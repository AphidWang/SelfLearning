---
description: Code Review Guidelines for Kid Platform - ç³»çµ±åŒ–æª¢æŸ¥æµç¨‹
globs: ["apps/kid-platform/**"]
alwaysApply: true
---

# Code Review æª¢æŸ¥æŒ‡å—

## ğŸ¯ æª¢æŸ¥æµç¨‹

å°æ–¼æ¯å€‹ commit æˆ– PRï¼Œéœ€è¦**é€é …æª¢æŸ¥**ä»¥ä¸‹è¦å‰‡ï¼Œä½¿ç”¨å…·é«”çš„ grep/æœå°‹æŒ‡ä»¤ã€‚

---

## ğŸ“‹ æª¢æŸ¥æ¸…å–®

### 1. Use Shadcn UI Components (#1)

**å·²å¼•å…¥çš„çµ„ä»¶**ï¼ˆåœ¨ `components/ui/` è³‡æ–™å¤¾ï¼‰ï¼š
- `Button`, `Input`, `Label`, `Card`, `Dialog`, `Select`, `Tabs`, `Toast`, `Alert`, `Badge`, `Avatar`, `Form`, `Checkbox`, `Radio Group`, `Switch`, `Slider`, `Progress`, `Skeleton`, `Separator`, `Sheet`, `Popover`, `Tooltip`, `Command`, `Calendar`, `Date Picker`

**æª¢æŸ¥æŒ‡ä»¤ï¼š**

```bash
# æª¢æŸ¥æ˜¯å¦æœ‰ä½¿ç”¨ Shadcn UI çµ„ä»¶
grep -E "<Button|<Card|<Avatar|<Input|<Label|<Form|<Dialog|<Select" <file>

# æª¢æŸ¥é€™äº›çµ„ä»¶æ˜¯å¦å¾ @/components/ui æ­£ç¢ºå°å…¥
grep "from '@/components/ui/" <file>

# æª¢æŸ¥æ˜¯å¦æœ‰è‡ªå®šç¾©çš„ UI çµ„ä»¶ï¼ˆé•è¦ï¼šæ‡‰è©²è¦ç”¨ Shadcn UI çš„çµ„ä»¶ï¼‰
grep -E "function.*Button|const.*Button|export.*Button" <file> | grep -v "from '@/components/ui"
grep -E "function.*Card|const.*Card|export.*Card" <file> | grep -v "from '@/components/ui"
grep -E "function.*Input|const.*Input|export.*Input" <file> | grep -v "from '@/components/ui"
grep -E "function.*Dialog|function.*Modal|const.*Dialog|const.*Modal" <file> | grep -v "from '@/components/ui"
grep -E "function.*Dropdown|function.*Select|const.*Dropdown|const.*Select" <file> | grep -v "from '@/components/ui"

# æª¢æŸ¥æ˜¯å¦æœ‰ä½¿ç”¨åŸç”Ÿ HTML æ¨™ç±¤ä½œç‚º UI çµ„ä»¶ï¼ˆæ‡‰è©²è¦ç”¨ Shadcn UIï¼‰
grep -E "<button[^>]*className" <file>  # æ‡‰è©²è¦ç”¨ <Button> è€Œä¸æ˜¯ <button>
grep -E "<input[^>]*className" <file>  # æ‡‰è©²è¦ç”¨ <Input> è€Œä¸æ˜¯ <input>
grep -E "<label[^>]*className" <file>  # æ‡‰è©²è¦ç”¨ <Label> è€Œä¸æ˜¯ <label>
```

**åˆ¤æ–·åŸå‰‡**ï¼š
- å¦‚æœç¨‹å¼ç¢¼ä¸­æœ‰è‡ªå®šç¾©çš„ UI çµ„ä»¶ï¼Œæ‡‰è©²å…ˆæª¢æŸ¥æ˜¯å¦å¯ä»¥ç”¨ Shadcn UI çµ„ä»¶æ›¿ä»£
- å¦‚æœéœ€è¦çš„çµ„ä»¶ Shadcn UI æœ‰ï¼Œæ‡‰è©²å…ˆå¼•å…¥å†ä½¿ç”¨ï¼Œè€Œä¸æ˜¯è‡ªå·±å¯¦ä½œ

---

### 2. Use Typography Component (#2)

**æª¢æŸ¥æŒ‡ä»¤ï¼š**

```bash
# æª¢æŸ¥æ˜¯å¦æœ‰ç›´æ¥ä½¿ç”¨ HTML æ–‡å­—æ¨™ç±¤ï¼ˆæ‡‰è©²è¦ç”¨ Typography çµ„ä»¶ï¼‰
grep -E "<p[^>]*>|<h[1-6][^>]*>" <file>  # <p> å’Œ <h1>-<h6> æ‡‰è©²è¦ç”¨ Typography
grep -E "<span[^>]*>[^<]*[A-Za-z]" <file>  # <span> ç”¨æ–¼æ–‡å­—é¡¯ç¤ºæ™‚æ‡‰è©²è¦ç”¨ Typography

# æª¢æŸ¥æ˜¯å¦æœ‰ä½¿ç”¨ Typography çµ„ä»¶
grep -E "<Typography" <file>
```

**åˆ¤æ–·åŸå‰‡**ï¼š
- `<p>`, `<h1>`, `<h2>`, `<h3>`, `<h4>`, `<h5>`, `<h6>` â†’ æ‡‰è©²ç”¨ `<Typography tag="p">` ç­‰
- `<span>` ç”¨æ–¼æ–‡å­—é¡¯ç¤ºæ™‚ â†’ æ‡‰è©²ç”¨ `<Typography tag="span">`
- `<div>` ä½œç‚ºå®¹å™¨/å¸ƒå±€ â†’ ä¸éœ€è¦ç”¨ Typographyï¼ˆé€™æ˜¯å®¹å™¨ï¼Œä¸æ˜¯æ–‡å­—ï¼‰
- `<label>` â†’ æ‡‰è©²ç”¨ Shadcn UI çš„ `<Label>` çµ„ä»¶ï¼ˆä¸æ˜¯ Typographyï¼‰
- Button/Input ç­‰çµ„ä»¶å…§çš„æ–‡å­— â†’ ä¸éœ€è¦ç”¨ Typographyï¼ˆçµ„ä»¶è‡ªå·±è™•ç†æ¨£å¼ï¼‰

---

### 3. Use i18n Strings (#3)

**æª¢æŸ¥æŒ‡ä»¤ï¼š**

```bash
# æª¢æŸ¥æ˜¯å¦æœ‰ç¡¬ç·¨ç¢¼çš„ä¸­æ–‡å­—ä¸²ï¼ˆé•è¦ï¼‰
grep -E "['\"][\u4e00-\u9fa5]+['\"]" <file>  # æª¢æŸ¥ä¸­æ–‡å­—ä¸²

# æª¢æŸ¥æ˜¯å¦æœ‰ä½¿ç”¨ useI18n hook
grep -E "useI18n|from '@/lib/i18n'" <file>

# æª¢æŸ¥æ˜¯å¦æœ‰ä½¿ç”¨ t() å‡½æ•¸
grep -E "t\(['\"]" <file>
```

**åˆ¤æ–·åŸå‰‡**ï¼š
- **é•è¦**ï¼šç›´æ¥åœ¨å…ƒä»¶ä¸­å¯«ä¸­æ–‡å­—ä¸²
  - `'é–‹å§‹å­¸ç¿’'` â†’ æ‡‰è©²ç”¨ `t('student.welcome.startButton')`
  - `'æ­¡è¿å›ä¾†ï¼'` â†’ æ‡‰è©²ç”¨ `t('student.welcome.title')`
- **å¯æ¥å—**ï¼šåœ¨ `lib/i18n/strings/` æª”æ¡ˆä¸­å®šç¾©å­—ä¸²ï¼ˆé€™æ˜¯æ­£ç¢ºçš„ï¼‰
- **å¯æ¥å—**ï¼šåœ¨è¨»è§£ä¸­çš„ä¸­æ–‡ï¼ˆè¨»è§£ä¸å½±éŸ¿ä½¿ç”¨è€…ï¼‰

---

### 4. No Inline Styles (#4)

**æª¢æŸ¥æŒ‡ä»¤ï¼š**

```bash
# æª¢æŸ¥æ˜¯å¦æœ‰ style={{}} å±¬æ€§
grep -E "style=\{" <file>
```

**åˆ¤æ–·åŸå‰‡**ï¼š
- **é•è¦**ï¼šéœæ…‹æ¨£å¼ç”¨ inline style
  - `style={{ padding: '16px' }}` â†’ æ‡‰è©²ç”¨ `className="p-4"`
  - `style={{ backgroundColor: '#ff0000' }}` â†’ æ‡‰è©²ç”¨ `className="bg-red-500"`
  - `style={{ width: '240px' }}` â†’ æ‡‰è©²ç”¨ `className="w-60"`
- **å¯æ¥å—**ï¼šå‹•æ…‹å€¼ç”¨ inline style
  - `style={{ width: `${dynamicWidth}px` }}` â†’ å¯æ¥å—ï¼ˆå‹•æ…‹å€¼ï¼‰
  - `style={{ top: `${scrollPosition}px` }}` â†’ å¯æ¥å—ï¼ˆå‹•æ…‹å€¼ï¼‰

---

### 5. Use Standard Tailwind Classes (#5)

**æª¢æŸ¥æŒ‡ä»¤ï¼š**

```bash
# æª¢æŸ¥æ˜¯å¦æœ‰ä»»æ„å€¼èªæ³• [value]ï¼ˆæ‡‰è©²è¦ä½¿ç”¨æ¨™æº– Tailwind classesï¼‰
grep -E "\[[0-9]+px\]|\[[0-9]+\%\]" <file>

# æª¢æŸ¥æ˜¯å¦æœ‰ç¡¬ç·¨ç¢¼çš„é¡è‰²å€¼ï¼ˆæ‡‰è©²è¦ä½¿ç”¨å“ç‰Œè‰²å½©æˆ–æ¨™æº– Tailwind é¡è‰²ï¼‰
grep -E "text-\[#[0-9a-fA-F]|bg-\[#[0-9a-fA-F]|border-\[#[0-9a-fA-F]" <file>
```

**åˆ¤æ–·åŸå‰‡**ï¼š
- **é•è¦**ï¼šä½¿ç”¨ä»»æ„å€¼ `w-[240px]` â†’ æ‡‰è©²ç”¨ `w-60`
- **é•è¦**ï¼šä½¿ç”¨ä»»æ„å€¼ `p-[16px]` â†’ æ‡‰è©²ç”¨ `p-4`
- **å¯æ¥å—**ï¼šå¦‚æœå€¼ä¸åœ¨æ¨™æº– Tailwind ä¸­ï¼Œä½¿ç”¨æœ€æ¥è¿‘çš„æ¨™æº–å€¼
- **å¯æ¥å—**ï¼šå“ç‰Œè‰²å½©å®šç¾©åœ¨ `globals.css` ä¸­ï¼Œä½¿ç”¨ `text-brand-*`, `bg-brand-*`

---

### 6. Use Brand Colors (#6)

**æª¢æŸ¥æŒ‡ä»¤ï¼š**

```bash
# æª¢æŸ¥æ˜¯å¦æœ‰ç¡¬ç·¨ç¢¼çš„é¡è‰²å€¼ï¼ˆæ‡‰è©²è¦ä½¿ç”¨å“ç‰Œè‰²å½©ï¼‰
grep -E "#[0-9a-fA-F]{3,6}" <file>  # æª¢æŸ¥ hex é¡è‰²

# æª¢æŸ¥æ˜¯å¦ä½¿ç”¨å“ç‰Œè‰²å½©é¡åˆ¥
grep -E "text-brand-|bg-brand-|border-brand-" <file>
```

**åˆ¤æ–·åŸå‰‡**ï¼š
- å¦‚æœé¡è‰²æ˜¯å“ç‰Œè‰²æˆ–å°ˆæ¡ˆè‰²ï¼ˆæœƒé‡è¤‡ä½¿ç”¨ï¼‰ï¼Œæ‡‰è©²å®šç¾©åœ¨ `globals.css` çš„ Brand colors å€å¡Š
- å¦‚æœé¡è‰²å·²ç¶“åœ¨å“ç‰Œèª¿è‰²æ¿ä¸­ï¼Œæ‡‰è©²ä½¿ç”¨å°æ‡‰çš„ Tailwind class
- åªæœ‰çœŸæ­£çš„ä¸€æ¬¡æ€§é¡è‰²ï¼ˆä¸æœƒé‡è¤‡ä½¿ç”¨ï¼‰æ‰å¯ä»¥ç”¨ä»»æ„å€¼ `bg-[#xxx]`

---

### 7. Feature-Specific Components (#7)

**æª¢æŸ¥æŒ‡ä»¤ï¼š**

```bash
# æª¢æŸ¥çµ„ä»¶æ˜¯å¦æ”¾åœ¨æ­£ç¢ºä½ç½®
# å¦‚æœçµ„ä»¶åªåœ¨ç‰¹å®š route ä½¿ç”¨ï¼Œæ‡‰è©²åœ¨è©² route ä¸‹çš„ _components/ æˆ– _widgets/
ls -la <route-directory>/_components/ <route-directory>/_widgets/

# æª¢æŸ¥ import è·¯å¾‘
grep -E "from.*components/shared" <route-page-file>  # å¦‚æœçµ„ä»¶åªåœ¨ä¸€å€‹ route ä½¿ç”¨ï¼Œä¸æ‡‰è©²åœ¨ shared
```

**åˆ¤æ–·åŸå‰‡**ï¼š
- å¦‚æœçµ„ä»¶åªç”¨åœ¨ä¸€å€‹ routeï¼ˆå¦‚ `app/(teacher)/`ï¼‰ï¼Œæ‡‰è©²æ”¾åœ¨ `app/(teacher)/_components/`
- å¦‚æœçµ„ä»¶è·¨åŠŸèƒ½ä½¿ç”¨ï¼Œæ‡‰è©²æ”¾åœ¨ `components/shared/`
- å¦‚æœçµ„ä»¶æ˜¯ UI åŸºç¤å…ƒä»¶ï¼Œæ‡‰è©²æ”¾åœ¨ `components/ui/`ï¼ˆshadcn/uiï¼‰

---

### 8. Store Usage (#8)

**æª¢æŸ¥æŒ‡ä»¤ï¼š**

```bash
# æª¢æŸ¥æ˜¯å¦æœ‰ä½¿ç”¨ store
grep -E "use.*Store|from.*store/" <file>

# æª¢æŸ¥ store æ˜¯å¦æ”¾åœ¨æ­£ç¢ºä½ç½®
# Feature-specific store æ‡‰è©²åœ¨ app/(feature)/_store/
# Shared store æ‡‰è©²åœ¨ store/

# æª¢æŸ¥æ˜¯å¦æœ‰ç›´æ¥æ“ä½œå…¨åŸŸç‹€æ…‹ï¼ˆæ‡‰è©²é€é store actionsï¼‰
grep -E "\.user\s*=|\.loading\s*=" <file>  # ä¸æ‡‰è©²ç›´æ¥ä¿®æ”¹ store ç‹€æ…‹
```

**åˆ¤æ–·åŸå‰‡**ï¼š
- Feature-specific store â†’ `app/(feature)/_store/`
- Shared store â†’ `store/`
- å¿…é ˆé€é store actions ä¿®æ”¹ç‹€æ…‹ï¼Œä¸å¯ç›´æ¥ä¿®æ”¹
- å¦‚æœè¦æ–°å¢ Global Storeï¼Œå¿…é ˆå…ˆè¨è«–ï¼ˆè¦‹ kid-platform.mdcï¼‰

---

### 9. Form Validation (#9)

**æª¢æŸ¥æŒ‡ä»¤ï¼š**

```bash
# æª¢æŸ¥æ˜¯å¦æœ‰ä½¿ç”¨ React Hook Form
grep -E "useForm|from 'react-hook-form'" <file>

# æª¢æŸ¥æ˜¯å¦æœ‰ä½¿ç”¨ yup é©—è­‰
grep -E "yupResolver|from.*validations" <file>

# æª¢æŸ¥æ˜¯å¦æœ‰ä½¿ç”¨ Shadcn UI çš„ Form çµ„ä»¶
grep -E "<Form|<FormField|<FormItem" <file>
```

**åˆ¤æ–·åŸå‰‡**ï¼š
- **é•è¦**ï¼šä¸ä½¿ç”¨ React Hook Form è™•ç†è¡¨å–®
- **é•è¦**ï¼šä¸ä½¿ç”¨ yup åšé©—è­‰
- **é•è¦**ï¼šä¸ä½¿ç”¨ Shadcn UI çš„ Form çµ„ä»¶
- Schema æ‡‰è©²å®šç¾©åœ¨ `lib/validations/` ç›®éŒ„ä¸‹

---

### 10. Component Size & Structure (#10)

**æª¢æŸ¥æŒ‡ä»¤ï¼š**

```bash
# æª¢æŸ¥å…ƒä»¶è¡Œæ•¸ï¼ˆæ‡‰è©² < 200 è¡Œï¼‰
wc -l <file>

# æª¢æŸ¥ useState æ•¸é‡ï¼ˆæ‡‰è©² < 5 å€‹ï¼‰
grep -c "useState" <file>

# æª¢æŸ¥ useEffect æ•¸é‡ï¼ˆæ‡‰è©² < 3 å€‹ï¼‰
grep -c "useEffect" <file>
```

**åˆ¤æ–·åŸå‰‡**ï¼š
- å–®ä¸€å…ƒä»¶ < 200 è¡Œ
- æœ€å¤š 5 å€‹ useState per component
- æœ€å¤š 3 å€‹ useEffect per component
- è¶…éæ™‚æ‡‰è©²æ‹†åˆ†æˆå­å…ƒä»¶æˆ–æå–åˆ° hooks

---

### 11. TypeScript Types (#11)

**æª¢æŸ¥æŒ‡ä»¤ï¼š**

```bash
# æª¢æŸ¥æ˜¯å¦æœ‰ä½¿ç”¨ anyï¼ˆé•è¦ï¼‰
grep -E ": any|any\[|any\||any\&" <file>

# æª¢æŸ¥æ˜¯å¦æœ‰é©ç•¶çš„é¡å‹å®šç¾©
grep -E "interface|type" <file>
```

**åˆ¤æ–·åŸå‰‡**ï¼š
- **é•è¦**ï¼šä½¿ç”¨ `any` é¡å‹
- æ‡‰è©²ä½¿ç”¨é©ç•¶çš„ TypeScript é¡å‹
- é¡å‹å®šç¾©æ‡‰è©²æ”¾åœ¨ `types/` ç›®éŒ„ä¸‹

---

### 12. No Console.log (#12)

**æª¢æŸ¥æŒ‡ä»¤ï¼š**

```bash
# æª¢æŸ¥æ˜¯å¦æœ‰ console.logï¼ˆæ‡‰è©²ç§»é™¤æˆ–æ”¹ç”¨é©ç•¶çš„ loggingï¼‰
grep -E "console\.log|console\.warn|console\.error" <file>
```

**åˆ¤æ–·åŸå‰‡**ï¼š
- ç”Ÿç”¢ç’°å¢ƒä¸æ‡‰è©²æœ‰ console.log
- å¯ä»¥ä½¿ç”¨é©ç•¶çš„ logging å·¥å…·ï¼ˆå¦‚ Sentryï¼‰
- é–‹ç™¼æ™‚å¯ä»¥ä¿ç•™ï¼Œä½†æ‡‰è©²æ¨™è¨» `// TODO: remove before production`

---

## ğŸ”„ ç³»çµ±åŒ–æª¢æŸ¥æ­¥é©Ÿ

å°æ–¼æ¯å€‹ commit æˆ– PRï¼Œ**å¿…é ˆåŸ·è¡Œä»¥ä¸‹æ­¥é©Ÿ**ï¼š

### Step 1: åˆ—å‡ºæ‰€æœ‰æ”¹å‹•çš„æª”æ¡ˆ

```bash
# å°æ–¼ commit
git show <commit> --name-only

# å°æ–¼ PR
git diff --name-only main...feature-branch
```

### Step 2: å°æ¯å€‹æª”æ¡ˆï¼Œé€é …æª¢æŸ¥ 12 å€‹è¦å‰‡

ä½¿ç”¨ä¸Šé¢çš„ grep æŒ‡ä»¤ï¼Œè¨˜éŒ„ç™¼ç¾çš„å•é¡Œï¼š

1. âœ… Rule #1: Shadcn UI Components
2. âœ… Rule #2: Typography Component
3. âœ… Rule #3: i18n Strings
4. âœ… Rule #4: No Inline Styles
5. âœ… Rule #5: Standard Tailwind Classes
6. âœ… Rule #6: Brand Colors
7. âœ… Rule #7: Feature-Specific Components
8. âœ… Rule #8: Store Usage
9. âœ… Rule #9: Form Validation
10. âœ… Rule #10: Component Size & Structure
11. âœ… Rule #11: TypeScript Types
12. âœ… Rule #12: No Console.log

### Step 3: è¨˜éŒ„å•é¡Œ

å»ºç«‹æª¢æŸ¥å ±å‘Šï¼Œåˆ—å‡ºï¼š
- ç™¼ç¾çš„å•é¡Œ
- é•è¦çš„æª”æ¡ˆå’Œè¡Œæ•¸
- å»ºè­°çš„ä¿®æ­£æ–¹å¼

### Step 4: ä¿®æ­£å¾Œå†æ¬¡æª¢æŸ¥

ä¿®æ­£å•é¡Œå¾Œï¼Œ**å†æ¬¡åŸ·è¡Œæ‰€æœ‰ grep æª¢æŸ¥ç¢ºèª**ã€‚

---

## ğŸ“ Code Review ç¯„ä¾‹

```bash
# ç¯„ä¾‹ï¼šæª¢æŸ¥ä¸€å€‹æª”æ¡ˆ
FILE="apps/kid-platform/src/app/(student)/WelcomePage.tsx"

# 1. æª¢æŸ¥ Shadcn UI
grep "from '@/components/ui/" "$FILE" || echo "âŒ æ²’æœ‰ä½¿ç”¨ Shadcn UI çµ„ä»¶"

# 2. æª¢æŸ¥ Typography
grep -E "<p[^>]*>|<h[1-6][^>]*>" "$FILE" && echo "âŒ æ‡‰è©²ä½¿ç”¨ Typography çµ„ä»¶"

# 3. æª¢æŸ¥ i18n
grep -E "['\"][\u4e00-\u9fa5]+['\"]" "$FILE" && echo "âŒ æœ‰ç¡¬ç·¨ç¢¼çš„ä¸­æ–‡å­—ä¸²"

# 4. æª¢æŸ¥ inline styles
grep -E "style=\{" "$FILE" && echo "âš ï¸ æœ‰ inline stylesï¼Œç¢ºèªæ˜¯å¦ç‚ºå‹•æ…‹å€¼"

# ... ç¹¼çºŒæª¢æŸ¥å…¶ä»–è¦å‰‡
```

---

## âš ï¸ é‡è¦æé†’

1. **é€é …æª¢æŸ¥**ï¼šä¸è¦è·³éä»»ä½•è¦å‰‡
2. **ä½¿ç”¨å…·é«”æŒ‡ä»¤**ï¼šä½¿ç”¨ grep æŒ‡ä»¤ï¼Œä¸è¦åªé è¦–è¦ºæª¢æŸ¥
3. **æª¢æŸ¥æ‰€æœ‰æª”æ¡ˆ**ï¼šä¸è¦åªæª¢æŸ¥ä¸»è¦æª”æ¡ˆ
4. **ä¿®æ­£å¾Œå†æª¢æŸ¥**ï¼šä¿®æ­£å•é¡Œå¾Œï¼Œå†æ¬¡åŸ·è¡Œæ‰€æœ‰æª¢æŸ¥ç¢ºèª

---

## ğŸ”— ç›¸é—œæ–‡ä»¶

- [Kid Platform Coding Rules](./kid-platform.mdc) - å®Œæ•´çš„é–‹ç™¼è¦ç¯„
- [README](../../README.md) - å°ˆæ¡ˆæ¦‚è¿°å’Œæ¶æ§‹èªªæ˜

