var Eg=Object.defineProperty;var wg=(t,e,r)=>e in t?Eg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var En=(t,e,r)=>wg(t,typeof e!="symbol"?e+"":e,r);function _mergeNamespaces(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var commonjsGlobal$2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;function m(oe){return oe===null||typeof oe!="object"?null:(oe=p&&oe[p]||oe["@@iterator"],typeof oe=="function"?oe:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,E={};function T(oe,ye,Ee){this.props=oe,this.context=ye,this.refs=E,this.updater=Ee||y}T.prototype.isReactComponent={},T.prototype.setState=function(oe,ye){if(typeof oe!="object"&&typeof oe!="function"&&oe!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,oe,ye,"setState")},T.prototype.forceUpdate=function(oe){this.updater.enqueueForceUpdate(this,oe,"forceUpdate")};function S(){}S.prototype=T.prototype;function P(oe,ye,Ee){this.props=oe,this.context=ye,this.refs=E,this.updater=Ee||y}var A=P.prototype=new S;A.constructor=P,b(A,T.prototype),A.isPureReactComponent=!0;var I=Array.isArray,j=Object.prototype.hasOwnProperty,K={current:null},W={key:!0,ref:!0,__self:!0,__source:!0};function H(oe,ye,Ee){var Ae,je={},Te=null,Ve=null;if(ye!=null)for(Ae in ye.ref!==void 0&&(Ve=ye.ref),ye.key!==void 0&&(Te=""+ye.key),ye)j.call(ye,Ae)&&!W.hasOwnProperty(Ae)&&(je[Ae]=ye[Ae]);var Pe=arguments.length-2;if(Pe===1)je.children=Ee;else if(1<Pe){for(var Ce=Array(Pe),De=0;De<Pe;De++)Ce[De]=arguments[De+2];je.children=Ce}if(oe&&oe.defaultProps)for(Ae in Pe=oe.defaultProps,Pe)je[Ae]===void 0&&(je[Ae]=Pe[Ae]);return{$$typeof:t,type:oe,key:Te,ref:Ve,props:je,_owner:K.current}}function ee(oe,ye){return{$$typeof:t,type:oe.type,key:ye,ref:oe.ref,props:oe.props,_owner:oe._owner}}function ue(oe){return typeof oe=="object"&&oe!==null&&oe.$$typeof===t}function de(oe){var ye={"=":"=0",":":"=2"};return"$"+oe.replace(/[=:]/g,function(Ee){return ye[Ee]})}var fe=/\/+/g;function ae(oe,ye){return typeof oe=="object"&&oe!==null&&oe.key!=null?de(""+oe.key):ye.toString(36)}function ce(oe,ye,Ee,Ae,je){var Te=typeof oe;(Te==="undefined"||Te==="boolean")&&(oe=null);var Ve=!1;if(oe===null)Ve=!0;else switch(Te){case"string":case"number":Ve=!0;break;case"object":switch(oe.$$typeof){case t:case e:Ve=!0}}if(Ve)return Ve=oe,je=je(Ve),oe=Ae===""?"."+ae(Ve,0):Ae,I(je)?(Ee="",oe!=null&&(Ee=oe.replace(fe,"$&/")+"/"),ce(je,ye,Ee,"",function(De){return De})):je!=null&&(ue(je)&&(je=ee(je,Ee+(!je.key||Ve&&Ve.key===je.key?"":(""+je.key).replace(fe,"$&/")+"/")+oe)),ye.push(je)),1;if(Ve=0,Ae=Ae===""?".":Ae+":",I(oe))for(var Pe=0;Pe<oe.length;Pe++){Te=oe[Pe];var Ce=Ae+ae(Te,Pe);Ve+=ce(Te,ye,Ee,Ce,je)}else if(Ce=m(oe),typeof Ce=="function")for(oe=Ce.call(oe),Pe=0;!(Te=oe.next()).done;)Te=Te.value,Ce=Ae+ae(Te,Pe++),Ve+=ce(Te,ye,Ee,Ce,je);else if(Te==="object")throw ye=String(oe),Error("Objects are not valid as a React child (found: "+(ye==="[object Object]"?"object with keys {"+Object.keys(oe).join(", ")+"}":ye)+"). If you meant to render a collection of children, use an array instead.");return Ve}function me(oe,ye,Ee){if(oe==null)return oe;var Ae=[],je=0;return ce(oe,Ae,"","",function(Te){return ye.call(Ee,Te,je++)}),Ae}function te(oe){if(oe._status===-1){var ye=oe._result;ye=ye(),ye.then(function(Ee){(oe._status===0||oe._status===-1)&&(oe._status=1,oe._result=Ee)},function(Ee){(oe._status===0||oe._status===-1)&&(oe._status=2,oe._result=Ee)}),oe._status===-1&&(oe._status=0,oe._result=ye)}if(oe._status===1)return oe._result.default;throw oe._result}var le={current:null},Z={transition:null},Y={ReactCurrentDispatcher:le,ReactCurrentBatchConfig:Z,ReactCurrentOwner:K};function he(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:me,forEach:function(oe,ye,Ee){me(oe,function(){ye.apply(this,arguments)},Ee)},count:function(oe){var ye=0;return me(oe,function(){ye++}),ye},toArray:function(oe){return me(oe,function(ye){return ye})||[]},only:function(oe){if(!ue(oe))throw Error("React.Children.only expected to receive a single React element child.");return oe}},react_production_min.Component=T,react_production_min.Fragment=r,react_production_min.Profiler=s,react_production_min.PureComponent=P,react_production_min.StrictMode=n,react_production_min.Suspense=u,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y,react_production_min.act=he,react_production_min.cloneElement=function(oe,ye,Ee){if(oe==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+oe+".");var Ae=b({},oe.props),je=oe.key,Te=oe.ref,Ve=oe._owner;if(ye!=null){if(ye.ref!==void 0&&(Te=ye.ref,Ve=K.current),ye.key!==void 0&&(je=""+ye.key),oe.type&&oe.type.defaultProps)var Pe=oe.type.defaultProps;for(Ce in ye)j.call(ye,Ce)&&!W.hasOwnProperty(Ce)&&(Ae[Ce]=ye[Ce]===void 0&&Pe!==void 0?Pe[Ce]:ye[Ce])}var Ce=arguments.length-2;if(Ce===1)Ae.children=Ee;else if(1<Ce){Pe=Array(Ce);for(var De=0;De<Ce;De++)Pe[De]=arguments[De+2];Ae.children=Pe}return{$$typeof:t,type:oe.type,key:je,ref:Te,props:Ae,_owner:Ve}},react_production_min.createContext=function(oe){return oe={$$typeof:o,_currentValue:oe,_currentValue2:oe,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},oe.Provider={$$typeof:a,_context:oe},oe.Consumer=oe},react_production_min.createElement=H,react_production_min.createFactory=function(oe){var ye=H.bind(null,oe);return ye.type=oe,ye},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(oe){return{$$typeof:l,render:oe}},react_production_min.isValidElement=ue,react_production_min.lazy=function(oe){return{$$typeof:d,_payload:{_status:-1,_result:oe},_init:te}},react_production_min.memo=function(oe,ye){return{$$typeof:c,type:oe,compare:ye===void 0?null:ye}},react_production_min.startTransition=function(oe){var ye=Z.transition;Z.transition={};try{oe()}finally{Z.transition=ye}},react_production_min.unstable_act=he,react_production_min.useCallback=function(oe,ye){return le.current.useCallback(oe,ye)},react_production_min.useContext=function(oe){return le.current.useContext(oe)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(oe){return le.current.useDeferredValue(oe)},react_production_min.useEffect=function(oe,ye){return le.current.useEffect(oe,ye)},react_production_min.useId=function(){return le.current.useId()},react_production_min.useImperativeHandle=function(oe,ye,Ee){return le.current.useImperativeHandle(oe,ye,Ee)},react_production_min.useInsertionEffect=function(oe,ye){return le.current.useInsertionEffect(oe,ye)},react_production_min.useLayoutEffect=function(oe,ye){return le.current.useLayoutEffect(oe,ye)},react_production_min.useMemo=function(oe,ye){return le.current.useMemo(oe,ye)},react_production_min.useReducer=function(oe,ye,Ee){return le.current.useReducer(oe,ye,Ee)},react_production_min.useRef=function(oe){return le.current.useRef(oe)},react_production_min.useState=function(oe){return le.current.useState(oe)},react_production_min.useSyncExternalStore=function(oe,ye,Ee){return le.current.useSyncExternalStore(oe,ye,Ee)},react_production_min.useTransition=function(){return le.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var t=requireReact(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,c){var d,p={},m=null,y=null;c!==void 0&&(m=""+c),u.key!==void 0&&(m=""+u.key),u.ref!==void 0&&(y=u.ref);for(d in u)n.call(u,d)&&!a.hasOwnProperty(d)&&(p[d]=u[d]);if(l&&l.defaultProps)for(d in u=l.defaultProps,u)p[d]===void 0&&(p[d]=u[d]);return{$$typeof:e,type:l,key:m,ref:y,props:p,_owner:s.current}}return reactJsxRuntime_production_min.Fragment=r,reactJsxRuntime_production_min.jsx=o,reactJsxRuntime_production_min.jsxs=o,reactJsxRuntime_production_min}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production_min()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),client$1={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,function(t){function e(Z,Y){var he=Z.length;Z.push(Y);e:for(;0<he;){var oe=he-1>>>1,ye=Z[oe];if(0<s(ye,Y))Z[oe]=Y,Z[he]=ye,he=oe;else break e}}function r(Z){return Z.length===0?null:Z[0]}function n(Z){if(Z.length===0)return null;var Y=Z[0],he=Z.pop();if(he!==Y){Z[0]=he;e:for(var oe=0,ye=Z.length,Ee=ye>>>1;oe<Ee;){var Ae=2*(oe+1)-1,je=Z[Ae],Te=Ae+1,Ve=Z[Te];if(0>s(je,he))Te<ye&&0>s(Ve,je)?(Z[oe]=Ve,Z[Te]=he,oe=Te):(Z[oe]=je,Z[Ae]=he,oe=Ae);else if(Te<ye&&0>s(Ve,he))Z[oe]=Ve,Z[Te]=he,oe=Te;else break e}}return Y}function s(Z,Y){var he=Z.sortIndex-Y.sortIndex;return he!==0?he:Z.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],c=[],d=1,p=null,m=3,y=!1,b=!1,E=!1,T=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(Z){for(var Y=r(c);Y!==null;){if(Y.callback===null)n(c);else if(Y.startTime<=Z)n(c),Y.sortIndex=Y.expirationTime,e(u,Y);else break;Y=r(c)}}function I(Z){if(E=!1,A(Z),!b)if(r(u)!==null)b=!0,te(j);else{var Y=r(c);Y!==null&&le(I,Y.startTime-Z)}}function j(Z,Y){b=!1,E&&(E=!1,S(H),H=-1),y=!0;var he=m;try{for(A(Y),p=r(u);p!==null&&(!(p.expirationTime>Y)||Z&&!de());){var oe=p.callback;if(typeof oe=="function"){p.callback=null,m=p.priorityLevel;var ye=oe(p.expirationTime<=Y);Y=t.unstable_now(),typeof ye=="function"?p.callback=ye:p===r(u)&&n(u),A(Y)}else n(u);p=r(u)}if(p!==null)var Ee=!0;else{var Ae=r(c);Ae!==null&&le(I,Ae.startTime-Y),Ee=!1}return Ee}finally{p=null,m=he,y=!1}}var K=!1,W=null,H=-1,ee=5,ue=-1;function de(){return!(t.unstable_now()-ue<ee)}function fe(){if(W!==null){var Z=t.unstable_now();ue=Z;var Y=!0;try{Y=W(!0,Z)}finally{Y?ae():(K=!1,W=null)}}else K=!1}var ae;if(typeof P=="function")ae=function(){P(fe)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,me=ce.port2;ce.port1.onmessage=fe,ae=function(){me.postMessage(null)}}else ae=function(){T(fe,0)};function te(Z){W=Z,K||(K=!0,ae())}function le(Z,Y){H=T(function(){Z(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){b||y||(b=!0,te(j))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(Z){switch(m){case 1:case 2:case 3:var Y=3;break;default:Y=m}var he=m;m=Y;try{return Z()}finally{m=he}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,Y){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var he=m;m=Z;try{return Y()}finally{m=he}},t.unstable_scheduleCallback=function(Z,Y,he){var oe=t.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?oe+he:oe):he=oe,Z){case 1:var ye=-1;break;case 2:ye=250;break;case 5:ye=1073741823;break;case 4:ye=1e4;break;default:ye=5e3}return ye=he+ye,Z={id:d++,callback:Y,priorityLevel:Z,startTime:he,expirationTime:ye,sortIndex:-1},he>oe?(Z.sortIndex=he,e(c,Z),r(u)===null&&Z===r(c)&&(E?(S(H),H=-1):E=!0,le(I,he-oe))):(Z.sortIndex=ye,e(u,Z),b||y||(b=!0,te(j))),Z},t.unstable_shouldYield=de,t.unstable_wrapCallback=function(Z){var Y=m;return function(){var he=m;m=Y;try{return Z.apply(this,arguments)}finally{m=he}}}}(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var t=requireReact(),e=requireScheduler();function r(f){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+f,C=1;C<arguments.length;C++)g+="&args[]="+encodeURIComponent(arguments[C]);return"Minified React error #"+f+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function a(f,g){o(f,g),o(f+"Capture",g)}function o(f,g){for(s[f]=g,f=0;f<g.length;f++)n.add(g[f])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},p={};function m(f){return u.call(p,f)?!0:u.call(d,f)?!1:c.test(f)?p[f]=!0:(d[f]=!0,!1)}function y(f,g,C,V){if(C!==null&&C.type===0)return!1;switch(typeof g){case"function":case"symbol":return!0;case"boolean":return V?!1:C!==null?!C.acceptsBooleans:(f=f.toLowerCase().slice(0,5),f!=="data-"&&f!=="aria-");default:return!1}}function b(f,g,C,V){if(g===null||typeof g>"u"||y(f,g,C,V))return!0;if(V)return!1;if(C!==null)switch(C.type){case 3:return!g;case 4:return g===!1;case 5:return isNaN(g);case 6:return isNaN(g)||1>g}return!1}function E(f,g,C,V,J,se,ve){this.acceptsBooleans=g===2||g===3||g===4,this.attributeName=V,this.attributeNamespace=J,this.mustUseProperty=C,this.propertyName=f,this.type=g,this.sanitizeURL=se,this.removeEmptyString=ve}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(f){T[f]=new E(f,0,!1,f,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(f){var g=f[0];T[g]=new E(g,1,!1,f[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(f){T[f]=new E(f,2,!1,f.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(f){T[f]=new E(f,2,!1,f,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(f){T[f]=new E(f,3,!1,f.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(f){T[f]=new E(f,3,!0,f,null,!1,!1)}),["capture","download"].forEach(function(f){T[f]=new E(f,4,!1,f,null,!1,!1)}),["cols","rows","size","span"].forEach(function(f){T[f]=new E(f,6,!1,f,null,!1,!1)}),["rowSpan","start"].forEach(function(f){T[f]=new E(f,5,!1,f.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function P(f){return f[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(f){var g=f.replace(S,P);T[g]=new E(g,1,!1,f,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(f){var g=f.replace(S,P);T[g]=new E(g,1,!1,f,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(f){var g=f.replace(S,P);T[g]=new E(g,1,!1,f,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(f){T[f]=new E(f,1,!1,f.toLowerCase(),null,!1,!1)}),T.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(f){T[f]=new E(f,1,!1,f.toLowerCase(),null,!0,!0)});function A(f,g,C,V){var J=T.hasOwnProperty(g)?T[g]:null;(J!==null?J.type!==0:V||!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(b(g,C,J,V)&&(C=null),V||J===null?m(g)&&(C===null?f.removeAttribute(g):f.setAttribute(g,""+C)):J.mustUseProperty?f[J.propertyName]=C===null?J.type===3?!1:"":C:(g=J.attributeName,V=J.attributeNamespace,C===null?f.removeAttribute(g):(J=J.type,C=J===3||J===4&&C===!0?"":""+C,V?f.setAttributeNS(V,g,C):f.setAttribute(g,C))))}var I=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,j=Symbol.for("react.element"),K=Symbol.for("react.portal"),W=Symbol.for("react.fragment"),H=Symbol.for("react.strict_mode"),ee=Symbol.for("react.profiler"),ue=Symbol.for("react.provider"),de=Symbol.for("react.context"),fe=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),ce=Symbol.for("react.suspense_list"),me=Symbol.for("react.memo"),te=Symbol.for("react.lazy"),le=Symbol.for("react.offscreen"),Z=Symbol.iterator;function Y(f){return f===null||typeof f!="object"?null:(f=Z&&f[Z]||f["@@iterator"],typeof f=="function"?f:null)}var he=Object.assign,oe;function ye(f){if(oe===void 0)try{throw Error()}catch(C){var g=C.stack.trim().match(/\n( *(at )?)/);oe=g&&g[1]||""}return`
`+oe+f}var Ee=!1;function Ae(f,g){if(!f||Ee)return"";Ee=!0;var C=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(Ge){var V=Ge}Reflect.construct(f,[],g)}else{try{g.call()}catch(Ge){V=Ge}f.call(g.prototype)}else{try{throw Error()}catch(Ge){V=Ge}f()}}catch(Ge){if(Ge&&V&&typeof Ge.stack=="string"){for(var J=Ge.stack.split(`
`),se=V.stack.split(`
`),ve=J.length-1,we=se.length-1;1<=ve&&0<=we&&J[ve]!==se[we];)we--;for(;1<=ve&&0<=we;ve--,we--)if(J[ve]!==se[we]){if(ve!==1||we!==1)do if(ve--,we--,0>we||J[ve]!==se[we]){var Ie=`
`+J[ve].replace(" at new "," at ");return f.displayName&&Ie.includes("<anonymous>")&&(Ie=Ie.replace("<anonymous>",f.displayName)),Ie}while(1<=ve&&0<=we);break}}}finally{Ee=!1,Error.prepareStackTrace=C}return(f=f?f.displayName||f.name:"")?ye(f):""}function je(f){switch(f.tag){case 5:return ye(f.type);case 16:return ye("Lazy");case 13:return ye("Suspense");case 19:return ye("SuspenseList");case 0:case 2:case 15:return f=Ae(f.type,!1),f;case 11:return f=Ae(f.type.render,!1),f;case 1:return f=Ae(f.type,!0),f;default:return""}}function Te(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case W:return"Fragment";case K:return"Portal";case ee:return"Profiler";case H:return"StrictMode";case ae:return"Suspense";case ce:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case de:return(f.displayName||"Context")+".Consumer";case ue:return(f._context.displayName||"Context")+".Provider";case fe:var g=f.render;return f=f.displayName,f||(f=g.displayName||g.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case me:return g=f.displayName||null,g!==null?g:Te(f.type)||"Memo";case te:g=f._payload,f=f._init;try{return Te(f(g))}catch{}}return null}function Ve(f){var g=f.type;switch(f.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=g.render,f=f.displayName||f.name||"",g.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Te(g);case 8:return g===H?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function Pe(f){switch(typeof f){case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function Ce(f){var g=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function De(f){var g=Ce(f)?"checked":"value",C=Object.getOwnPropertyDescriptor(f.constructor.prototype,g),V=""+f[g];if(!f.hasOwnProperty(g)&&typeof C<"u"&&typeof C.get=="function"&&typeof C.set=="function"){var J=C.get,se=C.set;return Object.defineProperty(f,g,{configurable:!0,get:function(){return J.call(this)},set:function(ve){V=""+ve,se.call(this,ve)}}),Object.defineProperty(f,g,{enumerable:C.enumerable}),{getValue:function(){return V},setValue:function(ve){V=""+ve},stopTracking:function(){f._valueTracker=null,delete f[g]}}}}function ze(f){f._valueTracker||(f._valueTracker=De(f))}function Et(f){if(!f)return!1;var g=f._valueTracker;if(!g)return!0;var C=g.getValue(),V="";return f&&(V=Ce(f)?f.checked?"true":"false":f.value),f=V,f!==C?(g.setValue(f),!0):!1}function Ze(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}function Ue(f,g){var C=g.checked;return he({},g,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:C??f._wrapperState.initialChecked})}function qt(f,g){var C=g.defaultValue==null?"":g.defaultValue,V=g.checked!=null?g.checked:g.defaultChecked;C=Pe(g.value!=null?g.value:C),f._wrapperState={initialChecked:V,initialValue:C,controlled:g.type==="checkbox"||g.type==="radio"?g.checked!=null:g.value!=null}}function or(f,g){g=g.checked,g!=null&&A(f,"checked",g,!1)}function Lt(f,g){or(f,g);var C=Pe(g.value),V=g.type;if(C!=null)V==="number"?(C===0&&f.value===""||f.value!=C)&&(f.value=""+C):f.value!==""+C&&(f.value=""+C);else if(V==="submit"||V==="reset"){f.removeAttribute("value");return}g.hasOwnProperty("value")?lr(f,g.type,C):g.hasOwnProperty("defaultValue")&&lr(f,g.type,Pe(g.defaultValue)),g.checked==null&&g.defaultChecked!=null&&(f.defaultChecked=!!g.defaultChecked)}function rt(f,g,C){if(g.hasOwnProperty("value")||g.hasOwnProperty("defaultValue")){var V=g.type;if(!(V!=="submit"&&V!=="reset"||g.value!==void 0&&g.value!==null))return;g=""+f._wrapperState.initialValue,C||g===f.value||(f.value=g),f.defaultValue=g}C=f.name,C!==""&&(f.name=""),f.defaultChecked=!!f._wrapperState.initialChecked,C!==""&&(f.name=C)}function lr(f,g,C){(g!=="number"||Ze(f.ownerDocument)!==f)&&(C==null?f.defaultValue=""+f._wrapperState.initialValue:f.defaultValue!==""+C&&(f.defaultValue=""+C))}var ir=Array.isArray;function er(f,g,C,V){if(f=f.options,g){g={};for(var J=0;J<C.length;J++)g["$"+C[J]]=!0;for(C=0;C<f.length;C++)J=g.hasOwnProperty("$"+f[C].value),f[C].selected!==J&&(f[C].selected=J),J&&V&&(f[C].defaultSelected=!0)}else{for(C=""+Pe(C),g=null,J=0;J<f.length;J++){if(f[J].value===C){f[J].selected=!0,V&&(f[J].defaultSelected=!0);return}g!==null||f[J].disabled||(g=f[J])}g!==null&&(g.selected=!0)}}function xr(f,g){if(g.dangerouslySetInnerHTML!=null)throw Error(r(91));return he({},g,{value:void 0,defaultValue:void 0,children:""+f._wrapperState.initialValue})}function br(f,g){var C=g.value;if(C==null){if(C=g.children,g=g.defaultValue,C!=null){if(g!=null)throw Error(r(92));if(ir(C)){if(1<C.length)throw Error(r(93));C=C[0]}g=C}g==null&&(g=""),C=g}f._wrapperState={initialValue:Pe(C)}}function Pr(f,g){var C=Pe(g.value),V=Pe(g.defaultValue);C!=null&&(C=""+C,C!==f.value&&(f.value=C),g.defaultValue==null&&f.defaultValue!==C&&(f.defaultValue=C)),V!=null&&(f.defaultValue=""+V)}function zr(f){var g=f.textContent;g===f._wrapperState.initialValue&&g!==""&&g!==null&&(f.value=g)}function pr(f){switch(f){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dr(f,g){return f==null||f==="http://www.w3.org/1999/xhtml"?pr(g):f==="http://www.w3.org/2000/svg"&&g==="foreignObject"?"http://www.w3.org/1999/xhtml":f}var Ar,_r=function(f){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(g,C,V,J){MSApp.execUnsafeLocalFunction(function(){return f(g,C,V,J)})}:f}(function(f,g){if(f.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in f)f.innerHTML=g;else{for(Ar=Ar||document.createElement("div"),Ar.innerHTML="<svg>"+g.valueOf().toString()+"</svg>",g=Ar.firstChild;f.firstChild;)f.removeChild(f.firstChild);for(;g.firstChild;)f.appendChild(g.firstChild)}});function It(f,g){if(g){var C=f.firstChild;if(C&&C===f.lastChild&&C.nodeType===3){C.nodeValue=g;return}}f.textContent=g}var Bt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ur=["Webkit","ms","Moz","O"];Object.keys(Bt).forEach(function(f){ur.forEach(function(g){g=g+f.charAt(0).toUpperCase()+f.substring(1),Bt[g]=Bt[f]})});function Vn(f,g,C){return g==null||typeof g=="boolean"||g===""?"":C||typeof g!="number"||g===0||Bt.hasOwnProperty(f)&&Bt[f]?(""+g).trim():g+"px"}function gn(f,g){f=f.style;for(var C in g)if(g.hasOwnProperty(C)){var V=C.indexOf("--")===0,J=Vn(C,g[C],V);C==="float"&&(C="cssFloat"),V?f.setProperty(C,J):f[C]=J}}var yn=he({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Dr(f,g){if(g){if(yn[f]&&(g.children!=null||g.dangerouslySetInnerHTML!=null))throw Error(r(137,f));if(g.dangerouslySetInnerHTML!=null){if(g.children!=null)throw Error(r(60));if(typeof g.dangerouslySetInnerHTML!="object"||!("__html"in g.dangerouslySetInnerHTML))throw Error(r(61))}if(g.style!=null&&typeof g.style!="object")throw Error(r(62))}}function Nr(f,g){if(f.indexOf("-")===-1)return typeof g.is=="string";switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wn=null;function jn(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var $r=null,Cr=null,Ir=null;function kr(f){if(f=ks(f)){if(typeof $r!="function")throw Error(r(280));var g=f.stateNode;g&&(g=Vu(g),$r(f.stateNode,f.type,g))}}function Er(f){Cr?Ir?Ir.push(f):Ir=[f]:Cr=f}function Nn(){if(Cr){var f=Cr,g=Ir;if(Ir=Cr=null,kr(f),g)for(f=0;f<g.length;f++)kr(g[f])}}function Hr(f,g){return f(g)}function qr(){}var Fr=!1;function Dn(f,g,C){if(Fr)return f(g,C);Fr=!0;try{return Hr(f,g,C)}finally{Fr=!1,(Cr!==null||Ir!==null)&&(qr(),Nn())}}function yr(f,g){var C=f.stateNode;if(C===null)return null;var V=Vu(C);if(V===null)return null;C=V[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(V=!V.disabled)||(f=f.type,V=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!V;break e;default:f=!1}if(f)return null;if(C&&typeof C!="function")throw Error(r(231,g,typeof C));return C}var Wr=!1;if(l)try{var vr={};Object.defineProperty(vr,"passive",{get:function(){Wr=!0}}),window.addEventListener("test",vr,vr),window.removeEventListener("test",vr,vr)}catch{Wr=!1}function jr(f,g,C,V,J,se,ve,we,Ie){var Ge=Array.prototype.slice.call(arguments,3);try{g.apply(C,Ge)}catch(nt){this.onError(nt)}}var Qr=!1,xn=null,Lr=!1,_s=null,Hs={onError:function(f){Qr=!0,xn=f}};function Bn(f,g,C,V,J,se,ve,we,Ie){Qr=!1,xn=null,jr.apply(Hs,arguments)}function Hn(f,g,C,V,J,se,ve,we,Ie){if(Bn.apply(this,arguments),Qr){if(Qr){var Ge=xn;Qr=!1,xn=null}else throw Error(r(198));Lr||(Lr=!0,_s=Ge)}}function Tn(f){var g=f,C=f;if(f.alternate)for(;g.return;)g=g.return;else{f=g;do g=f,(g.flags&4098)!==0&&(C=g.return),f=g.return;while(f)}return g.tag===3?C:null}function Mn(f){if(f.tag===13){var g=f.memoizedState;if(g===null&&(f=f.alternate,f!==null&&(g=f.memoizedState)),g!==null)return g.dehydrated}return null}function os(f){if(Tn(f)!==f)throw Error(r(188))}function es(f){var g=f.alternate;if(!g){if(g=Tn(f),g===null)throw Error(r(188));return g!==f?null:f}for(var C=f,V=g;;){var J=C.return;if(J===null)break;var se=J.alternate;if(se===null){if(V=J.return,V!==null){C=V;continue}break}if(J.child===se.child){for(se=J.child;se;){if(se===C)return os(J),f;if(se===V)return os(J),g;se=se.sibling}throw Error(r(188))}if(C.return!==V.return)C=J,V=se;else{for(var ve=!1,we=J.child;we;){if(we===C){ve=!0,C=J,V=se;break}if(we===V){ve=!0,V=J,C=se;break}we=we.sibling}if(!ve){for(we=se.child;we;){if(we===C){ve=!0,C=se,V=J;break}if(we===V){ve=!0,V=se,C=J;break}we=we.sibling}if(!ve)throw Error(r(189))}}if(C.alternate!==V)throw Error(r(190))}if(C.tag!==3)throw Error(r(188));return C.stateNode.current===C?f:g}function ci(f){return f=es(f),f!==null?ti(f):null}function ti(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var g=ti(f);if(g!==null)return g;f=f.sibling}return null}var Se=e.unstable_scheduleCallback,We=e.unstable_cancelCallback,et=e.unstable_shouldYield,Ye=e.unstable_requestPaint,Xe=e.unstable_now,qe=e.unstable_getCurrentPriorityLevel,kt=e.unstable_ImmediatePriority,Wt=e.unstable_UserBlockingPriority,cr=e.unstable_NormalPriority,nr=e.unstable_LowPriority,Kr=e.unstable_IdlePriority,un=null,An=null;function Sn(f){if(An&&typeof An.onCommitFiberRoot=="function")try{An.onCommitFiberRoot(un,f,void 0,(f.current.flags&128)===128)}catch{}}var ls=Math.clz32?Math.clz32:Fs,Fa=Math.log,ho=Math.LN2;function Fs(f){return f>>>=0,f===0?32:31-(Fa(f)/ho|0)|0}var Wi=64,La=4194304;function pa(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function Ki(f,g){var C=f.pendingLanes;if(C===0)return 0;var V=0,J=f.suspendedLanes,se=f.pingedLanes,ve=C&268435455;if(ve!==0){var we=ve&~J;we!==0?V=pa(we):(se&=ve,se!==0&&(V=pa(se)))}else ve=C&~J,ve!==0?V=pa(ve):se!==0&&(V=pa(se));if(V===0)return 0;if(g!==0&&g!==V&&(g&J)===0&&(J=V&-V,se=g&-g,J>=se||J===16&&(se&4194240)!==0))return g;if((V&4)!==0&&(V|=C&16),g=f.entangledLanes,g!==0)for(f=f.entanglements,g&=V;0<g;)C=31-ls(g),J=1<<C,V|=f[C],g&=~J;return V}function xu(f,g){switch(f){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ma(f,g){for(var C=f.suspendedLanes,V=f.pingedLanes,J=f.expirationTimes,se=f.pendingLanes;0<se;){var ve=31-ls(se),we=1<<ve,Ie=J[ve];Ie===-1?((we&C)===0||(we&V)!==0)&&(J[ve]=xu(we,g)):Ie<=g&&(f.expiredLanes|=we),se&=~we}}function qs(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function Va(){var f=Wi;return Wi<<=1,(Wi&4194240)===0&&(Wi=64),f}function Zi(f){for(var g=[],C=0;31>C;C++)g.push(f);return g}function Ba(f,g,C){f.pendingLanes|=g,g!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,g=31-ls(g),f[g]=C}function Cn(f,g){var C=f.pendingLanes&~g;f.pendingLanes=g,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=g,f.mutableReadLanes&=g,f.entangledLanes&=g,g=f.entanglements;var V=f.eventTimes;for(f=f.expirationTimes;0<C;){var J=31-ls(C),se=1<<J;g[J]=0,V[J]=-1,f[J]=-1,C&=~se}}function Xi(f,g){var C=f.entangledLanes|=g;for(f=f.entanglements;C;){var V=31-ls(C),J=1<<V;J&g|f[V]&g&&(f[V]|=g),C&=~J}}var Gr=0;function ri(f){return f&=-f,1<f?4<f?(f&268435455)!==0?16:536870912:4:1}var Cl,po,_u,Il,kl,Wo=!1,Ci=[],bs=null,Ii=null,ki=null,ga=new Map,di=new Map,Yi=[],Oc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bu(f,g){switch(f){case"focusin":case"focusout":bs=null;break;case"dragenter":case"dragleave":Ii=null;break;case"mouseover":case"mouseout":ki=null;break;case"pointerover":case"pointerout":ga.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":di.delete(g.pointerId)}}function Ts(f,g,C,V,J,se){return f===null||f.nativeEvent!==se?(f={blockedOn:g,domEventName:C,eventSystemFlags:V,nativeEvent:se,targetContainers:[J]},g!==null&&(g=ks(g),g!==null&&po(g)),f):(f.eventSystemFlags|=V,g=f.targetContainers,J!==null&&g.indexOf(J)===-1&&g.push(J),f)}function $c(f,g,C,V,J){switch(g){case"focusin":return bs=Ts(bs,f,g,C,V,J),!0;case"dragenter":return Ii=Ts(Ii,f,g,C,V,J),!0;case"mouseover":return ki=Ts(ki,f,g,C,V,J),!0;case"pointerover":var se=J.pointerId;return ga.set(se,Ts(ga.get(se)||null,f,g,C,V,J)),!0;case"gotpointercapture":return se=J.pointerId,di.set(se,Ts(di.get(se)||null,f,g,C,V,J)),!0}return!1}function Eu(f){var g=ta(f.target);if(g!==null){var C=Tn(g);if(C!==null){if(g=C.tag,g===13){if(g=Mn(C),g!==null){f.blockedOn=g,kl(f.priority,function(){_u(C)});return}}else if(g===3&&C.stateNode.current.memoizedState.isDehydrated){f.blockedOn=C.tag===3?C.stateNode.containerInfo:null;return}}}f.blockedOn=null}function ya(f){if(f.blockedOn!==null)return!1;for(var g=f.targetContainers;0<g.length;){var C=yo(f.domEventName,f.eventSystemFlags,g[0],f.nativeEvent);if(C===null){C=f.nativeEvent;var V=new C.constructor(C.type,C);wn=V,C.target.dispatchEvent(V),wn=null}else return g=ks(C),g!==null&&po(g),f.blockedOn=C,!1;g.shift()}return!0}function mo(f,g,C){ya(f)&&C.delete(g)}function wu(){Wo=!1,bs!==null&&ya(bs)&&(bs=null),Ii!==null&&ya(Ii)&&(Ii=null),ki!==null&&ya(ki)&&(ki=null),ga.forEach(mo),di.forEach(mo)}function Xr(f,g){f.blockedOn===g&&(f.blockedOn=null,Wo||(Wo=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,wu)))}function Zr(f){function g(J){return Xr(J,f)}if(0<Ci.length){Xr(Ci[0],f);for(var C=1;C<Ci.length;C++){var V=Ci[C];V.blockedOn===f&&(V.blockedOn=null)}}for(bs!==null&&Xr(bs,f),Ii!==null&&Xr(Ii,f),ki!==null&&Xr(ki,f),ga.forEach(g),di.forEach(g),C=0;C<Yi.length;C++)V=Yi[C],V.blockedOn===f&&(V.blockedOn=null);for(;0<Yi.length&&(C=Yi[0],C.blockedOn===null);)Eu(C),C.blockedOn===null&&Yi.shift()}var va=I.ReactCurrentBatchConfig,Ua=!0;function Un(f,g,C,V){var J=Gr,se=va.transition;va.transition=null;try{Gr=1,Nl(f,g,C,V)}finally{Gr=J,va.transition=se}}function Fc(f,g,C,V){var J=Gr,se=va.transition;va.transition=null;try{Gr=4,Nl(f,g,C,V)}finally{Gr=J,va.transition=se}}function Nl(f,g,C,V){if(Ua){var J=yo(f,g,C,V);if(J===null)Gc(f,g,V,go,C),bu(f,V);else if($c(J,f,g,C,V))V.stopPropagation();else if(bu(f,V),g&4&&-1<Oc.indexOf(f)){for(;J!==null;){var se=ks(J);if(se!==null&&Cl(se),se=yo(f,g,C,V),se===null&&Gc(f,g,V,go,C),se===J)break;J=se}J!==null&&V.stopPropagation()}else Gc(f,g,V,null,C)}}var go=null;function yo(f,g,C,V){if(go=null,f=jn(V),f=ta(f),f!==null)if(g=Tn(f),g===null)f=null;else if(C=g.tag,C===13){if(f=Mn(g),f!==null)return f;f=null}else if(C===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;f=null}else g!==f&&(f=null);return go=f,null}function Dl(f){switch(f){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qe()){case kt:return 1;case Wt:return 4;case cr:case nr:return 16;case Kr:return 536870912;default:return 16}default:return 16}}var Rn=null,Ga=null,ts=null;function Ko(){if(ts)return ts;var f,g=Ga,C=g.length,V,J="value"in Rn?Rn.value:Rn.textContent,se=J.length;for(f=0;f<C&&g[f]===J[f];f++);var ve=C-f;for(V=1;V<=ve&&g[C-V]===J[se-V];V++);return ts=J.slice(f,1<V?1-V:void 0)}function za(f){var g=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&g===13&&(f=13)):f=g,f===10&&(f=13),32<=f||f===13?f:0}function Xn(){return!0}function Zo(){return!1}function ms(f){function g(C,V,J,se,ve){this._reactName=C,this._targetInst=J,this.type=V,this.nativeEvent=se,this.target=ve,this.currentTarget=null;for(var we in f)f.hasOwnProperty(we)&&(C=f[we],this[we]=C?C(se):se[we]);return this.isDefaultPrevented=(se.defaultPrevented!=null?se.defaultPrevented:se.returnValue===!1)?Xn:Zo,this.isPropagationStopped=Zo,this}return he(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var C=this.nativeEvent;C&&(C.preventDefault?C.preventDefault():typeof C.returnValue!="unknown"&&(C.returnValue=!1),this.isDefaultPrevented=Xn)},stopPropagation:function(){var C=this.nativeEvent;C&&(C.stopPropagation?C.stopPropagation():typeof C.cancelBubble!="unknown"&&(C.cancelBubble=!0),this.isPropagationStopped=Xn)},persist:function(){},isPersistent:Xn}),g}var fi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vo=ms(fi),Ni=he({},fi,{view:0,detail:0}),Su=ms(Ni),gs,xa,us,xo=he({},Ni,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ji,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==us&&(us&&f.type==="mousemove"?(gs=f.screenX-us.screenX,xa=f.screenY-us.screenY):xa=gs=0,us=f),gs)},movementY:function(f){return"movementY"in f?f.movementY:xa}}),_o=ms(xo),hi=he({},xo,{dataTransfer:0}),bo=ms(hi),Ha=he({},Ni,{relatedTarget:0}),Pn=ms(Ha),Di=he({},fi,{animationName:0,elapsedTime:0,pseudoElement:0}),ji=ms(Di),Ru=he({},fi,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),Xo=ms(Ru),Pu=he({},fi,{data:0}),jl=ms(Pu),Yo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},As={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Eo={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ba(f){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(f):(f=Eo[f])?!!g[f]:!1}function Ji(){return ba}var D=he({},Ni,{key:function(f){if(f.key){var g=Yo[f.key]||f.key;if(g!=="Unidentified")return g}return f.type==="keypress"?(f=za(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?As[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ji,charCode:function(f){return f.type==="keypress"?za(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?za(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),ne=ms(D),pe=he({},xo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_e=ms(pe),$e=he({},Ni,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ji}),He=ms($e),Nt=he({},fi,{propertyName:0,elapsedTime:0,pseudoElement:0}),vn=ms(Nt),cs=he({},xo,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),Yr=ms(cs),bn=[9,13,27,32],Kn=l&&"CompositionEvent"in window,Cs=null;l&&"documentMode"in document&&(Cs=document.documentMode);var Ws=l&&"TextEvent"in window&&!Cs,qa=l&&(!Kn||Cs&&8<Cs&&11>=Cs),Jo=" ",Bd=!1;function Ud(f,g){switch(f){case"keyup":return bn.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gd(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var Qo=!1;function el(f,g){switch(f){case"compositionend":return Gd(g);case"keypress":return g.which!==32?null:(Bd=!0,Jo);case"textInput":return f=g.data,f===Jo&&Bd?null:f;default:return null}}function zf(f,g){if(Qo)return f==="compositionend"||!Kn&&Ud(f,g)?(f=Ko(),ts=Ga=Rn=null,Qo=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return qa&&g.locale!=="ko"?null:g.data;default:return null}}var Hf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tu(f){var g=f&&f.nodeName&&f.nodeName.toLowerCase();return g==="input"?!!Hf[f.type]:g==="textarea"}function Lc(f,g,C,V){Er(V),g=Ou(g,"onChange"),0<g.length&&(C=new vo("onChange","change",null,C,V),f.push({event:C,listeners:g}))}var pi=null,Wa=null;function qf(f){Xd(f,0)}function Au(f){var g=Mr(f);if(Et(g))return f}function Wf(f,g){if(f==="change")return g}var wo=!1;if(l){var ni;if(l){var Cu="oninput"in document;if(!Cu){var zd=document.createElement("div");zd.setAttribute("oninput","return;"),Cu=typeof zd.oninput=="function"}ni=Cu}else ni=!1;wo=ni&&(!document.documentMode||9<document.documentMode)}function Hd(){pi&&(pi.detachEvent("onpropertychange",qd),Wa=pi=null)}function qd(f){if(f.propertyName==="value"&&Au(Wa)){var g=[];Lc(g,Wa,f,jn(f)),Dn(qf,g)}}function Kf(f,g,C){f==="focusin"?(Hd(),pi=g,Wa=C,pi.attachEvent("onpropertychange",qd)):f==="focusout"&&Hd()}function Zf(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return Au(Wa)}function tl(f,g){if(f==="click")return Au(g)}function Me(f,g){if(f==="input"||f==="change")return Au(g)}function Ke(f,g){return f===g&&(f!==0||1/f===1/g)||f!==f&&g!==g}var Be=typeof Object.is=="function"?Object.is:Ke;function Ut(f,g){if(Be(f,g))return!0;if(typeof f!="object"||f===null||typeof g!="object"||g===null)return!1;var C=Object.keys(f),V=Object.keys(g);if(C.length!==V.length)return!1;for(V=0;V<C.length;V++){var J=C[V];if(!u.call(g,J)||!Be(f[J],g[J]))return!1}return!0}function Tr(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function hn(f,g){var C=Tr(f);f=0;for(var V;C;){if(C.nodeType===3){if(V=f+C.textContent.length,f<=g&&V>=g)return{node:C,offset:g-f};f=V}e:{for(;C;){if(C.nextSibling){C=C.nextSibling;break e}C=C.parentNode}C=void 0}C=Tr(C)}}function rs(f,g){return f&&g?f===g?!0:f&&f.nodeType===3?!1:g&&g.nodeType===3?rs(f,g.parentNode):"contains"in f?f.contains(g):f.compareDocumentPosition?!!(f.compareDocumentPosition(g)&16):!1:!1}function In(){for(var f=window,g=Ze();g instanceof f.HTMLIFrameElement;){try{var C=typeof g.contentWindow.location.href=="string"}catch{C=!1}if(C)f=g.contentWindow;else break;g=Ze(f.document)}return g}function Ml(f){var g=f&&f.nodeName&&f.nodeName.toLowerCase();return g&&(g==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||g==="textarea"||f.contentEditable==="true")}function Xf(f){var g=In(),C=f.focusedElem,V=f.selectionRange;if(g!==C&&C&&C.ownerDocument&&rs(C.ownerDocument.documentElement,C)){if(V!==null&&Ml(C)){if(g=V.start,f=V.end,f===void 0&&(f=g),"selectionStart"in C)C.selectionStart=g,C.selectionEnd=Math.min(f,C.value.length);else if(f=(g=C.ownerDocument||document)&&g.defaultView||window,f.getSelection){f=f.getSelection();var J=C.textContent.length,se=Math.min(V.start,J);V=V.end===void 0?se:Math.min(V.end,J),!f.extend&&se>V&&(J=V,V=se,se=J),J=hn(C,se);var ve=hn(C,V);J&&ve&&(f.rangeCount!==1||f.anchorNode!==J.node||f.anchorOffset!==J.offset||f.focusNode!==ve.node||f.focusOffset!==ve.offset)&&(g=g.createRange(),g.setStart(J.node,J.offset),f.removeAllRanges(),se>V?(f.addRange(g),f.extend(ve.node,ve.offset)):(g.setEnd(ve.node,ve.offset),f.addRange(g)))}}for(g=[],f=C;f=f.parentNode;)f.nodeType===1&&g.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof C.focus=="function"&&C.focus(),C=0;C<g.length;C++)f=g[C],f.element.scrollLeft=f.left,f.element.scrollTop=f.top}}var mi=l&&"documentMode"in document&&11>=document.documentMode,Ea=null,Vc=null,Qi=null,rl=!1;function Ol(f,g,C){var V=C.window===C?C.document:C.nodeType===9?C:C.ownerDocument;rl||Ea==null||Ea!==Ze(V)||(V=Ea,"selectionStart"in V&&Ml(V)?V={start:V.selectionStart,end:V.selectionEnd}:(V=(V.ownerDocument&&V.ownerDocument.defaultView||window).getSelection(),V={anchorNode:V.anchorNode,anchorOffset:V.anchorOffset,focusNode:V.focusNode,focusOffset:V.focusOffset}),Qi&&Ut(Qi,V)||(Qi=V,V=Ou(Vc,"onSelect"),0<V.length&&(g=new vo("onSelect","select",null,g,C),f.push({event:g,listeners:V}),g.target=Ea)))}function pn(f,g){var C={};return C[f.toLowerCase()]=g.toLowerCase(),C["Webkit"+f]="webkit"+g,C["Moz"+f]="moz"+g,C}var nl={animationend:pn("Animation","AnimationEnd"),animationiteration:pn("Animation","AnimationIteration"),animationstart:pn("Animation","AnimationStart"),transitionend:pn("Transition","TransitionEnd")},Iu={},$l={};l&&($l=document.createElement("div").style,"AnimationEvent"in window||(delete nl.animationend.animation,delete nl.animationiteration.animation,delete nl.animationstart.animation),"TransitionEvent"in window||delete nl.transitionend.transition);function ku(f){if(Iu[f])return Iu[f];if(!nl[f])return f;var g=nl[f],C;for(C in g)if(g.hasOwnProperty(C)&&C in $l)return Iu[f]=g[C];return f}var Wd=ku("animationend"),Kd=ku("animationiteration"),Fl=ku("animationstart"),wa=ku("transitionend"),Ll=new Map,Bc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mi(f,g){Ll.set(f,g),a(g,[f])}for(var Nu=0;Nu<Bc.length;Nu++){var Du=Bc[Nu],ju=Du.toLowerCase(),Zd=Du[0].toUpperCase()+Du.slice(1);Mi(ju,"on"+Zd)}Mi(Wd,"onAnimationEnd"),Mi(Kd,"onAnimationIteration"),Mi(Fl,"onAnimationStart"),Mi("dblclick","onDoubleClick"),Mi("focusin","onFocus"),Mi("focusout","onBlur"),Mi(wa,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),So=new Set("cancel close invalid load scroll toggle".split(" ").concat(Sa));function Vl(f,g,C){var V=f.type||"unknown-event";f.currentTarget=C,Hn(V,g,void 0,f),f.currentTarget=null}function Xd(f,g){g=(g&4)!==0;for(var C=0;C<f.length;C++){var V=f[C],J=V.event;V=V.listeners;e:{var se=void 0;if(g)for(var ve=V.length-1;0<=ve;ve--){var we=V[ve],Ie=we.instance,Ge=we.currentTarget;if(we=we.listener,Ie!==se&&J.isPropagationStopped())break e;Vl(J,we,Ge),se=Ie}else for(ve=0;ve<V.length;ve++){if(we=V[ve],Ie=we.instance,Ge=we.currentTarget,we=we.listener,Ie!==se&&J.isPropagationStopped())break e;Vl(J,we,Ge),se=Ie}}}if(Lr)throw f=_s,Lr=!1,_s=null,f}function $n(f,g){var C=g[Lu];C===void 0&&(C=g[Lu]=new Set);var V=f+"__bubble";C.has(V)||(Mu(g,f,2,!1),C.add(V))}function Uc(f,g,C){var V=0;g&&(V|=4),Mu(C,f,V,g)}var Ro="_reactListening"+Math.random().toString(36).slice(2);function Ka(f){if(!f[Ro]){f[Ro]=!0,n.forEach(function(C){C!=="selectionchange"&&(So.has(C)||Uc(C,!1,f),Uc(C,!0,f))});var g=f.nodeType===9?f:f.ownerDocument;g===null||g[Ro]||(g[Ro]=!0,Uc("selectionchange",!1,g))}}function Mu(f,g,C,V){switch(Dl(g)){case 1:var J=Un;break;case 4:J=Fc;break;default:J=Nl}C=J.bind(null,g,C,f),J=void 0,!Wr||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(J=!0),V?J!==void 0?f.addEventListener(g,C,{capture:!0,passive:J}):f.addEventListener(g,C,!0):J!==void 0?f.addEventListener(g,C,{passive:J}):f.addEventListener(g,C,!1)}function Gc(f,g,C,V,J){var se=V;if((g&1)===0&&(g&2)===0&&V!==null)e:for(;;){if(V===null)return;var ve=V.tag;if(ve===3||ve===4){var we=V.stateNode.containerInfo;if(we===J||we.nodeType===8&&we.parentNode===J)break;if(ve===4)for(ve=V.return;ve!==null;){var Ie=ve.tag;if((Ie===3||Ie===4)&&(Ie=ve.stateNode.containerInfo,Ie===J||Ie.nodeType===8&&Ie.parentNode===J))return;ve=ve.return}for(;we!==null;){if(ve=ta(we),ve===null)return;if(Ie=ve.tag,Ie===5||Ie===6){V=se=ve;continue e}we=we.parentNode}}V=V.return}Dn(function(){var Ge=se,nt=jn(C),vt=[];e:{var tt=Ll.get(f);if(tt!==void 0){var Gt=vo,tr=f;switch(f){case"keypress":if(za(C)===0)break e;case"keydown":case"keyup":Gt=ne;break;case"focusin":tr="focus",Gt=Pn;break;case"focusout":tr="blur",Gt=Pn;break;case"beforeblur":case"afterblur":Gt=Pn;break;case"click":if(C.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Gt=_o;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Gt=bo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Gt=He;break;case Wd:case Kd:case Fl:Gt=ji;break;case wa:Gt=vn;break;case"scroll":Gt=Su;break;case"wheel":Gt=Yr;break;case"copy":case"cut":case"paste":Gt=Xo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Gt=_e}var rr=(g&4)!==0,Jn=!rr&&f==="scroll",Fe=rr?tt!==null?tt+"Capture":null:tt;rr=[];for(var Ne=Ge,Le;Ne!==null;){Le=Ne;var Ct=Le.stateNode;if(Le.tag===5&&Ct!==null&&(Le=Ct,Fe!==null&&(Ct=yr(Ne,Fe),Ct!=null&&rr.push(sl(Ne,Ct,Le)))),Jn)break;Ne=Ne.return}0<rr.length&&(tt=new Gt(tt,tr,null,C,nt),vt.push({event:tt,listeners:rr}))}}if((g&7)===0){e:{if(tt=f==="mouseover"||f==="pointerover",Gt=f==="mouseout"||f==="pointerout",tt&&C!==wn&&(tr=C.relatedTarget||C.fromElement)&&(ta(tr)||tr[si]))break e;if((Gt||tt)&&(tt=nt.window===nt?nt:(tt=nt.ownerDocument)?tt.defaultView||tt.parentWindow:window,Gt?(tr=C.relatedTarget||C.toElement,Gt=Ge,tr=tr?ta(tr):null,tr!==null&&(Jn=Tn(tr),tr!==Jn||tr.tag!==5&&tr.tag!==6)&&(tr=null)):(Gt=null,tr=Ge),Gt!==tr)){if(rr=_o,Ct="onMouseLeave",Fe="onMouseEnter",Ne="mouse",(f==="pointerout"||f==="pointerover")&&(rr=_e,Ct="onPointerLeave",Fe="onPointerEnter",Ne="pointer"),Jn=Gt==null?tt:Mr(Gt),Le=tr==null?tt:Mr(tr),tt=new rr(Ct,Ne+"leave",Gt,C,nt),tt.target=Jn,tt.relatedTarget=Le,Ct=null,ta(nt)===Ge&&(rr=new rr(Fe,Ne+"enter",tr,C,nt),rr.target=Le,rr.relatedTarget=Jn,Ct=rr),Jn=Ct,Gt&&tr)t:{for(rr=Gt,Fe=tr,Ne=0,Le=rr;Le;Le=il(Le))Ne++;for(Le=0,Ct=Fe;Ct;Ct=il(Ct))Le++;for(;0<Ne-Le;)rr=il(rr),Ne--;for(;0<Le-Ne;)Fe=il(Fe),Le--;for(;Ne--;){if(rr===Fe||Fe!==null&&rr===Fe.alternate)break t;rr=il(rr),Fe=il(Fe)}rr=null}else rr=null;Gt!==null&&ns(vt,tt,Gt,rr,!1),tr!==null&&Jn!==null&&ns(vt,Jn,tr,rr,!0)}}e:{if(tt=Ge?Mr(Ge):window,Gt=tt.nodeName&&tt.nodeName.toLowerCase(),Gt==="select"||Gt==="input"&&tt.type==="file")var sr=Wf;else if(Tu(tt))if(wo)sr=Me;else{sr=Zf;var mr=Kf}else(Gt=tt.nodeName)&&Gt.toLowerCase()==="input"&&(tt.type==="checkbox"||tt.type==="radio")&&(sr=tl);if(sr&&(sr=sr(f,Ge))){Lc(vt,sr,C,nt);break e}mr&&mr(f,tt,Ge),f==="focusout"&&(mr=tt._wrapperState)&&mr.controlled&&tt.type==="number"&&lr(tt,"number",tt.value)}switch(mr=Ge?Mr(Ge):window,f){case"focusin":(Tu(mr)||mr.contentEditable==="true")&&(Ea=mr,Vc=Ge,Qi=null);break;case"focusout":Qi=Vc=Ea=null;break;case"mousedown":rl=!0;break;case"contextmenu":case"mouseup":case"dragend":rl=!1,Ol(vt,C,nt);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":Ol(vt,C,nt)}var hr;if(Kn)e:{switch(f){case"compositionstart":var wr="onCompositionStart";break e;case"compositionend":wr="onCompositionEnd";break e;case"compositionupdate":wr="onCompositionUpdate";break e}wr=void 0}else Qo?Ud(f,C)&&(wr="onCompositionEnd"):f==="keydown"&&C.keyCode===229&&(wr="onCompositionStart");wr&&(qa&&C.locale!=="ko"&&(Qo||wr!=="onCompositionStart"?wr==="onCompositionEnd"&&Qo&&(hr=Ko()):(Rn=nt,Ga="value"in Rn?Rn.value:Rn.textContent,Qo=!0)),mr=Ou(Ge,wr),0<mr.length&&(wr=new jl(wr,f,null,C,nt),vt.push({event:wr,listeners:mr}),hr?wr.data=hr:(hr=Gd(C),hr!==null&&(wr.data=hr)))),(hr=Ws?el(f,C):zf(f,C))&&(Ge=Ou(Ge,"onBeforeInput"),0<Ge.length&&(nt=new jl("onBeforeInput","beforeinput",null,C,nt),vt.push({event:nt,listeners:Ge}),nt.data=hr))}Xd(vt,g)})}function sl(f,g,C){return{instance:f,listener:g,currentTarget:C}}function Ou(f,g){for(var C=g+"Capture",V=[];f!==null;){var J=f,se=J.stateNode;J.tag===5&&se!==null&&(J=se,se=yr(f,C),se!=null&&V.unshift(sl(f,se,J)),se=yr(f,g),se!=null&&V.push(sl(f,se,J))),f=f.return}return V}function il(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5);return f||null}function ns(f,g,C,V,J){for(var se=g._reactName,ve=[];C!==null&&C!==V;){var we=C,Ie=we.alternate,Ge=we.stateNode;if(Ie!==null&&Ie===V)break;we.tag===5&&Ge!==null&&(we=Ge,J?(Ie=yr(C,se),Ie!=null&&ve.unshift(sl(C,Ie,we))):J||(Ie=yr(C,se),Ie!=null&&ve.push(sl(C,Ie,we)))),C=C.return}ve.length!==0&&f.push({event:g,listeners:ve})}var Is=/\r\n?/g,Yf=/\u0000|\uFFFD/g;function Yd(f){return(typeof f=="string"?f:""+f).replace(Is,`
`).replace(Yf,"")}function Bl(f,g,C){if(g=Yd(g),Yd(f)!==g&&C)throw Error(r(425))}function $u(){}var Ul=null,Po=null;function Gl(f,g){return f==="textarea"||f==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var Za=typeof setTimeout=="function"?setTimeout:void 0,zl=typeof clearTimeout=="function"?clearTimeout:void 0,al=typeof Promise=="function"?Promise:void 0,Fu=typeof queueMicrotask=="function"?queueMicrotask:typeof al<"u"?function(f){return al.resolve(null).then(f).catch(ol)}:Za;function ol(f){setTimeout(function(){throw f})}function zc(f,g){var C=g,V=0;do{var J=C.nextSibling;if(f.removeChild(C),J&&J.nodeType===8)if(C=J.data,C==="/$"){if(V===0){f.removeChild(J),Zr(g);return}V--}else C!=="$"&&C!=="$?"&&C!=="$!"||V++;C=J}while(C);Zr(g)}function Xa(f){for(;f!=null;f=f.nextSibling){var g=f.nodeType;if(g===1||g===3)break;if(g===8){if(g=f.data,g==="$"||g==="$!"||g==="$?")break;if(g==="/$")return null}}return f}function Jd(f){f=f.previousSibling;for(var g=0;f;){if(f.nodeType===8){var C=f.data;if(C==="$"||C==="$!"||C==="$?"){if(g===0)return f;g--}else C==="/$"&&g++}f=f.previousSibling}return null}var ll=Math.random().toString(36).slice(2),ea="__reactFiber$"+ll,Ya="__reactProps$"+ll,si="__reactContainer$"+ll,Lu="__reactEvents$"+ll,xe="__reactListeners$"+ll,ul="__reactHandles$"+ll;function ta(f){var g=f[ea];if(g)return g;for(var C=f.parentNode;C;){if(g=C[si]||C[ea]){if(C=g.alternate,g.child!==null||C!==null&&C.child!==null)for(f=Jd(f);f!==null;){if(C=f[ea])return C;f=Jd(f)}return g}f=C,C=f.parentNode}return null}function ks(f){return f=f[ea]||f[si],!f||f.tag!==5&&f.tag!==6&&f.tag!==13&&f.tag!==3?null:f}function Mr(f){if(f.tag===5||f.tag===6)return f.stateNode;throw Error(r(33))}function Vu(f){return f[Ya]||null}var Hc=[],cl=-1;function Ks(f){return{current:f}}function Fn(f){0>cl||(f.current=Hc[cl],Hc[cl]=null,cl--)}function On(f,g){cl++,Hc[cl]=f.current,f.current=g}var Ja={},Ns=Ks(Ja),Zs=Ks(!1),Ls=Ja;function dl(f,g){var C=f.type.contextTypes;if(!C)return Ja;var V=f.stateNode;if(V&&V.__reactInternalMemoizedUnmaskedChildContext===g)return V.__reactInternalMemoizedMaskedChildContext;var J={},se;for(se in C)J[se]=g[se];return V&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=g,f.__reactInternalMemoizedMaskedChildContext=J),J}function Xs(f){return f=f.childContextTypes,f!=null}function Bu(){Fn(Zs),Fn(Ns)}function Qd(f,g,C){if(Ns.current!==Ja)throw Error(r(168));On(Ns,g),On(Zs,C)}function ef(f,g,C){var V=f.stateNode;if(g=g.childContextTypes,typeof V.getChildContext!="function")return C;V=V.getChildContext();for(var J in V)if(!(J in g))throw Error(r(108,Ve(f)||"Unknown",J));return he({},C,V)}function gi(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||Ja,Ls=Ns.current,On(Ns,f),On(Zs,Zs.current),!0}function tf(f,g,C){var V=f.stateNode;if(!V)throw Error(r(169));C?(f=ef(f,g,Ls),V.__reactInternalMemoizedMergedChildContext=f,Fn(Zs),Fn(Ns),On(Ns,f)):Fn(Zs),On(Zs,C)}var Ra=null,Uu=!1,qc=!1;function rf(f){Ra===null?Ra=[f]:Ra.push(f)}function To(f){Uu=!0,rf(f)}function Qa(){if(!qc&&Ra!==null){qc=!0;var f=0,g=Gr;try{var C=Ra;for(Gr=1;f<C.length;f++){var V=C[f];do V=V(!0);while(V!==null)}Ra=null,Uu=!1}catch(J){throw Ra!==null&&(Ra=Ra.slice(f+1)),Se(kt,Qa),J}finally{Gr=g,qc=!1}}return null}var fl=[],Ds=0,Gu=null,zu=0,yi=[],vi=0,Ao=null,ra=1,na="";function Co(f,g){fl[Ds++]=zu,fl[Ds++]=Gu,Gu=f,zu=g}function nf(f,g,C){yi[vi++]=ra,yi[vi++]=na,yi[vi++]=Ao,Ao=f;var V=ra;f=na;var J=32-ls(V)-1;V&=~(1<<J),C+=1;var se=32-ls(g)+J;if(30<se){var ve=J-J%5;se=(V&(1<<ve)-1).toString(32),V>>=ve,J-=ve,ra=1<<32-ls(g)+J|C<<J|V,na=se+f}else ra=1<<se|C<<J|V,na=f}function Hl(f){f.return!==null&&(Co(f,1),nf(f,1,0))}function Io(f){for(;f===Gu;)Gu=fl[--Ds],fl[Ds]=null,zu=fl[--Ds],fl[Ds]=null;for(;f===Ao;)Ao=yi[--vi],yi[vi]=null,na=yi[--vi],yi[vi]=null,ra=yi[--vi],yi[vi]=null}var js=null,ii=null,Ln=!1,Oi=null;function sa(f,g){var C=Ri(5,null,null,0);C.elementType="DELETED",C.stateNode=g,C.return=f,g=f.deletions,g===null?(f.deletions=[C],f.flags|=16):g.push(C)}function Hu(f,g){switch(f.tag){case 5:var C=f.type;return g=g.nodeType!==1||C.toLowerCase()!==g.nodeName.toLowerCase()?null:g,g!==null?(f.stateNode=g,js=f,ii=Xa(g.firstChild),!0):!1;case 6:return g=f.pendingProps===""||g.nodeType!==3?null:g,g!==null?(f.stateNode=g,js=f,ii=null,!0):!1;case 13:return g=g.nodeType!==8?null:g,g!==null?(C=Ao!==null?{id:ra,overflow:na}:null,f.memoizedState={dehydrated:g,treeContext:C,retryLane:1073741824},C=Ri(18,null,null,0),C.stateNode=g,C.return=f,f.child=C,js=f,ii=null,!0):!1;default:return!1}}function Pa(f){return(f.mode&1)!==0&&(f.flags&128)===0}function Ys(f){if(Ln){var g=ii;if(g){var C=g;if(!Hu(f,g)){if(Pa(f))throw Error(r(418));g=Xa(C.nextSibling);var V=js;g&&Hu(f,g)?sa(V,C):(f.flags=f.flags&-4097|2,Ln=!1,js=f)}}else{if(Pa(f))throw Error(r(418));f.flags=f.flags&-4097|2,Ln=!1,js=f}}}function sf(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;js=f}function ql(f){if(f!==js)return!1;if(!Ln)return sf(f),Ln=!0,!1;var g;if((g=f.tag!==3)&&!(g=f.tag!==5)&&(g=f.type,g=g!=="head"&&g!=="body"&&!Gl(f.type,f.memoizedProps)),g&&(g=ii)){if(Pa(f))throw Wc(),Error(r(418));for(;g;)sa(f,g),g=Xa(g.nextSibling)}if(sf(f),f.tag===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(r(317));e:{for(f=f.nextSibling,g=0;f;){if(f.nodeType===8){var C=f.data;if(C==="/$"){if(g===0){ii=Xa(f.nextSibling);break e}g--}else C!=="$"&&C!=="$!"&&C!=="$?"||g++}f=f.nextSibling}ii=null}}else ii=js?Xa(f.stateNode.nextSibling):null;return!0}function Wc(){for(var f=ii;f;)f=Xa(f.nextSibling)}function ia(){ii=js=null,Ln=!1}function aa(f){Oi===null?Oi=[f]:Oi.push(f)}var af=I.ReactCurrentBatchConfig;function Wl(f,g,C){if(f=C.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(C._owner){if(C=C._owner,C){if(C.tag!==1)throw Error(r(309));var V=C.stateNode}if(!V)throw Error(r(147,f));var J=V,se=""+f;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===se?g.ref:(g=function(ve){var we=J.refs;ve===null?delete we[se]:we[se]=ve},g._stringRef=se,g)}if(typeof f!="string")throw Error(r(284));if(!C._owner)throw Error(r(290,f))}return f}function ko(f,g){throw f=Object.prototype.toString.call(g),Error(r(31,f==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":f))}function of(f){var g=f._init;return g(f._payload)}function Kc(f){function g(Fe,Ne){if(f){var Le=Fe.deletions;Le===null?(Fe.deletions=[Ne],Fe.flags|=16):Le.push(Ne)}}function C(Fe,Ne){if(!f)return null;for(;Ne!==null;)g(Fe,Ne),Ne=Ne.sibling;return null}function V(Fe,Ne){for(Fe=new Map;Ne!==null;)Ne.key!==null?Fe.set(Ne.key,Ne):Fe.set(Ne.index,Ne),Ne=Ne.sibling;return Fe}function J(Fe,Ne){return Fe=Gi(Fe,Ne),Fe.index=0,Fe.sibling=null,Fe}function se(Fe,Ne,Le){return Fe.index=Le,f?(Le=Fe.alternate,Le!==null?(Le=Le.index,Le<Ne?(Fe.flags|=2,Ne):Le):(Fe.flags|=2,Ne)):(Fe.flags|=1048576,Ne)}function ve(Fe){return f&&Fe.alternate===null&&(Fe.flags|=2),Fe}function we(Fe,Ne,Le,Ct){return Ne===null||Ne.tag!==6?(Ne=Md(Le,Fe.mode,Ct),Ne.return=Fe,Ne):(Ne=J(Ne,Le),Ne.return=Fe,Ne)}function Ie(Fe,Ne,Le,Ct){var sr=Le.type;return sr===W?nt(Fe,Ne,Le.props.children,Ct,Le.key):Ne!==null&&(Ne.elementType===sr||typeof sr=="object"&&sr!==null&&sr.$$typeof===te&&of(sr)===Ne.type)?(Ct=J(Ne,Le.props),Ct.ref=Wl(Fe,Ne,Le),Ct.return=Fe,Ct):(Ct=Tc(Le.type,Le.key,Le.props,null,Fe.mode,Ct),Ct.ref=Wl(Fe,Ne,Le),Ct.return=Fe,Ct)}function Ge(Fe,Ne,Le,Ct){return Ne===null||Ne.tag!==4||Ne.stateNode.containerInfo!==Le.containerInfo||Ne.stateNode.implementation!==Le.implementation?(Ne=Od(Le,Fe.mode,Ct),Ne.return=Fe,Ne):(Ne=J(Ne,Le.children||[]),Ne.return=Fe,Ne)}function nt(Fe,Ne,Le,Ct,sr){return Ne===null||Ne.tag!==7?(Ne=Uo(Le,Fe.mode,Ct,sr),Ne.return=Fe,Ne):(Ne=J(Ne,Le),Ne.return=Fe,Ne)}function vt(Fe,Ne,Le){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number")return Ne=Md(""+Ne,Fe.mode,Le),Ne.return=Fe,Ne;if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case j:return Le=Tc(Ne.type,Ne.key,Ne.props,null,Fe.mode,Le),Le.ref=Wl(Fe,null,Ne),Le.return=Fe,Le;case K:return Ne=Od(Ne,Fe.mode,Le),Ne.return=Fe,Ne;case te:var Ct=Ne._init;return vt(Fe,Ct(Ne._payload),Le)}if(ir(Ne)||Y(Ne))return Ne=Uo(Ne,Fe.mode,Le,null),Ne.return=Fe,Ne;ko(Fe,Ne)}return null}function tt(Fe,Ne,Le,Ct){var sr=Ne!==null?Ne.key:null;if(typeof Le=="string"&&Le!==""||typeof Le=="number")return sr!==null?null:we(Fe,Ne,""+Le,Ct);if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case j:return Le.key===sr?Ie(Fe,Ne,Le,Ct):null;case K:return Le.key===sr?Ge(Fe,Ne,Le,Ct):null;case te:return sr=Le._init,tt(Fe,Ne,sr(Le._payload),Ct)}if(ir(Le)||Y(Le))return sr!==null?null:nt(Fe,Ne,Le,Ct,null);ko(Fe,Le)}return null}function Gt(Fe,Ne,Le,Ct,sr){if(typeof Ct=="string"&&Ct!==""||typeof Ct=="number")return Fe=Fe.get(Le)||null,we(Ne,Fe,""+Ct,sr);if(typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case j:return Fe=Fe.get(Ct.key===null?Le:Ct.key)||null,Ie(Ne,Fe,Ct,sr);case K:return Fe=Fe.get(Ct.key===null?Le:Ct.key)||null,Ge(Ne,Fe,Ct,sr);case te:var mr=Ct._init;return Gt(Fe,Ne,Le,mr(Ct._payload),sr)}if(ir(Ct)||Y(Ct))return Fe=Fe.get(Le)||null,nt(Ne,Fe,Ct,sr,null);ko(Ne,Ct)}return null}function tr(Fe,Ne,Le,Ct){for(var sr=null,mr=null,hr=Ne,wr=Ne=0,xs=null;hr!==null&&wr<Le.length;wr++){hr.index>wr?(xs=hr,hr=null):xs=hr.sibling;var mn=tt(Fe,hr,Le[wr],Ct);if(mn===null){hr===null&&(hr=xs);break}f&&hr&&mn.alternate===null&&g(Fe,hr),Ne=se(mn,Ne,wr),mr===null?sr=mn:mr.sibling=mn,mr=mn,hr=xs}if(wr===Le.length)return C(Fe,hr),Ln&&Co(Fe,wr),sr;if(hr===null){for(;wr<Le.length;wr++)hr=vt(Fe,Le[wr],Ct),hr!==null&&(Ne=se(hr,Ne,wr),mr===null?sr=hr:mr.sibling=hr,mr=hr);return Ln&&Co(Fe,wr),sr}for(hr=V(Fe,hr);wr<Le.length;wr++)xs=Gt(hr,Fe,wr,Le[wr],Ct),xs!==null&&(f&&xs.alternate!==null&&hr.delete(xs.key===null?wr:xs.key),Ne=se(xs,Ne,wr),mr===null?sr=xs:mr.sibling=xs,mr=xs);return f&&hr.forEach(function(fo){return g(Fe,fo)}),Ln&&Co(Fe,wr),sr}function rr(Fe,Ne,Le,Ct){var sr=Y(Le);if(typeof sr!="function")throw Error(r(150));if(Le=sr.call(Le),Le==null)throw Error(r(151));for(var mr=sr=null,hr=Ne,wr=Ne=0,xs=null,mn=Le.next();hr!==null&&!mn.done;wr++,mn=Le.next()){hr.index>wr?(xs=hr,hr=null):xs=hr.sibling;var fo=tt(Fe,hr,mn.value,Ct);if(fo===null){hr===null&&(hr=xs);break}f&&hr&&fo.alternate===null&&g(Fe,hr),Ne=se(fo,Ne,wr),mr===null?sr=fo:mr.sibling=fo,mr=fo,hr=xs}if(mn.done)return C(Fe,hr),Ln&&Co(Fe,wr),sr;if(hr===null){for(;!mn.done;wr++,mn=Le.next())mn=vt(Fe,mn.value,Ct),mn!==null&&(Ne=se(mn,Ne,wr),mr===null?sr=mn:mr.sibling=mn,mr=mn);return Ln&&Co(Fe,wr),sr}for(hr=V(Fe,hr);!mn.done;wr++,mn=Le.next())mn=Gt(hr,Fe,wr,mn.value,Ct),mn!==null&&(f&&mn.alternate!==null&&hr.delete(mn.key===null?wr:mn.key),Ne=se(mn,Ne,wr),mr===null?sr=mn:mr.sibling=mn,mr=mn);return f&&hr.forEach(function(xh){return g(Fe,xh)}),Ln&&Co(Fe,wr),sr}function Jn(Fe,Ne,Le,Ct){if(typeof Le=="object"&&Le!==null&&Le.type===W&&Le.key===null&&(Le=Le.props.children),typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case j:e:{for(var sr=Le.key,mr=Ne;mr!==null;){if(mr.key===sr){if(sr=Le.type,sr===W){if(mr.tag===7){C(Fe,mr.sibling),Ne=J(mr,Le.props.children),Ne.return=Fe,Fe=Ne;break e}}else if(mr.elementType===sr||typeof sr=="object"&&sr!==null&&sr.$$typeof===te&&of(sr)===mr.type){C(Fe,mr.sibling),Ne=J(mr,Le.props),Ne.ref=Wl(Fe,mr,Le),Ne.return=Fe,Fe=Ne;break e}C(Fe,mr);break}else g(Fe,mr);mr=mr.sibling}Le.type===W?(Ne=Uo(Le.props.children,Fe.mode,Ct,Le.key),Ne.return=Fe,Fe=Ne):(Ct=Tc(Le.type,Le.key,Le.props,null,Fe.mode,Ct),Ct.ref=Wl(Fe,Ne,Le),Ct.return=Fe,Fe=Ct)}return ve(Fe);case K:e:{for(mr=Le.key;Ne!==null;){if(Ne.key===mr)if(Ne.tag===4&&Ne.stateNode.containerInfo===Le.containerInfo&&Ne.stateNode.implementation===Le.implementation){C(Fe,Ne.sibling),Ne=J(Ne,Le.children||[]),Ne.return=Fe,Fe=Ne;break e}else{C(Fe,Ne);break}else g(Fe,Ne);Ne=Ne.sibling}Ne=Od(Le,Fe.mode,Ct),Ne.return=Fe,Fe=Ne}return ve(Fe);case te:return mr=Le._init,Jn(Fe,Ne,mr(Le._payload),Ct)}if(ir(Le))return tr(Fe,Ne,Le,Ct);if(Y(Le))return rr(Fe,Ne,Le,Ct);ko(Fe,Le)}return typeof Le=="string"&&Le!==""||typeof Le=="number"?(Le=""+Le,Ne!==null&&Ne.tag===6?(C(Fe,Ne.sibling),Ne=J(Ne,Le),Ne.return=Fe,Fe=Ne):(C(Fe,Ne),Ne=Md(Le,Fe.mode,Ct),Ne.return=Fe,Fe=Ne),ve(Fe)):C(Fe,Ne)}return Jn}var Zn=Kc(!0),qu=Kc(!1),Kl=Ks(null),ai=null,eo=null,hl=null;function Ta(){hl=eo=ai=null}function Wu(f){var g=Kl.current;Fn(Kl),f._currentValue=g}function Es(f,g,C){for(;f!==null;){var V=f.alternate;if((f.childLanes&g)!==g?(f.childLanes|=g,V!==null&&(V.childLanes|=g)):V!==null&&(V.childLanes&g)!==g&&(V.childLanes|=g),f===C)break;f=f.return}}function to(f,g){ai=f,hl=eo=null,f=f.dependencies,f!==null&&f.firstContext!==null&&((f.lanes&g)!==0&&(Bs=!0),f.firstContext=null)}function xi(f){var g=f._currentValue;if(hl!==f)if(f={context:f,memoizedValue:g,next:null},eo===null){if(ai===null)throw Error(r(308));eo=f,ai.dependencies={lanes:0,firstContext:f}}else eo=eo.next=f;return g}var No=null;function Zc(f){No===null?No=[f]:No.push(f)}function Ku(f,g,C,V){var J=g.interleaved;return J===null?(C.next=C,Zc(g)):(C.next=J.next,J.next=C),g.interleaved=C,Aa(f,V)}function Aa(f,g){f.lanes|=g;var C=f.alternate;for(C!==null&&(C.lanes|=g),C=f,f=f.return;f!==null;)f.childLanes|=g,C=f.alternate,C!==null&&(C.childLanes|=g),C=f,f=f.return;return C.tag===3?C.stateNode:null}var _i=!1;function Zu(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lf(f,g){f=f.updateQueue,g.updateQueue===f&&(g.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function Ca(f,g){return{eventTime:f,lane:g,tag:0,payload:null,callback:null,next:null}}function bi(f,g,C){var V=f.updateQueue;if(V===null)return null;if(V=V.shared,(dn&2)!==0){var J=V.pending;return J===null?g.next=g:(g.next=J.next,J.next=g),V.pending=g,Aa(f,C)}return J=V.interleaved,J===null?(g.next=g,Zc(V)):(g.next=J.next,J.next=g),V.interleaved=g,Aa(f,C)}function Xu(f,g,C){if(g=g.updateQueue,g!==null&&(g=g.shared,(C&4194240)!==0)){var V=g.lanes;V&=f.pendingLanes,C|=V,g.lanes=C,Xi(f,C)}}function uf(f,g){var C=f.updateQueue,V=f.alternate;if(V!==null&&(V=V.updateQueue,C===V)){var J=null,se=null;if(C=C.firstBaseUpdate,C!==null){do{var ve={eventTime:C.eventTime,lane:C.lane,tag:C.tag,payload:C.payload,callback:C.callback,next:null};se===null?J=se=ve:se=se.next=ve,C=C.next}while(C!==null);se===null?J=se=g:se=se.next=g}else J=se=g;C={baseState:V.baseState,firstBaseUpdate:J,lastBaseUpdate:se,shared:V.shared,effects:V.effects},f.updateQueue=C;return}f=C.lastBaseUpdate,f===null?C.firstBaseUpdate=g:f.next=g,C.lastBaseUpdate=g}function pl(f,g,C,V){var J=f.updateQueue;_i=!1;var se=J.firstBaseUpdate,ve=J.lastBaseUpdate,we=J.shared.pending;if(we!==null){J.shared.pending=null;var Ie=we,Ge=Ie.next;Ie.next=null,ve===null?se=Ge:ve.next=Ge,ve=Ie;var nt=f.alternate;nt!==null&&(nt=nt.updateQueue,we=nt.lastBaseUpdate,we!==ve&&(we===null?nt.firstBaseUpdate=Ge:we.next=Ge,nt.lastBaseUpdate=Ie))}if(se!==null){var vt=J.baseState;ve=0,nt=Ge=Ie=null,we=se;do{var tt=we.lane,Gt=we.eventTime;if((V&tt)===tt){nt!==null&&(nt=nt.next={eventTime:Gt,lane:0,tag:we.tag,payload:we.payload,callback:we.callback,next:null});e:{var tr=f,rr=we;switch(tt=g,Gt=C,rr.tag){case 1:if(tr=rr.payload,typeof tr=="function"){vt=tr.call(Gt,vt,tt);break e}vt=tr;break e;case 3:tr.flags=tr.flags&-65537|128;case 0:if(tr=rr.payload,tt=typeof tr=="function"?tr.call(Gt,vt,tt):tr,tt==null)break e;vt=he({},vt,tt);break e;case 2:_i=!0}}we.callback!==null&&we.lane!==0&&(f.flags|=64,tt=J.effects,tt===null?J.effects=[we]:tt.push(we))}else Gt={eventTime:Gt,lane:tt,tag:we.tag,payload:we.payload,callback:we.callback,next:null},nt===null?(Ge=nt=Gt,Ie=vt):nt=nt.next=Gt,ve|=tt;if(we=we.next,we===null){if(we=J.shared.pending,we===null)break;tt=we,we=tt.next,tt.next=null,J.lastBaseUpdate=tt,J.shared.pending=null}}while(!0);if(nt===null&&(Ie=vt),J.baseState=Ie,J.firstBaseUpdate=Ge,J.lastBaseUpdate=nt,g=J.shared.interleaved,g!==null){J=g;do ve|=J.lane,J=J.next;while(J!==g)}else se===null&&(J.shared.lanes=0);ao|=ve,f.lanes=ve,f.memoizedState=vt}}function Xc(f,g,C){if(f=g.effects,g.effects=null,f!==null)for(g=0;g<f.length;g++){var V=f[g],J=V.callback;if(J!==null){if(V.callback=null,V=C,typeof J!="function")throw Error(r(191,J));J.call(V)}}}var Zl={},oa=Ks(Zl),Xl=Ks(Zl),ml=Ks(Zl);function Ia(f){if(f===Zl)throw Error(r(174));return f}function Yc(f,g){switch(On(ml,g),On(Xl,f),On(oa,Zl),f=g.nodeType,f){case 9:case 11:g=(g=g.documentElement)?g.namespaceURI:dr(null,"");break;default:f=f===8?g.parentNode:g,g=f.namespaceURI||null,f=f.tagName,g=dr(g,f)}Fn(oa),On(oa,g)}function ro(){Fn(oa),Fn(Xl),Fn(ml)}function Jc(f){Ia(ml.current);var g=Ia(oa.current),C=dr(g,f.type);g!==C&&(On(Xl,f),On(oa,C))}function Yu(f){Xl.current===f&&(Fn(oa),Fn(Xl))}var Gn=Ks(0);function Do(f){for(var g=f;g!==null;){if(g.tag===13){var C=g.memoizedState;if(C!==null&&(C=C.dehydrated,C===null||C.data==="$?"||C.data==="$!"))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===f)break;for(;g.sibling===null;){if(g.return===null||g.return===f)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var Qc=[];function Ju(){for(var f=0;f<Qc.length;f++)Qc[f]._workInProgressVersionPrimary=null;Qc.length=0}var Yl=I.ReactCurrentDispatcher,ed=I.ReactCurrentBatchConfig,no=0,qn=null,Yn=null,ds=null,gl=!1,Jl=!1,jo=0,Vr=0;function Ms(){throw Error(r(321))}function td(f,g){if(g===null)return!1;for(var C=0;C<g.length&&C<f.length;C++)if(!Be(f[C],g[C]))return!1;return!0}function Mo(f,g,C,V,J,se){if(no=se,qn=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,Yl.current=f===null||f.memoizedState===null?Qf:ic,f=C(V,J),Jl){se=0;do{if(Jl=!1,jo=0,25<=se)throw Error(r(301));se+=1,ds=Yn=null,g.updateQueue=null,Yl.current=_l,f=C(V,J)}while(Jl)}if(Yl.current=sc,g=Yn!==null&&Yn.next!==null,no=0,ds=Yn=qn=null,gl=!1,g)throw Error(r(300));return f}function Qu(){var f=jo!==0;return jo=0,f}function la(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ds===null?qn.memoizedState=ds=f:ds=ds.next=f,ds}function Ei(){if(Yn===null){var f=qn.alternate;f=f!==null?f.memoizedState:null}else f=Yn.next;var g=ds===null?qn.memoizedState:ds.next;if(g!==null)ds=g,Yn=f;else{if(f===null)throw Error(r(310));Yn=f,f={memoizedState:Yn.memoizedState,baseState:Yn.baseState,baseQueue:Yn.baseQueue,queue:Yn.queue,next:null},ds===null?qn.memoizedState=ds=f:ds=ds.next=f}return ds}function Os(f,g){return typeof g=="function"?g(f):g}function rd(f){var g=Ei(),C=g.queue;if(C===null)throw Error(r(311));C.lastRenderedReducer=f;var V=Yn,J=V.baseQueue,se=C.pending;if(se!==null){if(J!==null){var ve=J.next;J.next=se.next,se.next=ve}V.baseQueue=J=se,C.pending=null}if(J!==null){se=J.next,V=V.baseState;var we=ve=null,Ie=null,Ge=se;do{var nt=Ge.lane;if((no&nt)===nt)Ie!==null&&(Ie=Ie.next={lane:0,action:Ge.action,hasEagerState:Ge.hasEagerState,eagerState:Ge.eagerState,next:null}),V=Ge.hasEagerState?Ge.eagerState:f(V,Ge.action);else{var vt={lane:nt,action:Ge.action,hasEagerState:Ge.hasEagerState,eagerState:Ge.eagerState,next:null};Ie===null?(we=Ie=vt,ve=V):Ie=Ie.next=vt,qn.lanes|=nt,ao|=nt}Ge=Ge.next}while(Ge!==null&&Ge!==se);Ie===null?ve=V:Ie.next=we,Be(V,g.memoizedState)||(Bs=!0),g.memoizedState=V,g.baseState=ve,g.baseQueue=Ie,C.lastRenderedState=V}if(f=C.interleaved,f!==null){J=f;do se=J.lane,qn.lanes|=se,ao|=se,J=J.next;while(J!==f)}else J===null&&(C.lanes=0);return[g.memoizedState,C.dispatch]}function yl(f){var g=Ei(),C=g.queue;if(C===null)throw Error(r(311));C.lastRenderedReducer=f;var V=C.dispatch,J=C.pending,se=g.memoizedState;if(J!==null){C.pending=null;var ve=J=J.next;do se=f(se,ve.action),ve=ve.next;while(ve!==J);Be(se,g.memoizedState)||(Bs=!0),g.memoizedState=se,g.baseQueue===null&&(g.baseState=se),C.lastRenderedState=se}return[se,V]}function ec(){}function nd(f,g){var C=qn,V=Ei(),J=g(),se=!Be(V.memoizedState,J);if(se&&(V.memoizedState=J,Bs=!0),V=V.queue,ua(ka.bind(null,C,V,f),[f]),V.getSnapshot!==g||se||ds!==null&&ds.memoizedState.tag&1){if(C.flags|=2048,vl(9,Js.bind(null,C,V,J,g),void 0,null),vs===null)throw Error(r(349));(no&30)!==0||sd(C,g,J)}return J}function sd(f,g,C){f.flags|=16384,f={getSnapshot:g,value:C},g=qn.updateQueue,g===null?(g={lastEffect:null,stores:null},qn.updateQueue=g,g.stores=[f]):(C=g.stores,C===null?g.stores=[f]:C.push(f))}function Js(f,g,C,V){g.value=C,g.getSnapshot=V,tc(g)&&ad(f)}function ka(f,g,C){return C(function(){tc(g)&&ad(f)})}function tc(f){var g=f.getSnapshot;f=f.value;try{var C=g();return!Be(f,C)}catch{return!0}}function ad(f){var g=Aa(f,1);g!==null&&Ui(g,f,1,-1)}function Ql(f){var g=la();return typeof f=="function"&&(f=f()),g.memoizedState=g.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Os,lastRenderedState:f},g.queue=f,f=f.dispatch=mf.bind(null,qn,f),[g.memoizedState,f]}function vl(f,g,C,V){return f={tag:f,create:g,destroy:C,deps:V,next:null},g=qn.updateQueue,g===null?(g={lastEffect:null,stores:null},qn.updateQueue=g,g.lastEffect=f.next=f):(C=g.lastEffect,C===null?g.lastEffect=f.next=f:(V=C.next,C.next=f,f.next=V,g.lastEffect=f)),f}function rc(){return Ei().memoizedState}function eu(f,g,C,V){var J=la();qn.flags|=f,J.memoizedState=vl(1|g,C,void 0,V===void 0?null:V)}function xl(f,g,C,V){var J=Ei();V=V===void 0?null:V;var se=void 0;if(Yn!==null){var ve=Yn.memoizedState;if(se=ve.destroy,V!==null&&td(V,ve.deps)){J.memoizedState=vl(g,C,se,V);return}}qn.flags|=f,J.memoizedState=vl(1|g,C,se,V)}function nc(f,g){return eu(8390656,8,f,g)}function ua(f,g){return xl(2048,8,f,g)}function cf(f,g){return xl(4,2,f,g)}function Na(f,g){return xl(4,4,f,g)}function od(f,g){if(typeof g=="function")return f=f(),g(f),function(){g(null)};if(g!=null)return f=f(),g.current=f,function(){g.current=null}}function ld(f,g,C){return C=C!=null?C.concat([f]):null,xl(4,4,od.bind(null,g,f),C)}function tu(){}function df(f,g){var C=Ei();g=g===void 0?null:g;var V=C.memoizedState;return V!==null&&g!==null&&td(g,V[1])?V[0]:(C.memoizedState=[f,g],f)}function ff(f,g){var C=Ei();g=g===void 0?null:g;var V=C.memoizedState;return V!==null&&g!==null&&td(g,V[1])?V[0]:(f=f(),C.memoizedState=[f,g],f)}function hf(f,g,C){return(no&21)===0?(f.baseState&&(f.baseState=!1,Bs=!0),f.memoizedState=C):(Be(C,g)||(C=Va(),qn.lanes|=C,ao|=C,f.baseState=!0),g)}function pf(f,g){var C=Gr;Gr=C!==0&&4>C?C:4,f(!0);var V=ed.transition;ed.transition={};try{f(!1),g()}finally{Gr=C,ed.transition=V}}function ud(){return Ei().memoizedState}function Jf(f,g,C){var V=uo(f);if(C={lane:V,action:C,hasEagerState:!1,eagerState:null,next:null},cd(f))Vs(g,C);else if(C=Ku(f,g,C,V),C!==null){var J=zs();Ui(C,f,V,J),$i(C,g,V)}}function mf(f,g,C){var V=uo(f),J={lane:V,action:C,hasEagerState:!1,eagerState:null,next:null};if(cd(f))Vs(g,J);else{var se=f.alternate;if(f.lanes===0&&(se===null||se.lanes===0)&&(se=g.lastRenderedReducer,se!==null))try{var ve=g.lastRenderedState,we=se(ve,C);if(J.hasEagerState=!0,J.eagerState=we,Be(we,ve)){var Ie=g.interleaved;Ie===null?(J.next=J,Zc(g)):(J.next=Ie.next,Ie.next=J),g.interleaved=J;return}}catch{}finally{}C=Ku(f,g,J,V),C!==null&&(J=zs(),Ui(C,f,V,J),$i(C,g,V))}}function cd(f){var g=f.alternate;return f===qn||g!==null&&g===qn}function Vs(f,g){Jl=gl=!0;var C=f.pending;C===null?g.next=g:(g.next=C.next,C.next=g),f.pending=g}function $i(f,g,C){if((C&4194240)!==0){var V=g.lanes;V&=f.pendingLanes,C|=V,g.lanes=C,Xi(f,C)}}var sc={readContext:xi,useCallback:Ms,useContext:Ms,useEffect:Ms,useImperativeHandle:Ms,useInsertionEffect:Ms,useLayoutEffect:Ms,useMemo:Ms,useReducer:Ms,useRef:Ms,useState:Ms,useDebugValue:Ms,useDeferredValue:Ms,useTransition:Ms,useMutableSource:Ms,useSyncExternalStore:Ms,useId:Ms,unstable_isNewReconciler:!1},Qf={readContext:xi,useCallback:function(f,g){return la().memoizedState=[f,g===void 0?null:g],f},useContext:xi,useEffect:nc,useImperativeHandle:function(f,g,C){return C=C!=null?C.concat([f]):null,eu(4194308,4,od.bind(null,g,f),C)},useLayoutEffect:function(f,g){return eu(4194308,4,f,g)},useInsertionEffect:function(f,g){return eu(4,2,f,g)},useMemo:function(f,g){var C=la();return g=g===void 0?null:g,f=f(),C.memoizedState=[f,g],f},useReducer:function(f,g,C){var V=la();return g=C!==void 0?C(g):g,V.memoizedState=V.baseState=g,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:g},V.queue=f,f=f.dispatch=Jf.bind(null,qn,f),[V.memoizedState,f]},useRef:function(f){var g=la();return f={current:f},g.memoizedState=f},useState:Ql,useDebugValue:tu,useDeferredValue:function(f){return la().memoizedState=f},useTransition:function(){var f=Ql(!1),g=f[0];return f=pf.bind(null,f[1]),la().memoizedState=f,[g,f]},useMutableSource:function(){},useSyncExternalStore:function(f,g,C){var V=qn,J=la();if(Ln){if(C===void 0)throw Error(r(407));C=C()}else{if(C=g(),vs===null)throw Error(r(349));(no&30)!==0||sd(V,g,C)}J.memoizedState=C;var se={value:C,getSnapshot:g};return J.queue=se,nc(ka.bind(null,V,se,f),[f]),V.flags|=2048,vl(9,Js.bind(null,V,se,C,g),void 0,null),C},useId:function(){var f=la(),g=vs.identifierPrefix;if(Ln){var C=na,V=ra;C=(V&~(1<<32-ls(V)-1)).toString(32)+C,g=":"+g+"R"+C,C=jo++,0<C&&(g+="H"+C.toString(32)),g+=":"}else C=Vr++,g=":"+g+"r"+C.toString(32)+":";return f.memoizedState=g},unstable_isNewReconciler:!1},ic={readContext:xi,useCallback:df,useContext:xi,useEffect:ua,useImperativeHandle:ld,useInsertionEffect:cf,useLayoutEffect:Na,useMemo:ff,useReducer:rd,useRef:rc,useState:function(){return rd(Os)},useDebugValue:tu,useDeferredValue:function(f){var g=Ei();return hf(g,Yn.memoizedState,f)},useTransition:function(){var f=rd(Os)[0],g=Ei().memoizedState;return[f,g]},useMutableSource:ec,useSyncExternalStore:nd,useId:ud,unstable_isNewReconciler:!1},_l={readContext:xi,useCallback:df,useContext:xi,useEffect:ua,useImperativeHandle:ld,useInsertionEffect:cf,useLayoutEffect:Na,useMemo:ff,useReducer:yl,useRef:rc,useState:function(){return yl(Os)},useDebugValue:tu,useDeferredValue:function(f){var g=Ei();return Yn===null?g.memoizedState=f:hf(g,Yn.memoizedState,f)},useTransition:function(){var f=yl(Os)[0],g=Ei().memoizedState;return[f,g]},useMutableSource:ec,useSyncExternalStore:nd,useId:ud,unstable_isNewReconciler:!1};function wi(f,g){if(f&&f.defaultProps){g=he({},g),f=f.defaultProps;for(var C in f)g[C]===void 0&&(g[C]=f[C]);return g}return g}function ac(f,g,C,V){g=f.memoizedState,C=C(V,g),C=C==null?g:he({},g,C),f.memoizedState=C,f.lanes===0&&(f.updateQueue.baseState=C)}var oc={isMounted:function(f){return(f=f._reactInternals)?Tn(f)===f:!1},enqueueSetState:function(f,g,C){f=f._reactInternals;var V=zs(),J=uo(f),se=Ca(V,J);se.payload=g,C!=null&&(se.callback=C),g=bi(f,se,J),g!==null&&(Ui(g,f,J,V),Xu(g,f,J))},enqueueReplaceState:function(f,g,C){f=f._reactInternals;var V=zs(),J=uo(f),se=Ca(V,J);se.tag=1,se.payload=g,C!=null&&(se.callback=C),g=bi(f,se,J),g!==null&&(Ui(g,f,J,V),Xu(g,f,J))},enqueueForceUpdate:function(f,g){f=f._reactInternals;var C=zs(),V=uo(f),J=Ca(C,V);J.tag=2,g!=null&&(J.callback=g),g=bi(f,J,V),g!==null&&(Ui(g,f,V,C),Xu(g,f,V))}};function dd(f,g,C,V,J,se,ve){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(V,se,ve):g.prototype&&g.prototype.isPureReactComponent?!Ut(C,V)||!Ut(J,se):!0}function Oo(f,g,C){var V=!1,J=Ja,se=g.contextType;return typeof se=="object"&&se!==null?se=xi(se):(J=Xs(g)?Ls:Ns.current,V=g.contextTypes,se=(V=V!=null)?dl(f,J):Ja),g=new g(C,se),f.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=oc,f.stateNode=g,g._reactInternals=f,V&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=J,f.__reactInternalMemoizedMaskedChildContext=se),g}function bl(f,g,C,V){f=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(C,V),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(C,V),g.state!==f&&oc.enqueueReplaceState(g,g.state,null)}function fd(f,g,C,V){var J=f.stateNode;J.props=C,J.state=f.memoizedState,J.refs={},Zu(f);var se=g.contextType;typeof se=="object"&&se!==null?J.context=xi(se):(se=Xs(g)?Ls:Ns.current,J.context=dl(f,se)),J.state=f.memoizedState,se=g.getDerivedStateFromProps,typeof se=="function"&&(ac(f,g,se,C),J.state=f.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof J.getSnapshotBeforeUpdate=="function"||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(g=J.state,typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount(),g!==J.state&&oc.enqueueReplaceState(J,J.state,null),pl(f,C,J,V),J.state=f.memoizedState),typeof J.componentDidMount=="function"&&(f.flags|=4194308)}function $o(f,g){try{var C="",V=g;do C+=je(V),V=V.return;while(V);var J=C}catch(se){J=`
Error generating stack: `+se.message+`
`+se.stack}return{value:f,source:g,stack:J,digest:null}}function lc(f,g,C){return{value:f,source:null,stack:C??null,digest:g??null}}function El(f,g){try{console.error(g.value)}catch(C){setTimeout(function(){throw C})}}var gf=typeof WeakMap=="function"?WeakMap:Map;function ru(f,g,C){C=Ca(-1,C),C.tag=3,C.payload={element:null};var V=g.value;return C.callback=function(){_c||(_c=!0,Ad=V),El(f,g)},C}function uc(f,g,C){C=Ca(-1,C),C.tag=3;var V=f.type.getDerivedStateFromError;if(typeof V=="function"){var J=g.value;C.payload=function(){return V(J)},C.callback=function(){El(f,g)}}var se=f.stateNode;return se!==null&&typeof se.componentDidCatch=="function"&&(C.callback=function(){El(f,g),typeof V!="function"&&(oo===null?oo=new Set([this]):oo.add(this));var ve=g.stack;this.componentDidCatch(g.value,{componentStack:ve!==null?ve:""})}),C}function nu(f,g,C){var V=f.pingCache;if(V===null){V=f.pingCache=new gf;var J=new Set;V.set(g,J)}else J=V.get(g),J===void 0&&(J=new Set,V.set(g,J));J.has(C)||(J.add(C),f=oh.bind(null,f,g,C),g.then(f,f))}function yf(f){do{var g;if((g=f.tag===13)&&(g=f.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return f;f=f.return}while(f!==null);return null}function hd(f,g,C,V,J){return(f.mode&1)===0?(f===g?f.flags|=65536:(f.flags|=128,C.flags|=131072,C.flags&=-52805,C.tag===1&&(C.alternate===null?C.tag=17:(g=Ca(-1,1),g.tag=2,bi(C,g,1))),C.lanes|=1),f):(f.flags|=65536,f.lanes=J,f)}var dc=I.ReactCurrentOwner,Bs=!1;function ws(f,g,C,V){g.child=f===null?qu(g,null,C,V):Zn(g,f.child,C,V)}function vf(f,g,C,V,J){C=C.render;var se=g.ref;return to(g,J),V=Mo(f,g,C,V,se,J),C=Qu(),f!==null&&!Bs?(g.updateQueue=f.updateQueue,g.flags&=-2053,f.lanes&=~J,Fi(f,g,J)):(Ln&&C&&Hl(g),g.flags|=1,ws(f,g,V,J),g.child)}function pd(f,g,C,V,J){if(f===null){var se=C.type;return typeof se=="function"&&!Pc(se)&&se.defaultProps===void 0&&C.compare===null&&C.defaultProps===void 0?(g.tag=15,g.type=se,ca(f,g,se,V,J)):(f=Tc(C.type,null,V,g,g.mode,J),f.ref=g.ref,f.return=g,g.child=f)}if(se=f.child,(f.lanes&J)===0){var ve=se.memoizedProps;if(C=C.compare,C=C!==null?C:Ut,C(ve,V)&&f.ref===g.ref)return Fi(f,g,J)}return g.flags|=1,f=Gi(se,V),f.ref=g.ref,f.return=g,g.child=f}function ca(f,g,C,V,J){if(f!==null){var se=f.memoizedProps;if(Ut(se,V)&&f.ref===g.ref)if(Bs=!1,g.pendingProps=V=se,(f.lanes&J)!==0)(f.flags&131072)!==0&&(Bs=!0);else return g.lanes=f.lanes,Fi(f,g,J)}return yd(f,g,C,V,J)}function md(f,g,C){var V=g.pendingProps,J=V.children,se=f!==null?f.memoizedState:null;if(V.mode==="hidden")if((g.mode&1)===0)g.memoizedState={baseLanes:0,cachePool:null,transitions:null},On(Pl,li),li|=C;else{if((C&1073741824)===0)return f=se!==null?se.baseLanes|C:C,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:f,cachePool:null,transitions:null},g.updateQueue=null,On(Pl,li),li|=f,null;g.memoizedState={baseLanes:0,cachePool:null,transitions:null},V=se!==null?se.baseLanes:C,On(Pl,li),li|=V}else se!==null?(V=se.baseLanes|C,g.memoizedState=null):V=C,On(Pl,li),li|=V;return ws(f,g,J,C),g.child}function gd(f,g){var C=g.ref;(f===null&&C!==null||f!==null&&f.ref!==C)&&(g.flags|=512,g.flags|=2097152)}function yd(f,g,C,V,J){var se=Xs(C)?Ls:Ns.current;return se=dl(g,se),to(g,J),C=Mo(f,g,C,V,se,J),V=Qu(),f!==null&&!Bs?(g.updateQueue=f.updateQueue,g.flags&=-2053,f.lanes&=~J,Fi(f,g,J)):(Ln&&V&&Hl(g),g.flags|=1,ws(f,g,C,J),g.child)}function vd(f,g,C,V,J){if(Xs(C)){var se=!0;gi(g)}else se=!1;if(to(g,J),g.stateNode===null)hc(f,g),Oo(g,C,V),fd(g,C,V,J),V=!0;else if(f===null){var ve=g.stateNode,we=g.memoizedProps;ve.props=we;var Ie=ve.context,Ge=C.contextType;typeof Ge=="object"&&Ge!==null?Ge=xi(Ge):(Ge=Xs(C)?Ls:Ns.current,Ge=dl(g,Ge));var nt=C.getDerivedStateFromProps,vt=typeof nt=="function"||typeof ve.getSnapshotBeforeUpdate=="function";vt||typeof ve.UNSAFE_componentWillReceiveProps!="function"&&typeof ve.componentWillReceiveProps!="function"||(we!==V||Ie!==Ge)&&bl(g,ve,V,Ge),_i=!1;var tt=g.memoizedState;ve.state=tt,pl(g,V,ve,J),Ie=g.memoizedState,we!==V||tt!==Ie||Zs.current||_i?(typeof nt=="function"&&(ac(g,C,nt,V),Ie=g.memoizedState),(we=_i||dd(g,C,we,V,tt,Ie,Ge))?(vt||typeof ve.UNSAFE_componentWillMount!="function"&&typeof ve.componentWillMount!="function"||(typeof ve.componentWillMount=="function"&&ve.componentWillMount(),typeof ve.UNSAFE_componentWillMount=="function"&&ve.UNSAFE_componentWillMount()),typeof ve.componentDidMount=="function"&&(g.flags|=4194308)):(typeof ve.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=V,g.memoizedState=Ie),ve.props=V,ve.state=Ie,ve.context=Ge,V=we):(typeof ve.componentDidMount=="function"&&(g.flags|=4194308),V=!1)}else{ve=g.stateNode,lf(f,g),we=g.memoizedProps,Ge=g.type===g.elementType?we:wi(g.type,we),ve.props=Ge,vt=g.pendingProps,tt=ve.context,Ie=C.contextType,typeof Ie=="object"&&Ie!==null?Ie=xi(Ie):(Ie=Xs(C)?Ls:Ns.current,Ie=dl(g,Ie));var Gt=C.getDerivedStateFromProps;(nt=typeof Gt=="function"||typeof ve.getSnapshotBeforeUpdate=="function")||typeof ve.UNSAFE_componentWillReceiveProps!="function"&&typeof ve.componentWillReceiveProps!="function"||(we!==vt||tt!==Ie)&&bl(g,ve,V,Ie),_i=!1,tt=g.memoizedState,ve.state=tt,pl(g,V,ve,J);var tr=g.memoizedState;we!==vt||tt!==tr||Zs.current||_i?(typeof Gt=="function"&&(ac(g,C,Gt,V),tr=g.memoizedState),(Ge=_i||dd(g,C,Ge,V,tt,tr,Ie)||!1)?(nt||typeof ve.UNSAFE_componentWillUpdate!="function"&&typeof ve.componentWillUpdate!="function"||(typeof ve.componentWillUpdate=="function"&&ve.componentWillUpdate(V,tr,Ie),typeof ve.UNSAFE_componentWillUpdate=="function"&&ve.UNSAFE_componentWillUpdate(V,tr,Ie)),typeof ve.componentDidUpdate=="function"&&(g.flags|=4),typeof ve.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof ve.componentDidUpdate!="function"||we===f.memoizedProps&&tt===f.memoizedState||(g.flags|=4),typeof ve.getSnapshotBeforeUpdate!="function"||we===f.memoizedProps&&tt===f.memoizedState||(g.flags|=1024),g.memoizedProps=V,g.memoizedState=tr),ve.props=V,ve.state=tr,ve.context=Ie,V=Ge):(typeof ve.componentDidUpdate!="function"||we===f.memoizedProps&&tt===f.memoizedState||(g.flags|=4),typeof ve.getSnapshotBeforeUpdate!="function"||we===f.memoizedProps&&tt===f.memoizedState||(g.flags|=1024),V=!1)}return xd(f,g,C,V,se,J)}function xd(f,g,C,V,J,se){gd(f,g);var ve=(g.flags&128)!==0;if(!V&&!ve)return J&&tf(g,C,!1),Fi(f,g,se);V=g.stateNode,dc.current=g;var we=ve&&typeof C.getDerivedStateFromError!="function"?null:V.render();return g.flags|=1,f!==null&&ve?(g.child=Zn(g,f.child,null,se),g.child=Zn(g,null,we,se)):ws(f,g,we,se),g.memoizedState=V.state,J&&tf(g,C,!0),g.child}function xf(f){var g=f.stateNode;g.pendingContext?Qd(f,g.pendingContext,g.pendingContext!==g.context):g.context&&Qd(f,g.context,!1),Yc(f,g.containerInfo)}function da(f,g,C,V,J){return ia(),aa(J),g.flags|=256,ws(f,g,C,V),g.child}var su={dehydrated:null,treeContext:null,retryLane:0};function iu(f){return{baseLanes:f,cachePool:null,transitions:null}}function fc(f,g,C){var V=g.pendingProps,J=Gn.current,se=!1,ve=(g.flags&128)!==0,we;if((we=ve)||(we=f!==null&&f.memoizedState===null?!1:(J&2)!==0),we?(se=!0,g.flags&=-129):(f===null||f.memoizedState!==null)&&(J|=1),On(Gn,J&1),f===null)return Ys(g),f=g.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?((g.mode&1)===0?g.lanes=1:f.data==="$!"?g.lanes=8:g.lanes=1073741824,null):(ve=V.children,f=V.fallback,se?(V=g.mode,se=g.child,ve={mode:"hidden",children:ve},(V&1)===0&&se!==null?(se.childLanes=0,se.pendingProps=ve):se=Ac(ve,V,0,null),f=Uo(f,V,C,null),se.return=g,f.return=g,se.sibling=f,g.child=se,g.child.memoizedState=iu(C),g.memoizedState=su,f):wl(g,ve));if(J=f.memoizedState,J!==null&&(we=J.dehydrated,we!==null))return gr(f,g,ve,V,we,J,C);if(se){se=V.fallback,ve=g.mode,J=f.child,we=J.sibling;var Ie={mode:"hidden",children:V.children};return(ve&1)===0&&g.child!==J?(V=g.child,V.childLanes=0,V.pendingProps=Ie,g.deletions=null):(V=Gi(J,Ie),V.subtreeFlags=J.subtreeFlags&14680064),we!==null?se=Gi(we,se):(se=Uo(se,ve,C,null),se.flags|=2),se.return=g,V.return=g,V.sibling=se,g.child=V,V=se,se=g.child,ve=f.child.memoizedState,ve=ve===null?iu(C):{baseLanes:ve.baseLanes|C,cachePool:null,transitions:ve.transitions},se.memoizedState=ve,se.childLanes=f.childLanes&~C,g.memoizedState=su,V}return se=f.child,f=se.sibling,V=Gi(se,{mode:"visible",children:V.children}),(g.mode&1)===0&&(V.lanes=C),V.return=g,V.sibling=null,f!==null&&(C=g.deletions,C===null?(g.deletions=[f],g.flags|=16):C.push(f)),g.child=V,g.memoizedState=null,V}function wl(f,g){return g=Ac({mode:"visible",children:g},f.mode,0,null),g.return=f,f.child=g}function Da(f,g,C,V){return V!==null&&aa(V),Zn(g,f.child,null,C),f=wl(g,g.pendingProps.children),f.flags|=2,g.memoizedState=null,f}function gr(f,g,C,V,J,se,ve){if(C)return g.flags&256?(g.flags&=-257,V=lc(Error(r(422))),Da(f,g,ve,V)):g.memoizedState!==null?(g.child=f.child,g.flags|=128,null):(se=V.fallback,J=g.mode,V=Ac({mode:"visible",children:V.children},J,0,null),se=Uo(se,J,ve,null),se.flags|=2,V.return=g,se.return=g,V.sibling=se,g.child=V,(g.mode&1)!==0&&Zn(g,f.child,null,ve),g.child.memoizedState=iu(ve),g.memoizedState=su,se);if((g.mode&1)===0)return Da(f,g,ve,null);if(J.data==="$!"){if(V=J.nextSibling&&J.nextSibling.dataset,V)var we=V.dgst;return V=we,se=Error(r(419)),V=lc(se,V,void 0),Da(f,g,ve,V)}if(we=(ve&f.childLanes)!==0,Bs||we){if(V=vs,V!==null){switch(ve&-ve){case 4:J=2;break;case 16:J=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:J=32;break;case 536870912:J=268435456;break;default:J=0}J=(J&(V.suspendedLanes|ve))!==0?0:J,J!==0&&J!==se.retryLane&&(se.retryLane=J,Aa(f,J),Ui(V,f,J,-1))}return jd(),V=lc(Error(r(421))),Da(f,g,ve,V)}return J.data==="$?"?(g.flags|=128,g.child=f.child,g=lh.bind(null,f),J._reactRetry=g,null):(f=se.treeContext,ii=Xa(J.nextSibling),js=g,Ln=!0,Oi=null,f!==null&&(yi[vi++]=ra,yi[vi++]=na,yi[vi++]=Ao,ra=f.id,na=f.overflow,Ao=g),g=wl(g,V.children),g.flags|=4096,g)}function au(f,g,C){f.lanes|=g;var V=f.alternate;V!==null&&(V.lanes|=g),Es(f.return,g,C)}function ou(f,g,C,V,J){var se=f.memoizedState;se===null?f.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:V,tail:C,tailMode:J}:(se.isBackwards=g,se.rendering=null,se.renderingStartTime=0,se.last=V,se.tail=C,se.tailMode=J)}function so(f,g,C){var V=g.pendingProps,J=V.revealOrder,se=V.tail;if(ws(f,g,V.children,C),V=Gn.current,(V&2)!==0)V=V&1|2,g.flags|=128;else{if(f!==null&&(f.flags&128)!==0)e:for(f=g.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&au(f,C,g);else if(f.tag===19)au(f,C,g);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===g)break e;for(;f.sibling===null;){if(f.return===null||f.return===g)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}V&=1}if(On(Gn,V),(g.mode&1)===0)g.memoizedState=null;else switch(J){case"forwards":for(C=g.child,J=null;C!==null;)f=C.alternate,f!==null&&Do(f)===null&&(J=C),C=C.sibling;C=J,C===null?(J=g.child,g.child=null):(J=C.sibling,C.sibling=null),ou(g,!1,J,C,se);break;case"backwards":for(C=null,J=g.child,g.child=null;J!==null;){if(f=J.alternate,f!==null&&Do(f)===null){g.child=J;break}f=J.sibling,J.sibling=C,C=J,J=f}ou(g,!0,C,null,se);break;case"together":ou(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function hc(f,g){(g.mode&1)===0&&f!==null&&(f.alternate=null,g.alternate=null,g.flags|=2)}function Fi(f,g,C){if(f!==null&&(g.dependencies=f.dependencies),ao|=g.lanes,(C&g.childLanes)===0)return null;if(f!==null&&g.child!==f.child)throw Error(r(153));if(g.child!==null){for(f=g.child,C=Gi(f,f.pendingProps),g.child=C,C.return=g;f.sibling!==null;)f=f.sibling,C=C.sibling=Gi(f,f.pendingProps),C.return=g;C.sibling=null}return g.child}function _f(f,g,C){switch(g.tag){case 3:xf(g),ia();break;case 5:Jc(g);break;case 1:Xs(g.type)&&gi(g);break;case 4:Yc(g,g.stateNode.containerInfo);break;case 10:var V=g.type._context,J=g.memoizedProps.value;On(Kl,V._currentValue),V._currentValue=J;break;case 13:if(V=g.memoizedState,V!==null)return V.dehydrated!==null?(On(Gn,Gn.current&1),g.flags|=128,null):(C&g.child.childLanes)!==0?fc(f,g,C):(On(Gn,Gn.current&1),f=Fi(f,g,C),f!==null?f.sibling:null);On(Gn,Gn.current&1);break;case 19:if(V=(C&g.childLanes)!==0,(f.flags&128)!==0){if(V)return so(f,g,C);g.flags|=128}if(J=g.memoizedState,J!==null&&(J.rendering=null,J.tail=null,J.lastEffect=null),On(Gn,Gn.current),V)break;return null;case 22:case 23:return g.lanes=0,md(f,g,C)}return Fi(f,g,C)}var Ss,_d,bf,bd;Ss=function(f,g){for(var C=g.child;C!==null;){if(C.tag===5||C.tag===6)f.appendChild(C.stateNode);else if(C.tag!==4&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===g)break;for(;C.sibling===null;){if(C.return===null||C.return===g)return;C=C.return}C.sibling.return=C.return,C=C.sibling}},_d=function(){},bf=function(f,g,C,V){var J=f.memoizedProps;if(J!==V){f=g.stateNode,Ia(oa.current);var se=null;switch(C){case"input":J=Ue(f,J),V=Ue(f,V),se=[];break;case"select":J=he({},J,{value:void 0}),V=he({},V,{value:void 0}),se=[];break;case"textarea":J=xr(f,J),V=xr(f,V),se=[];break;default:typeof J.onClick!="function"&&typeof V.onClick=="function"&&(f.onclick=$u)}Dr(C,V);var ve;C=null;for(Ge in J)if(!V.hasOwnProperty(Ge)&&J.hasOwnProperty(Ge)&&J[Ge]!=null)if(Ge==="style"){var we=J[Ge];for(ve in we)we.hasOwnProperty(ve)&&(C||(C={}),C[ve]="")}else Ge!=="dangerouslySetInnerHTML"&&Ge!=="children"&&Ge!=="suppressContentEditableWarning"&&Ge!=="suppressHydrationWarning"&&Ge!=="autoFocus"&&(s.hasOwnProperty(Ge)?se||(se=[]):(se=se||[]).push(Ge,null));for(Ge in V){var Ie=V[Ge];if(we=J!=null?J[Ge]:void 0,V.hasOwnProperty(Ge)&&Ie!==we&&(Ie!=null||we!=null))if(Ge==="style")if(we){for(ve in we)!we.hasOwnProperty(ve)||Ie&&Ie.hasOwnProperty(ve)||(C||(C={}),C[ve]="");for(ve in Ie)Ie.hasOwnProperty(ve)&&we[ve]!==Ie[ve]&&(C||(C={}),C[ve]=Ie[ve])}else C||(se||(se=[]),se.push(Ge,C)),C=Ie;else Ge==="dangerouslySetInnerHTML"?(Ie=Ie?Ie.__html:void 0,we=we?we.__html:void 0,Ie!=null&&we!==Ie&&(se=se||[]).push(Ge,Ie)):Ge==="children"?typeof Ie!="string"&&typeof Ie!="number"||(se=se||[]).push(Ge,""+Ie):Ge!=="suppressContentEditableWarning"&&Ge!=="suppressHydrationWarning"&&(s.hasOwnProperty(Ge)?(Ie!=null&&Ge==="onScroll"&&$n("scroll",f),se||we===Ie||(se=[])):(se=se||[]).push(Ge,Ie))}C&&(se=se||[]).push("style",C);var Ge=se;(g.updateQueue=Ge)&&(g.flags|=4)}},bd=function(f,g,C,V){C!==V&&(g.flags|=4)};function lu(f,g){if(!Ln)switch(f.tailMode){case"hidden":g=f.tail;for(var C=null;g!==null;)g.alternate!==null&&(C=g),g=g.sibling;C===null?f.tail=null:C.sibling=null;break;case"collapsed":C=f.tail;for(var V=null;C!==null;)C.alternate!==null&&(V=C),C=C.sibling;V===null?g||f.tail===null?f.tail=null:f.tail.sibling=null:V.sibling=null}}function Rs(f){var g=f.alternate!==null&&f.alternate.child===f.child,C=0,V=0;if(g)for(var J=f.child;J!==null;)C|=J.lanes|J.childLanes,V|=J.subtreeFlags&14680064,V|=J.flags&14680064,J.return=f,J=J.sibling;else for(J=f.child;J!==null;)C|=J.lanes|J.childLanes,V|=J.subtreeFlags,V|=J.flags,J.return=f,J=J.sibling;return f.subtreeFlags|=V,f.childLanes=C,g}function eh(f,g,C){var V=g.pendingProps;switch(Io(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rs(g),null;case 1:return Xs(g.type)&&Bu(),Rs(g),null;case 3:return V=g.stateNode,ro(),Fn(Zs),Fn(Ns),Ju(),V.pendingContext&&(V.context=V.pendingContext,V.pendingContext=null),(f===null||f.child===null)&&(ql(g)?g.flags|=4:f===null||f.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,Oi!==null&&(kd(Oi),Oi=null))),_d(f,g),Rs(g),null;case 5:Yu(g);var J=Ia(ml.current);if(C=g.type,f!==null&&g.stateNode!=null)bf(f,g,C,V,J),f.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!V){if(g.stateNode===null)throw Error(r(166));return Rs(g),null}if(f=Ia(oa.current),ql(g)){V=g.stateNode,C=g.type;var se=g.memoizedProps;switch(V[ea]=g,V[Ya]=se,f=(g.mode&1)!==0,C){case"dialog":$n("cancel",V),$n("close",V);break;case"iframe":case"object":case"embed":$n("load",V);break;case"video":case"audio":for(J=0;J<Sa.length;J++)$n(Sa[J],V);break;case"source":$n("error",V);break;case"img":case"image":case"link":$n("error",V),$n("load",V);break;case"details":$n("toggle",V);break;case"input":qt(V,se),$n("invalid",V);break;case"select":V._wrapperState={wasMultiple:!!se.multiple},$n("invalid",V);break;case"textarea":br(V,se),$n("invalid",V)}Dr(C,se),J=null;for(var ve in se)if(se.hasOwnProperty(ve)){var we=se[ve];ve==="children"?typeof we=="string"?V.textContent!==we&&(se.suppressHydrationWarning!==!0&&Bl(V.textContent,we,f),J=["children",we]):typeof we=="number"&&V.textContent!==""+we&&(se.suppressHydrationWarning!==!0&&Bl(V.textContent,we,f),J=["children",""+we]):s.hasOwnProperty(ve)&&we!=null&&ve==="onScroll"&&$n("scroll",V)}switch(C){case"input":ze(V),rt(V,se,!0);break;case"textarea":ze(V),zr(V);break;case"select":case"option":break;default:typeof se.onClick=="function"&&(V.onclick=$u)}V=J,g.updateQueue=V,V!==null&&(g.flags|=4)}else{ve=J.nodeType===9?J:J.ownerDocument,f==="http://www.w3.org/1999/xhtml"&&(f=pr(C)),f==="http://www.w3.org/1999/xhtml"?C==="script"?(f=ve.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild)):typeof V.is=="string"?f=ve.createElement(C,{is:V.is}):(f=ve.createElement(C),C==="select"&&(ve=f,V.multiple?ve.multiple=!0:V.size&&(ve.size=V.size))):f=ve.createElementNS(f,C),f[ea]=g,f[Ya]=V,Ss(f,g,!1,!1),g.stateNode=f;e:{switch(ve=Nr(C,V),C){case"dialog":$n("cancel",f),$n("close",f),J=V;break;case"iframe":case"object":case"embed":$n("load",f),J=V;break;case"video":case"audio":for(J=0;J<Sa.length;J++)$n(Sa[J],f);J=V;break;case"source":$n("error",f),J=V;break;case"img":case"image":case"link":$n("error",f),$n("load",f),J=V;break;case"details":$n("toggle",f),J=V;break;case"input":qt(f,V),J=Ue(f,V),$n("invalid",f);break;case"option":J=V;break;case"select":f._wrapperState={wasMultiple:!!V.multiple},J=he({},V,{value:void 0}),$n("invalid",f);break;case"textarea":br(f,V),J=xr(f,V),$n("invalid",f);break;default:J=V}Dr(C,J),we=J;for(se in we)if(we.hasOwnProperty(se)){var Ie=we[se];se==="style"?gn(f,Ie):se==="dangerouslySetInnerHTML"?(Ie=Ie?Ie.__html:void 0,Ie!=null&&_r(f,Ie)):se==="children"?typeof Ie=="string"?(C!=="textarea"||Ie!=="")&&It(f,Ie):typeof Ie=="number"&&It(f,""+Ie):se!=="suppressContentEditableWarning"&&se!=="suppressHydrationWarning"&&se!=="autoFocus"&&(s.hasOwnProperty(se)?Ie!=null&&se==="onScroll"&&$n("scroll",f):Ie!=null&&A(f,se,Ie,ve))}switch(C){case"input":ze(f),rt(f,V,!1);break;case"textarea":ze(f),zr(f);break;case"option":V.value!=null&&f.setAttribute("value",""+Pe(V.value));break;case"select":f.multiple=!!V.multiple,se=V.value,se!=null?er(f,!!V.multiple,se,!1):V.defaultValue!=null&&er(f,!!V.multiple,V.defaultValue,!0);break;default:typeof J.onClick=="function"&&(f.onclick=$u)}switch(C){case"button":case"input":case"select":case"textarea":V=!!V.autoFocus;break e;case"img":V=!0;break e;default:V=!1}}V&&(g.flags|=4)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return Rs(g),null;case 6:if(f&&g.stateNode!=null)bd(f,g,f.memoizedProps,V);else{if(typeof V!="string"&&g.stateNode===null)throw Error(r(166));if(C=Ia(ml.current),Ia(oa.current),ql(g)){if(V=g.stateNode,C=g.memoizedProps,V[ea]=g,(se=V.nodeValue!==C)&&(f=js,f!==null))switch(f.tag){case 3:Bl(V.nodeValue,C,(f.mode&1)!==0);break;case 5:f.memoizedProps.suppressHydrationWarning!==!0&&Bl(V.nodeValue,C,(f.mode&1)!==0)}se&&(g.flags|=4)}else V=(C.nodeType===9?C:C.ownerDocument).createTextNode(V),V[ea]=g,g.stateNode=V}return Rs(g),null;case 13:if(Fn(Gn),V=g.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(Ln&&ii!==null&&(g.mode&1)!==0&&(g.flags&128)===0)Wc(),ia(),g.flags|=98560,se=!1;else if(se=ql(g),V!==null&&V.dehydrated!==null){if(f===null){if(!se)throw Error(r(318));if(se=g.memoizedState,se=se!==null?se.dehydrated:null,!se)throw Error(r(317));se[ea]=g}else ia(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;Rs(g),se=!1}else Oi!==null&&(kd(Oi),Oi=null),se=!0;if(!se)return g.flags&65536?g:null}return(g.flags&128)!==0?(g.lanes=C,g):(V=V!==null,V!==(f!==null&&f.memoizedState!==null)&&V&&(g.child.flags|=8192,(g.mode&1)!==0&&(f===null||(Gn.current&1)!==0?fs===0&&(fs=3):jd())),g.updateQueue!==null&&(g.flags|=4),Rs(g),null);case 4:return ro(),_d(f,g),f===null&&Ka(g.stateNode.containerInfo),Rs(g),null;case 10:return Wu(g.type._context),Rs(g),null;case 17:return Xs(g.type)&&Bu(),Rs(g),null;case 19:if(Fn(Gn),se=g.memoizedState,se===null)return Rs(g),null;if(V=(g.flags&128)!==0,ve=se.rendering,ve===null)if(V)lu(se,!1);else{if(fs!==0||f!==null&&(f.flags&128)!==0)for(f=g.child;f!==null;){if(ve=Do(f),ve!==null){for(g.flags|=128,lu(se,!1),V=ve.updateQueue,V!==null&&(g.updateQueue=V,g.flags|=4),g.subtreeFlags=0,V=C,C=g.child;C!==null;)se=C,f=V,se.flags&=14680066,ve=se.alternate,ve===null?(se.childLanes=0,se.lanes=f,se.child=null,se.subtreeFlags=0,se.memoizedProps=null,se.memoizedState=null,se.updateQueue=null,se.dependencies=null,se.stateNode=null):(se.childLanes=ve.childLanes,se.lanes=ve.lanes,se.child=ve.child,se.subtreeFlags=0,se.deletions=null,se.memoizedProps=ve.memoizedProps,se.memoizedState=ve.memoizedState,se.updateQueue=ve.updateQueue,se.type=ve.type,f=ve.dependencies,se.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),C=C.sibling;return On(Gn,Gn.current&1|2),g.child}f=f.sibling}se.tail!==null&&Xe()>Fo&&(g.flags|=128,V=!0,lu(se,!1),g.lanes=4194304)}else{if(!V)if(f=Do(ve),f!==null){if(g.flags|=128,V=!0,C=f.updateQueue,C!==null&&(g.updateQueue=C,g.flags|=4),lu(se,!0),se.tail===null&&se.tailMode==="hidden"&&!ve.alternate&&!Ln)return Rs(g),null}else 2*Xe()-se.renderingStartTime>Fo&&C!==1073741824&&(g.flags|=128,V=!0,lu(se,!1),g.lanes=4194304);se.isBackwards?(ve.sibling=g.child,g.child=ve):(C=se.last,C!==null?C.sibling=ve:g.child=ve,se.last=ve)}return se.tail!==null?(g=se.tail,se.rendering=g,se.tail=g.sibling,se.renderingStartTime=Xe(),g.sibling=null,C=Gn.current,On(Gn,V?C&1|2:C&1),g):(Rs(g),null);case 22:case 23:return Dd(),V=g.memoizedState!==null,f!==null&&f.memoizedState!==null!==V&&(g.flags|=8192),V&&(g.mode&1)!==0?(li&1073741824)!==0&&(Rs(g),g.subtreeFlags&6&&(g.flags|=8192)):Rs(g),null;case 24:return null;case 25:return null}throw Error(r(156,g.tag))}function th(f,g){switch(Io(g),g.tag){case 1:return Xs(g.type)&&Bu(),f=g.flags,f&65536?(g.flags=f&-65537|128,g):null;case 3:return ro(),Fn(Zs),Fn(Ns),Ju(),f=g.flags,(f&65536)!==0&&(f&128)===0?(g.flags=f&-65537|128,g):null;case 5:return Yu(g),null;case 13:if(Fn(Gn),f=g.memoizedState,f!==null&&f.dehydrated!==null){if(g.alternate===null)throw Error(r(340));ia()}return f=g.flags,f&65536?(g.flags=f&-65537|128,g):null;case 19:return Fn(Gn),null;case 4:return ro(),null;case 10:return Wu(g.type._context),null;case 22:case 23:return Dd(),null;case 24:return null;default:return null}}var pc=!1,zn=!1,Us=typeof WeakSet=="function"?WeakSet:Set,Kt=null;function Sl(f,g){var C=f.ref;if(C!==null)if(typeof C=="function")try{C(null)}catch(V){Wn(f,g,V)}else C.current=null}function uu(f,g,C){try{C()}catch(V){Wn(f,g,V)}}var Ef=!1;function rh(f,g){if(Ul=Ua,f=In(),Ml(f)){if("selectionStart"in f)var C={start:f.selectionStart,end:f.selectionEnd};else e:{C=(C=f.ownerDocument)&&C.defaultView||window;var V=C.getSelection&&C.getSelection();if(V&&V.rangeCount!==0){C=V.anchorNode;var J=V.anchorOffset,se=V.focusNode;V=V.focusOffset;try{C.nodeType,se.nodeType}catch{C=null;break e}var ve=0,we=-1,Ie=-1,Ge=0,nt=0,vt=f,tt=null;t:for(;;){for(var Gt;vt!==C||J!==0&&vt.nodeType!==3||(we=ve+J),vt!==se||V!==0&&vt.nodeType!==3||(Ie=ve+V),vt.nodeType===3&&(ve+=vt.nodeValue.length),(Gt=vt.firstChild)!==null;)tt=vt,vt=Gt;for(;;){if(vt===f)break t;if(tt===C&&++Ge===J&&(we=ve),tt===se&&++nt===V&&(Ie=ve),(Gt=vt.nextSibling)!==null)break;vt=tt,tt=vt.parentNode}vt=Gt}C=we===-1||Ie===-1?null:{start:we,end:Ie}}else C=null}C=C||{start:0,end:0}}else C=null;for(Po={focusedElem:f,selectionRange:C},Ua=!1,Kt=g;Kt!==null;)if(g=Kt,f=g.child,(g.subtreeFlags&1028)!==0&&f!==null)f.return=g,Kt=f;else for(;Kt!==null;){g=Kt;try{var tr=g.alternate;if((g.flags&1024)!==0)switch(g.tag){case 0:case 11:case 15:break;case 1:if(tr!==null){var rr=tr.memoizedProps,Jn=tr.memoizedState,Fe=g.stateNode,Ne=Fe.getSnapshotBeforeUpdate(g.elementType===g.type?rr:wi(g.type,rr),Jn);Fe.__reactInternalSnapshotBeforeUpdate=Ne}break;case 3:var Le=g.stateNode.containerInfo;Le.nodeType===1?Le.textContent="":Le.nodeType===9&&Le.documentElement&&Le.removeChild(Le.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Ct){Wn(g,g.return,Ct)}if(f=g.sibling,f!==null){f.return=g.return,Kt=f;break}Kt=g.return}return tr=Ef,Ef=!1,tr}function ja(f,g,C){var V=g.updateQueue;if(V=V!==null?V.lastEffect:null,V!==null){var J=V=V.next;do{if((J.tag&f)===f){var se=J.destroy;J.destroy=void 0,se!==void 0&&uu(g,C,se)}J=J.next}while(J!==V)}}function cu(f,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var C=g=g.next;do{if((C.tag&f)===f){var V=C.create;C.destroy=V()}C=C.next}while(C!==g)}}function mc(f){var g=f.ref;if(g!==null){var C=f.stateNode;switch(f.tag){case 5:f=C;break;default:f=C}typeof g=="function"?g(f):g.current=f}}function wf(f){var g=f.alternate;g!==null&&(f.alternate=null,wf(g)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(g=f.stateNode,g!==null&&(delete g[ea],delete g[Ya],delete g[Lu],delete g[xe],delete g[ul])),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function Sf(f){return f.tag===5||f.tag===3||f.tag===4}function Rf(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||Sf(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function Ed(f,g,C){var V=f.tag;if(V===5||V===6)f=f.stateNode,g?C.nodeType===8?C.parentNode.insertBefore(f,g):C.insertBefore(f,g):(C.nodeType===8?(g=C.parentNode,g.insertBefore(f,C)):(g=C,g.appendChild(f)),C=C._reactRootContainer,C!=null||g.onclick!==null||(g.onclick=$u));else if(V!==4&&(f=f.child,f!==null))for(Ed(f,g,C),f=f.sibling;f!==null;)Ed(f,g,C),f=f.sibling}function gc(f,g,C){var V=f.tag;if(V===5||V===6)f=f.stateNode,g?C.insertBefore(f,g):C.appendChild(f);else if(V!==4&&(f=f.child,f!==null))for(gc(f,g,C),f=f.sibling;f!==null;)gc(f,g,C),f=f.sibling}var ys=null,Li=!1;function fa(f,g,C){for(C=C.child;C!==null;)wd(f,g,C),C=C.sibling}function wd(f,g,C){if(An&&typeof An.onCommitFiberUnmount=="function")try{An.onCommitFiberUnmount(un,C)}catch{}switch(C.tag){case 5:zn||Sl(C,g);case 6:var V=ys,J=Li;ys=null,fa(f,g,C),ys=V,Li=J,ys!==null&&(Li?(f=ys,C=C.stateNode,f.nodeType===8?f.parentNode.removeChild(C):f.removeChild(C)):ys.removeChild(C.stateNode));break;case 18:ys!==null&&(Li?(f=ys,C=C.stateNode,f.nodeType===8?zc(f.parentNode,C):f.nodeType===1&&zc(f,C),Zr(f)):zc(ys,C.stateNode));break;case 4:V=ys,J=Li,ys=C.stateNode.containerInfo,Li=!0,fa(f,g,C),ys=V,Li=J;break;case 0:case 11:case 14:case 15:if(!zn&&(V=C.updateQueue,V!==null&&(V=V.lastEffect,V!==null))){J=V=V.next;do{var se=J,ve=se.destroy;se=se.tag,ve!==void 0&&((se&2)!==0||(se&4)!==0)&&uu(C,g,ve),J=J.next}while(J!==V)}fa(f,g,C);break;case 1:if(!zn&&(Sl(C,g),V=C.stateNode,typeof V.componentWillUnmount=="function"))try{V.props=C.memoizedProps,V.state=C.memoizedState,V.componentWillUnmount()}catch(we){Wn(C,g,we)}fa(f,g,C);break;case 21:fa(f,g,C);break;case 22:C.mode&1?(zn=(V=zn)||C.memoizedState!==null,fa(f,g,C),zn=V):fa(f,g,C);break;default:fa(f,g,C)}}function Rl(f){var g=f.updateQueue;if(g!==null){f.updateQueue=null;var C=f.stateNode;C===null&&(C=f.stateNode=new Us),g.forEach(function(V){var J=uh.bind(null,f,V);C.has(V)||(C.add(V),V.then(J,J))})}}function oi(f,g){var C=g.deletions;if(C!==null)for(var V=0;V<C.length;V++){var J=C[V];try{var se=f,ve=g,we=ve;e:for(;we!==null;){switch(we.tag){case 5:ys=we.stateNode,Li=!1;break e;case 3:ys=we.stateNode.containerInfo,Li=!0;break e;case 4:ys=we.stateNode.containerInfo,Li=!0;break e}we=we.return}if(ys===null)throw Error(r(160));wd(se,ve,J),ys=null,Li=!1;var Ie=J.alternate;Ie!==null&&(Ie.return=null),J.return=null}catch(Ge){Wn(J,g,Ge)}}if(g.subtreeFlags&12854)for(g=g.child;g!==null;)Sd(g,f),g=g.sibling}function Sd(f,g){var C=f.alternate,V=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:if(oi(g,f),Vi(f),V&4){try{ja(3,f,f.return),cu(3,f)}catch(rr){Wn(f,f.return,rr)}try{ja(5,f,f.return)}catch(rr){Wn(f,f.return,rr)}}break;case 1:oi(g,f),Vi(f),V&512&&C!==null&&Sl(C,C.return);break;case 5:if(oi(g,f),Vi(f),V&512&&C!==null&&Sl(C,C.return),f.flags&32){var J=f.stateNode;try{It(J,"")}catch(rr){Wn(f,f.return,rr)}}if(V&4&&(J=f.stateNode,J!=null)){var se=f.memoizedProps,ve=C!==null?C.memoizedProps:se,we=f.type,Ie=f.updateQueue;if(f.updateQueue=null,Ie!==null)try{we==="input"&&se.type==="radio"&&se.name!=null&&or(J,se),Nr(we,ve);var Ge=Nr(we,se);for(ve=0;ve<Ie.length;ve+=2){var nt=Ie[ve],vt=Ie[ve+1];nt==="style"?gn(J,vt):nt==="dangerouslySetInnerHTML"?_r(J,vt):nt==="children"?It(J,vt):A(J,nt,vt,Ge)}switch(we){case"input":Lt(J,se);break;case"textarea":Pr(J,se);break;case"select":var tt=J._wrapperState.wasMultiple;J._wrapperState.wasMultiple=!!se.multiple;var Gt=se.value;Gt!=null?er(J,!!se.multiple,Gt,!1):tt!==!!se.multiple&&(se.defaultValue!=null?er(J,!!se.multiple,se.defaultValue,!0):er(J,!!se.multiple,se.multiple?[]:"",!1))}J[Ya]=se}catch(rr){Wn(f,f.return,rr)}}break;case 6:if(oi(g,f),Vi(f),V&4){if(f.stateNode===null)throw Error(r(162));J=f.stateNode,se=f.memoizedProps;try{J.nodeValue=se}catch(rr){Wn(f,f.return,rr)}}break;case 3:if(oi(g,f),Vi(f),V&4&&C!==null&&C.memoizedState.isDehydrated)try{Zr(g.containerInfo)}catch(rr){Wn(f,f.return,rr)}break;case 4:oi(g,f),Vi(f);break;case 13:oi(g,f),Vi(f),J=f.child,J.flags&8192&&(se=J.memoizedState!==null,J.stateNode.isHidden=se,!se||J.alternate!==null&&J.alternate.memoizedState!==null||(Td=Xe())),V&4&&Rl(f);break;case 22:if(nt=C!==null&&C.memoizedState!==null,f.mode&1?(zn=(Ge=zn)||nt,oi(g,f),zn=Ge):oi(g,f),Vi(f),V&8192){if(Ge=f.memoizedState!==null,(f.stateNode.isHidden=Ge)&&!nt&&(f.mode&1)!==0)for(Kt=f,nt=f.child;nt!==null;){for(vt=Kt=nt;Kt!==null;){switch(tt=Kt,Gt=tt.child,tt.tag){case 0:case 11:case 14:case 15:ja(4,tt,tt.return);break;case 1:Sl(tt,tt.return);var tr=tt.stateNode;if(typeof tr.componentWillUnmount=="function"){V=tt,C=tt.return;try{g=V,tr.props=g.memoizedProps,tr.state=g.memoizedState,tr.componentWillUnmount()}catch(rr){Wn(V,C,rr)}}break;case 5:Sl(tt,tt.return);break;case 22:if(tt.memoizedState!==null){io(vt);continue}}Gt!==null?(Gt.return=tt,Kt=Gt):io(vt)}nt=nt.sibling}e:for(nt=null,vt=f;;){if(vt.tag===5){if(nt===null){nt=vt;try{J=vt.stateNode,Ge?(se=J.style,typeof se.setProperty=="function"?se.setProperty("display","none","important"):se.display="none"):(we=vt.stateNode,Ie=vt.memoizedProps.style,ve=Ie!=null&&Ie.hasOwnProperty("display")?Ie.display:null,we.style.display=Vn("display",ve))}catch(rr){Wn(f,f.return,rr)}}}else if(vt.tag===6){if(nt===null)try{vt.stateNode.nodeValue=Ge?"":vt.memoizedProps}catch(rr){Wn(f,f.return,rr)}}else if((vt.tag!==22&&vt.tag!==23||vt.memoizedState===null||vt===f)&&vt.child!==null){vt.child.return=vt,vt=vt.child;continue}if(vt===f)break e;for(;vt.sibling===null;){if(vt.return===null||vt.return===f)break e;nt===vt&&(nt=null),vt=vt.return}nt===vt&&(nt=null),vt.sibling.return=vt.return,vt=vt.sibling}}break;case 19:oi(g,f),Vi(f),V&4&&Rl(f);break;case 21:break;default:oi(g,f),Vi(f)}}function Vi(f){var g=f.flags;if(g&2){try{e:{for(var C=f.return;C!==null;){if(Sf(C)){var V=C;break e}C=C.return}throw Error(r(160))}switch(V.tag){case 5:var J=V.stateNode;V.flags&32&&(It(J,""),V.flags&=-33);var se=Rf(f);gc(f,se,J);break;case 3:case 4:var ve=V.stateNode.containerInfo,we=Rf(f);Ed(f,we,ve);break;default:throw Error(r(161))}}catch(Ie){Wn(f,f.return,Ie)}f.flags&=-3}g&4096&&(f.flags&=-4097)}function yc(f,g,C){Kt=f,Rd(f)}function Rd(f,g,C){for(var V=(f.mode&1)!==0;Kt!==null;){var J=Kt,se=J.child;if(J.tag===22&&V){var ve=J.memoizedState!==null||pc;if(!ve){var we=J.alternate,Ie=we!==null&&we.memoizedState!==null||zn;we=pc;var Ge=zn;if(pc=ve,(zn=Ie)&&!Ge)for(Kt=J;Kt!==null;)ve=Kt,Ie=ve.child,ve.tag===22&&ve.memoizedState!==null?Pf(J):Ie!==null?(Ie.return=ve,Kt=Ie):Pf(J);for(;se!==null;)Kt=se,Rd(se),se=se.sibling;Kt=J,pc=we,zn=Ge}Bi(f)}else(J.subtreeFlags&8772)!==0&&se!==null?(se.return=J,Kt=se):Bi(f)}}function Bi(f){for(;Kt!==null;){var g=Kt;if((g.flags&8772)!==0){var C=g.alternate;try{if((g.flags&8772)!==0)switch(g.tag){case 0:case 11:case 15:zn||cu(5,g);break;case 1:var V=g.stateNode;if(g.flags&4&&!zn)if(C===null)V.componentDidMount();else{var J=g.elementType===g.type?C.memoizedProps:wi(g.type,C.memoizedProps);V.componentDidUpdate(J,C.memoizedState,V.__reactInternalSnapshotBeforeUpdate)}var se=g.updateQueue;se!==null&&Xc(g,se,V);break;case 3:var ve=g.updateQueue;if(ve!==null){if(C=null,g.child!==null)switch(g.child.tag){case 5:C=g.child.stateNode;break;case 1:C=g.child.stateNode}Xc(g,ve,C)}break;case 5:var we=g.stateNode;if(C===null&&g.flags&4){C=we;var Ie=g.memoizedProps;switch(g.type){case"button":case"input":case"select":case"textarea":Ie.autoFocus&&C.focus();break;case"img":Ie.src&&(C.src=Ie.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(g.memoizedState===null){var Ge=g.alternate;if(Ge!==null){var nt=Ge.memoizedState;if(nt!==null){var vt=nt.dehydrated;vt!==null&&Zr(vt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}zn||g.flags&512&&mc(g)}catch(tt){Wn(g,g.return,tt)}}if(g===f){Kt=null;break}if(C=g.sibling,C!==null){C.return=g.return,Kt=C;break}Kt=g.return}}function io(f){for(;Kt!==null;){var g=Kt;if(g===f){Kt=null;break}var C=g.sibling;if(C!==null){C.return=g.return,Kt=C;break}Kt=g.return}}function Pf(f){for(;Kt!==null;){var g=Kt;try{switch(g.tag){case 0:case 11:case 15:var C=g.return;try{cu(4,g)}catch(Ie){Wn(g,C,Ie)}break;case 1:var V=g.stateNode;if(typeof V.componentDidMount=="function"){var J=g.return;try{V.componentDidMount()}catch(Ie){Wn(g,J,Ie)}}var se=g.return;try{mc(g)}catch(Ie){Wn(g,se,Ie)}break;case 5:var ve=g.return;try{mc(g)}catch(Ie){Wn(g,ve,Ie)}}}catch(Ie){Wn(g,g.return,Ie)}if(g===f){Kt=null;break}var we=g.sibling;if(we!==null){we.return=g.return,Kt=we;break}Kt=g.return}}var Tf=Math.ceil,vc=I.ReactCurrentDispatcher,Pd=I.ReactCurrentOwner,Si=I.ReactCurrentBatchConfig,dn=0,vs=null,ss=null,Ps=0,li=0,Pl=Ks(0),fs=0,du=null,ao=0,fu=0,xc=0,hu=null,Qs=null,Td=0,Fo=1/0,Ma=null,_c=!1,Ad=null,oo=null,bc=!1,lo=null,Gs=0,pu=0,Cd=null,Ec=-1,mu=0;function zs(){return(dn&6)!==0?Xe():Ec!==-1?Ec:Ec=Xe()}function uo(f){return(f.mode&1)===0?1:(dn&2)!==0&&Ps!==0?Ps&-Ps:af.transition!==null?(mu===0&&(mu=Va()),mu):(f=Gr,f!==0||(f=window.event,f=f===void 0?16:Dl(f.type)),f)}function Ui(f,g,C,V){if(50<pu)throw pu=0,Cd=null,Error(r(185));Ba(f,C,V),((dn&2)===0||f!==vs)&&(f===vs&&((dn&2)===0&&(fu|=C),fs===4&&co(f,Ps)),ei(f,V),C===1&&dn===0&&(g.mode&1)===0&&(Fo=Xe()+500,Uu&&Qa()))}function ei(f,g){var C=f.callbackNode;ma(f,g);var V=Ki(f,f===vs?Ps:0);if(V===0)C!==null&&We(C),f.callbackNode=null,f.callbackPriority=0;else if(g=V&-V,f.callbackPriority!==g){if(C!=null&&We(C),g===1)f.tag===0?To(Af.bind(null,f)):rf(Af.bind(null,f)),Fu(function(){(dn&6)===0&&Qa()}),C=null;else{switch(ri(V)){case 1:C=kt;break;case 4:C=Wt;break;case 16:C=cr;break;case 536870912:C=Kr;break;default:C=cr}C=Mf(C,wc.bind(null,f))}f.callbackPriority=g,f.callbackNode=C}}function wc(f,g){if(Ec=-1,mu=0,(dn&6)!==0)throw Error(r(327));var C=f.callbackNode;if(Tl()&&f.callbackNode!==C)return null;var V=Ki(f,f===vs?Ps:0);if(V===0)return null;if((V&30)!==0||(V&f.expiredLanes)!==0||g)g=Sc(f,V);else{g=V;var J=dn;dn|=2;var se=If();(vs!==f||Ps!==g)&&(Ma=null,Fo=Xe()+500,Vo(f,g));do try{ih();break}catch(we){Cf(f,we)}while(!0);Ta(),vc.current=se,dn=J,ss!==null?g=0:(vs=null,Ps=0,g=fs)}if(g!==0){if(g===2&&(J=qs(f),J!==0&&(V=J,g=Id(f,J))),g===1)throw C=du,Vo(f,0),co(f,V),ei(f,Xe()),C;if(g===6)co(f,V);else{if(J=f.current.alternate,(V&30)===0&&!nh(J)&&(g=Sc(f,V),g===2&&(se=qs(f),se!==0&&(V=se,g=Id(f,se))),g===1))throw C=du,Vo(f,0),co(f,V),ei(f,Xe()),C;switch(f.finishedWork=J,f.finishedLanes=V,g){case 0:case 1:throw Error(r(345));case 2:Bo(f,Qs,Ma);break;case 3:if(co(f,V),(V&130023424)===V&&(g=Td+500-Xe(),10<g)){if(Ki(f,0)!==0)break;if(J=f.suspendedLanes,(J&V)!==V){zs(),f.pingedLanes|=f.suspendedLanes&J;break}f.timeoutHandle=Za(Bo.bind(null,f,Qs,Ma),g);break}Bo(f,Qs,Ma);break;case 4:if(co(f,V),(V&4194240)===V)break;for(g=f.eventTimes,J=-1;0<V;){var ve=31-ls(V);se=1<<ve,ve=g[ve],ve>J&&(J=ve),V&=~se}if(V=J,V=Xe()-V,V=(120>V?120:480>V?480:1080>V?1080:1920>V?1920:3e3>V?3e3:4320>V?4320:1960*Tf(V/1960))-V,10<V){f.timeoutHandle=Za(Bo.bind(null,f,Qs,Ma),V);break}Bo(f,Qs,Ma);break;case 5:Bo(f,Qs,Ma);break;default:throw Error(r(329))}}}return ei(f,Xe()),f.callbackNode===C?wc.bind(null,f):null}function Id(f,g){var C=hu;return f.current.memoizedState.isDehydrated&&(Vo(f,g).flags|=256),f=Sc(f,g),f!==2&&(g=Qs,Qs=C,g!==null&&kd(g)),f}function kd(f){Qs===null?Qs=f:Qs.push.apply(Qs,f)}function nh(f){for(var g=f;;){if(g.flags&16384){var C=g.updateQueue;if(C!==null&&(C=C.stores,C!==null))for(var V=0;V<C.length;V++){var J=C[V],se=J.getSnapshot;J=J.value;try{if(!Be(se(),J))return!1}catch{return!1}}}if(C=g.child,g.subtreeFlags&16384&&C!==null)C.return=g,g=C;else{if(g===f)break;for(;g.sibling===null;){if(g.return===null||g.return===f)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function co(f,g){for(g&=~xc,g&=~fu,f.suspendedLanes|=g,f.pingedLanes&=~g,f=f.expirationTimes;0<g;){var C=31-ls(g),V=1<<C;f[C]=-1,g&=~V}}function Af(f){if((dn&6)!==0)throw Error(r(327));Tl();var g=Ki(f,0);if((g&1)===0)return ei(f,Xe()),null;var C=Sc(f,g);if(f.tag!==0&&C===2){var V=qs(f);V!==0&&(g=V,C=Id(f,V))}if(C===1)throw C=du,Vo(f,0),co(f,g),ei(f,Xe()),C;if(C===6)throw Error(r(345));return f.finishedWork=f.current.alternate,f.finishedLanes=g,Bo(f,Qs,Ma),ei(f,Xe()),null}function Nd(f,g){var C=dn;dn|=1;try{return f(g)}finally{dn=C,dn===0&&(Fo=Xe()+500,Uu&&Qa())}}function Lo(f){lo!==null&&lo.tag===0&&(dn&6)===0&&Tl();var g=dn;dn|=1;var C=Si.transition,V=Gr;try{if(Si.transition=null,Gr=1,f)return f()}finally{Gr=V,Si.transition=C,dn=g,(dn&6)===0&&Qa()}}function Dd(){li=Pl.current,Fn(Pl)}function Vo(f,g){f.finishedWork=null,f.finishedLanes=0;var C=f.timeoutHandle;if(C!==-1&&(f.timeoutHandle=-1,zl(C)),ss!==null)for(C=ss.return;C!==null;){var V=C;switch(Io(V),V.tag){case 1:V=V.type.childContextTypes,V!=null&&Bu();break;case 3:ro(),Fn(Zs),Fn(Ns),Ju();break;case 5:Yu(V);break;case 4:ro();break;case 13:Fn(Gn);break;case 19:Fn(Gn);break;case 10:Wu(V.type._context);break;case 22:case 23:Dd()}C=C.return}if(vs=f,ss=f=Gi(f.current,null),Ps=li=g,fs=0,du=null,xc=fu=ao=0,Qs=hu=null,No!==null){for(g=0;g<No.length;g++)if(C=No[g],V=C.interleaved,V!==null){C.interleaved=null;var J=V.next,se=C.pending;if(se!==null){var ve=se.next;se.next=J,V.next=ve}C.pending=V}No=null}return f}function Cf(f,g){do{var C=ss;try{if(Ta(),Yl.current=sc,gl){for(var V=qn.memoizedState;V!==null;){var J=V.queue;J!==null&&(J.pending=null),V=V.next}gl=!1}if(no=0,ds=Yn=qn=null,Jl=!1,jo=0,Pd.current=null,C===null||C.return===null){fs=1,du=g,ss=null;break}e:{var se=f,ve=C.return,we=C,Ie=g;if(g=Ps,we.flags|=32768,Ie!==null&&typeof Ie=="object"&&typeof Ie.then=="function"){var Ge=Ie,nt=we,vt=nt.tag;if((nt.mode&1)===0&&(vt===0||vt===11||vt===15)){var tt=nt.alternate;tt?(nt.updateQueue=tt.updateQueue,nt.memoizedState=tt.memoizedState,nt.lanes=tt.lanes):(nt.updateQueue=null,nt.memoizedState=null)}var Gt=yf(ve);if(Gt!==null){Gt.flags&=-257,hd(Gt,ve,we,se,g),Gt.mode&1&&nu(se,Ge,g),g=Gt,Ie=Ge;var tr=g.updateQueue;if(tr===null){var rr=new Set;rr.add(Ie),g.updateQueue=rr}else tr.add(Ie);break e}else{if((g&1)===0){nu(se,Ge,g),jd();break e}Ie=Error(r(426))}}else if(Ln&&we.mode&1){var Jn=yf(ve);if(Jn!==null){(Jn.flags&65536)===0&&(Jn.flags|=256),hd(Jn,ve,we,se,g),aa($o(Ie,we));break e}}se=Ie=$o(Ie,we),fs!==4&&(fs=2),hu===null?hu=[se]:hu.push(se),se=ve;do{switch(se.tag){case 3:se.flags|=65536,g&=-g,se.lanes|=g;var Fe=ru(se,Ie,g);uf(se,Fe);break e;case 1:we=Ie;var Ne=se.type,Le=se.stateNode;if((se.flags&128)===0&&(typeof Ne.getDerivedStateFromError=="function"||Le!==null&&typeof Le.componentDidCatch=="function"&&(oo===null||!oo.has(Le)))){se.flags|=65536,g&=-g,se.lanes|=g;var Ct=uc(se,we,g);uf(se,Ct);break e}}se=se.return}while(se!==null)}Nf(C)}catch(sr){g=sr,ss===C&&C!==null&&(ss=C=C.return);continue}break}while(!0)}function If(){var f=vc.current;return vc.current=sc,f===null?sc:f}function jd(){(fs===0||fs===3||fs===2)&&(fs=4),vs===null||(ao&268435455)===0&&(fu&268435455)===0||co(vs,Ps)}function Sc(f,g){var C=dn;dn|=2;var V=If();(vs!==f||Ps!==g)&&(Ma=null,Vo(f,g));do try{sh();break}catch(J){Cf(f,J)}while(!0);if(Ta(),dn=C,vc.current=V,ss!==null)throw Error(r(261));return vs=null,Ps=0,fs}function sh(){for(;ss!==null;)kf(ss)}function ih(){for(;ss!==null&&!et();)kf(ss)}function kf(f){var g=jf(f.alternate,f,li);f.memoizedProps=f.pendingProps,g===null?Nf(f):ss=g,Pd.current=null}function Nf(f){var g=f;do{var C=g.alternate;if(f=g.return,(g.flags&32768)===0){if(C=eh(C,g,li),C!==null){ss=C;return}}else{if(C=th(C,g),C!==null){C.flags&=32767,ss=C;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{fs=6,ss=null;return}}if(g=g.sibling,g!==null){ss=g;return}ss=g=f}while(g!==null);fs===0&&(fs=5)}function Bo(f,g,C){var V=Gr,J=Si.transition;try{Si.transition=null,Gr=1,ah(f,g,C,V)}finally{Si.transition=J,Gr=V}return null}function ah(f,g,C,V){do Tl();while(lo!==null);if((dn&6)!==0)throw Error(r(327));C=f.finishedWork;var J=f.finishedLanes;if(C===null)return null;if(f.finishedWork=null,f.finishedLanes=0,C===f.current)throw Error(r(177));f.callbackNode=null,f.callbackPriority=0;var se=C.lanes|C.childLanes;if(Cn(f,se),f===vs&&(ss=vs=null,Ps=0),(C.subtreeFlags&2064)===0&&(C.flags&2064)===0||bc||(bc=!0,Mf(cr,function(){return Tl(),null})),se=(C.flags&15990)!==0,(C.subtreeFlags&15990)!==0||se){se=Si.transition,Si.transition=null;var ve=Gr;Gr=1;var we=dn;dn|=4,Pd.current=null,rh(f,C),Sd(C,f),Xf(Po),Ua=!!Ul,Po=Ul=null,f.current=C,yc(C),Ye(),dn=we,Gr=ve,Si.transition=se}else f.current=C;if(bc&&(bc=!1,lo=f,Gs=J),se=f.pendingLanes,se===0&&(oo=null),Sn(C.stateNode),ei(f,Xe()),g!==null)for(V=f.onRecoverableError,C=0;C<g.length;C++)J=g[C],V(J.value,{componentStack:J.stack,digest:J.digest});if(_c)throw _c=!1,f=Ad,Ad=null,f;return(Gs&1)!==0&&f.tag!==0&&Tl(),se=f.pendingLanes,(se&1)!==0?f===Cd?pu++:(pu=0,Cd=f):pu=0,Qa(),null}function Tl(){if(lo!==null){var f=ri(Gs),g=Si.transition,C=Gr;try{if(Si.transition=null,Gr=16>f?16:f,lo===null)var V=!1;else{if(f=lo,lo=null,Gs=0,(dn&6)!==0)throw Error(r(331));var J=dn;for(dn|=4,Kt=f.current;Kt!==null;){var se=Kt,ve=se.child;if((Kt.flags&16)!==0){var we=se.deletions;if(we!==null){for(var Ie=0;Ie<we.length;Ie++){var Ge=we[Ie];for(Kt=Ge;Kt!==null;){var nt=Kt;switch(nt.tag){case 0:case 11:case 15:ja(8,nt,se)}var vt=nt.child;if(vt!==null)vt.return=nt,Kt=vt;else for(;Kt!==null;){nt=Kt;var tt=nt.sibling,Gt=nt.return;if(wf(nt),nt===Ge){Kt=null;break}if(tt!==null){tt.return=Gt,Kt=tt;break}Kt=Gt}}}var tr=se.alternate;if(tr!==null){var rr=tr.child;if(rr!==null){tr.child=null;do{var Jn=rr.sibling;rr.sibling=null,rr=Jn}while(rr!==null)}}Kt=se}}if((se.subtreeFlags&2064)!==0&&ve!==null)ve.return=se,Kt=ve;else e:for(;Kt!==null;){if(se=Kt,(se.flags&2048)!==0)switch(se.tag){case 0:case 11:case 15:ja(9,se,se.return)}var Fe=se.sibling;if(Fe!==null){Fe.return=se.return,Kt=Fe;break e}Kt=se.return}}var Ne=f.current;for(Kt=Ne;Kt!==null;){ve=Kt;var Le=ve.child;if((ve.subtreeFlags&2064)!==0&&Le!==null)Le.return=ve,Kt=Le;else e:for(ve=Ne;Kt!==null;){if(we=Kt,(we.flags&2048)!==0)try{switch(we.tag){case 0:case 11:case 15:cu(9,we)}}catch(sr){Wn(we,we.return,sr)}if(we===ve){Kt=null;break e}var Ct=we.sibling;if(Ct!==null){Ct.return=we.return,Kt=Ct;break e}Kt=we.return}}if(dn=J,Qa(),An&&typeof An.onPostCommitFiberRoot=="function")try{An.onPostCommitFiberRoot(un,f)}catch{}V=!0}return V}finally{Gr=C,Si.transition=g}}return!1}function Rc(f,g,C){g=$o(C,g),g=ru(f,g,1),f=bi(f,g,1),g=zs(),f!==null&&(Ba(f,1,g),ei(f,g))}function Wn(f,g,C){if(f.tag===3)Rc(f,f,C);else for(;g!==null;){if(g.tag===3){Rc(g,f,C);break}else if(g.tag===1){var V=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof V.componentDidCatch=="function"&&(oo===null||!oo.has(V))){f=$o(C,f),f=uc(g,f,1),g=bi(g,f,1),f=zs(),g!==null&&(Ba(g,1,f),ei(g,f));break}}g=g.return}}function oh(f,g,C){var V=f.pingCache;V!==null&&V.delete(g),g=zs(),f.pingedLanes|=f.suspendedLanes&C,vs===f&&(Ps&C)===C&&(fs===4||fs===3&&(Ps&130023424)===Ps&&500>Xe()-Td?Vo(f,0):xc|=C),ei(f,g)}function Df(f,g){g===0&&((f.mode&1)===0?g=1:(g=La,La<<=1,(La&130023424)===0&&(La=4194304)));var C=zs();f=Aa(f,g),f!==null&&(Ba(f,g,C),ei(f,C))}function lh(f){var g=f.memoizedState,C=0;g!==null&&(C=g.retryLane),Df(f,C)}function uh(f,g){var C=0;switch(f.tag){case 13:var V=f.stateNode,J=f.memoizedState;J!==null&&(C=J.retryLane);break;case 19:V=f.stateNode;break;default:throw Error(r(314))}V!==null&&V.delete(g),Df(f,C)}var jf;jf=function(f,g,C){if(f!==null)if(f.memoizedProps!==g.pendingProps||Zs.current)Bs=!0;else{if((f.lanes&C)===0&&(g.flags&128)===0)return Bs=!1,_f(f,g,C);Bs=(f.flags&131072)!==0}else Bs=!1,Ln&&(g.flags&1048576)!==0&&nf(g,zu,g.index);switch(g.lanes=0,g.tag){case 2:var V=g.type;hc(f,g),f=g.pendingProps;var J=dl(g,Ns.current);to(g,C),J=Mo(null,g,V,f,J,C);var se=Qu();return g.flags|=1,typeof J=="object"&&J!==null&&typeof J.render=="function"&&J.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,Xs(V)?(se=!0,gi(g)):se=!1,g.memoizedState=J.state!==null&&J.state!==void 0?J.state:null,Zu(g),J.updater=oc,g.stateNode=J,J._reactInternals=g,fd(g,V,f,C),g=xd(null,g,V,!0,se,C)):(g.tag=0,Ln&&se&&Hl(g),ws(null,g,J,C),g=g.child),g;case 16:V=g.elementType;e:{switch(hc(f,g),f=g.pendingProps,J=V._init,V=J(V._payload),g.type=V,J=g.tag=dh(V),f=wi(V,f),J){case 0:g=yd(null,g,V,f,C);break e;case 1:g=vd(null,g,V,f,C);break e;case 11:g=vf(null,g,V,f,C);break e;case 14:g=pd(null,g,V,wi(V.type,f),C);break e}throw Error(r(306,V,""))}return g;case 0:return V=g.type,J=g.pendingProps,J=g.elementType===V?J:wi(V,J),yd(f,g,V,J,C);case 1:return V=g.type,J=g.pendingProps,J=g.elementType===V?J:wi(V,J),vd(f,g,V,J,C);case 3:e:{if(xf(g),f===null)throw Error(r(387));V=g.pendingProps,se=g.memoizedState,J=se.element,lf(f,g),pl(g,V,null,C);var ve=g.memoizedState;if(V=ve.element,se.isDehydrated)if(se={element:V,isDehydrated:!1,cache:ve.cache,pendingSuspenseBoundaries:ve.pendingSuspenseBoundaries,transitions:ve.transitions},g.updateQueue.baseState=se,g.memoizedState=se,g.flags&256){J=$o(Error(r(423)),g),g=da(f,g,V,C,J);break e}else if(V!==J){J=$o(Error(r(424)),g),g=da(f,g,V,C,J);break e}else for(ii=Xa(g.stateNode.containerInfo.firstChild),js=g,Ln=!0,Oi=null,C=qu(g,null,V,C),g.child=C;C;)C.flags=C.flags&-3|4096,C=C.sibling;else{if(ia(),V===J){g=Fi(f,g,C);break e}ws(f,g,V,C)}g=g.child}return g;case 5:return Jc(g),f===null&&Ys(g),V=g.type,J=g.pendingProps,se=f!==null?f.memoizedProps:null,ve=J.children,Gl(V,J)?ve=null:se!==null&&Gl(V,se)&&(g.flags|=32),gd(f,g),ws(f,g,ve,C),g.child;case 6:return f===null&&Ys(g),null;case 13:return fc(f,g,C);case 4:return Yc(g,g.stateNode.containerInfo),V=g.pendingProps,f===null?g.child=Zn(g,null,V,C):ws(f,g,V,C),g.child;case 11:return V=g.type,J=g.pendingProps,J=g.elementType===V?J:wi(V,J),vf(f,g,V,J,C);case 7:return ws(f,g,g.pendingProps,C),g.child;case 8:return ws(f,g,g.pendingProps.children,C),g.child;case 12:return ws(f,g,g.pendingProps.children,C),g.child;case 10:e:{if(V=g.type._context,J=g.pendingProps,se=g.memoizedProps,ve=J.value,On(Kl,V._currentValue),V._currentValue=ve,se!==null)if(Be(se.value,ve)){if(se.children===J.children&&!Zs.current){g=Fi(f,g,C);break e}}else for(se=g.child,se!==null&&(se.return=g);se!==null;){var we=se.dependencies;if(we!==null){ve=se.child;for(var Ie=we.firstContext;Ie!==null;){if(Ie.context===V){if(se.tag===1){Ie=Ca(-1,C&-C),Ie.tag=2;var Ge=se.updateQueue;if(Ge!==null){Ge=Ge.shared;var nt=Ge.pending;nt===null?Ie.next=Ie:(Ie.next=nt.next,nt.next=Ie),Ge.pending=Ie}}se.lanes|=C,Ie=se.alternate,Ie!==null&&(Ie.lanes|=C),Es(se.return,C,g),we.lanes|=C;break}Ie=Ie.next}}else if(se.tag===10)ve=se.type===g.type?null:se.child;else if(se.tag===18){if(ve=se.return,ve===null)throw Error(r(341));ve.lanes|=C,we=ve.alternate,we!==null&&(we.lanes|=C),Es(ve,C,g),ve=se.sibling}else ve=se.child;if(ve!==null)ve.return=se;else for(ve=se;ve!==null;){if(ve===g){ve=null;break}if(se=ve.sibling,se!==null){se.return=ve.return,ve=se;break}ve=ve.return}se=ve}ws(f,g,J.children,C),g=g.child}return g;case 9:return J=g.type,V=g.pendingProps.children,to(g,C),J=xi(J),V=V(J),g.flags|=1,ws(f,g,V,C),g.child;case 14:return V=g.type,J=wi(V,g.pendingProps),J=wi(V.type,J),pd(f,g,V,J,C);case 15:return ca(f,g,g.type,g.pendingProps,C);case 17:return V=g.type,J=g.pendingProps,J=g.elementType===V?J:wi(V,J),hc(f,g),g.tag=1,Xs(V)?(f=!0,gi(g)):f=!1,to(g,C),Oo(g,V,J),fd(g,V,J,C),xd(null,g,V,!0,f,C);case 19:return so(f,g,C);case 22:return md(f,g,C)}throw Error(r(156,g.tag))};function Mf(f,g){return Se(f,g)}function ch(f,g,C,V){this.tag=f,this.key=C,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=V,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ri(f,g,C,V){return new ch(f,g,C,V)}function Pc(f){return f=f.prototype,!(!f||!f.isReactComponent)}function dh(f){if(typeof f=="function")return Pc(f)?1:0;if(f!=null){if(f=f.$$typeof,f===fe)return 11;if(f===me)return 14}return 2}function Gi(f,g){var C=f.alternate;return C===null?(C=Ri(f.tag,g,f.key,f.mode),C.elementType=f.elementType,C.type=f.type,C.stateNode=f.stateNode,C.alternate=f,f.alternate=C):(C.pendingProps=g,C.type=f.type,C.flags=0,C.subtreeFlags=0,C.deletions=null),C.flags=f.flags&14680064,C.childLanes=f.childLanes,C.lanes=f.lanes,C.child=f.child,C.memoizedProps=f.memoizedProps,C.memoizedState=f.memoizedState,C.updateQueue=f.updateQueue,g=f.dependencies,C.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},C.sibling=f.sibling,C.index=f.index,C.ref=f.ref,C}function Tc(f,g,C,V,J,se){var ve=2;if(V=f,typeof f=="function")Pc(f)&&(ve=1);else if(typeof f=="string")ve=5;else e:switch(f){case W:return Uo(C.children,J,se,g);case H:ve=8,J|=8;break;case ee:return f=Ri(12,C,g,J|2),f.elementType=ee,f.lanes=se,f;case ae:return f=Ri(13,C,g,J),f.elementType=ae,f.lanes=se,f;case ce:return f=Ri(19,C,g,J),f.elementType=ce,f.lanes=se,f;case le:return Ac(C,J,se,g);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case ue:ve=10;break e;case de:ve=9;break e;case fe:ve=11;break e;case me:ve=14;break e;case te:ve=16,V=null;break e}throw Error(r(130,f==null?f:typeof f,""))}return g=Ri(ve,C,g,J),g.elementType=f,g.type=V,g.lanes=se,g}function Uo(f,g,C,V){return f=Ri(7,f,V,g),f.lanes=C,f}function Ac(f,g,C,V){return f=Ri(22,f,V,g),f.elementType=le,f.lanes=C,f.stateNode={isHidden:!1},f}function Md(f,g,C){return f=Ri(6,f,null,g),f.lanes=C,f}function Od(f,g,C){return g=Ri(4,f.children!==null?f.children:[],f.key,g),g.lanes=C,g.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},g}function fh(f,g,C,V,J){this.tag=g,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zi(0),this.expirationTimes=Zi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zi(0),this.identifierPrefix=V,this.onRecoverableError=J,this.mutableSourceEagerHydrationData=null}function $d(f,g,C,V,J,se,ve,we,Ie){return f=new fh(f,g,C,we,Ie),g===1?(g=1,se===!0&&(g|=8)):g=0,se=Ri(3,null,null,g),f.current=se,se.stateNode=f,se.memoizedState={element:V,isDehydrated:C,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zu(se),f}function hh(f,g,C){var V=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:K,key:V==null?null:""+V,children:f,containerInfo:g,implementation:C}}function Of(f){if(!f)return Ja;f=f._reactInternals;e:{if(Tn(f)!==f||f.tag!==1)throw Error(r(170));var g=f;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(Xs(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(r(171))}if(f.tag===1){var C=f.type;if(Xs(C))return ef(f,C,g)}return g}function $f(f,g,C,V,J,se,ve,we,Ie){return f=$d(C,V,!0,f,J,se,ve,we,Ie),f.context=Of(null),C=f.current,V=zs(),J=uo(C),se=Ca(V,J),se.callback=g??null,bi(C,se,J),f.current.lanes=J,Ba(f,J,V),ei(f,V),f}function Cc(f,g,C,V){var J=g.current,se=zs(),ve=uo(J);return C=Of(C),g.context===null?g.context=C:g.pendingContext=C,g=Ca(se,ve),g.payload={element:f},V=V===void 0?null:V,V!==null&&(g.callback=V),f=bi(J,g,ve),f!==null&&(Ui(f,J,ve,se),Xu(f,J,ve)),ve}function Ic(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return f.child.stateNode;default:return f.child.stateNode}}function Ff(f,g){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var C=f.retryLane;f.retryLane=C!==0&&C<g?C:g}}function Fd(f,g){Ff(f,g),(f=f.alternate)&&Ff(f,g)}function ph(){return null}var Lf=typeof reportError=="function"?reportError:function(f){console.error(f)};function kc(f){this._internalRoot=f}gu.prototype.render=kc.prototype.render=function(f){var g=this._internalRoot;if(g===null)throw Error(r(409));Cc(f,g,null,null)},gu.prototype.unmount=kc.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var g=f.containerInfo;Lo(function(){Cc(null,f,null,null)}),g[si]=null}};function gu(f){this._internalRoot=f}gu.prototype.unstable_scheduleHydration=function(f){if(f){var g=Il();f={blockedOn:null,target:f,priority:g};for(var C=0;C<Yi.length&&g!==0&&g<Yi[C].priority;C++);Yi.splice(C,0,f),C===0&&Eu(f)}};function Ld(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}function Nc(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11&&(f.nodeType!==8||f.nodeValue!==" react-mount-point-unstable "))}function Vf(){}function mh(f,g,C,V,J){if(J){if(typeof V=="function"){var se=V;V=function(){var Ge=Ic(ve);se.call(Ge)}}var ve=$f(g,V,f,0,null,!1,!1,"",Vf);return f._reactRootContainer=ve,f[si]=ve.current,Ka(f.nodeType===8?f.parentNode:f),Lo(),ve}for(;J=f.lastChild;)f.removeChild(J);if(typeof V=="function"){var we=V;V=function(){var Ge=Ic(Ie);we.call(Ge)}}var Ie=$d(f,0,!1,null,null,!1,!1,"",Vf);return f._reactRootContainer=Ie,f[si]=Ie.current,Ka(f.nodeType===8?f.parentNode:f),Lo(function(){Cc(g,Ie,C,V)}),Ie}function Go(f,g,C,V,J){var se=C._reactRootContainer;if(se){var ve=se;if(typeof J=="function"){var we=J;J=function(){var Ie=Ic(ve);we.call(Ie)}}Cc(g,ve,f,J)}else ve=mh(C,g,f,J,V);return Ic(ve)}Cl=function(f){switch(f.tag){case 3:var g=f.stateNode;if(g.current.memoizedState.isDehydrated){var C=pa(g.pendingLanes);C!==0&&(Xi(g,C|1),ei(g,Xe()),(dn&6)===0&&(Fo=Xe()+500,Qa()))}break;case 13:Lo(function(){var V=Aa(f,1);if(V!==null){var J=zs();Ui(V,f,1,J)}}),Fd(f,1)}},po=function(f){if(f.tag===13){var g=Aa(f,134217728);if(g!==null){var C=zs();Ui(g,f,134217728,C)}Fd(f,134217728)}},_u=function(f){if(f.tag===13){var g=uo(f),C=Aa(f,g);if(C!==null){var V=zs();Ui(C,f,g,V)}Fd(f,g)}},Il=function(){return Gr},kl=function(f,g){var C=Gr;try{return Gr=f,g()}finally{Gr=C}},$r=function(f,g,C){switch(g){case"input":if(Lt(f,C),g=C.name,C.type==="radio"&&g!=null){for(C=f;C.parentNode;)C=C.parentNode;for(C=C.querySelectorAll("input[name="+JSON.stringify(""+g)+'][type="radio"]'),g=0;g<C.length;g++){var V=C[g];if(V!==f&&V.form===f.form){var J=Vu(V);if(!J)throw Error(r(90));Et(V),Lt(V,J)}}}break;case"textarea":Pr(f,C);break;case"select":g=C.value,g!=null&&er(f,!!C.multiple,g,!1)}},Hr=Nd,qr=Lo;var gh={usingClientEntryPoint:!1,Events:[ks,Mr,Vu,Er,Nn,Nd]},yu={findFiberByHostInstance:ta,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},yh={bundleType:yu.bundleType,version:yu.version,rendererPackageName:yu.rendererPackageName,rendererConfig:yu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:I.ReactCurrentDispatcher,findHostInstanceByFiber:function(f){return f=ci(f),f===null?null:f.stateNode},findFiberByHostInstance:yu.findFiberByHostInstance||ph,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Dc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dc.isDisabled&&Dc.supportsFiber)try{un=Dc.inject(yh),An=Dc}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gh,reactDom_production_min.createPortal=function(f,g){var C=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ld(g))throw Error(r(200));return hh(f,g,null,C)},reactDom_production_min.createRoot=function(f,g){if(!Ld(f))throw Error(r(299));var C=!1,V="",J=Lf;return g!=null&&(g.unstable_strictMode===!0&&(C=!0),g.identifierPrefix!==void 0&&(V=g.identifierPrefix),g.onRecoverableError!==void 0&&(J=g.onRecoverableError)),g=$d(f,1,!1,null,null,C,!1,V,J),f[si]=g.current,Ka(f.nodeType===8?f.parentNode:f),new kc(g)},reactDom_production_min.findDOMNode=function(f){if(f==null)return null;if(f.nodeType===1)return f;var g=f._reactInternals;if(g===void 0)throw typeof f.render=="function"?Error(r(188)):(f=Object.keys(f).join(","),Error(r(268,f)));return f=ci(g),f=f===null?null:f.stateNode,f},reactDom_production_min.flushSync=function(f){return Lo(f)},reactDom_production_min.hydrate=function(f,g,C){if(!Nc(g))throw Error(r(200));return Go(null,f,g,!0,C)},reactDom_production_min.hydrateRoot=function(f,g,C){if(!Ld(f))throw Error(r(405));var V=C!=null&&C.hydratedSources||null,J=!1,se="",ve=Lf;if(C!=null&&(C.unstable_strictMode===!0&&(J=!0),C.identifierPrefix!==void 0&&(se=C.identifierPrefix),C.onRecoverableError!==void 0&&(ve=C.onRecoverableError)),g=$f(g,null,f,1,C??null,J,!1,se,ve),f[si]=g.current,Ka(f),V)for(f=0;f<V.length;f++)C=V[f],J=C._getVersion,J=J(C._source),g.mutableSourceEagerHydrationData==null?g.mutableSourceEagerHydrationData=[C,J]:g.mutableSourceEagerHydrationData.push(C,J);return new gu(g)},reactDom_production_min.render=function(f,g,C){if(!Nc(g))throw Error(r(200));return Go(null,f,g,!1,C)},reactDom_production_min.unmountComponentAtNode=function(f){if(!Nc(f))throw Error(r(40));return f._reactRootContainer?(Lo(function(){Go(null,null,f,!1,function(){f._reactRootContainer=null,f[si]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=Nd,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(f,g,C,V){if(!Nc(C))throw Error(r(200));if(f==null||f._reactInternals===void 0)throw Error(r(38));return Go(f,g,C,!1,V)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client$1;hasRequiredClient=1;var t=requireReactDom();return client$1.createRoot=t.createRoot,client$1.hydrateRoot=t.hydrateRoot,client$1}var clientExports=requireClient(),reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);var dist$1={},hasRequiredDist$1;function requireDist$1(){if(hasRequiredDist$1)return dist$1;hasRequiredDist$1=1,Object.defineProperty(dist$1,"__esModule",{value:!0}),dist$1.parse=o,dist$1.serialize=c;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,s=Object.prototype.toString,a=(()=>{const m=function(){};return m.prototype=Object.create(null),m})();function o(m,y){const b=new a,E=m.length;if(E<2)return b;const T=(y==null?void 0:y.decode)||d;let S=0;do{const P=m.indexOf("=",S);if(P===-1)break;const A=m.indexOf(";",S),I=A===-1?E:A;if(P>I){S=m.lastIndexOf(";",P-1)+1;continue}const j=l(m,S,P),K=u(m,P,j),W=m.slice(j,K);if(b[W]===void 0){let H=l(m,P+1,I),ee=u(m,I,H);const ue=T(m.slice(H,ee));b[W]=ue}S=I+1}while(S<E);return b}function l(m,y,b){do{const E=m.charCodeAt(y);if(E!==32&&E!==9)return y}while(++y<b);return b}function u(m,y,b){for(;y>b;){const E=m.charCodeAt(--y);if(E!==32&&E!==9)return y+1}return b}function c(m,y,b){const E=(b==null?void 0:b.encode)||encodeURIComponent;if(!t.test(m))throw new TypeError(`argument name is invalid: ${m}`);const T=E(y);if(!e.test(T))throw new TypeError(`argument val is invalid: ${y}`);let S=m+"="+T;if(!b)return S;if(b.maxAge!==void 0){if(!Number.isInteger(b.maxAge))throw new TypeError(`option maxAge is invalid: ${b.maxAge}`);S+="; Max-Age="+b.maxAge}if(b.domain){if(!r.test(b.domain))throw new TypeError(`option domain is invalid: ${b.domain}`);S+="; Domain="+b.domain}if(b.path){if(!n.test(b.path))throw new TypeError(`option path is invalid: ${b.path}`);S+="; Path="+b.path}if(b.expires){if(!p(b.expires)||!Number.isFinite(b.expires.valueOf()))throw new TypeError(`option expires is invalid: ${b.expires}`);S+="; Expires="+b.expires.toUTCString()}if(b.httpOnly&&(S+="; HttpOnly"),b.secure&&(S+="; Secure"),b.partitioned&&(S+="; Partitioned"),b.priority)switch(typeof b.priority=="string"?b.priority.toLowerCase():void 0){case"low":S+="; Priority=Low";break;case"medium":S+="; Priority=Medium";break;case"high":S+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${b.priority}`)}if(b.sameSite)switch(typeof b.sameSite=="string"?b.sameSite.toLowerCase():b.sameSite){case!0:case"strict":S+="; SameSite=Strict";break;case"lax":S+="; SameSite=Lax";break;case"none":S+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${b.sameSite}`)}return S}function d(m){if(m.indexOf("%")===-1)return m;try{return decodeURIComponent(m)}catch{return m}}function p(m){return s.call(m)==="[object Date]"}return dist$1}requireDist$1();var PopStateEventType="popstate";function createBrowserHistory(t={}){function e(n,s){let{pathname:a,search:o,hash:l}=n.location;return createLocation("",{pathname:a,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:createPath(s)}return getUrlBasedHistory(e,r,null,t)}function invariant$3(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function warning(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function createKey(){return Math.random().toString(36).substring(2,10)}function getHistoryState(t,e){return{usr:t.state,key:t.key,idx:e}}function createLocation(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?parsePath(e):e,state:r,key:e&&e.key||n||createKey()}}function createPath({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function parsePath(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function getUrlBasedHistory(t,e,r,n={}){let{window:s=document.defaultView,v5Compat:a=!1}=n,o=s.history,l="POP",u=null,c=d();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function d(){return(o.state||{idx:null}).idx}function p(){l="POP";let T=d(),S=T==null?null:T-c;c=T,u&&u({action:l,location:E.location,delta:S})}function m(T,S){l="PUSH";let P=createLocation(E.location,T,S);c=d()+1;let A=getHistoryState(P,c),I=E.createHref(P);try{o.pushState(A,"",I)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;s.location.assign(I)}a&&u&&u({action:l,location:E.location,delta:1})}function y(T,S){l="REPLACE";let P=createLocation(E.location,T,S);c=d();let A=getHistoryState(P,c),I=E.createHref(P);o.replaceState(A,"",I),a&&u&&u({action:l,location:E.location,delta:0})}function b(T){return createBrowserURLImpl(T)}let E={get action(){return l},get location(){return t(s,o)},listen(T){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(PopStateEventType,p),u=T,()=>{s.removeEventListener(PopStateEventType,p),u=null}},createHref(T){return e(s,T)},createURL:b,encodeLocation(T){let S=b(T);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:m,replace:y,go(T){return o.go(T)}};return E}function createBrowserURLImpl(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),invariant$3(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:createPath(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function matchRoutes(t,e,r="/"){return matchRoutesImpl(t,e,r,!1)}function matchRoutesImpl(t,e,r,n){let s=typeof e=="string"?parsePath(e):e,a=stripBasename(s.pathname||"/",r);if(a==null)return null;let o=flattenRoutes(t);rankRouteBranches(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let c=decodePath(a);l=matchRouteBranch(o[u],c,n)}return l}function flattenRoutes(t,e=[],r=[],n=""){let s=(a,o,l)=>{let u={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};u.relativePath.startsWith("/")&&(invariant$3(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length));let c=joinPaths([n,u.relativePath]),d=r.concat(u);a.children&&a.children.length>0&&(invariant$3(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),flattenRoutes(a.children,e,d,c)),!(a.path==null&&!a.index)&&e.push({path:c,score:computeScore(c,a.index),routesMeta:d})};return t.forEach((a,o)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))s(a,o);else for(let u of explodeOptionalSegments(a.path))s(a,o,u)}),e}function explodeOptionalSegments(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let o=explodeOptionalSegments(n.join("/")),l=[];return l.push(...o.map(u=>u===""?a:[a,u].join("/"))),s&&l.push(...o),l.map(u=>t.startsWith("/")&&u===""?"/":u)}function rankRouteBranches(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:compareIndexes(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=t=>t==="*";function computeScore(t,e){let r=t.split("/"),n=r.length;return r.some(isSplat)&&(n+=splatPenalty),e&&(n+=indexRouteValue),r.filter(s=>!isSplat(s)).reduce((s,a)=>s+(paramRe.test(a)?dynamicSegmentValue:a===""?emptySegmentValue:staticSegmentValue),n)}function compareIndexes(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function matchRouteBranch(t,e,r=!1){let{routesMeta:n}=t,s={},a="/",o=[];for(let l=0;l<n.length;++l){let u=n[l],c=l===n.length-1,d=a==="/"?e:e.slice(a.length)||"/",p=matchPath({path:u.relativePath,caseSensitive:u.caseSensitive,end:c},d),m=u.route;if(!p&&c&&r&&!n[n.length-1].route.index&&(p=matchPath({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},d)),!p)return null;Object.assign(s,p.params),o.push({params:s,pathname:joinPaths([a,p.pathname]),pathnameBase:normalizePathname(joinPaths([a,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(a=joinPaths([a,p.pathnameBase]))}return o}function matchPath(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=compilePath(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let a=s[0],o=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((c,{paramName:d,isOptional:p},m)=>{if(d==="*"){let b=l[m]||"";o=a.slice(0,a.length-b.length).replace(/(.)\/+$/,"$1")}const y=l[m];return p&&!y?c[d]=void 0:c[d]=(y||"").replace(/%2F/g,"/"),c},{}),pathname:a,pathnameBase:o,pattern:t}}function compilePath(t,e=!1,r=!0){warning(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(n.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function decodePath(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return warning(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function stripBasename(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function resolvePath(t,e="/"){let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?parsePath(t):t;return{pathname:r?r.startsWith("/")?r:resolvePathname(r,e):e,search:normalizeSearch(n),hash:normalizeHash(s)}}function resolvePathname(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function getInvalidPathError(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function getResolveToMatches(t){let e=getPathContributingMatches(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function resolveTo(t,e,r,n=!1){let s;typeof t=="string"?s=parsePath(t):(s={...t},invariant$3(!s.pathname||!s.pathname.includes("?"),getInvalidPathError("?","pathname","search",s)),invariant$3(!s.pathname||!s.pathname.includes("#"),getInvalidPathError("#","pathname","hash",s)),invariant$3(!s.search||!s.search.includes("#"),getInvalidPathError("#","search","hash",s)));let a=t===""||s.pathname==="",o=a?"/":s.pathname,l;if(o==null)l=r;else{let p=e.length-1;if(!n&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;s.pathname=m.join("/")}l=p>=0?e[p]:"/"}let u=resolvePath(s,l),c=o&&o!=="/"&&o.endsWith("/"),d=(a||o===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(c||d)&&(u.pathname+="/"),u}var joinPaths=t=>t.join("/").replace(/\/\/+/g,"/"),normalizePathname=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,normalizeHash=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function isRouteErrorResponse(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=reactExports.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=reactExports.createContext(null);DataRouterStateContext.displayName="DataRouterState";var ViewTransitionContext=reactExports.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=reactExports.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=reactExports.createContext(null);AwaitContext.displayName="Await";var NavigationContext=reactExports.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=reactExports.createContext(null);LocationContext.displayName="Location";var RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=reactExports.createContext(null);RouteErrorContext.displayName="RouteError";function useHref(t,{relative:e}={}){invariant$3(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=reactExports.useContext(NavigationContext),{hash:s,pathname:a,search:o}=useResolvedPath(t,{relative:e}),l=a;return r!=="/"&&(l=a==="/"?r:joinPaths([r,a])),n.createHref({pathname:l,search:o,hash:s})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return invariant$3(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),reactExports.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect$5(t){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(t)}function useNavigate(){let{isDataRoute:t}=reactExports.useContext(RouteContext);return t?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant$3(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let t=reactExports.useContext(DataRouterContext),{basename:e,navigator:r}=reactExports.useContext(NavigationContext),{matches:n}=reactExports.useContext(RouteContext),{pathname:s}=useLocation(),a=JSON.stringify(getResolveToMatches(n)),o=reactExports.useRef(!1);return useIsomorphicLayoutEffect$5(()=>{o.current=!0}),reactExports.useCallback((u,c={})=>{if(warning(o.current,navigateEffectWarning),!o.current)return;if(typeof u=="number"){r.go(u);return}let d=resolveTo(u,JSON.parse(a),s,c.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:joinPaths([e,d.pathname])),(c.replace?r.replace:r.push)(d,c.state,c)},[e,r,a,s,t])}reactExports.createContext(null);function useParams(){let{matches:t}=reactExports.useContext(RouteContext),e=t[t.length-1];return e?e.params:{}}function useResolvedPath(t,{relative:e}={}){let{matches:r}=reactExports.useContext(RouteContext),{pathname:n}=useLocation(),s=JSON.stringify(getResolveToMatches(r));return reactExports.useMemo(()=>resolveTo(t,JSON.parse(s),n,e==="path"),[t,s,n,e])}function useRoutes(t,e){return useRoutesImpl(t,e)}function useRoutesImpl(t,e,r,n){var S;invariant$3(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=reactExports.useContext(NavigationContext),{matches:a}=reactExports.useContext(RouteContext),o=a[a.length-1],l=o?o.params:{},u=o?o.pathname:"/",c=o?o.pathnameBase:"/",d=o&&o.route;{let P=d&&d.path||"";warningOnce(u,!d||P.endsWith("*")||P.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${P}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${P}"> to <Route path="${P==="/"?"*":`${P}/*`}">.`)}let p=useLocation(),m;if(e){let P=typeof e=="string"?parsePath(e):e;invariant$3(c==="/"||((S=P.pathname)==null?void 0:S.startsWith(c)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${c}" but pathname "${P.pathname}" was given in the \`location\` prop.`),m=P}else m=p;let y=m.pathname||"/",b=y;if(c!=="/"){let P=c.replace(/^\//,"").split("/");b="/"+y.replace(/^\//,"").split("/").slice(P.length).join("/")}let E=matchRoutes(t,{pathname:b});warning(d||E!=null,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),warning(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=_renderMatches(E&&E.map(P=>Object.assign({},P,{params:Object.assign({},l,P.params),pathname:joinPaths([c,s.encodeLocation?s.encodeLocation(P.pathname).pathname:P.pathname]),pathnameBase:P.pathnameBase==="/"?c:joinPaths([c,s.encodeLocation?s.encodeLocation(P.pathnameBase).pathname:P.pathnameBase])})),a,r,n);return e&&T?reactExports.createElement(LocationContext.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},T):T}function DefaultErrorComponent(){let t=useRouteError(),e=isRouteErrorResponse(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("p",null,"💿 Hey developer 👋"),reactExports.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",reactExports.createElement("code",{style:a},"ErrorBoundary")," or"," ",reactExports.createElement("code",{style:a},"errorElement")," prop on your route.")),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},e),r?reactExports.createElement("pre",{style:s},r):null,o)}var defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends reactExports.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:t,match:e,children:r}){let n=reactExports.useContext(DataRouterContext);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),reactExports.createElement(RouteContext.Provider,{value:t},r)}function _renderMatches(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let s=t,a=r==null?void 0:r.errors;if(a!=null){let u=s.findIndex(c=>c.route.id&&(a==null?void 0:a[c.route.id])!==void 0);invariant$3(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),s=s.slice(0,Math.min(s.length,u+1))}let o=!1,l=-1;if(r)for(let u=0;u<s.length;u++){let c=s[u];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(l=u),c.route.id){let{loaderData:d,errors:p}=r,m=c.route.loader&&!d.hasOwnProperty(c.route.id)&&(!p||p[c.route.id]===void 0);if(c.route.lazy||m){o=!0,l>=0?s=s.slice(0,l+1):s=[s[0]];break}}}return s.reduceRight((u,c,d)=>{let p,m=!1,y=null,b=null;r&&(p=a&&c.route.id?a[c.route.id]:void 0,y=c.route.errorElement||defaultErrorElement,o&&(l<0&&d===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,b=null):l===d&&(m=!0,b=c.route.hydrateFallbackElement||null)));let E=e.concat(s.slice(0,d+1)),T=()=>{let S;return p?S=y:m?S=b:c.route.Component?S=reactExports.createElement(c.route.Component,null):c.route.element?S=c.route.element:S=u,reactExports.createElement(RenderedRoute,{match:c,routeContext:{outlet:u,matches:E,isDataRoute:r!=null},children:S})};return r&&(c.route.ErrorBoundary||c.route.errorElement||d===0)?reactExports.createElement(RenderErrorBoundary,{location:r.location,revalidation:r.revalidation,component:y,error:p,children:T(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):T()},null)}function getDataRouterConsoleError(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(t){let e=reactExports.useContext(DataRouterContext);return invariant$3(e,getDataRouterConsoleError(t)),e}function useDataRouterState(t){let e=reactExports.useContext(DataRouterStateContext);return invariant$3(e,getDataRouterConsoleError(t)),e}function useRouteContext(t){let e=reactExports.useContext(RouteContext);return invariant$3(e,getDataRouterConsoleError(t)),e}function useCurrentRouteId(t){let e=useRouteContext(t),r=e.matches[e.matches.length-1];return invariant$3(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){var n;let t=reactExports.useContext(RouteErrorContext),e=useDataRouterState("useRouteError"),r=useCurrentRouteId("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function useNavigateStable(){let{router:t}=useDataRouterContext("useNavigate"),e=useCurrentRouteId("useNavigate"),r=reactExports.useRef(!1);return useIsomorphicLayoutEffect$5(()=>{r.current=!0}),reactExports.useCallback(async(s,a={})=>{warning(r.current,navigateEffectWarning),r.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...a}))},[t,e])}var alreadyWarned={};function warningOnce(t,e,r){!e&&!alreadyWarned[t]&&(alreadyWarned[t]=!0,warning(!1,r))}reactExports.memo(DataRoutes);function DataRoutes({routes:t,future:e,state:r}){return useRoutesImpl(t,void 0,r,e)}function Navigate({to:t,replace:e,state:r,relative:n}){invariant$3(useInRouterContext(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=reactExports.useContext(NavigationContext);warning(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=reactExports.useContext(RouteContext),{pathname:o}=useLocation(),l=useNavigate(),u=resolveTo(t,getResolveToMatches(a),o,n==="path"),c=JSON.stringify(u);return reactExports.useEffect(()=>{l(JSON.parse(c),{replace:e,state:r,relative:n})},[l,c,n,e,r]),null}function Route(t){invariant$3(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Router({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:s,static:a=!1}){invariant$3(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),l=reactExports.useMemo(()=>({basename:o,navigator:s,static:a,future:{}}),[o,s,a]);typeof r=="string"&&(r=parsePath(r));let{pathname:u="/",search:c="",hash:d="",state:p=null,key:m="default"}=r,y=reactExports.useMemo(()=>{let b=stripBasename(u,o);return b==null?null:{location:{pathname:b,search:c,hash:d,state:p,key:m},navigationType:n}},[o,u,c,d,p,m,n]);return warning(y!=null,`<Router basename="${o}"> is not able to match the URL "${u}${c}${d}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:reactExports.createElement(NavigationContext.Provider,{value:l},reactExports.createElement(LocationContext.Provider,{children:e,value:y}))}function Routes({children:t,location:e}){return useRoutes(createRoutesFromChildren(t),e)}function createRoutesFromChildren(t,e=[]){let r=[];return reactExports.Children.forEach(t,(n,s)=>{if(!reactExports.isValidElement(n))return;let a=[...e,s];if(n.type===reactExports.Fragment){r.push.apply(r,createRoutesFromChildren(n.props.children,a));return}invariant$3(n.type===Route,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),invariant$3(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=createRoutesFromChildren(n.props.children,a)),r.push(o)}),r}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement$1(t){return t!=null&&typeof t.tagName=="string"}function isButtonElement(t){return isHtmlElement$1(t)&&t.tagName.toLowerCase()==="button"}function isFormElement(t){return isHtmlElement$1(t)&&t.tagName.toLowerCase()==="form"}function isInputElement(t){return isHtmlElement$1(t)&&t.tagName.toLowerCase()==="input"}function isModifiedEvent(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function shouldProcessLinkClick(t,e){return t.button===0&&(!e||e==="_self")&&!isModifiedEvent(t)}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch{_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(t){return t!=null&&!supportedFormEncTypes.has(t)?(warning(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):t}function getFormSubmissionInfo(t,e){let r,n,s,a,o;if(isFormElement(t)){let l=t.getAttribute("action");n=l?stripBasename(l,e):null,r=t.getAttribute("method")||defaultMethod,s=getFormEncType(t.getAttribute("enctype"))||defaultEncType,a=new FormData(t)}else if(isButtonElement(t)||isInputElement(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||l.getAttribute("action");if(n=u?stripBasename(u,e):null,r=t.getAttribute("formmethod")||l.getAttribute("method")||defaultMethod,s=getFormEncType(t.getAttribute("formenctype"))||getFormEncType(l.getAttribute("enctype"))||defaultEncType,a=new FormData(l,t),!isFormDataSubmitterSupported()){let{name:c,type:d,value:p}=t;if(d==="image"){let m=c?`${c}.`:"";a.append(`${m}x`,"0"),a.append(`${m}y`,"0")}else c&&a.append(c,p)}}else{if(isHtmlElement$1(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=defaultMethod,n=null,s=defaultEncType,o=t}return a&&s==="text/plain"&&(o=a,a=void 0),{action:n,method:r.toLowerCase(),encType:s,formData:a,body:o}}function invariant2(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function loadRouteModule(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function isHtmlLinkDescriptor(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function getKeyedPrefetchLinks(t,e,r){let n=await Promise.all(t.map(async s=>{let a=e.routes[s.route.id];if(a){let o=await loadRouteModule(a,r);return o.links?o.links():[]}return[]}));return dedupeLinkDescriptors(n.flat(1).filter(isHtmlLinkDescriptor).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function getNewMatchesForLinks(t,e,r,n,s,a){let o=(u,c)=>r[c]?u.route.id!==r[c].route.id:!0,l=(u,c)=>{var d;return r[c].pathname!==u.pathname||((d=r[c].route.path)==null?void 0:d.endsWith("*"))&&r[c].params["*"]!==u.params["*"]};return a==="assets"?e.filter((u,c)=>o(u,c)||l(u,c)):a==="data"?e.filter((u,c)=>{var p;let d=n.routes[u.route.id];if(!d||!d.hasLoader)return!1;if(o(u,c)||l(u,c))return!0;if(u.route.shouldRevalidate){let m=u.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((p=r[0])==null?void 0:p.params)||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function getModuleLinkHrefs(t,e,{includeHydrateFallback:r}={}){return dedupeHrefs(t.map(n=>{let s=e.routes[n.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),r&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function dedupeHrefs(t){return[...new Set(t)]}function sortKeys(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function dedupeLinkDescriptors(t,e){let r=new Set;return new Set(e),t.reduce((n,s)=>{let a=JSON.stringify(sortKeys(s));return r.has(a)||(r.add(a),n.push({key:a,link:s})),n},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var NO_BODY_STATUS_CODES=new Set([100,101,204,205]);function singleFetchUrl(t,e){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname="_root.data":e&&stripBasename(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function useDataRouterContext2(){let t=reactExports.useContext(DataRouterContext);return invariant2(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function useDataRouterStateContext(){let t=reactExports.useContext(DataRouterStateContext);return invariant2(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var FrameworkContext=reactExports.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let t=reactExports.useContext(FrameworkContext);return invariant2(t,"You must render this element inside a <HydratedRouter> element"),t}function usePrefetchBehavior(t,e){let r=reactExports.useContext(FrameworkContext),[n,s]=reactExports.useState(!1),[a,o]=reactExports.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:c,onMouseLeave:d,onTouchStart:p}=e,m=reactExports.useRef(null);reactExports.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let E=S=>{S.forEach(P=>{o(P.isIntersecting)})},T=new IntersectionObserver(E,{threshold:.5});return m.current&&T.observe(m.current),()=>{T.disconnect()}}},[t]),reactExports.useEffect(()=>{if(n){let E=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(E)}}},[n]);let y=()=>{s(!0)},b=()=>{s(!1),o(!1)};return r?t!=="intent"?[a,m,{}]:[a,m,{onFocus:composeEventHandlers$1(l,y),onBlur:composeEventHandlers$1(u,b),onMouseEnter:composeEventHandlers$1(c,y),onMouseLeave:composeEventHandlers$1(d,b),onTouchStart:composeEventHandlers$1(p,y)}]:[!1,m,{}]}function composeEventHandlers$1(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function PrefetchPageLinks({page:t,...e}){let{router:r}=useDataRouterContext2(),n=reactExports.useMemo(()=>matchRoutes(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?reactExports.createElement(PrefetchPageLinksImpl,{page:t,matches:n,...e}):null}function useKeyedPrefetchLinks(t){let{manifest:e,routeModules:r}=useFrameworkContext(),[n,s]=reactExports.useState([]);return reactExports.useEffect(()=>{let a=!1;return getKeyedPrefetchLinks(t,e,r).then(o=>{a||s(o)}),()=>{a=!0}},[t,e,r]),n}function PrefetchPageLinksImpl({page:t,matches:e,...r}){let n=useLocation(),{manifest:s,routeModules:a}=useFrameworkContext(),{basename:o}=useDataRouterContext2(),{loaderData:l,matches:u}=useDataRouterStateContext(),c=reactExports.useMemo(()=>getNewMatchesForLinks(t,e,u,s,n,"data"),[t,e,u,s,n]),d=reactExports.useMemo(()=>getNewMatchesForLinks(t,e,u,s,n,"assets"),[t,e,u,s,n]),p=reactExports.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let b=new Set,E=!1;if(e.forEach(S=>{var A;let P=s.routes[S.route.id];!P||!P.hasLoader||(!c.some(I=>I.route.id===S.route.id)&&S.route.id in l&&((A=a[S.route.id])!=null&&A.shouldRevalidate)||P.hasClientLoader?E=!0:b.add(S.route.id))}),b.size===0)return[];let T=singleFetchUrl(t,o);return E&&b.size>0&&T.searchParams.set("_routes",e.filter(S=>b.has(S.route.id)).map(S=>S.route.id).join(",")),[T.pathname+T.search]},[o,l,n,s,c,e,t,a]),m=reactExports.useMemo(()=>getModuleLinkHrefs(d,s),[d,s]),y=useKeyedPrefetchLinks(d);return reactExports.createElement(reactExports.Fragment,null,p.map(b=>reactExports.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...r})),m.map(b=>reactExports.createElement("link",{key:b,rel:"modulepreload",href:b,...r})),y.map(({key:b,link:E})=>reactExports.createElement("link",{key:b,...E})))}function mergeRefs(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var isBrowser$3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{isBrowser$3&&(window.__reactRouterVersion="7.6.1")}catch{}function BrowserRouter({basename:t,children:e,window:r}){let n=reactExports.useRef();n.current==null&&(n.current=createBrowserHistory({window:r,v5Compat:!0}));let s=n.current,[a,o]=reactExports.useState({action:s.action,location:s.location}),l=reactExports.useCallback(u=>{reactExports.startTransition(()=>o(u))},[o]);return reactExports.useLayoutEffect(()=>s.listen(l),[s,l]),reactExports.createElement(Router,{basename:t,children:e,location:a.location,navigationType:a.action,navigator:s})}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:s,reloadDocument:a,replace:o,state:l,target:u,to:c,preventScrollReset:d,viewTransition:p,...m},y){let{basename:b}=reactExports.useContext(NavigationContext),E=typeof c=="string"&&ABSOLUTE_URL_REGEX2.test(c),T,S=!1;if(typeof c=="string"&&E&&(T=c,isBrowser$3))try{let ee=new URL(window.location.href),ue=c.startsWith("//")?new URL(ee.protocol+c):new URL(c),de=stripBasename(ue.pathname,b);ue.origin===ee.origin&&de!=null?c=de+ue.search+ue.hash:S=!0}catch{warning(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let P=useHref(c,{relative:s}),[A,I,j]=usePrefetchBehavior(n,m),K=useLinkClickHandler(c,{replace:o,state:l,target:u,preventScrollReset:d,relative:s,viewTransition:p});function W(ee){e&&e(ee),ee.defaultPrevented||K(ee)}let H=reactExports.createElement("a",{...m,...j,href:T||P,onClick:S||a?e:W,ref:mergeRefs(y,I),target:u,"data-discover":!E&&r==="render"?"true":void 0});return A&&!E?reactExports.createElement(reactExports.Fragment,null,H,reactExports.createElement(PrefetchPageLinks,{page:P})):H});Link.displayName="Link";var NavLink=reactExports.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:s=!1,style:a,to:o,viewTransition:l,children:u,...c},d){let p=useResolvedPath(o,{relative:c.relative}),m=useLocation(),y=reactExports.useContext(DataRouterStateContext),{navigator:b,basename:E}=reactExports.useContext(NavigationContext),T=y!=null&&useViewTransitionState(p)&&l===!0,S=b.encodeLocation?b.encodeLocation(p).pathname:p.pathname,P=m.pathname,A=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;r||(P=P.toLowerCase(),A=A?A.toLowerCase():null,S=S.toLowerCase()),A&&E&&(A=stripBasename(A,E)||A);const I=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let j=P===S||!s&&P.startsWith(S)&&P.charAt(I)==="/",K=A!=null&&(A===S||!s&&A.startsWith(S)&&A.charAt(S.length)==="/"),W={isActive:j,isPending:K,isTransitioning:T},H=j?e:void 0,ee;typeof n=="function"?ee=n(W):ee=[n,j?"active":null,K?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let ue=typeof a=="function"?a(W):a;return reactExports.createElement(Link,{...c,"aria-current":H,className:ee,ref:d,style:ue,to:o,viewTransition:l},typeof u=="function"?u(W):u)});NavLink.displayName="NavLink";var Form=reactExports.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:s,state:a,method:o=defaultMethod,action:l,onSubmit:u,relative:c,preventScrollReset:d,viewTransition:p,...m},y)=>{let b=useSubmit(),E=useFormAction(l,{relative:c}),T=o.toLowerCase()==="get"?"get":"post",S=typeof l=="string"&&ABSOLUTE_URL_REGEX2.test(l),P=A=>{if(u&&u(A),A.defaultPrevented)return;A.preventDefault();let I=A.nativeEvent.submitter,j=(I==null?void 0:I.getAttribute("formmethod"))||o;b(I||A.currentTarget,{fetcherKey:e,method:j,navigate:r,replace:s,state:a,relative:c,preventScrollReset:d,viewTransition:p})};return reactExports.createElement("form",{ref:y,method:T,action:E,onSubmit:n?u:P,...m,"data-discover":!S&&t==="render"?"true":void 0})});Form.displayName="Form";function getDataRouterConsoleError2(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(t){let e=reactExports.useContext(DataRouterContext);return invariant$3(e,getDataRouterConsoleError2(t)),e}function useLinkClickHandler(t,{target:e,replace:r,state:n,preventScrollReset:s,relative:a,viewTransition:o}={}){let l=useNavigate(),u=useLocation(),c=useResolvedPath(t,{relative:a});return reactExports.useCallback(d=>{if(shouldProcessLinkClick(d,e)){d.preventDefault();let p=r!==void 0?r:createPath(u)===createPath(c);l(t,{replace:p,state:n,preventScrollReset:s,relative:a,viewTransition:o})}},[u,l,c,r,n,e,t,s,a,o])}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:t}=useDataRouterContext3("useSubmit"),{basename:e}=reactExports.useContext(NavigationContext),r=useRouteId();return reactExports.useCallback(async(n,s={})=>{let{action:a,method:o,encType:l,formData:u,body:c}=getFormSubmissionInfo(n,e);if(s.navigate===!1){let d=s.fetcherKey||getUniqueFetcherId();await t.fetch(d,r,s.action||a,{preventScrollReset:s.preventScrollReset,formData:u,body:c,formMethod:s.method||o,formEncType:s.encType||l,flushSync:s.flushSync})}else await t.navigate(s.action||a,{preventScrollReset:s.preventScrollReset,formData:u,body:c,formMethod:s.method||o,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:r,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,r])}function useFormAction(t,{relative:e}={}){let{basename:r}=reactExports.useContext(NavigationContext),n=reactExports.useContext(RouteContext);invariant$3(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),a={...useResolvedPath(t||".",{relative:e})},o=useLocation();if(t==null){a.search=o.search;let l=new URLSearchParams(a.search),u=l.getAll("index");if(u.some(d=>d==="")){l.delete("index"),u.filter(p=>p).forEach(p=>l.append("index",p));let d=l.toString();a.search=d?`?${d}`:""}}return(!t||t===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(a.pathname=a.pathname==="/"?r:joinPaths([r,a.pathname])),createPath(a)}function useViewTransitionState(t,e={}){let r=reactExports.useContext(ViewTransitionContext);invariant$3(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=useDataRouterContext3("useViewTransitionState"),s=useResolvedPath(t,{relative:e.relative});if(!r.isTransitioning)return!1;let a=stripBasename(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=stripBasename(r.nextLocation.pathname,n)||r.nextLocation.pathname;return matchPath(s.pathname,o)!=null||matchPath(s.pathname,a)!=null}[...NO_BODY_STATUS_CODES];var reactDomExports=requireReactDom();const ReactDOM=getDefaultExportFromCjs(reactDomExports);function bind(t,e){return function(){return t.apply(e,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,{iterator,toStringTag}=Symbol,kindOf=(t=>e=>{const r=toString.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=t=>(t=t.toLowerCase(),e=>kindOf(e)===t),typeOfTest=t=>e=>typeof e===t,{isArray:isArray$2}=Array,isUndefined=typeOfTest("undefined");function isBuffer(t){return t!==null&&!isUndefined(t)&&t.constructor!==null&&!isUndefined(t.constructor)&&isFunction$2(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&isArrayBuffer(t.buffer),e}const isString=typeOfTest("string"),isFunction$2=typeOfTest("function"),isNumber=typeOfTest("number"),isObject$2=t=>t!==null&&typeof t=="object",isBoolean=t=>t===!0||t===!1,isPlainObject$1=t=>{if(kindOf(t)!=="object")return!1;const e=getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(toStringTag in t)&&!(iterator in t)},isDate$1=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=t=>isObject$2(t)&&isFunction$2(t.pipe),isFormData=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||isFunction$2(t.append)&&((e=kindOf(t))==="formdata"||e==="object"&&isFunction$2(t.toString)&&t.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),[isReadableStream,isRequest,isResponse,isHeaders]=["ReadableStream","Request","Response","Headers"].map(kindOfTest),trim=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach$1(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let n,s;if(typeof t!="object"&&(t=[t]),isArray$2(t))for(n=0,s=t.length;n<s;n++)e.call(null,t[n],n,t);else{const a=r?Object.getOwnPropertyNames(t):Object.keys(t),o=a.length;let l;for(n=0;n<o;n++)l=a[n],e.call(null,t[l],l,t)}}function findKey$1(t,e){e=e.toLowerCase();const r=Object.keys(t);let n=r.length,s;for(;n-- >0;)if(s=r[n],e===s.toLowerCase())return s;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=t=>!isUndefined(t)&&t!==_global;function merge(){const{caseless:t}=isContextDefined(this)&&this||{},e={},r=(n,s)=>{const a=t&&findKey$1(e,s)||s;isPlainObject$1(e[a])&&isPlainObject$1(n)?e[a]=merge(e[a],n):isPlainObject$1(n)?e[a]=merge({},n):isArray$2(n)?e[a]=n.slice():e[a]=n};for(let n=0,s=arguments.length;n<s;n++)arguments[n]&&forEach$1(arguments[n],r);return e}const extend$1=(t,e,r,{allOwnKeys:n}={})=>(forEach$1(e,(s,a)=>{r&&isFunction$2(s)?t[a]=bind(s,r):t[a]=s},{allOwnKeys:n}),t),stripBOM=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),inherits=(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},toFlatObject=(t,e,r,n)=>{let s,a,o;const l={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),a=s.length;a-- >0;)o=s[a],(!n||n(o,t,e))&&!l[o]&&(e[o]=t[o],l[o]=!0);t=r!==!1&&getPrototypeOf(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},endsWith=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const n=t.indexOf(e,r);return n!==-1&&n===r},toArray$2=t=>{if(!t)return null;if(isArray$2(t))return t;let e=t.length;if(!isNumber(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},isTypedArray=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(t,e)=>{const n=(t&&t[iterator]).call(t);let s;for(;(s=n.next())&&!s.done;){const a=s.value;e.call(t,a[0],a[1])}},matchAll=(t,e)=>{let r;const n=[];for(;(r=t.exec(e))!==null;)n.push(r);return n},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase$1=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),hasOwnProperty$1=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),n={};forEach$1(r,(s,a)=>{let o;(o=e(s,a,t))!==!1&&(n[a]=o||s)}),Object.defineProperties(t,n)},freezeMethods=t=>{reduceDescriptors(t,(e,r)=>{if(isFunction$2(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=t[r];if(isFunction$2(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},toObjectSet=(t,e)=>{const r={},n=s=>{s.forEach(a=>{r[a]=!0})};return isArray$2(t)?n(t):n(String(t).split(e)),r},noop$7=()=>{},toFiniteNumber=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function isSpecCompliantForm(t){return!!(t&&isFunction$2(t.append)&&t[toStringTag]==="FormData"&&t[iterator])}const toJSONObject=t=>{const e=new Array(10),r=(n,s)=>{if(isObject$2(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[s]=n;const a=isArray$2(n)?[]:{};return forEach$1(n,(o,l)=>{const u=r(o,s+1);!isUndefined(u)&&(a[l]=u)}),e[s]=void 0,a}}return n};return r(t,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=t=>t&&(isObject$2(t)||isFunction$2(t))&&isFunction$2(t.then)&&isFunction$2(t.catch),_setImmediate=((t,e)=>t?setImmediate:e?((r,n)=>(_global.addEventListener("message",({source:s,data:a})=>{s===_global&&a===r&&n.length&&n.shift()()},!1),s=>{n.push(s),_global.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",isFunction$2(_global.postMessage)),asap=typeof queueMicrotask<"u"?queueMicrotask.bind(_global):typeof process<"u"&&process.nextTick||_setImmediate,isIterable=t=>t!=null&&isFunction$2(t[iterator]),utils$1={isArray:isArray$2,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject:isObject$2,isPlainObject:isPlainObject$1,isReadableStream,isRequest,isResponse,isHeaders,isUndefined,isDate:isDate$1,isFile,isBlob,isRegExp,isFunction:isFunction$2,isStream,isURLSearchParams,isTypedArray,isFileList,forEach:forEach$1,merge,extend:extend$1,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray:toArray$2,forEachEntry,matchAll,isHTMLForm,hasOwnProperty:hasOwnProperty$1,hasOwnProp:hasOwnProperty$1,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase:toCamelCase$1,noop:noop$7,toFiniteNumber,findKey:findKey$1,global:_global,isContextDefined,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable,setImmediate:_setImmediate,asap,isIterable};function AxiosError$1(t,e,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}utils$1.inherits(AxiosError$1,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.status}}});const prototype$1=AxiosError$1.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{descriptors[t]={value:t}});Object.defineProperties(AxiosError$1,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError$1.from=(t,e,r,n,s,a)=>{const o=Object.create(prototype$1);return utils$1.toFlatObject(t,o,function(u){return u!==Error.prototype},l=>l!=="isAxiosError"),AxiosError$1.call(o,t.message,e,r,n,s),o.cause=t,o.name=t.name,a&&Object.assign(o,a),o};const httpAdapter=null;function isVisitable(t){return utils$1.isPlainObject(t)||utils$1.isArray(t)}function removeBrackets(t){return utils$1.endsWith(t,"[]")?t.slice(0,-2):t}function renderKey(t,e,r){return t?t.concat(e).map(function(s,a){return s=removeBrackets(s),!r&&a?"["+s+"]":s}).join(r?".":""):e}function isFlatArray(t){return utils$1.isArray(t)&&!t.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(e){return/^is[A-Z]/.test(e)});function toFormData$1(t,e,r){if(!utils$1.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=utils$1.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(E,T){return!utils$1.isUndefined(T[E])});const n=r.metaTokens,s=r.visitor||d,a=r.dots,o=r.indexes,u=(r.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(e);if(!utils$1.isFunction(s))throw new TypeError("visitor must be a function");function c(b){if(b===null)return"";if(utils$1.isDate(b))return b.toISOString();if(!u&&utils$1.isBlob(b))throw new AxiosError$1("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(b)||utils$1.isTypedArray(b)?u&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function d(b,E,T){let S=b;if(b&&!T&&typeof b=="object"){if(utils$1.endsWith(E,"{}"))E=n?E:E.slice(0,-2),b=JSON.stringify(b);else if(utils$1.isArray(b)&&isFlatArray(b)||(utils$1.isFileList(b)||utils$1.endsWith(E,"[]"))&&(S=utils$1.toArray(b)))return E=removeBrackets(E),S.forEach(function(A,I){!(utils$1.isUndefined(A)||A===null)&&e.append(o===!0?renderKey([E],I,a):o===null?E:E+"[]",c(A))}),!1}return isVisitable(b)?!0:(e.append(renderKey(T,E,a),c(b)),!1)}const p=[],m=Object.assign(predicates,{defaultVisitor:d,convertValue:c,isVisitable});function y(b,E){if(!utils$1.isUndefined(b)){if(p.indexOf(b)!==-1)throw Error("Circular reference detected in "+E.join("."));p.push(b),utils$1.forEach(b,function(S,P){(!(utils$1.isUndefined(S)||S===null)&&s.call(e,S,utils$1.isString(P)?P.trim():P,E,m))===!0&&y(S,E?E.concat(P):[P])}),p.pop()}}if(!utils$1.isObject(t))throw new TypeError("data must be an object");return y(t),e}function encode$2(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function AxiosURLSearchParams(t,e){this._pairs=[],t&&toFormData$1(t,this,e)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(e,r){this._pairs.push([e,r])};prototype.toString=function(e){const r=e?function(n){return e.call(this,n,encode$2)}:encode$2;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function encode$1(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(t,e,r){if(!e)return t;const n=r&&r.encode||encode$1;utils$1.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let a;if(s?a=s(e,r):a=utils$1.isURLSearchParams(e)?e.toString():new AxiosURLSearchParams(e,r).toString(n),a){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+a}return t}class InterceptorManager{constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){utils$1.forEach(this.handlers,function(n){n!==null&&e(n)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$2=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$2={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$2,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",_navigator=typeof navigator=="object"&&navigator||void 0,hasStandardBrowserEnv=hasBrowserEnv&&(!_navigator||["ReactNative","NativeScript","NS"].indexOf(_navigator.product)<0),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",origin$1=hasBrowserEnv&&window.location.href||"http://localhost",utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv,navigator:_navigator,origin:origin$1},Symbol.toStringTag,{value:"Module"})),platform$1={...utils,...platform$2};function toURLEncodedForm(t,e){return toFormData$1(t,new platform$1.classes.URLSearchParams,Object.assign({visitor:function(r,n,s,a){return platform$1.isNode&&utils$1.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},e))}function parsePropPath(t){return utils$1.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function arrayToObject(t){const e={},r=Object.keys(t);let n;const s=r.length;let a;for(n=0;n<s;n++)a=r[n],e[a]=t[a];return e}function formDataToJSON(t){function e(r,n,s,a){let o=r[a++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),u=a>=r.length;return o=!o&&utils$1.isArray(s)?s.length:o,u?(utils$1.hasOwnProp(s,o)?s[o]=[s[o],n]:s[o]=n,!l):((!s[o]||!utils$1.isObject(s[o]))&&(s[o]=[]),e(r,n,s[o],a)&&utils$1.isArray(s[o])&&(s[o]=arrayToObject(s[o])),!l)}if(utils$1.isFormData(t)&&utils$1.isFunction(t.entries)){const r={};return utils$1.forEachEntry(t,(n,s)=>{e(parsePropPath(n),s,r,0)}),r}return null}function stringifySafely(t,e,r){if(utils$1.isString(t))try{return(e||JSON.parse)(t),utils$1.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}const defaults$2={transitional:transitionalDefaults,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,a=utils$1.isObject(e);if(a&&utils$1.isHTMLForm(e)&&(e=new FormData(e)),utils$1.isFormData(e))return s?JSON.stringify(formDataToJSON(e)):e;if(utils$1.isArrayBuffer(e)||utils$1.isBuffer(e)||utils$1.isStream(e)||utils$1.isFile(e)||utils$1.isBlob(e)||utils$1.isReadableStream(e))return e;if(utils$1.isArrayBufferView(e))return e.buffer;if(utils$1.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(e,this.formSerializer).toString();if((l=utils$1.isFileList(e))||n.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return toFormData$1(l?{"files[]":e}:e,u&&new u,this.formSerializer)}}return a||s?(r.setContentType("application/json",!1),stringifySafely(e)):e}],transformResponse:[function(e){const r=this.transitional||defaults$2.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(utils$1.isResponse(e)||utils$1.isReadableStream(e))return e;if(e&&utils$1.isString(e)&&(n&&!this.responseType||s)){const o=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(l){if(o)throw l.name==="SyntaxError"?AxiosError$1.from(l,AxiosError$1.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform$1.classes.FormData,Blob:platform$1.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],t=>{defaults$2.headers[t]={}});const ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=t=>{const e={};let r,n,s;return t&&t.split(`
`).forEach(function(o){s=o.indexOf(":"),r=o.substring(0,s).trim().toLowerCase(),n=o.substring(s+1).trim(),!(!r||e[r]&&ignoreDuplicateOf[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e},$internals=Symbol("internals");function normalizeHeader(t){return t&&String(t).trim().toLowerCase()}function normalizeValue(t){return t===!1||t==null?t:utils$1.isArray(t)?t.map(normalizeValue):String(t)}function parseTokens(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}const isValidHeaderName=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function matchHeaderValue(t,e,r,n,s){if(utils$1.isFunction(n))return n.call(this,e,r);if(s&&(e=r),!!utils$1.isString(e)){if(utils$1.isString(n))return e.indexOf(n)!==-1;if(utils$1.isRegExp(n))return n.test(e)}}function formatHeader(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function buildAccessors(t,e){const r=utils$1.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(s,a,o){return this[n].call(this,e,s,a,o)},configurable:!0})})}let AxiosHeaders$1=class{constructor(e){e&&this.set(e)}set(e,r,n){const s=this;function a(l,u,c){const d=normalizeHeader(u);if(!d)throw new Error("header name must be a non-empty string");const p=utils$1.findKey(s,d);(!p||s[p]===void 0||c===!0||c===void 0&&s[p]!==!1)&&(s[p||u]=normalizeValue(l))}const o=(l,u)=>utils$1.forEach(l,(c,d)=>a(c,d,u));if(utils$1.isPlainObject(e)||e instanceof this.constructor)o(e,r);else if(utils$1.isString(e)&&(e=e.trim())&&!isValidHeaderName(e))o(parseHeaders(e),r);else if(utils$1.isObject(e)&&utils$1.isIterable(e)){let l={},u,c;for(const d of e){if(!utils$1.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[c=d[0]]=(u=l[c])?utils$1.isArray(u)?[...u,d[1]]:[u,d[1]]:d[1]}o(l,r)}else e!=null&&a(r,e,n);return this}get(e,r){if(e=normalizeHeader(e),e){const n=utils$1.findKey(this,e);if(n){const s=this[n];if(!r)return s;if(r===!0)return parseTokens(s);if(utils$1.isFunction(r))return r.call(this,s,n);if(utils$1.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=normalizeHeader(e),e){const n=utils$1.findKey(this,e);return!!(n&&this[n]!==void 0&&(!r||matchHeaderValue(this,this[n],n,r)))}return!1}delete(e,r){const n=this;let s=!1;function a(o){if(o=normalizeHeader(o),o){const l=utils$1.findKey(n,o);l&&(!r||matchHeaderValue(n,n[l],l,r))&&(delete n[l],s=!0)}}return utils$1.isArray(e)?e.forEach(a):a(e),s}clear(e){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const a=r[n];(!e||matchHeaderValue(this,this[a],a,e,!0))&&(delete this[a],s=!0)}return s}normalize(e){const r=this,n={};return utils$1.forEach(this,(s,a)=>{const o=utils$1.findKey(n,a);if(o){r[o]=normalizeValue(s),delete r[a];return}const l=e?formatHeader(a):String(a).trim();l!==a&&delete r[a],r[l]=normalizeValue(s),n[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return utils$1.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=e&&utils$1.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const n=new this(e);return r.forEach(s=>n.set(s)),n}static accessor(e){const n=(this[$internals]=this[$internals]={accessors:{}}).accessors,s=this.prototype;function a(o){const l=normalizeHeader(o);n[l]||(buildAccessors(s,o),n[l]=!0)}return utils$1.isArray(e)?e.forEach(a):a(e),this}};AxiosHeaders$1.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders$1.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[r]=n}}});utils$1.freezeMethods(AxiosHeaders$1);function transformData(t,e){const r=this||defaults$2,n=e||r,s=AxiosHeaders$1.from(n.headers);let a=n.data;return utils$1.forEach(t,function(l){a=l.call(r,a,s.normalize(),e?e.status:void 0)}),s.normalize(),a}function isCancel$1(t){return!!(t&&t.__CANCEL__)}function CanceledError$1(t,e,r){AxiosError$1.call(this,t??"canceled",AxiosError$1.ERR_CANCELED,e,r),this.name="CanceledError"}utils$1.inherits(CanceledError$1,AxiosError$1,{__CANCEL__:!0});function settle(t,e,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):e(new AxiosError$1("Request failed with status code "+r.status,[AxiosError$1.ERR_BAD_REQUEST,AxiosError$1.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function parseProtocol(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function speedometer(t,e){t=t||10;const r=new Array(t),n=new Array(t);let s=0,a=0,o;return e=e!==void 0?e:1e3,function(u){const c=Date.now(),d=n[a];o||(o=c),r[s]=u,n[s]=c;let p=a,m=0;for(;p!==s;)m+=r[p++],p=p%t;if(s=(s+1)%t,s===a&&(a=(a+1)%t),c-o<e)return;const y=d&&c-d;return y?Math.round(m*1e3/y):void 0}}function throttle(t,e){let r=0,n=1e3/e,s,a;const o=(c,d=Date.now())=>{r=d,s=null,a&&(clearTimeout(a),a=null),t.apply(null,c)};return[(...c)=>{const d=Date.now(),p=d-r;p>=n?o(c,d):(s=c,a||(a=setTimeout(()=>{a=null,o(s)},n-p)))},()=>s&&o(s)]}const progressEventReducer=(t,e,r=3)=>{let n=0;const s=speedometer(50,250);return throttle(a=>{const o=a.loaded,l=a.lengthComputable?a.total:void 0,u=o-n,c=s(u),d=o<=l;n=o;const p={loaded:o,total:l,progress:l?o/l:void 0,bytes:u,rate:c||void 0,estimated:c&&l&&d?(l-o)/c:void 0,event:a,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(p)},r)},progressEventDecorator=(t,e)=>{const r=t!=null;return[n=>e[0]({lengthComputable:r,total:t,loaded:n}),e[1]]},asyncDecorator=t=>(...e)=>utils$1.asap(()=>t(...e)),isURLSameOrigin=platform$1.hasStandardBrowserEnv?((t,e)=>r=>(r=new URL(r,platform$1.origin),t.protocol===r.protocol&&t.host===r.host&&(e||t.port===r.port)))(new URL(platform$1.origin),platform$1.navigator&&/(msie|trident)/i.test(platform$1.navigator.userAgent)):()=>!0,cookies=platform$1.hasStandardBrowserEnv?{write(t,e,r,n,s,a){const o=[t+"="+encodeURIComponent(e)];utils$1.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),utils$1.isString(n)&&o.push("path="+n),utils$1.isString(s)&&o.push("domain="+s),a===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL$1(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function combineURLs(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function buildFullPath(t,e,r){let n=!isAbsoluteURL$1(e);return t&&(n||r==!1)?combineURLs(t,e):e}const headersToObject=t=>t instanceof AxiosHeaders$1?{...t}:t;function mergeConfig$1(t,e){e=e||{};const r={};function n(c,d,p,m){return utils$1.isPlainObject(c)&&utils$1.isPlainObject(d)?utils$1.merge.call({caseless:m},c,d):utils$1.isPlainObject(d)?utils$1.merge({},d):utils$1.isArray(d)?d.slice():d}function s(c,d,p,m){if(utils$1.isUndefined(d)){if(!utils$1.isUndefined(c))return n(void 0,c,p,m)}else return n(c,d,p,m)}function a(c,d){if(!utils$1.isUndefined(d))return n(void 0,d)}function o(c,d){if(utils$1.isUndefined(d)){if(!utils$1.isUndefined(c))return n(void 0,c)}else return n(void 0,d)}function l(c,d,p){if(p in e)return n(c,d);if(p in t)return n(void 0,c)}const u={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(c,d,p)=>s(headersToObject(c),headersToObject(d),p,!0)};return utils$1.forEach(Object.keys(Object.assign({},t,e)),function(d){const p=u[d]||s,m=p(t[d],e[d],d);utils$1.isUndefined(m)&&p!==l||(r[d]=m)}),r}const resolveConfig=t=>{const e=mergeConfig$1({},t);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:a,headers:o,auth:l}=e;e.headers=o=AxiosHeaders$1.from(o),e.url=buildURL(buildFullPath(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let u;if(utils$1.isFormData(r)){if(platform$1.hasStandardBrowserEnv||platform$1.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((u=o.getContentType())!==!1){const[c,...d]=u?u.split(";").map(p=>p.trim()).filter(Boolean):[];o.setContentType([c||"multipart/form-data",...d].join("; "))}}if(platform$1.hasStandardBrowserEnv&&(n&&utils$1.isFunction(n)&&(n=n(e)),n||n!==!1&&isURLSameOrigin(e.url))){const c=s&&a&&cookies.read(a);c&&o.set(s,c)}return e},isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(t){return new Promise(function(r,n){const s=resolveConfig(t);let a=s.data;const o=AxiosHeaders$1.from(s.headers).normalize();let{responseType:l,onUploadProgress:u,onDownloadProgress:c}=s,d,p,m,y,b;function E(){y&&y(),b&&b(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let T=new XMLHttpRequest;T.open(s.method.toUpperCase(),s.url,!0),T.timeout=s.timeout;function S(){if(!T)return;const A=AxiosHeaders$1.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),j={data:!l||l==="text"||l==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:A,config:t,request:T};settle(function(W){r(W),E()},function(W){n(W),E()},j),T=null}"onloadend"in T?T.onloadend=S:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(S)},T.onabort=function(){T&&(n(new AxiosError$1("Request aborted",AxiosError$1.ECONNABORTED,t,T)),T=null)},T.onerror=function(){n(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,t,T)),T=null},T.ontimeout=function(){let I=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const j=s.transitional||transitionalDefaults;s.timeoutErrorMessage&&(I=s.timeoutErrorMessage),n(new AxiosError$1(I,j.clarifyTimeoutError?AxiosError$1.ETIMEDOUT:AxiosError$1.ECONNABORTED,t,T)),T=null},a===void 0&&o.setContentType(null),"setRequestHeader"in T&&utils$1.forEach(o.toJSON(),function(I,j){T.setRequestHeader(j,I)}),utils$1.isUndefined(s.withCredentials)||(T.withCredentials=!!s.withCredentials),l&&l!=="json"&&(T.responseType=s.responseType),c&&([m,b]=progressEventReducer(c,!0),T.addEventListener("progress",m)),u&&T.upload&&([p,y]=progressEventReducer(u),T.upload.addEventListener("progress",p),T.upload.addEventListener("loadend",y)),(s.cancelToken||s.signal)&&(d=A=>{T&&(n(!A||A.type?new CanceledError$1(null,t,T):A),T.abort(),T=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const P=parseProtocol(s.url);if(P&&platform$1.protocols.indexOf(P)===-1){n(new AxiosError$1("Unsupported protocol "+P+":",AxiosError$1.ERR_BAD_REQUEST,t));return}T.send(a||null)})},composeSignals=(t,e)=>{const{length:r}=t=t?t.filter(Boolean):[];if(e||r){let n=new AbortController,s;const a=function(c){if(!s){s=!0,l();const d=c instanceof Error?c:this.reason;n.abort(d instanceof AxiosError$1?d:new CanceledError$1(d instanceof Error?d.message:d))}};let o=e&&setTimeout(()=>{o=null,a(new AxiosError$1(`timeout ${e} of ms exceeded`,AxiosError$1.ETIMEDOUT))},e);const l=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(c=>{c.unsubscribe?c.unsubscribe(a):c.removeEventListener("abort",a)}),t=null)};t.forEach(c=>c.addEventListener("abort",a));const{signal:u}=n;return u.unsubscribe=()=>utils$1.asap(l),u}},streamChunk=function*(t,e){let r=t.byteLength;if(r<e){yield t;return}let n=0,s;for(;n<r;)s=n+e,yield t.slice(n,s),n=s},readBytes=async function*(t,e){for await(const r of readStream(t))yield*streamChunk(r,e)},readStream=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:r,value:n}=await e.read();if(r)break;yield n}}finally{await e.cancel()}},trackStream=(t,e,r,n)=>{const s=readBytes(t,e);let a=0,o,l=u=>{o||(o=!0,n&&n(u))};return new ReadableStream({async pull(u){try{const{done:c,value:d}=await s.next();if(c){l(),u.close();return}let p=d.byteLength;if(r){let m=a+=p;r(m)}u.enqueue(new Uint8Array(d))}catch(c){throw l(c),c}},cancel(u){return l(u),s.return()}},{highWaterMark:2})},isFetchSupported=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",isReadableStreamSupported=isFetchSupported&&typeof ReadableStream=="function",encodeText=isFetchSupported&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),test$1=(t,...e)=>{try{return!!t(...e)}catch{return!1}},supportsRequestStream=isReadableStreamSupported&&test$1(()=>{let t=!1;const e=new Request(platform$1.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),DEFAULT_CHUNK_SIZE=64*1024,supportsResponseStream=isReadableStreamSupported&&test$1(()=>utils$1.isReadableStream(new Response("").body)),resolvers={stream:supportsResponseStream&&(t=>t.body)};isFetchSupported&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!resolvers[e]&&(resolvers[e]=utils$1.isFunction(t[e])?r=>r[e]():(r,n)=>{throw new AxiosError$1(`Response type '${e}' is not supported`,AxiosError$1.ERR_NOT_SUPPORT,n)})})})(new Response);const getBodyLength=async t=>{if(t==null)return 0;if(utils$1.isBlob(t))return t.size;if(utils$1.isSpecCompliantForm(t))return(await new Request(platform$1.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(utils$1.isArrayBufferView(t)||utils$1.isArrayBuffer(t))return t.byteLength;if(utils$1.isURLSearchParams(t)&&(t=t+""),utils$1.isString(t))return(await encodeText(t)).byteLength},resolveBodyLength=async(t,e)=>{const r=utils$1.toFiniteNumber(t.getContentLength());return r??getBodyLength(e)},fetchAdapter=isFetchSupported&&(async t=>{let{url:e,method:r,data:n,signal:s,cancelToken:a,timeout:o,onDownloadProgress:l,onUploadProgress:u,responseType:c,headers:d,withCredentials:p="same-origin",fetchOptions:m}=resolveConfig(t);c=c?(c+"").toLowerCase():"text";let y=composeSignals([s,a&&a.toAbortSignal()],o),b;const E=y&&y.unsubscribe&&(()=>{y.unsubscribe()});let T;try{if(u&&supportsRequestStream&&r!=="get"&&r!=="head"&&(T=await resolveBodyLength(d,n))!==0){let j=new Request(e,{method:"POST",body:n,duplex:"half"}),K;if(utils$1.isFormData(n)&&(K=j.headers.get("content-type"))&&d.setContentType(K),j.body){const[W,H]=progressEventDecorator(T,progressEventReducer(asyncDecorator(u)));n=trackStream(j.body,DEFAULT_CHUNK_SIZE,W,H)}}utils$1.isString(p)||(p=p?"include":"omit");const S="credentials"in Request.prototype;b=new Request(e,{...m,signal:y,method:r.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:S?p:void 0});let P=await fetch(b);const A=supportsResponseStream&&(c==="stream"||c==="response");if(supportsResponseStream&&(l||A&&E)){const j={};["status","statusText","headers"].forEach(ee=>{j[ee]=P[ee]});const K=utils$1.toFiniteNumber(P.headers.get("content-length")),[W,H]=l&&progressEventDecorator(K,progressEventReducer(asyncDecorator(l),!0))||[];P=new Response(trackStream(P.body,DEFAULT_CHUNK_SIZE,W,()=>{H&&H(),E&&E()}),j)}c=c||"text";let I=await resolvers[utils$1.findKey(resolvers,c)||"text"](P,t);return!A&&E&&E(),await new Promise((j,K)=>{settle(j,K,{data:I,headers:AxiosHeaders$1.from(P.headers),status:P.status,statusText:P.statusText,config:t,request:b})})}catch(S){throw E&&E(),S&&S.name==="TypeError"&&/Load failed|fetch/i.test(S.message)?Object.assign(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,t,b),{cause:S.cause||S}):AxiosError$1.from(S,S&&S.code,t,b)}}),knownAdapters={http:httpAdapter,xhr:xhrAdapter,fetch:fetchAdapter};utils$1.forEach(knownAdapters,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const renderReason=t=>`- ${t}`,isResolvedHandle=t=>utils$1.isFunction(t)||t===null||t===!1,adapters={getAdapter:t=>{t=utils$1.isArray(t)?t:[t];const{length:e}=t;let r,n;const s={};for(let a=0;a<e;a++){r=t[a];let o;if(n=r,!isResolvedHandle(r)&&(n=knownAdapters[(o=String(r)).toLowerCase()],n===void 0))throw new AxiosError$1(`Unknown adapter '${o}'`);if(n)break;s[o||"#"+a]=n}if(!n){const a=Object.entries(s).map(([l,u])=>`adapter ${l} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=e?a.length>1?`since :
`+a.map(renderReason).join(`
`):" "+renderReason(a[0]):"as no adapter specified";throw new AxiosError$1("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:knownAdapters};function throwIfCancellationRequested(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new CanceledError$1(null,t)}function dispatchRequest(t){return throwIfCancellationRequested(t),t.headers=AxiosHeaders$1.from(t.headers),t.data=transformData.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(t.adapter||defaults$2.adapter)(t).then(function(n){return throwIfCancellationRequested(t),n.data=transformData.call(t,t.transformResponse,n),n.headers=AxiosHeaders$1.from(n.headers),n},function(n){return isCancel$1(n)||(throwIfCancellationRequested(t),n&&n.response&&(n.response.data=transformData.call(t,t.transformResponse,n.response),n.response.headers=AxiosHeaders$1.from(n.response.headers))),Promise.reject(n)})}const VERSION$2="1.9.0",validators$1={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{validators$1[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const deprecatedWarnings={};validators$1.transitional=function(e,r,n){function s(a,o){return"[Axios v"+VERSION$2+"] Transitional option '"+a+"'"+o+(n?". "+n:"")}return(a,o,l)=>{if(e===!1)throw new AxiosError$1(s(o," has been removed"+(r?" in "+r:"")),AxiosError$1.ERR_DEPRECATED);return r&&!deprecatedWarnings[o]&&(deprecatedWarnings[o]=!0,console.warn(s(o," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(a,o,l):!0}};validators$1.spelling=function(e){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function assertOptions(t,e,r){if(typeof t!="object")throw new AxiosError$1("options must be an object",AxiosError$1.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let s=n.length;for(;s-- >0;){const a=n[s],o=e[a];if(o){const l=t[a],u=l===void 0||o(l,a,t);if(u!==!0)throw new AxiosError$1("option "+a+" must be "+u,AxiosError$1.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new AxiosError$1("Unknown option "+a,AxiosError$1.ERR_BAD_OPTION)}}const validator$1={assertOptions,validators:validators$1},validators=validator$1.validators;let Axios$1=class{constructor(e){this.defaults=e||{},this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(e,r){try{return await this._request(e,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=mergeConfig$1(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:a}=r;n!==void 0&&validator$1.assertOptions(n,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),s!=null&&(utils$1.isFunction(s)?r.paramsSerializer={serialize:s}:validator$1.assertOptions(s,{encode:validators.function,serialize:validators.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),validator$1.assertOptions(r,{baseUrl:validators.spelling("baseURL"),withXsrfToken:validators.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=a&&utils$1.merge(a.common,a[r.method]);a&&utils$1.forEach(["delete","get","head","post","put","patch","common"],b=>{delete a[b]}),r.headers=AxiosHeaders$1.concat(o,a);const l=[];let u=!0;this.interceptors.request.forEach(function(E){typeof E.runWhen=="function"&&E.runWhen(r)===!1||(u=u&&E.synchronous,l.unshift(E.fulfilled,E.rejected))});const c=[];this.interceptors.response.forEach(function(E){c.push(E.fulfilled,E.rejected)});let d,p=0,m;if(!u){const b=[dispatchRequest.bind(this),void 0];for(b.unshift.apply(b,l),b.push.apply(b,c),m=b.length,d=Promise.resolve(r);p<m;)d=d.then(b[p++],b[p++]);return d}m=l.length;let y=r;for(p=0;p<m;){const b=l[p++],E=l[p++];try{y=b(y)}catch(T){E.call(this,T);break}}try{d=dispatchRequest.call(this,y)}catch(b){return Promise.reject(b)}for(p=0,m=c.length;p<m;)d=d.then(c[p++],c[p++]);return d}getUri(e){e=mergeConfig$1(this.defaults,e);const r=buildFullPath(e.baseURL,e.url,e.allowAbsoluteUrls);return buildURL(r,e.params,e.paramsSerializer)}};utils$1.forEach(["delete","get","head","options"],function(e){Axios$1.prototype[e]=function(r,n){return this.request(mergeConfig$1(n||{},{method:e,url:r,data:(n||{}).data}))}});utils$1.forEach(["post","put","patch"],function(e){function r(n){return function(a,o,l){return this.request(mergeConfig$1(l||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}Axios$1.prototype[e]=r(),Axios$1.prototype[e+"Form"]=r(!0)});let CancelToken$1=class Zh{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(s=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](s);n._listeners=null}),this.promise.then=s=>{let a;const o=new Promise(l=>{n.subscribe(l),a=l}).then(s);return o.cancel=function(){n.unsubscribe(a)},o},e(function(a,o,l){n.reason||(n.reason=new CanceledError$1(a,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=n=>{e.abort(n)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new Zh(function(s){e=s}),cancel:e}}};function spread$1(t){return function(r){return t.apply(null,r)}}function isAxiosError$1(t){return utils$1.isObject(t)&&t.isAxiosError===!0}const HttpStatusCode$1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode$1).forEach(([t,e])=>{HttpStatusCode$1[e]=t});function createInstance(t){const e=new Axios$1(t),r=bind(Axios$1.prototype.request,e);return utils$1.extend(r,Axios$1.prototype,e,{allOwnKeys:!0}),utils$1.extend(r,e,null,{allOwnKeys:!0}),r.create=function(s){return createInstance(mergeConfig$1(t,s))},r}const axios=createInstance(defaults$2);axios.Axios=Axios$1;axios.CanceledError=CanceledError$1;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel$1;axios.VERSION=VERSION$2;axios.toFormData=toFormData$1;axios.AxiosError=AxiosError$1;axios.Cancel=axios.CanceledError;axios.all=function(e){return Promise.all(e)};axios.spread=spread$1;axios.isAxiosError=isAxiosError$1;axios.mergeConfig=mergeConfig$1;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=t=>formDataToJSON(utils$1.isHTMLForm(t)?new FormData(t):t);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const{Axios,AxiosError,CanceledError,isCancel,CancelToken,VERSION:VERSION$1,all,Cancel,isAxiosError,spread,toFormData,AxiosHeaders,HttpStatusCode,formToJSON,getAdapter,mergeConfig}=axios,api=axios.create({baseURL:"http://localhost:3000",headers:{"Content-Type":"application/json"},withCredentials:!0,timeout:15e3});api.interceptors.request.use(t=>{const e=localStorage.getItem("token");return e&&(t.headers.Authorization=`Bearer ${e}`),t});api.interceptors.response.use(t=>t,t=>{var e;return((e=t.response)==null?void 0:e.status)===401&&(localStorage.removeItem("token"),window.location.href="/"),Promise.reject(t)});const authService={async login(t){return(await api.post("/api/auth/login",t)).data},async logout(){try{await api.post("/api/auth/logout")}finally{localStorage.removeItem("token")}},async getCurrentUser(){try{return(await api.get("/api/auth/me")).data}catch{return null}}},trackEvent=(t,e,r)=>{},UserContext=reactExports.createContext(void 0);function useUser(){const t=reactExports.useContext(UserContext);if(t===void 0)throw new Error("useUser must be used within a UserProvider");return t}function UserProvider({children:t}){const[e,r]=reactExports.useState(null),[n,s]=reactExports.useState(!0),[a,o]=reactExports.useState(null);reactExports.useEffect(()=>{const d=localStorage.getItem("user"),p=localStorage.getItem("token");console.log("Initial auth check:",{storedUser:d,token:p}),d&&p?(r(JSON.parse(d)),authService.getCurrentUser().then(m=>{console.log("Token validation result:",{user:m}),m||(console.log("Token invalid, clearing storage"),localStorage.removeItem("token"),localStorage.removeItem("user"),r(null))}).finally(()=>{s(!1)})):s(!1)},[]);const c={currentUser:e,setCurrentUser:r,isAuthenticated:!!e,login:async(d,p)=>{try{s(!0),o(null);const{user:m,token:y}=await authService.login({email:d,password:p});return localStorage.setItem("token",y),localStorage.setItem("user",JSON.stringify(m)),r(m),trackEvent("login_success","auth"),!0}catch(m){return o(m instanceof Error?m.message:"登入失敗"),!1}finally{s(!1)}},logout:async()=>{try{await authService.logout(),localStorage.removeItem("user"),r(null),trackEvent("logout","auth")}catch(d){console.error("Logout failed:",d)}},isLoading:n,error:a};return n?null:jsxRuntimeExports.jsx(UserContext.Provider,{value:c,children:t})}/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),toCamelCase=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),toPascalCase=t=>{const e=toCamelCase(t);return e.charAt(0).toUpperCase()+e.slice(1)},mergeClasses=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),hasA11yProp=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Icon=reactExports.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:o,...l},u)=>reactExports.createElement("svg",{ref:u,...defaultAttributes,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:mergeClasses("lucide",s),...!a&&!hasA11yProp(l)&&{"aria-hidden":"true"},...l},[...o.map(([c,d])=>reactExports.createElement(c,d)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const createLucideIcon=(t,e)=>{const r=reactExports.forwardRef(({className:n,...s},a)=>reactExports.createElement(Icon,{ref:a,iconNode:e,className:mergeClasses(`lucide-${toKebabCase(toPascalCase(t))}`,`lucide-${t}`,n),...s}));return r.displayName=toPascalCase(t),r};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$1a=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ArrowLeft=createLucideIcon("arrow-left",__iconNode$1a);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$19=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],ArrowRight=createLucideIcon("arrow-right",__iconNode$19);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$18=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Award=createLucideIcon("award",__iconNode$18);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$17=[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}],["line",{x1:"6",x2:"6",y1:"11",y2:"13",key:"1wd6dw"}],["line",{x1:"10",x2:"10",y1:"11",y2:"13",key:"haxvl5"}]],BatteryMedium=createLucideIcon("battery-medium",__iconNode$17);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$16=[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}],["line",{x1:"6",x2:"6",y1:"11",y2:"13",key:"1wd6dw"}]],BatteryLow=createLucideIcon("battery-low",__iconNode$16);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$15=[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]],Battery=createLucideIcon("battery",__iconNode$15);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$14=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Bell=createLucideIcon("bell",__iconNode$14);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$13=[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],BookMarked=createLucideIcon("book-marked",__iconNode$13);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$12=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],BookOpen=createLucideIcon("book-open",__iconNode$12);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$11=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],Book=createLucideIcon("book",__iconNode$11);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$10=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],Bookmark=createLucideIcon("bookmark",__iconNode$10);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$$=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],Brain=createLucideIcon("brain",__iconNode$$);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$_=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],CalendarDays=createLucideIcon("calendar-days",__iconNode$_);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$Z=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Calendar$1=createLucideIcon("calendar",__iconNode$Z);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$Y=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Check=createLucideIcon("check",__iconNode$Y);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$X=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ChevronDown=createLucideIcon("chevron-down",__iconNode$X);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$W=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],ChevronLeft=createLucideIcon("chevron-left",__iconNode$W);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$V=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ChevronRight=createLucideIcon("chevron-right",__iconNode$V);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$U=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ChevronUp=createLucideIcon("chevron-up",__iconNode$U);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$T=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],CircleAlert=createLucideIcon("circle-alert",__iconNode$T);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$S=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],CircleCheckBig=createLucideIcon("circle-check-big",__iconNode$S);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$R=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],CircleCheck=createLucideIcon("circle-check",__iconNode$R);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$Q=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]],CirclePause=createLucideIcon("circle-pause",__iconNode$Q);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$P=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]],CirclePlay=createLucideIcon("circle-play",__iconNode$P);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$O=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Circle=createLucideIcon("circle",__iconNode$O);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$N=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],Clock=createLucideIcon("clock",__iconNode$N);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$M=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Compass=createLucideIcon("compass",__iconNode$M);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$L=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Download=createLucideIcon("download",__iconNode$L);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$K=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]],FilePlus=createLucideIcon("file-plus",__iconNode$K);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$J=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],FileText=createLucideIcon("file-text",__iconNode$J);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$I=[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]],Flag=createLucideIcon("flag",__iconNode$I);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$H=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],Frown=createLucideIcon("frown",__iconNode$H);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$G=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Funnel=createLucideIcon("funnel",__iconNode$G);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$F=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],GripVertical=createLucideIcon("grip-vertical",__iconNode$F);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$E=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],History=createLucideIcon("history",__iconNode$E);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$D=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],House=createLucideIcon("house",__iconNode$D);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$C=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],KeyRound=createLucideIcon("key-round",__iconNode$C);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$B=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],Lightbulb=createLucideIcon("lightbulb",__iconNode$B);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$A=[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]],ListChecks=createLucideIcon("list-checks",__iconNode$A);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$z=[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]],ListTodo=createLucideIcon("list-todo",__iconNode$z);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$y=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],LoaderCircle=createLucideIcon("loader-circle",__iconNode$y);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$x=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Lock=createLucideIcon("lock",__iconNode$x);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$w=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],LogOut=createLucideIcon("log-out",__iconNode$w);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$v=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Mail=createLucideIcon("mail",__iconNode$v);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$u=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],Map$1=createLucideIcon("map",__iconNode$u);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$t=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"8",x2:"16",y1:"15",y2:"15",key:"1xb1d9"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],Meh=createLucideIcon("meh",__iconNode$t);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$s=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],Menu$1=createLucideIcon("menu",__iconNode$s);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$r=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],MessageSquare=createLucideIcon("message-square",__iconNode$r);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$q=[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]],Moon=createLucideIcon("moon",__iconNode$q);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$p=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],Paperclip=createLucideIcon("paperclip",__iconNode$p);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$o=[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]],PartyPopper=createLucideIcon("party-popper",__iconNode$o);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$n=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Pen=createLucideIcon("pen",__iconNode$n);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$m=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Pencil=createLucideIcon("pencil",__iconNode$m);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$l=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Plus=createLucideIcon("plus",__iconNode$l);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$k=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],RotateCcw=createLucideIcon("rotate-ccw",__iconNode$k);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$j=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Search=createLucideIcon("search",__iconNode$j);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$i=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Send=createLucideIcon("send",__iconNode$i);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$h=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Settings=createLucideIcon("settings",__iconNode$h);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$g=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Share2=createLucideIcon("share-2",__iconNode$g);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$f=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],Smile=createLucideIcon("smile",__iconNode$f);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$e=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],Sparkles=createLucideIcon("sparkles",__iconNode$e);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$d=[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],SquareCheckBig=createLucideIcon("square-check-big",__iconNode$d);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$c=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Star=createLucideIcon("star",__iconNode$c);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$b=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Sun=createLucideIcon("sun",__iconNode$b);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$a=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Tag=createLucideIcon("tag",__iconNode$a);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$9=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Target=createLucideIcon("target",__iconNode$9);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$8=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Trash2=createLucideIcon("trash-2",__iconNode$8);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$7=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],TrendingUp=createLucideIcon("trending-up",__iconNode$7);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$6=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],TriangleAlert=createLucideIcon("triangle-alert",__iconNode$6);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$5=[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]],Trophy=createLucideIcon("trophy",__iconNode$5);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$4=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Upload=createLucideIcon("upload",__iconNode$4);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$3=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],User$1=createLucideIcon("user",__iconNode$3);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$2=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],X=createLucideIcon("x",__iconNode$2);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$1=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],ZoomIn=createLucideIcon("zoom-in",__iconNode$1);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],ZoomOut=createLucideIcon("zoom-out",__iconNode),CONTACT_EMAIL="chiawentsai.0807@gmail.com",Login=()=>{const[t,e]=reactExports.useState(""),[r,n]=reactExports.useState(""),[s,a]=reactExports.useState(""),[o,l]=reactExports.useState(!1),{login:u,isAuthenticated:c,currentUser:d}=useUser(),p=useNavigate();React.useEffect(()=>{c&&d&&p(d.role==="student"?"/student":"/mentor")},[c,d,p]);const m=async b=>{b.preventDefault(),l(!0),a("");try{await u(t,r)||a("Invalid email or password")}catch{a("An error occurred. Please try again.")}finally{l(!1)}},y=async b=>{l(!0);try{await u(`demo-${b}@example.com`,"demo-password")}catch{a("Demo login failed. Please try again.")}finally{l(!1)}};return jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-100 to-teal-100 dark:from-gray-900 dark:to-indigo-950 flex items-center justify-center p-4 relative",children:jsxRuntimeExports.jsxs("div",{className:"max-w-md w-full space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"text-center space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-indigo-600 to-teal-600 dark:from-indigo-400 dark:to-teal-400 bg-clip-text text-transparent",children:"探索每個人獨特的學習旅程"}),jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center text-base",children:jsxRuntimeExports.jsx("span",{className:"bg-gradient-to-r from-indigo-500 to-indigo-600 dark:from-indigo-400 dark:to-indigo-500 bg-clip-text text-transparent font-medium",children:"老師和學生的溝通橋樑"})}),jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center text-base",children:jsxRuntimeExports.jsx("span",{className:"bg-gradient-to-r from-teal-500 to-teal-600 dark:from-teal-400 dark:to-teal-500 bg-clip-text text-transparent font-medium",children:"培養自主學習能力"})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>window.location.href=`mailto:${CONTACT_EMAIL}`,className:"inline-flex items-center px-6 py-3 text-base font-medium rounded-full shadow-lg text-white bg-teal-600 hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-colors",children:[jsxRuntimeExports.jsx(Mail,{className:"h-5 w-5 mr-2"}),"加入我們成為早期使用者"]}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["歡迎來信了解更多：",CONTACT_EMAIL]})]})]}),jsxRuntimeExports.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl overflow-hidden",children:jsxRuntimeExports.jsxs("div",{className:"p-6 sm:p-8",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-8",children:[jsxRuntimeExports.jsx("div",{className:"mx-auto bg-indigo-100 dark:bg-indigo-900 rounded-full w-16 h-16 flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx(BookOpen,{size:32,className:"text-indigo-600 dark:text-indigo-400"})}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"學習進度追蹤"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-2",children:"登入以管理學習進度和目標"})]}),s&&jsxRuntimeExports.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded-lg text-sm",children:s}),jsxRuntimeExports.jsxs("form",{onSubmit:m,className:"space-y-5",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"電子郵件"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:jsxRuntimeExports.jsx(User$1,{size:18,className:"text-gray-400"})}),jsxRuntimeExports.jsx("input",{id:"email",type:"email",value:t,onChange:b=>e(b.target.value),autoComplete:"email",className:"block w-full pl-10 pr-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"your@email.com",required:!0})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"密碼"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:jsxRuntimeExports.jsx(KeyRound,{size:18,className:"text-gray-400"})}),jsxRuntimeExports.jsx("input",{id:"password",type:"password",value:r,onChange:b=>n(b.target.value),autoComplete:"current-password",className:"block w-full pl-10 pr-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"••••••••",required:!0})]})]}),jsxRuntimeExports.jsx("button",{type:"submit",disabled:o,className:"w-full flex justify-center py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:o?"登入中...":"登入"})]}),jsxRuntimeExports.jsxs("div",{className:"mt-6",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center",children:jsxRuntimeExports.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})}),jsxRuntimeExports.jsx("div",{className:"relative flex justify-center text-sm",children:jsxRuntimeExports.jsx("span",{className:"px-2 bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400",children:"快速體驗"})})]}),jsxRuntimeExports.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>y("student"),disabled:o,className:"py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-teal-600 hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"學生示範"}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>y("mentor"),disabled:o,className:"py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"老師示範"})]})]})]})})]})})},Sidebar=({isOpen:t,setIsOpen:e,isCollapsed:r,setIsCollapsed:n})=>{const{currentUser:s,logout:a}=useUser(),o=s==null?void 0:s.role,u=o?{student:[{name:"時間表",path:"/student/schedule",icon:jsxRuntimeExports.jsx(CalendarDays,{size:20})},{name:"儀表板",path:"/student",icon:jsxRuntimeExports.jsx(BookOpen,{size:20})},{name:"學習規劃",path:"/student/planning",icon:jsxRuntimeExports.jsx(Target,{size:20})},{name:"學習地圖",path:"/student/learning-map",icon:jsxRuntimeExports.jsx(Map$1,{size:20})},{name:"學習日誌",path:"/student/journal",icon:jsxRuntimeExports.jsx(BookMarked,{size:20})}],mentor:[{name:"儀表板",path:"/mentor",icon:jsxRuntimeExports.jsx(BookOpen,{size:20})},{name:"任務管理",path:"/mentor/tasks",icon:jsxRuntimeExports.jsx(ListTodo,{size:20})},{name:"課程規劃",path:"/mentor/curriculum",icon:jsxRuntimeExports.jsx(Map$1,{size:20})},{name:"任務規劃",path:"/mentor/task-planner",icon:jsxRuntimeExports.jsx(Calendar$1,{size:20})},{name:"課程藍圖",path:"/mentor/course-blueprint",icon:jsxRuntimeExports.jsx(Target,{size:20})}]}[o]:[],c=()=>e(!t),d=()=>n(!r);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[t&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-20 lg:hidden",onClick:c}),jsxRuntimeExports.jsx("button",{className:"fixed top-4 left-4 z-30 lg:hidden bg-indigo-600 text-white p-2 rounded-md",onClick:c,children:t?jsxRuntimeExports.jsx(X,{size:20}):jsxRuntimeExports.jsx(Menu$1,{size:20})}),jsxRuntimeExports.jsxs("div",{className:`fixed lg:relative bg-white dark:bg-gray-900 transform transition-all duration-300 ease-in-out ${t?"translate-x-0":"-translate-x-full lg:translate-x-0"} ${r?"w-16":"w-64"} h-full z-30 shadow-lg`,children:[jsxRuntimeExports.jsx("button",{onClick:d,className:"hidden lg:flex absolute -right-3 top-1/2 transform -translate-y-1/2 w-6 h-6 bg-indigo-600 text-white items-center justify-center rounded-full shadow-lg hover:bg-indigo-700",children:r?jsxRuntimeExports.jsx(ChevronRight,{size:14}):jsxRuntimeExports.jsx(ChevronLeft,{size:14})}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-full",children:[jsxRuntimeExports.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[jsxRuntimeExports.jsx("h1",{className:`text-xl font-bold text-indigo-600 dark:text-indigo-400 truncate ${r?"text-center":""}`,children:r?"學習":"學習進度追蹤"}),!r&&jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:o==="student"?"學生版":"指導老師版"})]}),jsxRuntimeExports.jsx("nav",{className:"flex-1 overflow-y-auto py-4",children:jsxRuntimeExports.jsx("ul",{className:"space-y-1 px-2",children:u.map(p=>jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsxs(NavLink,{to:p.path,className:({isActive:m})=>`flex items-center px-4 py-2.5 text-sm rounded-lg transition-colors ${m&&p.path===window.location.pathname?"bg-indigo-100 text-indigo-700 dark:bg-indigo-900 dark:text-indigo-300 font-medium":"text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800"}`,onClick:()=>e(!1),title:r?p.name:void 0,children:[jsxRuntimeExports.jsx("span",{className:r?"mx-auto":"mr-3",children:p.icon}),!r&&p.name]})},p.path))})}),jsxRuntimeExports.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[(s==null?void 0:s.avatar)&&jsxRuntimeExports.jsx("img",{src:s.avatar,alt:s.name,className:`w-10 h-10 rounded-full object-cover ${r?"mx-auto":"mr-3"}`}),!r&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:s==null?void 0:s.name}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:o==="student"?"學生":"指導老師"})]}),jsxRuntimeExports.jsx("button",{onClick:a,className:"p-1.5 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",title:"登出",children:jsxRuntimeExports.jsx(LogOut,{size:18})})]})]})})]})]})]})},Header=({title:t})=>{const{currentUser:e}=useUser(),[r,n]=React.useState(!1),s=()=>{n(!r),document.documentElement.classList.toggle("dark")};return jsxRuntimeExports.jsxs("header",{className:"bg-white dark:bg-gray-900 shadow-sm border-b border-gray-200 dark:border-gray-800 h-16 flex items-center px-4 lg:px-6",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 min-w-0",children:jsxRuntimeExports.jsx("h1",{className:"text-xl font-semibold text-gray-800 dark:text-gray-100 truncate",children:t})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsx("button",{className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",onClick:s,children:r?jsxRuntimeExports.jsx(Sun,{size:20}):jsxRuntimeExports.jsx(Moon,{size:20})}),jsxRuntimeExports.jsxs("button",{className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors relative",children:[jsxRuntimeExports.jsx(Bell,{size:20}),jsxRuntimeExports.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),jsxRuntimeExports.jsxs("div",{className:"hidden sm:flex items-center",children:[(e==null?void 0:e.avatar)&&jsxRuntimeExports.jsx("img",{src:e.avatar,alt:e.name,className:"w-8 h-8 rounded-full object-cover"}),jsxRuntimeExports.jsx("span",{className:"ml-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:e==null?void 0:e.name})]})]})]})},PageLayout=({children:t,title:e})=>{const[r,n]=reactExports.useState(!1),[s,a]=reactExports.useState(!1),{isAuthenticated:o}=useUser(),l=useNavigate();return React.useEffect(()=>{o||(console.log("Not authenticated, redirecting to login"),l("/login"))},[o,l]),o?jsxRuntimeExports.jsxs("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-950",children:[jsxRuntimeExports.jsx(Sidebar,{isOpen:r,setIsOpen:n,isCollapsed:s,setIsCollapsed:a}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col",children:[jsxRuntimeExports.jsx(Header,{title:e,toggleSidebar:()=>n(!r)}),jsxRuntimeExports.jsx("main",{className:"flex-1 overflow-y-auto p-4 lg:p-6",children:t})]})]}):null},ProgressChart=({data:t,title:e="學習進度"})=>{const r=Math.round(t.reduce((n,s)=>n+s.progress,0)/t.length);return jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-4",children:e}),jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center mb-2",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-700 dark:text-gray-300 mr-2 font-medium",children:"總進度："}),jsxRuntimeExports.jsxs("span",{className:"text-lg font-bold text-indigo-600 dark:text-indigo-400",children:[r,"%"]})]}),jsxRuntimeExports.jsx("div",{className:"w-full h-3 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden mb-6",children:jsxRuntimeExports.jsx("div",{className:"h-full bg-indigo-500 dark:bg-indigo-400 transition-all duration-500",style:{width:`${r}%`}})})]}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:t.map((n,s)=>jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between mb-1",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:n.subject}),jsxRuntimeExports.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[n.progress,"%"]})]}),jsxRuntimeExports.jsx("div",{className:"w-full h-3 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${n.progress}%`,backgroundColor:n.color}})})]},s))})]})},getDefaultsFromPostinstall=()=>{};var define_process_env_default$3={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray$1=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},byteArrayToString=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=t[r++];e[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=t[r++],o=t[r++],l=t[r++],u=((s&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const a=t[r++],o=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|o&63)}}return e.join("")},base64$1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const a=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,c=u?t[s+2]:0,d=a>>2,p=(a&3)<<4|l>>4;let m=(l&15)<<2|c>>6,y=c&63;u||(y=64,o||(m=64)),n.push(r[d],r[p],r[m],r[y])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(stringToByteArray$1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):byteArrayToString(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const a=r[t.charAt(s++)],l=s<t.length?r[t.charAt(s)]:0;++s;const c=s<t.length?r[t.charAt(s)]:64;++s;const p=s<t.length?r[t.charAt(s)]:64;if(++s,a==null||l==null||c==null||p==null)throw new DecodeBase64StringError;const m=a<<2|l>>4;if(n.push(m),c!==64){const y=l<<4&240|c>>2;if(n.push(y),p!==64){const b=c<<6&192|p;n.push(b)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class DecodeBase64StringError extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const base64Encode=function(t){const e=stringToByteArray$1(t);return base64$1.encodeByteArray(e,!0)},base64urlEncodeWithoutPadding=function(t){return base64Encode(t).replace(/\./g,"")},base64Decode=function(t){try{return base64$1.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getGlobal(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const getDefaultsFromGlobal=()=>getGlobal().__FIREBASE_DEFAULTS__,getDefaultsFromEnvVariable=()=>{if(typeof process>"u"||typeof define_process_env_default$3>"u")return;const t=define_process_env_default$3.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},getDefaultsFromCookie=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&base64Decode(t[1]);return e&&JSON.parse(e)},getDefaults=()=>{try{return getDefaultsFromPostinstall()||getDefaultsFromGlobal()||getDefaultsFromEnvVariable()||getDefaultsFromCookie()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},getDefaultEmulatorHost=t=>{var e,r;return(r=(e=getDefaults())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},getDefaultEmulatorHostnameAndPort=t=>{const e=getDefaultEmulatorHost(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},getDefaultAppConfig=()=>{var t;return(t=getDefaults())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Deferred{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isCloudWorkstation(t){return t.endsWith(".cloudworkstations.dev")}async function pingServer(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createMockUserToken(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},t);return[base64urlEncodeWithoutPadding(JSON.stringify(r)),base64urlEncodeWithoutPadding(JSON.stringify(o)),""].join(".")}const emulatorStatus={};function getEmulatorSummary(){const t={prod:[],emulator:[]};for(const e of Object.keys(emulatorStatus))emulatorStatus[e]?t.emulator.push(e):t.prod.push(e);return t}function getOrCreateEl(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let previouslyDismissed=!1;function updateEmulatorBanner(t,e){if(typeof window>"u"||typeof document>"u"||!isCloudWorkstation(window.location.host)||emulatorStatus[t]===e||emulatorStatus[t]||previouslyDismissed)return;emulatorStatus[t]=e;function r(m){return`__firebase__banner__${m}`}const n="__firebase__banner",a=getEmulatorSummary().prod.length>0;function o(){const m=document.getElementById(n);m&&m.remove()}function l(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,y){m.setAttribute("width","24"),m.setAttribute("id",y),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function c(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{previouslyDismissed=!0,o()},m}function d(m,y){m.setAttribute("id",y),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=getOrCreateEl(n),y=r("text"),b=document.getElementById(y)||document.createElement("span"),E=r("learnmore"),T=document.getElementById(E)||document.createElement("a"),S=r("preprendIcon"),P=document.getElementById(S)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const A=m.element;l(A),d(T,E);const I=c();u(P,S),A.append(P,b,T,I),document.body.appendChild(A)}a?(b.innerText="Preview backend disconnected.",P.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(P.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,b.innerText="Preview backend running in this workspace."),b.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getUA(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function isNode$4(){var t;const e=(t=getDefaults())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function isSafari(){return!isNode$4()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function isIndexedDBAvailable(){try{return typeof indexedDB=="object"}catch{return!1}}function validateIndexedDBOpenable(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var a;e(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERROR_NAME="FirebaseError";class FirebaseError extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=ERROR_NAME,Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}}class ErrorFactory{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,a=this.errors[e],o=a?replaceTemplate(a,n):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new FirebaseError(s,l,n)}}function replaceTemplate(t,e){return t.replace(PATTERN,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const PATTERN=/\{\$([^}]+)}/g;function deepEqual$1(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const a=t[s],o=e[s];if(isObject$1(a)&&isObject$1(o)){if(!deepEqual$1(a,o))return!1}else if(a!==o)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function isObject$1(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getModularInstance(t){return t&&t._delegate?t._delegate:t}class Component{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME$1="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Provider$3=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Deferred;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(isComponentEager(e))try{this.getOrInitializeService({instanceIdentifier:DEFAULT_ENTRY_NAME$1})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(e=DEFAULT_ENTRY_NAME$1){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=DEFAULT_ENTRY_NAME$1){return this.instances.has(e)}getOptions(e=DEFAULT_ENTRY_NAME$1){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(a);n===l&&o.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),a=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;a.add(e),this.onInitCallbacks.set(s,a);const o=this.instances.get(s);return o&&e(o,s),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:normalizeIdentifierForFactory(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=DEFAULT_ENTRY_NAME$1){return this.component?this.component.multipleInstances?e:DEFAULT_ENTRY_NAME$1:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function normalizeIdentifierForFactory(t){return t===DEFAULT_ENTRY_NAME$1?void 0:t}function isComponentEager(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ComponentContainer{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new Provider$3(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var LogLevel;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(LogLevel||(LogLevel={}));const levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod={[LogLevel.DEBUG]:"log",[LogLevel.VERBOSE]:"log",[LogLevel.INFO]:"info",[LogLevel.WARN]:"warn",[LogLevel.ERROR]:"error"},defaultLogHandler=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=ConsoleMethod[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Logger{constructor(e){this.name=e,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in LogLevel))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?levelStringToEnum[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.DEBUG,...e),this._logHandler(this,LogLevel.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.VERBOSE,...e),this._logHandler(this,LogLevel.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.INFO,...e),this._logHandler(this,LogLevel.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.WARN,...e),this._logHandler(this,LogLevel.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.ERROR,...e),this._logHandler(this,LogLevel.ERROR,...e)}}const instanceOfAny=(t,e)=>e.some(r=>t instanceof r);let idbProxyableTypes,cursorAdvanceMethods;function getIdbProxyableTypes(){return idbProxyableTypes||(idbProxyableTypes=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return cursorAdvanceMethods||(cursorAdvanceMethods=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cursorRequestMap=new WeakMap,transactionDoneMap=new WeakMap,transactionStoreNamesMap=new WeakMap,transformCache=new WeakMap,reverseTransformCache=new WeakMap;function promisifyRequest(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{r(wrap$1(t.result)),s()},o=()=>{n(t.error),s()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&cursorRequestMap.set(r,t)}).catch(()=>{}),reverseTransformCache.set(e,t),e}function cacheDonePromiseForTransaction(t){if(transactionDoneMap.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{r(),s()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});transactionDoneMap.set(t,e)}let idbProxyTraps={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return transactionDoneMap.get(t);if(e==="objectStoreNames")return t.objectStoreNames||transactionStoreNamesMap.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return wrap$1(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function replaceTraps(t){idbProxyTraps=t(idbProxyTraps)}function wrapFunction(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(unwrap(this),e,...r);return transactionStoreNamesMap.set(n,e.sort?e.sort():[e]),wrap$1(n)}:getCursorAdvanceMethods().includes(t)?function(...e){return t.apply(unwrap(this),e),wrap$1(cursorRequestMap.get(this))}:function(...e){return wrap$1(t.apply(unwrap(this),e))}}function transformCachableValue(t){return typeof t=="function"?wrapFunction(t):(t instanceof IDBTransaction&&cacheDonePromiseForTransaction(t),instanceOfAny(t,getIdbProxyableTypes())?new Proxy(t,idbProxyTraps):t)}function wrap$1(t){if(t instanceof IDBRequest)return promisifyRequest(t);if(transformCache.has(t))return transformCache.get(t);const e=transformCachableValue(t);return e!==t&&(transformCache.set(t,e),reverseTransformCache.set(e,t)),e}const unwrap=t=>reverseTransformCache.get(t);function openDB(t,e,{blocked:r,upgrade:n,blocking:s,terminated:a}={}){const o=indexedDB.open(t,e),l=wrap$1(o);return n&&o.addEventListener("upgradeneeded",u=>{n(wrap$1(o.result),u.oldVersion,u.newVersion,wrap$1(o.transaction),u)}),r&&o.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),l.then(u=>{a&&u.addEventListener("close",()=>a()),s&&u.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const readMethods=["get","getKey","getAll","getAllKeys","count"],writeMethods=["put","add","delete","clear"],cachedMethods=new Map;function getMethod(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(cachedMethods.get(e))return cachedMethods.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=writeMethods.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||readMethods.includes(r)))return;const a=async function(o,...l){const u=this.transaction(o,s?"readwrite":"readonly");let c=u.store;return n&&(c=c.index(l.shift())),(await Promise.all([c[r](...l),s&&u.done]))[0]};return cachedMethods.set(e,a),a}replaceTraps(t=>({...t,get:(e,r,n)=>getMethod(e,r)||t.get(e,r,n),has:(e,r)=>!!getMethod(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PlatformLoggerServiceImpl{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(isVersionServiceProvider(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function isVersionServiceProvider(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const name$q="@firebase/app",version$1="0.13.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger=new Logger("@firebase/app"),name$p="@firebase/app-compat",name$o="@firebase/analytics-compat",name$n="@firebase/analytics",name$m="@firebase/app-check-compat",name$l="@firebase/app-check",name$k="@firebase/auth",name$j="@firebase/auth-compat",name$i="@firebase/database",name$h="@firebase/data-connect",name$g="@firebase/database-compat",name$f="@firebase/functions",name$e="@firebase/functions-compat",name$d="@firebase/installations",name$c="@firebase/installations-compat",name$b="@firebase/messaging",name$a="@firebase/messaging-compat",name$9="@firebase/performance",name$8="@firebase/performance-compat",name$7="@firebase/remote-config",name$6="@firebase/remote-config-compat",name$5="@firebase/storage",name$4="@firebase/storage-compat",name$3="@firebase/firestore",name$2="@firebase/ai",name$1="@firebase/firestore-compat",name$r="firebase",version$2="11.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME="[DEFAULT]",PLATFORM_LOG_STRING={[name$q]:"fire-core",[name$p]:"fire-core-compat",[name$n]:"fire-analytics",[name$o]:"fire-analytics-compat",[name$l]:"fire-app-check",[name$m]:"fire-app-check-compat",[name$k]:"fire-auth",[name$j]:"fire-auth-compat",[name$i]:"fire-rtdb",[name$h]:"fire-data-connect",[name$g]:"fire-rtdb-compat",[name$f]:"fire-fn",[name$e]:"fire-fn-compat",[name$d]:"fire-iid",[name$c]:"fire-iid-compat",[name$b]:"fire-fcm",[name$a]:"fire-fcm-compat",[name$9]:"fire-perf",[name$8]:"fire-perf-compat",[name$7]:"fire-rc",[name$6]:"fire-rc-compat",[name$5]:"fire-gcs",[name$4]:"fire-gcs-compat",[name$3]:"fire-fst",[name$1]:"fire-fst-compat",[name$2]:"fire-vertex","fire-js":"fire-js",[name$r]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _apps=new Map,_serverApps=new Map,_components=new Map;function _addComponent(t,e){try{t.container.addComponent(e)}catch(r){logger.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function _registerComponent(t){const e=t.name;if(_components.has(e))return logger.debug(`There were multiple attempts to register component ${e}.`),!1;_components.set(e,t);for(const r of _apps.values())_addComponent(r,t);for(const r of _serverApps.values())_addComponent(r,t);return!0}function _getProvider(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function _isFirebaseServerApp(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ERROR_FACTORY=new ErrorFactory("app","Firebase",ERRORS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirebaseAppImpl{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ERROR_FACTORY.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SDK_VERSION=version$2;function initializeApp(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:DEFAULT_ENTRY_NAME,automaticDataCollectionEnabled:!0},e),s=n.name;if(typeof s!="string"||!s)throw ERROR_FACTORY.create("bad-app-name",{appName:String(s)});if(r||(r=getDefaultAppConfig()),!r)throw ERROR_FACTORY.create("no-options");const a=_apps.get(s);if(a){if(deepEqual$1(r,a.options)&&deepEqual$1(n,a.config))return a;throw ERROR_FACTORY.create("duplicate-app",{appName:s})}const o=new ComponentContainer(s);for(const u of _components.values())o.addComponent(u);const l=new FirebaseAppImpl(r,n,o);return _apps.set(s,l),l}function getApp(t=DEFAULT_ENTRY_NAME){const e=_apps.get(t);if(!e&&t===DEFAULT_ENTRY_NAME&&getDefaultAppConfig())return initializeApp();if(!e)throw ERROR_FACTORY.create("no-app",{appName:t});return e}function registerVersion(t,e,r){var n;let s=(n=PLATFORM_LOG_STRING[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const a=s.match(/\s|\//),o=e.match(/\s|\//);if(a||o){const l=[`Unable to register library "${s}" with version "${e}":`];a&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),logger.warn(l.join(" "));return}_registerComponent(new Component(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME="firebase-heartbeat-database",DB_VERSION=1,STORE_NAME="firebase-heartbeat-store";let dbPromise=null;function getDbPromise(){return dbPromise||(dbPromise=openDB(DB_NAME,DB_VERSION,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(STORE_NAME)}catch(r){console.warn(r)}}}}).catch(t=>{throw ERROR_FACTORY.create("idb-open",{originalErrorMessage:t.message})})),dbPromise}async function readHeartbeatsFromIndexedDB(t){try{const r=(await getDbPromise()).transaction(STORE_NAME),n=await r.objectStore(STORE_NAME).get(computeKey(t));return await r.done,n}catch(e){if(e instanceof FirebaseError)logger.warn(e.message);else{const r=ERROR_FACTORY.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});logger.warn(r.message)}}}async function writeHeartbeatsToIndexedDB(t,e){try{const n=(await getDbPromise()).transaction(STORE_NAME,"readwrite");await n.objectStore(STORE_NAME).put(e,computeKey(t)),await n.done}catch(r){if(r instanceof FirebaseError)logger.warn(r.message);else{const n=ERROR_FACTORY.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});logger.warn(n.message)}}}function computeKey(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_HEADER_BYTES=1024,MAX_NUM_STORED_HEARTBEATS=30;class HeartbeatServiceImpl{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=getUTCDateString();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(o=>o.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats.length>MAX_NUM_STORED_HEARTBEATS){const o=getEarliestHeartbeatIdx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){logger.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=getUTCDateString(),{heartbeatsToSend:n,unsentEntries:s}=extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats),a=base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return logger.warn(r),""}}}function getUTCDateString(){return new Date().toISOString().substring(0,10)}function extractHeartbeatsForHeader(t,e=MAX_HEADER_BYTES){const r=[];let n=t.slice();for(const s of t){const a=r.find(o=>o.agent===s.agent);if(a){if(a.dates.push(s.date),countBytes(r)>e){a.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),countBytes(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class HeartbeatStorageImpl{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return isIndexedDBAvailable()?validateIndexedDBOpenable().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await readHeartbeatsFromIndexedDB(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function countBytes(t){return base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:t})).length}function getEarliestHeartbeatIdx(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerCoreComponents(t){_registerComponent(new Component("platform-logger",e=>new PlatformLoggerServiceImpl(e),"PRIVATE")),_registerComponent(new Component("heartbeat",e=>new HeartbeatServiceImpl(e),"PRIVATE")),registerVersion(name$q,version$1,t),registerVersion(name$q,version$1,"esm2017"),registerVersion("fire-js","")}registerCoreComponents("");var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Integer,Md5;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(W,H){function ee(){}ee.prototype=H.prototype,W.D=H.prototype,W.prototype=new ee,W.prototype.constructor=W,W.C=function(ue,de,fe){for(var ae=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)ae[ce-2]=arguments[ce];return H.prototype[de].apply(ue,ae)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(W,H,ee){ee||(ee=0);var ue=Array(16);if(typeof H=="string")for(var de=0;16>de;++de)ue[de]=H.charCodeAt(ee++)|H.charCodeAt(ee++)<<8|H.charCodeAt(ee++)<<16|H.charCodeAt(ee++)<<24;else for(de=0;16>de;++de)ue[de]=H[ee++]|H[ee++]<<8|H[ee++]<<16|H[ee++]<<24;H=W.g[0],ee=W.g[1],de=W.g[2];var fe=W.g[3],ae=H+(fe^ee&(de^fe))+ue[0]+3614090360&4294967295;H=ee+(ae<<7&4294967295|ae>>>25),ae=fe+(de^H&(ee^de))+ue[1]+3905402710&4294967295,fe=H+(ae<<12&4294967295|ae>>>20),ae=de+(ee^fe&(H^ee))+ue[2]+606105819&4294967295,de=fe+(ae<<17&4294967295|ae>>>15),ae=ee+(H^de&(fe^H))+ue[3]+3250441966&4294967295,ee=de+(ae<<22&4294967295|ae>>>10),ae=H+(fe^ee&(de^fe))+ue[4]+4118548399&4294967295,H=ee+(ae<<7&4294967295|ae>>>25),ae=fe+(de^H&(ee^de))+ue[5]+1200080426&4294967295,fe=H+(ae<<12&4294967295|ae>>>20),ae=de+(ee^fe&(H^ee))+ue[6]+2821735955&4294967295,de=fe+(ae<<17&4294967295|ae>>>15),ae=ee+(H^de&(fe^H))+ue[7]+4249261313&4294967295,ee=de+(ae<<22&4294967295|ae>>>10),ae=H+(fe^ee&(de^fe))+ue[8]+1770035416&4294967295,H=ee+(ae<<7&4294967295|ae>>>25),ae=fe+(de^H&(ee^de))+ue[9]+2336552879&4294967295,fe=H+(ae<<12&4294967295|ae>>>20),ae=de+(ee^fe&(H^ee))+ue[10]+4294925233&4294967295,de=fe+(ae<<17&4294967295|ae>>>15),ae=ee+(H^de&(fe^H))+ue[11]+2304563134&4294967295,ee=de+(ae<<22&4294967295|ae>>>10),ae=H+(fe^ee&(de^fe))+ue[12]+1804603682&4294967295,H=ee+(ae<<7&4294967295|ae>>>25),ae=fe+(de^H&(ee^de))+ue[13]+4254626195&4294967295,fe=H+(ae<<12&4294967295|ae>>>20),ae=de+(ee^fe&(H^ee))+ue[14]+2792965006&4294967295,de=fe+(ae<<17&4294967295|ae>>>15),ae=ee+(H^de&(fe^H))+ue[15]+1236535329&4294967295,ee=de+(ae<<22&4294967295|ae>>>10),ae=H+(de^fe&(ee^de))+ue[1]+4129170786&4294967295,H=ee+(ae<<5&4294967295|ae>>>27),ae=fe+(ee^de&(H^ee))+ue[6]+3225465664&4294967295,fe=H+(ae<<9&4294967295|ae>>>23),ae=de+(H^ee&(fe^H))+ue[11]+643717713&4294967295,de=fe+(ae<<14&4294967295|ae>>>18),ae=ee+(fe^H&(de^fe))+ue[0]+3921069994&4294967295,ee=de+(ae<<20&4294967295|ae>>>12),ae=H+(de^fe&(ee^de))+ue[5]+3593408605&4294967295,H=ee+(ae<<5&4294967295|ae>>>27),ae=fe+(ee^de&(H^ee))+ue[10]+38016083&4294967295,fe=H+(ae<<9&4294967295|ae>>>23),ae=de+(H^ee&(fe^H))+ue[15]+3634488961&4294967295,de=fe+(ae<<14&4294967295|ae>>>18),ae=ee+(fe^H&(de^fe))+ue[4]+3889429448&4294967295,ee=de+(ae<<20&4294967295|ae>>>12),ae=H+(de^fe&(ee^de))+ue[9]+568446438&4294967295,H=ee+(ae<<5&4294967295|ae>>>27),ae=fe+(ee^de&(H^ee))+ue[14]+3275163606&4294967295,fe=H+(ae<<9&4294967295|ae>>>23),ae=de+(H^ee&(fe^H))+ue[3]+4107603335&4294967295,de=fe+(ae<<14&4294967295|ae>>>18),ae=ee+(fe^H&(de^fe))+ue[8]+1163531501&4294967295,ee=de+(ae<<20&4294967295|ae>>>12),ae=H+(de^fe&(ee^de))+ue[13]+2850285829&4294967295,H=ee+(ae<<5&4294967295|ae>>>27),ae=fe+(ee^de&(H^ee))+ue[2]+4243563512&4294967295,fe=H+(ae<<9&4294967295|ae>>>23),ae=de+(H^ee&(fe^H))+ue[7]+1735328473&4294967295,de=fe+(ae<<14&4294967295|ae>>>18),ae=ee+(fe^H&(de^fe))+ue[12]+2368359562&4294967295,ee=de+(ae<<20&4294967295|ae>>>12),ae=H+(ee^de^fe)+ue[5]+4294588738&4294967295,H=ee+(ae<<4&4294967295|ae>>>28),ae=fe+(H^ee^de)+ue[8]+2272392833&4294967295,fe=H+(ae<<11&4294967295|ae>>>21),ae=de+(fe^H^ee)+ue[11]+1839030562&4294967295,de=fe+(ae<<16&4294967295|ae>>>16),ae=ee+(de^fe^H)+ue[14]+4259657740&4294967295,ee=de+(ae<<23&4294967295|ae>>>9),ae=H+(ee^de^fe)+ue[1]+2763975236&4294967295,H=ee+(ae<<4&4294967295|ae>>>28),ae=fe+(H^ee^de)+ue[4]+1272893353&4294967295,fe=H+(ae<<11&4294967295|ae>>>21),ae=de+(fe^H^ee)+ue[7]+4139469664&4294967295,de=fe+(ae<<16&4294967295|ae>>>16),ae=ee+(de^fe^H)+ue[10]+3200236656&4294967295,ee=de+(ae<<23&4294967295|ae>>>9),ae=H+(ee^de^fe)+ue[13]+681279174&4294967295,H=ee+(ae<<4&4294967295|ae>>>28),ae=fe+(H^ee^de)+ue[0]+3936430074&4294967295,fe=H+(ae<<11&4294967295|ae>>>21),ae=de+(fe^H^ee)+ue[3]+3572445317&4294967295,de=fe+(ae<<16&4294967295|ae>>>16),ae=ee+(de^fe^H)+ue[6]+76029189&4294967295,ee=de+(ae<<23&4294967295|ae>>>9),ae=H+(ee^de^fe)+ue[9]+3654602809&4294967295,H=ee+(ae<<4&4294967295|ae>>>28),ae=fe+(H^ee^de)+ue[12]+3873151461&4294967295,fe=H+(ae<<11&4294967295|ae>>>21),ae=de+(fe^H^ee)+ue[15]+530742520&4294967295,de=fe+(ae<<16&4294967295|ae>>>16),ae=ee+(de^fe^H)+ue[2]+3299628645&4294967295,ee=de+(ae<<23&4294967295|ae>>>9),ae=H+(de^(ee|~fe))+ue[0]+4096336452&4294967295,H=ee+(ae<<6&4294967295|ae>>>26),ae=fe+(ee^(H|~de))+ue[7]+1126891415&4294967295,fe=H+(ae<<10&4294967295|ae>>>22),ae=de+(H^(fe|~ee))+ue[14]+2878612391&4294967295,de=fe+(ae<<15&4294967295|ae>>>17),ae=ee+(fe^(de|~H))+ue[5]+4237533241&4294967295,ee=de+(ae<<21&4294967295|ae>>>11),ae=H+(de^(ee|~fe))+ue[12]+1700485571&4294967295,H=ee+(ae<<6&4294967295|ae>>>26),ae=fe+(ee^(H|~de))+ue[3]+2399980690&4294967295,fe=H+(ae<<10&4294967295|ae>>>22),ae=de+(H^(fe|~ee))+ue[10]+4293915773&4294967295,de=fe+(ae<<15&4294967295|ae>>>17),ae=ee+(fe^(de|~H))+ue[1]+2240044497&4294967295,ee=de+(ae<<21&4294967295|ae>>>11),ae=H+(de^(ee|~fe))+ue[8]+1873313359&4294967295,H=ee+(ae<<6&4294967295|ae>>>26),ae=fe+(ee^(H|~de))+ue[15]+4264355552&4294967295,fe=H+(ae<<10&4294967295|ae>>>22),ae=de+(H^(fe|~ee))+ue[6]+2734768916&4294967295,de=fe+(ae<<15&4294967295|ae>>>17),ae=ee+(fe^(de|~H))+ue[13]+1309151649&4294967295,ee=de+(ae<<21&4294967295|ae>>>11),ae=H+(de^(ee|~fe))+ue[4]+4149444226&4294967295,H=ee+(ae<<6&4294967295|ae>>>26),ae=fe+(ee^(H|~de))+ue[11]+3174756917&4294967295,fe=H+(ae<<10&4294967295|ae>>>22),ae=de+(H^(fe|~ee))+ue[2]+718787259&4294967295,de=fe+(ae<<15&4294967295|ae>>>17),ae=ee+(fe^(de|~H))+ue[9]+3951481745&4294967295,W.g[0]=W.g[0]+H&4294967295,W.g[1]=W.g[1]+(de+(ae<<21&4294967295|ae>>>11))&4294967295,W.g[2]=W.g[2]+de&4294967295,W.g[3]=W.g[3]+fe&4294967295}n.prototype.u=function(W,H){H===void 0&&(H=W.length);for(var ee=H-this.blockSize,ue=this.B,de=this.h,fe=0;fe<H;){if(de==0)for(;fe<=ee;)s(this,W,fe),fe+=this.blockSize;if(typeof W=="string"){for(;fe<H;)if(ue[de++]=W.charCodeAt(fe++),de==this.blockSize){s(this,ue),de=0;break}}else for(;fe<H;)if(ue[de++]=W[fe++],de==this.blockSize){s(this,ue),de=0;break}}this.h=de,this.o+=H},n.prototype.v=function(){var W=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);W[0]=128;for(var H=1;H<W.length-8;++H)W[H]=0;var ee=8*this.o;for(H=W.length-8;H<W.length;++H)W[H]=ee&255,ee/=256;for(this.u(W),W=Array(16),H=ee=0;4>H;++H)for(var ue=0;32>ue;ue+=8)W[ee++]=this.g[H]>>>ue&255;return W};function a(W,H){var ee=l;return Object.prototype.hasOwnProperty.call(ee,W)?ee[W]:ee[W]=H(W)}function o(W,H){this.h=H;for(var ee=[],ue=!0,de=W.length-1;0<=de;de--){var fe=W[de]|0;ue&&fe==H||(ee[de]=fe,ue=!1)}this.g=ee}var l={};function u(W){return-128<=W&&128>W?a(W,function(H){return new o([H|0],0>H?-1:0)}):new o([W|0],0>W?-1:0)}function c(W){if(isNaN(W)||!isFinite(W))return p;if(0>W)return T(c(-W));for(var H=[],ee=1,ue=0;W>=ee;ue++)H[ue]=W/ee|0,ee*=4294967296;return new o(H,0)}function d(W,H){if(W.length==0)throw Error("number format error: empty string");if(H=H||10,2>H||36<H)throw Error("radix out of range: "+H);if(W.charAt(0)=="-")return T(d(W.substring(1),H));if(0<=W.indexOf("-"))throw Error('number format error: interior "-" character');for(var ee=c(Math.pow(H,8)),ue=p,de=0;de<W.length;de+=8){var fe=Math.min(8,W.length-de),ae=parseInt(W.substring(de,de+fe),H);8>fe?(fe=c(Math.pow(H,fe)),ue=ue.j(fe).add(c(ae))):(ue=ue.j(ee),ue=ue.add(c(ae)))}return ue}var p=u(0),m=u(1),y=u(16777216);t=o.prototype,t.m=function(){if(E(this))return-T(this).m();for(var W=0,H=1,ee=0;ee<this.g.length;ee++){var ue=this.i(ee);W+=(0<=ue?ue:4294967296+ue)*H,H*=4294967296}return W},t.toString=function(W){if(W=W||10,2>W||36<W)throw Error("radix out of range: "+W);if(b(this))return"0";if(E(this))return"-"+T(this).toString(W);for(var H=c(Math.pow(W,6)),ee=this,ue="";;){var de=I(ee,H).g;ee=S(ee,de.j(H));var fe=((0<ee.g.length?ee.g[0]:ee.h)>>>0).toString(W);if(ee=de,b(ee))return fe+ue;for(;6>fe.length;)fe="0"+fe;ue=fe+ue}},t.i=function(W){return 0>W?0:W<this.g.length?this.g[W]:this.h};function b(W){if(W.h!=0)return!1;for(var H=0;H<W.g.length;H++)if(W.g[H]!=0)return!1;return!0}function E(W){return W.h==-1}t.l=function(W){return W=S(this,W),E(W)?-1:b(W)?0:1};function T(W){for(var H=W.g.length,ee=[],ue=0;ue<H;ue++)ee[ue]=~W.g[ue];return new o(ee,~W.h).add(m)}t.abs=function(){return E(this)?T(this):this},t.add=function(W){for(var H=Math.max(this.g.length,W.g.length),ee=[],ue=0,de=0;de<=H;de++){var fe=ue+(this.i(de)&65535)+(W.i(de)&65535),ae=(fe>>>16)+(this.i(de)>>>16)+(W.i(de)>>>16);ue=ae>>>16,fe&=65535,ae&=65535,ee[de]=ae<<16|fe}return new o(ee,ee[ee.length-1]&-2147483648?-1:0)};function S(W,H){return W.add(T(H))}t.j=function(W){if(b(this)||b(W))return p;if(E(this))return E(W)?T(this).j(T(W)):T(T(this).j(W));if(E(W))return T(this.j(T(W)));if(0>this.l(y)&&0>W.l(y))return c(this.m()*W.m());for(var H=this.g.length+W.g.length,ee=[],ue=0;ue<2*H;ue++)ee[ue]=0;for(ue=0;ue<this.g.length;ue++)for(var de=0;de<W.g.length;de++){var fe=this.i(ue)>>>16,ae=this.i(ue)&65535,ce=W.i(de)>>>16,me=W.i(de)&65535;ee[2*ue+2*de]+=ae*me,P(ee,2*ue+2*de),ee[2*ue+2*de+1]+=fe*me,P(ee,2*ue+2*de+1),ee[2*ue+2*de+1]+=ae*ce,P(ee,2*ue+2*de+1),ee[2*ue+2*de+2]+=fe*ce,P(ee,2*ue+2*de+2)}for(ue=0;ue<H;ue++)ee[ue]=ee[2*ue+1]<<16|ee[2*ue];for(ue=H;ue<2*H;ue++)ee[ue]=0;return new o(ee,0)};function P(W,H){for(;(W[H]&65535)!=W[H];)W[H+1]+=W[H]>>>16,W[H]&=65535,H++}function A(W,H){this.g=W,this.h=H}function I(W,H){if(b(H))throw Error("division by zero");if(b(W))return new A(p,p);if(E(W))return H=I(T(W),H),new A(T(H.g),T(H.h));if(E(H))return H=I(W,T(H)),new A(T(H.g),H.h);if(30<W.g.length){if(E(W)||E(H))throw Error("slowDivide_ only works with positive integers.");for(var ee=m,ue=H;0>=ue.l(W);)ee=j(ee),ue=j(ue);var de=K(ee,1),fe=K(ue,1);for(ue=K(ue,2),ee=K(ee,2);!b(ue);){var ae=fe.add(ue);0>=ae.l(W)&&(de=de.add(ee),fe=ae),ue=K(ue,1),ee=K(ee,1)}return H=S(W,de.j(H)),new A(de,H)}for(de=p;0<=W.l(H);){for(ee=Math.max(1,Math.floor(W.m()/H.m())),ue=Math.ceil(Math.log(ee)/Math.LN2),ue=48>=ue?1:Math.pow(2,ue-48),fe=c(ee),ae=fe.j(H);E(ae)||0<ae.l(W);)ee-=ue,fe=c(ee),ae=fe.j(H);b(fe)&&(fe=m),de=de.add(fe),W=S(W,ae)}return new A(de,W)}t.A=function(W){return I(this,W).h},t.and=function(W){for(var H=Math.max(this.g.length,W.g.length),ee=[],ue=0;ue<H;ue++)ee[ue]=this.i(ue)&W.i(ue);return new o(ee,this.h&W.h)},t.or=function(W){for(var H=Math.max(this.g.length,W.g.length),ee=[],ue=0;ue<H;ue++)ee[ue]=this.i(ue)|W.i(ue);return new o(ee,this.h|W.h)},t.xor=function(W){for(var H=Math.max(this.g.length,W.g.length),ee=[],ue=0;ue<H;ue++)ee[ue]=this.i(ue)^W.i(ue);return new o(ee,this.h^W.h)};function j(W){for(var H=W.g.length+1,ee=[],ue=0;ue<H;ue++)ee[ue]=W.i(ue)<<1|W.i(ue-1)>>>31;return new o(ee,W.h)}function K(W,H){var ee=H>>5;H%=32;for(var ue=W.g.length-ee,de=[],fe=0;fe<ue;fe++)de[fe]=0<H?W.i(fe+ee)>>>H|W.i(fe+ee+1)<<32-H:W.i(fe+ee);return new o(de,W.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Md5=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,Integer=o}).apply(typeof commonjsGlobal$1<"u"?commonjsGlobal$1:typeof self<"u"?self:typeof window<"u"?window:{});var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var XhrIo,WebChannel,EventType,ErrorCode,Stat,Event$1,getStatEventTarget,createWebChannelTransport;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(D,ne,pe){return D==Array.prototype||D==Object.prototype||(D[ne]=pe.value),D};function r(D){D=[typeof globalThis=="object"&&globalThis,D,typeof window=="object"&&window,typeof self=="object"&&self,typeof commonjsGlobal=="object"&&commonjsGlobal];for(var ne=0;ne<D.length;++ne){var pe=D[ne];if(pe&&pe.Math==Math)return pe}throw Error("Cannot find global object")}var n=r(this);function s(D,ne){if(ne)e:{var pe=n;D=D.split(".");for(var _e=0;_e<D.length-1;_e++){var $e=D[_e];if(!($e in pe))break e;pe=pe[$e]}D=D[D.length-1],_e=pe[D],ne=ne(_e),ne!=_e&&ne!=null&&e(pe,D,{configurable:!0,writable:!0,value:ne})}}function a(D,ne){D instanceof String&&(D+="");var pe=0,_e=!1,$e={next:function(){if(!_e&&pe<D.length){var He=pe++;return{value:ne(He,D[He]),done:!1}}return _e=!0,{done:!0,value:void 0}}};return $e[Symbol.iterator]=function(){return $e},$e}s("Array.prototype.values",function(D){return D||function(){return a(this,function(ne,pe){return pe})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(D){var ne=typeof D;return ne=ne!="object"?ne:D?Array.isArray(D)?"array":ne:"null",ne=="array"||ne=="object"&&typeof D.length=="number"}function c(D){var ne=typeof D;return ne=="object"&&D!=null||ne=="function"}function d(D,ne,pe){return D.call.apply(D.bind,arguments)}function p(D,ne,pe){if(!D)throw Error();if(2<arguments.length){var _e=Array.prototype.slice.call(arguments,2);return function(){var $e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply($e,_e),D.apply(ne,$e)}}return function(){return D.apply(ne,arguments)}}function m(D,ne,pe){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:p,m.apply(null,arguments)}function y(D,ne){var pe=Array.prototype.slice.call(arguments,1);return function(){var _e=pe.slice();return _e.push.apply(_e,arguments),D.apply(this,_e)}}function b(D,ne){function pe(){}pe.prototype=ne.prototype,D.aa=ne.prototype,D.prototype=new pe,D.prototype.constructor=D,D.Qb=function(_e,$e,He){for(var Nt=Array(arguments.length-2),vn=2;vn<arguments.length;vn++)Nt[vn-2]=arguments[vn];return ne.prototype[$e].apply(_e,Nt)}}function E(D){const ne=D.length;if(0<ne){const pe=Array(ne);for(let _e=0;_e<ne;_e++)pe[_e]=D[_e];return pe}return[]}function T(D,ne){for(let pe=1;pe<arguments.length;pe++){const _e=arguments[pe];if(u(_e)){const $e=D.length||0,He=_e.length||0;D.length=$e+He;for(let Nt=0;Nt<He;Nt++)D[$e+Nt]=_e[Nt]}else D.push(_e)}}class S{constructor(ne,pe){this.i=ne,this.j=pe,this.h=0,this.g=null}get(){let ne;return 0<this.h?(this.h--,ne=this.g,this.g=ne.next,ne.next=null):ne=this.i(),ne}}function P(D){return/^[\s\xa0]*$/.test(D)}function A(){var D=l.navigator;return D&&(D=D.userAgent)?D:""}function I(D){return I[" "](D),D}I[" "]=function(){};var j=A().indexOf("Gecko")!=-1&&!(A().toLowerCase().indexOf("webkit")!=-1&&A().indexOf("Edge")==-1)&&!(A().indexOf("Trident")!=-1||A().indexOf("MSIE")!=-1)&&A().indexOf("Edge")==-1;function K(D,ne,pe){for(const _e in D)ne.call(pe,D[_e],_e,D)}function W(D,ne){for(const pe in D)ne.call(void 0,D[pe],pe,D)}function H(D){const ne={};for(const pe in D)ne[pe]=D[pe];return ne}const ee="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ue(D,ne){let pe,_e;for(let $e=1;$e<arguments.length;$e++){_e=arguments[$e];for(pe in _e)D[pe]=_e[pe];for(let He=0;He<ee.length;He++)pe=ee[He],Object.prototype.hasOwnProperty.call(_e,pe)&&(D[pe]=_e[pe])}}function de(D){var ne=1;D=D.split(":");const pe=[];for(;0<ne&&D.length;)pe.push(D.shift()),ne--;return D.length&&pe.push(D.join(":")),pe}function fe(D){l.setTimeout(()=>{throw D},0)}function ae(){var D=Y;let ne=null;return D.g&&(ne=D.g,D.g=D.g.next,D.g||(D.h=null),ne.next=null),ne}class ce{constructor(){this.h=this.g=null}add(ne,pe){const _e=me.get();_e.set(ne,pe),this.h?this.h.next=_e:this.g=_e,this.h=_e}}var me=new S(()=>new te,D=>D.reset());class te{constructor(){this.next=this.g=this.h=null}set(ne,pe){this.h=ne,this.g=pe,this.next=null}reset(){this.next=this.g=this.h=null}}let le,Z=!1,Y=new ce,he=()=>{const D=l.Promise.resolve(void 0);le=()=>{D.then(oe)}};var oe=()=>{for(var D;D=ae();){try{D.h.call(D.g)}catch(pe){fe(pe)}var ne=me;ne.j(D),100>ne.h&&(ne.h++,D.next=ne.g,ne.g=D)}Z=!1};function ye(){this.s=this.s,this.C=this.C}ye.prototype.s=!1,ye.prototype.ma=function(){this.s||(this.s=!0,this.N())},ye.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ee(D,ne){this.type=D,this.g=this.target=ne,this.defaultPrevented=!1}Ee.prototype.h=function(){this.defaultPrevented=!0};var Ae=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var D=!1,ne=Object.defineProperty({},"passive",{get:function(){D=!0}});try{const pe=()=>{};l.addEventListener("test",pe,ne),l.removeEventListener("test",pe,ne)}catch{}return D}();function je(D,ne){if(Ee.call(this,D?D.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,D){var pe=this.type=D.type,_e=D.changedTouches&&D.changedTouches.length?D.changedTouches[0]:null;if(this.target=D.target||D.srcElement,this.g=ne,ne=D.relatedTarget){if(j){e:{try{I(ne.nodeName);var $e=!0;break e}catch{}$e=!1}$e||(ne=null)}}else pe=="mouseover"?ne=D.fromElement:pe=="mouseout"&&(ne=D.toElement);this.relatedTarget=ne,_e?(this.clientX=_e.clientX!==void 0?_e.clientX:_e.pageX,this.clientY=_e.clientY!==void 0?_e.clientY:_e.pageY,this.screenX=_e.screenX||0,this.screenY=_e.screenY||0):(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0),this.button=D.button,this.key=D.key||"",this.ctrlKey=D.ctrlKey,this.altKey=D.altKey,this.shiftKey=D.shiftKey,this.metaKey=D.metaKey,this.pointerId=D.pointerId||0,this.pointerType=typeof D.pointerType=="string"?D.pointerType:Te[D.pointerType]||"",this.state=D.state,this.i=D,D.defaultPrevented&&je.aa.h.call(this)}}b(je,Ee);var Te={2:"touch",3:"pen",4:"mouse"};je.prototype.h=function(){je.aa.h.call(this);var D=this.i;D.preventDefault?D.preventDefault():D.returnValue=!1};var Ve="closure_listenable_"+(1e6*Math.random()|0),Pe=0;function Ce(D,ne,pe,_e,$e){this.listener=D,this.proxy=null,this.src=ne,this.type=pe,this.capture=!!_e,this.ha=$e,this.key=++Pe,this.da=this.fa=!1}function De(D){D.da=!0,D.listener=null,D.proxy=null,D.src=null,D.ha=null}function ze(D){this.src=D,this.g={},this.h=0}ze.prototype.add=function(D,ne,pe,_e,$e){var He=D.toString();D=this.g[He],D||(D=this.g[He]=[],this.h++);var Nt=Ze(D,ne,_e,$e);return-1<Nt?(ne=D[Nt],pe||(ne.fa=!1)):(ne=new Ce(ne,this.src,He,!!_e,$e),ne.fa=pe,D.push(ne)),ne};function Et(D,ne){var pe=ne.type;if(pe in D.g){var _e=D.g[pe],$e=Array.prototype.indexOf.call(_e,ne,void 0),He;(He=0<=$e)&&Array.prototype.splice.call(_e,$e,1),He&&(De(ne),D.g[pe].length==0&&(delete D.g[pe],D.h--))}}function Ze(D,ne,pe,_e){for(var $e=0;$e<D.length;++$e){var He=D[$e];if(!He.da&&He.listener==ne&&He.capture==!!pe&&He.ha==_e)return $e}return-1}var Ue="closure_lm_"+(1e6*Math.random()|0),qt={};function or(D,ne,pe,_e,$e){if(Array.isArray(ne)){for(var He=0;He<ne.length;He++)or(D,ne[He],pe,_e,$e);return null}return pe=zr(pe),D&&D[Ve]?D.K(ne,pe,c(_e)?!!_e.capture:!1,$e):Lt(D,ne,pe,!1,_e,$e)}function Lt(D,ne,pe,_e,$e,He){if(!ne)throw Error("Invalid event type");var Nt=c($e)?!!$e.capture:!!$e,vn=br(D);if(vn||(D[Ue]=vn=new ze(D)),pe=vn.add(ne,pe,_e,Nt,He),pe.proxy)return pe;if(_e=rt(),pe.proxy=_e,_e.src=D,_e.listener=pe,D.addEventListener)Ae||($e=Nt),$e===void 0&&($e=!1),D.addEventListener(ne.toString(),_e,$e);else if(D.attachEvent)D.attachEvent(er(ne.toString()),_e);else if(D.addListener&&D.removeListener)D.addListener(_e);else throw Error("addEventListener and attachEvent are unavailable.");return pe}function rt(){function D(pe){return ne.call(D.src,D.listener,pe)}const ne=xr;return D}function lr(D,ne,pe,_e,$e){if(Array.isArray(ne))for(var He=0;He<ne.length;He++)lr(D,ne[He],pe,_e,$e);else _e=c(_e)?!!_e.capture:!!_e,pe=zr(pe),D&&D[Ve]?(D=D.i,ne=String(ne).toString(),ne in D.g&&(He=D.g[ne],pe=Ze(He,pe,_e,$e),-1<pe&&(De(He[pe]),Array.prototype.splice.call(He,pe,1),He.length==0&&(delete D.g[ne],D.h--)))):D&&(D=br(D))&&(ne=D.g[ne.toString()],D=-1,ne&&(D=Ze(ne,pe,_e,$e)),(pe=-1<D?ne[D]:null)&&ir(pe))}function ir(D){if(typeof D!="number"&&D&&!D.da){var ne=D.src;if(ne&&ne[Ve])Et(ne.i,D);else{var pe=D.type,_e=D.proxy;ne.removeEventListener?ne.removeEventListener(pe,_e,D.capture):ne.detachEvent?ne.detachEvent(er(pe),_e):ne.addListener&&ne.removeListener&&ne.removeListener(_e),(pe=br(ne))?(Et(pe,D),pe.h==0&&(pe.src=null,ne[Ue]=null)):De(D)}}}function er(D){return D in qt?qt[D]:qt[D]="on"+D}function xr(D,ne){if(D.da)D=!0;else{ne=new je(ne,this);var pe=D.listener,_e=D.ha||D.src;D.fa&&ir(D),D=pe.call(_e,ne)}return D}function br(D){return D=D[Ue],D instanceof ze?D:null}var Pr="__closure_events_fn_"+(1e9*Math.random()>>>0);function zr(D){return typeof D=="function"?D:(D[Pr]||(D[Pr]=function(ne){return D.handleEvent(ne)}),D[Pr])}function pr(){ye.call(this),this.i=new ze(this),this.M=this,this.F=null}b(pr,ye),pr.prototype[Ve]=!0,pr.prototype.removeEventListener=function(D,ne,pe,_e){lr(this,D,ne,pe,_e)};function dr(D,ne){var pe,_e=D.F;if(_e)for(pe=[];_e;_e=_e.F)pe.push(_e);if(D=D.M,_e=ne.type||ne,typeof ne=="string")ne=new Ee(ne,D);else if(ne instanceof Ee)ne.target=ne.target||D;else{var $e=ne;ne=new Ee(_e,D),ue(ne,$e)}if($e=!0,pe)for(var He=pe.length-1;0<=He;He--){var Nt=ne.g=pe[He];$e=Ar(Nt,_e,!0,ne)&&$e}if(Nt=ne.g=D,$e=Ar(Nt,_e,!0,ne)&&$e,$e=Ar(Nt,_e,!1,ne)&&$e,pe)for(He=0;He<pe.length;He++)Nt=ne.g=pe[He],$e=Ar(Nt,_e,!1,ne)&&$e}pr.prototype.N=function(){if(pr.aa.N.call(this),this.i){var D=this.i,ne;for(ne in D.g){for(var pe=D.g[ne],_e=0;_e<pe.length;_e++)De(pe[_e]);delete D.g[ne],D.h--}}this.F=null},pr.prototype.K=function(D,ne,pe,_e){return this.i.add(String(D),ne,!1,pe,_e)},pr.prototype.L=function(D,ne,pe,_e){return this.i.add(String(D),ne,!0,pe,_e)};function Ar(D,ne,pe,_e){if(ne=D.i.g[String(ne)],!ne)return!0;ne=ne.concat();for(var $e=!0,He=0;He<ne.length;++He){var Nt=ne[He];if(Nt&&!Nt.da&&Nt.capture==pe){var vn=Nt.listener,cs=Nt.ha||Nt.src;Nt.fa&&Et(D.i,Nt),$e=vn.call(cs,_e)!==!1&&$e}}return $e&&!_e.defaultPrevented}function _r(D,ne,pe){if(typeof D=="function")pe&&(D=m(D,pe));else if(D&&typeof D.handleEvent=="function")D=m(D.handleEvent,D);else throw Error("Invalid listener argument");return 2147483647<Number(ne)?-1:l.setTimeout(D,ne||0)}function It(D){D.g=_r(()=>{D.g=null,D.i&&(D.i=!1,It(D))},D.l);const ne=D.h;D.h=null,D.m.apply(null,ne)}class Bt extends ye{constructor(ne,pe){super(),this.m=ne,this.l=pe,this.h=null,this.i=!1,this.g=null}j(ne){this.h=arguments,this.g?this.i=!0:It(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ur(D){ye.call(this),this.h=D,this.g={}}b(ur,ye);var Vn=[];function gn(D){K(D.g,function(ne,pe){this.g.hasOwnProperty(pe)&&ir(ne)},D),D.g={}}ur.prototype.N=function(){ur.aa.N.call(this),gn(this)},ur.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var yn=l.JSON.stringify,Dr=l.JSON.parse,Nr=class{stringify(D){return l.JSON.stringify(D,void 0)}parse(D){return l.JSON.parse(D,void 0)}};function wn(){}wn.prototype.h=null;function jn(D){return D.h||(D.h=D.i())}function $r(){}var Cr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ir(){Ee.call(this,"d")}b(Ir,Ee);function kr(){Ee.call(this,"c")}b(kr,Ee);var Er={},Nn=null;function Hr(){return Nn=Nn||new pr}Er.La="serverreachability";function qr(D){Ee.call(this,Er.La,D)}b(qr,Ee);function Fr(D){const ne=Hr();dr(ne,new qr(ne))}Er.STAT_EVENT="statevent";function Dn(D,ne){Ee.call(this,Er.STAT_EVENT,D),this.stat=ne}b(Dn,Ee);function yr(D){const ne=Hr();dr(ne,new Dn(ne,D))}Er.Ma="timingevent";function Wr(D,ne){Ee.call(this,Er.Ma,D),this.size=ne}b(Wr,Ee);function vr(D,ne){if(typeof D!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){D()},ne)}function jr(){this.g=!0}jr.prototype.xa=function(){this.g=!1};function Qr(D,ne,pe,_e,$e,He){D.info(function(){if(D.g)if(He)for(var Nt="",vn=He.split("&"),cs=0;cs<vn.length;cs++){var Yr=vn[cs].split("=");if(1<Yr.length){var bn=Yr[0];Yr=Yr[1];var Kn=bn.split("_");Nt=2<=Kn.length&&Kn[1]=="type"?Nt+(bn+"="+Yr+"&"):Nt+(bn+"=redacted&")}}else Nt=null;else Nt=He;return"XMLHTTP REQ ("+_e+") [attempt "+$e+"]: "+ne+`
`+pe+`
`+Nt})}function xn(D,ne,pe,_e,$e,He,Nt){D.info(function(){return"XMLHTTP RESP ("+_e+") [ attempt "+$e+"]: "+ne+`
`+pe+`
`+He+" "+Nt})}function Lr(D,ne,pe,_e){D.info(function(){return"XMLHTTP TEXT ("+ne+"): "+Hs(D,pe)+(_e?" "+_e:"")})}function _s(D,ne){D.info(function(){return"TIMEOUT: "+ne})}jr.prototype.info=function(){};function Hs(D,ne){if(!D.g)return ne;if(!ne)return null;try{var pe=JSON.parse(ne);if(pe){for(D=0;D<pe.length;D++)if(Array.isArray(pe[D])){var _e=pe[D];if(!(2>_e.length)){var $e=_e[1];if(Array.isArray($e)&&!(1>$e.length)){var He=$e[0];if(He!="noop"&&He!="stop"&&He!="close")for(var Nt=1;Nt<$e.length;Nt++)$e[Nt]=""}}}}return yn(pe)}catch{return ne}}var Bn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Hn={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Tn;function Mn(){}b(Mn,wn),Mn.prototype.g=function(){return new XMLHttpRequest},Mn.prototype.i=function(){return{}},Tn=new Mn;function os(D,ne,pe,_e){this.j=D,this.i=ne,this.l=pe,this.R=_e||1,this.U=new ur(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new es}function es(){this.i=null,this.g="",this.h=!1}var ci={},ti={};function Se(D,ne,pe){D.L=1,D.v=Xi(qs(ne)),D.m=pe,D.P=!0,We(D,null)}function We(D,ne){D.F=Date.now(),Xe(D),D.A=qs(D.v);var pe=D.A,_e=D.R;Array.isArray(_e)||(_e=[String(_e)]),ga(pe.i,"t",_e),D.C=0,pe=D.j.J,D.h=new es,D.g=Pu(D.j,pe?ne:null,!D.m),0<D.O&&(D.M=new Bt(m(D.Y,D,D.g),D.O)),ne=D.U,pe=D.g,_e=D.ca;var $e="readystatechange";Array.isArray($e)||($e&&(Vn[0]=$e.toString()),$e=Vn);for(var He=0;He<$e.length;He++){var Nt=or(pe,$e[He],_e||ne.handleEvent,!1,ne.h||ne);if(!Nt)break;ne.g[Nt.key]=Nt}ne=D.H?H(D.H):{},D.m?(D.u||(D.u="POST"),ne["Content-Type"]="application/x-www-form-urlencoded",D.g.ea(D.A,D.u,D.m,ne)):(D.u="GET",D.g.ea(D.A,D.u,null,ne)),Fr(),Qr(D.i,D.u,D.A,D.l,D.R,D.m)}os.prototype.ca=function(D){D=D.target;const ne=this.M;ne&&ts(D)==3?ne.j():this.Y(D)},os.prototype.Y=function(D){try{if(D==this.g)e:{const Kn=ts(this.g);var ne=this.g.Ba();const Cs=this.g.Z();if(!(3>Kn)&&(Kn!=3||this.g&&(this.h.h||this.g.oa()||Ko(this.g)))){this.J||Kn!=4||ne==7||(ne==8||0>=Cs?Fr(3):Fr(2)),kt(this);var pe=this.g.Z();this.X=pe;t:if(et(this)){var _e=Ko(this.g);D="";var $e=_e.length,He=ts(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){cr(this),Wt(this);var Nt="";break t}this.h.i=new l.TextDecoder}for(ne=0;ne<$e;ne++)this.h.h=!0,D+=this.h.i.decode(_e[ne],{stream:!(He&&ne==$e-1)});_e.length=0,this.h.g+=D,this.C=0,Nt=this.h.g}else Nt=this.g.oa();if(this.o=pe==200,xn(this.i,this.u,this.A,this.l,this.R,Kn,pe),this.o){if(this.T&&!this.K){t:{if(this.g){var vn,cs=this.g;if((vn=cs.g?cs.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(vn)){var Yr=vn;break t}}Yr=null}if(pe=Yr)Lr(this.i,this.l,pe,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,nr(this,pe);else{this.o=!1,this.s=3,yr(12),cr(this),Wt(this);break e}}if(this.P){pe=!0;let Ws;for(;!this.J&&this.C<Nt.length;)if(Ws=Ye(this,Nt),Ws==ti){Kn==4&&(this.s=4,yr(14),pe=!1),Lr(this.i,this.l,null,"[Incomplete Response]");break}else if(Ws==ci){this.s=4,yr(15),Lr(this.i,this.l,Nt,"[Invalid Chunk]"),pe=!1;break}else Lr(this.i,this.l,Ws,null),nr(this,Ws);if(et(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Kn!=4||Nt.length!=0||this.h.h||(this.s=1,yr(16),pe=!1),this.o=this.o&&pe,!pe)Lr(this.i,this.l,Nt,"[Invalid Chunked Response]"),cr(this),Wt(this);else if(0<Nt.length&&!this.W){this.W=!0;var bn=this.j;bn.g==this&&bn.ba&&!bn.M&&(bn.j.info("Great, no buffering proxy detected. Bytes received: "+Nt.length),hi(bn),bn.M=!0,yr(11))}}else Lr(this.i,this.l,Nt,null),nr(this,Nt);Kn==4&&cr(this),this.o&&!this.J&&(Kn==4?Pn(this.j,this):(this.o=!1,Xe(this)))}else za(this.g),pe==400&&0<Nt.indexOf("Unknown SID")?(this.s=3,yr(12)):(this.s=0,yr(13)),cr(this),Wt(this)}}}catch{}finally{}};function et(D){return D.g?D.u=="GET"&&D.L!=2&&D.j.Ca:!1}function Ye(D,ne){var pe=D.C,_e=ne.indexOf(`
`,pe);return _e==-1?ti:(pe=Number(ne.substring(pe,_e)),isNaN(pe)?ci:(_e+=1,_e+pe>ne.length?ti:(ne=ne.slice(_e,_e+pe),D.C=_e+pe,ne)))}os.prototype.cancel=function(){this.J=!0,cr(this)};function Xe(D){D.S=Date.now()+D.I,qe(D,D.I)}function qe(D,ne){if(D.B!=null)throw Error("WatchDog timer not null");D.B=vr(m(D.ba,D),ne)}function kt(D){D.B&&(l.clearTimeout(D.B),D.B=null)}os.prototype.ba=function(){this.B=null;const D=Date.now();0<=D-this.S?(_s(this.i,this.A),this.L!=2&&(Fr(),yr(17)),cr(this),this.s=2,Wt(this)):qe(this,this.S-D)};function Wt(D){D.j.G==0||D.J||Pn(D.j,D)}function cr(D){kt(D);var ne=D.M;ne&&typeof ne.ma=="function"&&ne.ma(),D.M=null,gn(D.U),D.g&&(ne=D.g,D.g=null,ne.abort(),ne.ma())}function nr(D,ne){try{var pe=D.j;if(pe.G!=0&&(pe.g==D||ls(pe.h,D))){if(!D.K&&ls(pe.h,D)&&pe.G==3){try{var _e=pe.Da.g.parse(ne)}catch{_e=null}if(Array.isArray(_e)&&_e.length==3){var $e=_e;if($e[0]==0){e:if(!pe.u){if(pe.g)if(pe.g.F+3e3<D.F)Ha(pe),fi(pe);else break e;_o(pe),yr(18)}}else pe.za=$e[1],0<pe.za-pe.T&&37500>$e[2]&&pe.F&&pe.v==0&&!pe.C&&(pe.C=vr(m(pe.Za,pe),6e3));if(1>=Sn(pe.h)&&pe.ca){try{pe.ca()}catch{}pe.ca=void 0}}else ji(pe,11)}else if((D.K||pe.g==D)&&Ha(pe),!P(ne))for($e=pe.Da.g.parse(ne),ne=0;ne<$e.length;ne++){let Yr=$e[ne];if(pe.T=Yr[0],Yr=Yr[1],pe.G==2)if(Yr[0]=="c"){pe.K=Yr[1],pe.ia=Yr[2];const bn=Yr[3];bn!=null&&(pe.la=bn,pe.j.info("VER="+pe.la));const Kn=Yr[4];Kn!=null&&(pe.Aa=Kn,pe.j.info("SVER="+pe.Aa));const Cs=Yr[5];Cs!=null&&typeof Cs=="number"&&0<Cs&&(_e=1.5*Cs,pe.L=_e,pe.j.info("backChannelRequestTimeoutMs_="+_e)),_e=pe;const Ws=D.g;if(Ws){const qa=Ws.g?Ws.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(qa){var He=_e.h;He.g||qa.indexOf("spdy")==-1&&qa.indexOf("quic")==-1&&qa.indexOf("h2")==-1||(He.j=He.l,He.g=new Set,He.h&&(Fa(He,He.h),He.h=null))}if(_e.D){const Jo=Ws.g?Ws.g.getResponseHeader("X-HTTP-Session-Id"):null;Jo&&(_e.ya=Jo,Cn(_e.I,_e.D,Jo))}}pe.G=3,pe.l&&pe.l.ua(),pe.ba&&(pe.R=Date.now()-D.F,pe.j.info("Handshake RTT: "+pe.R+"ms")),_e=pe;var Nt=D;if(_e.qa=Xo(_e,_e.J?_e.ia:null,_e.W),Nt.K){ho(_e.h,Nt);var vn=Nt,cs=_e.L;cs&&(vn.I=cs),vn.B&&(kt(vn),Xe(vn)),_e.g=Nt}else xo(_e);0<pe.i.length&&Ni(pe)}else Yr[0]!="stop"&&Yr[0]!="close"||ji(pe,7);else pe.G==3&&(Yr[0]=="stop"||Yr[0]=="close"?Yr[0]=="stop"?ji(pe,7):ms(pe):Yr[0]!="noop"&&pe.l&&pe.l.ta(Yr),pe.v=0)}}Fr(4)}catch{}}var Kr=class{constructor(D,ne){this.g=D,this.map=ne}};function un(D){this.l=D||10,l.PerformanceNavigationTiming?(D=l.performance.getEntriesByType("navigation"),D=0<D.length&&(D[0].nextHopProtocol=="hq"||D[0].nextHopProtocol=="h2")):D=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=D?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function An(D){return D.h?!0:D.g?D.g.size>=D.j:!1}function Sn(D){return D.h?1:D.g?D.g.size:0}function ls(D,ne){return D.h?D.h==ne:D.g?D.g.has(ne):!1}function Fa(D,ne){D.g?D.g.add(ne):D.h=ne}function ho(D,ne){D.h&&D.h==ne?D.h=null:D.g&&D.g.has(ne)&&D.g.delete(ne)}un.prototype.cancel=function(){if(this.i=Fs(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const D of this.g.values())D.cancel();this.g.clear()}};function Fs(D){if(D.h!=null)return D.i.concat(D.h.D);if(D.g!=null&&D.g.size!==0){let ne=D.i;for(const pe of D.g.values())ne=ne.concat(pe.D);return ne}return E(D.i)}function Wi(D){if(D.V&&typeof D.V=="function")return D.V();if(typeof Map<"u"&&D instanceof Map||typeof Set<"u"&&D instanceof Set)return Array.from(D.values());if(typeof D=="string")return D.split("");if(u(D)){for(var ne=[],pe=D.length,_e=0;_e<pe;_e++)ne.push(D[_e]);return ne}ne=[],pe=0;for(_e in D)ne[pe++]=D[_e];return ne}function La(D){if(D.na&&typeof D.na=="function")return D.na();if(!D.V||typeof D.V!="function"){if(typeof Map<"u"&&D instanceof Map)return Array.from(D.keys());if(!(typeof Set<"u"&&D instanceof Set)){if(u(D)||typeof D=="string"){var ne=[];D=D.length;for(var pe=0;pe<D;pe++)ne.push(pe);return ne}ne=[],pe=0;for(const _e in D)ne[pe++]=_e;return ne}}}function pa(D,ne){if(D.forEach&&typeof D.forEach=="function")D.forEach(ne,void 0);else if(u(D)||typeof D=="string")Array.prototype.forEach.call(D,ne,void 0);else for(var pe=La(D),_e=Wi(D),$e=_e.length,He=0;He<$e;He++)ne.call(void 0,_e[He],pe&&pe[He],D)}var Ki=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function xu(D,ne){if(D){D=D.split("&");for(var pe=0;pe<D.length;pe++){var _e=D[pe].indexOf("="),$e=null;if(0<=_e){var He=D[pe].substring(0,_e);$e=D[pe].substring(_e+1)}else He=D[pe];ne(He,$e?decodeURIComponent($e.replace(/\+/g," ")):"")}}}function ma(D){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,D instanceof ma){this.h=D.h,Va(this,D.j),this.o=D.o,this.g=D.g,Zi(this,D.s),this.l=D.l;var ne=D.i,pe=new Ci;pe.i=ne.i,ne.g&&(pe.g=new Map(ne.g),pe.h=ne.h),Ba(this,pe),this.m=D.m}else D&&(ne=String(D).match(Ki))?(this.h=!1,Va(this,ne[1]||"",!0),this.o=Gr(ne[2]||""),this.g=Gr(ne[3]||"",!0),Zi(this,ne[4]),this.l=Gr(ne[5]||"",!0),Ba(this,ne[6]||"",!0),this.m=Gr(ne[7]||"")):(this.h=!1,this.i=new Ci(null,this.h))}ma.prototype.toString=function(){var D=[],ne=this.j;ne&&D.push(ri(ne,po,!0),":");var pe=this.g;return(pe||ne=="file")&&(D.push("//"),(ne=this.o)&&D.push(ri(ne,po,!0),"@"),D.push(encodeURIComponent(String(pe)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),pe=this.s,pe!=null&&D.push(":",String(pe))),(pe=this.l)&&(this.g&&pe.charAt(0)!="/"&&D.push("/"),D.push(ri(pe,pe.charAt(0)=="/"?Il:_u,!0))),(pe=this.i.toString())&&D.push("?",pe),(pe=this.m)&&D.push("#",ri(pe,Wo)),D.join("")};function qs(D){return new ma(D)}function Va(D,ne,pe){D.j=pe?Gr(ne,!0):ne,D.j&&(D.j=D.j.replace(/:$/,""))}function Zi(D,ne){if(ne){if(ne=Number(ne),isNaN(ne)||0>ne)throw Error("Bad port number "+ne);D.s=ne}else D.s=null}function Ba(D,ne,pe){ne instanceof Ci?(D.i=ne,Yi(D.i,D.h)):(pe||(ne=ri(ne,kl)),D.i=new Ci(ne,D.h))}function Cn(D,ne,pe){D.i.set(ne,pe)}function Xi(D){return Cn(D,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),D}function Gr(D,ne){return D?ne?decodeURI(D.replace(/%25/g,"%2525")):decodeURIComponent(D):""}function ri(D,ne,pe){return typeof D=="string"?(D=encodeURI(D).replace(ne,Cl),pe&&(D=D.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),D):null}function Cl(D){return D=D.charCodeAt(0),"%"+(D>>4&15).toString(16)+(D&15).toString(16)}var po=/[#\/\?@]/g,_u=/[#\?:]/g,Il=/[#\?]/g,kl=/[#\?@]/g,Wo=/#/g;function Ci(D,ne){this.h=this.g=null,this.i=D||null,this.j=!!ne}function bs(D){D.g||(D.g=new Map,D.h=0,D.i&&xu(D.i,function(ne,pe){D.add(decodeURIComponent(ne.replace(/\+/g," ")),pe)}))}t=Ci.prototype,t.add=function(D,ne){bs(this),this.i=null,D=di(this,D);var pe=this.g.get(D);return pe||this.g.set(D,pe=[]),pe.push(ne),this.h+=1,this};function Ii(D,ne){bs(D),ne=di(D,ne),D.g.has(ne)&&(D.i=null,D.h-=D.g.get(ne).length,D.g.delete(ne))}function ki(D,ne){return bs(D),ne=di(D,ne),D.g.has(ne)}t.forEach=function(D,ne){bs(this),this.g.forEach(function(pe,_e){pe.forEach(function($e){D.call(ne,$e,_e,this)},this)},this)},t.na=function(){bs(this);const D=Array.from(this.g.values()),ne=Array.from(this.g.keys()),pe=[];for(let _e=0;_e<ne.length;_e++){const $e=D[_e];for(let He=0;He<$e.length;He++)pe.push(ne[_e])}return pe},t.V=function(D){bs(this);let ne=[];if(typeof D=="string")ki(this,D)&&(ne=ne.concat(this.g.get(di(this,D))));else{D=Array.from(this.g.values());for(let pe=0;pe<D.length;pe++)ne=ne.concat(D[pe])}return ne},t.set=function(D,ne){return bs(this),this.i=null,D=di(this,D),ki(this,D)&&(this.h-=this.g.get(D).length),this.g.set(D,[ne]),this.h+=1,this},t.get=function(D,ne){return D?(D=this.V(D),0<D.length?String(D[0]):ne):ne};function ga(D,ne,pe){Ii(D,ne),0<pe.length&&(D.i=null,D.g.set(di(D,ne),E(pe)),D.h+=pe.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const D=[],ne=Array.from(this.g.keys());for(var pe=0;pe<ne.length;pe++){var _e=ne[pe];const He=encodeURIComponent(String(_e)),Nt=this.V(_e);for(_e=0;_e<Nt.length;_e++){var $e=He;Nt[_e]!==""&&($e+="="+encodeURIComponent(String(Nt[_e]))),D.push($e)}}return this.i=D.join("&")};function di(D,ne){return ne=String(ne),D.j&&(ne=ne.toLowerCase()),ne}function Yi(D,ne){ne&&!D.j&&(bs(D),D.i=null,D.g.forEach(function(pe,_e){var $e=_e.toLowerCase();_e!=$e&&(Ii(this,_e),ga(this,$e,pe))},D)),D.j=ne}function Oc(D,ne){const pe=new jr;if(l.Image){const _e=new Image;_e.onload=y(Ts,pe,"TestLoadImage: loaded",!0,ne,_e),_e.onerror=y(Ts,pe,"TestLoadImage: error",!1,ne,_e),_e.onabort=y(Ts,pe,"TestLoadImage: abort",!1,ne,_e),_e.ontimeout=y(Ts,pe,"TestLoadImage: timeout",!1,ne,_e),l.setTimeout(function(){_e.ontimeout&&_e.ontimeout()},1e4),_e.src=D}else ne(!1)}function bu(D,ne){const pe=new jr,_e=new AbortController,$e=setTimeout(()=>{_e.abort(),Ts(pe,"TestPingServer: timeout",!1,ne)},1e4);fetch(D,{signal:_e.signal}).then(He=>{clearTimeout($e),He.ok?Ts(pe,"TestPingServer: ok",!0,ne):Ts(pe,"TestPingServer: server error",!1,ne)}).catch(()=>{clearTimeout($e),Ts(pe,"TestPingServer: error",!1,ne)})}function Ts(D,ne,pe,_e,$e){try{$e&&($e.onload=null,$e.onerror=null,$e.onabort=null,$e.ontimeout=null),_e(pe)}catch{}}function $c(){this.g=new Nr}function Eu(D,ne,pe){const _e=pe||"";try{pa(D,function($e,He){let Nt=$e;c($e)&&(Nt=yn($e)),ne.push(_e+He+"="+encodeURIComponent(Nt))})}catch($e){throw ne.push(_e+"type="+encodeURIComponent("_badmap")),$e}}function ya(D){this.l=D.Ub||null,this.j=D.eb||!1}b(ya,wn),ya.prototype.g=function(){return new mo(this.l,this.j)},ya.prototype.i=function(D){return function(){return D}}({});function mo(D,ne){pr.call(this),this.D=D,this.o=ne,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(mo,pr),t=mo.prototype,t.open=function(D,ne){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=D,this.A=ne,this.readyState=1,Zr(this)},t.send=function(D){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const ne={headers:this.u,method:this.B,credentials:this.m,cache:void 0};D&&(ne.body=D),(this.D||l).fetch(new Request(this.A,ne)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Xr(this)),this.readyState=0},t.Sa=function(D){if(this.g&&(this.l=D,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=D.headers,this.readyState=2,Zr(this)),this.g&&(this.readyState=3,Zr(this),this.g)))if(this.responseType==="arraybuffer")D.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in D){if(this.j=D.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;wu(this)}else D.text().then(this.Ra.bind(this),this.ga.bind(this))};function wu(D){D.j.read().then(D.Pa.bind(D)).catch(D.ga.bind(D))}t.Pa=function(D){if(this.g){if(this.o&&D.value)this.response.push(D.value);else if(!this.o){var ne=D.value?D.value:new Uint8Array(0);(ne=this.v.decode(ne,{stream:!D.done}))&&(this.response=this.responseText+=ne)}D.done?Xr(this):Zr(this),this.readyState==3&&wu(this)}},t.Ra=function(D){this.g&&(this.response=this.responseText=D,Xr(this))},t.Qa=function(D){this.g&&(this.response=D,Xr(this))},t.ga=function(){this.g&&Xr(this)};function Xr(D){D.readyState=4,D.l=null,D.j=null,D.v=null,Zr(D)}t.setRequestHeader=function(D,ne){this.u.append(D,ne)},t.getResponseHeader=function(D){return this.h&&this.h.get(D.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const D=[],ne=this.h.entries();for(var pe=ne.next();!pe.done;)pe=pe.value,D.push(pe[0]+": "+pe[1]),pe=ne.next();return D.join(`\r
`)};function Zr(D){D.onreadystatechange&&D.onreadystatechange.call(D)}Object.defineProperty(mo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(D){this.m=D?"include":"same-origin"}});function va(D){let ne="";return K(D,function(pe,_e){ne+=_e,ne+=":",ne+=pe,ne+=`\r
`}),ne}function Ua(D,ne,pe){e:{for(_e in pe){var _e=!1;break e}_e=!0}_e||(pe=va(pe),typeof D=="string"?pe!=null&&encodeURIComponent(String(pe)):Cn(D,ne,pe))}function Un(D){pr.call(this),this.headers=new Map,this.o=D||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(Un,pr);var Fc=/^https?$/i,Nl=["POST","PUT"];t=Un.prototype,t.Ha=function(D){this.J=D},t.ea=function(D,ne,pe,_e){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+D);ne=ne?ne.toUpperCase():"GET",this.D=D,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Tn.g(),this.v=this.o?jn(this.o):jn(Tn),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(ne,String(D),!0),this.B=!1}catch(He){go(this,He);return}if(D=pe||"",pe=new Map(this.headers),_e)if(Object.getPrototypeOf(_e)===Object.prototype)for(var $e in _e)pe.set($e,_e[$e]);else if(typeof _e.keys=="function"&&typeof _e.get=="function")for(const He of _e.keys())pe.set(He,_e.get(He));else throw Error("Unknown input type for opt_headers: "+String(_e));_e=Array.from(pe.keys()).find(He=>He.toLowerCase()=="content-type"),$e=l.FormData&&D instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Nl,ne,void 0))||_e||$e||pe.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[He,Nt]of pe)this.g.setRequestHeader(He,Nt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ga(this),this.u=!0,this.g.send(D),this.u=!1}catch(He){go(this,He)}};function go(D,ne){D.h=!1,D.g&&(D.j=!0,D.g.abort(),D.j=!1),D.l=ne,D.m=5,yo(D),Rn(D)}function yo(D){D.A||(D.A=!0,dr(D,"complete"),dr(D,"error"))}t.abort=function(D){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=D||7,dr(this,"complete"),dr(this,"abort"),Rn(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Rn(this,!0)),Un.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Dl(this):this.bb())},t.bb=function(){Dl(this)};function Dl(D){if(D.h&&typeof o<"u"&&(!D.v[1]||ts(D)!=4||D.Z()!=2)){if(D.u&&ts(D)==4)_r(D.Ea,0,D);else if(dr(D,"readystatechange"),ts(D)==4){D.h=!1;try{const Nt=D.Z();e:switch(Nt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var ne=!0;break e;default:ne=!1}var pe;if(!(pe=ne)){var _e;if(_e=Nt===0){var $e=String(D.D).match(Ki)[1]||null;!$e&&l.self&&l.self.location&&($e=l.self.location.protocol.slice(0,-1)),_e=!Fc.test($e?$e.toLowerCase():"")}pe=_e}if(pe)dr(D,"complete"),dr(D,"success");else{D.m=6;try{var He=2<ts(D)?D.g.statusText:""}catch{He=""}D.l=He+" ["+D.Z()+"]",yo(D)}}finally{Rn(D)}}}}function Rn(D,ne){if(D.g){Ga(D);const pe=D.g,_e=D.v[0]?()=>{}:null;D.g=null,D.v=null,ne||dr(D,"ready");try{pe.onreadystatechange=_e}catch{}}}function Ga(D){D.I&&(l.clearTimeout(D.I),D.I=null)}t.isActive=function(){return!!this.g};function ts(D){return D.g?D.g.readyState:0}t.Z=function(){try{return 2<ts(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(D){if(this.g){var ne=this.g.responseText;return D&&ne.indexOf(D)==0&&(ne=ne.substring(D.length)),Dr(ne)}};function Ko(D){try{if(!D.g)return null;if("response"in D.g)return D.g.response;switch(D.H){case"":case"text":return D.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in D.g)return D.g.mozResponseArrayBuffer}return null}catch{return null}}function za(D){const ne={};D=(D.g&&2<=ts(D)&&D.g.getAllResponseHeaders()||"").split(`\r
`);for(let _e=0;_e<D.length;_e++){if(P(D[_e]))continue;var pe=de(D[_e]);const $e=pe[0];if(pe=pe[1],typeof pe!="string")continue;pe=pe.trim();const He=ne[$e]||[];ne[$e]=He,He.push(pe)}W(ne,function(_e){return _e.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Xn(D,ne,pe){return pe&&pe.internalChannelParams&&pe.internalChannelParams[D]||ne}function Zo(D){this.Aa=0,this.i=[],this.j=new jr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Xn("failFast",!1,D),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Xn("baseRetryDelayMs",5e3,D),this.cb=Xn("retryDelaySeedMs",1e4,D),this.Wa=Xn("forwardChannelMaxRetries",2,D),this.wa=Xn("forwardChannelRequestTimeoutMs",2e4,D),this.pa=D&&D.xmlHttpFactory||void 0,this.Xa=D&&D.Tb||void 0,this.Ca=D&&D.useFetchStreams||!1,this.L=void 0,this.J=D&&D.supportsCrossDomainXhr||!1,this.K="",this.h=new un(D&&D.concurrentRequestLimit),this.Da=new $c,this.P=D&&D.fastHandshake||!1,this.O=D&&D.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=D&&D.Rb||!1,D&&D.xa&&this.j.xa(),D&&D.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&D&&D.detectBufferingProxy||!1,this.ja=void 0,D&&D.longPollingTimeout&&0<D.longPollingTimeout&&(this.ja=D.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Zo.prototype,t.la=8,t.G=1,t.connect=function(D,ne,pe,_e){yr(0),this.W=D,this.H=ne||{},pe&&_e!==void 0&&(this.H.OSID=pe,this.H.OAID=_e),this.F=this.X,this.I=Xo(this,null,this.W),Ni(this)};function ms(D){if(vo(D),D.G==3){var ne=D.U++,pe=qs(D.I);if(Cn(pe,"SID",D.K),Cn(pe,"RID",ne),Cn(pe,"TYPE","terminate"),xa(D,pe),ne=new os(D,D.j,ne),ne.L=2,ne.v=Xi(qs(pe)),pe=!1,l.navigator&&l.navigator.sendBeacon)try{pe=l.navigator.sendBeacon(ne.v.toString(),"")}catch{}!pe&&l.Image&&(new Image().src=ne.v,pe=!0),pe||(ne.g=Pu(ne.j,null),ne.g.ea(ne.v)),ne.F=Date.now(),Xe(ne)}Ru(D)}function fi(D){D.g&&(hi(D),D.g.cancel(),D.g=null)}function vo(D){fi(D),D.u&&(l.clearTimeout(D.u),D.u=null),Ha(D),D.h.cancel(),D.s&&(typeof D.s=="number"&&l.clearTimeout(D.s),D.s=null)}function Ni(D){if(!An(D.h)&&!D.s){D.s=!0;var ne=D.Ga;le||he(),Z||(le(),Z=!0),Y.add(ne,D),D.B=0}}function Su(D,ne){return Sn(D.h)>=D.h.j-(D.s?1:0)?!1:D.s?(D.i=ne.D.concat(D.i),!0):D.G==1||D.G==2||D.B>=(D.Va?0:D.Wa)?!1:(D.s=vr(m(D.Ga,D,ne),Di(D,D.B)),D.B++,!0)}t.Ga=function(D){if(this.s)if(this.s=null,this.G==1){if(!D){this.U=Math.floor(1e5*Math.random()),D=this.U++;const $e=new os(this,this.j,D);let He=this.o;if(this.S&&(He?(He=H(He),ue(He,this.S)):He=this.S),this.m!==null||this.O||($e.H=He,He=null),this.P)e:{for(var ne=0,pe=0;pe<this.i.length;pe++){t:{var _e=this.i[pe];if("__data__"in _e.map&&(_e=_e.map.__data__,typeof _e=="string")){_e=_e.length;break t}_e=void 0}if(_e===void 0)break;if(ne+=_e,4096<ne){ne=pe;break e}if(ne===4096||pe===this.i.length-1){ne=pe+1;break e}}ne=1e3}else ne=1e3;ne=us(this,$e,ne),pe=qs(this.I),Cn(pe,"RID",D),Cn(pe,"CVER",22),this.D&&Cn(pe,"X-HTTP-Session-Id",this.D),xa(this,pe),He&&(this.O?ne="headers="+encodeURIComponent(String(va(He)))+"&"+ne:this.m&&Ua(pe,this.m,He)),Fa(this.h,$e),this.Ua&&Cn(pe,"TYPE","init"),this.P?(Cn(pe,"$req",ne),Cn(pe,"SID","null"),$e.T=!0,Se($e,pe,null)):Se($e,pe,ne),this.G=2}}else this.G==3&&(D?gs(this,D):this.i.length==0||An(this.h)||gs(this))};function gs(D,ne){var pe;ne?pe=ne.l:pe=D.U++;const _e=qs(D.I);Cn(_e,"SID",D.K),Cn(_e,"RID",pe),Cn(_e,"AID",D.T),xa(D,_e),D.m&&D.o&&Ua(_e,D.m,D.o),pe=new os(D,D.j,pe,D.B+1),D.m===null&&(pe.H=D.o),ne&&(D.i=ne.D.concat(D.i)),ne=us(D,pe,1e3),pe.I=Math.round(.5*D.wa)+Math.round(.5*D.wa*Math.random()),Fa(D.h,pe),Se(pe,_e,ne)}function xa(D,ne){D.H&&K(D.H,function(pe,_e){Cn(ne,_e,pe)}),D.l&&pa({},function(pe,_e){Cn(ne,_e,pe)})}function us(D,ne,pe){pe=Math.min(D.i.length,pe);var _e=D.l?m(D.l.Na,D.l,D):null;e:{var $e=D.i;let He=-1;for(;;){const Nt=["count="+pe];He==-1?0<pe?(He=$e[0].g,Nt.push("ofs="+He)):He=0:Nt.push("ofs="+He);let vn=!0;for(let cs=0;cs<pe;cs++){let Yr=$e[cs].g;const bn=$e[cs].map;if(Yr-=He,0>Yr)He=Math.max(0,$e[cs].g-100),vn=!1;else try{Eu(bn,Nt,"req"+Yr+"_")}catch{_e&&_e(bn)}}if(vn){_e=Nt.join("&");break e}}}return D=D.i.splice(0,pe),ne.D=D,_e}function xo(D){if(!D.g&&!D.u){D.Y=1;var ne=D.Fa;le||he(),Z||(le(),Z=!0),Y.add(ne,D),D.v=0}}function _o(D){return D.g||D.u||3<=D.v?!1:(D.Y++,D.u=vr(m(D.Fa,D),Di(D,D.v)),D.v++,!0)}t.Fa=function(){if(this.u=null,bo(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var D=2*this.R;this.j.info("BP detection timer enabled: "+D),this.A=vr(m(this.ab,this),D)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,yr(10),fi(this),bo(this))};function hi(D){D.A!=null&&(l.clearTimeout(D.A),D.A=null)}function bo(D){D.g=new os(D,D.j,"rpc",D.Y),D.m===null&&(D.g.H=D.o),D.g.O=0;var ne=qs(D.qa);Cn(ne,"RID","rpc"),Cn(ne,"SID",D.K),Cn(ne,"AID",D.T),Cn(ne,"CI",D.F?"0":"1"),!D.F&&D.ja&&Cn(ne,"TO",D.ja),Cn(ne,"TYPE","xmlhttp"),xa(D,ne),D.m&&D.o&&Ua(ne,D.m,D.o),D.L&&(D.g.I=D.L);var pe=D.g;D=D.ia,pe.L=1,pe.v=Xi(qs(ne)),pe.m=null,pe.P=!0,We(pe,D)}t.Za=function(){this.C!=null&&(this.C=null,fi(this),_o(this),yr(19))};function Ha(D){D.C!=null&&(l.clearTimeout(D.C),D.C=null)}function Pn(D,ne){var pe=null;if(D.g==ne){Ha(D),hi(D),D.g=null;var _e=2}else if(ls(D.h,ne))pe=ne.D,ho(D.h,ne),_e=1;else return;if(D.G!=0){if(ne.o)if(_e==1){pe=ne.m?ne.m.length:0,ne=Date.now()-ne.F;var $e=D.B;_e=Hr(),dr(_e,new Wr(_e,pe)),Ni(D)}else xo(D);else if($e=ne.s,$e==3||$e==0&&0<ne.X||!(_e==1&&Su(D,ne)||_e==2&&_o(D)))switch(pe&&0<pe.length&&(ne=D.h,ne.i=ne.i.concat(pe)),$e){case 1:ji(D,5);break;case 4:ji(D,10);break;case 3:ji(D,6);break;default:ji(D,2)}}}function Di(D,ne){let pe=D.Ta+Math.floor(Math.random()*D.cb);return D.isActive()||(pe*=2),pe*ne}function ji(D,ne){if(D.j.info("Error code "+ne),ne==2){var pe=m(D.fb,D),_e=D.Xa;const $e=!_e;_e=new ma(_e||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Va(_e,"https"),Xi(_e),$e?Oc(_e.toString(),pe):bu(_e.toString(),pe)}else yr(2);D.G=0,D.l&&D.l.sa(ne),Ru(D),vo(D)}t.fb=function(D){D?(this.j.info("Successfully pinged google.com"),yr(2)):(this.j.info("Failed to ping google.com"),yr(1))};function Ru(D){if(D.G=0,D.ka=[],D.l){const ne=Fs(D.h);(ne.length!=0||D.i.length!=0)&&(T(D.ka,ne),T(D.ka,D.i),D.h.i.length=0,E(D.i),D.i.length=0),D.l.ra()}}function Xo(D,ne,pe){var _e=pe instanceof ma?qs(pe):new ma(pe);if(_e.g!="")ne&&(_e.g=ne+"."+_e.g),Zi(_e,_e.s);else{var $e=l.location;_e=$e.protocol,ne=ne?ne+"."+$e.hostname:$e.hostname,$e=+$e.port;var He=new ma(null);_e&&Va(He,_e),ne&&(He.g=ne),$e&&Zi(He,$e),pe&&(He.l=pe),_e=He}return pe=D.D,ne=D.ya,pe&&ne&&Cn(_e,pe,ne),Cn(_e,"VER",D.la),xa(D,_e),_e}function Pu(D,ne,pe){if(ne&&!D.J)throw Error("Can't create secondary domain capable XhrIo object.");return ne=D.Ca&&!D.pa?new Un(new ya({eb:pe})):new Un(D.pa),ne.Ha(D.J),ne}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function jl(){}t=jl.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Yo(){}Yo.prototype.g=function(D,ne){return new As(D,ne)};function As(D,ne){pr.call(this),this.g=new Zo(ne),this.l=D,this.h=ne&&ne.messageUrlParams||null,D=ne&&ne.messageHeaders||null,ne&&ne.clientProtocolHeaderRequired&&(D?D["X-Client-Protocol"]="webchannel":D={"X-Client-Protocol":"webchannel"}),this.g.o=D,D=ne&&ne.initMessageHeaders||null,ne&&ne.messageContentType&&(D?D["X-WebChannel-Content-Type"]=ne.messageContentType:D={"X-WebChannel-Content-Type":ne.messageContentType}),ne&&ne.va&&(D?D["X-WebChannel-Client-Profile"]=ne.va:D={"X-WebChannel-Client-Profile":ne.va}),this.g.S=D,(D=ne&&ne.Sb)&&!P(D)&&(this.g.m=D),this.v=ne&&ne.supportsCrossDomainXhr||!1,this.u=ne&&ne.sendRawJson||!1,(ne=ne&&ne.httpSessionIdParam)&&!P(ne)&&(this.g.D=ne,D=this.h,D!==null&&ne in D&&(D=this.h,ne in D&&delete D[ne])),this.j=new Ji(this)}b(As,pr),As.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},As.prototype.close=function(){ms(this.g)},As.prototype.o=function(D){var ne=this.g;if(typeof D=="string"){var pe={};pe.__data__=D,D=pe}else this.u&&(pe={},pe.__data__=yn(D),D=pe);ne.i.push(new Kr(ne.Ya++,D)),ne.G==3&&Ni(ne)},As.prototype.N=function(){this.g.l=null,delete this.j,ms(this.g),delete this.g,As.aa.N.call(this)};function Eo(D){Ir.call(this),D.__headers__&&(this.headers=D.__headers__,this.statusCode=D.__status__,delete D.__headers__,delete D.__status__);var ne=D.__sm__;if(ne){e:{for(const pe in ne){D=pe;break e}D=void 0}(this.i=D)&&(D=this.i,ne=ne!==null&&D in ne?ne[D]:void 0),this.data=ne}else this.data=D}b(Eo,Ir);function ba(){kr.call(this),this.status=1}b(ba,kr);function Ji(D){this.g=D}b(Ji,jl),Ji.prototype.ua=function(){dr(this.g,"a")},Ji.prototype.ta=function(D){dr(this.g,new Eo(D))},Ji.prototype.sa=function(D){dr(this.g,new ba)},Ji.prototype.ra=function(){dr(this.g,"b")},Yo.prototype.createWebChannel=Yo.prototype.g,As.prototype.send=As.prototype.o,As.prototype.open=As.prototype.m,As.prototype.close=As.prototype.close,createWebChannelTransport=function(){return new Yo},getStatEventTarget=function(){return Hr()},Event$1=Er,Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Bn.NO_ERROR=0,Bn.TIMEOUT=8,Bn.HTTP_ERROR=6,ErrorCode=Bn,Hn.COMPLETE="complete",EventType=Hn,$r.EventType=Cr,Cr.OPEN="a",Cr.CLOSE="b",Cr.ERROR="c",Cr.MESSAGE="d",pr.prototype.listen=pr.prototype.K,WebChannel=$r,Un.prototype.listenOnce=Un.prototype.L,Un.prototype.getLastError=Un.prototype.Ka,Un.prototype.getLastErrorCode=Un.prototype.Ba,Un.prototype.getStatus=Un.prototype.Z,Un.prototype.getResponseJson=Un.prototype.Oa,Un.prototype.getResponseText=Un.prototype.oa,Un.prototype.send=Un.prototype.ea,Un.prototype.setWithCredentials=Un.prototype.Ha,XhrIo=Un}).apply(typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{});const F="@firebase/firestore",M="4.7.16";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class User{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}User.UNAUTHENTICATED=new User(null),User.GOOGLE_CREDENTIALS=new User("google-credentials-uid"),User.FIRST_PARTY=new User("first-party-uid"),User.MOCK_USER=new User("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let x="11.8.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O=new Logger("@firebase/firestore");function __PRIVATE_getLogLevel(){return O.logLevel}function __PRIVATE_logDebug(t,...e){if(O.logLevel<=LogLevel.DEBUG){const r=e.map(__PRIVATE_argToString);O.debug(`Firestore (${x}): ${t}`,...r)}}function __PRIVATE_logError(t,...e){if(O.logLevel<=LogLevel.ERROR){const r=e.map(__PRIVATE_argToString);O.error(`Firestore (${x}): ${t}`,...r)}}function __PRIVATE_logWarn(t,...e){if(O.logLevel<=LogLevel.WARN){const r=e.map(__PRIVATE_argToString);O.warn(`Firestore (${x}): ${t}`,...r)}}function __PRIVATE_argToString(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fail(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,__PRIVATE__fail(t,n,r)}function __PRIVATE__fail(t,e,r){let n=`FIRESTORE (${x}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw __PRIVATE_logError(n),new Error(n)}function __PRIVATE_hardAssert(t,e,r,n){let s="Unexpected state";typeof r=="string"?s=r:n=r,t||__PRIVATE__fail(e,s,n)}function __PRIVATE_debugCast(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class FirestoreError extends FirebaseError{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_Deferred{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_OAuthToken{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class __PRIVATE_EmptyAuthCredentialsProvider{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(User.UNAUTHENTICATED))}shutdown(){}}class __PRIVATE_EmulatorAuthCredentialsProvider{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class __PRIVATE_FirebaseAuthCredentialsProvider{constructor(e){this.t=e,this.currentUser=User.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){__PRIVATE_hardAssert(this.o===void 0,42304);let n=this.i;const s=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let a=new __PRIVATE_Deferred;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new __PRIVATE_Deferred,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=a;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new __PRIVATE_Deferred)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(__PRIVATE_hardAssert(typeof n.accessToken=="string",31837,{l:n}),new __PRIVATE_OAuthToken(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return __PRIVATE_hardAssert(e===null||typeof e=="string",2055,{h:e}),new User(e)}}class __PRIVATE_FirstPartyToken{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=User.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class __PRIVATE_FirstPartyAuthCredentialsProvider{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new __PRIVATE_FirstPartyToken(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(User.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class AppCheckToken{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class __PRIVATE_FirebaseAppCheckTokenProvider{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,_isFirebaseServerApp(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){__PRIVATE_hardAssert(this.o===void 0,3512);const n=a=>{a.error!=null&&__PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,__PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const s=a=>{__PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):__PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new AppCheckToken(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(__PRIVATE_hardAssert(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new AppCheckToken(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_randomBytes(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_newTextEncoder(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AutoId{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=__PRIVATE_randomBytes(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<r&&(n+=e.charAt(s[a]%62))}return n}}function __PRIVATE_primitiveComparator(t,e){return t<e?-1:t>e?1:0}function __PRIVATE_compareUtf8Strings(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=t.codePointAt(r),s=e.codePointAt(r);if(n!==s){if(n<128&&s<128)return __PRIVATE_primitiveComparator(n,s);{const a=__PRIVATE_newTextEncoder(),o=__PRIVATE_compareByteArrays$1(a.encode(__PRIVATE_getUtf8SafeSubstring(t,r)),a.encode(__PRIVATE_getUtf8SafeSubstring(e,r)));return o!==0?o:__PRIVATE_primitiveComparator(n,s)}}r+=n>65535?2:1}return __PRIVATE_primitiveComparator(t.length,e.length)}function __PRIVATE_getUtf8SafeSubstring(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function __PRIVATE_compareByteArrays$1(t,e){for(let r=0;r<t.length&&r<e.length;++r)if(t[r]!==e[r])return __PRIVATE_primitiveComparator(t[r],e[r]);return __PRIVATE_primitiveComparator(t.length,e.length)}function __PRIVATE_arrayEquals(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B=-62135596800,L=1e6;class Timestamp{static now(){return Timestamp.fromMillis(Date.now())}static fromDate(e){return Timestamp.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*L);return new Timestamp(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new FirestoreError(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new FirestoreError(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<B)throw new FirestoreError(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new FirestoreError(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/L}_compareTo(e){return this.seconds===e.seconds?__PRIVATE_primitiveComparator(this.nanoseconds,e.nanoseconds):__PRIVATE_primitiveComparator(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-B;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SnapshotVersion{static fromTimestamp(e){return new SnapshotVersion(e)}static min(){return new SnapshotVersion(new Timestamp(0,0))}static max(){return new SnapshotVersion(new Timestamp(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k="__name__";class BasePath{constructor(e,r,n){r===void 0?r=0:r>e.length&&fail(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&fail(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return BasePath.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof BasePath?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const a=BasePath.compareSegments(e.get(s),r.get(s));if(a!==0)return a}return __PRIVATE_primitiveComparator(e.length,r.length)}static compareSegments(e,r){const n=BasePath.isNumericId(e),s=BasePath.isNumericId(r);return n&&!s?-1:!n&&s?1:n&&s?BasePath.extractNumericId(e).compare(BasePath.extractNumericId(r)):__PRIVATE_compareUtf8Strings(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Integer.fromString(e.substring(4,e.length-2))}}class ResourcePath extends BasePath{construct(e,r,n){return new ResourcePath(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new ResourcePath(r)}static emptyPath(){return new ResourcePath([])}}const q=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class FieldPath$1 extends BasePath{construct(e,r,n){return new FieldPath$1(e,r,n)}static isValidIdentifier(e){return q.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),FieldPath$1.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===k}static keyField(){return new FieldPath$1([k])}static fromServerFormat(e){const r=[];let n="",s=0;const a=()=>{if(n.length===0)throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new FirestoreError(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new FirestoreError(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(n+=l,s++):(a(),s++)}if(a(),o)throw new FirestoreError(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new FieldPath$1(r)}static emptyPath(){return new FieldPath$1([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentKey{constructor(e){this.path=e}static fromPath(e){return new DocumentKey(ResourcePath.fromString(e))}static fromName(e){return new DocumentKey(ResourcePath.fromString(e).popFirst(5))}static empty(){return new DocumentKey(ResourcePath.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ResourcePath.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return ResourcePath.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new DocumentKey(new ResourcePath(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q=-1;function __PRIVATE_newIndexOffsetSuccessorFromReadTime(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=SnapshotVersion.fromTimestamp(n===1e9?new Timestamp(r+1,0):new Timestamp(r,n));return new IndexOffset(s,DocumentKey.empty(),e)}function __PRIVATE_newIndexOffsetFromDocument(t){return new IndexOffset(t.readTime,t.key,Q)}class IndexOffset{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new IndexOffset(SnapshotVersion.min(),DocumentKey.empty(),Q)}static max(){return new IndexOffset(SnapshotVersion.max(),DocumentKey.empty(),Q)}}function __PRIVATE_indexOffsetComparator(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=DocumentKey.comparator(t.documentKey,e.documentKey),r!==0?r:__PRIVATE_primitiveComparator(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class PersistenceTransaction{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function __PRIVATE_ignoreIfPrimaryLeaseLoss(t){if(t.code!==N.FAILED_PRECONDITION||t.message!==$)throw t;__PRIVATE_logDebug("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PersistencePromise{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&fail(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new PersistencePromise((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof PersistencePromise?r:PersistencePromise.resolve(r)}catch(r){return PersistencePromise.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):PersistencePromise.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):PersistencePromise.reject(r)}static resolve(e){return new PersistencePromise((r,n)=>{r(e)})}static reject(e){return new PersistencePromise((r,n)=>{n(e)})}static waitFor(e){return new PersistencePromise((r,n)=>{let s=0,a=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++a,o&&a===s&&r()},u=>n(u))}),o=!0,a===s&&r()})}static or(e){let r=PersistencePromise.resolve(!1);for(const n of e)r=r.next(s=>s?PersistencePromise.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,a)=>{n.push(r.call(this,s,a))}),this.waitFor(n)}static mapArray(e,r){return new PersistencePromise((n,s)=>{const a=e.length,o=new Array(a);let l=0;for(let u=0;u<a;u++){const c=u;r(e[c]).next(d=>{o[c]=d,++l,l===a&&n(o)},d=>s(d))}})}static doWhile(e,r){return new PersistencePromise((n,s)=>{const a=()=>{e()===!0?r().next(()=>{a()},s):n()};a()})}}function __PRIVATE_getAndroidVersion(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function __PRIVATE_isIndexedDbTransactionError(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ListenSequence{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ue(n),this.ce=n=>r.writeSequenceNumber(n))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}__PRIVATE_ListenSequence.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G=-1;function __PRIVATE_isNullOrUndefined(t){return t==null}function __PRIVATE_isNegativeZero(t){return t===0&&1/t==-1/0}function isSafeInteger(t){return typeof t=="number"&&Number.isInteger(t)&&!__PRIVATE_isNegativeZero(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z="";function __PRIVATE_encodeResourcePath(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=__PRIVATE_encodeSeparator(e)),e=__PRIVATE_encodeSegment(t.get(r),e);return __PRIVATE_encodeSeparator(e)}function __PRIVATE_encodeSegment(t,e){let r=e;const n=t.length;for(let s=0;s<n;s++){const a=t.charAt(s);switch(a){case"\0":r+="";break;case z:r+="";break;default:r+=a}}return r}function __PRIVATE_encodeSeparator(t){return t+z+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_objectSize(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function forEach(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function isEmpty(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SortedMap{constructor(e,r){this.comparator=e,this.root=r||LLRBNode.EMPTY}insert(e,r){return new SortedMap(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))}remove(e){return new SortedMap(this.comparator,this.root.remove(e,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new SortedMapIterator(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new SortedMapIterator(this.root,e,this.comparator,!1)}getReverseIterator(){return new SortedMapIterator(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new SortedMapIterator(this.root,e,this.comparator,!0)}}class SortedMapIterator{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class LLRBNode{constructor(e,r,n,s,a){this.key=e,this.value=r,this.color=n??LLRBNode.RED,this.left=s??LLRBNode.EMPTY,this.right=a??LLRBNode.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,a){return new LLRBNode(e??this.key,r??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const a=n(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,r,n),null):a===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return LLRBNode.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return LLRBNode.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw fail(43730,{key:this.key,value:this.value});if(this.right.isRed())throw fail(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw fail(27949);return e+(this.isRed()?0:1)}}LLRBNode.EMPTY=null,LLRBNode.RED=!0,LLRBNode.BLACK=!1;LLRBNode.EMPTY=new class{constructor(){this.size=0}get key(){throw fail(57766)}get value(){throw fail(16141)}get color(){throw fail(16727)}get left(){throw fail(29726)}get right(){throw fail(36894)}copy(e,r,n,s,a){return this}insert(e,r,n){return new LLRBNode(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SortedSet{constructor(e){this.comparator=e,this.data=new SortedMap(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new SortedSetIterator(this.data.getIterator())}getIteratorFrom(e){return new SortedSetIterator(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof SortedSet)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new SortedSet(this.comparator);return r.data=e,r}}class SortedSetIterator{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldMask{constructor(e){this.fields=e,e.sort(FieldPath$1.comparator)}static empty(){return new FieldMask([])}unionWith(e){let r=new SortedSet(FieldPath$1.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new FieldMask(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return __PRIVATE_arrayEquals(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_Base64DecodeError extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ByteString{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new __PRIVATE_Base64DecodeError("Invalid base64 string: "+a):a}}(e);return new ByteString(r)}static fromUint8Array(e){const r=function(s){let a="";for(let o=0;o<s.length;++o)a+=String.fromCharCode(s[o]);return a}(e);return new ByteString(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return __PRIVATE_primitiveComparator(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ByteString.EMPTY_BYTE_STRING=new ByteString("");const it=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function __PRIVATE_normalizeTimestamp(t){if(__PRIVATE_hardAssert(!!t,39018),typeof t=="string"){let e=0;const r=it.exec(t);if(__PRIVATE_hardAssert(!!r,46558,{timestamp:t}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:__PRIVATE_normalizeNumber(t.seconds),nanos:__PRIVATE_normalizeNumber(t.nanos)}}function __PRIVATE_normalizeNumber(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function __PRIVATE_normalizeByteString(t){return typeof t=="string"?ByteString.fromBase64String(t):ByteString.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const st="server_timestamp",ot="__type__",_t="__previous_value__",at="__local_write_time__";function __PRIVATE_isServerTimestamp(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[ot])===null||r===void 0?void 0:r.stringValue)===st}function __PRIVATE_getPreviousValue(t){const e=t.mapValue.fields[_t];return __PRIVATE_isServerTimestamp(e)?__PRIVATE_getPreviousValue(e):e}function __PRIVATE_getLocalWriteTime(t){const e=__PRIVATE_normalizeTimestamp(t.mapValue.fields[at].timestampValue);return new Timestamp(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DatabaseInfo{constructor(e,r,n,s,a,o,l,u,c,d){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=c,this.isUsingEmulator=d}}const ut="(default)";class DatabaseId{constructor(e,r){this.projectId=e,this.database=r||ut}static empty(){return new DatabaseId("","")}get isDefaultDatabase(){return this.database===ut}isEqual(e){return e instanceof DatabaseId&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ct="__type__",lt="__max__",ht={mapValue:{}},Pt="__vector__",Tt="value";function __PRIVATE_typeOrder(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?__PRIVATE_isServerTimestamp(t)?4:__PRIVATE_isMaxValue(t)?9007199254740991:__PRIVATE_isVectorValue(t)?10:11:fail(28295,{value:t})}function __PRIVATE_valueEquals(t,e){if(t===e)return!0;const r=__PRIVATE_typeOrder(t);if(r!==__PRIVATE_typeOrder(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return __PRIVATE_getLocalWriteTime(t).isEqual(__PRIVATE_getLocalWriteTime(e));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const o=__PRIVATE_normalizeTimestamp(s.timestampValue),l=__PRIVATE_normalizeTimestamp(a.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,a){return __PRIVATE_normalizeByteString(s.bytesValue).isEqual(__PRIVATE_normalizeByteString(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,a){return __PRIVATE_normalizeNumber(s.geoPointValue.latitude)===__PRIVATE_normalizeNumber(a.geoPointValue.latitude)&&__PRIVATE_normalizeNumber(s.geoPointValue.longitude)===__PRIVATE_normalizeNumber(a.geoPointValue.longitude)}(t,e);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return __PRIVATE_normalizeNumber(s.integerValue)===__PRIVATE_normalizeNumber(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const o=__PRIVATE_normalizeNumber(s.doubleValue),l=__PRIVATE_normalizeNumber(a.doubleValue);return o===l?__PRIVATE_isNegativeZero(o)===__PRIVATE_isNegativeZero(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return __PRIVATE_arrayEquals(t.arrayValue.values||[],e.arrayValue.values||[],__PRIVATE_valueEquals);case 10:case 11:return function(s,a){const o=s.mapValue.fields||{},l=a.mapValue.fields||{};if(__PRIVATE_objectSize(o)!==__PRIVATE_objectSize(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!__PRIVATE_valueEquals(o[u],l[u])))return!1;return!0}(t,e);default:return fail(52216,{left:t})}}function __PRIVATE_arrayValueContains(t,e){return(t.values||[]).find(r=>__PRIVATE_valueEquals(r,e))!==void 0}function __PRIVATE_valueCompare(t,e){if(t===e)return 0;const r=__PRIVATE_typeOrder(t),n=__PRIVATE_typeOrder(e);if(r!==n)return __PRIVATE_primitiveComparator(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return __PRIVATE_primitiveComparator(t.booleanValue,e.booleanValue);case 2:return function(a,o){const l=__PRIVATE_normalizeNumber(a.integerValue||a.doubleValue),u=__PRIVATE_normalizeNumber(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return __PRIVATE_compareTimestamps(t.timestampValue,e.timestampValue);case 4:return __PRIVATE_compareTimestamps(__PRIVATE_getLocalWriteTime(t),__PRIVATE_getLocalWriteTime(e));case 5:return __PRIVATE_compareUtf8Strings(t.stringValue,e.stringValue);case 6:return function(a,o){const l=__PRIVATE_normalizeByteString(a),u=__PRIVATE_normalizeByteString(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(a,o){const l=a.split("/"),u=o.split("/");for(let c=0;c<l.length&&c<u.length;c++){const d=__PRIVATE_primitiveComparator(l[c],u[c]);if(d!==0)return d}return __PRIVATE_primitiveComparator(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,o){const l=__PRIVATE_primitiveComparator(__PRIVATE_normalizeNumber(a.latitude),__PRIVATE_normalizeNumber(o.latitude));return l!==0?l:__PRIVATE_primitiveComparator(__PRIVATE_normalizeNumber(a.longitude),__PRIVATE_normalizeNumber(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return __PRIVATE_compareArrays(t.arrayValue,e.arrayValue);case 10:return function(a,o){var l,u,c,d;const p=a.fields||{},m=o.fields||{},y=(l=p[Tt])===null||l===void 0?void 0:l.arrayValue,b=(u=m[Tt])===null||u===void 0?void 0:u.arrayValue,E=__PRIVATE_primitiveComparator(((c=y==null?void 0:y.values)===null||c===void 0?void 0:c.length)||0,((d=b==null?void 0:b.values)===null||d===void 0?void 0:d.length)||0);return E!==0?E:__PRIVATE_compareArrays(y,b)}(t.mapValue,e.mapValue);case 11:return function(a,o){if(a===ht.mapValue&&o===ht.mapValue)return 0;if(a===ht.mapValue)return 1;if(o===ht.mapValue)return-1;const l=a.fields||{},u=Object.keys(l),c=o.fields||{},d=Object.keys(c);u.sort(),d.sort();for(let p=0;p<u.length&&p<d.length;++p){const m=__PRIVATE_compareUtf8Strings(u[p],d[p]);if(m!==0)return m;const y=__PRIVATE_valueCompare(l[u[p]],c[d[p]]);if(y!==0)return y}return __PRIVATE_primitiveComparator(u.length,d.length)}(t.mapValue,e.mapValue);default:throw fail(23264,{Pe:r})}}function __PRIVATE_compareTimestamps(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return __PRIVATE_primitiveComparator(t,e);const r=__PRIVATE_normalizeTimestamp(t),n=__PRIVATE_normalizeTimestamp(e),s=__PRIVATE_primitiveComparator(r.seconds,n.seconds);return s!==0?s:__PRIVATE_primitiveComparator(r.nanos,n.nanos)}function __PRIVATE_compareArrays(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const a=__PRIVATE_valueCompare(r[s],n[s]);if(a)return a}return __PRIVATE_primitiveComparator(r.length,n.length)}function canonicalId(t){return __PRIVATE_canonifyValue(t)}function __PRIVATE_canonifyValue(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=__PRIVATE_normalizeTimestamp(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return __PRIVATE_normalizeByteString(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return DocumentKey.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const a of r.values||[])s?s=!1:n+=",",n+=__PRIVATE_canonifyValue(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",a=!0;for(const o of n)a?a=!1:s+=",",s+=`${o}:${__PRIVATE_canonifyValue(r.fields[o])}`;return s+"}"}(t.mapValue):fail(61005,{value:t})}function __PRIVATE_estimateByteSize(t){switch(__PRIVATE_typeOrder(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=__PRIVATE_getPreviousValue(t);return e?16+__PRIVATE_estimateByteSize(e):16;case 5:return 2*t.stringValue.length;case 6:return __PRIVATE_normalizeByteString(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((s,a)=>s+__PRIVATE_estimateByteSize(a),0)}(t.arrayValue);case 10:case 11:return function(n){let s=0;return forEach(n.fields,(a,o)=>{s+=a.length+__PRIVATE_estimateByteSize(o)}),s}(t.mapValue);default:throw fail(13486,{value:t})}}function __PRIVATE_refValue(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function isInteger$1(t){return!!t&&"integerValue"in t}function isArray$1(t){return!!t&&"arrayValue"in t}function __PRIVATE_isNullValue(t){return!!t&&"nullValue"in t}function __PRIVATE_isNanValue(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function __PRIVATE_isMapValue(t){return!!t&&"mapValue"in t}function __PRIVATE_isVectorValue(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[ct])===null||r===void 0?void 0:r.stringValue)===Pt}function __PRIVATE_deepClone(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return forEach(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=__PRIVATE_deepClone(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=__PRIVATE_deepClone(t.arrayValue.values[r]);return e}return Object.assign({},t)}function __PRIVATE_isMaxValue(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===lt}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ObjectValue{constructor(e){this.value=e}static empty(){return new ObjectValue({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!__PRIVATE_isMapValue(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=__PRIVATE_deepClone(r)}setAll(e){let r=FieldPath$1.emptyPath(),n={},s=[];e.forEach((o,l)=>{if(!r.isImmediateParentOf(l)){const u=this.getFieldsMap(r);this.applyChanges(u,n,s),n={},s=[],r=l.popLast()}o?n[l.lastSegment()]=__PRIVATE_deepClone(o):s.push(l.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,s)}delete(e){const r=this.field(e.popLast());__PRIVATE_isMapValue(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return __PRIVATE_valueEquals(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];__PRIVATE_isMapValue(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){forEach(r,(s,a)=>e[s]=a);for(const s of n)delete e[s]}clone(){return new ObjectValue(__PRIVATE_deepClone(this.value))}}function __PRIVATE_extractFieldMask(t){const e=[];return forEach(t.fields,(r,n)=>{const s=new FieldPath$1([r]);if(__PRIVATE_isMapValue(n)){const a=__PRIVATE_extractFieldMask(n.mapValue).fields;if(a.length===0)e.push(s);else for(const o of a)e.push(s.child(o))}else e.push(s)}),new FieldMask(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MutableDocument{constructor(e,r,n,s,a,o,l){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=a,this.data=o,this.documentState=l}static newInvalidDocument(e){return new MutableDocument(e,0,SnapshotVersion.min(),SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),0)}static newFoundDocument(e,r,n,s){return new MutableDocument(e,1,r,SnapshotVersion.min(),n,s,0)}static newNoDocument(e,r){return new MutableDocument(e,2,r,SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),0)}static newUnknownDocument(e,r){return new MutableDocument(e,3,r,SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(SnapshotVersion.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ObjectValue.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ObjectValue.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=SnapshotVersion.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof MutableDocument&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new MutableDocument(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bound{constructor(e,r){this.position=e,this.inclusive=r}}function __PRIVATE_boundCompareToDocument(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const a=e[s],o=t.position[s];if(a.field.isKeyField()?n=DocumentKey.comparator(DocumentKey.fromName(o.referenceValue),r.key):n=__PRIVATE_valueCompare(o,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function __PRIVATE_boundEquals(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!__PRIVATE_valueEquals(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OrderBy{constructor(e,r="asc"){this.field=e,this.dir=r}}function __PRIVATE_orderByEquals(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Filter{}class FieldFilter extends Filter{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new __PRIVATE_KeyFieldFilter(e,r,n):r==="array-contains"?new __PRIVATE_ArrayContainsFilter(e,n):r==="in"?new __PRIVATE_InFilter(e,n):r==="not-in"?new __PRIVATE_NotInFilter(e,n):r==="array-contains-any"?new __PRIVATE_ArrayContainsAnyFilter(e,n):new FieldFilter(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new __PRIVATE_KeyFieldInFilter(e,n):new __PRIVATE_KeyFieldNotInFilter(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(__PRIVATE_valueCompare(r,this.value)):r!==null&&__PRIVATE_typeOrder(this.value)===__PRIVATE_typeOrder(r)&&this.matchesComparison(__PRIVATE_valueCompare(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return fail(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class CompositeFilter extends Filter{constructor(e,r){super(),this.filters=e,this.op=r,this.Te=null}static create(e,r){return new CompositeFilter(e,r)}matches(e){return __PRIVATE_compositeFilterIsConjunction(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function __PRIVATE_compositeFilterIsConjunction(t){return t.op==="and"}function __PRIVATE_compositeFilterIsFlatConjunction(t){return __PRIVATE_compositeFilterIsFlat(t)&&__PRIVATE_compositeFilterIsConjunction(t)}function __PRIVATE_compositeFilterIsFlat(t){for(const e of t.filters)if(e instanceof CompositeFilter)return!1;return!0}function __PRIVATE_canonifyFilter(t){if(t instanceof FieldFilter)return t.field.canonicalString()+t.op.toString()+canonicalId(t.value);if(__PRIVATE_compositeFilterIsFlatConjunction(t))return t.filters.map(e=>__PRIVATE_canonifyFilter(e)).join(",");{const e=t.filters.map(r=>__PRIVATE_canonifyFilter(r)).join(",");return`${t.op}(${e})`}}function __PRIVATE_filterEquals(t,e){return t instanceof FieldFilter?function(n,s){return s instanceof FieldFilter&&n.op===s.op&&n.field.isEqual(s.field)&&__PRIVATE_valueEquals(n.value,s.value)}(t,e):t instanceof CompositeFilter?function(n,s){return s instanceof CompositeFilter&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((a,o,l)=>a&&__PRIVATE_filterEquals(o,s.filters[l]),!0):!1}(t,e):void fail(19439)}function __PRIVATE_stringifyFilter(t){return t instanceof FieldFilter?function(r){return`${r.field.canonicalString()} ${r.op} ${canonicalId(r.value)}`}(t):t instanceof CompositeFilter?function(r){return r.op.toString()+" {"+r.getFilters().map(__PRIVATE_stringifyFilter).join(" ,")+"}"}(t):"Filter"}class __PRIVATE_KeyFieldFilter extends FieldFilter{constructor(e,r,n){super(e,r,n),this.key=DocumentKey.fromName(n.referenceValue)}matches(e){const r=DocumentKey.comparator(e.key,this.key);return this.matchesComparison(r)}}class __PRIVATE_KeyFieldInFilter extends FieldFilter{constructor(e,r){super(e,"in",r),this.keys=__PRIVATE_extractDocumentKeysFromArrayValue("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class __PRIVATE_KeyFieldNotInFilter extends FieldFilter{constructor(e,r){super(e,"not-in",r),this.keys=__PRIVATE_extractDocumentKeysFromArrayValue("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function __PRIVATE_extractDocumentKeysFromArrayValue(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>DocumentKey.fromName(n.referenceValue))}class __PRIVATE_ArrayContainsFilter extends FieldFilter{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return isArray$1(r)&&__PRIVATE_arrayValueContains(r.arrayValue,this.value)}}class __PRIVATE_InFilter extends FieldFilter{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&__PRIVATE_arrayValueContains(this.value.arrayValue,r)}}class __PRIVATE_NotInFilter extends FieldFilter{constructor(e,r){super(e,"not-in",r)}matches(e){if(__PRIVATE_arrayValueContains(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!__PRIVATE_arrayValueContains(this.value.arrayValue,r)}}class __PRIVATE_ArrayContainsAnyFilter extends FieldFilter{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!isArray$1(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>__PRIVATE_arrayValueContains(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_TargetImpl{constructor(e,r=null,n=[],s=[],a=null,o=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=o,this.endAt=l,this.Ie=null}}function __PRIVATE_newTarget(t,e=null,r=[],n=[],s=null,a=null,o=null){return new __PRIVATE_TargetImpl(t,e,r,n,s,a,o)}function __PRIVATE_canonifyTarget(t){const e=__PRIVATE_debugCast(t);if(e.Ie===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>__PRIVATE_canonifyFilter(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),__PRIVATE_isNullOrUndefined(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>canonicalId(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>canonicalId(n)).join(",")),e.Ie=r}return e.Ie}function __PRIVATE_targetEquals(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!__PRIVATE_orderByEquals(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!__PRIVATE_filterEquals(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!__PRIVATE_boundEquals(t.startAt,e.startAt)&&__PRIVATE_boundEquals(t.endAt,e.endAt)}function __PRIVATE_targetIsDocumentTarget(t){return DocumentKey.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryImpl{constructor(e,r=null,n=[],s=[],a=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=o,this.startAt=l,this.endAt=u,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function __PRIVATE_newQuery(t,e,r,n,s,a,o,l){return new __PRIVATE_QueryImpl(t,e,r,n,s,a,o,l)}function __PRIVATE_newQueryForPath(t){return new __PRIVATE_QueryImpl(t)}function __PRIVATE_queryMatchesAllDocuments(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function __PRIVATE_isCollectionGroupQuery(t){return t.collectionGroup!==null}function __PRIVATE_queryNormalizedOrderBy(t){const e=__PRIVATE_debugCast(t);if(e.Ee===null){e.Ee=[];const r=new Set;for(const a of e.explicitOrderBy)e.Ee.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new SortedSet(FieldPath$1.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(l=l.add(c.field))})}),l})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.Ee.push(new OrderBy(a,n))}),r.has(FieldPath$1.keyField().canonicalString())||e.Ee.push(new OrderBy(FieldPath$1.keyField(),n))}return e.Ee}function __PRIVATE_queryToTarget(t){const e=__PRIVATE_debugCast(t);return e.de||(e.de=__PRIVATE__queryToTarget(e,__PRIVATE_queryNormalizedOrderBy(t))),e.de}function __PRIVATE__queryToTarget(t,e){if(t.limitType==="F")return __PRIVATE_newTarget(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new OrderBy(s.field,a)});const r=t.endAt?new Bound(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Bound(t.startAt.position,t.startAt.inclusive):null;return __PRIVATE_newTarget(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function __PRIVATE_queryWithAddedFilter(t,e){const r=t.filters.concat([e]);return new __PRIVATE_QueryImpl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function __PRIVATE_queryWithLimit(t,e,r){return new __PRIVATE_QueryImpl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function __PRIVATE_queryEquals(t,e){return __PRIVATE_targetEquals(__PRIVATE_queryToTarget(t),__PRIVATE_queryToTarget(e))&&t.limitType===e.limitType}function __PRIVATE_canonifyQuery(t){return`${__PRIVATE_canonifyTarget(__PRIVATE_queryToTarget(t))}|lt:${t.limitType}`}function __PRIVATE_stringifyQuery(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>__PRIVATE_stringifyFilter(s)).join(", ")}]`),__PRIVATE_isNullOrUndefined(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>canonicalId(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>canonicalId(s)).join(",")),`Target(${n})`}(__PRIVATE_queryToTarget(t))}; limitType=${t.limitType})`}function __PRIVATE_queryMatches(t,e){return e.isFoundDocument()&&function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):DocumentKey.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,s){for(const a of __PRIVATE_queryNormalizedOrderBy(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(o,l,u){const c=__PRIVATE_boundCompareToDocument(o,l,u);return o.inclusive?c<=0:c<0}(n.startAt,__PRIVATE_queryNormalizedOrderBy(n),s)||n.endAt&&!function(o,l,u){const c=__PRIVATE_boundCompareToDocument(o,l,u);return o.inclusive?c>=0:c>0}(n.endAt,__PRIVATE_queryNormalizedOrderBy(n),s))}(t,e)}function __PRIVATE_queryCollectionGroup(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function __PRIVATE_newQueryComparator(t){return(e,r)=>{let n=!1;for(const s of __PRIVATE_queryNormalizedOrderBy(t)){const a=__PRIVATE_compareDocs(s,e,r);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function __PRIVATE_compareDocs(t,e,r){const n=t.field.isKeyField()?DocumentKey.comparator(e.key,r.key):function(a,o,l){const u=o.data.field(a),c=l.data.field(a);return u!==null&&c!==null?__PRIVATE_valueCompare(u,c):fail(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return fail(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ObjectMap{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){forEach(this.inner,(r,n)=>{for(const[s,a]of n)e(s,a)})}isEmpty(){return isEmpty(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dt=new SortedMap(DocumentKey.comparator);function __PRIVATE_mutableDocumentMap(){return dt}const At=new SortedMap(DocumentKey.comparator);function documentMap(...t){let e=At;for(const r of t)e=e.insert(r.key,r);return e}function __PRIVATE_convertOverlayedDocumentMapToDocumentMap(t){let e=At;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function __PRIVATE_newOverlayMap(){return __PRIVATE_newDocumentKeyMap()}function __PRIVATE_newMutationMap(){return __PRIVATE_newDocumentKeyMap()}function __PRIVATE_newDocumentKeyMap(){return new ObjectMap(t=>t.toString(),(t,e)=>t.isEqual(e))}const Rt=new SortedMap(DocumentKey.comparator),Vt=new SortedSet(DocumentKey.comparator);function __PRIVATE_documentKeySet(...t){let e=Vt;for(const r of t)e=e.add(r);return e}const mt=new SortedSet(__PRIVATE_primitiveComparator);function __PRIVATE_targetIdSet(){return mt}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_toDouble(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:__PRIVATE_isNegativeZero(e)?"-0":e}}function __PRIVATE_toInteger(t){return{integerValue:""+t}}function toNumber(t,e){return isSafeInteger(e)?__PRIVATE_toInteger(e):__PRIVATE_toDouble(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TransformOperation{constructor(){this._=void 0}}function __PRIVATE_applyTransformOperationToLocalView(t,e,r){return t instanceof __PRIVATE_ServerTimestampTransform?function(s,a){const o={fields:{[ot]:{stringValue:st},[at]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&__PRIVATE_isServerTimestamp(a)&&(a=__PRIVATE_getPreviousValue(a)),a&&(o.fields[_t]=a),{mapValue:o}}(r,e):t instanceof __PRIVATE_ArrayUnionTransformOperation?__PRIVATE_applyArrayUnionTransformOperation(t,e):t instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_applyArrayRemoveTransformOperation(t,e):function(s,a){const o=__PRIVATE_computeTransformOperationBaseValue(s,a),l=asNumber$1(o)+asNumber$1(s.Re);return isInteger$1(o)&&isInteger$1(s.Re)?__PRIVATE_toInteger(l):__PRIVATE_toDouble(s.serializer,l)}(t,e)}function __PRIVATE_applyTransformOperationToRemoteDocument(t,e,r){return t instanceof __PRIVATE_ArrayUnionTransformOperation?__PRIVATE_applyArrayUnionTransformOperation(t,e):t instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_applyArrayRemoveTransformOperation(t,e):r}function __PRIVATE_computeTransformOperationBaseValue(t,e){return t instanceof __PRIVATE_NumericIncrementTransformOperation?function(n){return isInteger$1(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class __PRIVATE_ServerTimestampTransform extends TransformOperation{}class __PRIVATE_ArrayUnionTransformOperation extends TransformOperation{constructor(e){super(),this.elements=e}}function __PRIVATE_applyArrayUnionTransformOperation(t,e){const r=__PRIVATE_coercedFieldValuesArray(e);for(const n of t.elements)r.some(s=>__PRIVATE_valueEquals(s,n))||r.push(n);return{arrayValue:{values:r}}}class __PRIVATE_ArrayRemoveTransformOperation extends TransformOperation{constructor(e){super(),this.elements=e}}function __PRIVATE_applyArrayRemoveTransformOperation(t,e){let r=__PRIVATE_coercedFieldValuesArray(e);for(const n of t.elements)r=r.filter(s=>!__PRIVATE_valueEquals(s,n));return{arrayValue:{values:r}}}class __PRIVATE_NumericIncrementTransformOperation extends TransformOperation{constructor(e,r){super(),this.serializer=e,this.Re=r}}function asNumber$1(t){return __PRIVATE_normalizeNumber(t.integerValue||t.doubleValue)}function __PRIVATE_coercedFieldValuesArray(t){return isArray$1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function __PRIVATE_fieldTransformEquals(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof __PRIVATE_ArrayUnionTransformOperation&&s instanceof __PRIVATE_ArrayUnionTransformOperation||n instanceof __PRIVATE_ArrayRemoveTransformOperation&&s instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_arrayEquals(n.elements,s.elements,__PRIVATE_valueEquals):n instanceof __PRIVATE_NumericIncrementTransformOperation&&s instanceof __PRIVATE_NumericIncrementTransformOperation?__PRIVATE_valueEquals(n.Re,s.Re):n instanceof __PRIVATE_ServerTimestampTransform&&s instanceof __PRIVATE_ServerTimestampTransform}(t.transform,e.transform)}class MutationResult{constructor(e,r){this.version=e,this.transformResults=r}}class Precondition{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Precondition}static exists(e){return new Precondition(void 0,e)}static updateTime(e){return new Precondition(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function __PRIVATE_preconditionIsValidForDocument(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Mutation{}function __PRIVATE_calculateOverlayMutation(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new __PRIVATE_DeleteMutation(t.key,Precondition.none()):new __PRIVATE_SetMutation(t.key,t.data,Precondition.none());{const r=t.data,n=ObjectValue.empty();let s=new SortedSet(FieldPath$1.comparator);for(let a of e.fields)if(!s.has(a)){let o=r.field(a);o===null&&a.length>1&&(a=a.popLast(),o=r.field(a)),o===null?n.delete(a):n.set(a,o),s=s.add(a)}return new __PRIVATE_PatchMutation(t.key,n,new FieldMask(s.toArray()),Precondition.none())}}function __PRIVATE_mutationApplyToRemoteDocument(t,e,r){t instanceof __PRIVATE_SetMutation?function(s,a,o){const l=s.value.clone(),u=__PRIVATE_serverTransformResults(s.fieldTransforms,a,o.transformResults);l.setAll(u),a.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,r):t instanceof __PRIVATE_PatchMutation?function(s,a,o){if(!__PRIVATE_preconditionIsValidForDocument(s.precondition,a))return void a.convertToUnknownDocument(o.version);const l=__PRIVATE_serverTransformResults(s.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(__PRIVATE_getPatch(s)),u.setAll(l),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,r):function(s,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function __PRIVATE_mutationApplyToLocalView(t,e,r,n){return t instanceof __PRIVATE_SetMutation?function(a,o,l,u){if(!__PRIVATE_preconditionIsValidForDocument(a.precondition,o))return l;const c=a.value.clone(),d=__PRIVATE_localTransformResults(a.fieldTransforms,u,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof __PRIVATE_PatchMutation?function(a,o,l,u){if(!__PRIVATE_preconditionIsValidForDocument(a.precondition,o))return l;const c=__PRIVATE_localTransformResults(a.fieldTransforms,u,o),d=o.data;return d.setAll(__PRIVATE_getPatch(a)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(p=>p.field))}(t,e,r,n):function(a,o,l){return __PRIVATE_preconditionIsValidForDocument(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,r)}function __PRIVATE_mutationExtractBaseValue(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),a=__PRIVATE_computeTransformOperationBaseValue(n.transform,s||null);a!=null&&(r===null&&(r=ObjectValue.empty()),r.set(n.field,a))}return r||null}function __PRIVATE_mutationEquals(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&__PRIVATE_arrayEquals(n,s,(a,o)=>__PRIVATE_fieldTransformEquals(a,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class __PRIVATE_SetMutation extends Mutation{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class __PRIVATE_PatchMutation extends Mutation{constructor(e,r,n,s,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function __PRIVATE_getPatch(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function __PRIVATE_serverTransformResults(t,e,r){const n=new Map;__PRIVATE_hardAssert(t.length===r.length,32656,{Ve:r.length,me:t.length});for(let s=0;s<r.length;s++){const a=t[s],o=a.transform,l=e.data.field(a.field);n.set(a.field,__PRIVATE_applyTransformOperationToRemoteDocument(o,l,r[s]))}return n}function __PRIVATE_localTransformResults(t,e,r){const n=new Map;for(const s of t){const a=s.transform,o=r.data.field(s.field);n.set(s.field,__PRIVATE_applyTransformOperationToLocalView(a,o,e))}return n}class __PRIVATE_DeleteMutation extends Mutation{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class __PRIVATE_VerifyMutation extends Mutation{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MutationBatch{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&__PRIVATE_mutationApplyToRemoteDocument(a,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=__PRIVATE_mutationApplyToLocalView(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=__PRIVATE_mutationApplyToLocalView(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=__PRIVATE_newMutationMap();return this.mutations.forEach(s=>{const a=e.get(s.key),o=a.overlayedDocument;let l=this.applyToLocalView(o,a.mutatedFields);l=r.has(s.key)?null:l;const u=__PRIVATE_calculateOverlayMutation(o,l);u!==null&&n.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(SnapshotVersion.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),__PRIVATE_documentKeySet())}isEqual(e){return this.batchId===e.batchId&&__PRIVATE_arrayEquals(this.mutations,e.mutations,(r,n)=>__PRIVATE_mutationEquals(r,n))&&__PRIVATE_arrayEquals(this.baseMutations,e.baseMutations,(r,n)=>__PRIVATE_mutationEquals(r,n))}}class MutationBatchResult{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){__PRIVATE_hardAssert(e.mutations.length===n.length,58842,{fe:e.mutations.length,ge:n.length});let s=function(){return Rt}();const a=e.mutations;for(let o=0;o<a.length;o++)s=s.insert(a[o].key,n[o].version);return new MutationBatchResult(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Overlay{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ExistenceFilter{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ft,gt;function __PRIVATE_isPermanentError(t){switch(t){case N.OK:return fail(64938);case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0;default:return fail(15467,{code:t})}}function __PRIVATE_mapCodeFromRpcCode(t){if(t===void 0)return __PRIVATE_logError("GRPC error has no .code"),N.UNKNOWN;switch(t){case ft.OK:return N.OK;case ft.CANCELLED:return N.CANCELLED;case ft.UNKNOWN:return N.UNKNOWN;case ft.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case ft.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case ft.INTERNAL:return N.INTERNAL;case ft.UNAVAILABLE:return N.UNAVAILABLE;case ft.UNAUTHENTICATED:return N.UNAUTHENTICATED;case ft.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case ft.NOT_FOUND:return N.NOT_FOUND;case ft.ALREADY_EXISTS:return N.ALREADY_EXISTS;case ft.PERMISSION_DENIED:return N.PERMISSION_DENIED;case ft.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case ft.ABORTED:return N.ABORTED;case ft.OUT_OF_RANGE:return N.OUT_OF_RANGE;case ft.UNIMPLEMENTED:return N.UNIMPLEMENTED;case ft.DATA_LOSS:return N.DATA_LOSS;default:return fail(39323,{code:t})}}(gt=ft||(ft={}))[gt.OK=0]="OK",gt[gt.CANCELLED=1]="CANCELLED",gt[gt.UNKNOWN=2]="UNKNOWN",gt[gt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",gt[gt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",gt[gt.NOT_FOUND=5]="NOT_FOUND",gt[gt.ALREADY_EXISTS=6]="ALREADY_EXISTS",gt[gt.PERMISSION_DENIED=7]="PERMISSION_DENIED",gt[gt.UNAUTHENTICATED=16]="UNAUTHENTICATED",gt[gt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",gt[gt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",gt[gt.ABORTED=10]="ABORTED",gt[gt.OUT_OF_RANGE=11]="OUT_OF_RANGE",gt[gt.UNIMPLEMENTED=12]="UNIMPLEMENTED",gt[gt.INTERNAL=13]="INTERNAL",gt[gt.UNAVAILABLE=14]="UNAVAILABLE",gt[gt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yt=new Integer([4294967295,4294967295],0);function __PRIVATE_getMd5HashValue(t){const e=__PRIVATE_newTextEncoder().encode(t),r=new Md5;return r.update(e),new Uint8Array(r.digest())}function __PRIVATE_get64BitUints(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Integer([r,n],0),new Integer([s,a],0)]}class BloomFilter{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new __PRIVATE_BloomFilterError(`Invalid padding: ${r}`);if(n<0)throw new __PRIVATE_BloomFilterError(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new __PRIVATE_BloomFilterError(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new __PRIVATE_BloomFilterError(`Invalid padding when bitmap length is 0: ${r}`);this.pe=8*e.length-r,this.ye=Integer.fromNumber(this.pe)}we(e,r,n){let s=e.add(r.multiply(Integer.fromNumber(n)));return s.compare(yt)===1&&(s=new Integer([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ye).toNumber()}Se(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const r=__PRIVATE_getMd5HashValue(e),[n,s]=__PRIVATE_get64BitUints(r);for(let a=0;a<this.hashCount;a++){const o=this.we(n,s,a);if(!this.Se(o))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new BloomFilter(a,s,r);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.pe===0)return;const r=__PRIVATE_getMd5HashValue(e),[n,s]=__PRIVATE_get64BitUints(r);for(let a=0;a<this.hashCount;a++){const o=this.we(n,s,a);this.be(o)}}be(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class __PRIVATE_BloomFilterError extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RemoteEvent{constructor(e,r,n,s,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,TargetChange.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new RemoteEvent(SnapshotVersion.min(),s,new SortedMap(__PRIVATE_primitiveComparator),__PRIVATE_mutableDocumentMap(),__PRIVATE_documentKeySet())}}class TargetChange{constructor(e,r,n,s,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new TargetChange(n,r,__PRIVATE_documentKeySet(),__PRIVATE_documentKeySet(),__PRIVATE_documentKeySet())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_DocumentWatchChange{constructor(e,r,n,s){this.De=e,this.removedTargetIds=r,this.key=n,this.ve=s}}class __PRIVATE_ExistenceFilterChange{constructor(e,r){this.targetId=e,this.Ce=r}}class __PRIVATE_WatchTargetChange{constructor(e,r,n=ByteString.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class __PRIVATE_TargetState{constructor(){this.Fe=0,this.Me=__PRIVATE_snapshotChangesMap(),this.xe=ByteString.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=__PRIVATE_documentKeySet(),r=__PRIVATE_documentKeySet(),n=__PRIVATE_documentKeySet();return this.Me.forEach((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:fail(38017,{changeType:a})}}),new TargetChange(this.xe,this.Oe,e,r,n)}Qe(){this.Ne=!1,this.Me=__PRIVATE_snapshotChangesMap()}$e(e,r){this.Ne=!0,this.Me=this.Me.insert(e,r)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,__PRIVATE_hardAssert(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class __PRIVATE_WatchChangeAggregator{constructor(e){this.ze=e,this.je=new Map,this.He=__PRIVATE_mutableDocumentMap(),this.Je=__PRIVATE_documentTargetMap(),this.Ye=__PRIVATE_documentTargetMap(),this.Ze=new SortedMap(__PRIVATE_primitiveComparator)}Xe(e){for(const r of e.De)e.ve&&e.ve.isFoundDocument()?this.et(r,e.ve):this.tt(r,e.key,e.ve);for(const r of e.removedTargetIds)this.tt(r,e.key,e.ve)}nt(e){this.forEachTarget(e,r=>{const n=this.rt(r);switch(e.state){case 0:this.it(r)&&n.ke(e.resumeToken);break;case 1:n.We(),n.Be||n.Qe(),n.ke(e.resumeToken);break;case 2:n.We(),n.Be||this.removeTarget(r);break;case 3:this.it(r)&&(n.Ge(),n.ke(e.resumeToken));break;case 4:this.it(r)&&(this.st(r),n.ke(e.resumeToken));break;default:fail(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.je.forEach((n,s)=>{this.it(s)&&r(s)})}ot(e){const r=e.targetId,n=e.Ce.count,s=this._t(r);if(s){const a=s.target;if(__PRIVATE_targetIsDocumentTarget(a))if(n===0){const o=new DocumentKey(a.path);this.tt(r,o,MutableDocument.newNoDocument(o,SnapshotVersion.min()))}else __PRIVATE_hardAssert(n===1,20013,{expectedCount:n});else{const o=this.ut(r);if(o!==n){const l=this.ct(e),u=l?this.lt(l,e,o):1;if(u!==0){this.st(r);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(r,c)}}}}}ct(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=r;let o,l;try{o=__PRIVATE_normalizeByteString(n).toUint8Array()}catch(u){if(u instanceof __PRIVATE_Base64DecodeError)return __PRIVATE_logWarn("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new BloomFilter(o,s,a)}catch(u){return __PRIVATE_logWarn(u instanceof __PRIVATE_BloomFilterError?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.pe===0?null:l}lt(e,r,n){return r.Ce.count===n-this.Tt(e,r.targetId)?0:2}Tt(e,r){const n=this.ze.getRemoteKeysForTarget(r);let s=0;return n.forEach(a=>{const o=this.ze.Pt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(l)||(this.tt(r,a,null),s++)}),s}It(e){const r=new Map;this.je.forEach((a,o)=>{const l=this._t(o);if(l){if(a.current&&__PRIVATE_targetIsDocumentTarget(l.target)){const u=new DocumentKey(l.target.path);this.Et(u).has(o)||this.dt(o,u)||this.tt(o,u,MutableDocument.newNoDocument(u,e))}a.Le&&(r.set(o,a.qe()),a.Qe())}});let n=__PRIVATE_documentKeySet();this.Ye.forEach((a,o)=>{let l=!0;o.forEachWhile(u=>{const c=this._t(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(a))}),this.He.forEach((a,o)=>o.setReadTime(e));const s=new RemoteEvent(e,r,this.Ze,this.He,n);return this.He=__PRIVATE_mutableDocumentMap(),this.Je=__PRIVATE_documentTargetMap(),this.Ye=__PRIVATE_documentTargetMap(),this.Ze=new SortedMap(__PRIVATE_primitiveComparator),s}et(e,r){if(!this.it(e))return;const n=this.dt(e,r.key)?2:0;this.rt(e).$e(r.key,n),this.He=this.He.insert(r.key,r),this.Je=this.Je.insert(r.key,this.Et(r.key).add(e)),this.Ye=this.Ye.insert(r.key,this.At(r.key).add(e))}tt(e,r,n){if(!this.it(e))return;const s=this.rt(e);this.dt(e,r)?s.$e(r,1):s.Ue(r),this.Ye=this.Ye.insert(r,this.At(r).delete(e)),this.Ye=this.Ye.insert(r,this.At(r).add(e)),n&&(this.He=this.He.insert(r,n))}removeTarget(e){this.je.delete(e)}ut(e){const r=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let r=this.je.get(e);return r||(r=new __PRIVATE_TargetState,this.je.set(e,r)),r}At(e){let r=this.Ye.get(e);return r||(r=new SortedSet(__PRIVATE_primitiveComparator),this.Ye=this.Ye.insert(e,r)),r}Et(e){let r=this.Je.get(e);return r||(r=new SortedSet(__PRIVATE_primitiveComparator),this.Je=this.Je.insert(e,r)),r}it(e){const r=this._t(e)!==null;return r||__PRIVATE_logDebug("WatchChangeAggregator","Detected inactive target",e),r}_t(e){const r=this.je.get(e);return r&&r.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new __PRIVATE_TargetState),this.ze.getRemoteKeysForTarget(e).forEach(r=>{this.tt(e,r,null)})}dt(e,r){return this.ze.getRemoteKeysForTarget(e).has(r)}}function __PRIVATE_documentTargetMap(){return new SortedMap(DocumentKey.comparator)}function __PRIVATE_snapshotChangesMap(){return new SortedMap(DocumentKey.comparator)}const wt={asc:"ASCENDING",desc:"DESCENDING"},St={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},bt={and:"AND",or:"OR"};class JsonProtoSerializer{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function __PRIVATE_toInt32Proto(t,e){return t.useProto3Json||__PRIVATE_isNullOrUndefined(e)?e:{value:e}}function toTimestamp(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function __PRIVATE_toBytes(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function __PRIVATE_toVersion(t,e){return toTimestamp(t,e.toTimestamp())}function __PRIVATE_fromVersion(t){return __PRIVATE_hardAssert(!!t,49232),SnapshotVersion.fromTimestamp(function(r){const n=__PRIVATE_normalizeTimestamp(r);return new Timestamp(n.seconds,n.nanos)}(t))}function __PRIVATE_toResourceName(t,e){return __PRIVATE_toResourcePath(t,e).canonicalString()}function __PRIVATE_toResourcePath(t,e){const r=function(s){return new ResourcePath(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function __PRIVATE_fromResourceName(t){const e=ResourcePath.fromString(t);return __PRIVATE_hardAssert(__PRIVATE_isValidResourceName(e),10190,{key:e.toString()}),e}function __PRIVATE_toName(t,e){return __PRIVATE_toResourceName(t.databaseId,e.path)}function fromName(t,e){const r=__PRIVATE_fromResourceName(e);if(r.get(1)!==t.databaseId.projectId)throw new FirestoreError(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new FirestoreError(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new DocumentKey(__PRIVATE_extractLocalPathFromResourceName(r))}function __PRIVATE_toQueryPath(t,e){return __PRIVATE_toResourceName(t.databaseId,e)}function __PRIVATE_fromQueryPath(t){const e=__PRIVATE_fromResourceName(t);return e.length===4?ResourcePath.emptyPath():__PRIVATE_extractLocalPathFromResourceName(e)}function __PRIVATE_getEncodedDatabaseId(t){return new ResourcePath(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function __PRIVATE_extractLocalPathFromResourceName(t){return __PRIVATE_hardAssert(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function __PRIVATE_toMutationDocument(t,e,r){return{name:__PRIVATE_toName(t,e),fields:r.value.mapValue.fields}}function __PRIVATE_fromWatchChange(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:fail(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=function(c,d){return c.useProto3Json?(__PRIVATE_hardAssert(d===void 0||typeof d=="string",58123),ByteString.fromBase64String(d||"")):(__PRIVATE_hardAssert(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),ByteString.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(c){const d=c.code===void 0?N.UNKNOWN:__PRIVATE_mapCodeFromRpcCode(c.code);return new FirestoreError(d,c.message||"")}(o);r=new __PRIVATE_WatchTargetChange(n,s,a,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=fromName(t,n.document.name),a=__PRIVATE_fromVersion(n.document.updateTime),o=n.document.createTime?__PRIVATE_fromVersion(n.document.createTime):SnapshotVersion.min(),l=new ObjectValue({mapValue:{fields:n.document.fields}}),u=MutableDocument.newFoundDocument(s,a,o,l),c=n.targetIds||[],d=n.removedTargetIds||[];r=new __PRIVATE_DocumentWatchChange(c,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=fromName(t,n.document),a=n.readTime?__PRIVATE_fromVersion(n.readTime):SnapshotVersion.min(),o=MutableDocument.newNoDocument(s,a),l=n.removedTargetIds||[];r=new __PRIVATE_DocumentWatchChange([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=fromName(t,n.document),a=n.removedTargetIds||[];r=new __PRIVATE_DocumentWatchChange([],a,s,null)}else{if(!("filter"in e))return fail(11601,{Vt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,o=new ExistenceFilter(s,a),l=n.targetId;r=new __PRIVATE_ExistenceFilterChange(l,o)}}return r}function toMutation(t,e){let r;if(e instanceof __PRIVATE_SetMutation)r={update:__PRIVATE_toMutationDocument(t,e.key,e.value)};else if(e instanceof __PRIVATE_DeleteMutation)r={delete:__PRIVATE_toName(t,e.key)};else if(e instanceof __PRIVATE_PatchMutation)r={update:__PRIVATE_toMutationDocument(t,e.key,e.data),updateMask:__PRIVATE_toDocumentMask(e.fieldMask)};else{if(!(e instanceof __PRIVATE_VerifyMutation))return fail(16599,{ft:e.type});r={verify:__PRIVATE_toName(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,o){const l=o.transform;if(l instanceof __PRIVATE_ServerTimestampTransform)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof __PRIVATE_ArrayUnionTransformOperation)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof __PRIVATE_ArrayRemoveTransformOperation)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof __PRIVATE_NumericIncrementTransformOperation)return{fieldPath:o.field.canonicalString(),increment:l.Re};throw fail(20930,{transform:o.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:__PRIVATE_toVersion(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:fail(27497)}(t,e.precondition)),r}function __PRIVATE_fromWriteResults(t,e){return t&&t.length>0?(__PRIVATE_hardAssert(e!==void 0,14353),t.map(r=>function(s,a){let o=s.updateTime?__PRIVATE_fromVersion(s.updateTime):__PRIVATE_fromVersion(a);return o.isEqual(SnapshotVersion.min())&&(o=__PRIVATE_fromVersion(a)),new MutationResult(o,s.transformResults||[])}(r,e))):[]}function __PRIVATE_toDocumentsTarget(t,e){return{documents:[__PRIVATE_toQueryPath(t,e.path)]}}function __PRIVATE_toQueryTarget(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=__PRIVATE_toQueryPath(t,s);const a=function(c){if(c.length!==0)return __PRIVATE_toFilter(CompositeFilter.create(c,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const o=function(c){if(c.length!==0)return c.map(d=>function(m){return{field:__PRIVATE_toFieldPathReference(m.field),direction:__PRIVATE_toDirection(m.dir)}}(d))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const l=__PRIVATE_toInt32Proto(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{gt:r,parent:s}}function __PRIVATE_convertQueryTargetToQuery(t){let e=__PRIVATE_fromQueryPath(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){__PRIVATE_hardAssert(n===1,65062);const d=r.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let a=[];r.where&&(a=function(p){const m=__PRIVATE_fromFilter(p);return m instanceof CompositeFilter&&__PRIVATE_compositeFilterIsFlatConjunction(m)?m.getFilters():[m]}(r.where));let o=[];r.orderBy&&(o=function(p){return p.map(m=>function(b){return new OrderBy(__PRIVATE_fromFieldPathReference(b.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(m))}(r.orderBy));let l=null;r.limit&&(l=function(p){let m;return m=typeof p=="object"?p.value:p,__PRIVATE_isNullOrUndefined(m)?null:m}(r.limit));let u=null;r.startAt&&(u=function(p){const m=!!p.before,y=p.values||[];return new Bound(y,m)}(r.startAt));let c=null;return r.endAt&&(c=function(p){const m=!p.before,y=p.values||[];return new Bound(y,m)}(r.endAt)),__PRIVATE_newQuery(e,s,o,a,l,"F",u,c)}function __PRIVATE_toListenRequestLabels(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return fail(28987,{purpose:s})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function __PRIVATE_fromFilter(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=__PRIVATE_fromFieldPathReference(r.unaryFilter.field);return FieldFilter.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=__PRIVATE_fromFieldPathReference(r.unaryFilter.field);return FieldFilter.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=__PRIVATE_fromFieldPathReference(r.unaryFilter.field);return FieldFilter.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=__PRIVATE_fromFieldPathReference(r.unaryFilter.field);return FieldFilter.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return fail(61313);default:return fail(60726)}}(t):t.fieldFilter!==void 0?function(r){return FieldFilter.create(__PRIVATE_fromFieldPathReference(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return fail(58110);default:return fail(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return CompositeFilter.create(r.compositeFilter.filters.map(n=>__PRIVATE_fromFilter(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return fail(1026)}}(r.compositeFilter.op))}(t):fail(30097,{filter:t})}function __PRIVATE_toDirection(t){return wt[t]}function __PRIVATE_toOperatorName(t){return St[t]}function __PRIVATE_toCompositeOperatorName(t){return bt[t]}function __PRIVATE_toFieldPathReference(t){return{fieldPath:t.canonicalString()}}function __PRIVATE_fromFieldPathReference(t){return FieldPath$1.fromServerFormat(t.fieldPath)}function __PRIVATE_toFilter(t){return t instanceof FieldFilter?function(r){if(r.op==="=="){if(__PRIVATE_isNanValue(r.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(r.field),op:"IS_NAN"}};if(__PRIVATE_isNullValue(r.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(__PRIVATE_isNanValue(r.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(r.field),op:"IS_NOT_NAN"}};if(__PRIVATE_isNullValue(r.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:__PRIVATE_toFieldPathReference(r.field),op:__PRIVATE_toOperatorName(r.op),value:r.value}}}(t):t instanceof CompositeFilter?function(r){const n=r.getFilters().map(s=>__PRIVATE_toFilter(s));return n.length===1?n[0]:{compositeFilter:{op:__PRIVATE_toCompositeOperatorName(r.op),filters:n}}}(t):fail(54877,{filter:t})}function __PRIVATE_toDocumentMask(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function __PRIVATE_isValidResourceName(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TargetData{constructor(e,r,n,s,a=SnapshotVersion.min(),o=SnapshotVersion.min(),l=ByteString.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new TargetData(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_LocalSerializer{constructor(e){this.wt=e}}function __PRIVATE_fromBundledQuery(t){const e=__PRIVATE_convertQueryTargetToQuery({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?__PRIVATE_queryWithLimit(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryIndexManager{constructor(){this.Cn=new __PRIVATE_MemoryCollectionParentIndex}addToCollectionParentIndex(e,r){return this.Cn.add(r),PersistencePromise.resolve()}getCollectionParents(e,r){return PersistencePromise.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return PersistencePromise.resolve()}deleteFieldIndex(e,r){return PersistencePromise.resolve()}deleteAllFieldIndexes(e){return PersistencePromise.resolve()}createTargetIndexes(e,r){return PersistencePromise.resolve()}getDocumentsMatchingTarget(e,r){return PersistencePromise.resolve(null)}getIndexType(e,r){return PersistencePromise.resolve(0)}getFieldIndexes(e,r){return PersistencePromise.resolve([])}getNextCollectionGroupToUpdate(e){return PersistencePromise.resolve(null)}getMinOffset(e,r){return PersistencePromise.resolve(IndexOffset.min())}getMinOffsetFromCollectionGroup(e,r){return PersistencePromise.resolve(IndexOffset.min())}updateCollectionGroup(e,r,n){return PersistencePromise.resolve()}updateIndexEntries(e,r){return PersistencePromise.resolve()}}class __PRIVATE_MemoryCollectionParentIndex{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new SortedSet(ResourcePath.comparator),a=!s.has(n);return this.index[r]=s.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new SortedSet(ResourcePath.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ft={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Mt=41943040;class LruParams{static withCacheSize(e){return new LruParams(e,LruParams.DEFAULT_COLLECTION_PERCENTILE,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */LruParams.DEFAULT_COLLECTION_PERCENTILE=10,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,LruParams.DEFAULT=new LruParams(Mt,LruParams.DEFAULT_COLLECTION_PERCENTILE,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),LruParams.DISABLED=new LruParams(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_TargetIdGenerator{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new __PRIVATE_TargetIdGenerator(0)}static lr(){return new __PRIVATE_TargetIdGenerator(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xt="LruGarbageCollector",Ot=1048576;function __PRIVATE_bufferEntryComparator([t,e],[r,n]){const s=__PRIVATE_primitiveComparator(t,r);return s===0?__PRIVATE_primitiveComparator(e,n):s}class __PRIVATE_RollingSequenceNumberBuffer{constructor(e){this.Er=e,this.buffer=new SortedSet(__PRIVATE_bufferEntryComparator),this.dr=0}Ar(){return++this.dr}Rr(e){const r=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();__PRIVATE_bufferEntryComparator(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class __PRIVATE_LruScheduler{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){__PRIVATE_logDebug(xt,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){__PRIVATE_isIndexedDbTransactionError(r)?__PRIVATE_logDebug(xt,"Ignoring IndexedDB error during garbage collection: ",r):await __PRIVATE_ignoreIfPrimaryLeaseLoss(r)}await this.mr(3e5)})}}class __PRIVATE_LruGarbageCollectorImpl{constructor(e,r){this.gr=e,this.params=r}calculateTargetCount(e,r){return this.gr.pr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return PersistencePromise.resolve(__PRIVATE_ListenSequence.le);const n=new __PRIVATE_RollingSequenceNumberBuffer(r);return this.gr.forEachTarget(e,s=>n.Rr(s.sequenceNumber)).next(()=>this.gr.yr(e,s=>n.Rr(s))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.gr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.gr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(__PRIVATE_logDebug("LruGarbageCollector","Garbage collection skipped; disabled"),PersistencePromise.resolve(Ft)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(__PRIVATE_logDebug("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ft):this.wr(e,r))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,r){let n,s,a,o,l,u,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(__PRIVATE_logDebug("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),s=this.params.maximumSequenceNumbersToCollect):s=p,o=Date.now(),this.nthSequenceNumber(e,s))).next(p=>(n=p,l=Date.now(),this.removeTargets(e,n,r))).next(p=>(a=p,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(p=>(c=Date.now(),__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${a} targets in `+(u-l)+`ms
	Removed ${p} documents in `+(c-u)+`ms
Total Duration: ${c-d}ms`),PersistencePromise.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:p})))}}function __PRIVATE_newLruGarbageCollector(t,e){return new __PRIVATE_LruGarbageCollectorImpl(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RemoteDocumentChangeBuffer{constructor(){this.changes=new ObjectMap(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,MutableDocument.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?PersistencePromise.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OverlayedDocument{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LocalDocumentsView{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&__PRIVATE_mutationApplyToLocalView(n.mutation,s,FieldMask.empty(),Timestamp.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,__PRIVATE_documentKeySet()).next(()=>n))}getLocalViewOfDocuments(e,r,n=__PRIVATE_documentKeySet()){const s=__PRIVATE_newOverlayMap();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(a=>{let o=documentMap();return a.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=__PRIVATE_newOverlayMap();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,__PRIVATE_documentKeySet()))}populateOverlays(e,r,n){const s=[];return n.forEach(a=>{r.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(e,s).next(a=>{a.forEach((o,l)=>{r.set(o,l)})})}computeViews(e,r,n,s){let a=__PRIVATE_mutableDocumentMap();const o=__PRIVATE_newDocumentKeyMap(),l=function(){return __PRIVATE_newDocumentKeyMap()}();return r.forEach((u,c)=>{const d=n.get(c.key);s.has(c.key)&&(d===void 0||d.mutation instanceof __PRIVATE_PatchMutation)?a=a.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),__PRIVATE_mutationApplyToLocalView(d.mutation,c,d.mutation.getFieldMask(),Timestamp.now())):o.set(c.key,FieldMask.empty())}),this.recalculateAndSaveOverlays(e,a).next(u=>(u.forEach((c,d)=>o.set(c,d)),r.forEach((c,d)=>{var p;return l.set(c,new OverlayedDocument(d,(p=o.get(c))!==null&&p!==void 0?p:null))}),l))}recalculateAndSaveOverlays(e,r){const n=__PRIVATE_newDocumentKeyMap();let s=new SortedMap((o,l)=>o-l),a=__PRIVATE_documentKeySet();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const l of o)l.keys().forEach(u=>{const c=r.get(u);if(c===null)return;let d=n.get(u)||FieldMask.empty();d=l.applyToLocalView(c,d),n.set(u,d);const p=(s.get(l.batchId)||__PRIVATE_documentKeySet()).add(u);s=s.insert(l.batchId,p)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),c=u.key,d=u.value,p=__PRIVATE_newMutationMap();d.forEach(m=>{if(!a.has(m)){const y=__PRIVATE_calculateOverlayMutation(r.get(m),n.get(m));y!==null&&p.set(m,y),a=a.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,p))}return PersistencePromise.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(o){return DocumentKey.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):__PRIVATE_isCollectionGroupQuery(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(a=>{const o=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-a.size):PersistencePromise.resolve(__PRIVATE_newOverlayMap());let l=Q,u=a;return o.next(c=>PersistencePromise.forEach(c,(d,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),a.get(d)?PersistencePromise.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{u=u.insert(d,m)}))).next(()=>this.populateOverlays(e,c,a)).next(()=>this.computeViews(e,u,c,__PRIVATE_documentKeySet())).next(d=>({batchId:l,changes:__PRIVATE_convertOverlayedDocumentMapToDocumentMap(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new DocumentKey(r)).next(n=>{let s=documentMap();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const a=r.collectionGroup;let o=documentMap();return this.indexManager.getCollectionParents(e,a).next(l=>PersistencePromise.forEach(l,u=>{const c=function(p,m){return new __PRIVATE_QueryImpl(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(r,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,c,n,s).next(d=>{d.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,s))).next(o=>{a.forEach((u,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,MutableDocument.newInvalidDocument(d)))});let l=documentMap();return o.forEach((u,c)=>{const d=a.get(u);d!==void 0&&__PRIVATE_mutationApplyToLocalView(d.mutation,c,FieldMask.empty(),Timestamp.now()),__PRIVATE_queryMatches(r,c)&&(l=l.insert(u,c))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryBundleCache{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,r){return PersistencePromise.resolve(this.kr.get(r))}saveBundleMetadata(e,r){return this.kr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:__PRIVATE_fromVersion(s.createTime)}}(r)),PersistencePromise.resolve()}getNamedQuery(e,r){return PersistencePromise.resolve(this.qr.get(r))}saveNamedQuery(e,r){return this.qr.set(r.name,function(s){return{name:s.name,query:__PRIVATE_fromBundledQuery(s.bundledQuery),readTime:__PRIVATE_fromVersion(s.readTime)}}(r)),PersistencePromise.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryDocumentOverlayCache{constructor(){this.overlays=new SortedMap(DocumentKey.comparator),this.Qr=new Map}getOverlay(e,r){return PersistencePromise.resolve(this.overlays.get(r))}getOverlays(e,r){const n=__PRIVATE_newOverlayMap();return PersistencePromise.forEach(r,s=>this.getOverlay(e,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,a)=>{this.bt(e,r,a)}),PersistencePromise.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Qr.get(n);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.Qr.delete(n)),PersistencePromise.resolve()}getOverlaysForCollection(e,r,n){const s=__PRIVATE_newOverlayMap(),a=r.length+1,o=new DocumentKey(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,c=u.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===a&&u.largestBatchId>n&&s.set(u.getKey(),u)}return PersistencePromise.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let a=new SortedMap((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let d=a.get(c.largestBatchId);d===null&&(d=__PRIVATE_newOverlayMap(),a=a.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const l=__PRIVATE_newOverlayMap(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,d)=>l.set(c,d)),!(l.size()>=s)););return PersistencePromise.resolve(l)}bt(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.Qr.get(s.largestBatchId).delete(n.key);this.Qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new Overlay(r,n));let a=this.Qr.get(r);a===void 0&&(a=__PRIVATE_documentKeySet(),this.Qr.set(r,a)),this.Qr.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryGlobalsCache{constructor(){this.sessionToken=ByteString.EMPTY_BYTE_STRING}getSessionToken(e){return PersistencePromise.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,PersistencePromise.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ReferenceSet{constructor(){this.$r=new SortedSet(__PRIVATE_DocReference.Ur),this.Kr=new SortedSet(__PRIVATE_DocReference.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,r){const n=new __PRIVATE_DocReference(e,r);this.$r=this.$r.add(n),this.Kr=this.Kr.add(n)}Gr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.zr(new __PRIVATE_DocReference(e,r))}jr(e,r){e.forEach(n=>this.removeReference(n,r))}Hr(e){const r=new DocumentKey(new ResourcePath([])),n=new __PRIVATE_DocReference(r,e),s=new __PRIVATE_DocReference(r,e+1),a=[];return this.Kr.forEachInRange([n,s],o=>{this.zr(o),a.push(o.key)}),a}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const r=new DocumentKey(new ResourcePath([])),n=new __PRIVATE_DocReference(r,e),s=new __PRIVATE_DocReference(r,e+1);let a=__PRIVATE_documentKeySet();return this.Kr.forEachInRange([n,s],o=>{a=a.add(o.key)}),a}containsKey(e){const r=new __PRIVATE_DocReference(e,0),n=this.$r.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class __PRIVATE_DocReference{constructor(e,r){this.key=e,this.Zr=r}static Ur(e,r){return DocumentKey.comparator(e.key,r.key)||__PRIVATE_primitiveComparator(e.Zr,r.Zr)}static Wr(e,r){return __PRIVATE_primitiveComparator(e.Zr,r.Zr)||DocumentKey.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryMutationQueue{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.nr=1,this.Xr=new SortedSet(__PRIVATE_DocReference.Ur)}checkEmpty(e){return PersistencePromise.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const a=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new MutationBatch(a,r,n,s);this.mutationQueue.push(o);for(const l of s)this.Xr=this.Xr.add(new __PRIVATE_DocReference(l.key,a)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return PersistencePromise.resolve(o)}lookupMutationBatch(e,r){return PersistencePromise.resolve(this.ei(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.ti(n),a=s<0?0:s;return PersistencePromise.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return PersistencePromise.resolve(this.mutationQueue.length===0?G:this.nr-1)}getAllMutationBatches(e){return PersistencePromise.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new __PRIVATE_DocReference(r,0),s=new __PRIVATE_DocReference(r,Number.POSITIVE_INFINITY),a=[];return this.Xr.forEachInRange([n,s],o=>{const l=this.ei(o.Zr);a.push(l)}),PersistencePromise.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new SortedSet(__PRIVATE_primitiveComparator);return r.forEach(s=>{const a=new __PRIVATE_DocReference(s,0),o=new __PRIVATE_DocReference(s,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([a,o],l=>{n=n.add(l.Zr)})}),PersistencePromise.resolve(this.ni(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let a=n;DocumentKey.isDocumentKey(a)||(a=a.child(""));const o=new __PRIVATE_DocReference(new DocumentKey(a),0);let l=new SortedSet(__PRIVATE_primitiveComparator);return this.Xr.forEachWhile(u=>{const c=u.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(l=l.add(u.Zr)),!0)},o),PersistencePromise.resolve(this.ni(l))}ni(e){const r=[];return e.forEach(n=>{const s=this.ei(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){__PRIVATE_hardAssert(this.ri(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Xr;return PersistencePromise.forEach(r.mutations,s=>{const a=new __PRIVATE_DocReference(s.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Xr=n})}sr(e){}containsKey(e,r){const n=new __PRIVATE_DocReference(r,0),s=this.Xr.firstAfterOrEqual(n);return PersistencePromise.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,PersistencePromise.resolve()}ri(e,r){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const r=this.ti(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryRemoteDocumentCacheImpl{constructor(e){this.ii=e,this.docs=function(){return new SortedMap(DocumentKey.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),a=s?s.size:0,o=this.ii(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return PersistencePromise.resolve(n?n.document.mutableCopy():MutableDocument.newInvalidDocument(r))}getEntries(e,r){let n=__PRIVATE_mutableDocumentMap();return r.forEach(s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():MutableDocument.newInvalidDocument(s))}),PersistencePromise.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let a=__PRIVATE_mutableDocumentMap();const o=r.path,l=new DocumentKey(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:c,value:{document:d}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||__PRIVATE_indexOffsetComparator(__PRIVATE_newIndexOffsetFromDocument(d),n)<=0||(s.has(d.key)||__PRIVATE_queryMatches(r,d))&&(a=a.insert(d.key,d.mutableCopy()))}return PersistencePromise.resolve(a)}getAllFromCollectionGroup(e,r,n,s){fail(9500)}si(e,r){return PersistencePromise.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new __PRIVATE_MemoryRemoteDocumentChangeBuffer(this)}getSize(e){return PersistencePromise.resolve(this.size)}}class __PRIVATE_MemoryRemoteDocumentChangeBuffer extends RemoteDocumentChangeBuffer{constructor(e){super(),this.Br=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.Br.addEntry(e,s)):this.Br.removeEntry(n)}),PersistencePromise.waitFor(r)}getFromCache(e,r){return this.Br.getEntry(e,r)}getAllFromCache(e,r){return this.Br.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryTargetCache{constructor(e){this.persistence=e,this.oi=new ObjectMap(r=>__PRIVATE_canonifyTarget(r),__PRIVATE_targetEquals),this.lastRemoteSnapshotVersion=SnapshotVersion.min(),this.highestTargetId=0,this._i=0,this.ai=new __PRIVATE_ReferenceSet,this.targetCount=0,this.ui=__PRIVATE_TargetIdGenerator.cr()}forEachTarget(e,r){return this.oi.forEach((n,s)=>r(s)),PersistencePromise.resolve()}getLastRemoteSnapshotVersion(e){return PersistencePromise.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return PersistencePromise.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),PersistencePromise.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this._i&&(this._i=r),PersistencePromise.resolve()}Tr(e){this.oi.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ui=new __PRIVATE_TargetIdGenerator(r),this.highestTargetId=r),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,r){return this.Tr(r),this.targetCount+=1,PersistencePromise.resolve()}updateTargetData(e,r){return this.Tr(r),PersistencePromise.resolve()}removeTargetData(e,r){return this.oi.delete(r.target),this.ai.Hr(r.targetId),this.targetCount-=1,PersistencePromise.resolve()}removeTargets(e,r,n){let s=0;const a=[];return this.oi.forEach((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.oi.delete(o),a.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),PersistencePromise.waitFor(a).next(()=>s)}getTargetCount(e){return PersistencePromise.resolve(this.targetCount)}getTargetData(e,r){const n=this.oi.get(r)||null;return PersistencePromise.resolve(n)}addMatchingKeys(e,r,n){return this.ai.Gr(r,n),PersistencePromise.resolve()}removeMatchingKeys(e,r,n){this.ai.jr(r,n);const s=this.persistence.referenceDelegate,a=[];return s&&r.forEach(o=>{a.push(s.markPotentiallyOrphaned(e,o))}),PersistencePromise.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this.ai.Hr(r),PersistencePromise.resolve()}getMatchingKeysForTargetId(e,r){const n=this.ai.Yr(r);return PersistencePromise.resolve(n)}containsKey(e,r){return PersistencePromise.resolve(this.ai.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryPersistence{constructor(e,r){this.ci={},this.overlays={},this.li=new __PRIVATE_ListenSequence(0),this.hi=!1,this.hi=!0,this.Pi=new __PRIVATE_MemoryGlobalsCache,this.referenceDelegate=e(this),this.Ti=new __PRIVATE_MemoryTargetCache(this),this.indexManager=new __PRIVATE_MemoryIndexManager,this.remoteDocumentCache=function(s){return new __PRIVATE_MemoryRemoteDocumentCacheImpl(s)}(n=>this.referenceDelegate.Ii(n)),this.serializer=new __PRIVATE_LocalSerializer(r),this.Ei=new __PRIVATE_MemoryBundleCache(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new __PRIVATE_MemoryDocumentOverlayCache,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ci[e.toKey()];return n||(n=new __PRIVATE_MemoryMutationQueue(r,this.referenceDelegate),this.ci[e.toKey()]=n),n}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,r,n){__PRIVATE_logDebug("MemoryPersistence","Starting transaction:",e);const s=new __PRIVATE_MemoryTransaction(this.li.next());return this.referenceDelegate.di(),n(s).next(a=>this.referenceDelegate.Ai(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Ri(e,r){return PersistencePromise.or(Object.values(this.ci).map(n=>()=>n.containsKey(e,r)))}}class __PRIVATE_MemoryTransaction extends PersistenceTransaction{constructor(e){super(),this.currentSequenceNumber=e}}class __PRIVATE_MemoryEagerDelegate{constructor(e){this.persistence=e,this.Vi=new __PRIVATE_ReferenceSet,this.mi=null}static fi(e){return new __PRIVATE_MemoryEagerDelegate(e)}get gi(){if(this.mi)return this.mi;throw fail(60996)}addReference(e,r,n){return this.Vi.addReference(n,r),this.gi.delete(n.toString()),PersistencePromise.resolve()}removeReference(e,r,n){return this.Vi.removeReference(n,r),this.gi.add(n.toString()),PersistencePromise.resolve()}markPotentiallyOrphaned(e,r){return this.gi.add(r.toString()),PersistencePromise.resolve()}removeTarget(e,r){this.Vi.Hr(r.targetId).forEach(s=>this.gi.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(a=>this.gi.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}di(){this.mi=new Set}Ai(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return PersistencePromise.forEach(this.gi,n=>{const s=DocumentKey.fromPath(n);return this.pi(e,s).next(a=>{a||r.removeEntry(s,SnapshotVersion.min())})}).next(()=>(this.mi=null,r.apply(e)))}updateLimboDocument(e,r){return this.pi(e,r).next(n=>{n?this.gi.delete(r.toString()):this.gi.add(r.toString())})}Ii(e){return 0}pi(e,r){return PersistencePromise.or([()=>PersistencePromise.resolve(this.Vi.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ri(e,r)])}}class __PRIVATE_MemoryLruDelegate{constructor(e,r){this.persistence=e,this.yi=new ObjectMap(n=>__PRIVATE_encodeResourcePath(n.path),(n,s)=>n.isEqual(s)),this.garbageCollector=__PRIVATE_newLruGarbageCollector(this,r)}static fi(e,r){return new __PRIVATE_MemoryLruDelegate(e,r)}di(){}Ai(e){return PersistencePromise.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}pr(e){const r=this.Sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(s=>n+s))}Sr(e){let r=0;return this.yr(e,n=>{r++}).next(()=>r)}yr(e,r){return PersistencePromise.forEach(this.yi,(n,s)=>this.Dr(e,n,s).next(a=>a?PersistencePromise.resolve():r(s)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.si(e,o=>this.Dr(e,o,r).next(l=>{l||(n++,a.removeEntry(o,SnapshotVersion.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.yi.set(r,e.currentSequenceNumber),PersistencePromise.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.yi.set(n,e.currentSequenceNumber),PersistencePromise.resolve()}removeReference(e,r,n){return this.yi.set(n,e.currentSequenceNumber),PersistencePromise.resolve()}updateLimboDocument(e,r){return this.yi.set(r,e.currentSequenceNumber),PersistencePromise.resolve()}Ii(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=__PRIVATE_estimateByteSize(e.data.value)),r}Dr(e,r,n){return PersistencePromise.or([()=>this.persistence.Ri(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const s=this.yi.get(r);return PersistencePromise.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_LocalViewChanges{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.ds=n,this.As=s}static Rs(e,r){let n=__PRIVATE_documentKeySet(),s=__PRIVATE_documentKeySet();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new __PRIVATE_LocalViewChanges(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QueryContext{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryEngine{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return isSafari()?8:__PRIVATE_getAndroidVersion(getUA())>0?6:4}()}initialize(e,r){this.ys=e,this.indexManager=r,this.Vs=!0}getDocumentsMatchingQuery(e,r,n,s){const a={result:null};return this.ws(e,r).next(o=>{a.result=o}).next(()=>{if(!a.result)return this.Ss(e,r,s,n).next(o=>{a.result=o})}).next(()=>{if(a.result)return;const o=new QueryContext;return this.bs(e,r,o).next(l=>{if(a.result=l,this.fs)return this.Ds(e,r,o,l.size)})}).next(()=>a.result)}Ds(e,r,n,s){return n.documentReadCount<this.gs?(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","SDK will not create cache indexes for query:",__PRIVATE_stringifyQuery(r),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),PersistencePromise.resolve()):(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Query:",__PRIVATE_stringifyQuery(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.ps*s?(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","The SDK decides to create cache indexes for query:",__PRIVATE_stringifyQuery(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,__PRIVATE_queryToTarget(r))):PersistencePromise.resolve())}ws(e,r){if(__PRIVATE_queryMatchesAllDocuments(r))return PersistencePromise.resolve(null);let n=__PRIVATE_queryToTarget(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=__PRIVATE_queryWithLimit(r,null,"F"),n=__PRIVATE_queryToTarget(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const o=__PRIVATE_documentKeySet(...a);return this.ys.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(u=>{const c=this.vs(r,l);return this.Cs(r,c,o,u.readTime)?this.ws(e,__PRIVATE_queryWithLimit(r,null,"F")):this.Fs(e,c,r,u)}))})))}Ss(e,r,n,s){return __PRIVATE_queryMatchesAllDocuments(r)||s.isEqual(SnapshotVersion.min())?PersistencePromise.resolve(null):this.ys.getDocuments(e,n).next(a=>{const o=this.vs(r,a);return this.Cs(r,o,n,s)?PersistencePromise.resolve(null):(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),__PRIVATE_stringifyQuery(r)),this.Fs(e,o,r,__PRIVATE_newIndexOffsetSuccessorFromReadTime(s,Q)).next(l=>l))})}vs(e,r){let n=new SortedSet(__PRIVATE_newQueryComparator(e));return r.forEach((s,a)=>{__PRIVATE_queryMatches(e,a)&&(n=n.add(a))}),n}Cs(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}bs(e,r,n){return __PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Using full collection scan to execute query:",__PRIVATE_stringifyQuery(r)),this.ys.getDocumentsMatchingQuery(e,r,IndexOffset.min(),n)}Fs(e,r,n,s){return this.ys.getDocumentsMatchingQuery(e,n,s).next(a=>(r.forEach(o=>{a=a.insert(o.key,o)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qt="LocalStore",$t=3e8;class __PRIVATE_LocalStoreImpl{constructor(e,r,n,s){this.persistence=e,this.Ms=r,this.serializer=s,this.xs=new SortedMap(__PRIVATE_primitiveComparator),this.Os=new ObjectMap(a=>__PRIVATE_canonifyTarget(a),__PRIVATE_targetEquals),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(n)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new LocalDocumentsView(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.xs))}}function __PRIVATE_newLocalStore(t,e,r,n){return new __PRIVATE_LocalStoreImpl(t,e,r,n)}async function __PRIVATE_localStoreHandleUserChange(t,e){const r=__PRIVATE_debugCast(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(a=>(s=a,r.Ls(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const o=[],l=[];let u=__PRIVATE_documentKeySet();for(const c of s){o.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}for(const c of a){l.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}return r.localDocuments.getDocuments(n,u).next(c=>({ks:c,removedBatchIds:o,addedBatchIds:l}))})})}function __PRIVATE_localStoreAcknowledgeBatch(t,e){const r=__PRIVATE_debugCast(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),a=r.Bs.newChangeBuffer({trackRemovals:!0});return function(l,u,c,d){const p=c.batch,m=p.keys();let y=PersistencePromise.resolve();return m.forEach(b=>{y=y.next(()=>d.getEntry(u,b)).next(E=>{const T=c.docVersions.get(b);__PRIVATE_hardAssert(T!==null,48541),E.version.compareTo(T)<0&&(p.applyToRemoteDocument(E,c),E.isValidDocument()&&(E.setReadTime(c.commitVersion),d.addEntry(E)))})}),y.next(()=>l.mutationQueue.removeMutationBatch(u,p))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let u=__PRIVATE_documentKeySet();for(let c=0;c<l.mutationResults.length;++c)l.mutationResults[c].transformResults.length>0&&(u=u.add(l.batch.mutations[c].key));return u}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function __PRIVATE_localStoreGetLastRemoteSnapshotVersion(t){const e=__PRIVATE_debugCast(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ti.getLastRemoteSnapshotVersion(r))}function __PRIVATE_localStoreApplyRemoteEventToLocalCache(t,e){const r=__PRIVATE_debugCast(t),n=e.snapshotVersion;let s=r.xs;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const o=r.Bs.newChangeBuffer({trackRemovals:!0});s=r.xs;const l=[];e.targetChanges.forEach((d,p)=>{const m=s.get(p);if(!m)return;l.push(r.Ti.removeMatchingKeys(a,d.removedDocuments,p).next(()=>r.Ti.addMatchingKeys(a,d.addedDocuments,p)));let y=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(p)!==null?y=y.withResumeToken(ByteString.EMPTY_BYTE_STRING,SnapshotVersion.min()).withLastLimboFreeSnapshotVersion(SnapshotVersion.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,n)),s=s.insert(p,y),function(E,T,S){return E.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=$t?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(m,y,d)&&l.push(r.Ti.updateTargetData(a,y))});let u=__PRIVATE_mutableDocumentMap(),c=__PRIVATE_documentKeySet();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(a,d))}),l.push(__PRIVATE_populateDocumentChangeBuffer(a,o,e.documentUpdates).next(d=>{u=d.qs,c=d.Qs})),!n.isEqual(SnapshotVersion.min())){const d=r.Ti.getLastRemoteSnapshotVersion(a).next(p=>r.Ti.setTargetsMetadata(a,a.currentSequenceNumber,n));l.push(d)}return PersistencePromise.waitFor(l).next(()=>o.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,u,c)).next(()=>u)}).then(a=>(r.xs=s,a))}function __PRIVATE_populateDocumentChangeBuffer(t,e,r){let n=__PRIVATE_documentKeySet(),s=__PRIVATE_documentKeySet();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let o=__PRIVATE_mutableDocumentMap();return r.forEach((l,u)=>{const c=a.get(l);u.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(SnapshotVersion.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):__PRIVATE_logDebug(Qt,"Ignoring outdated watch update for ",l,". Current version:",c.version," Watch version:",u.version)}),{qs:o,Qs:s}})}function __PRIVATE_localStoreGetNextMutationBatch(t,e){const r=__PRIVATE_debugCast(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=G),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function __PRIVATE_localStoreAllocateTarget(t,e){const r=__PRIVATE_debugCast(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ti.getTargetData(n,e).next(a=>a?(s=a,PersistencePromise.resolve(s)):r.Ti.allocateTargetId(n).next(o=>(s=new TargetData(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ti.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.xs.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.xs=r.xs.insert(n.targetId,n),r.Os.set(e,n.targetId)),n})}async function __PRIVATE_localStoreReleaseTarget(t,e,r){const n=__PRIVATE_debugCast(t),s=n.xs.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,o=>n.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!__PRIVATE_isIndexedDbTransactionError(o))throw o;__PRIVATE_logDebug(Qt,`Failed to update sequence numbers for target ${e}: ${o}`)}n.xs=n.xs.remove(e),n.Os.delete(s.target)}function __PRIVATE_localStoreExecuteQuery(t,e,r){const n=__PRIVATE_debugCast(t);let s=SnapshotVersion.min(),a=__PRIVATE_documentKeySet();return n.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,d){const p=__PRIVATE_debugCast(u),m=p.Os.get(d);return m!==void 0?PersistencePromise.resolve(p.xs.get(m)):p.Ti.getTargetData(c,d)}(n,o,__PRIVATE_queryToTarget(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,n.Ti.getMatchingKeysForTargetId(o,l.targetId).next(u=>{a=u})}).next(()=>n.Ms.getDocumentsMatchingQuery(o,e,r?s:SnapshotVersion.min(),r?a:__PRIVATE_documentKeySet())).next(l=>(__PRIVATE_setMaxReadTime(n,__PRIVATE_queryCollectionGroup(e),l),{documents:l,$s:a})))}function __PRIVATE_setMaxReadTime(t,e,r){let n=t.Ns.get(e)||SnapshotVersion.min();r.forEach((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.Ns.set(e,n)}class __PRIVATE_LocalClientState{constructor(){this.activeTargetIds=__PRIVATE_targetIdSet()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class __PRIVATE_MemorySharedClientState{constructor(){this.xo=new __PRIVATE_LocalClientState,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,r,n){this.Oo[e]=r}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new __PRIVATE_LocalClientState,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_NoopConnectivityMonitor{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zt="ConnectivityMonitor";class __PRIVATE_BrowserConnectivityMonitor{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){__PRIVATE_logDebug(zt,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){__PRIVATE_logDebug(zt,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jt=null;function __PRIVATE_generateUniqueDebugId(){return jt===null?jt=function(){return 268435456+Math.round(2147483648*Math.random())}():jt++,"0x"+jt.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ht="RestConnection",Jt={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class __PRIVATE_RestConnection{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Ko=r+"://"+e.host,this.Wo=`projects/${n}/databases/${s}`,this.Go=this.databaseId.database===ut?`project_id=${n}`:`project_id=${n}&database_id=${s}`}zo(e,r,n,s,a){const o=__PRIVATE_generateUniqueDebugId(),l=this.jo(e,r.toUriEncodedString());__PRIVATE_logDebug(Ht,`Sending RPC '${e}' ${o}:`,l,n);const u={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(u,s,a);const{host:c}=new URL(l),d=isCloudWorkstation(c);return this.Jo(e,l,u,n,d).then(p=>(__PRIVATE_logDebug(Ht,`Received RPC '${e}' ${o}: `,p),p),p=>{throw __PRIVATE_logWarn(Ht,`RPC '${e}' ${o} failed with error: `,p,"url: ",l,"request:",n),p})}Yo(e,r,n,s,a,o){return this.zo(e,r,n,s,a)}Ho(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+x}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>e[a]=s),n&&n.headers.forEach((s,a)=>e[a]=s)}jo(e,r){const n=Jt[e];return`${this.Ko}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_StreamBridge{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt="WebChannelConnection";class __PRIVATE_WebChannelConnection extends __PRIVATE_RestConnection{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,s,a){const o=__PRIVATE_generateUniqueDebugId();return new Promise((l,u)=>{const c=new XhrIo;c.setWithCredentials(!0),c.listenOnce(EventType.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case ErrorCode.NO_ERROR:const p=c.getResponseJson();__PRIVATE_logDebug(Yt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),l(p);break;case ErrorCode.TIMEOUT:__PRIVATE_logDebug(Yt,`RPC '${e}' ${o} timed out`),u(new FirestoreError(N.DEADLINE_EXCEEDED,"Request time out"));break;case ErrorCode.HTTP_ERROR:const m=c.getStatus();if(__PRIVATE_logDebug(Yt,`RPC '${e}' ${o} failed with status:`,m,"response text:",c.getResponseText()),m>0){let y=c.getResponseJson();Array.isArray(y)&&(y=y[0]);const b=y==null?void 0:y.error;if(b&&b.status&&b.message){const E=function(S){const P=S.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(P)>=0?P:N.UNKNOWN}(b.status);u(new FirestoreError(E,b.message))}else u(new FirestoreError(N.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new FirestoreError(N.UNAVAILABLE,"Connection failed."));break;default:fail(9055,{l_:e,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{__PRIVATE_logDebug(Yt,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(s);__PRIVATE_logDebug(Yt,`RPC '${e}' ${o} sending request:`,s),c.send(r,"POST",d,n,15)})}T_(e,r,n){const s=__PRIVATE_generateUniqueDebugId(),a=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=createWebChannelTransport(),l=getStatEventTarget(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Ho(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const d=a.join("");__PRIVATE_logDebug(Yt,`Creating RPC '${e}' stream ${s}: ${d}`,u);const p=o.createWebChannel(d,u);let m=!1,y=!1;const b=new __PRIVATE_StreamBridge({Zo:T=>{y?__PRIVATE_logDebug(Yt,`Not sending because RPC '${e}' stream ${s} is closed:`,T):(m||(__PRIVATE_logDebug(Yt,`Opening RPC '${e}' stream ${s} transport.`),p.open(),m=!0),__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${s} sending:`,T),p.send(T))},Xo:()=>p.close()}),E=(T,S,P)=>{T.listen(S,A=>{try{P(A)}catch(I){setTimeout(()=>{throw I},0)}})};return E(p,WebChannel.EventType.OPEN,()=>{y||(__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${s} transport opened.`),b.__())}),E(p,WebChannel.EventType.CLOSE,()=>{y||(y=!0,__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${s} transport closed`),b.u_())}),E(p,WebChannel.EventType.ERROR,T=>{y||(y=!0,__PRIVATE_logWarn(Yt,`RPC '${e}' stream ${s} transport errored. Name:`,T.name,"Message:",T.message),b.u_(new FirestoreError(N.UNAVAILABLE,"The operation could not be completed")))}),E(p,WebChannel.EventType.MESSAGE,T=>{var S;if(!y){const P=T.data[0];__PRIVATE_hardAssert(!!P,16349);const A=P,I=(A==null?void 0:A.error)||((S=A[0])===null||S===void 0?void 0:S.error);if(I){__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${s} received error:`,I);const j=I.status;let K=function(ee){const ue=ft[ee];if(ue!==void 0)return __PRIVATE_mapCodeFromRpcCode(ue)}(j),W=I.message;K===void 0&&(K=N.INTERNAL,W="Unknown error status: "+j+" with message "+I.message),y=!0,b.u_(new FirestoreError(K,W)),p.close()}else __PRIVATE_logDebug(Yt,`RPC '${e}' stream ${s} received:`,P),b.c_(P)}}),E(l,Event$1.STAT_EVENT,T=>{T.stat===Stat.PROXY?__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${s} detected buffering proxy`):T.stat===Stat.NOPROXY&&__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{b.a_()},0),b}}function getDocument(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_newSerializer(t){return new JsonProtoSerializer(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ExponentialBackoff{constructor(e,r,n=1e3,s=1.5,a=6e4){this.xi=e,this.timerId=r,this.I_=n,this.E_=s,this.d_=a,this.A_=0,this.R_=null,this.V_=Date.now(),this.reset()}reset(){this.A_=0}m_(){this.A_=this.d_}f_(e){this.cancel();const r=Math.floor(this.A_+this.g_()),n=Math.max(0,Date.now()-this.V_),s=Math.max(0,r-n);s>0&&__PRIVATE_logDebug("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.A_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.R_=this.xi.enqueueAfterDelay(this.timerId,s,()=>(this.V_=Date.now(),e())),this.A_*=this.E_,this.A_<this.I_&&(this.A_=this.I_),this.A_>this.d_&&(this.A_=this.d_)}p_(){this.R_!==null&&(this.R_.skipDelay(),this.R_=null)}cancel(){this.R_!==null&&(this.R_.cancel(),this.R_=null)}g_(){return(Math.random()-.5)*this.A_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zt="PersistentStream";class __PRIVATE_PersistentStream{constructor(e,r,n,s,a,o,l,u){this.xi=e,this.y_=n,this.w_=s,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.S_=0,this.b_=null,this.D_=null,this.stream=null,this.v_=0,this.C_=new __PRIVATE_ExponentialBackoff(e,r)}F_(){return this.state===1||this.state===5||this.M_()}M_(){return this.state===2||this.state===3}start(){this.v_=0,this.state!==4?this.auth():this.x_()}async stop(){this.F_()&&await this.close(0)}O_(){this.state=0,this.C_.reset()}N_(){this.M_()&&this.b_===null&&(this.b_=this.xi.enqueueAfterDelay(this.y_,6e4,()=>this.B_()))}L_(e){this.k_(),this.stream.send(e)}async B_(){if(this.M_())return this.close(0)}k_(){this.b_&&(this.b_.cancel(),this.b_=null)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}async close(e,r){this.k_(),this.q_(),this.C_.cancel(),this.S_++,e!==4?this.C_.reset():r&&r.code===N.RESOURCE_EXHAUSTED?(__PRIVATE_logError(r.toString()),__PRIVATE_logError("Using maximum backoff delay to prevent overloading the backend."),this.C_.m_()):r&&r.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Q_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(r)}Q_(){}auth(){this.state=1;const e=this.U_(this.S_),r=this.S_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.S_===r&&this.K_(n,s)},n=>{e(()=>{const s=new FirestoreError(N.UNKNOWN,"Fetching auth token failed: "+n.message);return this.W_(s)})})}K_(e,r){const n=this.U_(this.S_);this.stream=this.G_(e,r),this.stream.e_(()=>{n(()=>this.listener.e_())}),this.stream.n_(()=>{n(()=>(this.state=2,this.D_=this.xi.enqueueAfterDelay(this.w_,1e4,()=>(this.M_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(s=>{n(()=>this.W_(s))}),this.stream.onMessage(s=>{n(()=>++this.v_==1?this.z_(s):this.onNext(s))})}x_(){this.state=5,this.C_.f_(async()=>{this.state=0,this.start()})}W_(e){return __PRIVATE_logDebug(Zt,`close with error: ${e}`),this.stream=null,this.close(4,e)}U_(e){return r=>{this.xi.enqueueAndForget(()=>this.S_===e?r():(__PRIVATE_logDebug(Zt,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class __PRIVATE_PersistentListenStream extends __PRIVATE_PersistentStream{constructor(e,r,n,s,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,o),this.serializer=a}G_(e,r){return this.connection.T_("Listen",e,r)}z_(e){return this.onNext(e)}onNext(e){this.C_.reset();const r=__PRIVATE_fromWatchChange(this.serializer,e),n=function(a){if(!("targetChange"in a))return SnapshotVersion.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?SnapshotVersion.min():o.readTime?__PRIVATE_fromVersion(o.readTime):SnapshotVersion.min()}(e);return this.listener.j_(r,n)}H_(e){const r={};r.database=__PRIVATE_getEncodedDatabaseId(this.serializer),r.addTarget=function(a,o){let l;const u=o.target;if(l=__PRIVATE_targetIsDocumentTarget(u)?{documents:__PRIVATE_toDocumentsTarget(a,u)}:{query:__PRIVATE_toQueryTarget(a,u).gt},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=__PRIVATE_toBytes(a,o.resumeToken);const c=__PRIVATE_toInt32Proto(a,o.expectedCount);c!==null&&(l.expectedCount=c)}else if(o.snapshotVersion.compareTo(SnapshotVersion.min())>0){l.readTime=toTimestamp(a,o.snapshotVersion.toTimestamp());const c=__PRIVATE_toInt32Proto(a,o.expectedCount);c!==null&&(l.expectedCount=c)}return l}(this.serializer,e);const n=__PRIVATE_toListenRequestLabels(this.serializer,e);n&&(r.labels=n),this.L_(r)}J_(e){const r={};r.database=__PRIVATE_getEncodedDatabaseId(this.serializer),r.removeTarget=e,this.L_(r)}}class __PRIVATE_PersistentWriteStream extends __PRIVATE_PersistentStream{constructor(e,r,n,s,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,o),this.serializer=a}get Y_(){return this.v_>0}start(){this.lastStreamToken=void 0,super.start()}Q_(){this.Y_&&this.Z_([])}G_(e,r){return this.connection.T_("Write",e,r)}z_(e){return __PRIVATE_hardAssert(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,__PRIVATE_hardAssert(!e.writeResults||e.writeResults.length===0,55816),this.listener.X_()}onNext(e){__PRIVATE_hardAssert(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.C_.reset();const r=__PRIVATE_fromWriteResults(e.writeResults,e.commitTime),n=__PRIVATE_fromVersion(e.commitTime);return this.listener.ea(n,r)}ta(){const e={};e.database=__PRIVATE_getEncodedDatabaseId(this.serializer),this.L_(e)}Z_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>toMutation(this.serializer,n))};this.L_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Datastore{}class __PRIVATE_DatastoreImpl extends Datastore{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.na=!1}ra(){if(this.na)throw new FirestoreError(N.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,r,n,s){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.zo(e,__PRIVATE_toResourcePath(r,n),s,a,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new FirestoreError(N.UNKNOWN,a.toString())})}Yo(e,r,n,s,a){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Yo(e,__PRIVATE_toResourcePath(r,n),s,o,l,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new FirestoreError(N.UNKNOWN,o.toString())})}terminate(){this.na=!0,this.connection.terminate()}}class __PRIVATE_OnlineStateTracker{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.ia=0,this.sa=null,this.oa=!0}_a(){this.ia===0&&(this.aa("Unknown"),this.sa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.sa=null,this.ua("Backend didn't respond within 10 seconds."),this.aa("Offline"),Promise.resolve())))}ca(e){this.state==="Online"?this.aa("Unknown"):(this.ia++,this.ia>=1&&(this.la(),this.ua(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.aa("Offline")))}set(e){this.la(),this.ia=0,e==="Online"&&(this.oa=!1),this.aa(e)}aa(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ua(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.oa?(__PRIVATE_logError(r),this.oa=!1):__PRIVATE_logDebug("OnlineStateTracker",r)}la(){this.sa!==null&&(this.sa.cancel(),this.sa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xt="RemoteStore";class __PRIVATE_RemoteStoreImpl{constructor(e,r,n,s,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.ha=[],this.Pa=new Map,this.Ta=new Set,this.Ia=[],this.Ea=a,this.Ea.No(o=>{n.enqueueAndForget(async()=>{__PRIVATE_canUseNetwork(this)&&(__PRIVATE_logDebug(Xt,"Restarting streams for network reachability change."),await async function(u){const c=__PRIVATE_debugCast(u);c.Ta.add(4),await __PRIVATE_disableNetworkInternal(c),c.da.set("Unknown"),c.Ta.delete(4),await __PRIVATE_enableNetworkInternal(c)}(this))})}),this.da=new __PRIVATE_OnlineStateTracker(n,s)}}async function __PRIVATE_enableNetworkInternal(t){if(__PRIVATE_canUseNetwork(t))for(const e of t.Ia)await e(!0)}async function __PRIVATE_disableNetworkInternal(t){for(const e of t.Ia)await e(!1)}function __PRIVATE_remoteStoreListen(t,e){const r=__PRIVATE_debugCast(t);r.Pa.has(e.targetId)||(r.Pa.set(e.targetId,e),__PRIVATE_shouldStartWatchStream(r)?__PRIVATE_startWatchStream(r):__PRIVATE_ensureWatchStream(r).M_()&&__PRIVATE_sendWatchRequest(r,e))}function __PRIVATE_remoteStoreUnlisten(t,e){const r=__PRIVATE_debugCast(t),n=__PRIVATE_ensureWatchStream(r);r.Pa.delete(e),n.M_()&&__PRIVATE_sendUnwatchRequest(r,e),r.Pa.size===0&&(n.M_()?n.N_():__PRIVATE_canUseNetwork(r)&&r.da.set("Unknown"))}function __PRIVATE_sendWatchRequest(t,e){if(t.Aa.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(SnapshotVersion.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}__PRIVATE_ensureWatchStream(t).H_(e)}function __PRIVATE_sendUnwatchRequest(t,e){t.Aa.Ke(e),__PRIVATE_ensureWatchStream(t).J_(e)}function __PRIVATE_startWatchStream(t){t.Aa=new __PRIVATE_WatchChangeAggregator({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>t.Pa.get(e)||null,Pt:()=>t.datastore.serializer.databaseId}),__PRIVATE_ensureWatchStream(t).start(),t.da._a()}function __PRIVATE_shouldStartWatchStream(t){return __PRIVATE_canUseNetwork(t)&&!__PRIVATE_ensureWatchStream(t).F_()&&t.Pa.size>0}function __PRIVATE_canUseNetwork(t){return __PRIVATE_debugCast(t).Ta.size===0}function __PRIVATE_cleanUpWatchStreamState(t){t.Aa=void 0}async function __PRIVATE_onWatchStreamConnected(t){t.da.set("Online")}async function __PRIVATE_onWatchStreamOpen(t){t.Pa.forEach((e,r)=>{__PRIVATE_sendWatchRequest(t,e)})}async function __PRIVATE_onWatchStreamClose(t,e){__PRIVATE_cleanUpWatchStreamState(t),__PRIVATE_shouldStartWatchStream(t)?(t.da.ca(e),__PRIVATE_startWatchStream(t)):t.da.set("Unknown")}async function __PRIVATE_onWatchStreamChange(t,e,r){if(t.da.set("Online"),e instanceof __PRIVATE_WatchTargetChange&&e.state===2&&e.cause)try{await async function(s,a){const o=a.cause;for(const l of a.targetIds)s.Pa.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Pa.delete(l),s.Aa.removeTarget(l))}(t,e)}catch(n){__PRIVATE_logDebug(Xt,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await __PRIVATE_disableNetworkUntilRecovery(t,n)}else if(e instanceof __PRIVATE_DocumentWatchChange?t.Aa.Xe(e):e instanceof __PRIVATE_ExistenceFilterChange?t.Aa.ot(e):t.Aa.nt(e),!r.isEqual(SnapshotVersion.min()))try{const n=await __PRIVATE_localStoreGetLastRemoteSnapshotVersion(t.localStore);r.compareTo(n)>=0&&await function(a,o){const l=a.Aa.It(o);return l.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){const d=a.Pa.get(c);d&&a.Pa.set(c,d.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,c)=>{const d=a.Pa.get(u);if(!d)return;a.Pa.set(u,d.withResumeToken(ByteString.EMPTY_BYTE_STRING,d.snapshotVersion)),__PRIVATE_sendUnwatchRequest(a,u);const p=new TargetData(d.target,u,c,d.sequenceNumber);__PRIVATE_sendWatchRequest(a,p)}),a.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){__PRIVATE_logDebug(Xt,"Failed to raise snapshot:",n),await __PRIVATE_disableNetworkUntilRecovery(t,n)}}async function __PRIVATE_disableNetworkUntilRecovery(t,e,r){if(!__PRIVATE_isIndexedDbTransactionError(e))throw e;t.Ta.add(1),await __PRIVATE_disableNetworkInternal(t),t.da.set("Offline"),r||(r=()=>__PRIVATE_localStoreGetLastRemoteSnapshotVersion(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{__PRIVATE_logDebug(Xt,"Retrying IndexedDB access"),await r(),t.Ta.delete(1),await __PRIVATE_enableNetworkInternal(t)})}function __PRIVATE_executeWithRecovery(t,e){return e().catch(r=>__PRIVATE_disableNetworkUntilRecovery(t,r,e))}async function __PRIVATE_fillWritePipeline(t){const e=__PRIVATE_debugCast(t),r=__PRIVATE_ensureWriteStream(e);let n=e.ha.length>0?e.ha[e.ha.length-1].batchId:G;for(;__PRIVATE_canAddToWritePipeline(e);)try{const s=await __PRIVATE_localStoreGetNextMutationBatch(e.localStore,n);if(s===null){e.ha.length===0&&r.N_();break}n=s.batchId,__PRIVATE_addToWritePipeline(e,s)}catch(s){await __PRIVATE_disableNetworkUntilRecovery(e,s)}__PRIVATE_shouldStartWriteStream(e)&&__PRIVATE_startWriteStream(e)}function __PRIVATE_canAddToWritePipeline(t){return __PRIVATE_canUseNetwork(t)&&t.ha.length<10}function __PRIVATE_addToWritePipeline(t,e){t.ha.push(e);const r=__PRIVATE_ensureWriteStream(t);r.M_()&&r.Y_&&r.Z_(e.mutations)}function __PRIVATE_shouldStartWriteStream(t){return __PRIVATE_canUseNetwork(t)&&!__PRIVATE_ensureWriteStream(t).F_()&&t.ha.length>0}function __PRIVATE_startWriteStream(t){__PRIVATE_ensureWriteStream(t).start()}async function __PRIVATE_onWriteStreamOpen(t){__PRIVATE_ensureWriteStream(t).ta()}async function __PRIVATE_onWriteHandshakeComplete(t){const e=__PRIVATE_ensureWriteStream(t);for(const r of t.ha)e.Z_(r.mutations)}async function __PRIVATE_onMutationResult(t,e,r){const n=t.ha.shift(),s=MutationBatchResult.from(n,e,r);await __PRIVATE_executeWithRecovery(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await __PRIVATE_fillWritePipeline(t)}async function __PRIVATE_onWriteStreamClose(t,e){e&&__PRIVATE_ensureWriteStream(t).Y_&&await async function(n,s){if(function(o){return __PRIVATE_isPermanentError(o)&&o!==N.ABORTED}(s.code)){const a=n.ha.shift();__PRIVATE_ensureWriteStream(n).O_(),await __PRIVATE_executeWithRecovery(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,s)),await __PRIVATE_fillWritePipeline(n)}}(t,e),__PRIVATE_shouldStartWriteStream(t)&&__PRIVATE_startWriteStream(t)}async function __PRIVATE_remoteStoreHandleCredentialChange(t,e){const r=__PRIVATE_debugCast(t);r.asyncQueue.verifyOperationInProgress(),__PRIVATE_logDebug(Xt,"RemoteStore received new credentials");const n=__PRIVATE_canUseNetwork(r);r.Ta.add(3),await __PRIVATE_disableNetworkInternal(r),n&&r.da.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ta.delete(3),await __PRIVATE_enableNetworkInternal(r)}async function __PRIVATE_remoteStoreApplyPrimaryState(t,e){const r=__PRIVATE_debugCast(t);e?(r.Ta.delete(2),await __PRIVATE_enableNetworkInternal(r)):e||(r.Ta.add(2),await __PRIVATE_disableNetworkInternal(r),r.da.set("Unknown"))}function __PRIVATE_ensureWatchStream(t){return t.Ra||(t.Ra=function(r,n,s){const a=__PRIVATE_debugCast(r);return a.ra(),new __PRIVATE_PersistentListenStream(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{e_:__PRIVATE_onWatchStreamConnected.bind(null,t),n_:__PRIVATE_onWatchStreamOpen.bind(null,t),i_:__PRIVATE_onWatchStreamClose.bind(null,t),j_:__PRIVATE_onWatchStreamChange.bind(null,t)}),t.Ia.push(async e=>{e?(t.Ra.O_(),__PRIVATE_shouldStartWatchStream(t)?__PRIVATE_startWatchStream(t):t.da.set("Unknown")):(await t.Ra.stop(),__PRIVATE_cleanUpWatchStreamState(t))})),t.Ra}function __PRIVATE_ensureWriteStream(t){return t.Va||(t.Va=function(r,n,s){const a=__PRIVATE_debugCast(r);return a.ra(),new __PRIVATE_PersistentWriteStream(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{e_:()=>Promise.resolve(),n_:__PRIVATE_onWriteStreamOpen.bind(null,t),i_:__PRIVATE_onWriteStreamClose.bind(null,t),X_:__PRIVATE_onWriteHandshakeComplete.bind(null,t),ea:__PRIVATE_onMutationResult.bind(null,t)}),t.Ia.push(async e=>{e?(t.Va.O_(),await __PRIVATE_fillWritePipeline(t)):(await t.Va.stop(),t.ha.length>0&&(__PRIVATE_logDebug(Xt,`Stopping write stream with ${t.ha.length} pending writes`),t.ha=[]))})),t.Va}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DelayedOperation{constructor(e,r,n,s,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new __PRIVATE_Deferred,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,a){const o=Date.now()+n,l=new DelayedOperation(e,r,o,s,a);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new FirestoreError(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function __PRIVATE_wrapInUserErrorIfRecoverable(t,e){if(__PRIVATE_logError("AsyncQueue",`${e}: ${t}`),__PRIVATE_isIndexedDbTransactionError(t))return new FirestoreError(N.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentSet{static emptySet(e){return new DocumentSet(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||DocumentKey.comparator(r.key,n.key):(r,n)=>DocumentKey.comparator(r.key,n.key),this.keyedMap=documentMap(),this.sortedSet=new SortedMap(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof DocumentSet)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new DocumentSet;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_DocumentChangeSet{constructor(){this.ma=new SortedMap(DocumentKey.comparator)}track(e){const r=e.doc.key,n=this.ma.get(r);n?e.type!==0&&n.type===3?this.ma=this.ma.insert(r,e):e.type===3&&n.type!==1?this.ma=this.ma.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ma=this.ma.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ma=this.ma.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ma=this.ma.remove(r):e.type===1&&n.type===2?this.ma=this.ma.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ma=this.ma.insert(r,{type:2,doc:e.doc}):fail(63341,{Vt:e,fa:n}):this.ma=this.ma.insert(r,e)}ga(){const e=[];return this.ma.inorderTraversal((r,n)=>{e.push(n)}),e}}class ViewSnapshot{constructor(e,r,n,s,a,o,l,u,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,s,a){const o=[];return r.forEach(l=>{o.push({type:0,doc:l})}),new ViewSnapshot(e,r,DocumentSet.emptySet(r),o,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&__PRIVATE_queryEquals(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryListenersInfo{constructor(){this.pa=void 0,this.ya=[]}wa(){return this.ya.some(e=>e.Sa())}}class __PRIVATE_EventManagerImpl{constructor(){this.queries=__PRIVATE_newQueriesObjectMap(),this.onlineState="Unknown",this.ba=new Set}terminate(){(function(r,n){const s=__PRIVATE_debugCast(r),a=s.queries;s.queries=__PRIVATE_newQueriesObjectMap(),a.forEach((o,l)=>{for(const u of l.ya)u.onError(n)})})(this,new FirestoreError(N.ABORTED,"Firestore shutting down"))}}function __PRIVATE_newQueriesObjectMap(){return new ObjectMap(t=>__PRIVATE_canonifyQuery(t),__PRIVATE_queryEquals)}async function __PRIVATE_eventManagerListen(t,e){const r=__PRIVATE_debugCast(t);let n=3;const s=e.query;let a=r.queries.get(s);a?!a.wa()&&e.Sa()&&(n=2):(a=new __PRIVATE_QueryListenersInfo,n=e.Sa()?0:1);try{switch(n){case 0:a.pa=await r.onListen(s,!0);break;case 1:a.pa=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(o){const l=__PRIVATE_wrapInUserErrorIfRecoverable(o,`Initialization of query '${__PRIVATE_stringifyQuery(e.query)}' failed`);return void e.onError(l)}r.queries.set(s,a),a.ya.push(e),e.Da(r.onlineState),a.pa&&e.va(a.pa)&&__PRIVATE_raiseSnapshotsInSyncEvent(r)}async function __PRIVATE_eventManagerUnlisten(t,e){const r=__PRIVATE_debugCast(t),n=e.query;let s=3;const a=r.queries.get(n);if(a){const o=a.ya.indexOf(e);o>=0&&(a.ya.splice(o,1),a.ya.length===0?s=e.Sa()?0:1:!a.wa()&&e.Sa()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function __PRIVATE_eventManagerOnWatchChange(t,e){const r=__PRIVATE_debugCast(t);let n=!1;for(const s of e){const a=s.query,o=r.queries.get(a);if(o){for(const l of o.ya)l.va(s)&&(n=!0);o.pa=s}}n&&__PRIVATE_raiseSnapshotsInSyncEvent(r)}function __PRIVATE_eventManagerOnWatchError(t,e,r){const n=__PRIVATE_debugCast(t),s=n.queries.get(e);if(s)for(const a of s.ya)a.onError(r);n.queries.delete(e)}function __PRIVATE_raiseSnapshotsInSyncEvent(t){t.ba.forEach(e=>{e.next()})}var en,tn;(tn=en||(en={})).Ca="default",tn.Cache="cache";class __PRIVATE_QueryListener{constructor(e,r,n){this.query=e,this.Fa=r,this.Ma=!1,this.xa=null,this.onlineState="Unknown",this.options=n||{}}va(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new ViewSnapshot(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Ma?this.Oa(e)&&(this.Fa.next(e),r=!0):this.Na(e,this.onlineState)&&(this.Ba(e),r=!0),this.xa=e,r}onError(e){this.Fa.error(e)}Da(e){this.onlineState=e;let r=!1;return this.xa&&!this.Ma&&this.Na(this.xa,e)&&(this.Ba(this.xa),r=!0),r}Na(e,r){if(!e.fromCache||!this.Sa())return!0;const n=r!=="Offline";return(!this.options.La||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Oa(e){if(e.docChanges.length>0)return!0;const r=this.xa&&this.xa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}Ba(e){e=ViewSnapshot.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Ma=!0,this.Fa.next(e)}Sa(){return this.options.source!==en.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AddedLimboDocument{constructor(e){this.key=e}}class __PRIVATE_RemovedLimboDocument{constructor(e){this.key=e}}class __PRIVATE_View{constructor(e,r){this.query=e,this.Ga=r,this.za=null,this.hasCachedResults=!1,this.current=!1,this.ja=__PRIVATE_documentKeySet(),this.mutatedKeys=__PRIVATE_documentKeySet(),this.Ha=__PRIVATE_newQueryComparator(e),this.Ja=new DocumentSet(this.Ha)}get Ya(){return this.Ga}Za(e,r){const n=r?r.Xa:new __PRIVATE_DocumentChangeSet,s=r?r.Ja:this.Ja;let a=r?r.mutatedKeys:this.mutatedKeys,o=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,p)=>{const m=s.get(d),y=__PRIVATE_queryMatches(this.query,p)?p:null,b=!!m&&this.mutatedKeys.has(m.key),E=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let T=!1;m&&y?m.data.isEqual(y.data)?b!==E&&(n.track({type:3,doc:y}),T=!0):this.eu(m,y)||(n.track({type:2,doc:y}),T=!0,(u&&this.Ha(y,u)>0||c&&this.Ha(y,c)<0)&&(l=!0)):!m&&y?(n.track({type:0,doc:y}),T=!0):m&&!y&&(n.track({type:1,doc:m}),T=!0,(u||c)&&(l=!0)),T&&(y?(o=o.add(y),a=E?a.add(d):a.delete(d)):(o=o.delete(d),a=a.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),a=a.delete(d.key),n.track({type:1,doc:d})}return{Ja:o,Xa:n,Cs:l,mutatedKeys:a}}eu(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const a=this.Ja;this.Ja=e.Ja,this.mutatedKeys=e.mutatedKeys;const o=e.Xa.ga();o.sort((d,p)=>function(y,b){const E=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fail(20277,{Vt:T})}};return E(y)-E(b)}(d.type,p.type)||this.Ha(d.doc,p.doc)),this.tu(n),s=s!=null&&s;const l=r&&!s?this.nu():[],u=this.ja.size===0&&this.current&&!s?1:0,c=u!==this.za;return this.za=u,o.length!==0||c?{snapshot:new ViewSnapshot(this.query,e.Ja,a,o,e.mutatedKeys,u===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),ru:l}:{ru:l}}Da(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ja:this.Ja,Xa:new __PRIVATE_DocumentChangeSet,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ru:[]}}iu(e){return!this.Ga.has(e)&&!!this.Ja.has(e)&&!this.Ja.get(e).hasLocalMutations}tu(e){e&&(e.addedDocuments.forEach(r=>this.Ga=this.Ga.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ga=this.Ga.delete(r)),this.current=e.current)}nu(){if(!this.current)return[];const e=this.ja;this.ja=__PRIVATE_documentKeySet(),this.Ja.forEach(n=>{this.iu(n.key)&&(this.ja=this.ja.add(n.key))});const r=[];return e.forEach(n=>{this.ja.has(n)||r.push(new __PRIVATE_RemovedLimboDocument(n))}),this.ja.forEach(n=>{e.has(n)||r.push(new __PRIVATE_AddedLimboDocument(n))}),r}su(e){this.Ga=e.$s,this.ja=__PRIVATE_documentKeySet();const r=this.Za(e.documents);return this.applyChanges(r,!0)}ou(){return ViewSnapshot.fromInitialDocuments(this.query,this.Ja,this.mutatedKeys,this.za===0,this.hasCachedResults)}}const nn="SyncEngine";class __PRIVATE_QueryView{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class LimboResolution{constructor(e){this.key=e,this._u=!1}}class __PRIVATE_SyncEngineImpl{constructor(e,r,n,s,a,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.au={},this.uu=new ObjectMap(l=>__PRIVATE_canonifyQuery(l),__PRIVATE_queryEquals),this.cu=new Map,this.lu=new Set,this.hu=new SortedMap(DocumentKey.comparator),this.Pu=new Map,this.Tu=new __PRIVATE_ReferenceSet,this.Iu={},this.Eu=new Map,this.du=__PRIVATE_TargetIdGenerator.lr(),this.onlineState="Unknown",this.Au=void 0}get isPrimaryClient(){return this.Au===!0}}async function __PRIVATE_syncEngineListen(t,e,r=!0){const n=__PRIVATE_ensureWatchCallbacks(t);let s;const a=n.uu.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.ou()):s=await __PRIVATE_allocateTargetAndMaybeListen(n,e,r,!0),s}async function __PRIVATE_triggerRemoteStoreListen(t,e){const r=__PRIVATE_ensureWatchCallbacks(t);await __PRIVATE_allocateTargetAndMaybeListen(r,e,!0,!1)}async function __PRIVATE_allocateTargetAndMaybeListen(t,e,r,n){const s=await __PRIVATE_localStoreAllocateTarget(t.localStore,__PRIVATE_queryToTarget(e)),a=s.targetId,o=t.sharedClientState.addLocalQueryTarget(a,r);let l;return n&&(l=await __PRIVATE_initializeViewAndComputeSnapshot(t,e,a,o==="current",s.resumeToken)),t.isPrimaryClient&&r&&__PRIVATE_remoteStoreListen(t.remoteStore,s),l}async function __PRIVATE_initializeViewAndComputeSnapshot(t,e,r,n,s){t.Ru=(p,m,y)=>async function(E,T,S,P){let A=T.view.Za(S);A.Cs&&(A=await __PRIVATE_localStoreExecuteQuery(E.localStore,T.query,!1).then(({documents:W})=>T.view.Za(W,A)));const I=P&&P.targetChanges.get(T.targetId),j=P&&P.targetMismatches.get(T.targetId)!=null,K=T.view.applyChanges(A,E.isPrimaryClient,I,j);return __PRIVATE_updateTrackedLimbos(E,T.targetId,K.ru),K.snapshot}(t,p,m,y);const a=await __PRIVATE_localStoreExecuteQuery(t.localStore,e,!0),o=new __PRIVATE_View(e,a.$s),l=o.Za(a.documents),u=TargetChange.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),c=o.applyChanges(l,t.isPrimaryClient,u);__PRIVATE_updateTrackedLimbos(t,r,c.ru);const d=new __PRIVATE_QueryView(e,r,o);return t.uu.set(e,d),t.cu.has(r)?t.cu.get(r).push(e):t.cu.set(r,[e]),c.snapshot}async function __PRIVATE_syncEngineUnlisten(t,e,r){const n=__PRIVATE_debugCast(t),s=n.uu.get(e),a=n.cu.get(s.targetId);if(a.length>1)return n.cu.set(s.targetId,a.filter(o=>!__PRIVATE_queryEquals(o,e))),void n.uu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await __PRIVATE_localStoreReleaseTarget(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&__PRIVATE_remoteStoreUnlisten(n.remoteStore,s.targetId),__PRIVATE_removeAndCleanupTarget(n,s.targetId)}).catch(__PRIVATE_ignoreIfPrimaryLeaseLoss)):(__PRIVATE_removeAndCleanupTarget(n,s.targetId),await __PRIVATE_localStoreReleaseTarget(n.localStore,s.targetId,!0))}async function __PRIVATE_triggerRemoteStoreUnlisten(t,e){const r=__PRIVATE_debugCast(t),n=r.uu.get(e),s=r.cu.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),__PRIVATE_remoteStoreUnlisten(r.remoteStore,n.targetId))}async function __PRIVATE_syncEngineWrite(t,e,r){const n=__PRIVATE_syncEngineEnsureWriteCallbacks(t);try{const s=await function(o,l){const u=__PRIVATE_debugCast(o),c=Timestamp.now(),d=l.reduce((y,b)=>y.add(b.key),__PRIVATE_documentKeySet());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let b=__PRIVATE_mutableDocumentMap(),E=__PRIVATE_documentKeySet();return u.Bs.getEntries(y,d).next(T=>{b=T,b.forEach((S,P)=>{P.isValidDocument()||(E=E.add(S))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,b)).next(T=>{p=T;const S=[];for(const P of l){const A=__PRIVATE_mutationExtractBaseValue(P,p.get(P.key).overlayedDocument);A!=null&&S.push(new __PRIVATE_PatchMutation(P.key,A,__PRIVATE_extractFieldMask(A.value.mapValue),Precondition.exists(!0)))}return u.mutationQueue.addMutationBatch(y,c,S,l)}).next(T=>{m=T;const S=T.applyToLocalDocumentSet(p,E);return u.documentOverlayCache.saveOverlays(y,T.batchId,S)})}).then(()=>({batchId:m.batchId,changes:__PRIVATE_convertOverlayedDocumentMapToDocumentMap(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(o,l,u){let c=o.Iu[o.currentUser.toKey()];c||(c=new SortedMap(__PRIVATE_primitiveComparator)),c=c.insert(l,u),o.Iu[o.currentUser.toKey()]=c}(n,s.batchId,r),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(n,s.changes),await __PRIVATE_fillWritePipeline(n.remoteStore)}catch(s){const a=__PRIVATE_wrapInUserErrorIfRecoverable(s,"Failed to persist write");r.reject(a)}}async function __PRIVATE_syncEngineApplyRemoteEvent(t,e){const r=__PRIVATE_debugCast(t);try{const n=await __PRIVATE_localStoreApplyRemoteEventToLocalCache(r.localStore,e);e.targetChanges.forEach((s,a)=>{const o=r.Pu.get(a);o&&(__PRIVATE_hardAssert(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o._u=!0:s.modifiedDocuments.size>0?__PRIVATE_hardAssert(o._u,14607):s.removedDocuments.size>0&&(__PRIVATE_hardAssert(o._u,42227),o._u=!1))}),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(r,n,e)}catch(n){await __PRIVATE_ignoreIfPrimaryLeaseLoss(n)}}function __PRIVATE_syncEngineApplyOnlineStateChange(t,e,r){const n=__PRIVATE_debugCast(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.uu.forEach((a,o)=>{const l=o.view.Da(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const u=__PRIVATE_debugCast(o);u.onlineState=l;let c=!1;u.queries.forEach((d,p)=>{for(const m of p.ya)m.Da(l)&&(c=!0)}),c&&__PRIVATE_raiseSnapshotsInSyncEvent(u)}(n.eventManager,e),s.length&&n.au.j_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function __PRIVATE_syncEngineRejectListen(t,e,r){const n=__PRIVATE_debugCast(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Pu.get(e),a=s&&s.key;if(a){let o=new SortedMap(DocumentKey.comparator);o=o.insert(a,MutableDocument.newNoDocument(a,SnapshotVersion.min()));const l=__PRIVATE_documentKeySet().add(a),u=new RemoteEvent(SnapshotVersion.min(),new Map,new SortedMap(__PRIVATE_primitiveComparator),o,l);await __PRIVATE_syncEngineApplyRemoteEvent(n,u),n.hu=n.hu.remove(a),n.Pu.delete(e),__PRIVATE_pumpEnqueuedLimboResolutions(n)}else await __PRIVATE_localStoreReleaseTarget(n.localStore,e,!1).then(()=>__PRIVATE_removeAndCleanupTarget(n,e,r)).catch(__PRIVATE_ignoreIfPrimaryLeaseLoss)}async function __PRIVATE_syncEngineApplySuccessfulWrite(t,e){const r=__PRIVATE_debugCast(t),n=e.batch.batchId;try{const s=await __PRIVATE_localStoreAcknowledgeBatch(r.localStore,e);__PRIVATE_processUserCallback(r,n,null),__PRIVATE_triggerPendingWritesCallbacks(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(r,s)}catch(s){await __PRIVATE_ignoreIfPrimaryLeaseLoss(s)}}async function __PRIVATE_syncEngineRejectFailedWrite(t,e,r){const n=__PRIVATE_debugCast(t);try{const s=await function(o,l){const u=__PRIVATE_debugCast(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return u.mutationQueue.lookupMutationBatch(c,l).next(p=>(__PRIVATE_hardAssert(p!==null,37113),d=p.keys(),u.mutationQueue.removeMutationBatch(c,p))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,d,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>u.localDocuments.getDocuments(c,d))})}(n.localStore,e);__PRIVATE_processUserCallback(n,e,r),__PRIVATE_triggerPendingWritesCallbacks(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(n,s)}catch(s){await __PRIVATE_ignoreIfPrimaryLeaseLoss(s)}}function __PRIVATE_triggerPendingWritesCallbacks(t,e){(t.Eu.get(e)||[]).forEach(r=>{r.resolve()}),t.Eu.delete(e)}function __PRIVATE_processUserCallback(t,e,r){const n=__PRIVATE_debugCast(t);let s=n.Iu[n.currentUser.toKey()];if(s){const a=s.get(e);a&&(r?a.reject(r):a.resolve(),s=s.remove(e)),n.Iu[n.currentUser.toKey()]=s}}function __PRIVATE_removeAndCleanupTarget(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.cu.get(e))t.uu.delete(n),r&&t.au.Vu(n,r);t.cu.delete(e),t.isPrimaryClient&&t.Tu.Hr(e).forEach(n=>{t.Tu.containsKey(n)||__PRIVATE_removeLimboTarget(t,n)})}function __PRIVATE_removeLimboTarget(t,e){t.lu.delete(e.path.canonicalString());const r=t.hu.get(e);r!==null&&(__PRIVATE_remoteStoreUnlisten(t.remoteStore,r),t.hu=t.hu.remove(e),t.Pu.delete(r),__PRIVATE_pumpEnqueuedLimboResolutions(t))}function __PRIVATE_updateTrackedLimbos(t,e,r){for(const n of r)n instanceof __PRIVATE_AddedLimboDocument?(t.Tu.addReference(n.key,e),__PRIVATE_trackLimboChange(t,n)):n instanceof __PRIVATE_RemovedLimboDocument?(__PRIVATE_logDebug(nn,"Document no longer in limbo: "+n.key),t.Tu.removeReference(n.key,e),t.Tu.containsKey(n.key)||__PRIVATE_removeLimboTarget(t,n.key)):fail(19791,{mu:n})}function __PRIVATE_trackLimboChange(t,e){const r=e.key,n=r.path.canonicalString();t.hu.get(r)||t.lu.has(n)||(__PRIVATE_logDebug(nn,"New document in limbo: "+r),t.lu.add(n),__PRIVATE_pumpEnqueuedLimboResolutions(t))}function __PRIVATE_pumpEnqueuedLimboResolutions(t){for(;t.lu.size>0&&t.hu.size<t.maxConcurrentLimboResolutions;){const e=t.lu.values().next().value;t.lu.delete(e);const r=new DocumentKey(ResourcePath.fromString(e)),n=t.du.next();t.Pu.set(n,new LimboResolution(r)),t.hu=t.hu.insert(r,n),__PRIVATE_remoteStoreListen(t.remoteStore,new TargetData(__PRIVATE_queryToTarget(__PRIVATE_newQueryForPath(r.path)),n,"TargetPurposeLimboResolution",__PRIVATE_ListenSequence.le))}}async function __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(t,e,r){const n=__PRIVATE_debugCast(t),s=[],a=[],o=[];n.uu.isEmpty()||(n.uu.forEach((l,u)=>{o.push(n.Ru(u,e,r).then(c=>{var d;if((c||r)&&n.isPrimaryClient){const p=c?!c.fromCache:(d=r==null?void 0:r.targetChanges.get(u.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(c){s.push(c);const p=__PRIVATE_LocalViewChanges.Rs(u.targetId,c);a.push(p)}}))}),await Promise.all(o),n.au.j_(s),await async function(u,c){const d=__PRIVATE_debugCast(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>PersistencePromise.forEach(c,m=>PersistencePromise.forEach(m.ds,y=>d.persistence.referenceDelegate.addReference(p,m.targetId,y)).next(()=>PersistencePromise.forEach(m.As,y=>d.persistence.referenceDelegate.removeReference(p,m.targetId,y)))))}catch(p){if(!__PRIVATE_isIndexedDbTransactionError(p))throw p;__PRIVATE_logDebug(Qt,"Failed to update sequence numbers: "+p)}for(const p of c){const m=p.targetId;if(!p.fromCache){const y=d.xs.get(m),b=y.snapshotVersion,E=y.withLastLimboFreeSnapshotVersion(b);d.xs=d.xs.insert(m,E)}}}(n.localStore,a))}async function __PRIVATE_syncEngineHandleCredentialChange(t,e){const r=__PRIVATE_debugCast(t);if(!r.currentUser.isEqual(e)){__PRIVATE_logDebug(nn,"User change. New user:",e.toKey());const n=await __PRIVATE_localStoreHandleUserChange(r.localStore,e);r.currentUser=e,function(a,o){a.Eu.forEach(l=>{l.forEach(u=>{u.reject(new FirestoreError(N.CANCELLED,o))})}),a.Eu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(r,n.ks)}}function __PRIVATE_syncEngineGetRemoteKeysForTarget(t,e){const r=__PRIVATE_debugCast(t),n=r.Pu.get(e);if(n&&n._u)return __PRIVATE_documentKeySet().add(n.key);{let s=__PRIVATE_documentKeySet();const a=r.cu.get(e);if(!a)return s;for(const o of a){const l=r.uu.get(o);s=s.unionWith(l.view.Ya)}return s}}function __PRIVATE_ensureWatchCallbacks(t){const e=__PRIVATE_debugCast(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=__PRIVATE_syncEngineApplyRemoteEvent.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=__PRIVATE_syncEngineGetRemoteKeysForTarget.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=__PRIVATE_syncEngineRejectListen.bind(null,e),e.au.j_=__PRIVATE_eventManagerOnWatchChange.bind(null,e.eventManager),e.au.Vu=__PRIVATE_eventManagerOnWatchError.bind(null,e.eventManager),e}function __PRIVATE_syncEngineEnsureWriteCallbacks(t){const e=__PRIVATE_debugCast(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=__PRIVATE_syncEngineApplySuccessfulWrite.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=__PRIVATE_syncEngineRejectFailedWrite.bind(null,e),e}class __PRIVATE_MemoryOfflineComponentProvider{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=__PRIVATE_newSerializer(e.databaseInfo.databaseId),this.sharedClientState=this.pu(e),this.persistence=this.yu(e),await this.persistence.start(),this.localStore=this.wu(e),this.gcScheduler=this.Su(e,this.localStore),this.indexBackfillerScheduler=this.bu(e,this.localStore)}Su(e,r){return null}bu(e,r){return null}wu(e){return __PRIVATE_newLocalStore(this.persistence,new __PRIVATE_QueryEngine,e.initialUser,this.serializer)}yu(e){return new __PRIVATE_MemoryPersistence(__PRIVATE_MemoryEagerDelegate.fi,this.serializer)}pu(e){return new __PRIVATE_MemorySharedClientState}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}__PRIVATE_MemoryOfflineComponentProvider.provider={build:()=>new __PRIVATE_MemoryOfflineComponentProvider};class __PRIVATE_LruGcMemoryOfflineComponentProvider extends __PRIVATE_MemoryOfflineComponentProvider{constructor(e){super(),this.cacheSizeBytes=e}Su(e,r){__PRIVATE_hardAssert(this.persistence.referenceDelegate instanceof __PRIVATE_MemoryLruDelegate,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new __PRIVATE_LruScheduler(n,e.asyncQueue,r)}yu(e){const r=this.cacheSizeBytes!==void 0?LruParams.withCacheSize(this.cacheSizeBytes):LruParams.DEFAULT;return new __PRIVATE_MemoryPersistence(n=>__PRIVATE_MemoryLruDelegate.fi(n,r),this.serializer)}}class OnlineComponentProvider{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>__PRIVATE_syncEngineApplyOnlineStateChange(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=__PRIVATE_syncEngineHandleCredentialChange.bind(null,this.syncEngine),await __PRIVATE_remoteStoreApplyPrimaryState(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new __PRIVATE_EventManagerImpl}()}createDatastore(e){const r=__PRIVATE_newSerializer(e.databaseInfo.databaseId),n=function(a){return new __PRIVATE_WebChannelConnection(a)}(e.databaseInfo);return function(a,o,l,u){return new __PRIVATE_DatastoreImpl(a,o,l,u)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,a,o,l){return new __PRIVATE_RemoteStoreImpl(n,s,a,o,l)}(this.localStore,this.datastore,e.asyncQueue,r=>__PRIVATE_syncEngineApplyOnlineStateChange(this.syncEngine,r,0),function(){return __PRIVATE_BrowserConnectivityMonitor.C()?new __PRIVATE_BrowserConnectivityMonitor:new __PRIVATE_NoopConnectivityMonitor}())}createSyncEngine(e,r){return function(s,a,o,l,u,c,d){const p=new __PRIVATE_SyncEngineImpl(s,a,o,l,u,c);return d&&(p.Au=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const a=__PRIVATE_debugCast(s);__PRIVATE_logDebug(Xt,"RemoteStore shutting down."),a.Ta.add(5),await __PRIVATE_disableNetworkInternal(a),a.Ea.shutdown(),a.da.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}OnlineComponentProvider.provider={build:()=>new OnlineComponentProvider};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AsyncObserver{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.vu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.vu(this.observer.error,e):__PRIVATE_logError("Uncaught Error in snapshot listener:",e.toString()))}Cu(){this.muted=!0}vu(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rn="FirestoreClient";class FirestoreClient{constructor(e,r,n,s,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=User.UNAUTHENTICATED,this.clientId=__PRIVATE_AutoId.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async o=>{__PRIVATE_logDebug(rn,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(__PRIVATE_logDebug(rn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new __PRIVATE_Deferred;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=__PRIVATE_wrapInUserErrorIfRecoverable(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function __PRIVATE_setOfflineComponentProvider(t,e){t.asyncQueue.verifyOperationInProgress(),__PRIVATE_logDebug(rn,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await __PRIVATE_localStoreHandleUserChange(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function __PRIVATE_setOnlineComponentProvider(t,e){t.asyncQueue.verifyOperationInProgress();const r=await __PRIVATE_ensureOfflineComponents(t);__PRIVATE_logDebug(rn,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>__PRIVATE_remoteStoreHandleCredentialChange(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>__PRIVATE_remoteStoreHandleCredentialChange(e.remoteStore,s)),t._onlineComponents=e}async function __PRIVATE_ensureOfflineComponents(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){__PRIVATE_logDebug(rn,"Using user provided OfflineComponentProvider");try{await __PRIVATE_setOfflineComponentProvider(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===N.FAILED_PRECONDITION||s.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;__PRIVATE_logWarn("Error using user provided cache. Falling back to memory cache: "+r),await __PRIVATE_setOfflineComponentProvider(t,new __PRIVATE_MemoryOfflineComponentProvider)}}else __PRIVATE_logDebug(rn,"Using default OfflineComponentProvider"),await __PRIVATE_setOfflineComponentProvider(t,new __PRIVATE_LruGcMemoryOfflineComponentProvider(void 0));return t._offlineComponents}async function __PRIVATE_ensureOnlineComponents(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(__PRIVATE_logDebug(rn,"Using user provided OnlineComponentProvider"),await __PRIVATE_setOnlineComponentProvider(t,t._uninitializedComponentsProvider._online)):(__PRIVATE_logDebug(rn,"Using default OnlineComponentProvider"),await __PRIVATE_setOnlineComponentProvider(t,new OnlineComponentProvider))),t._onlineComponents}function __PRIVATE_getSyncEngine(t){return __PRIVATE_ensureOnlineComponents(t).then(e=>e.syncEngine)}async function __PRIVATE_getEventManager(t){const e=await __PRIVATE_ensureOnlineComponents(t),r=e.eventManager;return r.onListen=__PRIVATE_syncEngineListen.bind(null,e.syncEngine),r.onUnlisten=__PRIVATE_syncEngineUnlisten.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=__PRIVATE_triggerRemoteStoreListen.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=__PRIVATE_triggerRemoteStoreUnlisten.bind(null,e.syncEngine),r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_cloneLongPollingOptions(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sn=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_validateNonEmptyArgument(t,e,r){if(!r)throw new FirestoreError(N.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function __PRIVATE_validateIsNotUsedTogether(t,e,r,n){if(e===!0&&n===!0)throw new FirestoreError(N.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function __PRIVATE_validateDocumentPath(t){if(!DocumentKey.isDocumentKey(t))throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function __PRIVATE_validateCollectionPath(t){if(DocumentKey.isDocumentKey(t))throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function __PRIVATE_valueDescription(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":fail(12329,{type:typeof t})}function __PRIVATE_cast(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new FirestoreError(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=__PRIVATE_valueDescription(t);throw new FirestoreError(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const on="firestore.googleapis.com",_n=!0;class FirestoreSettingsImpl{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new FirestoreError(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=on,this.ssl=_n}else this.host=e.host,this.ssl=(r=e.ssl)!==null&&r!==void 0?r:_n;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Mt;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Ot)throw new FirestoreError(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}__PRIVATE_validateIsNotUsedTogether("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=__PRIVATE_cloneLongPollingOptions((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new FirestoreError(N.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new FirestoreError(N.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new FirestoreError(N.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Firestore$1{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FirestoreSettingsImpl({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new FirestoreError(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new FirestoreError(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FirestoreSettingsImpl(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new __PRIVATE_EmptyAuthCredentialsProvider;switch(n.type){case"firstParty":return new __PRIVATE_FirstPartyAuthCredentialsProvider(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new FirestoreError(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=sn.get(r);n&&(__PRIVATE_logDebug("ComponentProvider","Removing Datastore"),sn.delete(r),n.terminate())}(this),Promise.resolve()}}function connectFirestoreEmulator(t,e,r,n={}){var s;t=__PRIVATE_cast(t,Firestore$1);const a=isCloudWorkstation(e),o=t._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),u=`${e}:${r}`;a&&(pingServer(`https://${u}`),updateEmulatorBanner("Firestore",!0)),o.host!==on&&o.host!==u&&__PRIVATE_logWarn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},o),{host:u,ssl:a,emulatorOptions:n});if(!deepEqual$1(c,l)&&(t._setSettings(c),n.mockUserToken)){let d,p;if(typeof n.mockUserToken=="string")d=n.mockUserToken,p=User.MOCK_USER;else{d=createMockUserToken(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const m=n.mockUserToken.sub||n.mockUserToken.user_id;if(!m)throw new FirestoreError(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new User(m)}t._authCredentials=new __PRIVATE_EmulatorAuthCredentialsProvider(new __PRIVATE_OAuthToken(d,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Query{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Query(this.firestore,e,this._query)}}class DocumentReference{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new CollectionReference(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new DocumentReference(this.firestore,e,this._key)}}class CollectionReference extends Query{constructor(e,r,n){super(e,r,__PRIVATE_newQueryForPath(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new DocumentReference(this.firestore,null,new DocumentKey(e))}withConverter(e){return new CollectionReference(this.firestore,e,this._path)}}function collection(t,e,...r){if(t=getModularInstance(t),__PRIVATE_validateNonEmptyArgument("collection","path",e),t instanceof Firestore$1){const n=ResourcePath.fromString(e,...r);return __PRIVATE_validateCollectionPath(n),new CollectionReference(t,null,n)}{if(!(t instanceof DocumentReference||t instanceof CollectionReference))throw new FirestoreError(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ResourcePath.fromString(e,...r));return __PRIVATE_validateCollectionPath(n),new CollectionReference(t.firestore,null,n)}}function doc(t,e,...r){if(t=getModularInstance(t),arguments.length===1&&(e=__PRIVATE_AutoId.newId()),__PRIVATE_validateNonEmptyArgument("doc","path",e),t instanceof Firestore$1){const n=ResourcePath.fromString(e,...r);return __PRIVATE_validateDocumentPath(n),new DocumentReference(t,null,new DocumentKey(n))}{if(!(t instanceof DocumentReference||t instanceof CollectionReference))throw new FirestoreError(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ResourcePath.fromString(e,...r));return __PRIVATE_validateDocumentPath(n),new DocumentReference(t.firestore,t instanceof CollectionReference?t.converter:null,new DocumentKey(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const an="AsyncQueue";class __PRIVATE_AsyncQueueImpl{constructor(e=Promise.resolve()){this.zu=[],this.ju=!1,this.Hu=[],this.Ju=null,this.Yu=!1,this.Zu=!1,this.Xu=[],this.C_=new __PRIVATE_ExponentialBackoff(this,"async_queue_retry"),this.ec=()=>{const n=getDocument();n&&__PRIVATE_logDebug(an,"Visibility state changed to "+n.visibilityState),this.C_.p_()},this.tc=e;const r=getDocument();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.ec)}get isShuttingDown(){return this.ju}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.nc(),this.rc(e)}enterRestrictedMode(e){if(!this.ju){this.ju=!0,this.Zu=e||!1;const r=getDocument();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.ec)}}enqueue(e){if(this.nc(),this.ju)return new Promise(()=>{});const r=new __PRIVATE_Deferred;return this.rc(()=>this.ju&&this.Zu?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.zu.push(e),this.sc()))}async sc(){if(this.zu.length!==0){try{await this.zu[0](),this.zu.shift(),this.C_.reset()}catch(e){if(!__PRIVATE_isIndexedDbTransactionError(e))throw e;__PRIVATE_logDebug(an,"Operation failed with retryable error: "+e)}this.zu.length>0&&this.C_.f_(()=>this.sc())}}rc(e){const r=this.tc.then(()=>(this.Yu=!0,e().catch(n=>{throw this.Ju=n,this.Yu=!1,__PRIVATE_logError("INTERNAL UNHANDLED ERROR: ",__PRIVATE_getMessageOrStack(n)),n}).then(n=>(this.Yu=!1,n))));return this.tc=r,r}enqueueAfterDelay(e,r,n){this.nc(),this.Xu.indexOf(e)>-1&&(r=0);const s=DelayedOperation.createAndSchedule(this,e,r,n,a=>this.oc(a));return this.Hu.push(s),s}nc(){this.Ju&&fail(47125,{_c:__PRIVATE_getMessageOrStack(this.Ju)})}verifyOperationInProgress(){}async ac(){let e;do e=this.tc,await e;while(e!==this.tc)}uc(e){for(const r of this.Hu)if(r.timerId===e)return!0;return!1}cc(e){return this.ac().then(()=>{this.Hu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Hu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.ac()})}lc(e){this.Xu.push(e)}oc(e){const r=this.Hu.indexOf(e);this.Hu.splice(r,1)}}function __PRIVATE_getMessageOrStack(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_isPartialObserver(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const a of n)if(a in s&&typeof s[a]=="function")return!0;return!1}(t,["next","error","complete"])}class Firestore extends Firestore$1{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new __PRIVATE_AsyncQueueImpl,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new __PRIVATE_AsyncQueueImpl(e),this._firestoreClient=void 0,await e}}}function getFirestore(t,e){const r=typeof t=="object"?t:getApp(),n=typeof t=="string"?t:ut,s=_getProvider(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=getDefaultEmulatorHostnameAndPort("firestore");a&&connectFirestoreEmulator(s,...a)}return s}function ensureFirestoreConfigured(t){if(t._terminated)throw new FirestoreError(N.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||__PRIVATE_configureFirestore(t),t._firestoreClient}function __PRIVATE_configureFirestore(t){var e,r,n;const s=t._freezeSettings(),a=function(l,u,c,d){return new DatabaseInfo(l,u,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,__PRIVATE_cloneLongPollingOptions(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new FirestoreClient(t._authCredentials,t._appCheckCredentials,t._queue,a,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bytes{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bytes(ByteString.fromBase64String(e))}catch(r){throw new FirestoreError(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Bytes(ByteString.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldPath{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new FirestoreError(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new FieldPath$1(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldValue{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GeoPoint{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new FirestoreError(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new FirestoreError(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return __PRIVATE_primitiveComparator(this._lat,e._lat)||__PRIVATE_primitiveComparator(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VectorValue{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cn=/^__.*__$/;class ParsedSetData{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new __PRIVATE_PatchMutation(e,this.data,this.fieldMask,r,this.fieldTransforms):new __PRIVATE_SetMutation(e,this.data,r,this.fieldTransforms)}}function __PRIVATE_isWrite(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw fail(40011,{hc:t})}}class __PRIVATE_ParseContextImpl{constructor(e,r,n,s,a,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,a===void 0&&this.Pc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get hc(){return this.settings.hc}Tc(e){return new __PRIVATE_ParseContextImpl(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ic(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Tc({path:n,Ec:!1});return s.dc(e),s}Ac(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Tc({path:n,Ec:!1});return s.Pc(),s}Rc(e){return this.Tc({path:void 0,Ec:!0})}Vc(e){return __PRIVATE_createError(e,this.settings.methodName,this.settings.mc||!1,this.path,this.settings.fc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Pc(){if(this.path)for(let e=0;e<this.path.length;e++)this.dc(this.path.get(e))}dc(e){if(e.length===0)throw this.Vc("Document fields must not be empty");if(__PRIVATE_isWrite(this.hc)&&cn.test(e))throw this.Vc('Document fields cannot begin and end with "__"')}}class __PRIVATE_UserDataReader{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||__PRIVATE_newSerializer(e)}gc(e,r,n,s=!1){return new __PRIVATE_ParseContextImpl({hc:e,methodName:r,fc:n,path:FieldPath$1.emptyPath(),Ec:!1,mc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function __PRIVATE_newUserDataReader(t){const e=t._freezeSettings(),r=__PRIVATE_newSerializer(t._databaseId);return new __PRIVATE_UserDataReader(t._databaseId,!!e.ignoreUndefinedProperties,r)}function __PRIVATE_parseSetData(t,e,r,n,s,a={}){const o=t.gc(a.merge||a.mergeFields?2:0,e,r,s);__PRIVATE_validatePlainObject("Data must be an object, but it was:",o,n);const l=__PRIVATE_parseObject(n,o);let u,c;if(a.merge)u=new FieldMask(o.fieldMask),c=o.fieldTransforms;else if(a.mergeFields){const d=[];for(const p of a.mergeFields){const m=__PRIVATE_fieldPathFromArgument$1(e,p,r);if(!o.contains(m))throw new FirestoreError(N.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);__PRIVATE_fieldMaskContains(d,m)||d.push(m)}u=new FieldMask(d),c=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,c=o.fieldTransforms;return new ParsedSetData(new ObjectValue(l),u,c)}function __PRIVATE_parseQueryValue(t,e,r,n=!1){return __PRIVATE_parseData(r,t.gc(n?4:3,e))}function __PRIVATE_parseData(t,e){if(__PRIVATE_looksLikeJsonObject(t=getModularInstance(t)))return __PRIVATE_validatePlainObject("Unsupported field value:",e,t),__PRIVATE_parseObject(t,e);if(t instanceof FieldValue)return function(n,s){if(!__PRIVATE_isWrite(s.hc))throw s.Vc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Vc(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Ec&&e.hc!==4)throw e.Vc("Nested arrays are not supported");return function(n,s){const a=[];let o=0;for(const l of n){let u=__PRIVATE_parseData(l,s.Rc(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}}(t,e)}return function(n,s){if((n=getModularInstance(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return toNumber(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=Timestamp.fromDate(n);return{timestampValue:toTimestamp(s.serializer,a)}}if(n instanceof Timestamp){const a=new Timestamp(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:toTimestamp(s.serializer,a)}}if(n instanceof GeoPoint)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Bytes)return{bytesValue:__PRIVATE_toBytes(s.serializer,n._byteString)};if(n instanceof DocumentReference){const a=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(a))throw s.Vc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:__PRIVATE_toResourceName(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof VectorValue)return function(o,l){return{mapValue:{fields:{[ct]:{stringValue:Pt},[Tt]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Vc("VectorValues must only contain numeric values.");return __PRIVATE_toDouble(l.serializer,c)})}}}}}}(n,s);throw s.Vc(`Unsupported field value: ${__PRIVATE_valueDescription(n)}`)}(t,e)}function __PRIVATE_parseObject(t,e){const r={};return isEmpty(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):forEach(t,(n,s)=>{const a=__PRIVATE_parseData(s,e.Ic(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function __PRIVATE_looksLikeJsonObject(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Timestamp||t instanceof GeoPoint||t instanceof Bytes||t instanceof DocumentReference||t instanceof FieldValue||t instanceof VectorValue)}function __PRIVATE_validatePlainObject(t,e,r){if(!__PRIVATE_looksLikeJsonObject(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=__PRIVATE_valueDescription(r);throw n==="an object"?e.Vc(t+" a custom object"):e.Vc(t+" "+n)}}function __PRIVATE_fieldPathFromArgument$1(t,e,r){if((e=getModularInstance(e))instanceof FieldPath)return e._internalPath;if(typeof e=="string")return __PRIVATE_fieldPathFromDotSeparatedString(t,e);throw __PRIVATE_createError("Field path arguments must be of type string or ",t,!1,void 0,r)}const ln=new RegExp("[~\\*/\\[\\]]");function __PRIVATE_fieldPathFromDotSeparatedString(t,e,r){if(e.search(ln)>=0)throw __PRIVATE_createError(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new FieldPath(...e.split("."))._internalPath}catch{throw __PRIVATE_createError(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function __PRIVATE_createError(t,e,r,n,s){const a=n&&!n.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${n}`),o&&(u+=` in document ${s}`),u+=")"),new FirestoreError(N.INVALID_ARGUMENT,l+t+u)}function __PRIVATE_fieldMaskContains(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentSnapshot$1{constructor(e,r,n,s,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new DocumentReference(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new QueryDocumentSnapshot$1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class QueryDocumentSnapshot$1 extends DocumentSnapshot$1{data(){return super.data()}}function __PRIVATE_fieldPathFromArgument(t,e){return typeof e=="string"?__PRIVATE_fieldPathFromDotSeparatedString(t,e):e instanceof FieldPath?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_validateHasExplicitOrderByForLimitToLast(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new FirestoreError(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class AppliableConstraint{}class QueryConstraint extends AppliableConstraint{}function query(t,e,...r){let n=[];e instanceof AppliableConstraint&&n.push(e),n=n.concat(r),function(a){const o=a.filter(u=>u instanceof QueryCompositeFilterConstraint).length,l=a.filter(u=>u instanceof QueryFieldFilterConstraint).length;if(o>1||o>0&&l>0)throw new FirestoreError(N.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class QueryFieldFilterConstraint extends QueryConstraint{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new QueryFieldFilterConstraint(e,r,n)}_apply(e){const r=this._parse(e);return __PRIVATE_validateNewFieldFilter(e._query,r),new Query(e.firestore,e.converter,__PRIVATE_queryWithAddedFilter(e._query,r))}_parse(e){const r=__PRIVATE_newUserDataReader(e.firestore);return function(a,o,l,u,c,d,p){let m;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){__PRIVATE_validateDisjunctiveFilterElements(p,d);const b=[];for(const E of p)b.push(__PRIVATE_parseDocumentIdValue(u,a,E));m={arrayValue:{values:b}}}else m=__PRIVATE_parseDocumentIdValue(u,a,p)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||__PRIVATE_validateDisjunctiveFilterElements(p,d),m=__PRIVATE_parseQueryValue(l,o,p,d==="in"||d==="not-in");return FieldFilter.create(c,d,m)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}class QueryCompositeFilterConstraint extends AppliableConstraint{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new QueryCompositeFilterConstraint(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:CompositeFilter.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,a){let o=s;const l=a.getFlattenedFilters();for(const u of l)__PRIVATE_validateNewFieldFilter(o,u),o=__PRIVATE_queryWithAddedFilter(o,u)}(e._query,r),new Query(e.firestore,e.converter,__PRIVATE_queryWithAddedFilter(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class QueryOrderByConstraint extends QueryConstraint{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new QueryOrderByConstraint(e,r)}_apply(e){const r=function(s,a,o){if(s.startAt!==null)throw new FirestoreError(N.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new FirestoreError(N.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new OrderBy(a,o)}(e._query,this._field,this._direction);return new Query(e.firestore,e.converter,function(s,a){const o=s.explicitOrderBy.concat([a]);return new __PRIVATE_QueryImpl(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function orderBy(t,e="asc"){const r=e,n=__PRIVATE_fieldPathFromArgument("orderBy",t);return QueryOrderByConstraint._create(n,r)}function __PRIVATE_parseDocumentIdValue(t,e,r){if(typeof(r=getModularInstance(r))=="string"){if(r==="")throw new FirestoreError(N.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!__PRIVATE_isCollectionGroupQuery(e)&&r.indexOf("/")!==-1)throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(ResourcePath.fromString(r));if(!DocumentKey.isDocumentKey(n))throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return __PRIVATE_refValue(t,new DocumentKey(n))}if(r instanceof DocumentReference)return __PRIVATE_refValue(t,r._key);throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${__PRIVATE_valueDescription(r)}.`)}function __PRIVATE_validateDisjunctiveFilterElements(t,e){if(!Array.isArray(t)||t.length===0)throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function __PRIVATE_validateNewFieldFilter(t,e){const r=function(s,a){for(const o of s)for(const l of o.getFlattenedFilters())if(a.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class AbstractUserDataWriter{convertValue(e,r="none"){switch(__PRIVATE_typeOrder(e)){case 0:return null;case 1:return e.booleanValue;case 2:return __PRIVATE_normalizeNumber(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(__PRIVATE_normalizeByteString(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw fail(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return forEach(e,(s,a)=>{n[s]=this.convertValue(a,r)}),n}convertVectorValue(e){var r,n,s;const a=(s=(n=(r=e.fields)===null||r===void 0?void 0:r[Tt].arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(o=>__PRIVATE_normalizeNumber(o.doubleValue));return new VectorValue(a)}convertGeoPoint(e){return new GeoPoint(__PRIVATE_normalizeNumber(e.latitude),__PRIVATE_normalizeNumber(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=__PRIVATE_getPreviousValue(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(__PRIVATE_getLocalWriteTime(e));default:return null}}convertTimestamp(e){const r=__PRIVATE_normalizeTimestamp(e);return new Timestamp(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=ResourcePath.fromString(e);__PRIVATE_hardAssert(__PRIVATE_isValidResourceName(n),9688,{name:e});const s=new DatabaseId(n.get(1),n.get(3)),a=new DocumentKey(n.popFirst(5));return s.isEqual(r)||__PRIVATE_logError(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_applyFirestoreDataConverter(t,e,r){let n;return n=t?t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SnapshotMetadata{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class DocumentSnapshot extends DocumentSnapshot$1{constructor(e,r,n,s,a,o){super(e,r,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new QueryDocumentSnapshot(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class QueryDocumentSnapshot extends DocumentSnapshot{data(e={}){return super.data(e)}}class QuerySnapshot{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new SnapshotMetadata(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new QueryDocumentSnapshot(this._firestore,this._userDataWriter,n.key,n,new SnapshotMetadata(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new FirestoreError(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const u=new QueryDocumentSnapshot(s._firestore,s._userDataWriter,l.doc.key,l.doc,new SnapshotMetadata(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>a||l.type!==3).map(l=>{const u=new QueryDocumentSnapshot(s._firestore,s._userDataWriter,l.doc.key,l.doc,new SnapshotMetadata(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,d=-1;return l.type!==0&&(c=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:__PRIVATE_resultChangeType(l.type),doc:u,oldIndex:c,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function __PRIVATE_resultChangeType(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fail(61501,{type:t})}}class __PRIVATE_ExpUserDataWriter extends AbstractUserDataWriter{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bytes(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new DocumentReference(this.firestore,null,r)}}function setDoc(t,e,r){t=__PRIVATE_cast(t,DocumentReference);const n=__PRIVATE_cast(t.firestore,Firestore),s=__PRIVATE_applyFirestoreDataConverter(t.converter,e);return executeWrite(n,[__PRIVATE_parseSetData(__PRIVATE_newUserDataReader(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,Precondition.none())])}function addDoc(t,e){const r=__PRIVATE_cast(t.firestore,Firestore),n=doc(t),s=__PRIVATE_applyFirestoreDataConverter(t.converter,e);return executeWrite(r,[__PRIVATE_parseSetData(__PRIVATE_newUserDataReader(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,Precondition.exists(!1))]).then(()=>n)}function onSnapshot(t,...e){var r,n,s;t=getModularInstance(t);let a={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||__PRIVATE_isPartialObserver(e[o])||(a=e[o],o++);const l={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(__PRIVATE_isPartialObserver(e[o])){const p=e[o];e[o]=(r=p.next)===null||r===void 0?void 0:r.bind(p),e[o+1]=(n=p.error)===null||n===void 0?void 0:n.bind(p),e[o+2]=(s=p.complete)===null||s===void 0?void 0:s.bind(p)}let u,c,d;if(t instanceof DocumentReference)c=__PRIVATE_cast(t.firestore,Firestore),d=__PRIVATE_newQueryForPath(t._key.path),u={next:p=>{e[o]&&e[o](__PRIVATE_convertToDocSnapshot(c,t,p))},error:e[o+1],complete:e[o+2]};else{const p=__PRIVATE_cast(t,Query);c=__PRIVATE_cast(p.firestore,Firestore),d=p._query;const m=new __PRIVATE_ExpUserDataWriter(c);u={next:y=>{e[o]&&e[o](new QuerySnapshot(c,m,p,y))},error:e[o+1],complete:e[o+2]},__PRIVATE_validateHasExplicitOrderByForLimitToLast(t._query)}return function(m,y,b,E){const T=new __PRIVATE_AsyncObserver(E),S=new __PRIVATE_QueryListener(y,T,b);return m.asyncQueue.enqueueAndForget(async()=>__PRIVATE_eventManagerListen(await __PRIVATE_getEventManager(m),S)),()=>{T.Cu(),m.asyncQueue.enqueueAndForget(async()=>__PRIVATE_eventManagerUnlisten(await __PRIVATE_getEventManager(m),S))}}(ensureFirestoreConfigured(c),d,l,u)}function executeWrite(t,e){return function(n,s){const a=new __PRIVATE_Deferred;return n.asyncQueue.enqueueAndForget(async()=>__PRIVATE_syncEngineWrite(await __PRIVATE_getSyncEngine(n),s,a)),a.promise}(ensureFirestoreConfigured(t),e)}function __PRIVATE_convertToDocSnapshot(t,e,r){const n=r.docs.get(e._key),s=new __PRIVATE_ExpUserDataWriter(t);return new DocumentSnapshot(t,s,e._key,n,new SnapshotMetadata(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(s){x=s})(SDK_VERSION),_registerComponent(new Component("firestore",(n,{instanceIdentifier:s,options:a})=>{const o=n.getProvider("app").getImmediate(),l=new Firestore(new __PRIVATE_FirebaseAuthCredentialsProvider(n.getProvider("auth-internal")),new __PRIVATE_FirebaseAppCheckTokenProvider(o,n.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new FirestoreError(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new DatabaseId(c.options.projectId,d)}(o,s),o);return a=Object.assign({useFetchStreams:r},a),l._setSettings(a),l},"PUBLIC").setMultipleInstances(!0)),registerVersion(F,M,e),registerVersion(F,M,"esm2017")})();var name="firebase",version="11.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */registerVersion(name,version,"app");const firebaseConfig={apiKey:void 0,authDomain:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0},app=initializeApp(firebaseConfig),db=getFirestore(app);function conversationId(t,e){return[t,e].sort().join("_")}const realtimeChatService={sendMessage:async(t,e,r)=>{const n=conversationId(t,e);await addDoc(collection(db,"conversations",n,"messages"),{senderId:t,receiverId:e,content:r,timestamp:Date.now()})},listenMessages:(t,e,r)=>{const n=conversationId(t,e),s=query(collection(db,"conversations",n,"messages"),orderBy("timestamp"));return onSnapshot(s,a=>{const o=a.docs.map(l=>({...l.data(),id:l.id}));r(o)})},addContact:async(t,e)=>{await setDoc(doc(db,"users",t,"contacts",e.id),e)},listenContacts:(t,e)=>{const r=collection(db,"users",t,"contacts");return onSnapshot(r,n=>{const s=n.docs.map(a=>({...a.data(),id:a.id}));e(s)})}},ChatModule=()=>{const{currentUser:t}=useUser(),[e,r]=reactExports.useState([]),[n,s]=reactExports.useState(null),[a,o]=reactExports.useState([]),[l,u]=reactExports.useState(""),[c,d]=reactExports.useState("");reactExports.useEffect(()=>{if(!t)return;const y=realtimeChatService.listenContacts(t.id,r);return()=>y()},[t]),reactExports.useEffect(()=>{if(!t||!n)return;const y=realtimeChatService.listenMessages(t.id,n.id,o);return()=>y()},[t,n]);const p=async()=>{!t||!n||!c.trim()||(await realtimeChatService.sendMessage(t.id,n.id,c.trim()),d(""))},m=async()=>{if(!t||!l.trim())return;const y={id:l.trim(),name:l.trim()};await realtimeChatService.addContact(t.id,y),u("")};return t?jsxRuntimeExports.jsxs("div",{className:"p-4 border rounded-md bg-white dark:bg-gray-800",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold mb-2",children:"即時聊天"}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsxs("div",{className:"w-1/3 pr-2 border-r",children:[jsxRuntimeExports.jsx("h3",{className:"font-medium mb-2",children:"聯絡人"}),jsxRuntimeExports.jsx("ul",{className:"space-y-1",children:e.map(y=>jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx("button",{className:`w-full text-left p-1 rounded ${(n==null?void 0:n.id)===y.id?"bg-blue-500 text-white":"hover:bg-gray-100 dark:hover:bg-gray-700"}`,onClick:()=>s(y),children:y.name})},y.id))}),jsxRuntimeExports.jsxs("div",{className:"mt-2 flex",children:[jsxRuntimeExports.jsx("input",{value:l,onChange:y=>u(y.target.value),className:"flex-1 border rounded p-1 text-sm",placeholder:"聯絡人ID"}),jsxRuntimeExports.jsx("button",{onClick:m,className:"ml-1 px-2 bg-blue-500 text-white rounded",children:"新增"})]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 pl-2",children:n?jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-64",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto mb-2 space-y-1",children:a.map(y=>jsxRuntimeExports.jsx("div",{className:y.senderId===t.id?"text-right":"text-left",children:jsxRuntimeExports.jsx("span",{className:"inline-block bg-gray-200 dark:bg-gray-700 rounded px-2 py-1 text-sm",children:y.content})},y.id))}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("input",{value:c,onChange:y=>d(y.target.value),className:"flex-1 border rounded p-1 text-sm",placeholder:"輸入訊息"}),jsxRuntimeExports.jsx("button",{onClick:p,className:"ml-1 px-2 bg-blue-500 text-white rounded",children:"送出"})]})]}):jsxRuntimeExports.jsx("div",{className:"text-gray-500",children:"請選擇聯絡人開始聊天"})})]})]}):null},todayEvents=[{id:"1",title:"國語課",date:new Date,startTime:"10:30",endTime:"12:00",category:"國語",color:"indigo"},{id:"2",title:"自然科學",date:new Date,startTime:"13:00",endTime:"14:30",category:"自然",color:"green"}],upcomingTasks$1=[{id:"1",title:"寫一篇遊記",description:"選擇一個最近去過的地方，寫一篇遊記",dueDate:new Date(new Date().setDate(new Date().getDate()+1)),completed:!1,subject:"國語",priority:"high",assignedBy:"陳老師"},{id:"2",title:"水三態的科學實驗",description:"準備水三態實驗的報告",dueDate:new Date(new Date().setDate(new Date().getDate()+3)),completed:!1,subject:"自然",priority:"medium",assignedBy:"林老師"},{id:"3",title:"閱讀課外讀物 - 科學家",description:"閱讀科學家的傳記並做筆記",dueDate:new Date,completed:!0,subject:"自然",priority:"low",assignedBy:"林老師"}],progressData$1=[{subject:"國語",progress:38,color:"#4F46E5"},{subject:"數學",progress:55,color:"#0EA5E9"},{subject:"英語",progress:47,color:"#F97316"},{subject:"自然",progress:62,color:"#10B981"},{subject:"社會",progress:41,color:"#8B5CF6"}],StudentDashboard=()=>{const[t,e]=React.useState(upcomingTasks$1),r=n=>{e(t.map(s=>s.id===n?{...s,completed:!s.completed}:s))};return jsxRuntimeExports.jsxs(PageLayout,{title:"學生儀表板",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:"今日學習規劃"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:todayEvents.map((n,s)=>jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 border-l-4",style:{borderLeftColor:n.color==="indigo"?"#4F46E5":"#10B981"},children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-start",children:[jsxRuntimeExports.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:n.title}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[n.startTime," - ",n.endTime]})]}),jsxRuntimeExports.jsx("div",{className:"mt-4 space-y-3",children:s===0?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"flex items-center",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx(Check,{size:16,className:"text-green-500 mr-2"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300 line-through",children:"課文閱讀"})]})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"h-4 w-4 border border-gray-300 dark:border-gray-600 rounded mr-2"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"寫一篇遊記 (1/3)"})]}),jsxRuntimeExports.jsxs("div",{className:"mt-3 text-xs text-gray-500 dark:text-gray-400",children:[jsxRuntimeExports.jsx("strong",{children:"進度規劃:"})," 第六課, 第七課"]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx(Check,{size:16,className:"text-green-500 mr-2"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300 line-through",children:"閱讀課外讀物 - 科學家"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"h-4 w-4 border border-gray-300 dark:border-gray-600 rounded mr-2"}),jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"水三態的科學實驗"})]}),jsxRuntimeExports.jsxs("div",{className:"mt-3 text-xs text-gray-500 dark:text-gray-400",children:[jsxRuntimeExports.jsx("strong",{children:"進度紀錄:"})," 《居禮夫人傳》, 已閱讀 60 頁"]})]})})]},s))})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:"待完成任務"}),jsxRuntimeExports.jsx("button",{className:"text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300 font-medium",children:"查看全部"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow divide-y divide-gray-200 dark:divide-gray-700",children:[t.filter(n=>!n.completed).slice(0,3).map((n,s)=>jsxRuntimeExports.jsxs("div",{className:"p-4 flex items-start",children:[jsxRuntimeExports.jsx("button",{className:"mt-0.5 mr-3 focus:outline-none",onClick:()=>r(n.id),children:jsxRuntimeExports.jsx("div",{className:"h-5 w-5 border-2 border-gray-300 dark:border-gray-600 rounded-full"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:n.title}),jsxRuntimeExports.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${n.priority==="high"?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300":n.priority==="medium"?"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300"}`,children:n.priority==="high"?"優先":n.priority==="medium"?"一般":"次要"})]}),n.description&&jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:n.description}),jsxRuntimeExports.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center text-xs font-medium text-indigo-600 dark:text-indigo-400",children:[jsxRuntimeExports.jsx(BookOpen,{size:14,className:"mr-1"}),n.subject]}),jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center text-xs font-medium text-gray-500 dark:text-gray-400",children:[jsxRuntimeExports.jsx(Clock,{size:14,className:"mr-1"}),"到期: ",new Intl.DateTimeFormat("zh-TW",{month:"short",day:"numeric"}).format(n.dueDate)]})]})]})]},s)),t.filter(n=>!n.completed).length===0&&jsxRuntimeExports.jsx("div",{className:"p-6 text-center text-gray-500 dark:text-gray-400",children:"沒有待完成的任務"})]})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("div",{className:"flex justify-between items-center mb-4",children:jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:"最近完成"})}),jsxRuntimeExports.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:jsxRuntimeExports.jsx("div",{className:"space-y-4",children:t.filter(n=>n.completed).map((n,s)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"h-8 w-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center mr-3",children:jsxRuntimeExports.jsx(Check,{size:16,className:"text-green-600 dark:text-green-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-gray-800 dark:text-white",children:n.title}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[n.subject," · 今天完成"]})]})]},s))})})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:"學習進度"}),jsxRuntimeExports.jsx("button",{className:"text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300 font-medium",children:"詳細資料"})]}),jsxRuntimeExports.jsx(ProgressChart,{data:progressData$1})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:"本週課表"}),jsxRuntimeExports.jsx("button",{className:"text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300 font-medium",children:"完整課表"})]}),jsxRuntimeExports.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:jsxRuntimeExports.jsx("div",{className:"space-y-3",children:["一","二","三","四","五"].map((n,s)=>jsxRuntimeExports.jsxs("div",{className:"flex items-start",children:[jsxRuntimeExports.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 flex items-center justify-center mr-3",children:jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:n})}),jsxRuntimeExports.jsx("div",{className:"flex-1",children:s===0?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-gray-800 dark:text-white",children:"國語、數學"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500",children:"10:30 - 15:00"})]})}):s===2?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-gray-800 dark:text-white",children:"自然、社會"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500",children:"13:00 - 16:30"})]})}):s===4?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("p",{className:"font-medium text-gray-800 dark:text-white",children:"英語、藝術"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500",children:"10:00 - 15:00"})]})}):jsxRuntimeExports.jsx("p",{className:"text-gray-500 dark:text-gray-400 italic",children:"自主學習日"})})]},s))})})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:"學習筆記"}),jsxRuntimeExports.jsx("button",{className:"text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300 font-medium",children:"所有筆記"})]}),jsxRuntimeExports.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"今日反思"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"今天"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"今天閱讀了居禮夫人的生平，她的堅持和毅力讓我很受啟發。在遇到困難時也要像她一樣堅持..."}),jsxRuntimeExports.jsxs("div",{className:"mt-2 flex items-center",children:[jsxRuntimeExports.jsx(FileText,{size:14,className:"text-gray-400 mr-1"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"自然科學"})]})]}),jsxRuntimeExports.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"遊記初稿"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"昨天"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"上週去了海邊，我觀察到許多有趣的海洋生物。寫作過程中我發現可以加入更多細節..."}),jsxRuntimeExports.jsxs("div",{className:"mt-2 flex items-center",children:[jsxRuntimeExports.jsx(FileText,{size:14,className:"text-gray-400 mr-1"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"國語"})]})]})]})})]})]})]}),jsxRuntimeExports.jsx("div",{className:"mt-6",children:jsxRuntimeExports.jsx(ChatModule,{})})]})},colors={indigo:{100:"bg-indigo-100 dark:bg-indigo-900/30",500:"bg-indigo-500 dark:bg-indigo-500",600:"text-indigo-600 dark:text-indigo-400",border:"#4F46E5"},green:{100:"bg-green-100 dark:bg-green-900/30",500:"bg-green-500 dark:bg-green-500",600:"text-green-600 dark:text-green-400",border:"#16A34A"},orange:{100:"bg-orange-100 dark:bg-orange-900/30",500:"bg-orange-500 dark:bg-orange-500",600:"text-orange-600 dark:text-orange-400",border:"#EA580C"},purple:{100:"bg-purple-100 dark:bg-purple-900/30",500:"bg-purple-500 dark:bg-purple-500",600:"text-purple-600 dark:text-purple-400",border:"#9333EA"}},card={base:"bg-white dark:bg-gray-800 rounded-lg shadow",border:"border-l-4"},text={label:"text-sm font-medium text-gray-500 dark:text-gray-400",value:"text-2xl font-semibold text-gray-900 dark:text-white",title:"text-xl font-semibold text-gray-900 dark:text-white",link:"text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300 font-medium",name:"font-medium text-gray-900 dark:text-white",description:"text-sm text-gray-600 dark:text-gray-300",meta:"text-sm text-gray-500 dark:text-gray-400",activity:"text-sm font-medium text-gray-900 dark:text-white"},iconContainer={base:"flex-shrink-0 p-3 rounded-lg"},layout$1={section:{header:"flex items-center justify-between mb-4",content:"space-y-6",wrapper:"space-y-6"},icon:{wrapper:"mr-4 flex-shrink-0",circle:"h-8 w-8 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center",base:"text-indigo-600 dark:text-indigo-400"},activity:{container:"flex"},grid:{main:"grid grid-cols-1 xl:grid-cols-3 gap-6",sidebar:"xl:col-span-2 space-y-6"},card:{base:"bg-white dark:bg-gray-800 rounded-lg shadow",padding:"p-4",border:"border border-gray-200 dark:border-gray-700"},table:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",tableHeader:"bg-gray-50 dark:bg-gray-800/50",tableHeaderCell:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",tableRow:"hover:bg-gray-50 dark:hover:bg-gray-800/50",tableCell:"px-6 py-4 whitespace-nowrap"},subjects={colors:{國語:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-800 dark:text-blue-300",accent:"#3B82F6",gradient:"from-blue-400 to-blue-600"},英語:{bg:"bg-cyan-100 dark:bg-cyan-900/30",text:"text-cyan-800 dark:text-cyan-300",accent:"#06B6D4",gradient:"from-cyan-400 to-cyan-600"},數學:{bg:"bg-orange-100 dark:bg-orange-900/30",text:"text-orange-800 dark:text-orange-300",accent:"#F97316",gradient:"from-orange-400 to-orange-600"},自然:{bg:"bg-emerald-100 dark:bg-emerald-900/30",text:"text-emerald-800 dark:text-emerald-300",accent:"#10B981",gradient:"from-emerald-400 to-emerald-600"},社會:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-800 dark:text-amber-300",accent:"#F59E0B",gradient:"from-amber-400 to-amber-600"},藝術:{bg:"bg-fuchsia-100 dark:bg-fuchsia-900/30",text:"text-fuchsia-800 dark:text-fuchsia-300",accent:"#D946EF",gradient:"from-fuchsia-400 to-fuchsia-600"},體育:{bg:"bg-rose-100 dark:bg-rose-900/30",text:"text-rose-800 dark:text-rose-300",accent:"#E11D48",gradient:"from-rose-400 to-rose-600"},自訂:{bg:"bg-violet-100 dark:bg-violet-900/30",text:"text-violet-800 dark:text-violet-300",accent:"#8B5CF6",gradient:"from-violet-400 to-violet-600"}},getSubjectStyle:t=>{const e={bg:"bg-gray-100 dark:bg-gray-800",text:"text-gray-600 dark:text-gray-400",accent:"#6B7280",gradient:"from-purple-400 to-purple-600"};return subjects.colors[t]||e}},taskStyles={title:"text-sm font-medium text-gray-900 dark:text-white",description:"text-sm text-gray-600 dark:text-gray-300 break-words",status:{completed:"inline-flex px-2 py-0.5 rounded-full text-xs font-medium text-gray-600 dark:text-gray-400",in_progress:"inline-flex px-2 py-0.5 rounded-full text-xs font-medium text-gray-600 dark:text-gray-400",waiting_feedback:"inline-flex px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300",pending:"inline-flex px-2 py-0.5 rounded-full text-xs font-medium text-gray-600 dark:text-gray-400",overdue:"inline-flex px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"},badge:{feedback:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300"}},statsConfig=[{key:"studentCount",icon:User$1,label:"學生總數",color:"indigo"},{key:"completedTasks",icon:CircleCheckBig,label:"已完成任務",color:"green"},{key:"pendingTasks",icon:Clock,label:"待完成任務",color:"orange"},{key:"weeklyPlans",icon:Calendar$1,label:"本週計畫",color:"purple"}],StatsBlock=({data:t})=>jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:statsConfig.map(e=>jsxRuntimeExports.jsx("div",{className:`${card.base} ${card.border} p-4`,style:{borderLeftColor:colors[e.color].border},children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:`${iconContainer.base} ${colors[e.color][100]}`,children:jsxRuntimeExports.jsx(e.icon,{className:`h-6 w-6 ${colors[e.color][600]}`})}),jsxRuntimeExports.jsxs("div",{className:"ml-4",children:[jsxRuntimeExports.jsx("p",{className:text.label,children:e.label}),jsxRuntimeExports.jsx("p",{className:text.value,children:t[e.key]})]})]})},e.key))}),formatDate=t=>{const e=new Date;e.setHours(0,0,0,0);const r=new Date(t);r.setHours(0,0,0,0);const n=r.getTime()-e.getTime(),s=Math.ceil(n/(1e3*60*60*24));if(s===0)return"今天";if(s===1)return"明天";if(s===-1)return"昨天";const a=new Date(e);a.setDate(e.getDate()-e.getDay());const o=new Date(a);return o.setDate(a.getDate()+6),r>=a&&r<=o?["週日","週一","週二","週三","週四","週五","週六"][r.getDay()]:`${r.getMonth()+1}/${r.getDate()}`},getDueDateStyle=(t,e)=>{if(e==="completed"||e==="waiting_feedback")return"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium text-gray-600 dark:text-gray-400";const r=new Date;r.setHours(0,0,0,0);const n=new Date(t);n.setHours(0,0,0,0);const s=n.getTime()-r.getTime();return Math.ceil(s/(1e3*60*60*24))<0?"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300":"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium text-gray-600 dark:text-gray-400"},StudentProgressTable=({students:t,onViewDetails:e})=>{const[r,n]=reactExports.useState(new Set),s=l=>{const u=new Set(r);u.has(l)?u.delete(l):u.add(l),n(u)},a=l=>{switch(l){case"completed":return"已完成";case"in_progress":return"進行中";case"waiting_feedback":return"待回饋";case"overdue":return"已逾期";default:return"未開始"}},o=l=>{var c;let u=0;return(c=l.weeklyPlans)==null||c.forEach(d=>{u+=d.tasks.filter(p=>p.status==="overdue").length}),u};return jsxRuntimeExports.jsx("div",{className:`${layout$1.card.base} ${layout$1.card.border}`,children:jsxRuntimeExports.jsx("div",{className:layout$1.card.padding,children:jsxRuntimeExports.jsxs("table",{className:layout$1.table,children:[jsxRuntimeExports.jsx("thead",{className:layout$1.tableHeader,children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{className:`${layout$1.tableHeaderCell} w-3/12`,children:"學生"}),jsxRuntimeExports.jsx("th",{className:`${layout$1.tableHeaderCell} w-2/12`,children:"進度"}),jsxRuntimeExports.jsx("th",{className:`${layout$1.tableHeaderCell} w-2/12`,children:"關注項目"}),jsxRuntimeExports.jsx("th",{className:`${layout$1.tableHeaderCell} w-2/12`,children:"待回饋"}),jsxRuntimeExports.jsx("th",{className:`${layout$1.tableHeaderCell} w-2/12`,children:"最後活動"}),jsxRuntimeExports.jsx("th",{className:`${layout$1.tableHeaderCell} w-1/12`,children:"操作"})]})}),jsxRuntimeExports.jsx("tbody",{children:t.map(l=>jsxRuntimeExports.jsxs(React.Fragment,{children:[jsxRuntimeExports.jsxs("tr",{className:layout$1.tableRow,children:[jsxRuntimeExports.jsx("td",{className:layout$1.tableCell,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("img",{src:l.avatar,alt:l.name,className:"w-8 h-8 rounded-full mr-3"}),jsxRuntimeExports.jsx("span",{className:text.name,children:l.name})]})}),jsxRuntimeExports.jsx("td",{className:layout$1.tableCell,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700 mr-2",children:jsxRuntimeExports.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full dark:bg-blue-500",style:{width:`${l.progress}%`}})}),jsxRuntimeExports.jsxs("span",{className:text.meta,children:[l.progress,"%"]})]})}),jsxRuntimeExports.jsx("td",{className:layout$1.tableCell,children:o(l)>0?jsxRuntimeExports.jsx("span",{className:taskStyles.status.overdue,children:o(l)}):jsxRuntimeExports.jsx("span",{className:text.meta,children:"正常"})}),jsxRuntimeExports.jsx("td",{className:layout$1.tableCell,children:jsxRuntimeExports.jsx("span",{className:taskStyles.badge.feedback,children:l.pendingFeedback})}),jsxRuntimeExports.jsx("td",{className:layout$1.tableCell,children:jsxRuntimeExports.jsx("span",{className:text.meta,children:l.lastActive})}),jsxRuntimeExports.jsx("td",{className:`${layout$1.tableCell} text-center`,children:jsxRuntimeExports.jsx("button",{onClick:()=>s(l.id),className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:r.has(l.id)?jsxRuntimeExports.jsx(ChevronUp,{size:20}):jsxRuntimeExports.jsx(ChevronDown,{size:20})})})]}),r.has(l.id)&&jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{colSpan:6,className:"p-0",children:jsxRuntimeExports.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/50",children:l.weeklyPlans&&l.weeklyPlans.length>0?jsxRuntimeExports.jsx("div",{className:layout$1.section.content,children:l.weeklyPlans.map((u,c)=>jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center justify-between",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("h3",{className:text.name,children:u.curriculum}),jsxRuntimeExports.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${subjects.getSubjectStyle(u.subject).bg} ${subjects.getSubjectStyle(u.subject).text}`,children:[jsxRuntimeExports.jsx(BookOpen,{size:14,className:"mr-1"}),u.subject]})]})}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:u.tasks.map((d,p)=>jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-12 items-center bg-white dark:bg-gray-700/50 px-6 py-3 rounded-lg",children:[jsxRuntimeExports.jsx("div",{className:"col-span-3",children:jsxRuntimeExports.jsx("h3",{className:taskStyles.title,children:d.title})}),jsxRuntimeExports.jsx("div",{className:"col-span-5",children:jsxRuntimeExports.jsx("p",{className:taskStyles.description,children:d.description})}),jsxRuntimeExports.jsx("div",{className:"col-span-2 text-center",children:jsxRuntimeExports.jsxs("span",{className:getDueDateStyle(d.endDate,d.status),children:[jsxRuntimeExports.jsx(Clock,{size:14,className:"mr-1"}),formatDate(d.endDate)]})}),jsxRuntimeExports.jsx("div",{className:"col-span-2 text-right",children:jsxRuntimeExports.jsx("span",{className:taskStyles.status[d.status],children:a(d.status)})})]},`${l.id}-plan-${c}-task-${p}`))})]},`${l.id}-plan-${c}`))}):jsxRuntimeExports.jsx("div",{className:"text-center py-4 text-gray-500 dark:text-gray-400",children:"本週沒有安排的任務"})})})})]},l.id))})]})})})},AttentionBlock=({items:t})=>{const e=r=>({error:{border:"border-red-500",bg:"bg-red-50 dark:bg-red-900/10",icon:"text-red-400",title:"text-red-800 dark:text-red-300",description:"text-red-700 dark:text-red-200"},warning:{border:"border-orange-500",bg:"bg-orange-50 dark:bg-orange-900/10",icon:"text-orange-400",title:"text-orange-800 dark:text-orange-300",description:"text-orange-700 dark:text-orange-200"},success:{border:"border-blue-500",bg:"bg-blue-50 dark:bg-blue-900/10",icon:"text-blue-400",title:"text-blue-800 dark:text-blue-300",description:"text-blue-700 dark:text-blue-200"}})[r];return jsxRuntimeExports.jsx("div",{className:`${card.base} p-4`,children:jsxRuntimeExports.jsx("div",{className:"space-y-4",children:t.map((r,n)=>{const s=e(r.type);return jsxRuntimeExports.jsx("div",{className:`p-3 border-l-4 ${s.border} ${s.bg} rounded-r-lg`,children:jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:r.type==="success"?jsxRuntimeExports.jsx(TrendingUp,{className:`h-5 w-5 ${s.icon}`,"aria-hidden":"true"}):jsxRuntimeExports.jsx(TriangleAlert,{className:`h-5 w-5 ${s.icon}`,"aria-hidden":"true"})}),jsxRuntimeExports.jsxs("div",{className:"ml-3",children:[jsxRuntimeExports.jsx("h3",{className:`text-sm font-medium ${s.title}`,children:r.title}),jsxRuntimeExports.jsx("div",{className:`mt-1 text-sm ${s.description}`,children:jsxRuntimeExports.jsx("p",{children:r.description})})]})]})},n)})})})},TasksBlock=({tasks:t})=>jsxRuntimeExports.jsx("div",{className:`${card.base} p-4`,children:jsxRuntimeExports.jsx("div",{className:"space-y-4",children:t.map(e=>jsxRuntimeExports.jsxs("div",{className:"p-3 border border-gray-200 dark:border-gray-700 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:e.title}),jsxRuntimeExports.jsx("span",{className:getDueDateStyle(e.endDate,e.status),children:formatDate(e.endDate)})]}),jsxRuntimeExports.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:e.students.map((r,n)=>jsxRuntimeExports.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300",children:r},n))})]},e.id))})}),RecentActivitiesBlock=({activities:t})=>jsxRuntimeExports.jsx("div",{className:`${card.base} p-4`,children:jsxRuntimeExports.jsx("div",{className:layout$1.section.content,children:t.map(e=>jsxRuntimeExports.jsxs("div",{className:layout$1.activity.container,children:[jsxRuntimeExports.jsx("div",{className:layout$1.icon.wrapper,children:jsxRuntimeExports.jsx("div",{className:layout$1.icon.circle,children:jsxRuntimeExports.jsx(Book,{size:16,className:layout$1.icon.base})})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("p",{className:text.activity,children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:e.student})," ",e.activity]}),jsxRuntimeExports.jsx("p",{className:text.description,children:e.detail}),jsxRuntimeExports.jsx("p",{className:`mt-1 ${text.meta}`,children:e.time})]})]},e.id))})}),today$1=new Date,yesterday$1=new Date(today$1);yesterday$1.setDate(today$1.getDate()-1);const twoDaysAgo=new Date(today$1);twoDaysAgo.setDate(today$1.getDate()-2);const tomorrow$1=new Date(today$1);tomorrow$1.setDate(today$1.getDate()+1);const dayAfterTomorrow$1=new Date(today$1);dayAfterTomorrow$1.setDate(today$1.getDate()+2);const mockStudents=[{id:"1",name:"王小明",progress:75,subjects:[{name:"國語",progress:80},{name:"數學",progress:70},{name:"英語",progress:75}],avatar:"https://images.pexels.com/photos/2379004/pexels-photo-2379004.jpeg?auto=compress&cs=tinysrgb&w=150",completedTasks:3,totalTasks:5,lastActive:"今天",pendingFeedback:2,weeklyPlans:[{subject:"國語",curriculum:"第六課 - 生活中的科學",tasks:[{id:"t1",title:"寫一篇遊記",description:"選擇一個最近去過的地方，寫一篇遊記",startDate:today$1,endDate:dayAfterTomorrow$1,status:"in_progress",progress:30},{id:"t2",title:"課文朗讀練習",description:"練習課文朗讀並錄音",startDate:twoDaysAgo,endDate:twoDaysAgo,status:"in_progress",progress:50},{id:"t3",title:"詞語練習",description:"完成詞語練習作業",startDate:yesterday$1,endDate:today$1,status:"pending",progress:0}]},{subject:"自然",curriculum:"水的三態變化",tasks:[{id:"t6",title:"實驗報告",description:"完成水的三態變化實驗報告",startDate:yesterday$1,endDate:tomorrow$1,status:"waiting_feedback",progress:100},{id:"t7",title:"課堂練習",description:"完成課本練習題",startDate:today$1,endDate:today$1,status:"waiting_feedback",progress:100}]}]},{id:"2",name:"陳小美",progress:62,subjects:[{name:"國語",progress:65},{name:"數學",progress:55},{name:"英語",progress:72}],avatar:"https://images.pexels.com/photos/774909/pexels-photo-774909.jpeg?auto=compress&cs=tinysrgb&w=150",completedTasks:0,totalTasks:2,lastActive:"昨天",pendingFeedback:1,weeklyPlans:[{subject:"數學",curriculum:"分數的加減",tasks:[{id:"t4",title:"分數加減練習",description:"完成課本練習題",startDate:today$1,endDate:tomorrow$1,status:"in_progress",progress:50},{id:"t5",title:"情境應用題",description:"完成應用題作業",startDate:yesterday$1,endDate:today$1,status:"pending",progress:0}]}]},{id:"3",name:"林大文",progress:91,completedTasks:0,totalTasks:0,lastActive:"3 小時前",avatar:"https://images.pexels.com/photos/614810/pexels-photo-614810.jpeg?auto=compress&cs=tinysrgb&w=150",subjects:[{name:"國語",progress:92},{name:"數學",progress:88},{name:"英語",progress:95},{name:"自然",progress:89}],pendingFeedback:0}],today=new Date,yesterday=new Date(today);yesterday.setDate(today.getDate()-1);const tomorrow=new Date(today);tomorrow.setDate(today.getDate()+1);const dayAfterTomorrow=new Date(today);dayAfterTomorrow.setDate(today.getDate()+2);const recentActivities=[{id:"1",student:"王小明",activity:"完成了任務",detail:"水三態的科學實驗",time:"1 小時前"},{id:"2",student:"陳小美",activity:"提交了學習筆記",detail:"遊記初稿",time:"3 小時前"},{id:"3",student:"林大文",activity:"完成了測驗",detail:"英語單字測驗：95 分",time:"昨天"},{id:"4",student:"王小明",activity:"需要幫助",detail:"數學：分數除法",time:"昨天"},{id:"5",student:"陳小美",activity:"報名了活動",detail:"戶外教學：自然博物館",time:"2 天前"}],upcomingTasks=[{id:"1",title:"審核遊記作業",dueDate:"今天",students:["王小明","陳小美"]},{id:"2",title:"準備下週自然科實驗",dueDate:"明天",students:["全班"]},{id:"3",title:"英語對話練習",dueDate:"週五",students:["林大文"]}],attentionItems=[{type:"error",title:"任務進度延遲",description:"陳小美: 自然科作業已延遲 3 天"},{type:"warning",title:"學習時間不足",description:"王小明: 數學科學習時間連續兩週低於計畫"},{type:"success",title:"進步顯著",description:"林大文: 英語口說能力提升 25%"}],MentorDashboard=()=>{const t=useNavigate(),e={studentCount:mockStudents.length,completedTasks:mockStudents.reduce((r,n)=>r+n.completedTasks,0),pendingTasks:mockStudents.reduce((r,n)=>r+(n.totalTasks-n.completedTasks),0),weeklyPlans:5};return jsxRuntimeExports.jsxs(PageLayout,{title:"指導老師儀表板",children:[jsxRuntimeExports.jsxs("div",{className:layout$1.grid.main,children:[jsxRuntimeExports.jsxs("div",{className:layout$1.grid.sidebar,children:[jsxRuntimeExports.jsx("section",{className:layout$1.section.wrapper,children:jsxRuntimeExports.jsx(StatsBlock,{data:e})}),jsxRuntimeExports.jsxs("section",{className:layout$1.section.wrapper,children:[jsxRuntimeExports.jsx("div",{className:layout$1.section.header,children:jsxRuntimeExports.jsx("h2",{className:text.title,children:"學生進度總覽"})}),jsxRuntimeExports.jsx("div",{className:`${layout$1.card.base} overflow-hidden`,children:jsxRuntimeExports.jsx(StudentProgressTable,{students:mockStudents,onViewDetails:r=>t(`/mentor/students/${r}`)})})]})]}),jsxRuntimeExports.jsxs("div",{className:layout$1.section.wrapper,children:[jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("div",{className:layout$1.section.header,children:jsxRuntimeExports.jsx("h2",{className:text.title,children:"需要關注"})}),jsxRuntimeExports.jsx(AttentionBlock,{items:attentionItems})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsxs("div",{className:layout$1.section.header,children:[jsxRuntimeExports.jsx("h2",{className:text.title,children:"您的待辦事項"}),jsxRuntimeExports.jsx("button",{onClick:()=>t("/mentor/tasks"),className:text.link,children:"查看全部"})]}),jsxRuntimeExports.jsx(TasksBlock,{tasks:upcomingTasks})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsxs("div",{className:layout$1.section.header,children:[jsxRuntimeExports.jsx("h2",{className:text.title,children:"學生最近活動"}),jsxRuntimeExports.jsx("button",{onClick:()=>t("/mentor/activities"),className:text.link,children:"查看全部"})]}),jsxRuntimeExports.jsx(RecentActivitiesBlock,{activities:recentActivities})]})]})]}),jsxRuntimeExports.jsx("div",{className:"mt-6",children:jsxRuntimeExports.jsx(ChatModule,{})})]})},millisecondsInWeek=6048e5,millisecondsInDay=864e5,constructFromSymbol=Symbol.for("constructDateFrom");function constructFrom(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&constructFromSymbol in t?t[constructFromSymbol](e):t instanceof Date?new t.constructor(e):new Date(e)}function toDate(t,e){return constructFrom(e||t,t)}function addMonths(t,e,r){const n=toDate(t,r==null?void 0:r.in);if(isNaN(e))return constructFrom(t,NaN);if(!e)return n;const s=n.getDate(),a=constructFrom(t,n.getTime());a.setMonth(n.getMonth()+e+1,0);const o=a.getDate();return s>=o?a:(n.setFullYear(a.getFullYear(),a.getMonth(),s),n)}let defaultOptions$4={};function getDefaultOptions$2(){return defaultOptions$4}function startOfWeek(t,e){var l,u,c,d;const r=getDefaultOptions$2(),n=(e==null?void 0:e.weekStartsOn)??((u=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:u.weekStartsOn)??r.weekStartsOn??((d=(c=r.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??0,s=toDate(t,e==null?void 0:e.in),a=s.getDay(),o=(a<n?7:0)+a-n;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function startOfISOWeek(t,e){return startOfWeek(t,{...e,weekStartsOn:1})}function getISOWeekYear(t,e){const r=toDate(t,e==null?void 0:e.in),n=r.getFullYear(),s=constructFrom(r,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const a=startOfISOWeek(s),o=constructFrom(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=startOfISOWeek(o);return r.getTime()>=a.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function getTimezoneOffsetInMilliseconds(t){const e=toDate(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function normalizeDates(t,...e){const r=constructFrom.bind(null,e.find(n=>typeof n=="object"));return e.map(r)}function startOfDay(t,e){const r=toDate(t,e==null?void 0:e.in);return r.setHours(0,0,0,0),r}function differenceInCalendarDays(t,e,r){const[n,s]=normalizeDates(r==null?void 0:r.in,t,e),a=startOfDay(n),o=startOfDay(s),l=+a-getTimezoneOffsetInMilliseconds(a),u=+o-getTimezoneOffsetInMilliseconds(o);return Math.round((l-u)/millisecondsInDay)}function startOfISOWeekYear(t,e){const r=getISOWeekYear(t,e),n=constructFrom(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),startOfISOWeek(n)}function constructNow(t){return constructFrom(t,Date.now())}function isSameDay(t,e,r){const[n,s]=normalizeDates(r==null?void 0:r.in,t,e);return+startOfDay(n)==+startOfDay(s)}function isDate(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function isValid$1(t){return!(!isDate(t)&&typeof t!="number"||isNaN(+toDate(t)))}function endOfMonth(t,e){const r=toDate(t,e==null?void 0:e.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function normalizeInterval(t,e){const[r,n]=normalizeDates(t,e.start,e.end);return{start:r,end:n}}function eachDayOfInterval(t,e){const{start:r,end:n}=normalizeInterval(e==null?void 0:e.in,t);let s=+r>+n;const a=s?+r:+n,o=s?n:r;o.setHours(0,0,0,0);let l=1;const u=[];for(;+o<=a;)u.push(constructFrom(r,o)),o.setDate(o.getDate()+l),o.setHours(0,0,0,0);return s?u.reverse():u}function startOfMonth(t,e){const r=toDate(t,e==null?void 0:e.in);return r.setDate(1),r.setHours(0,0,0,0),r}function startOfYear(t,e){const r=toDate(t,e==null?void 0:e.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const formatDistanceLocale={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},formatDistance=(t,e,r)=>{let n;const s=formatDistanceLocale[t];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function buildFormatLongFn(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const dateFormats={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},timeFormats={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},formatLong={date:buildFormatLongFn({formats:dateFormats,defaultWidth:"full"}),time:buildFormatLongFn({formats:timeFormats,defaultWidth:"full"}),dateTime:buildFormatLongFn({formats:dateTimeFormats,defaultWidth:"full"})},formatRelativeLocale={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},formatRelative=(t,e,r,n)=>formatRelativeLocale[t];function buildLocalizeFn(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):o;s=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;s=t.values[l]||t.values[o]}const a=t.argumentCallback?t.argumentCallback(e):e;return s[a]}}const eraValues={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},quarterValues={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},monthValues={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},dayValues={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},formattingDayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ordinalNumber=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},localize={ordinalNumber,era:buildLocalizeFn({values:eraValues,defaultWidth:"wide"}),quarter:buildLocalizeFn({values:quarterValues,defaultWidth:"wide",argumentCallback:t=>t-1}),month:buildLocalizeFn({values:monthValues,defaultWidth:"wide"}),day:buildLocalizeFn({values:dayValues,defaultWidth:"wide"}),dayPeriod:buildLocalizeFn({values:dayPeriodValues,defaultWidth:"wide",formattingValues:formattingDayPeriodValues,defaultFormattingWidth:"wide"})};function buildMatchFn(t){return(e,r={})=>{const n=r.width,s=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(s);if(!a)return null;const o=a[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],u=Array.isArray(l)?findIndex$1(l,p=>p.test(o)):findKey(l,p=>p.test(o));let c;c=t.valueCallback?t.valueCallback(u):u,c=r.valueCallback?r.valueCallback(c):c;const d=e.slice(o.length);return{value:c,rest:d}}}function findKey(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function findIndex$1(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function buildMatchPatternFn(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const s=n[0],a=e.match(t.parsePattern);if(!a)return null;let o=t.valueCallback?t.valueCallback(a[0]):a[0];o=r.valueCallback?r.valueCallback(o):o;const l=e.slice(s.length);return{value:o,rest:l}}}const matchOrdinalNumberPattern=/^(\d+)(th|st|nd|rd)?/i,parseOrdinalNumberPattern=/\d+/i,matchEraPatterns={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},parseEraPatterns={any:[/^b/i,/^(a|c)/i]},matchQuarterPatterns={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},parseQuarterPatterns={any:[/1/i,/2/i,/3/i,/4/i]},matchMonthPatterns={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},parseMonthPatterns={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},matchDayPatterns={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},parseDayPatterns={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},matchDayPeriodPatterns={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},parseDayPeriodPatterns={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},match$1={ordinalNumber:buildMatchPatternFn({matchPattern:matchOrdinalNumberPattern,parsePattern:parseOrdinalNumberPattern,valueCallback:t=>parseInt(t,10)}),era:buildMatchFn({matchPatterns:matchEraPatterns,defaultMatchWidth:"wide",parsePatterns:parseEraPatterns,defaultParseWidth:"any"}),quarter:buildMatchFn({matchPatterns:matchQuarterPatterns,defaultMatchWidth:"wide",parsePatterns:parseQuarterPatterns,defaultParseWidth:"any",valueCallback:t=>t+1}),month:buildMatchFn({matchPatterns:matchMonthPatterns,defaultMatchWidth:"wide",parsePatterns:parseMonthPatterns,defaultParseWidth:"any"}),day:buildMatchFn({matchPatterns:matchDayPatterns,defaultMatchWidth:"wide",parsePatterns:parseDayPatterns,defaultParseWidth:"any"}),dayPeriod:buildMatchFn({matchPatterns:matchDayPeriodPatterns,defaultMatchWidth:"any",parsePatterns:parseDayPeriodPatterns,defaultParseWidth:"any"})},enUS={code:"en-US",formatDistance,formatLong,formatRelative,localize,match:match$1,options:{weekStartsOn:0,firstWeekContainsDate:1}};function getDayOfYear(t,e){const r=toDate(t,e==null?void 0:e.in);return differenceInCalendarDays(r,startOfYear(r))+1}function getISOWeek(t,e){const r=toDate(t,e==null?void 0:e.in),n=+startOfISOWeek(r)-+startOfISOWeekYear(r);return Math.round(n/millisecondsInWeek)+1}function getWeekYear(t,e){var d,p,m,y;const r=toDate(t,e==null?void 0:e.in),n=r.getFullYear(),s=getDefaultOptions$2(),a=(e==null?void 0:e.firstWeekContainsDate)??((p=(d=e==null?void 0:e.locale)==null?void 0:d.options)==null?void 0:p.firstWeekContainsDate)??s.firstWeekContainsDate??((y=(m=s.locale)==null?void 0:m.options)==null?void 0:y.firstWeekContainsDate)??1,o=constructFrom((e==null?void 0:e.in)||t,0);o.setFullYear(n+1,0,a),o.setHours(0,0,0,0);const l=startOfWeek(o,e),u=constructFrom((e==null?void 0:e.in)||t,0);u.setFullYear(n,0,a),u.setHours(0,0,0,0);const c=startOfWeek(u,e);return+r>=+l?n+1:+r>=+c?n:n-1}function startOfWeekYear(t,e){var l,u,c,d;const r=getDefaultOptions$2(),n=(e==null?void 0:e.firstWeekContainsDate)??((u=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:u.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(c=r.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??1,s=getWeekYear(t,e),a=constructFrom((e==null?void 0:e.in)||t,0);return a.setFullYear(s,0,n),a.setHours(0,0,0,0),startOfWeek(a,e)}function getWeek(t,e){const r=toDate(t,e==null?void 0:e.in),n=+startOfWeek(r,e)-+startOfWeekYear(r,e);return Math.round(n/millisecondsInWeek)+1}function addLeadingZeros(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const lightFormatters={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return addLeadingZeros(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):addLeadingZeros(r+1,2)},d(t,e){return addLeadingZeros(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return addLeadingZeros(t.getHours()%12||12,e.length)},H(t,e){return addLeadingZeros(t.getHours(),e.length)},m(t,e){return addLeadingZeros(t.getMinutes(),e.length)},s(t,e){return addLeadingZeros(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return addLeadingZeros(s,e.length)}},dayPeriodEnum={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},formatters$1={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return lightFormatters.y(t,e)},Y:function(t,e,r,n){const s=getWeekYear(t,n),a=s>0?s:1-s;if(e==="YY"){const o=a%100;return addLeadingZeros(o,2)}return e==="Yo"?r.ordinalNumber(a,{unit:"year"}):addLeadingZeros(a,e.length)},R:function(t,e){const r=getISOWeekYear(t);return addLeadingZeros(r,e.length)},u:function(t,e){const r=t.getFullYear();return addLeadingZeros(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return addLeadingZeros(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return addLeadingZeros(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return lightFormatters.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return addLeadingZeros(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const s=getWeek(t,n);return e==="wo"?r.ordinalNumber(s,{unit:"week"}):addLeadingZeros(s,e.length)},I:function(t,e,r){const n=getISOWeek(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):addLeadingZeros(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):lightFormatters.d(t,e)},D:function(t,e,r){const n=getDayOfYear(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):addLeadingZeros(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const s=t.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return addLeadingZeros(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const s=t.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return addLeadingZeros(a,e.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),s=n===0?7:n;switch(e){case"i":return String(s);case"ii":return addLeadingZeros(s,e.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let s;switch(n===12?s=dayPeriodEnum.noon:n===0?s=dayPeriodEnum.midnight:s=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let s;switch(n>=17?s=dayPeriodEnum.evening:n>=12?s=dayPeriodEnum.afternoon:n>=4?s=dayPeriodEnum.morning:s=dayPeriodEnum.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return lightFormatters.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):lightFormatters.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):addLeadingZeros(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):addLeadingZeros(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):lightFormatters.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):lightFormatters.s(t,e)},S:function(t,e){return lightFormatters.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return formatTimezoneWithOptionalMinutes(n);case"XXXX":case"XX":return formatTimezone(n);case"XXXXX":case"XXX":default:return formatTimezone(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return formatTimezoneWithOptionalMinutes(n);case"xxxx":case"xx":return formatTimezone(n);case"xxxxx":case"xxx":default:return formatTimezone(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+formatTimezoneShort(n,":");case"OOOO":default:return"GMT"+formatTimezone(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+formatTimezoneShort(n,":");case"zzzz":default:return"GMT"+formatTimezone(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return addLeadingZeros(n,e.length)},T:function(t,e,r){return addLeadingZeros(+t,e.length)}};function formatTimezoneShort(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=Math.trunc(n/60),a=n%60;return a===0?r+String(s):r+String(s)+e+addLeadingZeros(a,2)}function formatTimezoneWithOptionalMinutes(t,e){return t%60===0?(t>0?"-":"+")+addLeadingZeros(Math.abs(t)/60,2):formatTimezone(t,e)}function formatTimezone(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=addLeadingZeros(Math.trunc(n/60),2),a=addLeadingZeros(n%60,2);return r+s+e+a}const dateLongFormatter=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},timeLongFormatter=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},dateTimeLongFormatter=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return dateLongFormatter(t,e);let a;switch(n){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;case"PPPP":default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",dateLongFormatter(n,e)).replace("{{time}}",timeLongFormatter(s,e))},longFormatters={p:timeLongFormatter,P:dateTimeLongFormatter},dayOfYearTokenRE=/^D+$/,weekYearTokenRE=/^Y+$/,throwTokens=["D","DD","YY","YYYY"];function isProtectedDayOfYearToken(t){return dayOfYearTokenRE.test(t)}function isProtectedWeekYearToken(t){return weekYearTokenRE.test(t)}function warnOrThrowProtectedError(t,e,r){const n=message(t,e,r);if(console.warn(n),throwTokens.includes(t))throw new RangeError(n)}function message(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const formattingTokensRegExp=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,longFormattingTokensRegExp=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,escapedStringRegExp=/^'([^]*?)'?$/,doubleQuoteRegExp=/''/g,unescapedLatinCharacterRegExp=/[a-zA-Z]/;function format(t,e,r){var d,p,m,y;const n=getDefaultOptions$2(),s=n.locale??enUS,a=n.firstWeekContainsDate??((p=(d=n.locale)==null?void 0:d.options)==null?void 0:p.firstWeekContainsDate)??1,o=n.weekStartsOn??((y=(m=n.locale)==null?void 0:m.options)==null?void 0:y.weekStartsOn)??0,l=toDate(t,r==null?void 0:r.in);if(!isValid$1(l))throw new RangeError("Invalid time value");let u=e.match(longFormattingTokensRegExp).map(b=>{const E=b[0];if(E==="p"||E==="P"){const T=longFormatters[E];return T(b,s.formatLong)}return b}).join("").match(formattingTokensRegExp).map(b=>{if(b==="''")return{isToken:!1,value:"'"};const E=b[0];if(E==="'")return{isToken:!1,value:cleanEscapedString(b)};if(formatters$1[E])return{isToken:!0,value:b};if(E.match(unescapedLatinCharacterRegExp))throw new RangeError("Format string contains an unescaped latin alphabet character `"+E+"`");return{isToken:!1,value:b}});s.localize.preprocessor&&(u=s.localize.preprocessor(l,u));const c={firstWeekContainsDate:a,weekStartsOn:o,locale:s};return u.map(b=>{if(!b.isToken)return b.value;const E=b.value;(isProtectedWeekYearToken(E)||isProtectedDayOfYearToken(E))&&warnOrThrowProtectedError(E,e,String(t));const T=formatters$1[E[0]];return T(l,E,s.localize,c)}).join("")}function cleanEscapedString(t){const e=t.match(escapedStringRegExp);return e?e[1].replace(doubleQuoteRegExp,"'"):t}function isSameMonth(t,e,r){const[n,s]=normalizeDates(r==null?void 0:r.in,t,e);return n.getFullYear()===s.getFullYear()&&n.getMonth()===s.getMonth()}function isToday(t,e){return isSameDay(constructFrom(t,t),constructNow(t))}function subMonths(t,e,r){return addMonths(t,-1,r)}const Calendar=({events:t,onSelectDate:e,onSelectEvent:r,showImportantOnly:n=!1})=>{const[s,a]=reactExports.useState(new Date),[o,l]=reactExports.useState("month"),u=startOfMonth(s),c=endOfMonth(u),d=eachDayOfInterval({start:u,end:c}),p=["日","一","二","三","四","五","六"],m=t.filter(A=>{const I=new Date(A.date);return isSameMonth(I,s)&&(!n||A.isImportant)}),y=()=>a(subMonths(s)),b=()=>a(addMonths(s,1)),E=()=>a(new Date),T=()=>{l(o==="month"?"week":"month")},S=A=>m.filter(I=>isSameDay(new Date(I.date),A)),P=A=>{let I="h-24 border border-gray-200 dark:border-gray-700 p-1 transition duration-150";return isSameMonth(A,s)?isToday(A)?I+=" bg-indigo-50 dark:bg-indigo-900/30":I+=" bg-white dark:bg-gray-800":I+=" bg-gray-50 dark:bg-gray-900 text-gray-400",I};return jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"p-4 flex items-center justify-between border-b border-gray-200 dark:border-gray-700",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:format(s,"yyyy年 M月")}),jsxRuntimeExports.jsxs("div",{className:"flex space-x-2",children:[jsxRuntimeExports.jsx("button",{onClick:E,className:"px-3 py-1 text-sm rounded-md border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:"今天"}),jsxRuntimeExports.jsx("button",{onClick:T,className:"px-3 py-1 text-sm rounded-md border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:o==="month"?"週檢視":"月檢視"}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("button",{onClick:y,className:"p-1 rounded-l-md border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:jsxRuntimeExports.jsx(ChevronLeft,{size:16})}),jsxRuntimeExports.jsx("button",{onClick:b,className:"p-1 rounded-r-md border border-gray-300 dark:border-gray-600 border-l-0 hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:jsxRuntimeExports.jsx(ChevronRight,{size:16})})]})]})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-7 bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700",children:p.map((A,I)=>jsxRuntimeExports.jsx("div",{className:"p-2 text-center text-sm font-medium text-gray-700 dark:text-gray-300",children:A},I))}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-7 h-[600px] overflow-y-auto",children:d.map((A,I)=>jsxRuntimeExports.jsxs("div",{className:P(A),onClick:()=>e&&e(A),children:[jsxRuntimeExports.jsx("div",{className:"flex justify-between",children:jsxRuntimeExports.jsx("span",{className:`text-sm font-medium ${isToday(A)?"bg-indigo-600 text-white w-6 h-6 rounded-full flex items-center justify-center":"text-gray-700 dark:text-gray-300"}`,children:format(A,"d")})}),jsxRuntimeExports.jsx("div",{className:"mt-1 space-y-1 max-h-[80px] overflow-y-auto",children:S(A).map(j=>jsxRuntimeExports.jsxs("div",{onClick:K=>{K.stopPropagation(),r&&r(j)},className:`text-xs truncate px-2 py-1 rounded ${j.isImportant?"bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-300 border-l-2 border-orange-500":`bg-${j.color||"blue"}-100 dark:bg-${j.color||"blue"}-900/30 text-${j.color||"blue"}-800 dark:text-${j.color||"blue"}-300`} cursor-pointer hover:opacity-80 transition`,children:[j.startTime&&jsxRuntimeExports.jsxs("span",{className:"font-medium",children:[j.startTime," "]}),j.title]},j.id))})]},I))})]})},mockEvents=[{id:"1",title:"國語課",date:new Date,startTime:"10:30",endTime:"12:00",category:"國語",location:"主教室",color:"indigo",isImportant:!0},{id:"2",title:"自然科學",date:new Date,startTime:"13:00",endTime:"14:30",category:"自然",location:"科學教室",color:"green",isImportant:!1},{id:"3",title:"數學課",date:new Date(new Date().setDate(new Date().getDate()+2)),startTime:"09:00",endTime:"10:30",category:"數學",location:"主教室",color:"blue",isImportant:!1},{id:"4",title:"戶外教學",date:new Date(new Date().setDate(new Date().getDate()+7)),startTime:"08:30",endTime:"16:00",category:"社會",location:"自然博物館",color:"orange",isImportant:!0},{id:"5",title:"英語會話",date:new Date(new Date().setDate(new Date().getDate()-1)),startTime:"14:00",endTime:"15:30",category:"英語",location:"視訊教室",color:"purple",isImportant:!1}],StudentSchedule=()=>{const[t,e]=reactExports.useState(mockEvents),[r,n]=reactExports.useState(null),[s,a]=reactExports.useState(!1),[o,l]=reactExports.useState(!1),u=y=>{n(y),a(!0)},c=y=>{n({id:String(Date.now()),title:"",date:y,startTime:"",endTime:"",isImportant:!1}),a(!0)},d=y=>{t.find(b=>b.id===y.id)?e(t.map(b=>b.id===y.id?y:b)):e([...t,y]),a(!1),n(null)},p=y=>{e(t.filter(b=>b.id!==y)),a(!1),n(null)},m=()=>{a(!1),n(null)};return jsxRuntimeExports.jsxs(PageLayout,{title:"課表",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[jsxRuntimeExports.jsx("div",{className:"lg:col-span-3",children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:"月課表"}),jsxRuntimeExports.jsxs("div",{className:"flex space-x-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("input",{id:"showImportant",type:"checkbox",checked:o,onChange:()=>l(!o),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),jsxRuntimeExports.jsx("label",{htmlFor:"showImportant",className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"僅顯示重要事項"})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>c(new Date),className:"inline-flex items-center px-3 py-1.5 text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[jsxRuntimeExports.jsx(Plus,{size:16,className:"mr-1"}),"新增課程"]})]})]}),jsxRuntimeExports.jsx(Calendar,{events:t,onSelectDate:c,onSelectEvent:u,showImportantOnly:o})]})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-4",children:"課表類型"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx("button",{className:"w-full flex items-center px-4 py-2 text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"一般課表 (目前)"}),jsxRuntimeExports.jsx("button",{className:"w-full flex items-center px-4 py-2 text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-none",children:"旅行課表"}),jsxRuntimeExports.jsx("button",{className:"w-full flex items-center px-4 py-2 text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-none",children:"滑雪課表"}),jsxRuntimeExports.jsx("button",{className:"w-full flex items-center px-4 py-2 text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-none",children:"假期課表"})]}),jsxRuntimeExports.jsxs("div",{className:"mt-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-4",children:"即將到來的課程"}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:t.filter(y=>new Date(y.date)>=new Date).sort((y,b)=>new Date(y.date).getTime()-new Date(b.date).getTime()).slice(0,3).map((y,b)=>jsxRuntimeExports.jsxs("div",{className:"p-3 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800/70 cursor-pointer",onClick:()=>u(y),children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-start",children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:y.title}),y.isImportant&&jsxRuntimeExports.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300",children:"重要"})]}),jsxRuntimeExports.jsxs("div",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:[new Intl.DateTimeFormat("zh-TW",{month:"short",day:"numeric",weekday:"short"}).format(new Date(y.date)),y.startTime&&` · ${y.startTime} - ${y.endTime}`]}),y.category&&jsxRuntimeExports.jsx("div",{className:"mt-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-indigo-100 text-indigo-800 dark:bg-indigo-900/30 dark:text-indigo-300",children:y.category})]},b))})]})]})})]}),s&&r&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center border-b border-gray-200 dark:border-gray-700 p-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r.id?"編輯課程":"新增課程"}),jsxRuntimeExports.jsx("button",{onClick:m,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:jsxRuntimeExports.jsx(X,{size:20})})]}),jsxRuntimeExports.jsx("div",{className:"p-4",children:jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"標題"}),jsxRuntimeExports.jsx("input",{type:"text",id:"title",value:r.title,onChange:y=>n({...r,title:y.target.value}),className:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"課程名稱"})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"startTime",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"開始時間"}),jsxRuntimeExports.jsx("input",{type:"time",id:"startTime",value:r.startTime,onChange:y=>n({...r,startTime:y.target.value}),className:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"endTime",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"結束時間"}),jsxRuntimeExports.jsx("input",{type:"time",id:"endTime",value:r.endTime,onChange:y=>n({...r,endTime:y.target.value}),className:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"科目"}),jsxRuntimeExports.jsxs("select",{id:"category",value:r.category,onChange:y=>n({...r,category:y.target.value}),className:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[jsxRuntimeExports.jsx("option",{value:"",children:"選擇科目"}),jsxRuntimeExports.jsx("option",{value:"國語",children:"國語"}),jsxRuntimeExports.jsx("option",{value:"數學",children:"數學"}),jsxRuntimeExports.jsx("option",{value:"英語",children:"英語"}),jsxRuntimeExports.jsx("option",{value:"自然",children:"自然"}),jsxRuntimeExports.jsx("option",{value:"社會",children:"社會"}),jsxRuntimeExports.jsx("option",{value:"藝術",children:"藝術"}),jsxRuntimeExports.jsx("option",{value:"體育",children:"體育"}),jsxRuntimeExports.jsx("option",{value:"其他",children:"其他"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"地點"}),jsxRuntimeExports.jsx("input",{type:"text",id:"location",value:r.location,onChange:y=>n({...r,location:y.target.value}),className:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"上課地點"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("input",{id:"isImportant",type:"checkbox",checked:r.isImportant,onChange:y=>n({...r,isImportant:y.target.checked}),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),jsxRuntimeExports.jsx("label",{htmlFor:"isImportant",className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"標記為重要事項"})]})]})}),jsxRuntimeExports.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4 flex justify-end space-x-3",children:[r.id&&jsxRuntimeExports.jsx("button",{onClick:()=>p(r.id),className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 dark:text-red-300 dark:bg-red-900/30 dark:hover:bg-red-900/50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"刪除"}),jsxRuntimeExports.jsx("button",{onClick:m,className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-md text-gray-700 bg-gray-100 hover:bg-gray-200 dark:text-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"取消"}),jsxRuntimeExports.jsx("button",{onClick:()=>d(r),className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"儲存"})]})]})})]})},TaskList=({tasks:t,onStatusChange:e,onTaskSelect:r,groupBy:n="none"})=>{const[s,a]=reactExports.useState([]),o=y=>{s.includes(y)?a(s.filter(b=>b!==y)):a([...s,y])},u=n==="none"?{"All Tasks":t}:t.reduce((y,b)=>{let E;if(n==="subject")E=b.subject;else if(n==="priority")E=b.priority?b.priority.charAt(0).toUpperCase()+b.priority.slice(1):"Normal";else if(n==="dueDate"){const T=new Date;T.setHours(0,0,0,0);const S=new Date(b.endDate);S.setHours(0,0,0,0);const P=S.getTime()-T.getTime(),A=Math.ceil(P/(1e3*60*60*24));A<0?E="已過期":A===0?E="今天":A===1?E="明天":A<7?E="本週":E="未來"}else E="All Tasks";return y[E]||(y[E]=[]),y[E].push(b),y},{}),c=Object.keys(u),d=y=>{switch(y){case"high":return jsxRuntimeExports.jsx(CircleAlert,{size:16,className:"text-red-500"});case"medium":return jsxRuntimeExports.jsx(Clock,{size:16,className:"text-orange-500"});default:return jsxRuntimeExports.jsx(Clock,{size:16,className:"text-blue-500"})}},p=y=>{switch(y){case"completed":return jsxRuntimeExports.jsx(CircleCheckBig,{size:20,className:"text-green-500"});case"in_progress":return jsxRuntimeExports.jsx(Circle,{size:20,className:"text-blue-500 fill-blue-100"});case"waiting_feedback":return jsxRuntimeExports.jsx(Circle,{size:20,className:"text-orange-500 fill-orange-100"});case"overdue":return jsxRuntimeExports.jsx(CircleAlert,{size:20,className:"text-red-500"});default:return jsxRuntimeExports.jsx(Circle,{size:20,className:"text-gray-400"})}},m=y=>{const b=new Date;b.setHours(0,0,0,0);const E=new Date(y);E.setHours(0,0,0,0);const T=E.getTime()-b.getTime(),S=Math.ceil(T/(1e3*60*60*24));return S<0?"已過期":S===0?"今天":S===1?"明天":new Intl.DateTimeFormat("zh-TW",{month:"short",day:"numeric"}).format(E)};return jsxRuntimeExports.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:c.map(y=>{const b=s.includes(y)||n==="none",E=u[y];return jsxRuntimeExports.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700 last:border-b-0",children:[n!=="none"&&jsxRuntimeExports.jsxs("div",{className:"flex items-center px-4 py-3 bg-gray-50 dark:bg-gray-900 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-950 transition",onClick:()=>o(y),children:[jsxRuntimeExports.jsx("div",{className:"mr-2",children:b?jsxRuntimeExports.jsx(ChevronDown,{size:18}):jsxRuntimeExports.jsx(ChevronRight,{size:18})}),jsxRuntimeExports.jsx("h3",{className:"font-medium",children:y}),jsxRuntimeExports.jsxs("span",{className:"ml-2 text-sm text-gray-500 dark:text-gray-400",children:["(",E.length,")"]})]}),b&&jsxRuntimeExports.jsxs("ul",{children:[E.map(T=>jsxRuntimeExports.jsx("li",{className:"px-4 py-3 border-b border-gray-100 dark:border-gray-800 last:border-b-0 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition cursor-pointer",onClick:()=>r&&r(T),children:jsxRuntimeExports.jsxs("div",{className:"flex items-start",children:[jsxRuntimeExports.jsx("button",{className:"mt-0.5 mr-3 focus:outline-none",onClick:S=>{S.stopPropagation(),e==null||e(T.id,T.status==="completed"?"pending":"completed")},children:p(T.status)}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("p",{className:`font-medium ${T.status==="completed"?"text-gray-500 dark:text-gray-400 line-through":"text-gray-900 dark:text-white"}`,children:T.title}),jsxRuntimeExports.jsxs("div",{className:"flex items-center ml-2",children:[T.priority&&d(T.priority),jsxRuntimeExports.jsx("span",{className:`ml-1 text-xs ${T.status==="overdue"?"text-red-500":"text-gray-500"}`,children:m(T.endDate)})]})]}),T.description&&jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1 line-clamp-2",children:T.description}),jsxRuntimeExports.jsxs("div",{className:"flex items-center mt-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-indigo-100 text-indigo-800 dark:bg-indigo-900/30 dark:text-indigo-300",children:T.subject}),T.assignedBy&&jsxRuntimeExports.jsxs("span",{className:"ml-2 text-xs text-gray-500 dark:text-gray-400",children:["由 ",T.assignedBy," 指派"]}),T.progress>0&&jsxRuntimeExports.jsxs("span",{className:"ml-2 text-xs text-gray-500 dark:text-gray-400",children:["進度: ",T.progress,"%"]})]})]})]})},T.id)),E.length===0&&jsxRuntimeExports.jsx("li",{className:"px-4 py-8 text-center text-gray-500 dark:text-gray-400",children:"沒有任務"})]})]},y)})})},mockTasks=[{id:"1",title:"寫一篇遊記",description:"選擇一個最近去過的地方，寫一篇遊記",dueDate:new Date(new Date().setDate(new Date().getDate()+1)),completed:!1,subject:"國語",priority:"high",assignedBy:"陳老師"},{id:"2",title:"水三態的科學實驗",description:"準備水三態實驗的報告",dueDate:new Date(new Date().setDate(new Date().getDate()+3)),completed:!1,subject:"自然",priority:"medium",assignedBy:"林老師"},{id:"3",title:"閱讀課外讀物 - 科學家",description:"閱讀科學家的傳記並做筆記",dueDate:new Date,completed:!0,subject:"自然",priority:"low",assignedBy:"林老師"},{id:"4",title:"英語單字測驗準備",description:"準備下週的英語單字測驗，範圍：Unit 5-7",dueDate:new Date(new Date().setDate(new Date().getDate()+5)),completed:!1,subject:"英語",priority:"high",assignedBy:"王老師"},{id:"5",title:"數學練習題",description:"完成分數除法練習題",dueDate:new Date(new Date().setDate(new Date().getDate()+2)),completed:!1,subject:"數學",priority:"medium",assignedBy:"李老師"}],StudentTasks=()=>{const[t,e]=reactExports.useState(mockTasks),[r,n]=reactExports.useState("dueDate"),[s,a]=reactExports.useState(null),[o,l]=reactExports.useState(!1),u=d=>{e(t.map(p=>p.id===d?{...p,completed:!p.completed}:p))},c=d=>{a(d),l(!0)};return jsxRuntimeExports.jsx(PageLayout,{title:"任務列表",children:jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-4",children:[jsxRuntimeExports.jsxs("select",{value:r,onChange:d=>n(d.target.value),className:"block w-40 pl-3 pr-10 py-2 text-base border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[jsxRuntimeExports.jsx("option",{value:"none",children:"不分組"}),jsxRuntimeExports.jsx("option",{value:"subject",children:"依科目"}),jsxRuntimeExports.jsx("option",{value:"dueDate",children:"依到期日"}),jsxRuntimeExports.jsx("option",{value:"priority",children:"依優先順序"})]}),jsxRuntimeExports.jsxs("button",{className:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[jsxRuntimeExports.jsx(Funnel,{className:"h-4 w-4 mr-2"}),"篩選"]})]}),jsxRuntimeExports.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[jsxRuntimeExports.jsx(Plus,{className:"h-4 w-4 mr-2"}),"新增任務"]})]}),jsxRuntimeExports.jsx(TaskList,{tasks:t,onTaskToggle:u,onTaskSelect:c,groupBy:r})]})})},mockEntries=[{id:"1",title:"今日反思",content:"今天閱讀了居禮夫人的生平，她的堅持和毅力讓我很受啟發。在遇到困難時也要像她一樣堅持下去。我學到了很多關於放射性元素的知識，也對科學家的研究精神有了更深的認識。",date:new Date,subject:"自然科學",tags:["閱讀心得","科學家","反思"]},{id:"2",title:"遊記初稿",content:"上週去了海邊，我觀察到許多有趣的海洋生物。寫作過程中我發現可以加入更多細節來描述潮間帶的生態系統。下次修改時要著重描寫顏色和形狀的變化。",date:new Date(new Date().setDate(new Date().getDate()-1)),subject:"國語",tags:["作文","遊記","海洋生物"]},{id:"3",title:"數學解題思路",content:"今天學習了分數除法，一開始覺得很困難，但是在理解了倒數的概念後就豁然開朗。我發現把複雜的問題拆解成小步驟會更容易理解。",date:new Date(new Date().setDate(new Date().getDate()-2)),subject:"數學",tags:["解題技巧","分數","心得"]}],StudentJournal=()=>{const[t,e]=reactExports.useState(mockEntries),[r,n]=reactExports.useState(""),[s,a]=reactExports.useState("all"),o=t.filter(l=>{const u=l.title.toLowerCase().includes(r.toLowerCase())||l.content.toLowerCase().includes(r.toLowerCase())||l.tags.some(d=>d.toLowerCase().includes(r.toLowerCase())),c=s==="all"||l.subject===s;return u&&c});return jsxRuntimeExports.jsx(PageLayout,{title:"學習日誌",children:jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 w-full sm:w-auto",children:jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"搜尋日誌...",value:r,onChange:l=>n(l.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),jsxRuntimeExports.jsx(Search,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]})}),jsxRuntimeExports.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[jsxRuntimeExports.jsx(Plus,{className:"h-4 w-4 mr-2"}),"新增日誌"]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[jsxRuntimeExports.jsx("div",{className:"lg:col-span-2 space-y-6",children:o.map(l=>jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-start mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:l.title}),jsxRuntimeExports.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[jsxRuntimeExports.jsx(Calendar$1,{className:"h-4 w-4 mr-1"}),new Intl.DateTimeFormat("zh-TW",{year:"numeric",month:"long",day:"numeric"}).format(l.date)]})]}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4 whitespace-pre-line",children:l.content}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 dark:bg-indigo-900/30 dark:text-indigo-300",children:[jsxRuntimeExports.jsx(BookOpen,{className:"h-3 w-3 mr-1"}),l.subject]}),l.tags.map((u,c)=>jsxRuntimeExports.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300",children:[jsxRuntimeExports.jsx(Tag,{className:"h-3 w-3 mr-1"}),u]},c))]})]},l.id))}),jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"科目篩選"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>a("all"),className:`w-full text-left px-3 py-2 rounded-md text-sm ${s==="all"?"bg-indigo-100 text-indigo-800 dark:bg-indigo-900/30 dark:text-indigo-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"全部科目"}),["國語","數學","英語","自然科學","社會"].map(l=>jsxRuntimeExports.jsx("button",{onClick:()=>a(l),className:`w-full text-left px-3 py-2 rounded-md text-sm ${s===l?"bg-indigo-100 text-indigo-800 dark:bg-indigo-900/30 dark:text-indigo-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:l},l))]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"寫作提示"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4 text-sm text-gray-600 dark:text-gray-300",children:[jsxRuntimeExports.jsx("p",{children:"• 記錄今天學到的重要概念"}),jsxRuntimeExports.jsx("p",{children:"• 描述你遇到的困難和解決方法"}),jsxRuntimeExports.jsx("p",{children:"• 分享學習過程中的心得感受"}),jsxRuntimeExports.jsx("p",{children:"• 寫下還想深入了解的問題"}),jsxRuntimeExports.jsx("p",{children:"• 連結不同科目之間的關係"})]})]})]})]})]})})},progressData=[{subject:"國語",progress:65,color:"#4F46E5"},{subject:"數學",progress:78,color:"#0EA5E9"},{subject:"英語",progress:42,color:"#F97316"},{subject:"自然",progress:85,color:"#10B981"},{subject:"社會",progress:51,color:"#8B5CF6"}],mockGoals=[{id:"1",title:"完成科學讀物閱讀計畫",description:"閱讀三本科學相關的課外讀物，並完成閱讀心得",deadline:new Date(new Date().setDate(new Date().getDate()+30)),progress:65,subject:"自然",status:"in-progress"},{id:"2",title:"英語口說能力提升",description:"每週進行兩次英語口說練習，提升口語表達能力",deadline:new Date(new Date().setDate(new Date().getDate()+60)),progress:42,subject:"英語",status:"in-progress"},{id:"3",title:"數學解題技巧培養",description:"完成高階數學題目練習，培養邏輯思維能力",deadline:new Date(new Date().setDate(new Date().getDate()+15)),progress:78,subject:"數學",status:"in-progress"},{id:"4",title:"完成文學作品創作",description:"創作一篇原創短篇小說，字數不少於 3000 字",deadline:new Date(new Date().setDate(new Date().getDate()-5)),progress:100,subject:"國語",status:"completed"}],StudentGoals=()=>jsxRuntimeExports.jsx(PageLayout,{title:"目標與進度",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:"學習目標"}),jsxRuntimeExports.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[jsxRuntimeExports.jsx(Target,{className:"h-4 w-4 mr-2"}),"設定新目標"]})]}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:mockGoals.map(t=>jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-start mb-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-1",children:t.title}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:t.description})]}),jsxRuntimeExports.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.status==="completed"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":t.status==="overdue"?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300"}`,children:t.status==="completed"?"已完成":t.status==="overdue"?"已逾期":"進行中"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[jsxRuntimeExports.jsx(Clock,{className:"h-4 w-4 mr-1"}),"截止日期：",new Intl.DateTimeFormat("zh-TW",{year:"numeric",month:"long",day:"numeric"}).format(t.deadline)]}),jsxRuntimeExports.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[t.progress,"%"]})]}),jsxRuntimeExports.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:jsxRuntimeExports.jsx("div",{className:`h-2 rounded-full ${t.status==="completed"?"bg-green-600":t.status==="overdue"?"bg-red-600":"bg-indigo-600"}`,style:{width:`${t.progress}%`}})}),jsxRuntimeExports.jsx("div",{className:"mt-4",children:jsxRuntimeExports.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 dark:bg-indigo-900/30 dark:text-indigo-300",children:t.subject})})]},t.id))})]}),jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("div",{className:"flex justify-between items-center mb-4",children:jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:"近期里程碑"})}),jsxRuntimeExports.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsx("div",{className:"relative",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"h-8 w-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:jsxRuntimeExports.jsx(CircleCheck,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),jsxRuntimeExports.jsxs("div",{className:"ml-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"完成第一階段英語口說訓練"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"已完成 10 次口說練習，口語表達更加流暢"})]})]})}),jsxRuntimeExports.jsx("div",{className:"relative",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"h-8 w-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:jsxRuntimeExports.jsx(CircleCheck,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),jsxRuntimeExports.jsxs("div",{className:"ml-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"完成科學讀物閱讀"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"閱讀完成第二本科學讀物，並撰寫心得"})]})]})}),jsxRuntimeExports.jsx("div",{className:"relative",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center",children:jsxRuntimeExports.jsx(TrendingUp,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400"})}),jsxRuntimeExports.jsxs("div",{className:"ml-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"數學解題能力提升"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"最近一次測驗成績提升 15 分"})]})]})})]})})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("section",{children:[jsxRuntimeExports.jsx("div",{className:"flex justify-between items-center mb-4",children:jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:"整體學習進度"})}),jsxRuntimeExports.jsx(ProgressChart,{data:progressData})]}),jsxRuntimeExports.jsx("section",{children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"學習建議"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsx("div",{className:"h-8 w-8 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center",children:jsxRuntimeExports.jsx(TrendingUp,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"})})}),jsxRuntimeExports.jsx("div",{className:"ml-3",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"英語科目的進度較慢，建議增加口語練習的頻率"})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-start",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsx("div",{className:"h-8 w-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:jsxRuntimeExports.jsx(CircleCheck,{className:"h-5 w-5 text-green-600 dark:text-green-400"})})}),jsxRuntimeExports.jsx("div",{className:"ml-3",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"自然科學的學習成效良好，可以嘗試更具挑戰性的內容"})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-start",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:jsxRuntimeExports.jsx(Target,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})})}),jsxRuntimeExports.jsx("div",{className:"ml-3",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"建議設定更多短期目標，幫助追蹤學習進度"})})]})]})]})})]})]})}),MentorTaskManager=()=>jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h1",{children:"Mentor Task Manager"})}),SubjectPage=({isMentor:t=!1})=>{const{subjectId:e}=useParams(),n={國語:{name:"國語",progress:65,currentUnit:"第六課：春天的雨",nextAssessment:"作文：遊記",recentActivities:[{type:"task",title:"完成遊記初稿",date:"2024/03/15"},{type:"note",title:"課文筆記：春天的意象",date:"2024/03/14"},{type:"assessment",title:"單元測驗：85分",date:"2024/03/12"}]},數學:{name:"數學",progress:78,currentUnit:"單元四：分數除法",nextAssessment:"單元測驗：分數運算",recentActivities:[{type:"task",title:"完成練習題 4-2",date:"2024/03/15"},{type:"note",title:"解題技巧：分數除法",date:"2024/03/14"},{type:"assessment",title:"小考：90分",date:"2024/03/13"}]},英語:{name:"English",progress:42,currentUnit:"Unit 5: Daily Life",nextAssessment:"Oral Test: Daily Conversation",recentActivities:[{type:"task",title:"完成單字練習",date:"2024/03/15"},{type:"note",title:"文法筆記：現在進行式",date:"2024/03/14"},{type:"assessment",title:"單字測驗：75分",date:"2024/03/12"}]},自然:{name:"自然科學",progress:85,currentUnit:"物質的三態變化",nextAssessment:"實驗報告：水的三態",recentActivities:[{type:"task",title:"完成實驗記錄",date:"2024/03/15"},{type:"note",title:"實驗觀察筆記",date:"2024/03/14"},{type:"assessment",title:"實驗操作評量：95分",date:"2024/03/12"}]}}[e];return n?jsxRuntimeExports.jsx(PageLayout,{title:n.name,children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[jsxRuntimeExports.jsx("section",{children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:n.currentUnit}),jsxRuntimeExports.jsxs("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:["目前進度：",n.progress,"%"]})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center",children:jsxRuntimeExports.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 w-32",children:jsxRuntimeExports.jsx("div",{className:"bg-indigo-600 dark:bg-indigo-500 h-2.5 rounded-full",style:{width:`${n.progress}%`}})})})]}),jsxRuntimeExports.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"近期活動"}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:n.recentActivities.map((s,a)=>jsxRuntimeExports.jsxs("div",{className:"flex items-start",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsx("div",{className:`h-8 w-8 rounded-full flex items-center justify-center ${s.type==="task"?"bg-blue-100 dark:bg-blue-900/30":s.type==="note"?"bg-green-100 dark:bg-green-900/30":"bg-purple-100 dark:bg-purple-900/30"}`,children:s.type==="task"?jsxRuntimeExports.jsx(CircleCheckBig,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}):s.type==="note"?jsxRuntimeExports.jsx(BookOpen,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):jsxRuntimeExports.jsx(TriangleAlert,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})})}),jsxRuntimeExports.jsxs("div",{className:"ml-4",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:s.title}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.date})]})]},a))})]})]})}),jsxRuntimeExports.jsx("section",{children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"學習資源"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"推薦教材"}),jsxRuntimeExports.jsxs("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-300",children:[jsxRuntimeExports.jsx("li",{children:"• 課本隨堂練習"}),jsxRuntimeExports.jsx("li",{children:"• 補充教材"}),jsxRuntimeExports.jsx("li",{children:"• 線上影片教學"}),jsxRuntimeExports.jsx("li",{children:"• 互動式練習"})]})]}),jsxRuntimeExports.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"延伸學習"}),jsxRuntimeExports.jsxs("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-300",children:[jsxRuntimeExports.jsx("li",{children:"• 相關課外讀物"}),jsxRuntimeExports.jsx("li",{children:"• 實踐活動建議"}),jsxRuntimeExports.jsx("li",{children:"• 進階練習題"}),jsxRuntimeExports.jsx("li",{children:"• 小組討論主題"})]})]})]})]})})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsx("section",{children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"即將到來"}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx(Clock,{className:"h-5 w-5 text-gray-400 mr-3"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"下次評量"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n.nextAssessment})]})]})})]})}),t&&jsxRuntimeExports.jsx("section",{children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"教學建議"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4 text-sm text-gray-600 dark:text-gray-300",children:[jsxRuntimeExports.jsx("p",{children:"• 根據學生最近的表現，建議加強口語練習"}),jsxRuntimeExports.jsx("p",{children:"• 可以考慮增加實作練習的比重"}),jsxRuntimeExports.jsx("p",{children:"• 建議進行小組討論活動"}),jsxRuntimeExports.jsx("p",{children:"• 可以引入更多生活化的例子"})]})]})}),jsxRuntimeExports.jsx("section",{children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"學習提醒"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4 text-sm text-gray-600 dark:text-gray-300",children:[jsxRuntimeExports.jsx("p",{children:"• 記得複習今天學習的重點"}),jsxRuntimeExports.jsx("p",{children:"• 準備下次課程需要的材料"}),jsxRuntimeExports.jsx("p",{children:"• 完成作業後自我檢查"}),jsxRuntimeExports.jsx("p",{children:"• 有問題及時詢問老師"})]})]})})]})]})}):jsxRuntimeExports.jsx(PageLayout,{title:"科目不存在",children:jsxRuntimeExports.jsx("div",{className:"text-center py-12",children:jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"找不到該科目的資料"})})})},NotFound=()=>{const{currentUser:t}=useUser(),e=(t==null?void 0:t.role)==="student"?"/student":"/mentor";return jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950 flex flex-col items-center justify-center p-4",children:jsxRuntimeExports.jsxs("div",{className:"max-w-md w-full text-center",children:[jsxRuntimeExports.jsx("div",{className:"w-24 h-24 bg-indigo-100 dark:bg-indigo-900/30 rounded-full mx-auto flex items-center justify-center mb-6",children:jsxRuntimeExports.jsx(BookOpen,{size:40,className:"text-indigo-600 dark:text-indigo-400"})}),jsxRuntimeExports.jsx("h1",{className:"text-6xl font-bold text-gray-900 dark:text-white mb-2",children:"404"}),jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold text-gray-800 dark:text-gray-100 mb-4",children:"頁面未找到"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-8",children:"抱歉，您要尋找的頁面不存在或已被移除。"}),jsxRuntimeExports.jsxs(Link,{to:e,className:"inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[jsxRuntimeExports.jsx(House,{size:20,className:"mr-2"}),"返回首頁"]})]})})},mockTemplates=[{id:"1",title:"自然科學基礎課程",description:"適合國小高年級的基礎自然科學課程",subjects:["自然科學"],duration:"一學期",objectives:["理解基本科學概念","培養觀察能力","學習實驗方法"]},{id:"2",title:"數學思維訓練",description:"培養邏輯思維和解題能力",subjects:["數學"],duration:"一學期",objectives:["強化邏輯推理","提升解題技巧","建立數學概念"]}],CurriculumPlanner=({onCreatePlan:t,onImportPlan:e})=>{const[r,n]=reactExports.useState(""),[s,a]=reactExports.useState(!1),o=l=>{var c;const u=(c=l.target.files)==null?void 0:c[0];u&&e&&e(u)};return jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>a(!0),className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[jsxRuntimeExports.jsx(Plus,{className:"h-6 w-6 text-indigo-500 mb-2"}),jsxRuntimeExports.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"建立新課程"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"從頭開始規劃新的課程"})]}),jsxRuntimeExports.jsxs("label",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors cursor-pointer",children:[jsxRuntimeExports.jsx("input",{type:"file",className:"hidden",onChange:o,accept:".csv,.xlsx"}),jsxRuntimeExports.jsx(Upload,{className:"h-6 w-6 text-green-500 mb-2"}),jsxRuntimeExports.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"匯入課程"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"從 CSV 或 Excel 匯入"})]}),jsxRuntimeExports.jsxs("button",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[jsxRuntimeExports.jsx(Download,{className:"h-6 w-6 text-blue-500 mb-2"}),jsxRuntimeExports.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"匯出課程"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"下載課程規劃範本"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"課程範本庫"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:mockTemplates.map(l=>jsxRuntimeExports.jsxs("div",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors cursor-pointer",onClick:()=>n(l.id),children:[jsxRuntimeExports.jsx("div",{className:"flex items-start justify-between",children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h3",{className:"font-medium text-gray-900 dark:text-white flex items-center",children:[jsxRuntimeExports.jsx(BookOpen,{className:"h-4 w-4 mr-2 text-indigo-500"}),l.title]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:l.description})]})}),jsxRuntimeExports.jsxs("div",{className:"mt-4 space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[jsxRuntimeExports.jsx(Target,{className:"h-4 w-4 mr-2"}),jsxRuntimeExports.jsxs("span",{children:["目標：",l.objectives[0]]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[jsxRuntimeExports.jsx(Clock,{className:"h-4 w-4 mr-2"}),jsxRuntimeExports.jsxs("span",{children:["時長：",l.duration]})]})]}),jsxRuntimeExports.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:l.subjects.map((u,c)=>jsxRuntimeExports.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 dark:bg-indigo-900/30 dark:text-indigo-300",children:u},c))})]},l.id))})]}),s&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:jsxRuntimeExports.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full",children:jsxRuntimeExports.jsxs("div",{className:"p-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"選擇課程範本"}),jsxRuntimeExports.jsxs("div",{className:"mt-4 flex justify-end space-x-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 dark:text-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 rounded-md",children:"取消"}),jsxRuntimeExports.jsx("button",{onClick:()=>{a(!1)},className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-md",children:"使用範本"})]})]})})})]})},LayoutGroupContext=reactExports.createContext({});function useConstant(t){const e=reactExports.useRef(null);return e.current===null&&(e.current=t()),e.current}const isBrowser$2=typeof window<"u",useIsomorphicLayoutEffect$4=isBrowser$2?reactExports.useLayoutEffect:reactExports.useEffect,PresenceContext=reactExports.createContext(null);function addUniqueItem(t,e){t.indexOf(e)===-1&&t.push(e)}function removeItem(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}const clamp$2=(t,e,r)=>r>e?e:r<t?t:r;let invariant$2=()=>{};const MotionGlobalConfig={},isNumericalString=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function isObject(t){return typeof t=="object"&&t!==null}const isZeroValueString=t=>/^0[^.\s]+$/u.test(t);function memo(t){let e;return()=>(e===void 0&&(e=t()),e)}const noop$6=t=>t,combineFunctions=(t,e)=>r=>e(t(r)),pipe=(...t)=>t.reduce(combineFunctions),progress=(t,e,r)=>{const n=e-t;return n===0?1:(r-t)/n};class SubscriptionManager{constructor(){this.subscriptions=[]}add(e){return addUniqueItem(this.subscriptions,e),()=>removeItem(this.subscriptions,e)}notify(e,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,r,n);else for(let a=0;a<s;a++){const o=this.subscriptions[a];o&&o(e,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const secondsToMilliseconds=t=>t*1e3,millisecondsToSeconds=t=>t/1e3;function velocityPerSecond(t,e){return e?t*(1e3/e):0}const calcBezier=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,subdivisionPrecision=1e-7,subdivisionMaxIterations=12;function binarySubdivide(t,e,r,n,s){let a,o,l=0;do o=e+(r-e)/2,a=calcBezier(o,n,s)-t,a>0?r=o:e=o;while(Math.abs(a)>subdivisionPrecision&&++l<subdivisionMaxIterations);return o}function cubicBezier(t,e,r,n){if(t===e&&r===n)return noop$6;const s=a=>binarySubdivide(a,0,1,t,r);return a=>a===0||a===1?a:calcBezier(s(a),e,n)}const mirrorEasing=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,reverseEasing=t=>e=>1-t(1-e),backOut=cubicBezier(.33,1.53,.69,.99),backIn=reverseEasing(backOut),backInOut=mirrorEasing(backIn),anticipate=t=>(t*=2)<1?.5*backIn(t):.5*(2-Math.pow(2,-10*(t-1))),circIn=t=>1-Math.sin(Math.acos(t)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circIn),easeIn=cubicBezier(.42,0,1,1),easeOut=cubicBezier(0,0,.58,1),easeInOut=cubicBezier(.42,0,.58,1),isEasingArray=t=>Array.isArray(t)&&typeof t[0]!="number",isBezierDefinition=t=>Array.isArray(t)&&typeof t[0]=="number",easingLookup={linear:noop$6,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate},isValidEasing=t=>typeof t=="string",easingDefinitionToFunction=t=>{if(isBezierDefinition(t)){invariant$2(t.length===4);const[e,r,n,s]=t;return cubicBezier(e,r,n,s)}else if(isValidEasing(t))return easingLookup[t];return t},stepsOrder=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function createRenderStep(t,e){let r=new Set,n=new Set,s=!1,a=!1;const o=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function u(d){o.has(d)&&(c.schedule(d),t()),d(l)}const c={schedule:(d,p=!1,m=!1)=>{const b=m&&s?r:n;return p&&o.add(d),b.has(d)||b.add(d),d},cancel:d=>{n.delete(d),o.delete(d)},process:d=>{if(l=d,s){a=!0;return}s=!0,[r,n]=[n,r],r.forEach(u),r.clear(),s=!1,a&&(a=!1,c.process(d))}};return c}const maxElapsed=40;function createRenderBatcher(t,e){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,o=stepsOrder.reduce((A,I)=>(A[I]=createRenderStep(a),A),{}),{setup:l,read:u,resolveKeyframes:c,preUpdate:d,update:p,preRender:m,render:y,postRender:b}=o,E=()=>{const A=MotionGlobalConfig.useManualTiming?s.timestamp:performance.now();r=!1,MotionGlobalConfig.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(A-s.timestamp,maxElapsed),1)),s.timestamp=A,s.isProcessing=!0,l.process(s),u.process(s),c.process(s),d.process(s),p.process(s),m.process(s),y.process(s),b.process(s),s.isProcessing=!1,r&&e&&(n=!1,t(E))},T=()=>{r=!0,n=!0,s.isProcessing||t(E)};return{schedule:stepsOrder.reduce((A,I)=>{const j=o[I];return A[I]=(K,W=!1,H=!1)=>(r||T(),j.schedule(K,W,H)),A},{}),cancel:A=>{for(let I=0;I<stepsOrder.length;I++)o[stepsOrder[I]].cancel(A)},state:s,steps:o}}const{schedule:frame$1,cancel:cancelFrame,state:frameData,steps:frameSteps}=createRenderBatcher(typeof requestAnimationFrame<"u"?requestAnimationFrame:noop$6,!0);let now$1;function clearTime(){now$1=void 0}const time={now:()=>(now$1===void 0&&time.set(frameData.isProcessing||MotionGlobalConfig.useManualTiming?frameData.timestamp:performance.now()),now$1),set:t=>{now$1=t,queueMicrotask(clearTime)}},checkStringStartsWith=t=>e=>typeof e=="string"&&e.startsWith(t),isCSSVariableName=checkStringStartsWith("--"),startsAsVariableToken=checkStringStartsWith("var(--"),isCSSVariableToken=t=>startsAsVariableToken(t)?singleCssVariableRegex.test(t.split("/*")[0].trim()):!1,singleCssVariableRegex=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,number={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},alpha={...number,transform:t=>clamp$2(0,1,t)},scale={...number,default:1},sanitize=t=>Math.round(t*1e5)/1e5,floatRegex=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function isNullish(t){return t==null}const singleColorRegex=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,isColorString=(t,e)=>r=>!!(typeof r=="string"&&singleColorRegex.test(r)&&r.startsWith(t)||e&&!isNullish(r)&&Object.prototype.hasOwnProperty.call(r,e)),splitColor=(t,e,r)=>n=>{if(typeof n!="string")return n;const[s,a,o,l]=n.match(floatRegex);return{[t]:parseFloat(s),[e]:parseFloat(a),[r]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},clampRgbUnit=t=>clamp$2(0,255,t),rgbUnit={...number,transform:t=>Math.round(clampRgbUnit(t))},rgba$1={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:n=1})=>"rgba("+rgbUnit.transform(t)+", "+rgbUnit.transform(e)+", "+rgbUnit.transform(r)+", "+sanitize(alpha.transform(n))+")"};function parseHex(t){let e="",r="",n="",s="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),n=t.substring(3,4),s=t.substring(4,5),e+=e,r+=r,n+=n,s+=s),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const hex$1={test:isColorString("#"),parse:parseHex,transform:rgba$1.transform},createUnitType=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),degrees$1=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage={...percent,parse:t=>percent.parse(t)/100,transform:t=>percent.transform(t*100)},hsla$1={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:n=1})=>"hsla("+Math.round(t)+", "+percent.transform(sanitize(e))+", "+percent.transform(sanitize(r))+", "+sanitize(alpha.transform(n))+")"},color$2={test:t=>rgba$1.test(t)||hex$1.test(t)||hsla$1.test(t),parse:t=>rgba$1.test(t)?rgba$1.parse(t):hsla$1.test(t)?hsla$1.parse(t):hex$1.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?rgba$1.transform(t):hsla$1.transform(t)},colorRegex=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function test(t){var e,r;return isNaN(t)&&typeof t=="string"&&(((e=t.match(floatRegex))==null?void 0:e.length)||0)+(((r=t.match(colorRegex))==null?void 0:r.length)||0)>0}const NUMBER_TOKEN="number",COLOR_TOKEN="color",VAR_TOKEN="var",VAR_FUNCTION_TOKEN="var(",SPLIT_TOKEN="${}",complexRegex=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function analyseComplexValue(t){const e=t.toString(),r=[],n={color:[],number:[],var:[]},s=[];let a=0;const l=e.replace(complexRegex,u=>(color$2.test(u)?(n.color.push(a),s.push(COLOR_TOKEN),r.push(color$2.parse(u))):u.startsWith(VAR_FUNCTION_TOKEN)?(n.var.push(a),s.push(VAR_TOKEN),r.push(u)):(n.number.push(a),s.push(NUMBER_TOKEN),r.push(parseFloat(u))),++a,SPLIT_TOKEN)).split(SPLIT_TOKEN);return{values:r,split:l,indexes:n,types:s}}function parseComplexValue(t){return analyseComplexValue(t).values}function createTransformer(t){const{split:e,types:r}=analyseComplexValue(t),n=e.length;return s=>{let a="";for(let o=0;o<n;o++)if(a+=e[o],s[o]!==void 0){const l=r[o];l===NUMBER_TOKEN?a+=sanitize(s[o]):l===COLOR_TOKEN?a+=color$2.transform(s[o]):a+=s[o]}return a}}const convertNumbersToZero=t=>typeof t=="number"?0:t;function getAnimatableNone$1(t){const e=parseComplexValue(t);return createTransformer(t)(e.map(convertNumbersToZero))}const complex={test,parse:parseComplexValue,createTransformer,getAnimatableNone:getAnimatableNone$1};function hueToRgb(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function hslaToRgba({hue:t,saturation:e,lightness:r,alpha:n}){t/=360,e/=100,r/=100;let s=0,a=0,o=0;if(!e)s=a=o=r;else{const l=r<.5?r*(1+e):r+e-r*e,u=2*r-l;s=hueToRgb(u,l,t+1/3),a=hueToRgb(u,l,t),o=hueToRgb(u,l,t-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:n}}function mixImmediate(t,e){return r=>r>0?e:t}const mixNumber$1=(t,e,r)=>t+(e-t)*r,mixLinearColor=(t,e,r)=>{const n=t*t,s=r*(e*e-n)+n;return s<0?0:Math.sqrt(s)},colorTypes=[hex$1,rgba$1,hsla$1],getColorType=t=>colorTypes.find(e=>e.test(t));function asRGBA(t){const e=getColorType(t);if(!e)return!1;let r=e.parse(t);return e===hsla$1&&(r=hslaToRgba(r)),r}const mixColor=(t,e)=>{const r=asRGBA(t),n=asRGBA(e);if(!r||!n)return mixImmediate(t,e);const s={...r};return a=>(s.red=mixLinearColor(r.red,n.red,a),s.green=mixLinearColor(r.green,n.green,a),s.blue=mixLinearColor(r.blue,n.blue,a),s.alpha=mixNumber$1(r.alpha,n.alpha,a),rgba$1.transform(s))},invisibleValues=new Set(["none","hidden"]);function mixVisibility(t,e){return invisibleValues.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}function mixNumber(t,e){return r=>mixNumber$1(t,e,r)}function getMixer(t){return typeof t=="number"?mixNumber:typeof t=="string"?isCSSVariableToken(t)?mixImmediate:color$2.test(t)?mixColor:mixComplex:Array.isArray(t)?mixArray:typeof t=="object"?color$2.test(t)?mixColor:mixObject:mixImmediate}function mixArray(t,e){const r=[...t],n=r.length,s=t.map((a,o)=>getMixer(a)(a,e[o]));return a=>{for(let o=0;o<n;o++)r[o]=s[o](a);return r}}function mixObject(t,e){const r={...t,...e},n={};for(const s in r)t[s]!==void 0&&e[s]!==void 0&&(n[s]=getMixer(t[s])(t[s],e[s]));return s=>{for(const a in n)r[a]=n[a](s);return r}}function matchOrder(t,e){const r=[],n={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const a=e.types[s],o=t.indexes[a][n[a]],l=t.values[o]??0;r[s]=l,n[a]++}return r}const mixComplex=(t,e)=>{const r=complex.createTransformer(e),n=analyseComplexValue(t),s=analyseComplexValue(e);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?invisibleValues.has(t)&&!s.values.length||invisibleValues.has(e)&&!n.values.length?mixVisibility(t,e):pipe(mixArray(matchOrder(n,s),s.values),r):mixImmediate(t,e)};function mix(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?mixNumber$1(t,e,r):getMixer(t)(t,e)}const frameloopDriver=t=>{const e=({timestamp:r})=>t(r);return{start:(r=!0)=>frame$1.update(e,r),stop:()=>cancelFrame(e),now:()=>frameData.isProcessing?frameData.timestamp:time.now()}},generateLinearEasing=(t,e,r=10)=>{let n="";const s=Math.max(Math.round(e/r),2);for(let a=0;a<s;a++)n+=t(a/(s-1))+", ";return`linear(${n.substring(0,n.length-2)})`},maxGeneratorDuration=2e4;function calcGeneratorDuration(t){let e=0;const r=50;let n=t.next(e);for(;!n.done&&e<maxGeneratorDuration;)e+=r,n=t.next(e);return e>=maxGeneratorDuration?1/0:e}function createGeneratorEasing(t,e=100,r){const n=r({...t,keyframes:[0,e]}),s=Math.min(calcGeneratorDuration(n),maxGeneratorDuration);return{type:"keyframes",ease:a=>n.next(s*a).value/e,duration:millisecondsToSeconds(s)}}const velocitySampleDuration=5;function calcGeneratorVelocity(t,e,r){const n=Math.max(e-velocitySampleDuration,0);return velocityPerSecond(r-t(n),e-n)}const springDefaults={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},safeMin=.001;function findSpring({duration:t=springDefaults.duration,bounce:e=springDefaults.bounce,velocity:r=springDefaults.velocity,mass:n=springDefaults.mass}){let s,a,o=1-e;o=clamp$2(springDefaults.minDamping,springDefaults.maxDamping,o),t=clamp$2(springDefaults.minDuration,springDefaults.maxDuration,millisecondsToSeconds(t)),o<1?(s=c=>{const d=c*o,p=d*t,m=d-r,y=calcAngularFreq(c,o),b=Math.exp(-p);return safeMin-m/y*b},a=c=>{const p=c*o*t,m=p*r+r,y=Math.pow(o,2)*Math.pow(c,2)*t,b=Math.exp(-p),E=calcAngularFreq(Math.pow(c,2),o);return(-s(c)+safeMin>0?-1:1)*((m-y)*b)/E}):(s=c=>{const d=Math.exp(-c*t),p=(c-r)*t+1;return-.001+d*p},a=c=>{const d=Math.exp(-c*t),p=(r-c)*(t*t);return d*p});const l=5/t,u=approximateRoot(s,a,l);if(t=secondsToMilliseconds(t),isNaN(u))return{stiffness:springDefaults.stiffness,damping:springDefaults.damping,duration:t};{const c=Math.pow(u,2)*n;return{stiffness:c,damping:o*2*Math.sqrt(n*c),duration:t}}}const rootIterations=12;function approximateRoot(t,e,r){let n=r;for(let s=1;s<rootIterations;s++)n=n-t(n)/e(n);return n}function calcAngularFreq(t,e){return t*Math.sqrt(1-e*e)}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(t,e){return e.some(r=>t[r]!==void 0)}function getSpringOptions(t){let e={velocity:springDefaults.velocity,stiffness:springDefaults.stiffness,damping:springDefaults.damping,mass:springDefaults.mass,isResolvedFromDuration:!1,...t};if(!isSpringType(t,physicsKeys)&&isSpringType(t,durationKeys))if(t.visualDuration){const r=t.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,a=2*clamp$2(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:springDefaults.mass,stiffness:s,damping:a}}else{const r=findSpring(t);e={...e,...r,mass:springDefaults.mass},e.isResolvedFromDuration=!0}return e}function spring(t=springDefaults.visualDuration,e=springDefaults.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:s}=r;const a=r.keyframes[0],o=r.keyframes[r.keyframes.length-1],l={done:!1,value:a},{stiffness:u,damping:c,mass:d,duration:p,velocity:m,isResolvedFromDuration:y}=getSpringOptions({...r,velocity:-millisecondsToSeconds(r.velocity||0)}),b=m||0,E=c/(2*Math.sqrt(u*d)),T=o-a,S=millisecondsToSeconds(Math.sqrt(u/d)),P=Math.abs(T)<5;n||(n=P?springDefaults.restSpeed.granular:springDefaults.restSpeed.default),s||(s=P?springDefaults.restDelta.granular:springDefaults.restDelta.default);let A;if(E<1){const j=calcAngularFreq(S,E);A=K=>{const W=Math.exp(-E*S*K);return o-W*((b+E*S*T)/j*Math.sin(j*K)+T*Math.cos(j*K))}}else if(E===1)A=j=>o-Math.exp(-S*j)*(T+(b+S*T)*j);else{const j=S*Math.sqrt(E*E-1);A=K=>{const W=Math.exp(-E*S*K),H=Math.min(j*K,300);return o-W*((b+E*S*T)*Math.sinh(H)+j*T*Math.cosh(H))/j}}const I={calculatedDuration:y&&p||null,next:j=>{const K=A(j);if(y)l.done=j>=p;else{let W=j===0?b:0;E<1&&(W=j===0?secondsToMilliseconds(b):calcGeneratorVelocity(A,j,K));const H=Math.abs(W)<=n,ee=Math.abs(o-K)<=s;l.done=H&&ee}return l.value=l.done?o:K,l},toString:()=>{const j=Math.min(calcGeneratorDuration(I),maxGeneratorDuration),K=generateLinearEasing(W=>I.next(j*W).value,j,30);return j+"ms "+K},toTransition:()=>{}};return I}spring.applyToOptions=t=>{const e=createGeneratorEasing(t,100,spring);return t.ease=e.ease,t.duration=secondsToMilliseconds(e.duration),t.type="keyframes",t};function inertia({keyframes:t,velocity:e=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:o,min:l,max:u,restDelta:c=.5,restSpeed:d}){const p=t[0],m={done:!1,value:p},y=H=>l!==void 0&&H<l||u!==void 0&&H>u,b=H=>l===void 0?u:u===void 0||Math.abs(l-H)<Math.abs(u-H)?l:u;let E=r*e;const T=p+E,S=o===void 0?T:o(T);S!==T&&(E=S-p);const P=H=>-E*Math.exp(-H/n),A=H=>S+P(H),I=H=>{const ee=P(H),ue=A(H);m.done=Math.abs(ee)<=c,m.value=m.done?S:ue};let j,K;const W=H=>{y(m.value)&&(j=H,K=spring({keyframes:[m.value,b(m.value)],velocity:calcGeneratorVelocity(A,H,m.value),damping:s,stiffness:a,restDelta:c,restSpeed:d}))};return W(0),{calculatedDuration:null,next:H=>{let ee=!1;return!K&&j===void 0&&(ee=!0,I(H),W(H)),j!==void 0&&H>=j?K.next(H-j):(!ee&&I(H),m)}}}function createMixers(t,e,r){const n=[],s=r||MotionGlobalConfig.mix||mix,a=t.length-1;for(let o=0;o<a;o++){let l=s(t[o],t[o+1]);if(e){const u=Array.isArray(e)?e[o]||noop$6:e;l=pipe(u,l)}n.push(l)}return n}function interpolate$1(t,e,{clamp:r=!0,ease:n,mixer:s}={}){const a=t.length;if(invariant$2(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[a-1]&&(t=[...t].reverse(),e=[...e].reverse());const l=createMixers(e,n,s),u=l.length,c=d=>{if(o&&d<t[0])return e[0];let p=0;if(u>1)for(;p<t.length-2&&!(d<t[p+1]);p++);const m=progress(t[p],t[p+1],d);return l[p](m)};return r?d=>c(clamp$2(t[0],t[a-1],d)):c}function fillOffset(t,e){const r=t[t.length-1];for(let n=1;n<=e;n++){const s=progress(0,e,n);t.push(mixNumber$1(r,1,s))}}function defaultOffset(t){const e=[0];return fillOffset(e,t.length-1),e}function convertOffsetToTimes(t,e){return t.map(r=>r*e)}function defaultEasing(t,e){return t.map(()=>e||easeInOut).splice(0,t.length-1)}function keyframes({duration:t=300,keyframes:e,times:r,ease:n="easeInOut"}){const s=isEasingArray(n)?n.map(easingDefinitionToFunction):easingDefinitionToFunction(n),a={done:!1,value:e[0]},o=convertOffsetToTimes(r&&r.length===e.length?r:defaultOffset(e),t),l=interpolate$1(o,e,{ease:Array.isArray(s)?s:defaultEasing(e,s)});return{calculatedDuration:t,next:u=>(a.value=l(u),a.done=u>=t,a)}}const isNotNull$2=t=>t!==null;function getFinalKeyframe$1(t,{repeat:e,repeatType:r="loop"},n,s=1){const a=t.filter(isNotNull$2),l=s<0||e&&r!=="loop"&&e%2===1?0:a.length-1;return!l||n===void 0?a[l]:n}const transitionTypeMap={decay:inertia,inertia,tween:keyframes,keyframes,spring};function replaceTransitionType(t){typeof t.type=="string"&&(t.type=transitionTypeMap[t.type])}class WithPromise{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,r){return this.finished.then(e,r)}}const percentToProgress=t=>t/100;class JSAnimation extends WithPromise{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var n,s;const{motionValue:r}=this.options;r&&r.updatedAt!==time.now()&&this.tick(time.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(s=(n=this.options).onStop)==null||s.call(n))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;replaceTransitionType(e);const{type:r=keyframes,repeat:n=0,repeatDelay:s=0,repeatType:a,velocity:o=0}=e;let{keyframes:l}=e;const u=r||keyframes;u!==keyframes&&typeof l[0]!="number"&&(this.mixKeyframes=pipe(percentToProgress,mix(l[0],l[1])),l=[0,100]);const c=u({...e,keyframes:l});a==="mirror"&&(this.mirroredGenerator=u({...e,keyframes:[...l].reverse(),velocity:-o})),c.calculatedDuration===null&&(c.calculatedDuration=calcGeneratorDuration(c));const{calculatedDuration:d}=c;this.calculatedDuration=d,this.resolvedDuration=d+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=c}updateTime(e){const r=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(e,r=!1){const{generator:n,totalDuration:s,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:l,calculatedDuration:u}=this;if(this.startTime===null)return n.next(0);const{delay:c=0,keyframes:d,repeat:p,repeatType:m,repeatDelay:y,type:b,onUpdate:E,finalKeyframe:T}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-s/this.speed,this.startTime)),r?this.currentTime=e:this.updateTime(e);const S=this.currentTime-c*(this.playbackSpeed>=0?1:-1),P=this.playbackSpeed>=0?S<0:S>s;this.currentTime=Math.max(S,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let A=this.currentTime,I=n;if(p){const H=Math.min(this.currentTime,s)/l;let ee=Math.floor(H),ue=H%1;!ue&&H>=1&&(ue=1),ue===1&&ee--,ee=Math.min(ee,p+1),!!(ee%2)&&(m==="reverse"?(ue=1-ue,y&&(ue-=y/l)):m==="mirror"&&(I=o)),A=clamp$2(0,1,ue)*l}const j=P?{done:!1,value:d[0]}:I.next(A);a&&(j.value=a(j.value));let{done:K}=j;!P&&u!==null&&(K=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const W=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&K);return W&&b!==inertia&&(j.value=getFinalKeyframe$1(d,this.options,T,this.speed)),E&&E(j.value),W&&this.finish(),j}then(e,r){return this.finished.then(e,r)}get duration(){return millisecondsToSeconds(this.calculatedDuration)}get time(){return millisecondsToSeconds(this.currentTime)}set time(e){var r;e=secondsToMilliseconds(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(time.now());const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=millisecondsToSeconds(this.currentTime))}play(){var s,a;if(this.isStopped)return;const{driver:e=frameloopDriver,startTime:r}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),(a=(s=this.options).onPlay)==null||a.call(s);const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(time.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(e=this.options).onComplete)==null||r.call(e)}cancel(){var e,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(e=this.options).onCancel)==null||r.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),e.observe(this)}}function fillWildcards(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const radToDeg=t=>t*180/Math.PI,rotate=t=>{const e=radToDeg(Math.atan2(t[1],t[0]));return rebaseAngle(e)},matrix2dParsers={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate,rotateZ:rotate,skewX:t=>radToDeg(Math.atan(t[1])),skewY:t=>radToDeg(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},rebaseAngle=t=>(t=t%360,t<0&&(t+=360),t),rotateZ=rotate,scaleX=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),scaleY=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),matrix3dParsers={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX,scaleY,scale:t=>(scaleX(t)+scaleY(t))/2,rotateX:t=>rebaseAngle(radToDeg(Math.atan2(t[6],t[5]))),rotateY:t=>rebaseAngle(radToDeg(Math.atan2(-t[2],t[0]))),rotateZ,rotate:rotateZ,skewX:t=>radToDeg(Math.atan(t[4])),skewY:t=>radToDeg(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function defaultTransformValue(t){return t.includes("scale")?1:0}function parseValueFromTransform(t,e){if(!t||t==="none")return defaultTransformValue(e);const r=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=matrix3dParsers,s=r;else{const l=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=matrix2dParsers,s=l}if(!s)return defaultTransformValue(e);const a=n[e],o=s[1].split(",").map(convertTransformToNumber);return typeof a=="function"?a(o):o[a]}const readTransformValue=(t,e)=>{const{transform:r="none"}=getComputedStyle(t);return parseValueFromTransform(r,e)};function convertTransformToNumber(t){return parseFloat(t.trim())}const transformPropOrder=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],transformProps=new Set(transformPropOrder),isNumOrPxType=t=>t===number||t===px,transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformPropOrder.filter(t=>!transformKeys.has(t));function removeNonTranslationalTransform(t){const e=[];return nonTranslationalTransformKeys.forEach(r=>{const n=t.getValue(r);n!==void 0&&(e.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),e}const positionalValues={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>parseValueFromTransform(e,"x"),y:(t,{transform:e})=>parseValueFromTransform(e,"y")};positionalValues.translateX=positionalValues.x;positionalValues.translateY=positionalValues.y;const toResolve=new Set;let isScheduled=!1,anyNeedsMeasurement=!1,isForced=!1;function measureAllKeyframes(){if(anyNeedsMeasurement){const t=Array.from(toResolve).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),r=new Map;e.forEach(n=>{const s=removeNonTranslationalTransform(n);s.length&&(r.set(n,s),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([a,o])=>{var l;(l=n.getValue(a))==null||l.set(o)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}anyNeedsMeasurement=!1,isScheduled=!1,toResolve.forEach(t=>t.complete(isForced)),toResolve.clear()}function readAllKeyframes(){toResolve.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(anyNeedsMeasurement=!0)})}function flushKeyframeResolvers(){isForced=!0,readAllKeyframes(),measureAllKeyframes(),isForced=!1}class KeyframeResolver{constructor(e,r,n,s,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=n,this.motionValue=s,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(toResolve.add(this),isScheduled||(isScheduled=!0,frame$1.read(readAllKeyframes),frame$1.resolveKeyframes(measureAllKeyframes))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:n,motionValue:s}=this;if(e[0]===null){const a=s==null?void 0:s.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(n&&r){const l=n.readValue(r,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),s&&a===void 0&&s.set(e[0])}fillWildcards(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),toResolve.delete(this)}cancel(){this.state==="scheduled"&&(toResolve.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const isCSSVar=t=>t.startsWith("--");function setStyle(t,e,r){isCSSVar(e)?t.style.setProperty(e,r):t.style[e]=r}const supportsScrollTimeline=memo(()=>window.ScrollTimeline!==void 0),supportsFlags={};function memoSupports(t,e){const r=memo(t);return()=>supportsFlags[e]??r()}const supportsLinearEasing=memoSupports(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),cubicBezierAsString=([t,e,r,n])=>`cubic-bezier(${t}, ${e}, ${r}, ${n})`,supportedWaapiEasing={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])};function mapEasingToNativeEasing(t,e){if(t)return typeof t=="function"?supportsLinearEasing()?generateLinearEasing(t,e):"ease-out":isBezierDefinition(t)?cubicBezierAsString(t):Array.isArray(t)?t.map(r=>mapEasingToNativeEasing(r,e)||supportedWaapiEasing.easeOut):supportedWaapiEasing[t]}function startWaapiAnimation(t,e,r,{delay:n=0,duration:s=300,repeat:a=0,repeatType:o="loop",ease:l="easeOut",times:u}={},c=void 0){const d={[e]:r};u&&(d.offset=u);const p=mapEasingToNativeEasing(l,s);Array.isArray(p)&&(d.easing=p);const m={delay:n,duration:s,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return c&&(m.pseudoElement=c),t.animate(d,m)}function isGenerator(t){return typeof t=="function"&&"applyToOptions"in t}function applyGeneratorOptions({type:t,...e}){return isGenerator(t)&&supportsLinearEasing()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class NativeAnimation extends WithPromise{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:r,name:n,keyframes:s,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:l,onComplete:u}=e;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=e,invariant$2(typeof e.type!="string");const c=applyGeneratorOptions(e);this.animation=startWaapiAnimation(r,n,s,c,a),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const d=getFinalKeyframe$1(s,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(d):setStyle(r,n,d),this.animation.cancel()}u==null||u(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,r;(r=(e=this.animation).finish)==null||r.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,r;this.isPseudoElement||(r=(e=this.animation).commitStyles)==null||r.call(e)}get duration(){var r,n;const e=((n=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:n.call(r).duration)||0;return millisecondsToSeconds(Number(e))}get time(){return millisecondsToSeconds(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=secondsToMilliseconds(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:r}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&supportsScrollTimeline()?(this.animation.timeline=e,noop$6):r(this)}}const unsupportedEasingFunctions={anticipate,backInOut,circInOut};function isUnsupportedEase(t){return t in unsupportedEasingFunctions}function replaceStringEasing(t){typeof t.ease=="string"&&isUnsupportedEase(t.ease)&&(t.ease=unsupportedEasingFunctions[t.ease])}const sampleDelta=10;class NativeAnimationExtended extends NativeAnimation{constructor(e){replaceStringEasing(e),replaceTransitionType(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:r,onUpdate:n,onComplete:s,element:a,...o}=this.options;if(!r)return;if(e!==void 0){r.set(e);return}const l=new JSAnimation({...o,autoplay:!1}),u=secondsToMilliseconds(this.finishedTime??this.time);r.setWithVelocity(l.sample(u-sampleDelta).value,l.sample(u).value,sampleDelta),l.stop()}}const isAnimatable=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(complex.test(t)||t==="0")&&!t.startsWith("url("));function hasKeyframesChanged(t){const e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function canAnimate(t,e,r,n){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const a=t[t.length-1],o=isAnimatable(s,e),l=isAnimatable(a,e);return!o||!l?!1:hasKeyframesChanged(t)||(r==="spring"||isGenerator(r))&&n}function isHTMLElement$2(t){return isObject(t)&&"offsetHeight"in t}const acceleratedValues=new Set(["opacity","clipPath","filter","transform"]),supportsWaapi=memo(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function supportsBrowserAnimation(t){var c;const{motionValue:e,name:r,repeatDelay:n,repeatType:s,damping:a,type:o}=t;if(!isHTMLElement$2((c=e==null?void 0:e.owner)==null?void 0:c.current))return!1;const{onUpdate:l,transformTemplate:u}=e.owner.getProps();return supportsWaapi()&&r&&acceleratedValues.has(r)&&(r!=="transform"||!u)&&!l&&!n&&s!=="mirror"&&a!==0&&o!=="inertia"}const MAX_RESOLVE_DELAY=40;class AsyncMotionValueAnimation extends WithPromise{constructor({autoplay:e=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:o="loop",keyframes:l,name:u,motionValue:c,element:d,...p}){var b;super(),this.stop=()=>{var E,T;this._animation&&(this._animation.stop(),(E=this.stopTimeline)==null||E.call(this)),(T=this.keyframeResolver)==null||T.cancel()},this.createdAt=time.now();const m={autoplay:e,delay:r,type:n,repeat:s,repeatDelay:a,repeatType:o,name:u,motionValue:c,element:d,...p},y=(d==null?void 0:d.KeyframeResolver)||KeyframeResolver;this.keyframeResolver=new y(l,(E,T,S)=>this.onKeyframesResolved(E,T,m,!S),u,c,d),(b=this.keyframeResolver)==null||b.scheduleResolve()}onKeyframesResolved(e,r,n,s){this.keyframeResolver=void 0;const{name:a,type:o,velocity:l,delay:u,isHandoff:c,onUpdate:d}=n;this.resolvedAt=time.now(),canAnimate(e,a,o,l)||((MotionGlobalConfig.instantAnimations||!u)&&(d==null||d(getFinalKeyframe$1(e,n,r))),e[0]=e[e.length-1],n.duration=0,n.repeat=0);const m={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>MAX_RESOLVE_DELAY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:e},y=!c&&supportsBrowserAnimation(m)?new NativeAnimationExtended({...m,element:m.motionValue.owner.current}):new JSAnimation(m);y.finished.then(()=>this.notifyFinished()).catch(noop$6),this.pendingTimeline&&(this.stopTimeline=y.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=y}get finished(){return this._animation?this.animation.finished:this._finished}then(e,r){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),flushKeyframeResolvers()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const splitCSSVariableRegex=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function parseCSSVariable(t){const e=splitCSSVariableRegex.exec(t);if(!e)return[,];const[,r,n,s]=e;return[`--${r??n}`,s]}function getVariableValue(t,e,r=1){const[n,s]=parseCSSVariable(t);if(!n)return;const a=window.getComputedStyle(e).getPropertyValue(n);if(a){const o=a.trim();return isNumericalString(o)?parseFloat(o):o}return isCSSVariableToken(s)?getVariableValue(s,e,r+1):s}function getValueTransition(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const positionalKeys=new Set(["width","height","top","left","right","bottom",...transformPropOrder]),auto$1={test:t=>t==="auto",parse:t=>t},testValueType=t=>e=>e.test(t),dimensionValueTypes=[number,px,percent,degrees$1,vw,vh,auto$1],findDimensionValueType=t=>dimensionValueTypes.find(testValueType(t));function isNone(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||isZeroValueString(t):!0}const maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=r.match(floatRegex)||[];if(!n)return t;const s=r.replace(n,"");let a=maxDefaults.has(e)?1:0;return n!==r&&(a*=100),e+"("+a+s+")"}const functionRegex=/\b([a-z-]*)\(.*?\)/gu,filter$1={...complex,getAnimatableNone:t=>{const e=t.match(functionRegex);return e?e.map(applyDefaultFilter).join(" "):t}},int={...number,transform:Math.round},transformValueTypes={rotate:degrees$1,rotateX:degrees$1,rotateY:degrees$1,rotateZ:degrees$1,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees$1,skewX:degrees$1,skewY:degrees$1,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha,originX:progressPercentage,originY:progressPercentage,originZ:px},numberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,radius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,top:px,right:px,bottom:px,left:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,backgroundPositionX:px,backgroundPositionY:px,...transformValueTypes,zIndex:int,fillOpacity:alpha,strokeOpacity:alpha,numOctaves:int},defaultValueTypes={...numberValueTypes,color:color$2,backgroundColor:color$2,outlineColor:color$2,fill:color$2,stroke:color$2,borderColor:color$2,borderTopColor:color$2,borderRightColor:color$2,borderBottomColor:color$2,borderLeftColor:color$2,filter:filter$1,WebkitFilter:filter$1},getDefaultValueType=t=>defaultValueTypes[t];function getAnimatableNone(t,e){let r=getDefaultValueType(t);return r!==filter$1&&(r=complex),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const invalidTemplates=new Set(["auto","none","0"]);function makeNoneKeyframesAnimatable(t,e,r){let n=0,s;for(;n<t.length&&!s;){const a=t[n];typeof a=="string"&&!invalidTemplates.has(a)&&analyseComplexValue(a).values.length&&(s=t[n]),n++}if(s&&r)for(const a of e)t[a]=getAnimatableNone(r,s)}class DOMKeyframesResolver extends KeyframeResolver{constructor(e,r,n,s,a){super(e,r,n,s,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let c=e[u];if(typeof c=="string"&&(c=c.trim(),isCSSVariableToken(c))){const d=getVariableValue(c,r.current);d!==void 0&&(e[u]=d),u===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!positionalKeys.has(n)||e.length!==2)return;const[s,a]=e,o=findDimensionValueType(s),l=findDimensionValueType(a);if(o!==l)if(isNumOrPxType(o)&&isNumOrPxType(l))for(let u=0;u<e.length;u++){const c=e[u];typeof c=="string"&&(e[u]=parseFloat(c))}else positionalValues[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,n=[];for(let s=0;s<e.length;s++)(e[s]===null||isNone(e[s]))&&n.push(s);n.length&&makeNoneKeyframesAnimatable(e,n,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=positionalValues[n](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&e.getValue(n,s).jump(s,!1)}measureEndState(){var l;const{element:e,name:r,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const s=e.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=n.length-1,o=n[a];n[a]=positionalValues[r](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(l=this.removedTransforms)!=null&&l.length&&this.removedTransforms.forEach(([u,c])=>{e.getValue(u).set(c)}),this.resolveNoneKeyframes()}}function resolveElements(t,e,r){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let n=document;const s=(r==null?void 0:r[t])??n.querySelectorAll(t);return s?Array.from(s):[]}return Array.from(t)}const getValueAsType=(t,e)=>e&&typeof t=="number"?e.transform(t):t,MAX_VELOCITY_DELTA=30,isFloat=t=>!isNaN(parseFloat(t));class MotionValue{constructor(e,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,s=!0)=>{var o,l;const a=time.now();if(this.updatedAt!==a&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((o=this.events.change)==null||o.notify(this.current),this.dependents))for(const u of this.dependents)u.dirty();s&&((l=this.events.renderRequest)==null||l.notify(this.current))},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=time.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=isFloat(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new SubscriptionManager);const n=this.events[e].add(r);return e==="change"?()=>{n(),frame$1.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e,r=!0){!r||!this.passiveEffect?this.updateAndNotify(e,r):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=time.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>MAX_VELOCITY_DELTA)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,MAX_VELOCITY_DELTA);return velocityPerSecond(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,r;(e=this.dependents)==null||e.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function motionValue(t,e){return new MotionValue(t,e)}const{schedule:microtask}=createRenderBatcher(queueMicrotask,!1),isDragging={x:!1,y:!1};function isDragActive(){return isDragging.x||isDragging.y}function setDragLock(t){return t==="x"||t==="y"?isDragging[t]?null:(isDragging[t]=!0,()=>{isDragging[t]=!1}):isDragging.x||isDragging.y?null:(isDragging.x=isDragging.y=!0,()=>{isDragging.x=isDragging.y=!1})}function setupGesture(t,e){const r=resolveElements(t),n=new AbortController,s={passive:!0,...e,signal:n.signal};return[r,s,()=>n.abort()]}function isValidHover(t){return!(t.pointerType==="touch"||isDragActive())}function hover(t,e,r={}){const[n,s,a]=setupGesture(t,r),o=l=>{if(!isValidHover(l))return;const{target:u}=l,c=e(u,l);if(typeof c!="function"||!u)return;const d=p=>{isValidHover(p)&&(c(p),u.removeEventListener("pointerleave",d))};u.addEventListener("pointerleave",d,s)};return n.forEach(l=>{l.addEventListener("pointerenter",o,s)}),a}const isNodeOrChild=(t,e)=>e?t===e?!0:isNodeOrChild(t,e.parentElement):!1,isPrimaryPointer=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,focusableElements=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function isElementKeyboardAccessible(t){return focusableElements.has(t.tagName)||t.tabIndex!==-1}const isPressing=new WeakSet;function filterEvents(t){return e=>{e.key==="Enter"&&t(e)}}function firePointerEvent(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const enableKeyboardPress=(t,e)=>{const r=t.currentTarget;if(!r)return;const n=filterEvents(()=>{if(isPressing.has(r))return;firePointerEvent(r,"down");const s=filterEvents(()=>{firePointerEvent(r,"up")}),a=()=>firePointerEvent(r,"cancel");r.addEventListener("keyup",s,e),r.addEventListener("blur",a,e)});r.addEventListener("keydown",n,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),e)};function isValidPressEvent(t){return isPrimaryPointer(t)&&!isDragActive()}function press(t,e,r={}){const[n,s,a]=setupGesture(t,r),o=l=>{const u=l.currentTarget;if(!isValidPressEvent(l))return;isPressing.add(u);const c=e(u,l),d=(y,b)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",m),isPressing.has(u)&&isPressing.delete(u),isValidPressEvent(y)&&typeof c=="function"&&c(y,{success:b})},p=y=>{d(y,u===window||u===document||r.useGlobalTarget||isNodeOrChild(u,y.target))},m=y=>{d(y,!1)};window.addEventListener("pointerup",p,s),window.addEventListener("pointercancel",m,s)};return n.forEach(l=>{(r.useGlobalTarget?window:l).addEventListener("pointerdown",o,s),isHTMLElement$2(l)&&(l.addEventListener("focus",c=>enableKeyboardPress(c,s)),!isElementKeyboardAccessible(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),a}function isSVGElement$1(t){return isObject(t)&&"ownerSVGElement"in t}function isSVGSVGElement(t){return isSVGElement$1(t)&&t.tagName==="svg"}const isMotionValue=t=>!!(t&&t.getVelocity),valueTypes=[...dimensionValueTypes,color$2,complex],findValueType=t=>valueTypes.find(testValueType(t)),MotionConfigContext=reactExports.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class PopChildMeasure extends reactExports.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const n=r.offsetParent,s=isHTMLElement$2(n)&&n.offsetWidth||0,a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft,a.right=s-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function PopChild({children:t,isPresent:e,anchorX:r}){const n=reactExports.useId(),s=reactExports.useRef(null),a=reactExports.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=reactExports.useContext(MotionConfigContext);return reactExports.useInsertionEffect(()=>{const{width:l,height:u,top:c,left:d,right:p}=a.current;if(e||!s.current||!l||!u)return;const m=r==="left"?`left: ${d}`:`right: ${p}`;s.current.dataset.motionPopId=n;const y=document.createElement("style");return o&&(y.nonce=o),document.head.appendChild(y),y.sheet&&y.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${u}px !important;
            ${m}px !important;
            top: ${c}px !important;
          }
        `),()=>{document.head.contains(y)&&document.head.removeChild(y)}},[e]),jsxRuntimeExports.jsx(PopChildMeasure,{isPresent:e,childRef:s,sizeRef:a,children:reactExports.cloneElement(t,{ref:s})})}const PresenceChild=({children:t,initial:e,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:a,mode:o,anchorX:l})=>{const u=useConstant(newChildrenMap),c=reactExports.useId();let d=!0,p=reactExports.useMemo(()=>(d=!1,{id:c,initial:e,isPresent:r,custom:s,onExitComplete:m=>{u.set(m,!0);for(const y of u.values())if(!y)return;n&&n()},register:m=>(u.set(m,!1),()=>u.delete(m))}),[r,u,n]);return a&&d&&(p={...p}),reactExports.useMemo(()=>{u.forEach((m,y)=>u.set(y,!1))},[r]),reactExports.useEffect(()=>{!r&&!u.size&&n&&n()},[r]),o==="popLayout"&&(t=jsxRuntimeExports.jsx(PopChild,{isPresent:r,anchorX:l,children:t})),jsxRuntimeExports.jsx(PresenceContext.Provider,{value:p,children:t})};function newChildrenMap(){return new Map}function usePresence$1(t=!0){const e=reactExports.useContext(PresenceContext);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=e,a=reactExports.useId();reactExports.useEffect(()=>{if(t)return s(a)},[t]);const o=reactExports.useCallback(()=>t&&n&&n(a),[a,n,t]);return!r&&n?[!1,o]:[!0]}const getChildKey=t=>t.key||"";function onlyElements(t){const e=[];return reactExports.Children.forEach(t,r=>{reactExports.isValidElement(r)&&e.push(r)}),e}const AnimatePresence=({children:t,custom:e,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:a="sync",propagate:o=!1,anchorX:l="left"})=>{const[u,c]=usePresence$1(o),d=reactExports.useMemo(()=>onlyElements(t),[t]),p=o&&!u?[]:d.map(getChildKey),m=reactExports.useRef(!0),y=reactExports.useRef(d),b=useConstant(()=>new Map),[E,T]=reactExports.useState(d),[S,P]=reactExports.useState(d);useIsomorphicLayoutEffect$4(()=>{m.current=!1,y.current=d;for(let j=0;j<S.length;j++){const K=getChildKey(S[j]);p.includes(K)?b.delete(K):b.get(K)!==!0&&b.set(K,!1)}},[S,p.length,p.join("-")]);const A=[];if(d!==E){let j=[...d];for(let K=0;K<S.length;K++){const W=S[K],H=getChildKey(W);p.includes(H)||(j.splice(K,0,W),A.push(W))}return a==="wait"&&A.length&&(j=A),P(onlyElements(j)),T(d),null}const{forceRender:I}=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:S.map(j=>{const K=getChildKey(j),W=o&&!u?!1:d===S||p.includes(K),H=()=>{if(b.has(K))b.set(K,!0);else return;let ee=!0;b.forEach(ue=>{ue||(ee=!1)}),ee&&(I==null||I(),P(y.current),o&&(c==null||c()),n&&n())};return jsxRuntimeExports.jsx(PresenceChild,{isPresent:W,initial:!m.current||r?void 0:!1,custom:e,presenceAffectsLayout:s,mode:a,onExitComplete:W?void 0:H,anchorX:l,children:j},K)})})},LazyContext=reactExports.createContext({strict:!1}),featureProps={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},featureDefinitions={};for(const t in featureProps)featureDefinitions[t]={isEnabled:e=>featureProps[t].some(r=>!!e[r])};function loadFeatures(t){for(const e in t)featureDefinitions[e]={...featureDefinitions[e],...t[e]}}const validMotionProps=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||validMotionProps.has(t)}let shouldForward=t=>!isValidMotionProp(t);function loadExternalIsValidProp(t){t&&(shouldForward=e=>e.startsWith("on")?!isValidMotionProp(e):t(e))}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch{}function filterProps(t,e,r){const n={};for(const s in t)s==="values"&&typeof t.values=="object"||(shouldForward(s)||r===!0&&isValidMotionProp(s)||!e&&!isValidMotionProp(s)||t.draggable&&s.startsWith("onDrag"))&&(n[s]=t[s]);return n}function createDOMMotionComponentProxy(t){if(typeof Proxy>"u")return t;const e=new Map,r=(...n)=>t(...n);return new Proxy(r,{get:(n,s)=>s==="create"?t:(e.has(s)||e.set(s,t(s)),e.get(s))})}const MotionContext=reactExports.createContext({});function isAnimationControls(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function isVariantLabel(t){return typeof t=="string"||Array.isArray(t)}const variantPriorityOrder=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],variantProps=["initial",...variantPriorityOrder];function isControllingVariants(t){return isAnimationControls(t.animate)||variantProps.some(e=>isVariantLabel(t[e]))}function isVariantNode(t){return!!(isControllingVariants(t)||t.variants)}function getCurrentTreeVariants(t,e){if(isControllingVariants(t)){const{initial:r,animate:n}=t;return{initial:r===!1||isVariantLabel(r)?r:void 0,animate:isVariantLabel(n)?n:void 0}}return t.inherit!==!1?e:{}}function useCreateMotionContext(t){const{initial:e,animate:r}=getCurrentTreeVariants(t,reactExports.useContext(MotionContext));return reactExports.useMemo(()=>({initial:e,animate:r}),[variantLabelsAsDependency(e),variantLabelsAsDependency(r)])}function variantLabelsAsDependency(t){return Array.isArray(t)?t.join(" "):t}const motionComponentSymbol=Symbol.for("motionComponentSymbol");function isRefObject(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function useMotionRef(t,e,r){return reactExports.useCallback(n=>{n&&t.onMount&&t.onMount(n),e&&(n?e.mount(n):e.unmount()),r&&(typeof r=="function"?r(n):isRefObject(r)&&(r.current=n))},[e])}const camelToDash=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),optimizedAppearDataId="framerAppearId",optimizedAppearDataAttribute="data-"+camelToDash(optimizedAppearDataId),SwitchLayoutGroupContext=reactExports.createContext({});function useVisualElement(t,e,r,n,s){var E,T;const{visualElement:a}=reactExports.useContext(MotionContext),o=reactExports.useContext(LazyContext),l=reactExports.useContext(PresenceContext),u=reactExports.useContext(MotionConfigContext).reducedMotion,c=reactExports.useRef(null);n=n||o.renderer,!c.current&&n&&(c.current=n(t,{visualState:e,parent:a,props:r,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:u}));const d=c.current,p=reactExports.useContext(SwitchLayoutGroupContext);d&&!d.projection&&s&&(d.type==="html"||d.type==="svg")&&createProjectionNode$1(c.current,r,s,p);const m=reactExports.useRef(!1);reactExports.useInsertionEffect(()=>{d&&m.current&&d.update(r,l)});const y=r[optimizedAppearDataAttribute],b=reactExports.useRef(!!y&&!((E=window.MotionHandoffIsComplete)!=null&&E.call(window,y))&&((T=window.MotionHasOptimisedAnimation)==null?void 0:T.call(window,y)));return useIsomorphicLayoutEffect$4(()=>{d&&(m.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),microtask.render(d.render),b.current&&d.animationState&&d.animationState.animateChanges())}),reactExports.useEffect(()=>{d&&(!b.current&&d.animationState&&d.animationState.animateChanges(),b.current&&(queueMicrotask(()=>{var S;(S=window.MotionHandoffMarkAsComplete)==null||S.call(window,y)}),b.current=!1))}),d}function createProjectionNode$1(t,e,r,n){const{layoutId:s,layout:a,drag:o,dragConstraints:l,layoutScroll:u,layoutRoot:c,layoutCrossfade:d}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:getClosestProjectingNode(t.parent)),t.projection.setOptions({layoutId:s,layout:a,alwaysMeasureLayout:!!o||l&&isRefObject(l),visualElement:t,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,crossfade:d,layoutScroll:u,layoutRoot:c})}function getClosestProjectingNode(t){if(t)return t.options.allowProjection!==!1?t.projection:getClosestProjectingNode(t.parent)}function createRendererMotionComponent({preloadedFeatures:t,createVisualElement:e,useRender:r,useVisualState:n,Component:s}){t&&loadFeatures(t);function a(l,u){let c;const d={...reactExports.useContext(MotionConfigContext),...l,layoutId:useLayoutId(l)},{isStatic:p}=d,m=useCreateMotionContext(l),y=n(l,p);if(!p&&isBrowser$2){useStrictMode();const b=getProjectionFunctionality(d);c=b.MeasureLayout,m.visualElement=useVisualElement(s,y,d,e,b.ProjectionNode)}return jsxRuntimeExports.jsxs(MotionContext.Provider,{value:m,children:[c&&m.visualElement?jsxRuntimeExports.jsx(c,{visualElement:m.visualElement,...d}):null,r(s,l,useMotionRef(y,m.visualElement,u),y,p,m.visualElement)]})}a.displayName=`motion.${typeof s=="string"?s:`create(${s.displayName??s.name??""})`}`;const o=reactExports.forwardRef(a);return o[motionComponentSymbol]=s,o}function useLayoutId({layoutId:t}){const e=reactExports.useContext(LayoutGroupContext).id;return e&&t!==void 0?e+"-"+t:t}function useStrictMode(t,e){reactExports.useContext(LazyContext).strict}function getProjectionFunctionality(t){const{drag:e,layout:r}=featureDefinitions;if(!e&&!r)return{};const n={...e,...r};return{MeasureLayout:e!=null&&e.isEnabled(t)||r!=null&&r.isEnabled(t)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const scaleCorrectors={};function addScaleCorrector(t){for(const e in t)scaleCorrectors[e]=t[e],isCSSVariableName(e)&&(scaleCorrectors[e].isCSSVariable=!0)}function isForcedMotionValue(t,{layout:e,layoutId:r}){return transformProps.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!scaleCorrectors[t]||t==="opacity")}const translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},numTransforms=transformPropOrder.length;function buildTransform(t,e,r){let n="",s=!0;for(let a=0;a<numTransforms;a++){const o=transformPropOrder[a],l=t[o];if(l===void 0)continue;let u=!0;if(typeof l=="number"?u=l===(o.startsWith("scale")?1:0):u=parseFloat(l)===0,!u||r){const c=getValueAsType(l,numberValueTypes[o]);if(!u){s=!1;const d=translateAlias[o]||o;n+=`${d}(${c}) `}r&&(e[o]=c)}}return n=n.trim(),r?n=r(e,s?"":n):s&&(n="none"),n}function buildHTMLStyles(t,e,r){const{style:n,vars:s,transformOrigin:a}=t;let o=!1,l=!1;for(const u in e){const c=e[u];if(transformProps.has(u)){o=!0;continue}else if(isCSSVariableName(u)){s[u]=c;continue}else{const d=getValueAsType(c,numberValueTypes[u]);u.startsWith("origin")?(l=!0,a[u]=d):n[u]=d}}if(e.transform||(o||r?n.transform=buildTransform(e,t.transform,r):n.transform&&(n.transform="none")),l){const{originX:u="50%",originY:c="50%",originZ:d=0}=a;n.transformOrigin=`${u} ${c} ${d}`}}const createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function copyRawValuesOnly(t,e,r){for(const n in e)!isMotionValue(e[n])&&!isForcedMotionValue(n,r)&&(t[n]=e[n])}function useInitialMotionValues({transformTemplate:t},e){return reactExports.useMemo(()=>{const r=createHtmlRenderState();return buildHTMLStyles(r,e,t),Object.assign({},r.vars,r.style)},[e])}function useStyle(t,e){const r=t.style||{},n={};return copyRawValuesOnly(n,r,t),Object.assign(n,useInitialMotionValues(t,e)),n}function useHTMLProps(t,e){const r={},n=useStyle(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=n,r}const dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(t,e,r=1,n=0,s=!0){t.pathLength=1;const a=s?dashKeys:camelKeys;t[a.offset]=px.transform(-n);const o=px.transform(e),l=px.transform(r);t[a.array]=`${o} ${l}`}function buildSVGAttrs(t,{attrX:e,attrY:r,attrScale:n,pathLength:s,pathSpacing:a=1,pathOffset:o=0,...l},u,c,d){if(buildHTMLStyles(t,l,c),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:p,style:m}=t;p.transform&&(m.transform=p.transform,delete p.transform),(m.transform||p.transformOrigin)&&(m.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),m.transform&&(m.transformBox=(d==null?void 0:d.transformBox)??"fill-box",delete p.transformBox),e!==void 0&&(p.x=e),r!==void 0&&(p.y=r),n!==void 0&&(p.scale=n),s!==void 0&&buildSVGPath(p,s,a,o,!1)}const createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}}),isSVGTag=t=>typeof t=="string"&&t.toLowerCase()==="svg";function useSVGProps(t,e,r,n){const s=reactExports.useMemo(()=>{const a=createSvgRenderState();return buildSVGAttrs(a,e,isSVGTag(n),t.transformTemplate,t.style),{...a.attrs,style:{...a.style}}},[e]);if(t.style){const a={};copyRawValuesOnly(a,t.style,t),s.style={...a,...s.style}}return s}const lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(t){return typeof t!="string"||t.includes("-")?!1:!!(lowercaseSVGElements.indexOf(t)>-1||/[A-Z]/u.test(t))}function createUseRender(t=!1){return(r,n,s,{latestValues:a},o)=>{const u=(isSVGComponent(r)?useSVGProps:useHTMLProps)(n,a,o,r),c=filterProps(n,typeof r=="string",t),d=r!==reactExports.Fragment?{...c,...u,ref:s}:{},{children:p}=n,m=reactExports.useMemo(()=>isMotionValue(p)?p.get():p,[p]);return reactExports.createElement(r,{...d,children:m})}}function getValueState(t){const e=[{},{}];return t==null||t.values.forEach((r,n)=>{e[0][n]=r.get(),e[1][n]=r.getVelocity()}),e}function resolveVariantFromProps(t,e,r,n){if(typeof e=="function"){const[s,a]=getValueState(n);e=e(r!==void 0?r:t.custom,s,a)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,a]=getValueState(n);e=e(r!==void 0?r:t.custom,s,a)}return e}function resolveMotionValue(t){return isMotionValue(t)?t.get():t}function makeState({scrapeMotionValuesFromProps:t,createRenderState:e},r,n,s){return{latestValues:makeLatestValues(r,n,s,t),renderState:e()}}const makeUseVisualState=t=>(e,r)=>{const n=reactExports.useContext(MotionContext),s=reactExports.useContext(PresenceContext),a=()=>makeState(t,e,n,s);return r?a():useConstant(a)};function makeLatestValues(t,e,r,n){const s={},a=n(t,{});for(const m in a)s[m]=resolveMotionValue(a[m]);let{initial:o,animate:l}=t;const u=isControllingVariants(t),c=isVariantNode(t);e&&c&&!u&&t.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let d=r?r.initial===!1:!1;d=d||o===!1;const p=d?l:o;if(p&&typeof p!="boolean"&&!isAnimationControls(p)){const m=Array.isArray(p)?p:[p];for(let y=0;y<m.length;y++){const b=resolveVariantFromProps(t,m[y]);if(b){const{transitionEnd:E,transition:T,...S}=b;for(const P in S){let A=S[P];if(Array.isArray(A)){const I=d?A.length-1:0;A=A[I]}A!==null&&(s[P]=A)}for(const P in E)s[P]=E[P]}}}return s}function scrapeMotionValuesFromProps$1(t,e,r){var a;const{style:n}=t,s={};for(const o in n)(isMotionValue(n[o])||e.style&&isMotionValue(e.style[o])||isForcedMotionValue(o,t)||((a=r==null?void 0:r.getValue(o))==null?void 0:a.liveStyle)!==void 0)&&(s[o]=n[o]);return s}const htmlMotionConfig={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createHtmlRenderState})};function scrapeMotionValuesFromProps(t,e,r){const n=scrapeMotionValuesFromProps$1(t,e,r);for(const s in t)if(isMotionValue(t[s])||isMotionValue(e[s])){const a=transformPropOrder.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[a]=t[s]}return n}const svgMotionConfig={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps,createRenderState:createSvgRenderState})};function createMotionComponentFactory(t,e){return function(n,{forwardMotionProps:s}={forwardMotionProps:!1}){const o={...isSVGComponent(n)?svgMotionConfig:htmlMotionConfig,preloadedFeatures:t,useRender:createUseRender(s),createVisualElement:e,Component:n};return createRendererMotionComponent(o)}}function resolveVariant(t,e,r){const n=t.getProps();return resolveVariantFromProps(n,e,r!==void 0?r:n.custom,t)}const isKeyframesTarget=t=>Array.isArray(t);function setMotionValue(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,motionValue(r))}function resolveFinalValueInKeyframes(t){return isKeyframesTarget(t)?t[t.length-1]||0:t}function setTarget(t,e){const r=resolveVariant(t,e);let{transitionEnd:n={},transition:s={},...a}=r||{};a={...a,...n};for(const o in a){const l=resolveFinalValueInKeyframes(a[o]);setMotionValue(t,o,l)}}function isWillChangeMotionValue(t){return!!(isMotionValue(t)&&t.add)}function addValueToWillChange(t,e){const r=t.getValue("willChange");if(isWillChangeMotionValue(r))return r.add(e);if(!r&&MotionGlobalConfig.WillChange){const n=new MotionGlobalConfig.WillChange("auto");t.addValue("willChange",n),n.add(e)}}function getOptimisedAppearId(t){return t.props[optimizedAppearDataAttribute]}const isNotNull$1=t=>t!==null;function getFinalKeyframe(t,{repeat:e,repeatType:r="loop"},n){const s=t.filter(isNotNull$1),a=e&&r!=="loop"&&e%2===1?0:s.length-1;return s[a]}const underDampedSpring={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),keyframesTransition={type:"keyframes",duration:.8},ease={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(t,{keyframes:e})=>e.length>2?keyframesTransition:transformProps.has(t)?t.startsWith("scale")?criticallyDampedSpring(e[1]):underDampedSpring:ease;function isTransitionDefined({when:t,delay:e,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:a,repeatType:o,repeatDelay:l,from:u,elapsed:c,...d}){return!!Object.keys(d).length}const animateMotionValue=(t,e,r,n={},s,a)=>o=>{const l=getValueTransition(n,t)||{},u=l.delay||n.delay||0;let{elapsed:c=0}=n;c=c-secondsToMilliseconds(u);const d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-c,onUpdate:m=>{e.set(m),l.onUpdate&&l.onUpdate(m)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:t,motionValue:e,element:a?void 0:s};isTransitionDefined(l)||Object.assign(d,getDefaultTransition(t,d)),d.duration&&(d.duration=secondsToMilliseconds(d.duration)),d.repeatDelay&&(d.repeatDelay=secondsToMilliseconds(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let p=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(d.duration=0,d.delay===0&&(p=!0)),(MotionGlobalConfig.instantAnimations||MotionGlobalConfig.skipAnimations)&&(p=!0,d.duration=0,d.delay=0),d.allowFlatten=!l.type&&!l.ease,p&&!a&&e.get()!==void 0){const m=getFinalKeyframe(d.keyframes,l);if(m!==void 0){frame$1.update(()=>{d.onUpdate(m),d.onComplete()});return}}return l.isSync?new JSAnimation(d):new AsyncMotionValueAnimation(d)};function shouldBlockAnimation({protectedKeys:t,needsAnimating:e},r){const n=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,n}function animateTarget(t,e,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:a=t.getDefaultTransition(),transitionEnd:o,...l}=e;n&&(a=n);const u=[],c=s&&t.animationState&&t.animationState.getState()[s];for(const d in l){const p=t.getValue(d,t.latestValues[d]??null),m=l[d];if(m===void 0||c&&shouldBlockAnimation(c,d))continue;const y={delay:r,...getValueTransition(a||{},d)},b=p.get();if(b!==void 0&&!p.isAnimating&&!Array.isArray(m)&&m===b&&!y.velocity)continue;let E=!1;if(window.MotionHandoffAnimation){const S=getOptimisedAppearId(t);if(S){const P=window.MotionHandoffAnimation(S,d,frame$1);P!==null&&(y.startTime=P,E=!0)}}addValueToWillChange(t,d),p.start(animateMotionValue(d,p,m,t.shouldReduceMotion&&positionalKeys.has(d)?{type:!1}:y,t,E));const T=p.animation;T&&u.push(T)}return o&&Promise.all(u).then(()=>{frame$1.update(()=>{o&&setTarget(t,o)})}),u}function animateVariant(t,e,r={}){var u;const n=resolveVariant(t,e,r.type==="exit"?(u=t.presenceContext)==null?void 0:u.custom:void 0);let{transition:s=t.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const a=n?()=>Promise.all(animateTarget(t,n,r)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:p,staggerDirection:m}=s;return animateChildren(t,e,d+c,p,m,r)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,d]=l==="beforeChildren"?[a,o]:[o,a];return c().then(()=>d())}else return Promise.all([a(),o(r.delay)])}function animateChildren(t,e,r=0,n=0,s=1,a){const o=[],l=(t.variantChildren.size-1)*n,u=s===1?(c=0)=>c*n:(c=0)=>l-c*n;return Array.from(t.variantChildren).sort(sortByTreeOrder).forEach((c,d)=>{c.notify("AnimationStart",e),o.push(animateVariant(c,e,{...a,delay:r+u(d)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function sortByTreeOrder(t,e){return t.sortNodePosition(e)}function animateVisualElement(t,e,r={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const s=e.map(a=>animateVariant(t,a,r));n=Promise.all(s)}else if(typeof e=="string")n=animateVariant(t,e,r);else{const s=typeof e=="function"?resolveVariant(t,e,r.custom):e;n=Promise.all(animateTarget(t,s,r))}return n.then(()=>{t.notify("AnimationComplete",e)})}function shallowCompare(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}const numVariantProps=variantProps.length;function getVariantContext(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?getVariantContext(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const e={};for(let r=0;r<numVariantProps;r++){const n=variantProps[r],s=t.props[n];(isVariantLabel(s)||s===!1)&&(e[n]=s)}return e}const reversePriorityOrder=[...variantPriorityOrder].reverse(),numAnimationTypes=variantPriorityOrder.length;function animateList(t){return e=>Promise.all(e.map(({animation:r,options:n})=>animateVisualElement(t,r,n)))}function createAnimationState(t){let e=animateList(t),r=createState(),n=!0;const s=u=>(c,d)=>{var m;const p=resolveVariant(t,d,u==="exit"?(m=t.presenceContext)==null?void 0:m.custom:void 0);if(p){const{transition:y,transitionEnd:b,...E}=p;c={...c,...E,...b}}return c};function a(u){e=u(t)}function o(u){const{props:c}=t,d=getVariantContext(t.parent)||{},p=[],m=new Set;let y={},b=1/0;for(let T=0;T<numAnimationTypes;T++){const S=reversePriorityOrder[T],P=r[S],A=c[S]!==void 0?c[S]:d[S],I=isVariantLabel(A),j=S===u?P.isActive:null;j===!1&&(b=T);let K=A===d[S]&&A!==c[S]&&I;if(K&&n&&t.manuallyAnimateOnMount&&(K=!1),P.protectedKeys={...y},!P.isActive&&j===null||!A&&!P.prevProp||isAnimationControls(A)||typeof A=="boolean")continue;const W=checkVariantsDidChange(P.prevProp,A);let H=W||S===u&&P.isActive&&!K&&I||T>b&&I,ee=!1;const ue=Array.isArray(A)?A:[A];let de=ue.reduce(s(S),{});j===!1&&(de={});const{prevResolvedValues:fe={}}=P,ae={...fe,...de},ce=le=>{H=!0,m.has(le)&&(ee=!0,m.delete(le)),P.needsAnimating[le]=!0;const Z=t.getValue(le);Z&&(Z.liveStyle=!1)};for(const le in ae){const Z=de[le],Y=fe[le];if(y.hasOwnProperty(le))continue;let he=!1;isKeyframesTarget(Z)&&isKeyframesTarget(Y)?he=!shallowCompare(Z,Y):he=Z!==Y,he?Z!=null?ce(le):m.add(le):Z!==void 0&&m.has(le)?ce(le):P.protectedKeys[le]=!0}P.prevProp=A,P.prevResolvedValues=de,P.isActive&&(y={...y,...de}),n&&t.blockInitialAnimation&&(H=!1),H&&(!(K&&W)||ee)&&p.push(...ue.map(le=>({animation:le,options:{type:S}})))}if(m.size){const T={};if(typeof c.initial!="boolean"){const S=resolveVariant(t,Array.isArray(c.initial)?c.initial[0]:c.initial);S&&S.transition&&(T.transition=S.transition)}m.forEach(S=>{const P=t.getBaseTarget(S),A=t.getValue(S);A&&(A.liveStyle=!0),T[S]=P??null}),p.push({animation:T})}let E=!!p.length;return n&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(E=!1),n=!1,E?e(p):Promise.resolve()}function l(u,c){var p;if(r[u].isActive===c)return Promise.resolve();(p=t.variantChildren)==null||p.forEach(m=>{var y;return(y=m.animationState)==null?void 0:y.setActive(u,c)}),r[u].isActive=c;const d=o(u);for(const m in r)r[m].protectedKeys={};return d}return{animateChanges:o,setActive:l,setAnimateFunction:a,getState:()=>r,reset:()=>{r=createState(),n=!0}}}function checkVariantsDidChange(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!shallowCompare(e,t):!1}function createTypeState(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState(){return{animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()}}class Feature{constructor(e){this.isMounted=!1,this.node=e}update(){}}class AnimationFeature extends Feature{constructor(e){super(e),e.animationState||(e.animationState=createAnimationState(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();isAnimationControls(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let id$2=0;class ExitAnimationFeature extends Feature{constructor(){super(...arguments),this.id=id$2++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const s=this.node.animationState.setActive("exit",!e);r&&!e&&s.then(()=>{r(this.id)})}mount(){const{register:e,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const animations={animation:{Feature:AnimationFeature},exit:{Feature:ExitAnimationFeature}};function addDomEvent(t,e,r,n={passive:!0}){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r)}function extractEventInfo(t){return{point:{x:t.pageX,y:t.pageY}}}const addPointerInfo=t=>e=>isPrimaryPointer(e)&&t(e,extractEventInfo(e));function addPointerEvent(t,e,r,n){return addDomEvent(t,e,addPointerInfo(r),n)}function convertBoundingBoxToBox({top:t,left:e,right:r,bottom:n}){return{x:{min:e,max:r},y:{min:t,max:n}}}function convertBoxToBoundingBox({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function transformBoxPoints(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}const SCALE_PRECISION=1e-4,SCALE_MIN=1-SCALE_PRECISION,SCALE_MAX=1+SCALE_PRECISION,TRANSLATE_PRECISION=.01,TRANSLATE_MIN=0-TRANSLATE_PRECISION,TRANSLATE_MAX=0+TRANSLATE_PRECISION;function calcLength(t){return t.max-t.min}function isNear(t,e,r){return Math.abs(t-e)<=r}function calcAxisDelta(t,e,r,n=.5){t.origin=n,t.originPoint=mixNumber$1(e.min,e.max,t.origin),t.scale=calcLength(r)/calcLength(e),t.translate=mixNumber$1(r.min,r.max,t.origin)-t.originPoint,(t.scale>=SCALE_MIN&&t.scale<=SCALE_MAX||isNaN(t.scale))&&(t.scale=1),(t.translate>=TRANSLATE_MIN&&t.translate<=TRANSLATE_MAX||isNaN(t.translate))&&(t.translate=0)}function calcBoxDelta(t,e,r,n){calcAxisDelta(t.x,e.x,r.x,n?n.originX:void 0),calcAxisDelta(t.y,e.y,r.y,n?n.originY:void 0)}function calcRelativeAxis(t,e,r){t.min=r.min+e.min,t.max=t.min+calcLength(e)}function calcRelativeBox(t,e,r){calcRelativeAxis(t.x,e.x,r.x),calcRelativeAxis(t.y,e.y,r.y)}function calcRelativeAxisPosition(t,e,r){t.min=e.min-r.min,t.max=t.min+calcLength(e)}function calcRelativePosition(t,e,r){calcRelativeAxisPosition(t.x,e.x,r.x),calcRelativeAxisPosition(t.y,e.y,r.y)}const createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox$1=()=>({x:createAxis(),y:createAxis()});function eachAxis(t){return[t("x"),t("y")]}function isIdentityScale(t){return t===void 0||t===1}function hasScale({scale:t,scaleX:e,scaleY:r}){return!isIdentityScale(t)||!isIdentityScale(e)||!isIdentityScale(r)}function hasTransform(t){return hasScale(t)||has2DTranslate(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function has2DTranslate(t){return is2DTranslate(t.x)||is2DTranslate(t.y)}function is2DTranslate(t){return t&&t!=="0%"}function scalePoint(t,e,r){const n=t-r,s=e*n;return r+s}function applyPointDelta(t,e,r,n,s){return s!==void 0&&(t=scalePoint(t,s,n)),scalePoint(t,r,n)+e}function applyAxisDelta(t,e=0,r=1,n,s){t.min=applyPointDelta(t.min,e,r,n,s),t.max=applyPointDelta(t.max,e,r,n,s)}function applyBoxDelta(t,{x:e,y:r}){applyAxisDelta(t.x,e.translate,e.scale,e.originPoint),applyAxisDelta(t.y,r.translate,r.scale,r.originPoint)}const TREE_SCALE_SNAP_MIN=.999999999999,TREE_SCALE_SNAP_MAX=1.0000000000001;function applyTreeDeltas(t,e,r,n=!1){const s=r.length;if(!s)return;e.x=e.y=1;let a,o;for(let l=0;l<s;l++){a=r[l],o=a.projectionDelta;const{visualElement:u}=a.options;u&&u.props.style&&u.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&transformBox(t,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,applyBoxDelta(t,o)),n&&hasTransform(a.latestValues)&&transformBox(t,a.latestValues))}e.x<TREE_SCALE_SNAP_MAX&&e.x>TREE_SCALE_SNAP_MIN&&(e.x=1),e.y<TREE_SCALE_SNAP_MAX&&e.y>TREE_SCALE_SNAP_MIN&&(e.y=1)}function translateAxis(t,e){t.min=t.min+e,t.max=t.max+e}function transformAxis(t,e,r,n,s=.5){const a=mixNumber$1(t.min,t.max,s);applyAxisDelta(t,e,r,a,n)}function transformBox(t,e){transformAxis(t.x,e.x,e.scaleX,e.scale,e.originX),transformAxis(t.y,e.y,e.scaleY,e.scale,e.originY)}function measureViewportBox(t,e){return convertBoundingBoxToBox(transformBoxPoints(t.getBoundingClientRect(),e))}function measurePageBox(t,e,r){const n=measureViewportBox(t,r),{scroll:s}=e;return s&&(translateAxis(n.x,s.offset.x),translateAxis(n.y,s.offset.y)),n}const getContextWindow=({current:t})=>t?t.ownerDocument.defaultView:null,distance$2=(t,e)=>Math.abs(t-e);function distance2D(t,e){const r=distance$2(t.x,e.x),n=distance$2(t.y,e.y);return Math.sqrt(r**2+n**2)}class PanSession{constructor(e,r,{transformPagePoint:n,contextWindow:s,dragSnapToOrigin:a=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const p=getPanInfo(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,y=distance2D(p.offset,{x:0,y:0})>=3;if(!m&&!y)return;const{point:b}=p,{timestamp:E}=frameData;this.history.push({...b,timestamp:E});const{onStart:T,onMove:S}=this.handlers;m||(T&&T(this.lastMoveEvent,p),this.startEvent=this.lastMoveEvent),S&&S(this.lastMoveEvent,p)},this.handlePointerMove=(p,m)=>{this.lastMoveEvent=p,this.lastMoveEventInfo=transformPoint(m,this.transformPagePoint),frame$1.update(this.updatePoint,!0)},this.handlePointerUp=(p,m)=>{this.end();const{onEnd:y,onSessionEnd:b,resumeAnimation:E}=this.handlers;if(this.dragSnapToOrigin&&E&&E(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=getPanInfo(p.type==="pointercancel"?this.lastMoveEventInfo:transformPoint(m,this.transformPagePoint),this.history);this.startEvent&&y&&y(p,T),b&&b(p,T)},!isPrimaryPointer(e))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=n,this.contextWindow=s||window;const o=extractEventInfo(e),l=transformPoint(o,this.transformPagePoint),{point:u}=l,{timestamp:c}=frameData;this.history=[{...u,timestamp:c}];const{onSessionStart:d}=r;d&&d(e,getPanInfo(l,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),cancelFrame(this.updatePoint)}}function transformPoint(t,e){return e?{point:e(t.point)}:t}function subtractPoint(t,e){return{x:t.x-e.x,y:t.y-e.y}}function getPanInfo({point:t},e){return{point:t,delta:subtractPoint(t,lastDevicePoint(e)),offset:subtractPoint(t,startDevicePoint(e)),velocity:getVelocity(e,.1)}}function startDevicePoint(t){return t[0]}function lastDevicePoint(t){return t[t.length-1]}function getVelocity(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,n=null;const s=lastDevicePoint(t);for(;r>=0&&(n=t[r],!(s.timestamp-n.timestamp>secondsToMilliseconds(e)));)r--;if(!n)return{x:0,y:0};const a=millisecondsToSeconds(s.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const o={x:(s.x-n.x)/a,y:(s.y-n.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function applyConstraints(t,{min:e,max:r},n){return e!==void 0&&t<e?t=n?mixNumber$1(e,t,n.min):Math.max(t,e):r!==void 0&&t>r&&(t=n?mixNumber$1(r,t,n.max):Math.min(t,r)),t}function calcRelativeAxisConstraints(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function calcRelativeConstraints(t,{top:e,left:r,bottom:n,right:s}){return{x:calcRelativeAxisConstraints(t.x,r,s),y:calcRelativeAxisConstraints(t.y,e,n)}}function calcViewportAxisConstraints(t,e){let r=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,n]=[n,r]),{min:r,max:n}}function calcViewportConstraints(t,e){return{x:calcViewportAxisConstraints(t.x,e.x),y:calcViewportAxisConstraints(t.y,e.y)}}function calcOrigin(t,e){let r=.5;const n=calcLength(t),s=calcLength(e);return s>n?r=progress(e.min,e.max-n,t.min):n>s&&(r=progress(t.min,t.max-s,e.min)),clamp$2(0,1,r)}function rebaseAxisConstraints(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const defaultElastic=.35;function resolveDragElastic(t=defaultElastic){return t===!1?t=0:t===!0&&(t=defaultElastic),{x:resolveAxisElastic(t,"left","right"),y:resolveAxisElastic(t,"top","bottom")}}function resolveAxisElastic(t,e,r){return{min:resolvePointElastic(t,e),max:resolvePointElastic(t,r)}}function resolvePointElastic(t,e){return typeof t=="number"?t:t[e]||0}const elementDragControls=new WeakMap;class VisualElementDragControls{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox$1(),this.visualElement=e}start(e,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const s=d=>{const{dragSnapToOrigin:p}=this.getProps();p?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(extractEventInfo(d).point)},a=(d,p)=>{const{drag:m,dragPropagation:y,onDragStart:b}=this.getProps();if(m&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=setDragLock(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(T=>{let S=this.getAxisMotionValue(T).get()||0;if(percent.test(S)){const{projection:P}=this.visualElement;if(P&&P.layout){const A=P.layout.layoutBox[T];A&&(S=calcLength(A)*(parseFloat(S)/100))}}this.originPoint[T]=S}),b&&frame$1.postRender(()=>b(d,p)),addValueToWillChange(this.visualElement,"transform");const{animationState:E}=this.visualElement;E&&E.setActive("whileDrag",!0)},o=(d,p)=>{const{dragPropagation:m,dragDirectionLock:y,onDirectionLock:b,onDrag:E}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:T}=p;if(y&&this.currentDirection===null){this.currentDirection=getCurrentDirection(T),this.currentDirection!==null&&b&&b(this.currentDirection);return}this.updateAxis("x",p.point,T),this.updateAxis("y",p.point,T),this.visualElement.render(),E&&E(d,p)},l=(d,p)=>this.stop(d,p),u=()=>eachAxis(d=>{var p;return this.getAnimationState(d)==="paused"&&((p=this.getAxisMotionValue(d).animation)==null?void 0:p.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new PanSession(e,{onSessionStart:s,onStart:a,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:getContextWindow(this.visualElement)})}stop(e,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:s}=r;this.startAnimation(s);const{onDragEnd:a}=this.getProps();a&&frame$1.postRender(()=>a(e,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,n){const{drag:s}=this.getProps();if(!n||!shouldDrag(e,s,this.currentDirection))return;const a=this.getAxisMotionValue(e);let o=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(o=applyConstraints(o,this.constraints[e],this.elastic[e])),a.set(o)}resolveConstraints(){var a;const{dragConstraints:e,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(a=this.visualElement.projection)==null?void 0:a.layout,s=this.constraints;e&&isRefObject(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=calcRelativeConstraints(n.layoutBox,e):this.constraints=!1,this.elastic=resolveDragElastic(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=rebaseAxisConstraints(n.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!isRefObject(e))return!1;const n=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const a=measurePageBox(n,s.root,this.visualElement.getTransformPagePoint());let o=calcViewportConstraints(s.layout.layoutBox,a);if(r){const l=r(convertBoxToBoundingBox(o));this.hasMutatedConstraints=!!l,l&&(o=convertBoundingBoxToBox(l))}return o}startAnimation(e){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},c=eachAxis(d=>{if(!shouldDrag(d,r,this.currentDirection))return;let p=u&&u[d]||{};o&&(p={min:0,max:0});const m=s?200:1e6,y=s?40:1e7,b={type:"inertia",velocity:n?e[d]:0,bounceStiffness:m,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...a,...p};return this.startAxisValueAnimation(d,b)});return Promise.all(c).then(l)}startAxisValueAnimation(e,r){const n=this.getAxisMotionValue(e);return addValueToWillChange(this.visualElement,e),n.start(animateMotionValue(e,n,0,r,this.visualElement,!1))}stopAnimation(){eachAxis(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){eachAxis(e=>{var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.pause()})}getAnimationState(e){var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.state}getAxisMotionValue(e){const r=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){eachAxis(r=>{const{drag:n}=this.getProps();if(!shouldDrag(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,a=this.getAxisMotionValue(r);if(s&&s.layout){const{min:o,max:l}=s.layout.layoutBox[r];a.set(e[r]-mixNumber$1(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!isRefObject(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};eachAxis(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const u=l.get();s[o]=calcOrigin({min:u,max:u},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),eachAxis(o=>{if(!shouldDrag(o,e,null))return;const l=this.getAxisMotionValue(o),{min:u,max:c}=this.constraints[o];l.set(mixNumber$1(u,c,s[o]))})}addListeners(){if(!this.visualElement.current)return;elementDragControls.set(this.visualElement,this);const e=this.visualElement.current,r=addPointerEvent(e,"pointerdown",u=>{const{drag:c,dragListener:d=!0}=this.getProps();c&&d&&this.start(u)}),n=()=>{const{dragConstraints:u}=this.getProps();isRefObject(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,a=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),frame$1.read(n);const o=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:u,hasLayoutChanged:c})=>{this.isDragging&&c&&(eachAxis(d=>{const p=this.getAxisMotionValue(d);p&&(this.originPoint[d]+=u[d].translate,p.set(p.get()+u[d].translate))}),this.visualElement.render())});return()=>{o(),r(),a(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:a=!1,dragElastic:o=defaultElastic,dragMomentum:l=!0}=e;return{...e,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:a,dragElastic:o,dragMomentum:l}}}function shouldDrag(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function getCurrentDirection(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class DragGesture extends Feature{constructor(e){super(e),this.removeGroupControls=noop$6,this.removeListeners=noop$6,this.controls=new VisualElementDragControls(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||noop$6}unmount(){this.removeGroupControls(),this.removeListeners()}}const asyncHandler=t=>(e,r)=>{t&&frame$1.postRender(()=>t(e,r))};class PanGesture extends Feature{constructor(){super(...arguments),this.removePointerDownListener=noop$6}onPointerDown(e){this.session=new PanSession(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:asyncHandler(e),onStart:asyncHandler(r),onMove:n,onEnd:(a,o)=>{delete this.session,s&&frame$1.postRender(()=>s(a,o))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pixelsToPercent(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const correctBorderRadius={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(px.test(t))t=parseFloat(t);else return t;const r=pixelsToPercent(t,e.target.x),n=pixelsToPercent(t,e.target.y);return`${r}% ${n}%`}},correctBoxShadow={correct:(t,{treeScale:e,projectionDelta:r})=>{const n=t,s=complex.parse(t);if(s.length>5)return n;const a=complex.createTransformer(t),o=typeof s[0]!="number"?1:0,l=r.x.scale*e.x,u=r.y.scale*e.y;s[0+o]/=l,s[1+o]/=u;const c=mixNumber$1(l,u,.5);return typeof s[2+o]=="number"&&(s[2+o]/=c),typeof s[3+o]=="number"&&(s[3+o]/=c),a(s)}};class MeasureLayoutWithContext extends reactExports.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:a}=e;addScaleCorrector(defaultScaleCorrectors),a&&(r.group&&r.group.add(a),n&&n.register&&s&&n.register(a),a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),globalProjectionState.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:n,drag:s,isPresent:a}=this.props,{projection:o}=n;return o&&(o.isPresent=a,s||e.layoutDependency!==r||r===void 0||e.isPresent!==a?o.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?o.promote():o.relegate()||frame$1.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),microtask.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function MeasureLayout(t){const[e,r]=usePresence$1(),n=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(MeasureLayoutWithContext,{...t,layoutGroup:n,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:e,safeToRemove:r})}const defaultScaleCorrectors={borderRadius:{...correctBorderRadius,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow};function animateSingleValue(t,e,r){const n=isMotionValue(t)?t:motionValue(t);return n.start(animateMotionValue("",n,e,r)),n.animation}const compareByDepth=(t,e)=>t.depth-e.depth;class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(e){addUniqueItem(this.children,e),this.isDirty=!0}remove(e){removeItem(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(e)}}function delay(t,e){const r=time.now(),n=({timestamp:s})=>{const a=s-r;a>=e&&(cancelFrame(n),t(a-e))};return frame$1.setup(n,!0),()=>cancelFrame(n)}const borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=t=>typeof t=="string"?parseFloat(t):t,isPx=t=>typeof t=="number"||px.test(t);function mixValues(t,e,r,n,s,a){s?(t.opacity=mixNumber$1(0,r.opacity??1,easeCrossfadeIn(n)),t.opacityExit=mixNumber$1(e.opacity??1,0,easeCrossfadeOut(n))):a&&(t.opacity=mixNumber$1(e.opacity??1,r.opacity??1,n));for(let o=0;o<numBorders;o++){const l=`border${borders[o]}Radius`;let u=getRadius(e,l),c=getRadius(r,l);if(u===void 0&&c===void 0)continue;u||(u=0),c||(c=0),u===0||c===0||isPx(u)===isPx(c)?(t[l]=Math.max(mixNumber$1(asNumber(u),asNumber(c),n),0),(percent.test(c)||percent.test(u))&&(t[l]+="%")):t[l]=c}(e.rotate||r.rotate)&&(t.rotate=mixNumber$1(e.rotate||0,r.rotate||0,n))}function getRadius(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,noop$6);function compress(t,e,r){return n=>n<t?0:n>e?1:r(progress(t,e,n))}function copyAxisInto(t,e){t.min=e.min,t.max=e.max}function copyBoxInto(t,e){copyAxisInto(t.x,e.x),copyAxisInto(t.y,e.y)}function copyAxisDeltaInto(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function removePointDelta(t,e,r,n,s){return t-=e,t=scalePoint(t,1/r,n),s!==void 0&&(t=scalePoint(t,1/s,n)),t}function removeAxisDelta(t,e=0,r=1,n=.5,s,a=t,o=t){if(percent.test(e)&&(e=parseFloat(e),e=mixNumber$1(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=mixNumber$1(a.min,a.max,n);t===a&&(l-=e),t.min=removePointDelta(t.min,e,r,l,s),t.max=removePointDelta(t.max,e,r,l,s)}function removeAxisTransforms(t,e,[r,n,s],a,o){removeAxisDelta(t,e[r],e[n],e[s],e.scale,a,o)}const xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(t,e,r,n){removeAxisTransforms(t.x,e,xKeys,r?r.x:void 0,n?n.x:void 0),removeAxisTransforms(t.y,e,yKeys,r?r.y:void 0,n?n.y:void 0)}function isAxisDeltaZero(t){return t.translate===0&&t.scale===1}function isDeltaZero(t){return isAxisDeltaZero(t.x)&&isAxisDeltaZero(t.y)}function axisEquals(t,e){return t.min===e.min&&t.max===e.max}function boxEquals(t,e){return axisEquals(t.x,e.x)&&axisEquals(t.y,e.y)}function axisEqualsRounded(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function boxEqualsRounded(t,e){return axisEqualsRounded(t.x,e.x)&&axisEqualsRounded(t.y,e.y)}function aspectRatio(t){return calcLength(t.x)/calcLength(t.y)}function axisDeltaEquals(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class NodeStack{constructor(){this.members=[]}add(e){addUniqueItem(this.members,e),e.scheduleRender()}remove(e){if(removeItem(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(s=>e===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const a=this.members[s];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(e,r){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,r&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:n}=e;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function buildProjectionTransform(t,e,r){let n="";const s=t.x.translate/e.x,a=t.y.translate/e.y,o=(r==null?void 0:r.z)||0;if((s||a||o)&&(n=`translate3d(${s}px, ${a}px, ${o}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),r){const{transformPerspective:c,rotate:d,rotateX:p,rotateY:m,skewX:y,skewY:b}=r;c&&(n=`perspective(${c}px) ${n}`),d&&(n+=`rotate(${d}deg) `),p&&(n+=`rotateX(${p}deg) `),m&&(n+=`rotateY(${m}deg) `),y&&(n+=`skewX(${y}deg) `),b&&(n+=`skewY(${b}deg) `)}const l=t.x.scale*e.x,u=t.y.scale*e.y;return(l!==1||u!==1)&&(n+=`scale(${l}, ${u})`),n||"none"}const transformAxes=["","X","Y","Z"],hiddenVisibility={visibility:"hidden"},animationTarget=1e3;let id$1=0;function resetDistortingTransform(t,e,r,n){const{latestValues:s}=e;s[t]&&(r[t]=s[t],e.setStaticValue(t,0),n&&(n[t]=0))}function cancelTreeOptimisedTransformAnimations(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const r=getOptimisedAppearId(e);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:a}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",frame$1,!(s||a))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(n)}function createProjectionNode({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(o={},l=e==null?void 0:e()){this.id=id$1++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new SubscriptionManager),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=isSVGElement$1(o)&&!isSVGSVGElement(o),this.instance=o;const{layoutId:l,layout:u,visualElement:c}=this.options;if(c&&!c.current&&c.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||l)&&(this.isLayoutDirty=!0),t){let d;const p=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,d&&d(),d=delay(p,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&c&&(l||u)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:p,hasRelativeLayoutChanged:m,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const b=this.options.transition||c.getDefaultTransition()||defaultLayoutTransition,{onLayoutAnimationStart:E,onLayoutAnimationComplete:T}=c.getProps(),S=!this.targetLayout||!boxEqualsRounded(this.targetLayout,y),P=!p&&m;if(this.options.layoutRoot||this.resumeFrom||P||p&&(S||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const A={...getValueTransition(b,"layout"),onPlay:E,onComplete:T};(c.shouldReduceMotion||this.options.layoutRoot)&&(A.delay=0,A.type=!1),this.startAnimation(A),this.setAnimationOrigin(d,P)}else p||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),cancelFrame(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetSkewAndRotation),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const p=this.path[d];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}this.isUpdating||this.nodes.forEach(clearIsLayoutDirty),this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate),this.clearAllSnapshots();const l=time.now();frameData.delta=clamp$2(0,1e3/60,l-frameData.timestamp),frameData.timestamp=l,frameData.isProcessing=!0,frameSteps.update.process(frameData),frameSteps.preRender.process(frameData),frameSteps.render.process(frameData),frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,microtask.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,frame$1.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){frame$1.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!calcLength(this.snapshot.measuredBox.x)&&!calcLength(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=createBox$1(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&this.instance){const u=n(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!isDeltaZero(this.projectionDelta),u=this.getTransformTemplate(),c=u?u(this.latestValues,""):void 0,d=c!==this.prevTransformTemplateValue;o&&this.instance&&(l||hasTransform(this.latestValues)||d)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),roundBox(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:o}=this.options;if(!o)return createBox$1();const l=o.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(checkNodeWasScrollRoot))){const{scroll:d}=this.root;d&&(translateAxis(l.x,d.offset.x),translateAxis(l.y,d.offset.y))}return l}removeElementScroll(o){var u;const l=createBox$1();if(copyBoxInto(l,o),(u=this.scroll)!=null&&u.wasRoot)return l;for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:p,options:m}=d;d!==this.root&&p&&m.layoutScroll&&(p.wasRoot&&copyBoxInto(l,o),translateAxis(l.x,p.offset.x),translateAxis(l.y,p.offset.y))}return l}applyTransform(o,l=!1){const u=createBox$1();copyBoxInto(u,o);for(let c=0;c<this.path.length;c++){const d=this.path[c];!l&&d.options.layoutScroll&&d.scroll&&d!==d.root&&transformBox(u,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),hasTransform(d.latestValues)&&transformBox(u,d.latestValues)}return hasTransform(this.latestValues)&&transformBox(u,this.latestValues),u}removeTransform(o){const l=createBox$1();copyBoxInto(l,o);for(let u=0;u<this.path.length;u++){const c=this.path[u];if(!c.instance||!hasTransform(c.latestValues))continue;hasScale(c.latestValues)&&c.updateSnapshot();const d=createBox$1(),p=c.measurePageBox();copyBoxInto(d,p),removeBoxTransforms(l,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,d)}return hasTransform(this.latestValues)&&removeBoxTransforms(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var m;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:p}=this.options;if(!(!this.layout||!(d||p))){if(this.resolvedRelativeTargetAt=frameData.timestamp,!this.targetDelta&&!this.relativeTarget){const y=this.getClosestProjectingParent();y&&y.layout&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox$1(),this.relativeTargetOrigin=createBox$1(),calcRelativePosition(this.relativeTargetOrigin,this.layout.layoutBox,y.layout.layoutBox),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=createBox$1(),this.targetWithTransforms=createBox$1()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const y=this.getClosestProjectingParent();y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox$1(),this.relativeTargetOrigin=createBox$1(),calcRelativePosition(this.relativeTargetOrigin,this.target,y.target),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var b;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||(b=this.parent)!=null&&b.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===frameData.timestamp&&(u=!1),u)return;const{layout:c,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||d))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,m=this.treeScale.y;applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=createBox$1());const{target:y}=o;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(copyAxisDeltaInto(this.prevProjectionDelta.x,this.projectionDelta.x),copyAxisDeltaInto(this.prevProjectionDelta.y,this.projectionDelta.y)),calcBoxDelta(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==m||!axisDeltaEquals(this.projectionDelta.x,this.prevProjectionDelta.x)||!axisDeltaEquals(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)==null||l.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=createDelta(),this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta()}setAnimationOrigin(o,l=!1){const u=this.snapshot,c=u?u.latestValues:{},d={...this.latestValues},p=createDelta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const m=createBox$1(),y=u?u.source:void 0,b=this.layout?this.layout.source:void 0,E=y!==b,T=this.getStack(),S=!T||T.members.length<=1,P=!!(E&&!S&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0;let A;this.mixTargetDelta=I=>{const j=I/1e3;mixAxisDelta(p.x,o.x,j),mixAxisDelta(p.y,o.y,j),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(calcRelativePosition(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mixBox(this.relativeTarget,this.relativeTargetOrigin,m,j),A&&boxEquals(this.relativeTarget,A)&&(this.isProjectionDirty=!1),A||(A=createBox$1()),copyBoxInto(A,this.relativeTarget)),E&&(this.animationValues=d,mixValues(d,c,this.latestValues,j,P,S)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=j},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var l,u,c;this.notifyListeners("animationStart"),(l=this.currentAnimation)==null||l.stop(),(c=(u=this.resumingFrom)==null?void 0:u.currentAnimation)==null||c.stop(),this.pendingAnimation&&(cancelFrame(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=frame$1.update(()=>{globalProjectionState.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=motionValue(0)),this.currentAnimation=animateSingleValue(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:d=>{this.mixTargetDelta(d),o.onUpdate&&o.onUpdate(d)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(animationTarget),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:c,latestValues:d}=o;if(!(!l||!u||!c)){if(this!==o&&this.layout&&c&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,c.layoutBox)){u=this.target||createBox$1();const p=calcLength(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const m=calcLength(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+m}copyBoxInto(l,u),transformBox(l,d),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,l,d)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new NodeStack),this.sharedNodes.get(o).add(l);const c=l.options.initialPromotionConfig;l.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var l;const{layoutId:o}=this.options;return o?((l=this.getStack())==null?void 0:l.lead)||this:this}getPrevLead(){var l;const{layoutId:o}=this.options;return o?(l=this.getStack())==null?void 0:l.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const c=this.getStack();c&&c.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const c={};u.z&&resetDistortingTransform("z",o,c,this.animationValues);for(let d=0;d<transformAxes.length;d++)resetDistortingTransform(`rotate${transformAxes[d]}`,o,c,this.animationValues),resetDistortingTransform(`skew${transformAxes[d]}`,o,c,this.animationValues);o.render();for(const d in c)o.setStaticValue(d,c[d]),this.animationValues&&(this.animationValues[d]=c[d]);o.scheduleRender()}getProjectionStyles(o){if(!this.instance||this.isSVG)return;if(!this.isVisible)return hiddenVisibility;const l={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,l.opacity="",l.pointerEvents=resolveMotionValue(o==null?void 0:o.pointerEvents)||"",l.transform=u?u(this.latestValues,""):"none",l;const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){const y={};return this.options.layoutId&&(y.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,y.pointerEvents=resolveMotionValue(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(y.transform=u?u({},""):"none",this.hasProjected=!1),y}const d=c.animationValues||c.latestValues;this.applyTransformsToTarget(),l.transform=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,d),u&&(l.transform=u(d,l.transform));const{x:p,y:m}=this.projectionDelta;l.transformOrigin=`${p.origin*100}% ${m.origin*100}% 0`,c.animationValues?l.opacity=c===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:l.opacity=c===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const y in scaleCorrectors){if(d[y]===void 0)continue;const{correct:b,applyTo:E,isCSSVariable:T}=scaleCorrectors[y],S=l.transform==="none"?d[y]:b(d[y],c);if(E){const P=E.length;for(let A=0;A<P;A++)l[E[A]]=S}else T?this.options.visualElement.renderState.vars[y]=S:l[y]=S}return this.options.layoutId&&(l.pointerEvents=c===this?resolveMotionValue(o==null?void 0:o.pointerEvents)||"":"none"),l}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)==null?void 0:l.stop()}),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(t){t.updateLayout()}function notifyLayoutUpdate(t){var r;const e=((r=t.resumeFrom)==null?void 0:r.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=t.layout,{animationType:a}=t.options,o=e.source!==t.layout.source;a==="size"?eachAxis(p=>{const m=o?e.measuredBox[p]:e.layoutBox[p],y=calcLength(m);m.min=n[p].min,m.max=m.min+y}):shouldAnimatePositionOnly(a,e.layoutBox,n)&&eachAxis(p=>{const m=o?e.measuredBox[p]:e.layoutBox[p],y=calcLength(n[p]);m.max=m.min+y,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[p].max=t.relativeTarget[p].min+y)});const l=createDelta();calcBoxDelta(l,n,e.layoutBox);const u=createDelta();o?calcBoxDelta(u,t.applyTransform(s,!0),e.measuredBox):calcBoxDelta(u,n,e.layoutBox);const c=!isDeltaZero(l);let d=!1;if(!t.resumeFrom){const p=t.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:m,layout:y}=p;if(m&&y){const b=createBox$1();calcRelativePosition(b,e.layoutBox,m.layoutBox);const E=createBox$1();calcRelativePosition(E,n,y.layoutBox),boxEqualsRounded(b,E)||(d=!0),p.options.layoutRoot&&(t.relativeTarget=E,t.relativeTargetOrigin=b,t.relativeParent=p)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:u,layoutDelta:l,hasLayoutChanged:c,hasRelativeLayoutChanged:d})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function propagateDirtyNodes(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function cleanDirtyNodes(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function clearSnapshot(t){t.clearSnapshot()}function clearMeasurements(t){t.clearMeasurements()}function clearIsLayoutDirty(t){t.isLayoutDirty=!1}function resetTransformStyle(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function finishAnimation(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function resolveTargetDelta(t){t.resolveTargetDelta()}function calcProjection(t){t.calcProjection()}function resetSkewAndRotation(t){t.resetSkewAndRotation()}function removeLeadSnapshots(t){t.removeLeadSnapshot()}function mixAxisDelta(t,e,r){t.translate=mixNumber$1(e.translate,0,r),t.scale=mixNumber$1(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function mixAxis(t,e,r,n){t.min=mixNumber$1(e.min,r.min,n),t.max=mixNumber$1(e.max,r.max,n)}function mixBox(t,e,r,n){mixAxis(t.x,e.x,r.x,n),mixAxis(t.y,e.y,r.y,n)}function hasOpacityCrossfade(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]},userAgentContains=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),roundPoint=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:noop$6;function roundAxis(t){t.min=roundPoint(t.min),t.max=roundPoint(t.max)}function roundBox(t){roundAxis(t.x),roundAxis(t.y)}function shouldAnimatePositionOnly(t,e,r){return t==="position"||t==="preserve-aspect"&&!isNear(aspectRatio(e),aspectRatio(r),.2)}function checkNodeWasScrollRoot(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const DocumentProjectionNode=createProjectionNode({attachResizeListener:(t,e)=>addDomEvent(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!rootProjectionNode.current){const t=new DocumentProjectionNode({});t.mount(window),t.setOptions({layoutScroll:!0}),rootProjectionNode.current=t}return rootProjectionNode.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),drag$1={pan:{Feature:PanGesture},drag:{Feature:DragGesture,ProjectionNode:HTMLProjectionNode,MeasureLayout}};function handleHoverEvent(t,e,r){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,a=n[s];a&&frame$1.postRender(()=>a(e,extractEventInfo(e)))}class HoverGesture extends Feature{mount(){const{current:e}=this.node;e&&(this.unmount=hover(e,(r,n)=>(handleHoverEvent(this.node,n,"Start"),s=>handleHoverEvent(this.node,s,"End"))))}unmount(){}}class FocusGesture extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function handlePressEvent(t,e,r){const{props:n}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),a=n[s];a&&frame$1.postRender(()=>a(e,extractEventInfo(e)))}class PressGesture extends Feature{mount(){const{current:e}=this.node;e&&(this.unmount=press(e,(r,n)=>(handlePressEvent(this.node,n,"Start"),(s,{success:a})=>handlePressEvent(this.node,s,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=t=>{const e=observerCallbacks.get(t.target);e&&e(t)},fireAllObserverCallbacks=t=>{t.forEach(fireObserverCallback)};function initIntersectionObserver({root:t,...e}){const r=t||document;observers.has(r)||observers.set(r,{});const n=observers.get(r),s=JSON.stringify(e);return n[s]||(n[s]=new IntersectionObserver(fireAllObserverCallbacks,{root:t,...e})),n[s]}function observeIntersection(t,e,r){const n=initIntersectionObserver(e);return observerCallbacks.set(t,r),n.observe(t),()=>{observerCallbacks.delete(t),n.unobserve(t)}}const thresholdNames={some:0,all:1};class InViewFeature extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:a}=e,o={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:thresholdNames[s]},l=u=>{const{isIntersecting:c}=u;if(this.isInView===c||(this.isInView=c,a&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:d,onViewportLeave:p}=this.node.getProps(),m=c?d:p;m&&m(u)};return observeIntersection(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(hasViewportOptionChanged(e,r))&&this.startObserver()}unmount(){}}function hasViewportOptionChanged({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const gestureAnimations={inView:{Feature:InViewFeature},tap:{Feature:PressGesture},focus:{Feature:FocusGesture},hover:{Feature:HoverGesture}},layout={layout:{ProjectionNode:HTMLProjectionNode,MeasureLayout}},prefersReducedMotion={current:null},hasReducedMotionListener={current:!1};function initPrefersReducedMotion(){if(hasReducedMotionListener.current=!0,!!isBrowser$2)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>prefersReducedMotion.current=t.matches;t.addListener(e),e()}else prefersReducedMotion.current=!1}const visualElementStore=new WeakMap;function updateMotionValuesFromProps(t,e,r){for(const n in e){const s=e[n],a=r[n];if(isMotionValue(s))t.addValue(n,s);else if(isMotionValue(a))t.addValue(n,motionValue(s,{owner:t}));else if(a!==s)if(t.hasValue(n)){const o=t.getValue(n);o.liveStyle===!0?o.jump(s):o.hasAnimated||o.set(s)}else{const o=t.getStaticValue(n);t.addValue(n,motionValue(o!==void 0?o:s,{owner:t}))}}for(const n in r)e[n]===void 0&&t.removeValue(n);return e}const propEventHandlers=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class VisualElement{scrapeMotionValuesFromProps(e,r,n){return{}}constructor({parent:e,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:a,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=KeyframeResolver,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=time.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,frame$1.render(this.render,!1,!0))};const{latestValues:u,renderState:c}=o;this.latestValues=u,this.baseTarget={...u},this.initialValues=r.initial?{...u}:{},this.renderState=c,this.parent=e,this.props=r,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=l,this.blockInitialAnimation=!!a,this.isControllingVariants=isControllingVariants(r),this.isVariantNode=isVariantNode(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...p}=this.scrapeMotionValuesFromProps(r,{},this);for(const m in p){const y=p[m];u[m]!==void 0&&isMotionValue(y)&&y.set(u[m],!1)}}mount(e){this.current=e,visualElementStore.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),hasReducedMotionListener.current||initPrefersReducedMotion(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:prefersReducedMotion.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),cancelFrame(this.notifyUpdate),cancelFrame(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const r=this.features[e];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=transformProps.has(e);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&frame$1.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),a=r.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{s(),a(),o&&o(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in featureDefinitions){const r=featureDefinitions[e];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[e]&&s&&n(this.props)&&(this.features[e]=new s(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox$1()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<propEventHandlers.length;n++){const s=propEventHandlers[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const a="on"+s,o=e[a];o&&(this.propEventSubscriptions[s]=this.on(s,o))}this.prevMotionValues=updateMotionValuesFromProps(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const n=this.values.get(e);r!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&r!==void 0&&(n=motionValue(r===null?void 0:r,{owner:this}),this.addValue(e,n)),n}readValue(e,r){let n=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return n!=null&&(typeof n=="string"&&(isNumericalString(n)||isZeroValueString(n))?n=parseFloat(n):!findValueType(n)&&complex.test(r)&&(n=getAnimatableNone(e,r)),this.setBaseTarget(e,isMotionValue(n)?n.get():n)),isMotionValue(n)?n.get():n}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){var a;const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const o=resolveVariantFromProps(this.props,r,(a=this.presenceContext)==null?void 0:a.custom);o&&(n=o[e])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!isMotionValue(s)?s:this.initialValues[e]!==void 0&&n===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new SubscriptionManager),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}}class DOMVisualElement extends VisualElement{constructor(){super(...arguments),this.KeyframeResolver=DOMKeyframesResolver}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:n}){delete r[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;isMotionValue(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function renderHTML(t,{style:e,vars:r},n,s){Object.assign(t.style,e,s&&s.getProjectionStyles(n));for(const a in r)t.style.setProperty(a,r[a])}function getComputedStyle$2(t){return window.getComputedStyle(t)}class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html",this.renderInstance=renderHTML}readValueFromInstance(e,r){var n;if(transformProps.has(r))return(n=this.projection)!=null&&n.isProjecting?defaultTransformValue(r):readTransformValue(e,r);{const s=getComputedStyle$2(e),a=(isCSSVariableName(r)?s.getPropertyValue(r):s[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(e,{transformPagePoint:r}){return measureViewportBox(e,r)}build(e,r,n){buildHTMLStyles(e,r,n.transformTemplate)}scrapeMotionValuesFromProps(e,r,n){return scrapeMotionValuesFromProps$1(e,r,n)}}const camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function renderSVG(t,e,r,n){renderHTML(t,e,void 0,n);for(const s in e.attrs)t.setAttribute(camelCaseAttributes.has(s)?s:camelToDash(s),e.attrs[s])}class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=createBox$1}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(transformProps.has(r)){const n=getDefaultValueType(r);return n&&n.default||0}return r=camelCaseAttributes.has(r)?r:camelToDash(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,n){return scrapeMotionValuesFromProps(e,r,n)}build(e,r,n){buildSVGAttrs(e,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,r,n,s){renderSVG(e,r,n,s)}mount(e){this.isSVGTag=isSVGTag(e.tagName),super.mount(e)}}const createDomVisualElement=(t,e)=>isSVGComponent(t)?new SVGVisualElement(e):new HTMLVisualElement(e,{allowProjection:t!==reactExports.Fragment}),createMotionComponent=createMotionComponentFactory({...animations,...gestureAnimations,...drag$1,...layout},createDomVisualElement),motion=createDOMMotionComponentProxy(createMotionComponent);function useMotionValueEvent(t,e,r){reactExports.useInsertionEffect(()=>t.on(e,r),[t,e,r])}function useMotionValue(t){const e=useConstant(()=>motionValue(t)),{isStatic:r}=reactExports.useContext(MotionConfigContext);if(r){const[,n]=reactExports.useState(t);reactExports.useEffect(()=>e.on("change",n),[])}return e}class DragControls{constructor(){this.componentControls=new Set}subscribe(e){return this.componentControls.add(e),()=>this.componentControls.delete(e)}start(e,r){this.componentControls.forEach(n=>{n.start(e.nativeEvent||e,r)})}}const createDragControls=()=>new DragControls;function useDragControls(){return useConstant(createDragControls)}var lib$1={exports:{}},lodash$1={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var lodash=lodash$1.exports,hasRequiredLodash;function requireLodash(){return hasRequiredLodash||(hasRequiredLodash=1,function(t,e){(function(){var r,n="4.17.21",s=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",l="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",c=500,d="__lodash_placeholder__",p=1,m=2,y=4,b=1,E=2,T=1,S=2,P=4,A=8,I=16,j=32,K=64,W=128,H=256,ee=512,ue=30,de="...",fe=800,ae=16,ce=1,me=2,te=3,le=1/0,Z=9007199254740991,Y=17976931348623157e292,he=NaN,oe=4294967295,ye=oe-1,Ee=oe>>>1,Ae=[["ary",W],["bind",T],["bindKey",S],["curry",A],["curryRight",I],["flip",ee],["partial",j],["partialRight",K],["rearg",H]],je="[object Arguments]",Te="[object Array]",Ve="[object AsyncFunction]",Pe="[object Boolean]",Ce="[object Date]",De="[object DOMException]",ze="[object Error]",Et="[object Function]",Ze="[object GeneratorFunction]",Ue="[object Map]",qt="[object Number]",or="[object Null]",Lt="[object Object]",rt="[object Promise]",lr="[object Proxy]",ir="[object RegExp]",er="[object Set]",xr="[object String]",br="[object Symbol]",Pr="[object Undefined]",zr="[object WeakMap]",pr="[object WeakSet]",dr="[object ArrayBuffer]",Ar="[object DataView]",_r="[object Float32Array]",It="[object Float64Array]",Bt="[object Int8Array]",ur="[object Int16Array]",Vn="[object Int32Array]",gn="[object Uint8Array]",yn="[object Uint8ClampedArray]",Dr="[object Uint16Array]",Nr="[object Uint32Array]",wn=/\b__p \+= '';/g,jn=/\b(__p \+=) '' \+/g,$r=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Cr=/&(?:amp|lt|gt|quot|#39);/g,Ir=/[&<>"']/g,kr=RegExp(Cr.source),Er=RegExp(Ir.source),Nn=/<%-([\s\S]+?)%>/g,Hr=/<%([\s\S]+?)%>/g,qr=/<%=([\s\S]+?)%>/g,Fr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Dn=/^\w*$/,yr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Wr=/[\\^$.*+?()[\]{}|]/g,vr=RegExp(Wr.source),jr=/^\s+/,Qr=/\s/,xn=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Lr=/\{\n\/\* \[wrapped with (.+)\] \*/,_s=/,? & /,Hs=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Bn=/[()=,{}\[\]\/\s]/,Hn=/\\(\\)?/g,Tn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Mn=/\w*$/,os=/^[-+]0x[0-9a-f]+$/i,es=/^0b[01]+$/i,ci=/^\[object .+?Constructor\]$/,ti=/^0o[0-7]+$/i,Se=/^(?:0|[1-9]\d*)$/,We=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,et=/($^)/,Ye=/['\n\r\u2028\u2029\\]/g,Xe="\\ud800-\\udfff",qe="\\u0300-\\u036f",kt="\\ufe20-\\ufe2f",Wt="\\u20d0-\\u20ff",cr=qe+kt+Wt,nr="\\u2700-\\u27bf",Kr="a-z\\xdf-\\xf6\\xf8-\\xff",un="\\xac\\xb1\\xd7\\xf7",An="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Sn="\\u2000-\\u206f",ls=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Fa="A-Z\\xc0-\\xd6\\xd8-\\xde",ho="\\ufe0e\\ufe0f",Fs=un+An+Sn+ls,Wi="['’]",La="["+Xe+"]",pa="["+Fs+"]",Ki="["+cr+"]",xu="\\d+",ma="["+nr+"]",qs="["+Kr+"]",Va="[^"+Xe+Fs+xu+nr+Kr+Fa+"]",Zi="\\ud83c[\\udffb-\\udfff]",Ba="(?:"+Ki+"|"+Zi+")",Cn="[^"+Xe+"]",Xi="(?:\\ud83c[\\udde6-\\uddff]){2}",Gr="[\\ud800-\\udbff][\\udc00-\\udfff]",ri="["+Fa+"]",Cl="\\u200d",po="(?:"+qs+"|"+Va+")",_u="(?:"+ri+"|"+Va+")",Il="(?:"+Wi+"(?:d|ll|m|re|s|t|ve))?",kl="(?:"+Wi+"(?:D|LL|M|RE|S|T|VE))?",Wo=Ba+"?",Ci="["+ho+"]?",bs="(?:"+Cl+"(?:"+[Cn,Xi,Gr].join("|")+")"+Ci+Wo+")*",Ii="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ki="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ga=Ci+Wo+bs,di="(?:"+[ma,Xi,Gr].join("|")+")"+ga,Yi="(?:"+[Cn+Ki+"?",Ki,Xi,Gr,La].join("|")+")",Oc=RegExp(Wi,"g"),bu=RegExp(Ki,"g"),Ts=RegExp(Zi+"(?="+Zi+")|"+Yi+ga,"g"),$c=RegExp([ri+"?"+qs+"+"+Il+"(?="+[pa,ri,"$"].join("|")+")",_u+"+"+kl+"(?="+[pa,ri+po,"$"].join("|")+")",ri+"?"+po+"+"+Il,ri+"+"+kl,ki,Ii,xu,di].join("|"),"g"),Eu=RegExp("["+Cl+Xe+cr+ho+"]"),ya=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,mo=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],wu=-1,Xr={};Xr[_r]=Xr[It]=Xr[Bt]=Xr[ur]=Xr[Vn]=Xr[gn]=Xr[yn]=Xr[Dr]=Xr[Nr]=!0,Xr[je]=Xr[Te]=Xr[dr]=Xr[Pe]=Xr[Ar]=Xr[Ce]=Xr[ze]=Xr[Et]=Xr[Ue]=Xr[qt]=Xr[Lt]=Xr[ir]=Xr[er]=Xr[xr]=Xr[zr]=!1;var Zr={};Zr[je]=Zr[Te]=Zr[dr]=Zr[Ar]=Zr[Pe]=Zr[Ce]=Zr[_r]=Zr[It]=Zr[Bt]=Zr[ur]=Zr[Vn]=Zr[Ue]=Zr[qt]=Zr[Lt]=Zr[ir]=Zr[er]=Zr[xr]=Zr[br]=Zr[gn]=Zr[yn]=Zr[Dr]=Zr[Nr]=!0,Zr[ze]=Zr[Et]=Zr[zr]=!1;var va={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Ua={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Un={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Fc={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Nl=parseFloat,go=parseInt,yo=typeof commonjsGlobal$2=="object"&&commonjsGlobal$2&&commonjsGlobal$2.Object===Object&&commonjsGlobal$2,Dl=typeof self=="object"&&self&&self.Object===Object&&self,Rn=yo||Dl||Function("return this")(),Ga=e&&!e.nodeType&&e,ts=Ga&&!0&&t&&!t.nodeType&&t,Ko=ts&&ts.exports===Ga,za=Ko&&yo.process,Xn=function(){try{var Me=ts&&ts.require&&ts.require("util").types;return Me||za&&za.binding&&za.binding("util")}catch{}}(),Zo=Xn&&Xn.isArrayBuffer,ms=Xn&&Xn.isDate,fi=Xn&&Xn.isMap,vo=Xn&&Xn.isRegExp,Ni=Xn&&Xn.isSet,Su=Xn&&Xn.isTypedArray;function gs(Me,Ke,Be){switch(Be.length){case 0:return Me.call(Ke);case 1:return Me.call(Ke,Be[0]);case 2:return Me.call(Ke,Be[0],Be[1]);case 3:return Me.call(Ke,Be[0],Be[1],Be[2])}return Me.apply(Ke,Be)}function xa(Me,Ke,Be,Ut){for(var Tr=-1,hn=Me==null?0:Me.length;++Tr<hn;){var rs=Me[Tr];Ke(Ut,rs,Be(rs),Me)}return Ut}function us(Me,Ke){for(var Be=-1,Ut=Me==null?0:Me.length;++Be<Ut&&Ke(Me[Be],Be,Me)!==!1;);return Me}function xo(Me,Ke){for(var Be=Me==null?0:Me.length;Be--&&Ke(Me[Be],Be,Me)!==!1;);return Me}function _o(Me,Ke){for(var Be=-1,Ut=Me==null?0:Me.length;++Be<Ut;)if(!Ke(Me[Be],Be,Me))return!1;return!0}function hi(Me,Ke){for(var Be=-1,Ut=Me==null?0:Me.length,Tr=0,hn=[];++Be<Ut;){var rs=Me[Be];Ke(rs,Be,Me)&&(hn[Tr++]=rs)}return hn}function bo(Me,Ke){var Be=Me==null?0:Me.length;return!!Be&&ba(Me,Ke,0)>-1}function Ha(Me,Ke,Be){for(var Ut=-1,Tr=Me==null?0:Me.length;++Ut<Tr;)if(Be(Ke,Me[Ut]))return!0;return!1}function Pn(Me,Ke){for(var Be=-1,Ut=Me==null?0:Me.length,Tr=Array(Ut);++Be<Ut;)Tr[Be]=Ke(Me[Be],Be,Me);return Tr}function Di(Me,Ke){for(var Be=-1,Ut=Ke.length,Tr=Me.length;++Be<Ut;)Me[Tr+Be]=Ke[Be];return Me}function ji(Me,Ke,Be,Ut){var Tr=-1,hn=Me==null?0:Me.length;for(Ut&&hn&&(Be=Me[++Tr]);++Tr<hn;)Be=Ke(Be,Me[Tr],Tr,Me);return Be}function Ru(Me,Ke,Be,Ut){var Tr=Me==null?0:Me.length;for(Ut&&Tr&&(Be=Me[--Tr]);Tr--;)Be=Ke(Be,Me[Tr],Tr,Me);return Be}function Xo(Me,Ke){for(var Be=-1,Ut=Me==null?0:Me.length;++Be<Ut;)if(Ke(Me[Be],Be,Me))return!0;return!1}var Pu=pe("length");function jl(Me){return Me.split("")}function Yo(Me){return Me.match(Hs)||[]}function As(Me,Ke,Be){var Ut;return Be(Me,function(Tr,hn,rs){if(Ke(Tr,hn,rs))return Ut=hn,!1}),Ut}function Eo(Me,Ke,Be,Ut){for(var Tr=Me.length,hn=Be+(Ut?1:-1);Ut?hn--:++hn<Tr;)if(Ke(Me[hn],hn,Me))return hn;return-1}function ba(Me,Ke,Be){return Ke===Ke?Au(Me,Ke,Be):Eo(Me,D,Be)}function Ji(Me,Ke,Be,Ut){for(var Tr=Be-1,hn=Me.length;++Tr<hn;)if(Ut(Me[Tr],Ke))return Tr;return-1}function D(Me){return Me!==Me}function ne(Me,Ke){var Be=Me==null?0:Me.length;return Be?Nt(Me,Ke)/Be:he}function pe(Me){return function(Ke){return Ke==null?r:Ke[Me]}}function _e(Me){return function(Ke){return Me==null?r:Me[Ke]}}function $e(Me,Ke,Be,Ut,Tr){return Tr(Me,function(hn,rs,In){Be=Ut?(Ut=!1,hn):Ke(Be,hn,rs,In)}),Be}function He(Me,Ke){var Be=Me.length;for(Me.sort(Ke);Be--;)Me[Be]=Me[Be].value;return Me}function Nt(Me,Ke){for(var Be,Ut=-1,Tr=Me.length;++Ut<Tr;){var hn=Ke(Me[Ut]);hn!==r&&(Be=Be===r?hn:Be+hn)}return Be}function vn(Me,Ke){for(var Be=-1,Ut=Array(Me);++Be<Me;)Ut[Be]=Ke(Be);return Ut}function cs(Me,Ke){return Pn(Ke,function(Be){return[Be,Me[Be]]})}function Yr(Me){return Me&&Me.slice(0,Cu(Me)+1).replace(jr,"")}function bn(Me){return function(Ke){return Me(Ke)}}function Kn(Me,Ke){return Pn(Ke,function(Be){return Me[Be]})}function Cs(Me,Ke){return Me.has(Ke)}function Ws(Me,Ke){for(var Be=-1,Ut=Me.length;++Be<Ut&&ba(Ke,Me[Be],0)>-1;);return Be}function qa(Me,Ke){for(var Be=Me.length;Be--&&ba(Ke,Me[Be],0)>-1;);return Be}function Jo(Me,Ke){for(var Be=Me.length,Ut=0;Be--;)Me[Be]===Ke&&++Ut;return Ut}var Bd=_e(va),Ud=_e(Ua);function Gd(Me){return"\\"+Fc[Me]}function Qo(Me,Ke){return Me==null?r:Me[Ke]}function el(Me){return Eu.test(Me)}function zf(Me){return ya.test(Me)}function Hf(Me){for(var Ke,Be=[];!(Ke=Me.next()).done;)Be.push(Ke.value);return Be}function Tu(Me){var Ke=-1,Be=Array(Me.size);return Me.forEach(function(Ut,Tr){Be[++Ke]=[Tr,Ut]}),Be}function Lc(Me,Ke){return function(Be){return Me(Ke(Be))}}function pi(Me,Ke){for(var Be=-1,Ut=Me.length,Tr=0,hn=[];++Be<Ut;){var rs=Me[Be];(rs===Ke||rs===d)&&(Me[Be]=d,hn[Tr++]=Be)}return hn}function Wa(Me){var Ke=-1,Be=Array(Me.size);return Me.forEach(function(Ut){Be[++Ke]=Ut}),Be}function qf(Me){var Ke=-1,Be=Array(Me.size);return Me.forEach(function(Ut){Be[++Ke]=[Ut,Ut]}),Be}function Au(Me,Ke,Be){for(var Ut=Be-1,Tr=Me.length;++Ut<Tr;)if(Me[Ut]===Ke)return Ut;return-1}function Wf(Me,Ke,Be){for(var Ut=Be+1;Ut--;)if(Me[Ut]===Ke)return Ut;return Ut}function wo(Me){return el(Me)?Hd(Me):Pu(Me)}function ni(Me){return el(Me)?qd(Me):jl(Me)}function Cu(Me){for(var Ke=Me.length;Ke--&&Qr.test(Me.charAt(Ke)););return Ke}var zd=_e(Un);function Hd(Me){for(var Ke=Ts.lastIndex=0;Ts.test(Me);)++Ke;return Ke}function qd(Me){return Me.match(Ts)||[]}function Kf(Me){return Me.match($c)||[]}var Zf=function Me(Ke){Ke=Ke==null?Rn:tl.defaults(Rn.Object(),Ke,tl.pick(Rn,mo));var Be=Ke.Array,Ut=Ke.Date,Tr=Ke.Error,hn=Ke.Function,rs=Ke.Math,In=Ke.Object,Ml=Ke.RegExp,Xf=Ke.String,mi=Ke.TypeError,Ea=Be.prototype,Vc=hn.prototype,Qi=In.prototype,rl=Ke["__core-js_shared__"],Ol=Vc.toString,pn=Qi.hasOwnProperty,nl=0,Iu=function(){var _=/[^.]+$/.exec(rl&&rl.keys&&rl.keys.IE_PROTO||"");return _?"Symbol(src)_1."+_:""}(),$l=Qi.toString,ku=Ol.call(In),Wd=Rn._,Kd=Ml("^"+Ol.call(pn).replace(Wr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Fl=Ko?Ke.Buffer:r,wa=Ke.Symbol,Ll=Ke.Uint8Array,Bc=Fl?Fl.allocUnsafe:r,Mi=Lc(In.getPrototypeOf,In),Nu=In.create,Du=Qi.propertyIsEnumerable,ju=Ea.splice,Zd=wa?wa.isConcatSpreadable:r,Sa=wa?wa.iterator:r,So=wa?wa.toStringTag:r,Vl=function(){try{var _=so(In,"defineProperty");return _({},"",{}),_}catch{}}(),Xd=Ke.clearTimeout!==Rn.clearTimeout&&Ke.clearTimeout,$n=Ut&&Ut.now!==Rn.Date.now&&Ut.now,Uc=Ke.setTimeout!==Rn.setTimeout&&Ke.setTimeout,Ro=rs.ceil,Ka=rs.floor,Mu=In.getOwnPropertySymbols,Gc=Fl?Fl.isBuffer:r,sl=Ke.isFinite,Ou=Ea.join,il=Lc(In.keys,In),ns=rs.max,Is=rs.min,Yf=Ut.now,Yd=Ke.parseInt,Bl=rs.random,$u=Ea.reverse,Ul=so(Ke,"DataView"),Po=so(Ke,"Map"),Gl=so(Ke,"Promise"),Za=so(Ke,"Set"),zl=so(Ke,"WeakMap"),al=so(In,"create"),Fu=zl&&new zl,ol={},zc=io(Ul),Xa=io(Po),Jd=io(Gl),ll=io(Za),ea=io(zl),Ya=wa?wa.prototype:r,si=Ya?Ya.valueOf:r,Lu=Ya?Ya.toString:r;function xe(_){if(as(_)&&!Or(_)&&!(_ instanceof Mr)){if(_ instanceof ks)return _;if(pn.call(_,"__wrapped__"))return Tf(_)}return new ks(_)}var ul=function(){function _(){}return function(R){if(!Qn(R))return{};if(Nu)return Nu(R);_.prototype=R;var U=new _;return _.prototype=r,U}}();function ta(){}function ks(_,R){this.__wrapped__=_,this.__actions__=[],this.__chain__=!!R,this.__index__=0,this.__values__=r}xe.templateSettings={escape:Nn,evaluate:Hr,interpolate:qr,variable:"",imports:{_:xe}},xe.prototype=ta.prototype,xe.prototype.constructor=xe,ks.prototype=ul(ta.prototype),ks.prototype.constructor=ks;function Mr(_){this.__wrapped__=_,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=oe,this.__views__=[]}function Vu(){var _=new Mr(this.__wrapped__);return _.__actions__=Vs(this.__actions__),_.__dir__=this.__dir__,_.__filtered__=this.__filtered__,_.__iteratees__=Vs(this.__iteratees__),_.__takeCount__=this.__takeCount__,_.__views__=Vs(this.__views__),_}function Hc(){if(this.__filtered__){var _=new Mr(this);_.__dir__=-1,_.__filtered__=!0}else _=this.clone(),_.__dir__*=-1;return _}function cl(){var _=this.__wrapped__.value(),R=this.__dir__,U=Or(_),ie=R<0,ge=U?_.length:0,be=_d(0,ge,this.__views__),Re=be.start,ke=be.end,Oe=ke-Re,Je=ie?ke:Re-1,Qe=this.__iteratees__,pt=Qe.length,Dt=0,ar=Is(Oe,this.__takeCount__);if(!U||!ie&&ge==Oe&&ar==Oe)return vl(_,this.__actions__);var Sr=[];e:for(;Oe--&&Dt<ar;){Je+=R;for(var Ur=-1,Rr=_[Je];++Ur<pt;){var Jr=Qe[Ur],fn=Jr.iteratee,Hi=Jr.type,ui=fn(Rr);if(Hi==me)Rr=ui;else if(!ui){if(Hi==ce)continue e;break e}}Sr[Dt++]=Rr}return Sr}Mr.prototype=ul(ta.prototype),Mr.prototype.constructor=Mr;function Ks(_){var R=-1,U=_==null?0:_.length;for(this.clear();++R<U;){var ie=_[R];this.set(ie[0],ie[1])}}function Fn(){this.__data__=al?al(null):{},this.size=0}function On(_){var R=this.has(_)&&delete this.__data__[_];return this.size-=R?1:0,R}function Ja(_){var R=this.__data__;if(al){var U=R[_];return U===u?r:U}return pn.call(R,_)?R[_]:r}function Ns(_){var R=this.__data__;return al?R[_]!==r:pn.call(R,_)}function Zs(_,R){var U=this.__data__;return this.size+=this.has(_)?0:1,U[_]=al&&R===r?u:R,this}Ks.prototype.clear=Fn,Ks.prototype.delete=On,Ks.prototype.get=Ja,Ks.prototype.has=Ns,Ks.prototype.set=Zs;function Ls(_){var R=-1,U=_==null?0:_.length;for(this.clear();++R<U;){var ie=_[R];this.set(ie[0],ie[1])}}function dl(){this.__data__=[],this.size=0}function Xs(_){var R=this.__data__,U=js(R,_);if(U<0)return!1;var ie=R.length-1;return U==ie?R.pop():ju.call(R,U,1),--this.size,!0}function Bu(_){var R=this.__data__,U=js(R,_);return U<0?r:R[U][1]}function Qd(_){return js(this.__data__,_)>-1}function ef(_,R){var U=this.__data__,ie=js(U,_);return ie<0?(++this.size,U.push([_,R])):U[ie][1]=R,this}Ls.prototype.clear=dl,Ls.prototype.delete=Xs,Ls.prototype.get=Bu,Ls.prototype.has=Qd,Ls.prototype.set=ef;function gi(_){var R=-1,U=_==null?0:_.length;for(this.clear();++R<U;){var ie=_[R];this.set(ie[0],ie[1])}}function tf(){this.size=0,this.__data__={hash:new Ks,map:new(Po||Ls),string:new Ks}}function Ra(_){var R=au(this,_).delete(_);return this.size-=R?1:0,R}function Uu(_){return au(this,_).get(_)}function qc(_){return au(this,_).has(_)}function rf(_,R){var U=au(this,_),ie=U.size;return U.set(_,R),this.size+=U.size==ie?0:1,this}gi.prototype.clear=tf,gi.prototype.delete=Ra,gi.prototype.get=Uu,gi.prototype.has=qc,gi.prototype.set=rf;function To(_){var R=-1,U=_==null?0:_.length;for(this.__data__=new gi;++R<U;)this.add(_[R])}function Qa(_){return this.__data__.set(_,u),this}function fl(_){return this.__data__.has(_)}To.prototype.add=To.prototype.push=Qa,To.prototype.has=fl;function Ds(_){var R=this.__data__=new Ls(_);this.size=R.size}function Gu(){this.__data__=new Ls,this.size=0}function zu(_){var R=this.__data__,U=R.delete(_);return this.size=R.size,U}function yi(_){return this.__data__.get(_)}function vi(_){return this.__data__.has(_)}function Ao(_,R){var U=this.__data__;if(U instanceof Ls){var ie=U.__data__;if(!Po||ie.length<s-1)return ie.push([_,R]),this.size=++U.size,this;U=this.__data__=new gi(ie)}return U.set(_,R),this.size=U.size,this}Ds.prototype.clear=Gu,Ds.prototype.delete=zu,Ds.prototype.get=yi,Ds.prototype.has=vi,Ds.prototype.set=Ao;function ra(_,R){var U=Or(_),ie=!U&&vu(_),ge=!U&&!ie&&Al(_),be=!U&&!ie&&!ge&&jc(_),Re=U||ie||ge||be,ke=Re?vn(_.length,Xf):[],Oe=ke.length;for(var Je in _)(R||pn.call(_,Je))&&!(Re&&(Je=="length"||ge&&(Je=="offset"||Je=="parent")||be&&(Je=="buffer"||Je=="byteLength"||Je=="byteOffset")||zn(Je,Oe)))&&ke.push(Je);return ke}function na(_){var R=_.length;return R?_[gl(0,R-1)]:r}function Co(_,R){return yc(Vs(_),Pa(R,0,_.length))}function nf(_){return yc(Vs(_))}function Hl(_,R,U){(U!==r&&!Oa(_[R],U)||U===r&&!(R in _))&&sa(_,R,U)}function Io(_,R,U){var ie=_[R];(!(pn.call(_,R)&&Oa(ie,U))||U===r&&!(R in _))&&sa(_,R,U)}function js(_,R){for(var U=_.length;U--;)if(Oa(_[U][0],R))return U;return-1}function ii(_,R,U,ie){return aa(_,function(ge,be,Re){R(ie,ge,U(ge),Re)}),ie}function Ln(_,R){return _&&$i(R,$s(R),_)}function Oi(_,R){return _&&$i(R,Ti(R),_)}function sa(_,R,U){R=="__proto__"&&Vl?Vl(_,R,{configurable:!0,enumerable:!0,value:U,writable:!0}):_[R]=U}function Hu(_,R){for(var U=-1,ie=R.length,ge=Be(ie),be=_==null;++U<ie;)ge[U]=be?r:Eh(_,R[U]);return ge}function Pa(_,R,U){return _===_&&(U!==r&&(_=_<=U?_:U),R!==r&&(_=_>=R?_:R)),_}function Ys(_,R,U,ie,ge,be){var Re,ke=R&p,Oe=R&m,Je=R&y;if(U&&(Re=ge?U(_,ie,ge,be):U(_)),Re!==r)return Re;if(!Qn(_))return _;var Qe=Or(_);if(Qe){if(Re=lu(_),!ke)return Vs(_,Re)}else{var pt=Ss(_),Dt=pt==Et||pt==Ze;if(Al(_))return ld(_,ke);if(pt==Lt||pt==je||Dt&&!ge){if(Re=Oe||Dt?{}:Rs(_),!ke)return Oe?Qf(_,Oi(Re,_)):sc(_,Ln(Re,_))}else{if(!Zr[pt])return ge?_:{};Re=eh(_,pt,ke)}}be||(be=new Ds);var ar=be.get(_);if(ar)return ar;be.set(_,Re),jh(_)?_.forEach(function(Rr){Re.add(Ys(Rr,R,U,Rr,_,be))}):Nh(_)&&_.forEach(function(Rr,Jr){Re.set(Jr,Ys(Rr,R,U,Jr,_,be))});var Sr=Je?Oe?iu:su:Oe?Ti:$s,Ur=Qe?r:Sr(_);return us(Ur||_,function(Rr,Jr){Ur&&(Jr=Rr,Rr=_[Jr]),Io(Re,Jr,Ys(Rr,R,U,Jr,_,be))}),Re}function sf(_){var R=$s(_);return function(U){return ql(U,_,R)}}function ql(_,R,U){var ie=U.length;if(_==null)return!ie;for(_=In(_);ie--;){var ge=U[ie],be=R[ge],Re=_[ge];if(Re===r&&!(ge in _)||!be(Re))return!1}return!0}function Wc(_,R,U){if(typeof _!="function")throw new mi(o);return Rl(function(){_.apply(r,U)},R)}function ia(_,R,U,ie){var ge=-1,be=bo,Re=!0,ke=_.length,Oe=[],Je=R.length;if(!ke)return Oe;U&&(R=Pn(R,bn(U))),ie?(be=Ha,Re=!1):R.length>=s&&(be=Cs,Re=!1,R=new To(R));e:for(;++ge<ke;){var Qe=_[ge],pt=U==null?Qe:U(Qe);if(Qe=ie||Qe!==0?Qe:0,Re&&pt===pt){for(var Dt=Je;Dt--;)if(R[Dt]===pt)continue e;Oe.push(Qe)}else be(R,pt,ie)||Oe.push(Qe)}return Oe}var aa=wi(ai),af=wi(eo,!0);function Wl(_,R){var U=!0;return aa(_,function(ie,ge,be){return U=!!R(ie,ge,be),U}),U}function ko(_,R,U){for(var ie=-1,ge=_.length;++ie<ge;){var be=_[ie],Re=R(be);if(Re!=null&&(ke===r?Re===Re&&!zi(Re):U(Re,ke)))var ke=Re,Oe=be}return Oe}function of(_,R,U,ie){var ge=_.length;for(U=Br(U),U<0&&(U=-U>ge?0:ge+U),ie=ie===r||ie>ge?ge:Br(ie),ie<0&&(ie+=ge),ie=U>ie?0:Oh(ie);U<ie;)_[U++]=R;return _}function Kc(_,R){var U=[];return aa(_,function(ie,ge,be){R(ie,ge,be)&&U.push(ie)}),U}function Zn(_,R,U,ie,ge){var be=-1,Re=_.length;for(U||(U=pc),ge||(ge=[]);++be<Re;){var ke=_[be];R>0&&U(ke)?R>1?Zn(ke,R-1,U,ie,ge):Di(ge,ke):ie||(ge[ge.length]=ke)}return ge}var qu=ac(),Kl=ac(!0);function ai(_,R){return _&&qu(_,R,$s)}function eo(_,R){return _&&Kl(_,R,$s)}function hl(_,R){return hi(R,function(U){return zo(_[U])})}function Ta(_,R){R=ua(R,_);for(var U=0,ie=R.length;_!=null&&U<ie;)_=_[Bi(R[U++])];return U&&U==ie?_:r}function Wu(_,R,U){var ie=R(_);return Or(_)?ie:Di(ie,U(_))}function Es(_){return _==null?_===r?Pr:or:So&&So in In(_)?hc(_):Ed(_)}function to(_,R){return _>R}function xi(_,R){return _!=null&&pn.call(_,R)}function No(_,R){return _!=null&&R in In(_)}function Zc(_,R,U){return _>=Is(R,U)&&_<ns(R,U)}function Ku(_,R,U){for(var ie=U?Ha:bo,ge=_[0].length,be=_.length,Re=be,ke=Be(be),Oe=1/0,Je=[];Re--;){var Qe=_[Re];Re&&R&&(Qe=Pn(Qe,bn(R))),Oe=Is(Qe.length,Oe),ke[Re]=!U&&(R||ge>=120&&Qe.length>=120)?new To(Re&&Qe):r}Qe=_[0];var pt=-1,Dt=ke[0];e:for(;++pt<ge&&Je.length<Oe;){var ar=Qe[pt],Sr=R?R(ar):ar;if(ar=U||ar!==0?ar:0,!(Dt?Cs(Dt,Sr):ie(Je,Sr,U))){for(Re=be;--Re;){var Ur=ke[Re];if(!(Ur?Cs(Ur,Sr):ie(_[Re],Sr,U)))continue e}Dt&&Dt.push(Sr),Je.push(ar)}}return Je}function Aa(_,R,U,ie){return ai(_,function(ge,be,Re){R(ie,U(ge),be,Re)}),ie}function _i(_,R,U){R=ua(R,_),_=ys(_,R);var ie=_==null?_:_[Bi(Gs(R))];return ie==null?r:gs(ie,_,U)}function Zu(_){return as(_)&&Es(_)==je}function lf(_){return as(_)&&Es(_)==dr}function Ca(_){return as(_)&&Es(_)==Ce}function bi(_,R,U,ie,ge){return _===R?!0:_==null||R==null||!as(_)&&!as(R)?_!==_&&R!==R:Xu(_,R,U,ie,bi,ge)}function Xu(_,R,U,ie,ge,be){var Re=Or(_),ke=Or(R),Oe=Re?Te:Ss(_),Je=ke?Te:Ss(R);Oe=Oe==je?Lt:Oe,Je=Je==je?Lt:Je;var Qe=Oe==Lt,pt=Je==Lt,Dt=Oe==Je;if(Dt&&Al(_)){if(!Al(R))return!1;Re=!0,Qe=!1}if(Dt&&!Qe)return be||(be=new Ds),Re||jc(_)?vd(_,R,U,ie,ge,be):xd(_,R,Oe,U,ie,ge,be);if(!(U&b)){var ar=Qe&&pn.call(_,"__wrapped__"),Sr=pt&&pn.call(R,"__wrapped__");if(ar||Sr){var Ur=ar?_.value():_,Rr=Sr?R.value():R;return be||(be=new Ds),ge(Ur,Rr,U,ie,be)}}return Dt?(be||(be=new Ds),xf(_,R,U,ie,ge,be)):!1}function uf(_){return as(_)&&Ss(_)==Ue}function pl(_,R,U,ie){var ge=U.length,be=ge,Re=!ie;if(_==null)return!be;for(_=In(_);ge--;){var ke=U[ge];if(Re&&ke[2]?ke[1]!==_[ke[0]]:!(ke[0]in _))return!1}for(;++ge<be;){ke=U[ge];var Oe=ke[0],Je=_[Oe],Qe=ke[1];if(Re&&ke[2]){if(Je===r&&!(Oe in _))return!1}else{var pt=new Ds;if(ie)var Dt=ie(Je,Qe,Oe,_,R,pt);if(!(Dt===r?bi(Qe,Je,b|E,ie,pt):Dt))return!1}}return!0}function Xc(_){if(!Qn(_)||Ef(_))return!1;var R=zo(_)?Kd:ci;return R.test(io(_))}function Zl(_){return as(_)&&Es(_)==ir}function oa(_){return as(_)&&Ss(_)==er}function Xl(_){return as(_)&&Bf(_.length)&&!!Xr[Es(_)]}function ml(_){return typeof _=="function"?_:_==null?Ai:typeof _=="object"?Or(_)?Gn(_[0],_[1]):Yu(_):Wh(_)}function Ia(_){if(!ja(_))return il(_);var R=[];for(var U in In(_))pn.call(_,U)&&U!="constructor"&&R.push(U);return R}function Yc(_){if(!Qn(_))return Rf(_);var R=ja(_),U=[];for(var ie in _)ie=="constructor"&&(R||!pn.call(_,ie))||U.push(ie);return U}function ro(_,R){return _<R}function Jc(_,R){var U=-1,ie=Pi(_)?Be(_.length):[];return aa(_,function(ge,be,Re){ie[++U]=R(ge,be,Re)}),ie}function Yu(_){var R=ou(_);return R.length==1&&R[0][2]?mc(R[0][0],R[0][1]):function(U){return U===_||pl(U,_,R)}}function Gn(_,R){return Kt(_)&&cu(R)?mc(Bi(_),R):function(U){var ie=Eh(U,_);return ie===r&&ie===R?wh(U,_):bi(R,ie,b|E)}}function Do(_,R,U,ie,ge){_!==R&&qu(R,function(be,Re){if(ge||(ge=new Ds),Qn(be))Qc(_,R,Re,U,Do,ie,ge);else{var ke=ie?ie(fa(_,Re),be,Re+"",_,R,ge):r;ke===r&&(ke=be),Hl(_,Re,ke)}},Ti)}function Qc(_,R,U,ie,ge,be,Re){var ke=fa(_,U),Oe=fa(R,U),Je=Re.get(Oe);if(Je){Hl(_,U,Je);return}var Qe=be?be(ke,Oe,U+"",_,R,Re):r,pt=Qe===r;if(pt){var Dt=Or(Oe),ar=!Dt&&Al(Oe),Sr=!Dt&&!ar&&jc(Oe);Qe=Oe,Dt||ar||Sr?Or(ke)?Qe=ke:hs(ke)?Qe=Vs(ke):ar?(pt=!1,Qe=ld(Oe,!0)):Sr?(pt=!1,Qe=pf(Oe,!0)):Qe=[]:Vd(Oe)||vu(Oe)?(Qe=ke,vu(ke)?Qe=$h(ke):(!Qn(ke)||zo(ke))&&(Qe=Rs(Oe))):pt=!1}pt&&(Re.set(Oe,Qe),ge(Qe,Oe,ie,be,Re),Re.delete(Oe)),Hl(_,U,Qe)}function Ju(_,R){var U=_.length;if(U)return R+=R<0?U:0,zn(R,U)?_[R]:r}function Yl(_,R,U){R.length?R=Pn(R,function(be){return Or(be)?function(Re){return Ta(Re,be.length===1?be[0]:be)}:be}):R=[Ai];var ie=-1;R=Pn(R,bn(gr()));var ge=Jc(_,function(be,Re,ke){var Oe=Pn(R,function(Je){return Je(be)});return{criteria:Oe,index:++ie,value:be}});return He(ge,function(be,Re){return Jf(be,Re,U)})}function ed(_,R){return no(_,R,function(U,ie){return wh(_,ie)})}function no(_,R,U){for(var ie=-1,ge=R.length,be={};++ie<ge;){var Re=R[ie],ke=Ta(_,Re);U(ke,Re)&&Mo(be,ua(Re,_),ke)}return be}function qn(_){return function(R){return Ta(R,_)}}function Yn(_,R,U,ie){var ge=ie?Ji:ba,be=-1,Re=R.length,ke=_;for(_===R&&(R=Vs(R)),U&&(ke=Pn(_,bn(U)));++be<Re;)for(var Oe=0,Je=R[be],Qe=U?U(Je):Je;(Oe=ge(ke,Qe,Oe,ie))>-1;)ke!==_&&ju.call(ke,Oe,1),ju.call(_,Oe,1);return _}function ds(_,R){for(var U=_?R.length:0,ie=U-1;U--;){var ge=R[U];if(U==ie||ge!==be){var be=ge;zn(ge)?ju.call(_,ge,1):tc(_,ge)}}return _}function gl(_,R){return _+Ka(Bl()*(R-_+1))}function Jl(_,R,U,ie){for(var ge=-1,be=ns(Ro((R-_)/(U||1)),0),Re=Be(be);be--;)Re[ie?be:++ge]=_,_+=U;return Re}function jo(_,R){var U="";if(!_||R<1||R>Z)return U;do R%2&&(U+=_),R=Ka(R/2),R&&(_+=_);while(R);return U}function Vr(_,R){return oi(gc(_,R,Ai),_+"")}function Ms(_){return na(Mc(_))}function td(_,R){var U=Mc(_);return yc(U,Pa(R,0,U.length))}function Mo(_,R,U,ie){if(!Qn(_))return _;R=ua(R,_);for(var ge=-1,be=R.length,Re=be-1,ke=_;ke!=null&&++ge<be;){var Oe=Bi(R[ge]),Je=U;if(Oe==="__proto__"||Oe==="constructor"||Oe==="prototype")return _;if(ge!=Re){var Qe=ke[Oe];Je=ie?ie(Qe,Oe,ke):r,Je===r&&(Je=Qn(Qe)?Qe:zn(R[ge+1])?[]:{})}Io(ke,Oe,Je),ke=ke[Oe]}return _}var Qu=Fu?function(_,R){return Fu.set(_,R),_}:Ai,la=Vl?function(_,R){return Vl(_,"toString",{configurable:!0,enumerable:!1,value:Rh(R),writable:!0})}:Ai;function Ei(_){return yc(Mc(_))}function Os(_,R,U){var ie=-1,ge=_.length;R<0&&(R=-R>ge?0:ge+R),U=U>ge?ge:U,U<0&&(U+=ge),ge=R>U?0:U-R>>>0,R>>>=0;for(var be=Be(ge);++ie<ge;)be[ie]=_[ie+R];return be}function rd(_,R){var U;return aa(_,function(ie,ge,be){return U=R(ie,ge,be),!U}),!!U}function yl(_,R,U){var ie=0,ge=_==null?ie:_.length;if(typeof R=="number"&&R===R&&ge<=Ee){for(;ie<ge;){var be=ie+ge>>>1,Re=_[be];Re!==null&&!zi(Re)&&(U?Re<=R:Re<R)?ie=be+1:ge=be}return ge}return ec(_,R,Ai,U)}function ec(_,R,U,ie){var ge=0,be=_==null?0:_.length;if(be===0)return 0;R=U(R);for(var Re=R!==R,ke=R===null,Oe=zi(R),Je=R===r;ge<be;){var Qe=Ka((ge+be)/2),pt=U(_[Qe]),Dt=pt!==r,ar=pt===null,Sr=pt===pt,Ur=zi(pt);if(Re)var Rr=ie||Sr;else Je?Rr=Sr&&(ie||Dt):ke?Rr=Sr&&Dt&&(ie||!ar):Oe?Rr=Sr&&Dt&&!ar&&(ie||!Ur):ar||Ur?Rr=!1:Rr=ie?pt<=R:pt<R;Rr?ge=Qe+1:be=Qe}return Is(be,ye)}function nd(_,R){for(var U=-1,ie=_.length,ge=0,be=[];++U<ie;){var Re=_[U],ke=R?R(Re):Re;if(!U||!Oa(ke,Oe)){var Oe=ke;be[ge++]=Re===0?0:Re}}return be}function sd(_){return typeof _=="number"?_:zi(_)?he:+_}function Js(_){if(typeof _=="string")return _;if(Or(_))return Pn(_,Js)+"";if(zi(_))return Lu?Lu.call(_):"";var R=_+"";return R=="0"&&1/_==-1/0?"-0":R}function ka(_,R,U){var ie=-1,ge=bo,be=_.length,Re=!0,ke=[],Oe=ke;if(U)Re=!1,ge=Ha;else if(be>=s){var Je=R?null:vf(_);if(Je)return Wa(Je);Re=!1,ge=Cs,Oe=new To}else Oe=R?[]:ke;e:for(;++ie<be;){var Qe=_[ie],pt=R?R(Qe):Qe;if(Qe=U||Qe!==0?Qe:0,Re&&pt===pt){for(var Dt=Oe.length;Dt--;)if(Oe[Dt]===pt)continue e;R&&Oe.push(pt),ke.push(Qe)}else ge(Oe,pt,U)||(Oe!==ke&&Oe.push(pt),ke.push(Qe))}return ke}function tc(_,R){return R=ua(R,_),_=ys(_,R),_==null||delete _[Bi(Gs(R))]}function ad(_,R,U,ie){return Mo(_,R,U(Ta(_,R)),ie)}function Ql(_,R,U,ie){for(var ge=_.length,be=ie?ge:-1;(ie?be--:++be<ge)&&R(_[be],be,_););return U?Os(_,ie?0:be,ie?be+1:ge):Os(_,ie?be+1:0,ie?ge:be)}function vl(_,R){var U=_;return U instanceof Mr&&(U=U.value()),ji(R,function(ie,ge){return ge.func.apply(ge.thisArg,Di([ie],ge.args))},U)}function rc(_,R,U){var ie=_.length;if(ie<2)return ie?ka(_[0]):[];for(var ge=-1,be=Be(ie);++ge<ie;)for(var Re=_[ge],ke=-1;++ke<ie;)ke!=ge&&(be[ge]=ia(be[ge]||Re,_[ke],R,U));return ka(Zn(be,1),R,U)}function eu(_,R,U){for(var ie=-1,ge=_.length,be=R.length,Re={};++ie<ge;){var ke=ie<be?R[ie]:r;U(Re,_[ie],ke)}return Re}function xl(_){return hs(_)?_:[]}function nc(_){return typeof _=="function"?_:Ai}function ua(_,R){return Or(_)?_:Kt(_,R)?[_]:Rd(kn(_))}var cf=Vr;function Na(_,R,U){var ie=_.length;return U=U===r?ie:U,!R&&U>=ie?_:Os(_,R,U)}var od=Xd||function(_){return Rn.clearTimeout(_)};function ld(_,R){if(R)return _.slice();var U=_.length,ie=Bc?Bc(U):new _.constructor(U);return _.copy(ie),ie}function tu(_){var R=new _.constructor(_.byteLength);return new Ll(R).set(new Ll(_)),R}function df(_,R){var U=R?tu(_.buffer):_.buffer;return new _.constructor(U,_.byteOffset,_.byteLength)}function ff(_){var R=new _.constructor(_.source,Mn.exec(_));return R.lastIndex=_.lastIndex,R}function hf(_){return si?In(si.call(_)):{}}function pf(_,R){var U=R?tu(_.buffer):_.buffer;return new _.constructor(U,_.byteOffset,_.length)}function ud(_,R){if(_!==R){var U=_!==r,ie=_===null,ge=_===_,be=zi(_),Re=R!==r,ke=R===null,Oe=R===R,Je=zi(R);if(!ke&&!Je&&!be&&_>R||be&&Re&&Oe&&!ke&&!Je||ie&&Re&&Oe||!U&&Oe||!ge)return 1;if(!ie&&!be&&!Je&&_<R||Je&&U&&ge&&!ie&&!be||ke&&U&&ge||!Re&&ge||!Oe)return-1}return 0}function Jf(_,R,U){for(var ie=-1,ge=_.criteria,be=R.criteria,Re=ge.length,ke=U.length;++ie<Re;){var Oe=ud(ge[ie],be[ie]);if(Oe){if(ie>=ke)return Oe;var Je=U[ie];return Oe*(Je=="desc"?-1:1)}}return _.index-R.index}function mf(_,R,U,ie){for(var ge=-1,be=_.length,Re=U.length,ke=-1,Oe=R.length,Je=ns(be-Re,0),Qe=Be(Oe+Je),pt=!ie;++ke<Oe;)Qe[ke]=R[ke];for(;++ge<Re;)(pt||ge<be)&&(Qe[U[ge]]=_[ge]);for(;Je--;)Qe[ke++]=_[ge++];return Qe}function cd(_,R,U,ie){for(var ge=-1,be=_.length,Re=-1,ke=U.length,Oe=-1,Je=R.length,Qe=ns(be-ke,0),pt=Be(Qe+Je),Dt=!ie;++ge<Qe;)pt[ge]=_[ge];for(var ar=ge;++Oe<Je;)pt[ar+Oe]=R[Oe];for(;++Re<ke;)(Dt||ge<be)&&(pt[ar+U[Re]]=_[ge++]);return pt}function Vs(_,R){var U=-1,ie=_.length;for(R||(R=Be(ie));++U<ie;)R[U]=_[U];return R}function $i(_,R,U,ie){var ge=!U;U||(U={});for(var be=-1,Re=R.length;++be<Re;){var ke=R[be],Oe=ie?ie(U[ke],_[ke],ke,U,_):r;Oe===r&&(Oe=_[ke]),ge?sa(U,ke,Oe):Io(U,ke,Oe)}return U}function sc(_,R){return $i(_,Fi(_),R)}function Qf(_,R){return $i(_,_f(_),R)}function ic(_,R){return function(U,ie){var ge=Or(U)?xa:ii,be=R?R():{};return ge(U,_,gr(ie,2),be)}}function _l(_){return Vr(function(R,U){var ie=-1,ge=U.length,be=ge>1?U[ge-1]:r,Re=ge>2?U[2]:r;for(be=_.length>3&&typeof be=="function"?(ge--,be):r,Re&&Us(U[0],U[1],Re)&&(be=ge<3?r:be,ge=1),R=In(R);++ie<ge;){var ke=U[ie];ke&&_(R,ke,ie,be)}return R})}function wi(_,R){return function(U,ie){if(U==null)return U;if(!Pi(U))return _(U,ie);for(var ge=U.length,be=R?ge:-1,Re=In(U);(R?be--:++be<ge)&&ie(Re[be],be,Re)!==!1;);return U}}function ac(_){return function(R,U,ie){for(var ge=-1,be=In(R),Re=ie(R),ke=Re.length;ke--;){var Oe=Re[_?ke:++ge];if(U(be[Oe],Oe,be)===!1)break}return R}}function oc(_,R,U){var ie=R&T,ge=bl(_);function be(){var Re=this&&this!==Rn&&this instanceof be?ge:_;return Re.apply(ie?U:this,arguments)}return be}function dd(_){return function(R){R=kn(R);var U=el(R)?ni(R):r,ie=U?U[0]:R.charAt(0),ge=U?Na(U,1).join(""):R.slice(1);return ie[_]()+ge}}function Oo(_){return function(R){return ji(Hh(zh(R).replace(Oc,"")),_,"")}}function bl(_){return function(){var R=arguments;switch(R.length){case 0:return new _;case 1:return new _(R[0]);case 2:return new _(R[0],R[1]);case 3:return new _(R[0],R[1],R[2]);case 4:return new _(R[0],R[1],R[2],R[3]);case 5:return new _(R[0],R[1],R[2],R[3],R[4]);case 6:return new _(R[0],R[1],R[2],R[3],R[4],R[5]);case 7:return new _(R[0],R[1],R[2],R[3],R[4],R[5],R[6])}var U=ul(_.prototype),ie=_.apply(U,R);return Qn(ie)?ie:U}}function fd(_,R,U){var ie=bl(_);function ge(){for(var be=arguments.length,Re=Be(be),ke=be,Oe=Da(ge);ke--;)Re[ke]=arguments[ke];var Je=be<3&&Re[0]!==Oe&&Re[be-1]!==Oe?[]:pi(Re,Oe);if(be-=Je.length,be<U)return Bs(_,R,El,ge.placeholder,r,Re,Je,r,r,U-be);var Qe=this&&this!==Rn&&this instanceof ge?ie:_;return gs(Qe,this,Re)}return ge}function $o(_){return function(R,U,ie){var ge=In(R);if(!Pi(R)){var be=gr(U,3);R=$s(R),U=function(ke){return be(ge[ke],ke,ge)}}var Re=_(R,U,ie);return Re>-1?ge[be?R[Re]:Re]:r}}function lc(_){return da(function(R){var U=R.length,ie=U,ge=ks.prototype.thru;for(_&&R.reverse();ie--;){var be=R[ie];if(typeof be!="function")throw new mi(o);if(ge&&!Re&&wl(be)=="wrapper")var Re=new ks([],!0)}for(ie=Re?ie:U;++ie<U;){be=R[ie];var ke=wl(be),Oe=ke=="wrapper"?fc(be):r;Oe&&uu(Oe[0])&&Oe[1]==(W|A|j|H)&&!Oe[4].length&&Oe[9]==1?Re=Re[wl(Oe[0])].apply(Re,Oe[3]):Re=be.length==1&&uu(be)?Re[ke]():Re.thru(be)}return function(){var Je=arguments,Qe=Je[0];if(Re&&Je.length==1&&Or(Qe))return Re.plant(Qe).value();for(var pt=0,Dt=U?R[pt].apply(this,Je):Qe;++pt<U;)Dt=R[pt].call(this,Dt);return Dt}})}function El(_,R,U,ie,ge,be,Re,ke,Oe,Je){var Qe=R&W,pt=R&T,Dt=R&S,ar=R&(A|I),Sr=R&ee,Ur=Dt?r:bl(_);function Rr(){for(var Jr=arguments.length,fn=Be(Jr),Hi=Jr;Hi--;)fn[Hi]=arguments[Hi];if(ar)var ui=Da(Rr),qi=Jo(fn,ui);if(ie&&(fn=mf(fn,ie,ge,ar)),be&&(fn=cd(fn,be,Re,ar)),Jr-=qi,ar&&Jr<Je){var ps=pi(fn,ui);return Bs(_,R,El,Rr.placeholder,U,fn,ps,ke,Oe,Je-Jr)}var $a=pt?U:this,qo=Dt?$a[_]:_;return Jr=fn.length,ke?fn=Li(fn,ke):Sr&&Jr>1&&fn.reverse(),Qe&&Oe<Jr&&(fn.length=Oe),this&&this!==Rn&&this instanceof Rr&&(qo=Ur||bl(qo)),qo.apply($a,fn)}return Rr}function gf(_,R){return function(U,ie){return Aa(U,_,R(ie),{})}}function ru(_,R){return function(U,ie){var ge;if(U===r&&ie===r)return R;if(U!==r&&(ge=U),ie!==r){if(ge===r)return ie;typeof U=="string"||typeof ie=="string"?(U=Js(U),ie=Js(ie)):(U=sd(U),ie=sd(ie)),ge=_(U,ie)}return ge}}function uc(_){return da(function(R){return R=Pn(R,bn(gr())),Vr(function(U){var ie=this;return _(R,function(ge){return gs(ge,ie,U)})})})}function nu(_,R){R=R===r?" ":Js(R);var U=R.length;if(U<2)return U?jo(R,_):R;var ie=jo(R,Ro(_/wo(R)));return el(R)?Na(ni(ie),0,_).join(""):ie.slice(0,_)}function yf(_,R,U,ie){var ge=R&T,be=bl(_);function Re(){for(var ke=-1,Oe=arguments.length,Je=-1,Qe=ie.length,pt=Be(Qe+Oe),Dt=this&&this!==Rn&&this instanceof Re?be:_;++Je<Qe;)pt[Je]=ie[Je];for(;Oe--;)pt[Je++]=arguments[++ke];return gs(Dt,ge?U:this,pt)}return Re}function hd(_){return function(R,U,ie){return ie&&typeof ie!="number"&&Us(R,U,ie)&&(U=ie=r),R=Ho(R),U===r?(U=R,R=0):U=Ho(U),ie=ie===r?R<U?1:-1:Ho(ie),Jl(R,U,ie,_)}}function dc(_){return function(R,U){return typeof R=="string"&&typeof U=="string"||(R=ha(R),U=ha(U)),_(R,U)}}function Bs(_,R,U,ie,ge,be,Re,ke,Oe,Je){var Qe=R&A,pt=Qe?Re:r,Dt=Qe?r:Re,ar=Qe?be:r,Sr=Qe?r:be;R|=Qe?j:K,R&=~(Qe?K:j),R&P||(R&=-4);var Ur=[_,R,ge,ar,pt,Sr,Dt,ke,Oe,Je],Rr=U.apply(r,Ur);return uu(_)&&wd(Rr,Ur),Rr.placeholder=ie,Sd(Rr,_,R)}function ws(_){var R=rs[_];return function(U,ie){if(U=ha(U),ie=ie==null?0:Is(Br(ie),292),ie&&sl(U)){var ge=(kn(U)+"e").split("e"),be=R(ge[0]+"e"+(+ge[1]+ie));return ge=(kn(be)+"e").split("e"),+(ge[0]+"e"+(+ge[1]-ie))}return R(U)}}var vf=Za&&1/Wa(new Za([,-0]))[1]==le?function(_){return new Za(_)}:Ah;function pd(_){return function(R){var U=Ss(R);return U==Ue?Tu(R):U==er?qf(R):cs(R,_(R))}}function ca(_,R,U,ie,ge,be,Re,ke){var Oe=R&S;if(!Oe&&typeof _!="function")throw new mi(o);var Je=ie?ie.length:0;if(Je||(R&=-97,ie=ge=r),Re=Re===r?Re:ns(Br(Re),0),ke=ke===r?ke:Br(ke),Je-=ge?ge.length:0,R&K){var Qe=ie,pt=ge;ie=ge=r}var Dt=Oe?r:fc(_),ar=[_,R,U,ie,ge,Qe,pt,be,Re,ke];if(Dt&&Sf(ar,Dt),_=ar[0],R=ar[1],U=ar[2],ie=ar[3],ge=ar[4],ke=ar[9]=ar[9]===r?Oe?0:_.length:ns(ar[9]-Je,0),!ke&&R&(A|I)&&(R&=-25),!R||R==T)var Sr=oc(_,R,U);else R==A||R==I?Sr=fd(_,R,ke):(R==j||R==(T|j))&&!ge.length?Sr=yf(_,R,U,ie):Sr=El.apply(r,ar);var Ur=Dt?Qu:wd;return Sd(Ur(Sr,ar),_,R)}function md(_,R,U,ie){return _===r||Oa(_,Qi[U])&&!pn.call(ie,U)?R:_}function gd(_,R,U,ie,ge,be){return Qn(_)&&Qn(R)&&(be.set(R,_),Do(_,R,r,gd,be),be.delete(R)),_}function yd(_){return Vd(_)?r:_}function vd(_,R,U,ie,ge,be){var Re=U&b,ke=_.length,Oe=R.length;if(ke!=Oe&&!(Re&&Oe>ke))return!1;var Je=be.get(_),Qe=be.get(R);if(Je&&Qe)return Je==R&&Qe==_;var pt=-1,Dt=!0,ar=U&E?new To:r;for(be.set(_,R),be.set(R,_);++pt<ke;){var Sr=_[pt],Ur=R[pt];if(ie)var Rr=Re?ie(Ur,Sr,pt,R,_,be):ie(Sr,Ur,pt,_,R,be);if(Rr!==r){if(Rr)continue;Dt=!1;break}if(ar){if(!Xo(R,function(Jr,fn){if(!Cs(ar,fn)&&(Sr===Jr||ge(Sr,Jr,U,ie,be)))return ar.push(fn)})){Dt=!1;break}}else if(!(Sr===Ur||ge(Sr,Ur,U,ie,be))){Dt=!1;break}}return be.delete(_),be.delete(R),Dt}function xd(_,R,U,ie,ge,be,Re){switch(U){case Ar:if(_.byteLength!=R.byteLength||_.byteOffset!=R.byteOffset)return!1;_=_.buffer,R=R.buffer;case dr:return!(_.byteLength!=R.byteLength||!be(new Ll(_),new Ll(R)));case Pe:case Ce:case qt:return Oa(+_,+R);case ze:return _.name==R.name&&_.message==R.message;case ir:case xr:return _==R+"";case Ue:var ke=Tu;case er:var Oe=ie&b;if(ke||(ke=Wa),_.size!=R.size&&!Oe)return!1;var Je=Re.get(_);if(Je)return Je==R;ie|=E,Re.set(_,R);var Qe=vd(ke(_),ke(R),ie,ge,be,Re);return Re.delete(_),Qe;case br:if(si)return si.call(_)==si.call(R)}return!1}function xf(_,R,U,ie,ge,be){var Re=U&b,ke=su(_),Oe=ke.length,Je=su(R),Qe=Je.length;if(Oe!=Qe&&!Re)return!1;for(var pt=Oe;pt--;){var Dt=ke[pt];if(!(Re?Dt in R:pn.call(R,Dt)))return!1}var ar=be.get(_),Sr=be.get(R);if(ar&&Sr)return ar==R&&Sr==_;var Ur=!0;be.set(_,R),be.set(R,_);for(var Rr=Re;++pt<Oe;){Dt=ke[pt];var Jr=_[Dt],fn=R[Dt];if(ie)var Hi=Re?ie(fn,Jr,Dt,R,_,be):ie(Jr,fn,Dt,_,R,be);if(!(Hi===r?Jr===fn||ge(Jr,fn,U,ie,be):Hi)){Ur=!1;break}Rr||(Rr=Dt=="constructor")}if(Ur&&!Rr){var ui=_.constructor,qi=R.constructor;ui!=qi&&"constructor"in _&&"constructor"in R&&!(typeof ui=="function"&&ui instanceof ui&&typeof qi=="function"&&qi instanceof qi)&&(Ur=!1)}return be.delete(_),be.delete(R),Ur}function da(_){return oi(gc(_,r,xc),_+"")}function su(_){return Wu(_,$s,Fi)}function iu(_){return Wu(_,Ti,_f)}var fc=Fu?function(_){return Fu.get(_)}:Ah;function wl(_){for(var R=_.name+"",U=ol[R],ie=pn.call(ol,R)?U.length:0;ie--;){var ge=U[ie],be=ge.func;if(be==null||be==_)return ge.name}return R}function Da(_){var R=pn.call(xe,"placeholder")?xe:_;return R.placeholder}function gr(){var _=xe.iteratee||Ph;return _=_===Ph?ml:_,arguments.length?_(arguments[0],arguments[1]):_}function au(_,R){var U=_.__data__;return Sl(R)?U[typeof R=="string"?"string":"hash"]:U.map}function ou(_){for(var R=$s(_),U=R.length;U--;){var ie=R[U],ge=_[ie];R[U]=[ie,ge,cu(ge)]}return R}function so(_,R){var U=Qo(_,R);return Xc(U)?U:r}function hc(_){var R=pn.call(_,So),U=_[So];try{_[So]=r;var ie=!0}catch{}var ge=$l.call(_);return ie&&(R?_[So]=U:delete _[So]),ge}var Fi=Mu?function(_){return _==null?[]:(_=In(_),hi(Mu(_),function(R){return Du.call(_,R)}))}:Ch,_f=Mu?function(_){for(var R=[];_;)Di(R,Fi(_)),_=Mi(_);return R}:Ch,Ss=Es;(Ul&&Ss(new Ul(new ArrayBuffer(1)))!=Ar||Po&&Ss(new Po)!=Ue||Gl&&Ss(Gl.resolve())!=rt||Za&&Ss(new Za)!=er||zl&&Ss(new zl)!=zr)&&(Ss=function(_){var R=Es(_),U=R==Lt?_.constructor:r,ie=U?io(U):"";if(ie)switch(ie){case zc:return Ar;case Xa:return Ue;case Jd:return rt;case ll:return er;case ea:return zr}return R});function _d(_,R,U){for(var ie=-1,ge=U.length;++ie<ge;){var be=U[ie],Re=be.size;switch(be.type){case"drop":_+=Re;break;case"dropRight":R-=Re;break;case"take":R=Is(R,_+Re);break;case"takeRight":_=ns(_,R-Re);break}}return{start:_,end:R}}function bf(_){var R=_.match(Lr);return R?R[1].split(_s):[]}function bd(_,R,U){R=ua(R,_);for(var ie=-1,ge=R.length,be=!1;++ie<ge;){var Re=Bi(R[ie]);if(!(be=_!=null&&U(_,Re)))break;_=_[Re]}return be||++ie!=ge?be:(ge=_==null?0:_.length,!!ge&&Bf(ge)&&zn(Re,ge)&&(Or(_)||vu(_)))}function lu(_){var R=_.length,U=new _.constructor(R);return R&&typeof _[0]=="string"&&pn.call(_,"index")&&(U.index=_.index,U.input=_.input),U}function Rs(_){return typeof _.constructor=="function"&&!ja(_)?ul(Mi(_)):{}}function eh(_,R,U){var ie=_.constructor;switch(R){case dr:return tu(_);case Pe:case Ce:return new ie(+_);case Ar:return df(_,U);case _r:case It:case Bt:case ur:case Vn:case gn:case yn:case Dr:case Nr:return pf(_,U);case Ue:return new ie;case qt:case xr:return new ie(_);case ir:return ff(_);case er:return new ie;case br:return hf(_)}}function th(_,R){var U=R.length;if(!U)return _;var ie=U-1;return R[ie]=(U>1?"& ":"")+R[ie],R=R.join(U>2?", ":" "),_.replace(xn,`{
/* [wrapped with `+R+`] */
`)}function pc(_){return Or(_)||vu(_)||!!(Zd&&_&&_[Zd])}function zn(_,R){var U=typeof _;return R=R??Z,!!R&&(U=="number"||U!="symbol"&&Se.test(_))&&_>-1&&_%1==0&&_<R}function Us(_,R,U){if(!Qn(U))return!1;var ie=typeof R;return(ie=="number"?Pi(U)&&zn(R,U.length):ie=="string"&&R in U)?Oa(U[R],_):!1}function Kt(_,R){if(Or(_))return!1;var U=typeof _;return U=="number"||U=="symbol"||U=="boolean"||_==null||zi(_)?!0:Dn.test(_)||!Fr.test(_)||R!=null&&_ in In(R)}function Sl(_){var R=typeof _;return R=="string"||R=="number"||R=="symbol"||R=="boolean"?_!=="__proto__":_===null}function uu(_){var R=wl(_),U=xe[R];if(typeof U!="function"||!(R in Mr.prototype))return!1;if(_===U)return!0;var ie=fc(U);return!!ie&&_===ie[0]}function Ef(_){return!!Iu&&Iu in _}var rh=rl?zo:Ih;function ja(_){var R=_&&_.constructor,U=typeof R=="function"&&R.prototype||Qi;return _===U}function cu(_){return _===_&&!Qn(_)}function mc(_,R){return function(U){return U==null?!1:U[_]===R&&(R!==r||_ in In(U))}}function wf(_){var R=Le(_,function(ie){return U.size===c&&U.clear(),ie}),U=R.cache;return R}function Sf(_,R){var U=_[1],ie=R[1],ge=U|ie,be=ge<(T|S|W),Re=ie==W&&U==A||ie==W&&U==H&&_[7].length<=R[8]||ie==(W|H)&&R[7].length<=R[8]&&U==A;if(!(be||Re))return _;ie&T&&(_[2]=R[2],ge|=U&T?0:P);var ke=R[3];if(ke){var Oe=_[3];_[3]=Oe?mf(Oe,ke,R[4]):ke,_[4]=Oe?pi(_[3],d):R[4]}return ke=R[5],ke&&(Oe=_[5],_[5]=Oe?cd(Oe,ke,R[6]):ke,_[6]=Oe?pi(_[5],d):R[6]),ke=R[7],ke&&(_[7]=ke),ie&W&&(_[8]=_[8]==null?R[8]:Is(_[8],R[8])),_[9]==null&&(_[9]=R[9]),_[0]=R[0],_[1]=ge,_}function Rf(_){var R=[];if(_!=null)for(var U in In(_))R.push(U);return R}function Ed(_){return $l.call(_)}function gc(_,R,U){return R=ns(R===r?_.length-1:R,0),function(){for(var ie=arguments,ge=-1,be=ns(ie.length-R,0),Re=Be(be);++ge<be;)Re[ge]=ie[R+ge];ge=-1;for(var ke=Be(R+1);++ge<R;)ke[ge]=ie[ge];return ke[R]=U(Re),gs(_,this,ke)}}function ys(_,R){return R.length<2?_:Ta(_,Os(R,0,-1))}function Li(_,R){for(var U=_.length,ie=Is(R.length,U),ge=Vs(_);ie--;){var be=R[ie];_[ie]=zn(be,U)?ge[be]:r}return _}function fa(_,R){if(!(R==="constructor"&&typeof _[R]=="function")&&R!="__proto__")return _[R]}var wd=Vi(Qu),Rl=Uc||function(_,R){return Rn.setTimeout(_,R)},oi=Vi(la);function Sd(_,R,U){var ie=R+"";return oi(_,th(ie,Pf(bf(ie),U)))}function Vi(_){var R=0,U=0;return function(){var ie=Yf(),ge=ae-(ie-U);if(U=ie,ge>0){if(++R>=fe)return arguments[0]}else R=0;return _.apply(r,arguments)}}function yc(_,R){var U=-1,ie=_.length,ge=ie-1;for(R=R===r?ie:R;++U<R;){var be=gl(U,ge),Re=_[be];_[be]=_[U],_[U]=Re}return _.length=R,_}var Rd=wf(function(_){var R=[];return _.charCodeAt(0)===46&&R.push(""),_.replace(yr,function(U,ie,ge,be){R.push(ge?be.replace(Hn,"$1"):ie||U)}),R});function Bi(_){if(typeof _=="string"||zi(_))return _;var R=_+"";return R=="0"&&1/_==-1/0?"-0":R}function io(_){if(_!=null){try{return Ol.call(_)}catch{}try{return _+""}catch{}}return""}function Pf(_,R){return us(Ae,function(U){var ie="_."+U[0];R&U[1]&&!bo(_,ie)&&_.push(ie)}),_.sort()}function Tf(_){if(_ instanceof Mr)return _.clone();var R=new ks(_.__wrapped__,_.__chain__);return R.__actions__=Vs(_.__actions__),R.__index__=_.__index__,R.__values__=_.__values__,R}function vc(_,R,U){(U?Us(_,R,U):R===r)?R=1:R=ns(Br(R),0);var ie=_==null?0:_.length;if(!ie||R<1)return[];for(var ge=0,be=0,Re=Be(Ro(ie/R));ge<ie;)Re[be++]=Os(_,ge,ge+=R);return Re}function Pd(_){for(var R=-1,U=_==null?0:_.length,ie=0,ge=[];++R<U;){var be=_[R];be&&(ge[ie++]=be)}return ge}function Si(){var _=arguments.length;if(!_)return[];for(var R=Be(_-1),U=arguments[0],ie=_;ie--;)R[ie-1]=arguments[ie];return Di(Or(U)?Vs(U):[U],Zn(R,1))}var dn=Vr(function(_,R){return hs(_)?ia(_,Zn(R,1,hs,!0)):[]}),vs=Vr(function(_,R){var U=Gs(R);return hs(U)&&(U=r),hs(_)?ia(_,Zn(R,1,hs,!0),gr(U,2)):[]}),ss=Vr(function(_,R){var U=Gs(R);return hs(U)&&(U=r),hs(_)?ia(_,Zn(R,1,hs,!0),r,U):[]});function Ps(_,R,U){var ie=_==null?0:_.length;return ie?(R=U||R===r?1:Br(R),Os(_,R<0?0:R,ie)):[]}function li(_,R,U){var ie=_==null?0:_.length;return ie?(R=U||R===r?1:Br(R),R=ie-R,Os(_,0,R<0?0:R)):[]}function Pl(_,R){return _&&_.length?Ql(_,gr(R,3),!0,!0):[]}function fs(_,R){return _&&_.length?Ql(_,gr(R,3),!0):[]}function du(_,R,U,ie){var ge=_==null?0:_.length;return ge?(U&&typeof U!="number"&&Us(_,R,U)&&(U=0,ie=ge),of(_,R,U,ie)):[]}function ao(_,R,U){var ie=_==null?0:_.length;if(!ie)return-1;var ge=U==null?0:Br(U);return ge<0&&(ge=ns(ie+ge,0)),Eo(_,gr(R,3),ge)}function fu(_,R,U){var ie=_==null?0:_.length;if(!ie)return-1;var ge=ie-1;return U!==r&&(ge=Br(U),ge=U<0?ns(ie+ge,0):Is(ge,ie-1)),Eo(_,gr(R,3),ge,!0)}function xc(_){var R=_==null?0:_.length;return R?Zn(_,1):[]}function hu(_){var R=_==null?0:_.length;return R?Zn(_,le):[]}function Qs(_,R){var U=_==null?0:_.length;return U?(R=R===r?1:Br(R),Zn(_,R)):[]}function Td(_){for(var R=-1,U=_==null?0:_.length,ie={};++R<U;){var ge=_[R];ie[ge[0]]=ge[1]}return ie}function Fo(_){return _&&_.length?_[0]:r}function Ma(_,R,U){var ie=_==null?0:_.length;if(!ie)return-1;var ge=U==null?0:Br(U);return ge<0&&(ge=ns(ie+ge,0)),ba(_,R,ge)}function _c(_){var R=_==null?0:_.length;return R?Os(_,0,-1):[]}var Ad=Vr(function(_){var R=Pn(_,xl);return R.length&&R[0]===_[0]?Ku(R):[]}),oo=Vr(function(_){var R=Gs(_),U=Pn(_,xl);return R===Gs(U)?R=r:U.pop(),U.length&&U[0]===_[0]?Ku(U,gr(R,2)):[]}),bc=Vr(function(_){var R=Gs(_),U=Pn(_,xl);return R=typeof R=="function"?R:r,R&&U.pop(),U.length&&U[0]===_[0]?Ku(U,r,R):[]});function lo(_,R){return _==null?"":Ou.call(_,R)}function Gs(_){var R=_==null?0:_.length;return R?_[R-1]:r}function pu(_,R,U){var ie=_==null?0:_.length;if(!ie)return-1;var ge=ie;return U!==r&&(ge=Br(U),ge=ge<0?ns(ie+ge,0):Is(ge,ie-1)),R===R?Wf(_,R,ge):Eo(_,D,ge,!0)}function Cd(_,R){return _&&_.length?Ju(_,Br(R)):r}var Ec=Vr(mu);function mu(_,R){return _&&_.length&&R&&R.length?Yn(_,R):_}function zs(_,R,U){return _&&_.length&&R&&R.length?Yn(_,R,gr(U,2)):_}function uo(_,R,U){return _&&_.length&&R&&R.length?Yn(_,R,r,U):_}var Ui=da(function(_,R){var U=_==null?0:_.length,ie=Hu(_,R);return ds(_,Pn(R,function(ge){return zn(ge,U)?+ge:ge}).sort(ud)),ie});function ei(_,R){var U=[];if(!(_&&_.length))return U;var ie=-1,ge=[],be=_.length;for(R=gr(R,3);++ie<be;){var Re=_[ie];R(Re,ie,_)&&(U.push(Re),ge.push(ie))}return ds(_,ge),U}function wc(_){return _==null?_:$u.call(_)}function Id(_,R,U){var ie=_==null?0:_.length;return ie?(U&&typeof U!="number"&&Us(_,R,U)?(R=0,U=ie):(R=R==null?0:Br(R),U=U===r?ie:Br(U)),Os(_,R,U)):[]}function kd(_,R){return yl(_,R)}function nh(_,R,U){return ec(_,R,gr(U,2))}function co(_,R){var U=_==null?0:_.length;if(U){var ie=yl(_,R);if(ie<U&&Oa(_[ie],R))return ie}return-1}function Af(_,R){return yl(_,R,!0)}function Nd(_,R,U){return ec(_,R,gr(U,2),!0)}function Lo(_,R){var U=_==null?0:_.length;if(U){var ie=yl(_,R,!0)-1;if(Oa(_[ie],R))return ie}return-1}function Dd(_){return _&&_.length?nd(_):[]}function Vo(_,R){return _&&_.length?nd(_,gr(R,2)):[]}function Cf(_){var R=_==null?0:_.length;return R?Os(_,1,R):[]}function If(_,R,U){return _&&_.length?(R=U||R===r?1:Br(R),Os(_,0,R<0?0:R)):[]}function jd(_,R,U){var ie=_==null?0:_.length;return ie?(R=U||R===r?1:Br(R),R=ie-R,Os(_,R<0?0:R,ie)):[]}function Sc(_,R){return _&&_.length?Ql(_,gr(R,3),!1,!0):[]}function sh(_,R){return _&&_.length?Ql(_,gr(R,3)):[]}var ih=Vr(function(_){return ka(Zn(_,1,hs,!0))}),kf=Vr(function(_){var R=Gs(_);return hs(R)&&(R=r),ka(Zn(_,1,hs,!0),gr(R,2))}),Nf=Vr(function(_){var R=Gs(_);return R=typeof R=="function"?R:r,ka(Zn(_,1,hs,!0),r,R)});function Bo(_){return _&&_.length?ka(_):[]}function ah(_,R){return _&&_.length?ka(_,gr(R,2)):[]}function Tl(_,R){return R=typeof R=="function"?R:r,_&&_.length?ka(_,r,R):[]}function Rc(_){if(!(_&&_.length))return[];var R=0;return _=hi(_,function(U){if(hs(U))return R=ns(U.length,R),!0}),vn(R,function(U){return Pn(_,pe(U))})}function Wn(_,R){if(!(_&&_.length))return[];var U=Rc(_);return R==null?U:Pn(U,function(ie){return gs(R,r,ie)})}var oh=Vr(function(_,R){return hs(_)?ia(_,R):[]}),Df=Vr(function(_){return rc(hi(_,hs))}),lh=Vr(function(_){var R=Gs(_);return hs(R)&&(R=r),rc(hi(_,hs),gr(R,2))}),uh=Vr(function(_){var R=Gs(_);return R=typeof R=="function"?R:r,rc(hi(_,hs),r,R)}),jf=Vr(Rc);function Mf(_,R){return eu(_||[],R||[],Io)}function ch(_,R){return eu(_||[],R||[],Mo)}var Ri=Vr(function(_){var R=_.length,U=R>1?_[R-1]:r;return U=typeof U=="function"?(_.pop(),U):r,Wn(_,U)});function Pc(_){var R=xe(_);return R.__chain__=!0,R}function dh(_,R){return R(_),_}function Gi(_,R){return R(_)}var Tc=da(function(_){var R=_.length,U=R?_[0]:0,ie=this.__wrapped__,ge=function(be){return Hu(be,_)};return R>1||this.__actions__.length||!(ie instanceof Mr)||!zn(U)?this.thru(ge):(ie=ie.slice(U,+U+(R?1:0)),ie.__actions__.push({func:Gi,args:[ge],thisArg:r}),new ks(ie,this.__chain__).thru(function(be){return R&&!be.length&&be.push(r),be}))});function Uo(){return Pc(this)}function Ac(){return new ks(this.value(),this.__chain__)}function Md(){this.__values__===r&&(this.__values__=Mh(this.value()));var _=this.__index__>=this.__values__.length,R=_?r:this.__values__[this.__index__++];return{done:_,value:R}}function Od(){return this}function fh(_){for(var R,U=this;U instanceof ta;){var ie=Tf(U);ie.__index__=0,ie.__values__=r,R?ge.__wrapped__=ie:R=ie;var ge=ie;U=U.__wrapped__}return ge.__wrapped__=_,R}function $d(){var _=this.__wrapped__;if(_ instanceof Mr){var R=_;return this.__actions__.length&&(R=new Mr(this)),R=R.reverse(),R.__actions__.push({func:Gi,args:[wc],thisArg:r}),new ks(R,this.__chain__)}return this.thru(wc)}function hh(){return vl(this.__wrapped__,this.__actions__)}var Of=ic(function(_,R,U){pn.call(_,U)?++_[U]:sa(_,U,1)});function $f(_,R,U){var ie=Or(_)?_o:Wl;return U&&Us(_,R,U)&&(R=r),ie(_,gr(R,3))}function Cc(_,R){var U=Or(_)?hi:Kc;return U(_,gr(R,3))}var Ic=$o(ao),Ff=$o(fu);function Fd(_,R){return Zn(Go(_,R),1)}function ph(_,R){return Zn(Go(_,R),le)}function Lf(_,R,U){return U=U===r?1:Br(U),Zn(Go(_,R),U)}function kc(_,R){var U=Or(_)?us:aa;return U(_,gr(R,3))}function gu(_,R){var U=Or(_)?xo:af;return U(_,gr(R,3))}var Ld=ic(function(_,R,U){pn.call(_,U)?_[U].push(R):sa(_,U,[R])});function Nc(_,R,U,ie){_=Pi(_)?_:Mc(_),U=U&&!ie?Br(U):0;var ge=_.length;return U<0&&(U=ns(ge+U,0)),Uf(_)?U<=ge&&_.indexOf(R,U)>-1:!!ge&&ba(_,R,U)>-1}var Vf=Vr(function(_,R,U){var ie=-1,ge=typeof R=="function",be=Pi(_)?Be(_.length):[];return aa(_,function(Re){be[++ie]=ge?gs(R,Re,U):_i(Re,R,U)}),be}),mh=ic(function(_,R,U){sa(_,U,R)});function Go(_,R){var U=Or(_)?Pn:Jc;return U(_,gr(R,3))}function gh(_,R,U,ie){return _==null?[]:(Or(R)||(R=R==null?[]:[R]),U=ie?r:U,Or(U)||(U=U==null?[]:[U]),Yl(_,R,U))}var yu=ic(function(_,R,U){_[U?0:1].push(R)},function(){return[[],[]]});function yh(_,R,U){var ie=Or(_)?ji:$e,ge=arguments.length<3;return ie(_,gr(R,4),U,ge,aa)}function Dc(_,R,U){var ie=Or(_)?Ru:$e,ge=arguments.length<3;return ie(_,gr(R,4),U,ge,af)}function f(_,R){var U=Or(_)?hi:Kc;return U(_,Ct(gr(R,3)))}function g(_){var R=Or(_)?na:Ms;return R(_)}function C(_,R,U){(U?Us(_,R,U):R===r)?R=1:R=Br(R);var ie=Or(_)?Co:td;return ie(_,R)}function V(_){var R=Or(_)?nf:Ei;return R(_)}function J(_){if(_==null)return 0;if(Pi(_))return Uf(_)?wo(_):_.length;var R=Ss(_);return R==Ue||R==er?_.size:Ia(_).length}function se(_,R,U){var ie=Or(_)?Xo:rd;return U&&Us(_,R,U)&&(R=r),ie(_,gr(R,3))}var ve=Vr(function(_,R){if(_==null)return[];var U=R.length;return U>1&&Us(_,R[0],R[1])?R=[]:U>2&&Us(R[0],R[1],R[2])&&(R=[R[0]]),Yl(_,Zn(R,1),[])}),we=$n||function(){return Rn.Date.now()};function Ie(_,R){if(typeof R!="function")throw new mi(o);return _=Br(_),function(){if(--_<1)return R.apply(this,arguments)}}function Ge(_,R,U){return R=U?r:R,R=_&&R==null?_.length:R,ca(_,W,r,r,r,r,R)}function nt(_,R){var U;if(typeof R!="function")throw new mi(o);return _=Br(_),function(){return--_>0&&(U=R.apply(this,arguments)),_<=1&&(R=r),U}}var vt=Vr(function(_,R,U){var ie=T;if(U.length){var ge=pi(U,Da(vt));ie|=j}return ca(_,ie,R,U,ge)}),tt=Vr(function(_,R,U){var ie=T|S;if(U.length){var ge=pi(U,Da(tt));ie|=j}return ca(R,ie,_,U,ge)});function Gt(_,R,U){R=U?r:R;var ie=ca(_,A,r,r,r,r,r,R);return ie.placeholder=Gt.placeholder,ie}function tr(_,R,U){R=U?r:R;var ie=ca(_,I,r,r,r,r,r,R);return ie.placeholder=tr.placeholder,ie}function rr(_,R,U){var ie,ge,be,Re,ke,Oe,Je=0,Qe=!1,pt=!1,Dt=!0;if(typeof _!="function")throw new mi(o);R=ha(R)||0,Qn(U)&&(Qe=!!U.leading,pt="maxWait"in U,be=pt?ns(ha(U.maxWait)||0,R):be,Dt="trailing"in U?!!U.trailing:Dt);function ar(ps){var $a=ie,qo=ge;return ie=ge=r,Je=ps,Re=_.apply(qo,$a),Re}function Sr(ps){return Je=ps,ke=Rl(Jr,R),Qe?ar(ps):Re}function Ur(ps){var $a=ps-Oe,qo=ps-Je,Kh=R-$a;return pt?Is(Kh,be-qo):Kh}function Rr(ps){var $a=ps-Oe,qo=ps-Je;return Oe===r||$a>=R||$a<0||pt&&qo>=be}function Jr(){var ps=we();if(Rr(ps))return fn(ps);ke=Rl(Jr,Ur(ps))}function fn(ps){return ke=r,Dt&&ie?ar(ps):(ie=ge=r,Re)}function Hi(){ke!==r&&od(ke),Je=0,ie=Oe=ge=ke=r}function ui(){return ke===r?Re:fn(we())}function qi(){var ps=we(),$a=Rr(ps);if(ie=arguments,ge=this,Oe=ps,$a){if(ke===r)return Sr(Oe);if(pt)return od(ke),ke=Rl(Jr,R),ar(Oe)}return ke===r&&(ke=Rl(Jr,R)),Re}return qi.cancel=Hi,qi.flush=ui,qi}var Jn=Vr(function(_,R){return Wc(_,1,R)}),Fe=Vr(function(_,R,U){return Wc(_,ha(R)||0,U)});function Ne(_){return ca(_,ee)}function Le(_,R){if(typeof _!="function"||R!=null&&typeof R!="function")throw new mi(o);var U=function(){var ie=arguments,ge=R?R.apply(this,ie):ie[0],be=U.cache;if(be.has(ge))return be.get(ge);var Re=_.apply(this,ie);return U.cache=be.set(ge,Re)||be,Re};return U.cache=new(Le.Cache||gi),U}Le.Cache=gi;function Ct(_){if(typeof _!="function")throw new mi(o);return function(){var R=arguments;switch(R.length){case 0:return!_.call(this);case 1:return!_.call(this,R[0]);case 2:return!_.call(this,R[0],R[1]);case 3:return!_.call(this,R[0],R[1],R[2])}return!_.apply(this,R)}}function sr(_){return nt(2,_)}var mr=cf(function(_,R){R=R.length==1&&Or(R[0])?Pn(R[0],bn(gr())):Pn(Zn(R,1),bn(gr()));var U=R.length;return Vr(function(ie){for(var ge=-1,be=Is(ie.length,U);++ge<be;)ie[ge]=R[ge].call(this,ie[ge]);return gs(_,this,ie)})}),hr=Vr(function(_,R){var U=pi(R,Da(hr));return ca(_,j,r,R,U)}),wr=Vr(function(_,R){var U=pi(R,Da(wr));return ca(_,K,r,R,U)}),xs=da(function(_,R){return ca(_,H,r,r,r,R)});function mn(_,R){if(typeof _!="function")throw new mi(o);return R=R===r?R:Br(R),Vr(_,R)}function fo(_,R){if(typeof _!="function")throw new mi(o);return R=R==null?0:ns(Br(R),0),Vr(function(U){var ie=U[R],ge=Na(U,0,R);return ie&&Di(ge,ie),gs(_,this,ge)})}function xh(_,R,U){var ie=!0,ge=!0;if(typeof _!="function")throw new mi(o);return Qn(U)&&(ie="leading"in U?!!U.leading:ie,ge="trailing"in U?!!U.trailing:ge),rr(_,R,{leading:ie,maxWait:R,trailing:ge})}function Xh(_){return Ge(_,1)}function Yh(_,R){return hr(nc(R),_)}function Jh(){if(!arguments.length)return[];var _=arguments[0];return Or(_)?_:[_]}function Qh(_){return Ys(_,y)}function ep(_,R){return R=typeof R=="function"?R:r,Ys(_,y,R)}function tp(_){return Ys(_,p|y)}function rp(_,R){return R=typeof R=="function"?R:r,Ys(_,p|y,R)}function np(_,R){return R==null||ql(_,R,$s(R))}function Oa(_,R){return _===R||_!==_&&R!==R}var sp=dc(to),ap=dc(function(_,R){return _>=R}),vu=Zu(function(){return arguments}())?Zu:function(_){return as(_)&&pn.call(_,"callee")&&!Du.call(_,"callee")},Or=Be.isArray,lp=Zo?bn(Zo):lf;function Pi(_){return _!=null&&Bf(_.length)&&!zo(_)}function hs(_){return as(_)&&Pi(_)}function up(_){return _===!0||_===!1||as(_)&&Es(_)==Pe}var Al=Gc||Ih,cp=ms?bn(ms):Ca;function dp(_){return as(_)&&_.nodeType===1&&!Vd(_)}function fp(_){if(_==null)return!0;if(Pi(_)&&(Or(_)||typeof _=="string"||typeof _.splice=="function"||Al(_)||jc(_)||vu(_)))return!_.length;var R=Ss(_);if(R==Ue||R==er)return!_.size;if(ja(_))return!Ia(_).length;for(var U in _)if(pn.call(_,U))return!1;return!0}function hp(_,R){return bi(_,R)}function pp(_,R,U){U=typeof U=="function"?U:r;var ie=U?U(_,R):r;return ie===r?bi(_,R,r,U):!!ie}function _h(_){if(!as(_))return!1;var R=Es(_);return R==ze||R==De||typeof _.message=="string"&&typeof _.name=="string"&&!Vd(_)}function mp(_){return typeof _=="number"&&sl(_)}function zo(_){if(!Qn(_))return!1;var R=Es(_);return R==Et||R==Ze||R==Ve||R==lr}function kh(_){return typeof _=="number"&&_==Br(_)}function Bf(_){return typeof _=="number"&&_>-1&&_%1==0&&_<=Z}function Qn(_){var R=typeof _;return _!=null&&(R=="object"||R=="function")}function as(_){return _!=null&&typeof _=="object"}var Nh=fi?bn(fi):uf;function gp(_,R){return _===R||pl(_,R,ou(R))}function yp(_,R,U){return U=typeof U=="function"?U:r,pl(_,R,ou(R),U)}function vp(_){return Dh(_)&&_!=+_}function xp(_){if(rh(_))throw new Tr(a);return Xc(_)}function _p(_){return _===null}function bp(_){return _==null}function Dh(_){return typeof _=="number"||as(_)&&Es(_)==qt}function Vd(_){if(!as(_)||Es(_)!=Lt)return!1;var R=Mi(_);if(R===null)return!0;var U=pn.call(R,"constructor")&&R.constructor;return typeof U=="function"&&U instanceof U&&Ol.call(U)==ku}var bh=vo?bn(vo):Zl;function Ep(_){return kh(_)&&_>=-9007199254740991&&_<=Z}var jh=Ni?bn(Ni):oa;function Uf(_){return typeof _=="string"||!Or(_)&&as(_)&&Es(_)==xr}function zi(_){return typeof _=="symbol"||as(_)&&Es(_)==br}var jc=Su?bn(Su):Xl;function wp(_){return _===r}function Sp(_){return as(_)&&Ss(_)==zr}function Rp(_){return as(_)&&Es(_)==pr}var Pp=dc(ro),Tp=dc(function(_,R){return _<=R});function Mh(_){if(!_)return[];if(Pi(_))return Uf(_)?ni(_):Vs(_);if(Sa&&_[Sa])return Hf(_[Sa]());var R=Ss(_),U=R==Ue?Tu:R==er?Wa:Mc;return U(_)}function Ho(_){if(!_)return _===0?_:0;if(_=ha(_),_===le||_===-1/0){var R=_<0?-1:1;return R*Y}return _===_?_:0}function Br(_){var R=Ho(_),U=R%1;return R===R?U?R-U:R:0}function Oh(_){return _?Pa(Br(_),0,oe):0}function ha(_){if(typeof _=="number")return _;if(zi(_))return he;if(Qn(_)){var R=typeof _.valueOf=="function"?_.valueOf():_;_=Qn(R)?R+"":R}if(typeof _!="string")return _===0?_:+_;_=Yr(_);var U=es.test(_);return U||ti.test(_)?go(_.slice(2),U?2:8):os.test(_)?he:+_}function $h(_){return $i(_,Ti(_))}function Ap(_){return _?Pa(Br(_),-9007199254740991,Z):_===0?_:0}function kn(_){return _==null?"":Js(_)}var Cp=_l(function(_,R){if(ja(R)||Pi(R)){$i(R,$s(R),_);return}for(var U in R)pn.call(R,U)&&Io(_,U,R[U])}),Fh=_l(function(_,R){$i(R,Ti(R),_)}),Gf=_l(function(_,R,U,ie){$i(R,Ti(R),_,ie)}),Ip=_l(function(_,R,U,ie){$i(R,$s(R),_,ie)}),kp=da(Hu);function Np(_,R){var U=ul(_);return R==null?U:Ln(U,R)}var Dp=Vr(function(_,R){_=In(_);var U=-1,ie=R.length,ge=ie>2?R[2]:r;for(ge&&Us(R[0],R[1],ge)&&(ie=1);++U<ie;)for(var be=R[U],Re=Ti(be),ke=-1,Oe=Re.length;++ke<Oe;){var Je=Re[ke],Qe=_[Je];(Qe===r||Oa(Qe,Qi[Je])&&!pn.call(_,Je))&&(_[Je]=be[Je])}return _}),jp=Vr(function(_){return _.push(r,gd),gs(Lh,r,_)});function Mp(_,R){return As(_,gr(R,3),ai)}function Op(_,R){return As(_,gr(R,3),eo)}function $p(_,R){return _==null?_:qu(_,gr(R,3),Ti)}function Fp(_,R){return _==null?_:Kl(_,gr(R,3),Ti)}function Lp(_,R){return _&&ai(_,gr(R,3))}function Vp(_,R){return _&&eo(_,gr(R,3))}function Bp(_){return _==null?[]:hl(_,$s(_))}function Up(_){return _==null?[]:hl(_,Ti(_))}function Eh(_,R,U){var ie=_==null?r:Ta(_,R);return ie===r?U:ie}function Gp(_,R){return _!=null&&bd(_,R,xi)}function wh(_,R){return _!=null&&bd(_,R,No)}var zp=gf(function(_,R,U){R!=null&&typeof R.toString!="function"&&(R=$l.call(R)),_[R]=U},Rh(Ai)),Hp=gf(function(_,R,U){R!=null&&typeof R.toString!="function"&&(R=$l.call(R)),pn.call(_,R)?_[R].push(U):_[R]=[U]},gr),qp=Vr(_i);function $s(_){return Pi(_)?ra(_):Ia(_)}function Ti(_){return Pi(_)?ra(_,!0):Yc(_)}function Wp(_,R){var U={};return R=gr(R,3),ai(_,function(ie,ge,be){sa(U,R(ie,ge,be),ie)}),U}function Kp(_,R){var U={};return R=gr(R,3),ai(_,function(ie,ge,be){sa(U,ge,R(ie,ge,be))}),U}var Zp=_l(function(_,R,U){Do(_,R,U)}),Lh=_l(function(_,R,U,ie){Do(_,R,U,ie)}),Xp=da(function(_,R){var U={};if(_==null)return U;var ie=!1;R=Pn(R,function(be){return be=ua(be,_),ie||(ie=be.length>1),be}),$i(_,iu(_),U),ie&&(U=Ys(U,p|m|y,yd));for(var ge=R.length;ge--;)tc(U,R[ge]);return U});function Yp(_,R){return Vh(_,Ct(gr(R)))}var Jp=da(function(_,R){return _==null?{}:ed(_,R)});function Vh(_,R){if(_==null)return{};var U=Pn(iu(_),function(ie){return[ie]});return R=gr(R),no(_,U,function(ie,ge){return R(ie,ge[0])})}function Qp(_,R,U){R=ua(R,_);var ie=-1,ge=R.length;for(ge||(ge=1,_=r);++ie<ge;){var be=_==null?r:_[Bi(R[ie])];be===r&&(ie=ge,be=U),_=zo(be)?be.call(_):be}return _}function em(_,R,U){return _==null?_:Mo(_,R,U)}function tm(_,R,U,ie){return ie=typeof ie=="function"?ie:r,_==null?_:Mo(_,R,U,ie)}var Bh=pd($s),Uh=pd(Ti);function rm(_,R,U){var ie=Or(_),ge=ie||Al(_)||jc(_);if(R=gr(R,4),U==null){var be=_&&_.constructor;ge?U=ie?new be:[]:Qn(_)?U=zo(be)?ul(Mi(_)):{}:U={}}return(ge?us:ai)(_,function(Re,ke,Oe){return R(U,Re,ke,Oe)}),U}function sm(_,R){return _==null?!0:tc(_,R)}function im(_,R,U){return _==null?_:ad(_,R,nc(U))}function am(_,R,U,ie){return ie=typeof ie=="function"?ie:r,_==null?_:ad(_,R,nc(U),ie)}function Mc(_){return _==null?[]:Kn(_,$s(_))}function om(_){return _==null?[]:Kn(_,Ti(_))}function lm(_,R,U){return U===r&&(U=R,R=r),U!==r&&(U=ha(U),U=U===U?U:0),R!==r&&(R=ha(R),R=R===R?R:0),Pa(ha(_),R,U)}function um(_,R,U){return R=Ho(R),U===r?(U=R,R=0):U=Ho(U),_=ha(_),Zc(_,R,U)}function cm(_,R,U){if(U&&typeof U!="boolean"&&Us(_,R,U)&&(R=U=r),U===r&&(typeof R=="boolean"?(U=R,R=r):typeof _=="boolean"&&(U=_,_=r)),_===r&&R===r?(_=0,R=1):(_=Ho(_),R===r?(R=_,_=0):R=Ho(R)),_>R){var ie=_;_=R,R=ie}if(U||_%1||R%1){var ge=Bl();return Is(_+ge*(R-_+Nl("1e-"+((ge+"").length-1))),R)}return gl(_,R)}var dm=Oo(function(_,R,U){return R=R.toLowerCase(),_+(U?Gh(R):R)});function Gh(_){return Sh(kn(_).toLowerCase())}function zh(_){return _=kn(_),_&&_.replace(We,Bd).replace(bu,"")}function fm(_,R,U){_=kn(_),R=Js(R);var ie=_.length;U=U===r?ie:Pa(Br(U),0,ie);var ge=U;return U-=R.length,U>=0&&_.slice(U,ge)==R}function hm(_){return _=kn(_),_&&Er.test(_)?_.replace(Ir,Ud):_}function pm(_){return _=kn(_),_&&vr.test(_)?_.replace(Wr,"\\$&"):_}var mm=Oo(function(_,R,U){return _+(U?"-":"")+R.toLowerCase()}),gm=Oo(function(_,R,U){return _+(U?" ":"")+R.toLowerCase()}),ym=dd("toLowerCase");function vm(_,R,U){_=kn(_),R=Br(R);var ie=R?wo(_):0;if(!R||ie>=R)return _;var ge=(R-ie)/2;return nu(Ka(ge),U)+_+nu(Ro(ge),U)}function xm(_,R,U){_=kn(_),R=Br(R);var ie=R?wo(_):0;return R&&ie<R?_+nu(R-ie,U):_}function _m(_,R,U){_=kn(_),R=Br(R);var ie=R?wo(_):0;return R&&ie<R?nu(R-ie,U)+_:_}function bm(_,R,U){return U||R==null?R=0:R&&(R=+R),Yd(kn(_).replace(jr,""),R||0)}function Em(_,R,U){return(U?Us(_,R,U):R===r)?R=1:R=Br(R),jo(kn(_),R)}function wm(){var _=arguments,R=kn(_[0]);return _.length<3?R:R.replace(_[1],_[2])}var Sm=Oo(function(_,R,U){return _+(U?"_":"")+R.toLowerCase()});function Rm(_,R,U){return U&&typeof U!="number"&&Us(_,R,U)&&(R=U=r),U=U===r?oe:U>>>0,U?(_=kn(_),_&&(typeof R=="string"||R!=null&&!bh(R))&&(R=Js(R),!R&&el(_))?Na(ni(_),0,U):_.split(R,U)):[]}var Pm=Oo(function(_,R,U){return _+(U?" ":"")+Sh(R)});function Tm(_,R,U){return _=kn(_),U=U==null?0:Pa(Br(U),0,_.length),R=Js(R),_.slice(U,U+R.length)==R}function Am(_,R,U){var ie=xe.templateSettings;U&&Us(_,R,U)&&(R=r),_=kn(_),R=Gf({},R,ie,md);var ge=Gf({},R.imports,ie.imports,md),be=$s(ge),Re=Kn(ge,be),ke,Oe,Je=0,Qe=R.interpolate||et,pt="__p += '",Dt=Ml((R.escape||et).source+"|"+Qe.source+"|"+(Qe===qr?Tn:et).source+"|"+(R.evaluate||et).source+"|$","g"),ar="//# sourceURL="+(pn.call(R,"sourceURL")?(R.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++wu+"]")+`
`;_.replace(Dt,function(Rr,Jr,fn,Hi,ui,qi){return fn||(fn=Hi),pt+=_.slice(Je,qi).replace(Ye,Gd),Jr&&(ke=!0,pt+=`' +
__e(`+Jr+`) +
'`),ui&&(Oe=!0,pt+=`';
`+ui+`;
__p += '`),fn&&(pt+=`' +
((__t = (`+fn+`)) == null ? '' : __t) +
'`),Je=qi+Rr.length,Rr}),pt+=`';
`;var Sr=pn.call(R,"variable")&&R.variable;if(!Sr)pt=`with (obj) {
`+pt+`
}
`;else if(Bn.test(Sr))throw new Tr(l);pt=(Oe?pt.replace(wn,""):pt).replace(jn,"$1").replace($r,"$1;"),pt="function("+(Sr||"obj")+`) {
`+(Sr?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ke?", __e = _.escape":"")+(Oe?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+pt+`return __p
}`;var Ur=qh(function(){return hn(be,ar+"return "+pt).apply(r,Re)});if(Ur.source=pt,_h(Ur))throw Ur;return Ur}function Cm(_){return kn(_).toLowerCase()}function Im(_){return kn(_).toUpperCase()}function km(_,R,U){if(_=kn(_),_&&(U||R===r))return Yr(_);if(!_||!(R=Js(R)))return _;var ie=ni(_),ge=ni(R),be=Ws(ie,ge),Re=qa(ie,ge)+1;return Na(ie,be,Re).join("")}function Nm(_,R,U){if(_=kn(_),_&&(U||R===r))return _.slice(0,Cu(_)+1);if(!_||!(R=Js(R)))return _;var ie=ni(_),ge=qa(ie,ni(R))+1;return Na(ie,0,ge).join("")}function Dm(_,R,U){if(_=kn(_),_&&(U||R===r))return _.replace(jr,"");if(!_||!(R=Js(R)))return _;var ie=ni(_),ge=Ws(ie,ni(R));return Na(ie,ge).join("")}function jm(_,R){var U=ue,ie=de;if(Qn(R)){var ge="separator"in R?R.separator:ge;U="length"in R?Br(R.length):U,ie="omission"in R?Js(R.omission):ie}_=kn(_);var be=_.length;if(el(_)){var Re=ni(_);be=Re.length}if(U>=be)return _;var ke=U-wo(ie);if(ke<1)return ie;var Oe=Re?Na(Re,0,ke).join(""):_.slice(0,ke);if(ge===r)return Oe+ie;if(Re&&(ke+=Oe.length-ke),bh(ge)){if(_.slice(ke).search(ge)){var Je,Qe=Oe;for(ge.global||(ge=Ml(ge.source,kn(Mn.exec(ge))+"g")),ge.lastIndex=0;Je=ge.exec(Qe);)var pt=Je.index;Oe=Oe.slice(0,pt===r?ke:pt)}}else if(_.indexOf(Js(ge),ke)!=ke){var Dt=Oe.lastIndexOf(ge);Dt>-1&&(Oe=Oe.slice(0,Dt))}return Oe+ie}function Mm(_){return _=kn(_),_&&kr.test(_)?_.replace(Cr,zd):_}var Om=Oo(function(_,R,U){return _+(U?" ":"")+R.toUpperCase()}),Sh=dd("toUpperCase");function Hh(_,R,U){return _=kn(_),R=U?r:R,R===r?zf(_)?Kf(_):Yo(_):_.match(R)||[]}var qh=Vr(function(_,R){try{return gs(_,r,R)}catch(U){return _h(U)?U:new Tr(U)}}),$m=da(function(_,R){return us(R,function(U){U=Bi(U),sa(_,U,vt(_[U],_))}),_});function Fm(_){var R=_==null?0:_.length,U=gr();return _=R?Pn(_,function(ie){if(typeof ie[1]!="function")throw new mi(o);return[U(ie[0]),ie[1]]}):[],Vr(function(ie){for(var ge=-1;++ge<R;){var be=_[ge];if(gs(be[0],this,ie))return gs(be[1],this,ie)}})}function Lm(_){return sf(Ys(_,p))}function Rh(_){return function(){return _}}function Vm(_,R){return _==null||_!==_?R:_}var Bm=lc(),Um=lc(!0);function Ai(_){return _}function Ph(_){return ml(typeof _=="function"?_:Ys(_,p))}function Gm(_){return Yu(Ys(_,p))}function zm(_,R){return Gn(_,Ys(R,p))}var Hm=Vr(function(_,R){return function(U){return _i(U,_,R)}}),qm=Vr(function(_,R){return function(U){return _i(_,U,R)}});function Th(_,R,U){var ie=$s(R),ge=hl(R,ie);U==null&&!(Qn(R)&&(ge.length||!ie.length))&&(U=R,R=_,_=this,ge=hl(R,$s(R)));var be=!(Qn(U)&&"chain"in U)||!!U.chain,Re=zo(_);return us(ge,function(ke){var Oe=R[ke];_[ke]=Oe,Re&&(_.prototype[ke]=function(){var Je=this.__chain__;if(be||Je){var Qe=_(this.__wrapped__),pt=Qe.__actions__=Vs(this.__actions__);return pt.push({func:Oe,args:arguments,thisArg:_}),Qe.__chain__=Je,Qe}return Oe.apply(_,Di([this.value()],arguments))})}),_}function Wm(){return Rn._===this&&(Rn._=Wd),this}function Ah(){}function Km(_){return _=Br(_),Vr(function(R){return Ju(R,_)})}var Zm=uc(Pn),Xm=uc(_o),Ym=uc(Xo);function Wh(_){return Kt(_)?pe(Bi(_)):qn(_)}function Jm(_){return function(R){return _==null?r:Ta(_,R)}}var Qm=hd(),eg=hd(!0);function Ch(){return[]}function Ih(){return!1}function tg(){return{}}function rg(){return""}function ng(){return!0}function sg(_,R){if(_=Br(_),_<1||_>Z)return[];var U=oe,ie=Is(_,oe);R=gr(R),_-=oe;for(var ge=vn(ie,R);++U<_;)R(U);return ge}function ig(_){return Or(_)?Pn(_,Bi):zi(_)?[_]:Vs(Rd(kn(_)))}function ag(_){var R=++nl;return kn(_)+R}var og=ru(function(_,R){return _+R},0),lg=ws("ceil"),ug=ru(function(_,R){return _/R},1),cg=ws("floor");function dg(_){return _&&_.length?ko(_,Ai,to):r}function fg(_,R){return _&&_.length?ko(_,gr(R,2),to):r}function hg(_){return ne(_,Ai)}function pg(_,R){return ne(_,gr(R,2))}function mg(_){return _&&_.length?ko(_,Ai,ro):r}function gg(_,R){return _&&_.length?ko(_,gr(R,2),ro):r}var yg=ru(function(_,R){return _*R},1),vg=ws("round"),xg=ru(function(_,R){return _-R},0);function _g(_){return _&&_.length?Nt(_,Ai):0}function bg(_,R){return _&&_.length?Nt(_,gr(R,2)):0}return xe.after=Ie,xe.ary=Ge,xe.assign=Cp,xe.assignIn=Fh,xe.assignInWith=Gf,xe.assignWith=Ip,xe.at=kp,xe.before=nt,xe.bind=vt,xe.bindAll=$m,xe.bindKey=tt,xe.castArray=Jh,xe.chain=Pc,xe.chunk=vc,xe.compact=Pd,xe.concat=Si,xe.cond=Fm,xe.conforms=Lm,xe.constant=Rh,xe.countBy=Of,xe.create=Np,xe.curry=Gt,xe.curryRight=tr,xe.debounce=rr,xe.defaults=Dp,xe.defaultsDeep=jp,xe.defer=Jn,xe.delay=Fe,xe.difference=dn,xe.differenceBy=vs,xe.differenceWith=ss,xe.drop=Ps,xe.dropRight=li,xe.dropRightWhile=Pl,xe.dropWhile=fs,xe.fill=du,xe.filter=Cc,xe.flatMap=Fd,xe.flatMapDeep=ph,xe.flatMapDepth=Lf,xe.flatten=xc,xe.flattenDeep=hu,xe.flattenDepth=Qs,xe.flip=Ne,xe.flow=Bm,xe.flowRight=Um,xe.fromPairs=Td,xe.functions=Bp,xe.functionsIn=Up,xe.groupBy=Ld,xe.initial=_c,xe.intersection=Ad,xe.intersectionBy=oo,xe.intersectionWith=bc,xe.invert=zp,xe.invertBy=Hp,xe.invokeMap=Vf,xe.iteratee=Ph,xe.keyBy=mh,xe.keys=$s,xe.keysIn=Ti,xe.map=Go,xe.mapKeys=Wp,xe.mapValues=Kp,xe.matches=Gm,xe.matchesProperty=zm,xe.memoize=Le,xe.merge=Zp,xe.mergeWith=Lh,xe.method=Hm,xe.methodOf=qm,xe.mixin=Th,xe.negate=Ct,xe.nthArg=Km,xe.omit=Xp,xe.omitBy=Yp,xe.once=sr,xe.orderBy=gh,xe.over=Zm,xe.overArgs=mr,xe.overEvery=Xm,xe.overSome=Ym,xe.partial=hr,xe.partialRight=wr,xe.partition=yu,xe.pick=Jp,xe.pickBy=Vh,xe.property=Wh,xe.propertyOf=Jm,xe.pull=Ec,xe.pullAll=mu,xe.pullAllBy=zs,xe.pullAllWith=uo,xe.pullAt=Ui,xe.range=Qm,xe.rangeRight=eg,xe.rearg=xs,xe.reject=f,xe.remove=ei,xe.rest=mn,xe.reverse=wc,xe.sampleSize=C,xe.set=em,xe.setWith=tm,xe.shuffle=V,xe.slice=Id,xe.sortBy=ve,xe.sortedUniq=Dd,xe.sortedUniqBy=Vo,xe.split=Rm,xe.spread=fo,xe.tail=Cf,xe.take=If,xe.takeRight=jd,xe.takeRightWhile=Sc,xe.takeWhile=sh,xe.tap=dh,xe.throttle=xh,xe.thru=Gi,xe.toArray=Mh,xe.toPairs=Bh,xe.toPairsIn=Uh,xe.toPath=ig,xe.toPlainObject=$h,xe.transform=rm,xe.unary=Xh,xe.union=ih,xe.unionBy=kf,xe.unionWith=Nf,xe.uniq=Bo,xe.uniqBy=ah,xe.uniqWith=Tl,xe.unset=sm,xe.unzip=Rc,xe.unzipWith=Wn,xe.update=im,xe.updateWith=am,xe.values=Mc,xe.valuesIn=om,xe.without=oh,xe.words=Hh,xe.wrap=Yh,xe.xor=Df,xe.xorBy=lh,xe.xorWith=uh,xe.zip=jf,xe.zipObject=Mf,xe.zipObjectDeep=ch,xe.zipWith=Ri,xe.entries=Bh,xe.entriesIn=Uh,xe.extend=Fh,xe.extendWith=Gf,Th(xe,xe),xe.add=og,xe.attempt=qh,xe.camelCase=dm,xe.capitalize=Gh,xe.ceil=lg,xe.clamp=lm,xe.clone=Qh,xe.cloneDeep=tp,xe.cloneDeepWith=rp,xe.cloneWith=ep,xe.conformsTo=np,xe.deburr=zh,xe.defaultTo=Vm,xe.divide=ug,xe.endsWith=fm,xe.eq=Oa,xe.escape=hm,xe.escapeRegExp=pm,xe.every=$f,xe.find=Ic,xe.findIndex=ao,xe.findKey=Mp,xe.findLast=Ff,xe.findLastIndex=fu,xe.findLastKey=Op,xe.floor=cg,xe.forEach=kc,xe.forEachRight=gu,xe.forIn=$p,xe.forInRight=Fp,xe.forOwn=Lp,xe.forOwnRight=Vp,xe.get=Eh,xe.gt=sp,xe.gte=ap,xe.has=Gp,xe.hasIn=wh,xe.head=Fo,xe.identity=Ai,xe.includes=Nc,xe.indexOf=Ma,xe.inRange=um,xe.invoke=qp,xe.isArguments=vu,xe.isArray=Or,xe.isArrayBuffer=lp,xe.isArrayLike=Pi,xe.isArrayLikeObject=hs,xe.isBoolean=up,xe.isBuffer=Al,xe.isDate=cp,xe.isElement=dp,xe.isEmpty=fp,xe.isEqual=hp,xe.isEqualWith=pp,xe.isError=_h,xe.isFinite=mp,xe.isFunction=zo,xe.isInteger=kh,xe.isLength=Bf,xe.isMap=Nh,xe.isMatch=gp,xe.isMatchWith=yp,xe.isNaN=vp,xe.isNative=xp,xe.isNil=bp,xe.isNull=_p,xe.isNumber=Dh,xe.isObject=Qn,xe.isObjectLike=as,xe.isPlainObject=Vd,xe.isRegExp=bh,xe.isSafeInteger=Ep,xe.isSet=jh,xe.isString=Uf,xe.isSymbol=zi,xe.isTypedArray=jc,xe.isUndefined=wp,xe.isWeakMap=Sp,xe.isWeakSet=Rp,xe.join=lo,xe.kebabCase=mm,xe.last=Gs,xe.lastIndexOf=pu,xe.lowerCase=gm,xe.lowerFirst=ym,xe.lt=Pp,xe.lte=Tp,xe.max=dg,xe.maxBy=fg,xe.mean=hg,xe.meanBy=pg,xe.min=mg,xe.minBy=gg,xe.stubArray=Ch,xe.stubFalse=Ih,xe.stubObject=tg,xe.stubString=rg,xe.stubTrue=ng,xe.multiply=yg,xe.nth=Cd,xe.noConflict=Wm,xe.noop=Ah,xe.now=we,xe.pad=vm,xe.padEnd=xm,xe.padStart=_m,xe.parseInt=bm,xe.random=cm,xe.reduce=yh,xe.reduceRight=Dc,xe.repeat=Em,xe.replace=wm,xe.result=Qp,xe.round=vg,xe.runInContext=Me,xe.sample=g,xe.size=J,xe.snakeCase=Sm,xe.some=se,xe.sortedIndex=kd,xe.sortedIndexBy=nh,xe.sortedIndexOf=co,xe.sortedLastIndex=Af,xe.sortedLastIndexBy=Nd,xe.sortedLastIndexOf=Lo,xe.startCase=Pm,xe.startsWith=Tm,xe.subtract=xg,xe.sum=_g,xe.sumBy=bg,xe.template=Am,xe.times=sg,xe.toFinite=Ho,xe.toInteger=Br,xe.toLength=Oh,xe.toLower=Cm,xe.toNumber=ha,xe.toSafeInteger=Ap,xe.toString=kn,xe.toUpper=Im,xe.trim=km,xe.trimEnd=Nm,xe.trimStart=Dm,xe.truncate=jm,xe.unescape=Mm,xe.uniqueId=ag,xe.upperCase=Om,xe.upperFirst=Sh,xe.each=kc,xe.eachRight=gu,xe.first=Fo,Th(xe,function(){var _={};return ai(xe,function(R,U){pn.call(xe.prototype,U)||(_[U]=R)}),_}(),{chain:!1}),xe.VERSION=n,us(["bind","bindKey","curry","curryRight","partial","partialRight"],function(_){xe[_].placeholder=xe}),us(["drop","take"],function(_,R){Mr.prototype[_]=function(U){U=U===r?1:ns(Br(U),0);var ie=this.__filtered__&&!R?new Mr(this):this.clone();return ie.__filtered__?ie.__takeCount__=Is(U,ie.__takeCount__):ie.__views__.push({size:Is(U,oe),type:_+(ie.__dir__<0?"Right":"")}),ie},Mr.prototype[_+"Right"]=function(U){return this.reverse()[_](U).reverse()}}),us(["filter","map","takeWhile"],function(_,R){var U=R+1,ie=U==ce||U==te;Mr.prototype[_]=function(ge){var be=this.clone();return be.__iteratees__.push({iteratee:gr(ge,3),type:U}),be.__filtered__=be.__filtered__||ie,be}}),us(["head","last"],function(_,R){var U="take"+(R?"Right":"");Mr.prototype[_]=function(){return this[U](1).value()[0]}}),us(["initial","tail"],function(_,R){var U="drop"+(R?"":"Right");Mr.prototype[_]=function(){return this.__filtered__?new Mr(this):this[U](1)}}),Mr.prototype.compact=function(){return this.filter(Ai)},Mr.prototype.find=function(_){return this.filter(_).head()},Mr.prototype.findLast=function(_){return this.reverse().find(_)},Mr.prototype.invokeMap=Vr(function(_,R){return typeof _=="function"?new Mr(this):this.map(function(U){return _i(U,_,R)})}),Mr.prototype.reject=function(_){return this.filter(Ct(gr(_)))},Mr.prototype.slice=function(_,R){_=Br(_);var U=this;return U.__filtered__&&(_>0||R<0)?new Mr(U):(_<0?U=U.takeRight(-_):_&&(U=U.drop(_)),R!==r&&(R=Br(R),U=R<0?U.dropRight(-R):U.take(R-_)),U)},Mr.prototype.takeRightWhile=function(_){return this.reverse().takeWhile(_).reverse()},Mr.prototype.toArray=function(){return this.take(oe)},ai(Mr.prototype,function(_,R){var U=/^(?:filter|find|map|reject)|While$/.test(R),ie=/^(?:head|last)$/.test(R),ge=xe[ie?"take"+(R=="last"?"Right":""):R],be=ie||/^find/.test(R);ge&&(xe.prototype[R]=function(){var Re=this.__wrapped__,ke=ie?[1]:arguments,Oe=Re instanceof Mr,Je=ke[0],Qe=Oe||Or(Re),pt=function(Jr){var fn=ge.apply(xe,Di([Jr],ke));return ie&&Dt?fn[0]:fn};Qe&&U&&typeof Je=="function"&&Je.length!=1&&(Oe=Qe=!1);var Dt=this.__chain__,ar=!!this.__actions__.length,Sr=be&&!Dt,Ur=Oe&&!ar;if(!be&&Qe){Re=Ur?Re:new Mr(this);var Rr=_.apply(Re,ke);return Rr.__actions__.push({func:Gi,args:[pt],thisArg:r}),new ks(Rr,Dt)}return Sr&&Ur?_.apply(this,ke):(Rr=this.thru(pt),Sr?ie?Rr.value()[0]:Rr.value():Rr)})}),us(["pop","push","shift","sort","splice","unshift"],function(_){var R=Ea[_],U=/^(?:push|sort|unshift)$/.test(_)?"tap":"thru",ie=/^(?:pop|shift)$/.test(_);xe.prototype[_]=function(){var ge=arguments;if(ie&&!this.__chain__){var be=this.value();return R.apply(Or(be)?be:[],ge)}return this[U](function(Re){return R.apply(Or(Re)?Re:[],ge)})}}),ai(Mr.prototype,function(_,R){var U=xe[R];if(U){var ie=U.name+"";pn.call(ol,ie)||(ol[ie]=[]),ol[ie].push({name:R,func:U})}}),ol[El(r,S).name]=[{name:"wrapper",func:r}],Mr.prototype.clone=Vu,Mr.prototype.reverse=Hc,Mr.prototype.value=cl,xe.prototype.at=Tc,xe.prototype.chain=Uo,xe.prototype.commit=Ac,xe.prototype.next=Md,xe.prototype.plant=fh,xe.prototype.reverse=$d,xe.prototype.toJSON=xe.prototype.valueOf=xe.prototype.value=hh,xe.prototype.first=xe.prototype.head,Sa&&(xe.prototype[Sa]=Od),xe},tl=Zf();ts?((ts.exports=tl)._=tl,Ga._=tl):Rn._=tl}).call(lodash)}(lodash$1,lodash$1.exports)),lodash$1.exports}var propTypes={exports:{}},ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret;function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ReactPropTypesSecret_1=t,ReactPropTypesSecret_1}var factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims;function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var t=requireReactPropTypesSecret();function e(){}function r(){}return r.resetWarningCache=e,factoryWithThrowingShims=function(){function n(o,l,u,c,d,p){if(p!==t){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}n.isRequired=n;function s(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:s,element:n,elementType:n,instanceOf:s,node:n,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:r,resetWarningCache:e};return a.PropTypes=a,a},factoryWithThrowingShims}var hasRequiredPropTypes;function requirePropTypes(){return hasRequiredPropTypes||(hasRequiredPropTypes=1,propTypes.exports=requireFactoryWithThrowingShims()()),propTypes.exports}var lib=lib$1.exports,hasRequiredLib;function requireLib(){return hasRequiredLib||(hasRequiredLib=1,function(t,e){(function(n,s){t.exports=s(requireReact(),requireLodash(),requirePropTypes())})(lib,function(r,n,s){return function(){var a={"./src/Xarrow/utils/buzzier.js":function(c,d,p){p.r(d),p.d(d,{bzFunction:function(){return m},buzzierMinSols:function(){return y}});var m=function(E,T,S,P){return function(A){return Math.pow(1-A,3)*E+3*Math.pow(1-A,2)*A*T+3*(1-A)*Math.pow(A,2)*S+Math.pow(A,3)*P}},y=function(E,T,S,P){var A=m(E,T,S,P),I=-6*E+12*T-6*S,j=Math.pow(-6*E+12*T-6*S,2)-4*(3*T-3*E)*(-3*E+9*T-9*S+3*P),K=2*(-3*E+9*T-9*S+3*P),W=A((I+Math.sqrt(j))/K),H=A((I-Math.sqrt(j))/K);return[W,H]}},"./src/Xarrow/Xarrow.tsx":function(c,d,p){var m=this&&this.__assign||function(){return m=Object.assign||function(H){for(var ee,ue=1,de=arguments.length;ue<de;ue++){ee=arguments[ue];for(var fe in ee)Object.prototype.hasOwnProperty.call(ee,fe)&&(H[fe]=ee[fe])}return H},m.apply(this,arguments)},y=this&&this.__createBinding||(Object.create?function(H,ee,ue,de){de===void 0&&(de=ue),Object.defineProperty(H,de,{enumerable:!0,get:function(){return ee[ue]}})}:function(H,ee,ue,de){de===void 0&&(de=ue),H[de]=ee[ue]}),b=this&&this.__setModuleDefault||(Object.create?function(H,ee){Object.defineProperty(H,"default",{enumerable:!0,value:ee})}:function(H,ee){H.default=ee}),E=this&&this.__importStar||function(H){if(H&&H.__esModule)return H;var ee={};if(H!=null)for(var ue in H)ue!=="default"&&Object.prototype.hasOwnProperty.call(H,ue)&&y(ee,H,ue);return b(ee,H),ee},T=this&&this.__spreadArray||function(H,ee){for(var ue=0,de=ee.length,fe=H.length;ue<de;ue++,fe++)H[fe]=ee[ue];return H},S=this&&this.__importDefault||function(H){return H&&H.__esModule?H:{default:H}};Object.defineProperty(d,"__esModule",{value:!0});var P=E(p("react")),A=S(p("./src/Xarrow/useXarrowProps.ts")),I=p("./src/Xwrapper.tsx"),j=S(p("./src/Xarrow/propTypes.ts")),K=p("./src/Xarrow/utils/GetPosition.tsx"),W=function(H){var ee,ue=P.useRef({svgRef:P.useRef(null),lineRef:P.useRef(null),headRef:P.useRef(null),tailRef:P.useRef(null),lineDrawAnimRef:P.useRef(null),lineDashAnimRef:P.useRef(null),headOpacityAnimRef:P.useRef(null)}),de=ue.current,fe=de.svgRef,ae=de.lineRef,ce=de.headRef;de.tailRef;var me=de.lineDrawAnimRef,te=de.lineDashAnimRef,le=de.headOpacityAnimRef;P.useContext(I.XarrowContext);var Z=A.default(H,ue.current),Y=Z[0],he=Y.labels,oe=Y.lineColor,ye=Y.headColor,Ee=Y.tailColor,Ae=Y.strokeWidth,je=Y.showHead,Te=Y.showTail,Ve=Y.dashness,Pe=Y.headShape,Ce=Y.tailShape,De=Y.showXarrow,ze=Y.animateDrawing,Et=Y.zIndex,Ze=Y.passProps,Ue=Y.arrowBodyProps,qt=Y.arrowHeadProps,or=Y.arrowTailProps,Lt=Y.SVGcanvasProps,rt=Y.divContainerProps,lr=Y.divContainerStyle,ir=Y.SVGcanvasStyle,er=Y._debug,xr=Y.shouldUpdatePosition;ze=H.animateDrawing;var br=P.useState(!ze),Pr=br[0],zr=br[1],pr=P.useState({}),dr=pr[1],Ar=function(){return dr({})},_r=P.useState({cx0:0,cy0:0,cw:0,ch:0,x1:0,y1:0,x2:0,y2:0,dx:0,dy:0,absDx:0,absDy:0,cpx1:0,cpy1:0,cpx2:0,cpy2:0,headOrient:0,tailOrient:0,arrowHeadOffset:{x:0,y:0},arrowTailOffset:{x:0,y:0},headOffset:0,excRight:0,excLeft:0,excUp:0,excDown:0,startPoints:[],endPoints:[],mainDivPos:{x:0,y:0},xSign:1,ySign:1,lineLength:0,fHeadSize:1,fTailSize:1,arrowPath:"",labelStartPos:{x:0,y:0},labelMiddlePos:{x:0,y:0},labelEndPos:{x:0,y:0}}),It=_r[0],Bt=_r[1];P.useLayoutEffect(function(){if(xr.current){var kr=K.getPosition(Z,ue);Bt(kr),xr.current=!1}});var ur=It.x2-It.arrowHeadOffset.x,Vn=It.y2-It.arrowHeadOffset.y,gn=It.x1-It.arrowTailOffset.x,yn=It.y1-It.arrowTailOffset.y,Dr=Ve.strokeLen+Ve.nonStrokeLen,Nr=1;Ve.animation<0&&(Ve.animation*=-1,Nr=-1);var wn,jn,$r,Cr,Ir=0;return ze&&Pr==!1?(typeof ze=="boolean"&&(ze=1),jn=ze+"s",wn=It.lineLength,Cr=It.lineLength,$r=1,ze<0&&(ee=[Ir,Cr],Cr=ee[0],Ir=ee[1],jn=ze*-1+"s")):(wn=Ve.strokeLen+" "+Ve.nonStrokeLen,jn=1/Ve.animation+"s",Cr=Dr*Nr,$r="indefinite",Ir=0),P.useLayoutEffect(function(){ae.current&&Bt(function(kr){var Er,Nn;return m(m({},kr),{lineLength:(Nn=(Er=ae.current)===null||Er===void 0?void 0:Er.getTotalLength())!==null&&Nn!==void 0?Nn:0})})},[ae.current]),P.useEffect(function(){var kr=function(){window.addEventListener("resize",Ar);var Nn=function(){var qr,Fr;zr(!0),(qr=le.current)===null||qr===void 0||qr.beginElement(),(Fr=te.current)===null||Fr===void 0||Fr.beginElement()},Hr=function(){return ce.current.style.opacity="0"};return me.current&&ce.current&&(me.current.addEventListener("endEvent",Nn),me.current.addEventListener("beginEvent",Hr)),function(){window.removeEventListener("resize",Ar),me.current&&(me.current.removeEventListener("endEvent",Nn),ce.current&&me.current.removeEventListener("beginEvent",Hr))}},Er=kr();return function(){zr(!1),Er()}},[De]),P.default.createElement("div",m({},rt,{style:m({position:"absolute",zIndex:Et},lr)}),De?P.default.createElement(P.default.Fragment,null,P.default.createElement("svg",m({ref:fe,width:It.cw,height:It.ch,style:m({position:"absolute",left:It.cx0,top:It.cy0,pointerEvents:"none",border:er?"1px dashed yellow":null},ir),overflow:"auto"},Lt),P.default.createElement("path",m({ref:ae,d:It.arrowPath,stroke:oe,strokeDasharray:wn,strokeWidth:Ae,fill:"transparent",pointerEvents:"visibleStroke"},Ze,Ue),P.default.createElement(P.default.Fragment,null,Pr?P.default.createElement(P.default.Fragment,null,Ve.animation?P.default.createElement("animate",{ref:te,attributeName:"stroke-dashoffset",values:Dr*Nr+";0",dur:1/Ve.animation+"s",repeatCount:"indefinite"}):null):P.default.createElement(P.default.Fragment,null,ze?P.default.createElement("animate",{ref:me,id:"svgEndAnimate",attributeName:"stroke-dashoffset",values:Cr+";"+Ir,dur:jn,repeatCount:$r}):null))),Te?P.default.createElement("g",m({fill:Ee,pointerEvents:"auto",transform:"translate("+gn+","+yn+") rotate("+It.tailOrient+") scale("+It.fTailSize+")"},Ze,or),Ce.svgElem):null,je?P.default.createElement("g",m({ref:ce,fill:ye,pointerEvents:"auto",transform:"translate("+ur+","+Vn+") rotate("+It.headOrient+") scale("+It.fHeadSize+")",opacity:ze&&!Pr?0:1},Ze,qt),P.default.createElement("animate",{ref:le,dur:"0.4",attributeName:"opacity",from:"0",to:"1",begin:"indefinite",repeatCount:"0",fill:"freeze"}),Pe.svgElem):null,er?P.default.createElement(P.default.Fragment,null,P.default.createElement("circle",{r:"5",cx:It.cpx1,cy:It.cpy1,fill:"green"}),P.default.createElement("circle",{r:"5",cx:It.cpx2,cy:It.cpy2,fill:"blue"}),P.default.createElement("rect",{x:It.excLeft,y:It.excUp,width:It.absDx,height:It.absDy,fill:"none",stroke:"pink",strokeWidth:"2px"})):null),he.start?P.default.createElement("div",{style:{transform:It.dx<0?"translate(-100% , -50%)":"translate(-0% , -50%)",width:"max-content",position:"absolute",left:It.cx0+It.labelStartPos.x,top:It.cy0+It.labelStartPos.y-Ae-5}},he.start):null,he.middle?P.default.createElement("div",{style:{display:"table",width:"max-content",transform:"translate(-50% , -50%)",position:"absolute",left:It.cx0+It.labelMiddlePos.x,top:It.cy0+It.labelMiddlePos.y}},he.middle):null,he.end?P.default.createElement("div",{style:{transform:It.dx>0?"translate(-100% , -50%)":"translate(-0% , -50%)",width:"max-content",position:"absolute",left:It.cx0+It.labelEndPos.x,top:It.cy0+It.labelEndPos.y+Ae+5}},he.end):null,er?P.default.createElement(P.default.Fragment,null,T(T([],It.startPoints),It.endPoints).map(function(kr,Er){return P.default.createElement("div",{key:Er,style:{background:"gray",opacity:.5,borderRadius:"50%",transform:"translate(-50%, -50%)",height:5,width:5,position:"absolute",left:kr.x-It.mainDivPos.x,top:kr.y-It.mainDivPos.y}})})):null):null)};W.propTypes=j.default,d.default=W},"./src/Xarrow/anchors.ts":function(c,d,p){c=p.nmd(c),Object.defineProperty(d,"__esModule",{value:!0}),d.calcAnchors=void 0;var m=function(b,E){return{middle:{x:b*.5,y:E*.5},left:{x:0,y:E*.5},right:{x:b,y:E*.5},top:{x:b*.5,y:0},bottom:{x:b*.5,y:E}}},y=function(b,E){return b.map(function(T){var S=m(E.right-E.x,E.bottom-E.y),P=S[T.position],A=P.x,I=P.y;return{x:E.x+A+T.offset.x,y:E.y+I+T.offset.y,anchor:T}})};d.calcAnchors=y,p.c[p.s]},"./src/Xarrow/propTypes.ts":function(c,d,p){var m=this&&this.__importDefault||function(ue){return ue&&ue.__esModule?ue:{default:ue}};Object.defineProperty(d,"__esModule",{value:!0});var y=m(p("prop-types")),b=p("./src/constants.tsx"),E=y.default.oneOf(b.cAnchorEdge),T=y.default.exact({position:E.isRequired,offset:y.default.exact({x:y.default.number,y:y.default.number}).isRequired}),S=y.default.oneOfType([E,T]),P=y.default.oneOfType([S,y.default.arrayOf(S)]),A=y.default.oneOfType([y.default.string,y.default.exact({current:y.default.any})]),I=y.default.oneOfType([y.default.element,y.default.string]),j=y.default.exact({start:I,middle:I,end:I}),K=y.default.oneOf(Object.keys(b.arrowShapes)),W=y.default.any,H=y.default.oneOfType([K,y.default.exact({svgElem:W,offsetForward:y.default.number}).isRequired]),ee={start:A.isRequired,end:A.isRequired,startAnchor:P,endAnchor:P,labels:y.default.oneOfType([I,j]),color:y.default.string,lineColor:y.default.string,showHead:y.default.bool,headColor:y.default.string,headSize:y.default.number,tailSize:y.default.number,tailColor:y.default.string,strokeWidth:y.default.number,showTail:y.default.bool,path:y.default.oneOf(b.cPaths),showXarrow:y.default.bool,curveness:y.default.number,gridBreak:y.default.string,dashness:y.default.oneOfType([y.default.bool,y.default.object]),headShape:H,tailShape:H,animateDrawing:y.default.oneOfType([y.default.bool,y.default.number]),zIndex:y.default.number,passProps:y.default.object,arrowBodyProps:y.default.object,arrowHeadProps:y.default.object,arrowTailProps:y.default.object,SVGcanvasProps:y.default.object,divContainerProps:y.default.object,_extendSVGcanvas:y.default.number,_debug:y.default.bool,_cpx1Offset:y.default.number,_cpy1Offset:y.default.number,_cpx2Offset:y.default.number,_cpy2Offset:y.default.number};d.default=ee},"./src/Xarrow/useXarrowProps.ts":function(c,d,p){var m=this&&this.__assign||function(){return m=Object.assign||function(Pe){for(var Ce,De=1,ze=arguments.length;De<ze;De++){Ce=arguments[De];for(var Et in Ce)Object.prototype.hasOwnProperty.call(Ce,Et)&&(Pe[Et]=Ce[Et])}return Pe},m.apply(this,arguments)},y=this&&this.__createBinding||(Object.create?function(Pe,Ce,De,ze){ze===void 0&&(ze=De),Object.defineProperty(Pe,ze,{enumerable:!0,get:function(){return Ce[De]}})}:function(Pe,Ce,De,ze){ze===void 0&&(ze=De),Pe[ze]=Ce[De]}),b=this&&this.__setModuleDefault||(Object.create?function(Pe,Ce){Object.defineProperty(Pe,"default",{enumerable:!0,value:Ce})}:function(Pe,Ce){Pe.default=Ce}),E=this&&this.__importStar||function(Pe){if(Pe&&Pe.__esModule)return Pe;var Ce={};if(Pe!=null)for(var De in Pe)De!=="default"&&Object.prototype.hasOwnProperty.call(Pe,De)&&y(Ce,Pe,De);return b(Ce,Pe),Ce},T=this&&this.__importDefault||function(Pe){return Pe&&Pe.__esModule?Pe:{default:Pe}};Object.defineProperty(d,"__esModule",{value:!0});var S=E(p("react")),P=p("./src/Xarrow/utils/index.ts"),A=T(p("lodash")),I=p("./src/constants.tsx"),j=function(Pe){var Ce={start:null,middle:null,end:null};if(Pe)if(typeof Pe=="string"||S.default.isValidElement(Pe))Ce.middle=Pe;else for(var De in Pe)Ce[De]=Pe[De];return Ce},K=function(Pe){var Ce=Array.isArray(Pe)?Pe:[Pe],De=Ce.map(function(Ze){return typeof Ze=="string"?{position:Ze}:Ze});De=De.filter(function(Ze){return I.cAnchorEdge.includes(Ze.position)}),De.length==0&&(De=[{position:"auto"}]);var ze=De.filter(function(Ze){return Ze.position==="auto"});ze.length>0&&(De=De.filter(function(Ze){return Ze.position!=="auto"}),De.push.apply(De,ze.flatMap(function(Ze){return["left","right","top","bottom"].map(function(Ue){return m(m({},Ze),{position:Ue})})})));var Et=De.map(function(Ze){if(typeof Ze=="object"){var Ue=Ze;return Ue.position||(Ue.position="auto"),Ue.offset||(Ue.offset={x:0,y:0}),Ue.offset.y||(Ue.offset.y=0),Ue.offset.x||(Ue.offset.x=0),Ue=Ue,Ue}else return Ze});return Et},W=function(Pe,Ce){var De=0,ze=0,Et,Ze=1;return typeof Pe=="object"?(De=Pe.strokeLen||Ce.strokeWidth*2,ze=Pe.strokeLen?Pe.nonStrokeLen:Ce.strokeWidth,Et=Pe.animation?Pe.animation:null):typeof Pe=="boolean"&&Pe&&(De=Ce.strokeWidth*2,ze=Ce.strokeWidth,Et=null),{strokeLen:De,nonStrokeLen:ze,animation:Et,animDirection:Ze}},H=function(Pe){return typeof Pe=="string"&&(Pe in I.arrowShapes?Pe=I.arrowShapes[Pe]:(console.warn("'"+Pe+"' is not supported arrow shape. the supported arrow shapes is one of "+I.cArrowShapes+`.
           reverting to default shape.`),Pe=I.arrowShapes.arrow1)),Pe=Pe,(Pe==null?void 0:Pe.offsetForward)===void 0&&(Pe.offsetForward=.25),(Pe==null?void 0:Pe.svgElem)===void 0&&(Pe.svgElem="path"),Pe},ee=function(Pe){var Ce=P.xStr2absRelative(Pe);return Ce||(Ce={relative:.5,abs:0}),Ce},ue=function(Pe,Ce){return Ce&&(Ce.current=!0),Pe},de=function(Pe){return Pe},fe=function(Pe,Ce,De){return ue(Pe,De)},ae=function(Pe,Ce,De){return ue(Number(Pe),De)},ce=function(Pe){return Number(Pe)},me={start:function(Pe){return P.getElementByPropGiven(Pe)},end:function(Pe){return P.getElementByPropGiven(Pe)},startAnchor:function(Pe,Ce,De){return ue(K(Pe),De)},endAnchor:function(Pe,Ce,De){return ue(K(Pe),De)},labels:function(Pe){return j(Pe)},color:de,lineColor:function(Pe,Ce){return Pe||Ce.color},headColor:function(Pe,Ce){return Pe||Ce.color},tailColor:function(Pe,Ce){return Pe||Ce.color},strokeWidth:ae,showHead:fe,headSize:ae,showTail:fe,tailSize:ae,path:fe,curveness:ae,gridBreak:function(Pe,Ce,De){return ue(ee(Pe),De)},dashness:function(Pe,Ce){return W(Pe,Ce)},headShape:function(Pe){return H(Pe)},tailShape:function(Pe){return H(Pe)},showXarrow:de,animateDrawing:de,zIndex:ce,passProps:de,arrowBodyProps:fe,arrowHeadProps:fe,arrowTailProps:fe,SVGcanvasProps:fe,divContainerProps:fe,divContainerStyle:fe,SVGcanvasStyle:fe,_extendSVGcanvas:fe,_debug:fe,_cpx1Offset:fe,_cpy1Offset:fe,_cpx2Offset:fe,_cpy2Offset:fe},te={};for(var le in me)te[le]=[le];for(var Z=0,Y=["lineColor","headColor","tailColor"];Z<Y.length;Z++){var le=Y[Z];te[le].push("color")}var he=function(Pe,Ce){for(var De,ze=0,Et=Object.entries(Pe);ze<Et.length;ze++){var Ze=Et[ze],Ue=Ze[0],qt=Ze[1];Ce[Ue]=(De=me==null?void 0:me[Ue])===null||De===void 0?void 0:De.call(me,qt,Ce)}return Ce},oe={start:null,end:null,startAnchor:"auto",endAnchor:"auto",labels:null,color:"CornflowerBlue",lineColor:null,headColor:null,tailColor:null,strokeWidth:4,showHead:!0,headSize:6,showTail:!1,tailSize:6,path:"smooth",curveness:.8,gridBreak:"50%",dashness:!1,headShape:"arrow1",tailShape:"arrow1",showXarrow:!0,animateDrawing:!1,zIndex:0,passProps:{},arrowBodyProps:{},arrowHeadProps:{},arrowTailProps:{},SVGcanvasProps:{},divContainerProps:{},divContainerStyle:{},SVGcanvasStyle:{},_extendSVGcanvas:0,_debug:!1,_cpx1Offset:0,_cpy1Offset:0,_cpx2Offset:0,_cpy2Offset:0},ye={};ye=he(oe,ye);var Ee={startPos:{x:0,y:0,right:0,bottom:0},endPos:{x:0,y:0,right:0,bottom:0}};function Ae(Pe,Ce){return A.default.isEqual(Pe,Ce)}function je(Pe){var Ce=S.useRef();return Ae(Pe,Ce.current)||(Ce.current=Pe),Ce.current}function Te(Pe,Ce){S.useLayoutEffect(Pe,Ce.map(je))}var Ve=function(Pe,Ce){var De=S.useState(ye),ze=De[0],Et=De[1],Ze=S.useRef(!1);ze.shouldUpdatePosition=Ze;var Ue=m(m({},oe),Pe),qt=function(xr){S.useLayoutEffect(function(){var br;ze[xr]=(br=me==null?void 0:me[xr])===null||br===void 0?void 0:br.call(me,Ue[xr],ze,Ze),Et(m({},ze))},te[xr].map(function(br){return Pe[br]}))};for(var or in oe)qt(or);var Lt=S.useState(Ee),rt=Lt[0],lr=Lt[1],ir=P.getElemPos(ze.start);Te(function(){rt.startPos=ir,Ze.current=!0,lr(m({},rt))},[ir]);var er=P.getElemPos(ze.end);return Te(function(){rt.endPos=er,Ze.current=!0,lr(m({},rt))},[er]),S.useLayoutEffect(function(){Ze.current=!0,lr(m({},rt))},[ze.headShape.svgElem,ze.tailShape.svgElem]),[ze,rt]};d.default=Ve},"./src/Xarrow/utils/GetPosition.tsx":function(c,d,p){var m=this&&this.__importDefault||function(A){return A&&A.__esModule?A:{default:A}};Object.defineProperty(d,"__esModule",{value:!0}),d.getPosition=void 0;var y=p("./src/Xarrow/anchors.ts"),b=p("./src/Xarrow/utils/index.ts"),E=m(p("lodash")),T=p("./src/constants.tsx"),S=p("./src/Xarrow/utils/buzzier.js"),P=function(A,I){var j,K,W,H,ee=A[0],ue=A[1],de=ee.startAnchor,fe=ee.endAnchor,ae=ee.strokeWidth,ce=ee.showHead,me=ee.headSize,te=ee.showTail,le=ee.tailSize,Z=ee.path,Y=ee.curveness,he=ee.gridBreak,oe=ee.headShape,ye=ee.tailShape,Ee=ee._extendSVGcanvas,Ae=ee._cpx1Offset,je=ee._cpy1Offset,Te=ee._cpx2Offset,Ve=ee._cpy2Offset,Pe=ue.startPos,Ce=ue.endPos,De=I.current,ze=De.svgRef,Et=De.lineRef,Ze=0,Ue=0,qt=y.calcAnchors(de,Pe),or=y.calcAnchors(fe,Ce),Lt=b.getShortestLine(qt,or),rt=Lt.chosenStart,lr=Lt.chosenEnd,ir=rt.anchor.position,er=lr.anchor.position,xr=E.default.pick(rt,["x","y"]),br=E.default.pick(lr,["x","y"]),Pr=b.getSvgPos(ze),zr=Math.min(xr.x,br.x)-Pr.x,pr=Math.min(xr.y,br.y)-Pr.y,dr=br.x-xr.x,Ar=br.y-xr.y,_r=Math.abs(br.x-xr.x),It=Math.abs(br.y-xr.y),Bt=dr>0?1:-1,ur=Ar>0?1:-1,Vn=[oe.offsetForward,ye.offsetForward],gn=Vn[0],yn=Vn[1],Dr=me*ae,Nr=le*ae,wn=0,jn=0,$r=0,Cr=0,Ir=Dr*gn,kr=Nr*yn,Er=Number(Y);T.cPaths.includes(Z)||(Z="smooth"),Z==="straight"&&(Er=0,Z="smooth");var Nn=me>le?me:le,Hr=ae+ae*Nn/2,qr=Hr,Fr=Hr,Dn=Hr,yr=Hr;Fr+=Number(Ee),qr+=Number(Ee),Dn+=Number(Ee),yr+=Number(Ee);var Wr=0,vr=_r,jr=0,Qr=It;if(dr<0&&(j=[vr,Wr],Wr=j[0],vr=j[1]),Ar<0&&(K=[Qr,jr],jr=K[0],Qr=K[1]),Er===0){var xn=Math.atan(It/_r);ce&&(vr-=Dr*(1-gn)*Bt*Math.cos(xn),Qr-=Dr*(1-gn)*ur*Math.sin(xn),xn*=ur,Bt<0&&(xn=(Math.PI-xn*Bt)*Bt),wn=Math.cos(xn)*Ir-Math.sin(xn)*Dr/2,jn=Math.cos(xn)*Dr/2+Math.sin(xn)*Ir,Ze=xn*180/Math.PI);var Lr=Math.atan(It/_r);te&&(Wr+=Nr*(1-yn)*Bt*Math.cos(Lr),jr+=Nr*(1-yn)*ur*Math.sin(Lr),Lr*=-ur,Bt>0&&(Lr=(Math.PI-Lr*Bt)*Bt),$r=Math.cos(Lr)*kr-Math.sin(Lr)*Nr/2,Cr=Math.cos(Lr)*Nr/2+Math.sin(Lr)*kr,Ue=Lr*180/Math.PI)}else er==="middle"&&(_r>It?er=Bt?"left":"right":er=ur?"top":"bottom"),ce&&(["left","right"].includes(er)?(wn+=Ir*Bt,vr-=Dr*(1-gn)*Bt,jn+=Dr*Bt/2,er==="left"?(Ze=0,Bt<0&&(Ze+=180)):(Ze=180,Bt>0&&(Ze+=180))):["top","bottom"].includes(er)&&(wn+=Dr*-ur/2,jn+=Ir*ur,Qr-=Dr*ur-jn,er==="top"?(Ze=270,ur>0&&(Ze+=180)):(Ze=90,ur<0&&(Ze+=180))));te&&Er!==0&&(["left","right"].includes(ir)?($r+=kr*-Bt,Wr+=Nr*Bt+$r,Cr+=-(Nr*Bt)/2,ir==="left"?(Ue=180,Bt<0&&(Ue+=180)):(Ue=0,Bt>0&&(Ue+=180))):["top","bottom"].includes(ir)&&(Cr+=kr*-ur,jr+=Nr*ur+Cr,$r+=Nr*ur/2,ir==="top"?(Ue=90,ur>0&&(Ue+=180)):(Ue=270,ur<0&&(Ue+=180))));var _s={x:wn,y:jn},Hs={x:$r,y:Cr},Bn=Wr,Hn=jr,Tn=vr,Mn=Qr,os={};Z==="smooth"?os={hh:function(){Bn+=_r*Er*Bt,Tn-=_r*Er*Bt},vv:function(){Hn+=It*Er*ur,Mn-=It*Er*ur},hv:function(){Bn+=_r*Er*Bt,Mn-=It*Er*ur},vh:function(){Hn+=It*Er*ur,Tn-=_r*Er*Bt}}:Z==="grid"&&(os={hh:function(){Bn+=(_r*he.relative+he.abs)*Bt,Tn-=(_r*(1-he.relative)-he.abs)*Bt,ce&&(Bn-=Dr*(1-gn)/2*Bt,Tn+=Dr*(1-gn)/2*Bt),te&&(Bn-=Nr*(1-yn)/2*Bt,Tn+=Nr*(1-yn)/2*Bt)},vv:function(){Hn+=(It*he.relative+he.abs)*ur,Mn-=(It*(1-he.relative)-he.abs)*ur,ce&&(Hn-=Dr*(1-gn)/2*ur,Mn+=Dr*(1-gn)/2*ur),te&&(Hn-=Nr*(1-yn)/2*ur,Mn+=Nr*(1-yn)/2*ur)},hv:function(){Bn=vr},vh:function(){Hn=Qr}});var es="";["left","right"].includes(ir)?es+="h":["bottom","top"].includes(ir)?es+="v":ir==="middle"&&(es+="m"),["left","right"].includes(er)?es+="h":["bottom","top"].includes(er)?es+="v":er==="middle"&&(es+="m"),_r>It?es=es.replace(/m/g,"h"):es=es.replace(/m/g,"v"),os[es](),Bn+=Ae,Hn+=je,Tn+=Te,Mn+=Ve;var ci=S.buzzierMinSols(Wr,Bn,Tn,vr),ti=ci[0],Se=ci[1],We=S.buzzierMinSols(jr,Hn,Mn,Qr),et=We[0],Ye=We[1];ti<0&&(Fr+=-ti),Se>_r&&(qr+=Se-_r),et<0&&(Dn+=-et),Ye>It&&(yr+=Ye-It),Z==="grid"&&(Fr+=Hr,qr+=Hr,Dn+=Hr,yr+=Hr),Wr+=Fr,vr+=Fr,jr+=Dn,Qr+=Dn,Bn+=Fr,Tn+=Fr,Hn+=Dn,Mn+=Dn;var Xe=_r+Fr+qr,qe=It+Dn+yr;zr-=Fr,pr-=Dn;var kt=S.bzFunction(Wr,Bn,Tn,vr),Wt=S.bzFunction(jr,Hn,Mn,Qr),cr={x:kt(.01),y:Wt(.01)},nr={x:kt(.5),y:Wt(.5)},Kr={x:kt(.99),y:Wt(.99)},un;return Z==="grid"?un="M "+Wr+" "+jr+" L  "+Bn+" "+Hn+" L "+Tn+" "+Mn+" "+vr+" "+Qr:Z==="smooth"&&(un="M "+Wr+" "+jr+" C "+Bn+" "+Hn+", "+Tn+" "+Mn+", "+vr+" "+Qr),{cx0:zr,cy0:pr,x1:Wr,x2:vr,y1:jr,y2:Qr,cw:Xe,ch:qe,cpx1:Bn,cpy1:Hn,cpx2:Tn,cpy2:Mn,dx:dr,dy:Ar,absDx:_r,absDy:It,headOrient:Ze,tailOrient:Ue,labelStartPos:cr,labelMiddlePos:nr,labelEndPos:Kr,excLeft:Fr,excRight:qr,excUp:Dn,excDown:yr,headOffset:Ir,arrowHeadOffset:_s,arrowTailOffset:Hs,startPoints:qt,endPoints:or,mainDivPos:Pr,xSign:Bt,ySign:ur,lineLength:(H=(W=Et.current)===null||W===void 0?void 0:W.getTotalLength())!==null&&H!==void 0?H:0,fHeadSize:Dr,fTailSize:Nr,arrowPath:un}};d.getPosition=P},"./src/Xarrow/utils/index.ts":function(c,d){Object.defineProperty(d,"__esModule",{value:!0}),d.getSvgPos=d.getElemPos=d.getShortestLine=d.xStr2absRelative=d.factorDpathStr=d.getElementByPropGiven=void 0;var p=function(P){var A;return typeof P=="string"?A=document.getElementById(P):A=P==null?void 0:P.current,A};d.getElementByPropGiven=p;var m=function(P,A){var I=P.split(/(\d+(?:\.\d+)?)/);return I=I.map(function(j){return Number(j)?(Number(j)*A).toString():j}),I.join("")};d.factorDpathStr=m;var y=function(P){if(typeof P!="string")return{abs:0,relative:.5};var A=P.split("%"),I=0,j=0;if(A.length==1){var K=parseFloat(A[0]);if(!isNaN(K))return I=K,{abs:I,relative:0}}else if(A.length==2){var W=[parseFloat(A[0]),parseFloat(A[1])],H=W[0],ee=W[1];if(isNaN(H)||(j=H/100),isNaN(ee)||(I=ee),!isNaN(H)||!isNaN(ee))return{abs:I,relative:j}}};d.xStr2absRelative=y;var b=function(P,A){return Math.sqrt(Math.pow(P.x-A.x,2)+Math.pow(P.y-A.y,2))},E=function(P,A){var I=1/0,j=1/0,K;return P.forEach(function(W){A.forEach(function(H){j=b(W,H),j<I&&(I=j,K={chosenStart:W,chosenEnd:H})})}),K};d.getShortestLine=E;var T=function(P){if(!P)return{x:0,y:0,right:0,bottom:0};var A=P.getBoundingClientRect();return{x:A.left,y:A.top,right:A.right,bottom:A.bottom}};d.getElemPos=T;var S=function(P){if(!P.current)return{x:0,y:0};var A=P.current.getBoundingClientRect(),I=A.left,j=A.top,K=getComputedStyle(P.current),W=Number(K.left.slice(0,-2)),H=Number(K.top.slice(0,-2));return{x:I-W,y:j-H}};d.getSvgPos=S},"./src/Xwrapper.tsx":function(c,d,p){var m=this&&this.__createBinding||(Object.create?function(j,K,W,H){H===void 0&&(H=W),Object.defineProperty(j,H,{enumerable:!0,get:function(){return K[W]}})}:function(j,K,W,H){H===void 0&&(H=W),j[H]=K[W]}),y=this&&this.__setModuleDefault||(Object.create?function(j,K){Object.defineProperty(j,"default",{enumerable:!0,value:K})}:function(j,K){j.default=K}),b=this&&this.__importStar||function(j){if(j&&j.__esModule)return j;var K={};if(j!=null)for(var W in j)W!=="default"&&Object.prototype.hasOwnProperty.call(j,W)&&m(K,j,W);return y(K,j),K};Object.defineProperty(d,"__esModule",{value:!0}),d.XarrowContext=d.XelemContext=void 0;var E=b(p("react"));d.XelemContext=E.default.createContext(null),d.XarrowContext=E.default.createContext(null);var T={},S=0,P=function(j){var K=j.children,W=j.instanceCount,H=E.useState({}),ee=H[1],ue=function(){return ee({})};return E.useEffect(function(){W.current=S,T[W.current]=ue},[]),E.default.createElement(d.XarrowContext.Provider,{value:ue},K)},A=function(j){var K=j.children,W=j.instanceCount;return E.default.createElement(d.XelemContext.Provider,{value:T[W.current]},K)},I=function(j){var K=j.children,W=E.useRef(S),H=E.useState({}),ee=H[1];return E.useEffect(function(){return S++,ee({}),function(){delete T[W.current]}},[]),E.default.createElement(A,{instanceCount:W},E.default.createElement(P,{instanceCount:W},K))};d.default=I},"./src/constants.tsx":function(c,d,p){var m=this&&this.__importDefault||function(b){return b&&b.__esModule?b:{default:b}};Object.defineProperty(d,"__esModule",{value:!0}),d.cArrowShapes=d.arrowShapes=d.cSvgElems=d.cPaths=d.cAnchorEdge=void 0;var y=m(p("react"));d.cAnchorEdge=["middle","left","right","top","bottom","auto"],d.cPaths=["smooth","grid","straight"],d.cSvgElems=["circle","ellipse","line","path","polygon","polyline","rect"],d.arrowShapes={arrow1:{svgElem:y.default.createElement("path",{d:"M 0 0 L 1 0.5 L 0 1 L 0.25 0.5 z"}),offsetForward:.25},heart:{svgElem:y.default.createElement("path",{d:"M 0,0.25 A 0.125,0.125 0,0,1 0.5,0.25 A 0.125,0.125 0,0,1 1,0.25 Q 1,0.625 0.5,1 Q 0,0.625 0,0.25 z"}),offsetForward:.1},circle:{svgElem:y.default.createElement("circle",{r:.5,cx:.5,cy:.5}),offsetForward:0}},d.cArrowShapes=Object.keys(d.arrowShapes)},"./src/index.tsx":function(c,d,p){var m=this&&this.__createBinding||(Object.create?function(P,A,I,j){j===void 0&&(j=I),Object.defineProperty(P,j,{enumerable:!0,get:function(){return A[I]}})}:function(P,A,I,j){j===void 0&&(j=I),P[j]=A[I]}),y=this&&this.__exportStar||function(P,A){for(var I in P)I!=="default"&&!Object.prototype.hasOwnProperty.call(A,I)&&m(A,P,I)},b=this&&this.__importDefault||function(P){return P&&P.__esModule?P:{default:P}};Object.defineProperty(d,"__esModule",{value:!0}),d.useXarrow=d.Xwrapper=d.default=void 0;var E=p("./src/Xarrow/Xarrow.tsx");Object.defineProperty(d,"default",{enumerable:!0,get:function(){return b(E).default}}),y(p("./src/types.ts"),d),y(p("./src/constants.tsx"),d);var T=p("./src/Xwrapper.tsx");Object.defineProperty(d,"Xwrapper",{enumerable:!0,get:function(){return b(T).default}});var S=p("./src/useXarrow.tsx");Object.defineProperty(d,"useXarrow",{enumerable:!0,get:function(){return b(S).default}})},"./src/types.ts":function(c,d){Object.defineProperty(d,"__esModule",{value:!0})},"./src/useXarrow.tsx":function(c,d,p){Object.defineProperty(d,"__esModule",{value:!0});var m=p("react"),y=p("./src/Xwrapper.tsx"),b=function(){var E=m.useState({}),T=E[1],S=function(){return T({})},P=m.useContext(y.XelemContext);return P||(P=function(){}),m.useLayoutEffect(function(){P()}),S};d.default=b},lodash:function(c){c.exports=n},"prop-types":function(c){c.exports=s},react:function(c){c.exports=r}},o={};function l(c){var d=o[c];if(d!==void 0)return d.exports;var p=o[c]={id:c,loaded:!1,exports:{}};return a[c].call(p.exports,p,p.exports,l),p.loaded=!0,p.exports}l.c=o,function(){l.d=function(c,d){for(var p in d)l.o(d,p)&&!l.o(c,p)&&Object.defineProperty(c,p,{enumerable:!0,get:d[p]})}}(),function(){l.o=function(c,d){return Object.prototype.hasOwnProperty.call(c,d)}}(),function(){l.r=function(c){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})}}(),function(){l.nmd=function(c){return c.paths=[],c.children||(c.children=[]),c}}();var u=l(l.s="./src/index.tsx");return u}()})}(lib$1)),lib$1.exports}var libExports=requireLib();const Xarrow=getDefaultExportFromCjs(libExports),canUseDOM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function isWindow(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function isNode$3(t){return"nodeType"in t}function getWindow$1(t){var e,r;return t?isWindow(t)?t:isNode$3(t)&&(e=(r=t.ownerDocument)==null?void 0:r.defaultView)!=null?e:window:window}function isDocument(t){const{Document:e}=getWindow$1(t);return t instanceof e}function isHTMLElement$1(t){return isWindow(t)?!1:t instanceof getWindow$1(t).HTMLElement}function isSVGElement(t){return t instanceof getWindow$1(t).SVGElement}function getOwnerDocument(t){return t?isWindow(t)?t.document:isNode$3(t)?isDocument(t)?t:isHTMLElement$1(t)||isSVGElement(t)?t.ownerDocument:document:document:document}const useIsomorphicLayoutEffect$3=canUseDOM?reactExports.useLayoutEffect:reactExports.useEffect;function useEvent(t){const e=reactExports.useRef(t);return useIsomorphicLayoutEffect$3(()=>{e.current=t}),reactExports.useCallback(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return e.current==null?void 0:e.current(...n)},[])}function useInterval(){const t=reactExports.useRef(null),e=reactExports.useCallback((n,s)=>{t.current=setInterval(n,s)},[]),r=reactExports.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,r]}function useLatestValue(t,e){e===void 0&&(e=[t]);const r=reactExports.useRef(t);return useIsomorphicLayoutEffect$3(()=>{r.current!==t&&(r.current=t)},e),r}function useLazyMemo(t,e){const r=reactExports.useRef();return reactExports.useMemo(()=>{const n=t(r.current);return r.current=n,n},[...e])}function useNodeRef(t){const e=useEvent(t),r=reactExports.useRef(null),n=reactExports.useCallback(s=>{s!==r.current&&(e==null||e(s,r.current)),r.current=s},[]);return[r,n]}function usePrevious$1(t){const e=reactExports.useRef();return reactExports.useEffect(()=>{e.current=t},[t]),e.current}let ids={};function useUniqueId$1(t,e){return reactExports.useMemo(()=>{if(e)return e;const r=ids[t]==null?0:ids[t]+1;return ids[t]=r,t+"-"+r},[t,e])}function createAdjustmentFn(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return n.reduce((a,o)=>{const l=Object.entries(o);for(const[u,c]of l){const d=a[u];d!=null&&(a[u]=d+t*c)}return a},{...e})}}const add$1=createAdjustmentFn(1),subtract$1=createAdjustmentFn(-1);function hasViewportRelativeCoordinates(t){return"clientX"in t&&"clientY"in t}function isKeyboardEvent(t){if(!t)return!1;const{KeyboardEvent:e}=getWindow$1(t.target);return e&&t instanceof e}function isTouchEvent(t){if(!t)return!1;const{TouchEvent:e}=getWindow$1(t.target);return e&&t instanceof e}function getEventCoordinates(t){if(isTouchEvent(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:r}=t.touches[0];return{x:e,y:r}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:r}=t.changedTouches[0];return{x:e,y:r}}}return hasViewportRelativeCoordinates(t)?{x:t.clientX,y:t.clientY}:null}const SELECTOR="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function findFirstFocusableNode(t){return t.matches(SELECTOR)?t:t.querySelector(SELECTOR)}const hiddenStyles={display:"none"};function HiddenText(t){let{id:e,value:r}=t;return React.createElement("div",{id:e,style:hiddenStyles},r)}function LiveRegion(t){let{id:e,announcement:r,ariaLiveType:n="assertive"}=t;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return React.createElement("div",{id:e,style:s,role:"status","aria-live":n,"aria-atomic":!0},r)}function useAnnouncement(){const[t,e]=reactExports.useState("");return{announce:reactExports.useCallback(n=>{n!=null&&e(n)},[]),announcement:t}}const DndMonitorContext=reactExports.createContext(null);function useDndMonitor(t){const e=reactExports.useContext(DndMonitorContext);reactExports.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function useDndMonitorProvider(){const[t]=reactExports.useState(()=>new Set),e=reactExports.useCallback(n=>(t.add(n),()=>t.delete(n)),[t]);return[reactExports.useCallback(n=>{let{type:s,event:a}=n;t.forEach(o=>{var l;return(l=o[s])==null?void 0:l.call(o,a)})},[t]),e]}const defaultScreenReaderInstructions={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},defaultAnnouncements={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was moved over droppable area "+r.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:r}=t;return r?"Draggable item "+e.id+" was dropped over droppable area "+r.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function Accessibility(t){let{announcements:e=defaultAnnouncements,container:r,hiddenTextDescribedById:n,screenReaderInstructions:s=defaultScreenReaderInstructions}=t;const{announce:a,announcement:o}=useAnnouncement(),l=useUniqueId$1("DndLiveRegion"),[u,c]=reactExports.useState(!1);if(reactExports.useEffect(()=>{c(!0)},[]),useDndMonitor(reactExports.useMemo(()=>({onDragStart(p){let{active:m}=p;a(e.onDragStart({active:m}))},onDragMove(p){let{active:m,over:y}=p;e.onDragMove&&a(e.onDragMove({active:m,over:y}))},onDragOver(p){let{active:m,over:y}=p;a(e.onDragOver({active:m,over:y}))},onDragEnd(p){let{active:m,over:y}=p;a(e.onDragEnd({active:m,over:y}))},onDragCancel(p){let{active:m,over:y}=p;a(e.onDragCancel({active:m,over:y}))}}),[a,e])),!u)return null;const d=React.createElement(React.Fragment,null,React.createElement(HiddenText,{id:n,value:s.draggable}),React.createElement(LiveRegion,{id:l,announcement:o}));return r?reactDomExports.createPortal(d,r):d}var Action;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Action||(Action={}));function noop$5(){}const defaultCoordinates=Object.freeze({x:0,y:0});function sortCollisionsDesc(t,e){let{data:{value:r}}=t,{data:{value:n}}=e;return n-r}function getFirstCollision(t,e){if(!t||t.length===0)return null;const[r]=t;return r[e]}function getIntersectionRatio(t,e){const r=Math.max(e.top,t.top),n=Math.max(e.left,t.left),s=Math.min(e.left+e.width,t.left+t.width),a=Math.min(e.top+e.height,t.top+t.height),o=s-n,l=a-r;if(n<s&&r<a){const u=e.width*e.height,c=t.width*t.height,d=o*l,p=d/(u+c-d);return Number(p.toFixed(4))}return 0}const rectIntersection=t=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=t;const s=[];for(const a of n){const{id:o}=a,l=r.get(o);if(l){const u=getIntersectionRatio(l,e);u>0&&s.push({id:o,data:{droppableContainer:a,value:u}})}}return s.sort(sortCollisionsDesc)};function adjustScale(t,e,r){return{...t,scaleX:e&&r?e.width/r.width:1,scaleY:e&&r?e.height/r.height:1}}function getRectDelta(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:defaultCoordinates}function createRectAdjustmentFn(t){return function(r){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return s.reduce((o,l)=>({...o,top:o.top+t*l.y,bottom:o.bottom+t*l.y,left:o.left+t*l.x,right:o.right+t*l.x}),{...r})}}const getAdjustedRect=createRectAdjustmentFn(1);function parseTransform(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function inverseTransform(t,e,r){const n=parseTransform(e);if(!n)return t;const{scaleX:s,scaleY:a,x:o,y:l}=n,u=t.left-o-(1-s)*parseFloat(r),c=t.top-l-(1-a)*parseFloat(r.slice(r.indexOf(" ")+1)),d=s?t.width/s:t.width,p=a?t.height/a:t.height;return{width:d,height:p,top:c,right:u+d,bottom:c+p,left:u}}const defaultOptions$3={ignoreTransform:!1};function getClientRect(t,e){e===void 0&&(e=defaultOptions$3);let r=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:c,transformOrigin:d}=getWindow$1(t).getComputedStyle(t);c&&(r=inverseTransform(r,c,d))}const{top:n,left:s,width:a,height:o,bottom:l,right:u}=r;return{top:n,left:s,width:a,height:o,bottom:l,right:u}}function getTransformAgnosticClientRect(t){return getClientRect(t,{ignoreTransform:!0})}function getWindowClientRect(t){const e=t.innerWidth,r=t.innerHeight;return{top:0,left:0,right:e,bottom:r,width:e,height:r}}function isFixed(t,e){return e===void 0&&(e=getWindow$1(t).getComputedStyle(t)),e.position==="fixed"}function isScrollable(t,e){e===void 0&&(e=getWindow$1(t).getComputedStyle(t));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const a=e[s];return typeof a=="string"?r.test(a):!1})}function getScrollableAncestors(t,e){const r=[];function n(s){if(e!=null&&r.length>=e||!s)return r;if(isDocument(s)&&s.scrollingElement!=null&&!r.includes(s.scrollingElement))return r.push(s.scrollingElement),r;if(!isHTMLElement$1(s)||isSVGElement(s)||r.includes(s))return r;const a=getWindow$1(t).getComputedStyle(s);return s!==t&&isScrollable(s,a)&&r.push(s),isFixed(s,a)?r:n(s.parentNode)}return t?n(t):r}function getFirstScrollableAncestor(t){const[e]=getScrollableAncestors(t,1);return e??null}function getScrollableElement(t){return!canUseDOM||!t?null:isWindow(t)?t:isNode$3(t)?isDocument(t)||t===getOwnerDocument(t).scrollingElement?window:isHTMLElement$1(t)?t:null:null}function getScrollXCoordinate(t){return isWindow(t)?t.scrollX:t.scrollLeft}function getScrollYCoordinate(t){return isWindow(t)?t.scrollY:t.scrollTop}function getScrollCoordinates(t){return{x:getScrollXCoordinate(t),y:getScrollYCoordinate(t)}}var Direction;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(Direction||(Direction={}));function isDocumentScrollingElement(t){return!canUseDOM||!t?!1:t===document.scrollingElement}function getScrollPosition(t){const e={x:0,y:0},r=isDocumentScrollingElement(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},n={x:t.scrollWidth-r.width,y:t.scrollHeight-r.height},s=t.scrollTop<=e.y,a=t.scrollLeft<=e.x,o=t.scrollTop>=n.y,l=t.scrollLeft>=n.x;return{isTop:s,isLeft:a,isBottom:o,isRight:l,maxScroll:n,minScroll:e}}const defaultThreshold={x:.2,y:.2};function getScrollDirectionAndSpeed(t,e,r,n,s){let{top:a,left:o,right:l,bottom:u}=r;n===void 0&&(n=10),s===void 0&&(s=defaultThreshold);const{isTop:c,isBottom:d,isLeft:p,isRight:m}=getScrollPosition(t),y={x:0,y:0},b={x:0,y:0},E={height:e.height*s.y,width:e.width*s.x};return!c&&a<=e.top+E.height?(y.y=Direction.Backward,b.y=n*Math.abs((e.top+E.height-a)/E.height)):!d&&u>=e.bottom-E.height&&(y.y=Direction.Forward,b.y=n*Math.abs((e.bottom-E.height-u)/E.height)),!m&&l>=e.right-E.width?(y.x=Direction.Forward,b.x=n*Math.abs((e.right-E.width-l)/E.width)):!p&&o<=e.left+E.width&&(y.x=Direction.Backward,b.x=n*Math.abs((e.left+E.width-o)/E.width)),{direction:y,speed:b}}function getScrollElementRect(t){if(t===document.scrollingElement){const{innerWidth:a,innerHeight:o}=window;return{top:0,left:0,right:a,bottom:o,width:a,height:o}}const{top:e,left:r,right:n,bottom:s}=t.getBoundingClientRect();return{top:e,left:r,right:n,bottom:s,width:t.clientWidth,height:t.clientHeight}}function getScrollOffsets(t){return t.reduce((e,r)=>add$1(e,getScrollCoordinates(r)),defaultCoordinates)}function getScrollXOffset(t){return t.reduce((e,r)=>e+getScrollXCoordinate(r),0)}function getScrollYOffset(t){return t.reduce((e,r)=>e+getScrollYCoordinate(r),0)}function scrollIntoViewIfNeeded(t,e){if(e===void 0&&(e=getClientRect),!t)return;const{top:r,left:n,bottom:s,right:a}=e(t);getFirstScrollableAncestor(t)&&(s<=0||a<=0||r>=window.innerHeight||n>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const properties=[["x",["left","right"],getScrollXOffset],["y",["top","bottom"],getScrollYOffset]];class Rect{constructor(e,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=getScrollableAncestors(r),s=getScrollOffsets(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[a,o,l]of properties)for(const u of o)Object.defineProperty(this,u,{get:()=>{const c=l(n),d=s[a]-c;return this.rect[u]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Listeners{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=e}add(e,r,n){var s;(s=this.target)==null||s.addEventListener(e,r,n),this.listeners.push([e,r,n])}}function getEventListenerTarget(t){const{EventTarget:e}=getWindow$1(t);return t instanceof e?t:getOwnerDocument(t)}function hasExceededDistance(t,e){const r=Math.abs(t.x),n=Math.abs(t.y);return typeof e=="number"?Math.sqrt(r**2+n**2)>e:"x"in e&&"y"in e?r>e.x&&n>e.y:"x"in e?r>e.x:"y"in e?n>e.y:!1}var EventName;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(EventName||(EventName={}));function preventDefault$1(t){t.preventDefault()}function stopPropagation(t){t.stopPropagation()}var KeyboardCode;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(KeyboardCode||(KeyboardCode={}));const defaultKeyboardCodes={start:[KeyboardCode.Space,KeyboardCode.Enter],cancel:[KeyboardCode.Esc],end:[KeyboardCode.Space,KeyboardCode.Enter,KeyboardCode.Tab]},defaultKeyboardCoordinateGetter=(t,e)=>{let{currentCoordinates:r}=e;switch(t.code){case KeyboardCode.Right:return{...r,x:r.x+25};case KeyboardCode.Left:return{...r,x:r.x-25};case KeyboardCode.Down:return{...r,y:r.y+25};case KeyboardCode.Up:return{...r,y:r.y-25}}};class KeyboardSensor{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:r}}=e;this.props=e,this.listeners=new Listeners(getOwnerDocument(r)),this.windowListeners=new Listeners(getWindow$1(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(EventName.Resize,this.handleCancel),this.windowListeners.add(EventName.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(EventName.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:r}=this.props,n=e.node.current;n&&scrollIntoViewIfNeeded(n),r(defaultCoordinates)}handleKeyDown(e){if(isKeyboardEvent(e)){const{active:r,context:n,options:s}=this.props,{keyboardCodes:a=defaultKeyboardCodes,coordinateGetter:o=defaultKeyboardCoordinateGetter,scrollBehavior:l="smooth"}=s,{code:u}=e;if(a.end.includes(u)){this.handleEnd(e);return}if(a.cancel.includes(u)){this.handleCancel(e);return}const{collisionRect:c}=n.current,d=c?{x:c.left,y:c.top}:defaultCoordinates;this.referenceCoordinates||(this.referenceCoordinates=d);const p=o(e,{active:r,context:n.current,currentCoordinates:d});if(p){const m=subtract$1(p,d),y={x:0,y:0},{scrollableAncestors:b}=n.current;for(const E of b){const T=e.code,{isTop:S,isRight:P,isLeft:A,isBottom:I,maxScroll:j,minScroll:K}=getScrollPosition(E),W=getScrollElementRect(E),H={x:Math.min(T===KeyboardCode.Right?W.right-W.width/2:W.right,Math.max(T===KeyboardCode.Right?W.left:W.left+W.width/2,p.x)),y:Math.min(T===KeyboardCode.Down?W.bottom-W.height/2:W.bottom,Math.max(T===KeyboardCode.Down?W.top:W.top+W.height/2,p.y))},ee=T===KeyboardCode.Right&&!P||T===KeyboardCode.Left&&!A,ue=T===KeyboardCode.Down&&!I||T===KeyboardCode.Up&&!S;if(ee&&H.x!==p.x){const de=E.scrollLeft+m.x,fe=T===KeyboardCode.Right&&de<=j.x||T===KeyboardCode.Left&&de>=K.x;if(fe&&!m.y){E.scrollTo({left:de,behavior:l});return}fe?y.x=E.scrollLeft-de:y.x=T===KeyboardCode.Right?E.scrollLeft-j.x:E.scrollLeft-K.x,y.x&&E.scrollBy({left:-y.x,behavior:l});break}else if(ue&&H.y!==p.y){const de=E.scrollTop+m.y,fe=T===KeyboardCode.Down&&de<=j.y||T===KeyboardCode.Up&&de>=K.y;if(fe&&!m.x){E.scrollTo({top:de,behavior:l});return}fe?y.y=E.scrollTop-de:y.y=T===KeyboardCode.Down?E.scrollTop-j.y:E.scrollTop-K.y,y.y&&E.scrollBy({top:-y.y,behavior:l});break}}this.handleMove(e,add$1(subtract$1(p,this.referenceCoordinates),y))}}}handleMove(e,r){const{onMove:n}=this.props;e.preventDefault(),n(r)}handleEnd(e){const{onEnd:r}=this.props;e.preventDefault(),this.detach(),r()}handleCancel(e){const{onCancel:r}=this.props;e.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}KeyboardSensor.activators=[{eventName:"onKeyDown",handler:(t,e,r)=>{let{keyboardCodes:n=defaultKeyboardCodes,onActivation:s}=e,{active:a}=r;const{code:o}=t.nativeEvent;if(n.start.includes(o)){const l=a.activatorNode.current;return l&&t.target!==l?!1:(t.preventDefault(),s==null||s({event:t.nativeEvent}),!0)}return!1}}];function isDistanceConstraint(t){return!!(t&&"distance"in t)}function isDelayConstraint(t){return!!(t&&"delay"in t)}class AbstractPointerSensor{constructor(e,r,n){var s;n===void 0&&(n=getEventListenerTarget(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=r;const{event:a}=e,{target:o}=a;this.props=e,this.events=r,this.document=getOwnerDocument(o),this.documentListeners=new Listeners(this.document),this.listeners=new Listeners(n),this.windowListeners=new Listeners(getWindow$1(o)),this.initialCoordinates=(s=getEventCoordinates(a))!=null?s:defaultCoordinates,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(EventName.Resize,this.handleCancel),this.windowListeners.add(EventName.DragStart,preventDefault$1),this.windowListeners.add(EventName.VisibilityChange,this.handleCancel),this.windowListeners.add(EventName.ContextMenu,preventDefault$1),this.documentListeners.add(EventName.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(isDelayConstraint(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(isDistanceConstraint(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,r){const{active:n,onPending:s}=this.props;s(n,e,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:e}=this,{onStart:r}=this.props;e&&(this.activated=!0,this.documentListeners.add(EventName.Click,stopPropagation,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(EventName.SelectionChange,this.removeTextSelection),r(e))}handleMove(e){var r;const{activated:n,initialCoordinates:s,props:a}=this,{onMove:o,options:{activationConstraint:l}}=a;if(!s)return;const u=(r=getEventCoordinates(e))!=null?r:defaultCoordinates,c=subtract$1(s,u);if(!n&&l){if(isDistanceConstraint(l)){if(l.tolerance!=null&&hasExceededDistance(c,l.tolerance))return this.handleCancel();if(hasExceededDistance(c,l.distance))return this.handleStart()}if(isDelayConstraint(l)&&hasExceededDistance(c,l.tolerance))return this.handleCancel();this.handlePending(l,c);return}e.cancelable&&e.preventDefault(),o(u)}handleEnd(){const{onAbort:e,onEnd:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleCancel(){const{onAbort:e,onCancel:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleKeydown(e){e.code===KeyboardCode.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const events={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class PointerSensor extends AbstractPointerSensor{constructor(e){const{event:r}=e,n=getOwnerDocument(r.target);super(e,events,n)}}PointerSensor.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];const events$1={move:{name:"mousemove"},end:{name:"mouseup"}};var MouseButton;(function(t){t[t.RightClick=2]="RightClick"})(MouseButton||(MouseButton={}));class MouseSensor extends AbstractPointerSensor{constructor(e){super(e,events$1,getOwnerDocument(e.event.target))}}MouseSensor.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;return r.button===MouseButton.RightClick?!1:(n==null||n({event:r}),!0)}}];const events$2={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class TouchSensor extends AbstractPointerSensor{constructor(e){super(e,events$2)}static setup(){return window.addEventListener(events$2.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(events$2.move.name,e)};function e(){}}}TouchSensor.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:r}=t,{onActivation:n}=e;const{touches:s}=r;return s.length>1?!1:(n==null||n({event:r}),!0)}}];var AutoScrollActivator;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(AutoScrollActivator||(AutoScrollActivator={}));var TraversalOrder;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(TraversalOrder||(TraversalOrder={}));function useAutoScroller(t){let{acceleration:e,activator:r=AutoScrollActivator.Pointer,canScroll:n,draggingRect:s,enabled:a,interval:o=5,order:l=TraversalOrder.TreeOrder,pointerCoordinates:u,scrollableAncestors:c,scrollableAncestorRects:d,delta:p,threshold:m}=t;const y=useScrollIntent({delta:p,disabled:!a}),[b,E]=useInterval(),T=reactExports.useRef({x:0,y:0}),S=reactExports.useRef({x:0,y:0}),P=reactExports.useMemo(()=>{switch(r){case AutoScrollActivator.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case AutoScrollActivator.DraggableRect:return s}},[r,s,u]),A=reactExports.useRef(null),I=reactExports.useCallback(()=>{const K=A.current;if(!K)return;const W=T.current.x*S.current.x,H=T.current.y*S.current.y;K.scrollBy(W,H)},[]),j=reactExports.useMemo(()=>l===TraversalOrder.TreeOrder?[...c].reverse():c,[l,c]);reactExports.useEffect(()=>{if(!a||!c.length||!P){E();return}for(const K of j){if((n==null?void 0:n(K))===!1)continue;const W=c.indexOf(K),H=d[W];if(!H)continue;const{direction:ee,speed:ue}=getScrollDirectionAndSpeed(K,H,P,e,m);for(const de of["x","y"])y[de][ee[de]]||(ue[de]=0,ee[de]=0);if(ue.x>0||ue.y>0){E(),A.current=K,b(I,o),T.current=ue,S.current=ee;return}}T.current={x:0,y:0},S.current={x:0,y:0},E()},[e,I,n,E,a,o,JSON.stringify(P),JSON.stringify(y),b,c,j,d,JSON.stringify(m)])}const defaultScrollIntent={x:{[Direction.Backward]:!1,[Direction.Forward]:!1},y:{[Direction.Backward]:!1,[Direction.Forward]:!1}};function useScrollIntent(t){let{delta:e,disabled:r}=t;const n=usePrevious$1(e);return useLazyMemo(s=>{if(r||!n||!s)return defaultScrollIntent;const a={x:Math.sign(e.x-n.x),y:Math.sign(e.y-n.y)};return{x:{[Direction.Backward]:s.x[Direction.Backward]||a.x===-1,[Direction.Forward]:s.x[Direction.Forward]||a.x===1},y:{[Direction.Backward]:s.y[Direction.Backward]||a.y===-1,[Direction.Forward]:s.y[Direction.Forward]||a.y===1}}},[r,e,n])}function useCachedNode(t,e){const r=e!=null?t.get(e):void 0,n=r?r.node.current:null;return useLazyMemo(s=>{var a;return e==null?null:(a=n??s)!=null?a:null},[n,e])}function useCombineActivators(t,e){return reactExports.useMemo(()=>t.reduce((r,n)=>{const{sensor:s}=n,a=s.activators.map(o=>({eventName:o.eventName,handler:e(o.handler,n)}));return[...r,...a]},[]),[t,e])}var MeasuringStrategy;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(MeasuringStrategy||(MeasuringStrategy={}));var MeasuringFrequency;(function(t){t.Optimized="optimized"})(MeasuringFrequency||(MeasuringFrequency={}));const defaultValue=new Map;function useDroppableMeasuring(t,e){let{dragging:r,dependencies:n,config:s}=e;const[a,o]=reactExports.useState(null),{frequency:l,measure:u,strategy:c}=s,d=reactExports.useRef(t),p=T(),m=useLatestValue(p),y=reactExports.useCallback(function(S){S===void 0&&(S=[]),!m.current&&o(P=>P===null?S:P.concat(S.filter(A=>!P.includes(A))))},[m]),b=reactExports.useRef(null),E=useLazyMemo(S=>{if(p&&!r)return defaultValue;if(!S||S===defaultValue||d.current!==t||a!=null){const P=new Map;for(let A of t){if(!A)continue;if(a&&a.length>0&&!a.includes(A.id)&&A.rect.current){P.set(A.id,A.rect.current);continue}const I=A.node.current,j=I?new Rect(u(I),I):null;A.rect.current=j,j&&P.set(A.id,j)}return P}return S},[t,a,r,p,u]);return reactExports.useEffect(()=>{d.current=t},[t]),reactExports.useEffect(()=>{p||y()},[r,p]),reactExports.useEffect(()=>{a&&a.length>0&&o(null)},[JSON.stringify(a)]),reactExports.useEffect(()=>{p||typeof l!="number"||b.current!==null||(b.current=setTimeout(()=>{y(),b.current=null},l))},[l,p,y,...n]),{droppableRects:E,measureDroppableContainers:y,measuringScheduled:a!=null};function T(){switch(c){case MeasuringStrategy.Always:return!1;case MeasuringStrategy.BeforeDragging:return r;default:return!r}}}function useInitialValue(t,e){return useLazyMemo(r=>t?r||(typeof e=="function"?e(t):t):null,[e,t])}function useInitialRect(t,e){return useInitialValue(t,e)}function useMutationObserver(t){let{callback:e,disabled:r}=t;const n=useEvent(e),s=reactExports.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(n)},[n,r]);return reactExports.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function useResizeObserver(t){let{callback:e,disabled:r}=t;const n=useEvent(e),s=reactExports.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(n)},[r]);return reactExports.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function defaultMeasure(t){return new Rect(getClientRect(t),t)}function useRect(t,e,r){e===void 0&&(e=defaultMeasure);const[n,s]=reactExports.useState(null);function a(){s(u=>{if(!t)return null;if(t.isConnected===!1){var c;return(c=u??r)!=null?c:null}const d=e(t);return JSON.stringify(u)===JSON.stringify(d)?u:d})}const o=useMutationObserver({callback(u){if(t)for(const c of u){const{type:d,target:p}=c;if(d==="childList"&&p instanceof HTMLElement&&p.contains(t)){a();break}}}}),l=useResizeObserver({callback:a});return useIsomorphicLayoutEffect$3(()=>{a(),t?(l==null||l.observe(t),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),o==null||o.disconnect())},[t]),n}function useRectDelta(t){const e=useInitialValue(t);return getRectDelta(t,e)}const defaultValue$1=[];function useScrollableAncestors(t){const e=reactExports.useRef(t),r=useLazyMemo(n=>t?n&&n!==defaultValue$1&&t&&e.current&&t.parentNode===e.current.parentNode?n:getScrollableAncestors(t):defaultValue$1,[t]);return reactExports.useEffect(()=>{e.current=t},[t]),r}function useScrollOffsets(t){const[e,r]=reactExports.useState(null),n=reactExports.useRef(t),s=reactExports.useCallback(a=>{const o=getScrollableElement(a.target);o&&r(l=>l?(l.set(o,getScrollCoordinates(o)),new Map(l)):null)},[]);return reactExports.useEffect(()=>{const a=n.current;if(t!==a){o(a);const l=t.map(u=>{const c=getScrollableElement(u);return c?(c.addEventListener("scroll",s,{passive:!0}),[c,getScrollCoordinates(c)]):null}).filter(u=>u!=null);r(l.length?new Map(l):null),n.current=t}return()=>{o(t),o(a)};function o(l){l.forEach(u=>{const c=getScrollableElement(u);c==null||c.removeEventListener("scroll",s)})}},[s,t]),reactExports.useMemo(()=>t.length?e?Array.from(e.values()).reduce((a,o)=>add$1(a,o),defaultCoordinates):getScrollOffsets(t):defaultCoordinates,[t,e])}function useScrollOffsetsDelta(t,e){e===void 0&&(e=[]);const r=reactExports.useRef(null);return reactExports.useEffect(()=>{r.current=null},e),reactExports.useEffect(()=>{const n=t!==defaultCoordinates;n&&!r.current&&(r.current=t),!n&&r.current&&(r.current=null)},[t]),r.current?subtract$1(t,r.current):defaultCoordinates}function useSensorSetup(t){reactExports.useEffect(()=>{if(!canUseDOM)return;const e=t.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of e)r==null||r()}},t.map(e=>{let{sensor:r}=e;return r}))}function useSyntheticListeners(t,e){return reactExports.useMemo(()=>t.reduce((r,n)=>{let{eventName:s,handler:a}=n;return r[s]=o=>{a(o,e)},r},{}),[t,e])}function useWindowRect(t){return reactExports.useMemo(()=>t?getWindowClientRect(t):null,[t])}const defaultValue$2=[];function useRects(t,e){e===void 0&&(e=getClientRect);const[r]=t,n=useWindowRect(r?getWindow$1(r):null),[s,a]=reactExports.useState(defaultValue$2);function o(){a(()=>t.length?t.map(u=>isDocumentScrollingElement(u)?n:new Rect(e(u),u)):defaultValue$2)}const l=useResizeObserver({callback:o});return useIsomorphicLayoutEffect$3(()=>{l==null||l.disconnect(),o(),t.forEach(u=>l==null?void 0:l.observe(u))},[t]),s}function getMeasurableNode(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return isHTMLElement$1(e)?e:t}function useDragOverlayMeasuring(t){let{measure:e}=t;const[r,n]=reactExports.useState(null),s=reactExports.useCallback(c=>{for(const{target:d}of c)if(isHTMLElement$1(d)){n(p=>{const m=e(d);return p?{...p,width:m.width,height:m.height}:m});break}},[e]),a=useResizeObserver({callback:s}),o=reactExports.useCallback(c=>{const d=getMeasurableNode(c);a==null||a.disconnect(),d&&(a==null||a.observe(d)),n(d?e(d):null)},[e,a]),[l,u]=useNodeRef(o);return reactExports.useMemo(()=>({nodeRef:l,rect:r,setRef:u}),[r,l,u])}const defaultSensors$1=[{sensor:PointerSensor,options:{}},{sensor:KeyboardSensor,options:{}}],defaultData={current:{}},defaultMeasuringConfiguration={draggable:{measure:getTransformAgnosticClientRect},droppable:{measure:getTransformAgnosticClientRect,strategy:MeasuringStrategy.WhileDragging,frequency:MeasuringFrequency.Optimized},dragOverlay:{measure:getClientRect}};class DroppableContainersMap extends Map{get(e){var r;return e!=null&&(r=super.get(e))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:r}=e;return!r})}getNodeFor(e){var r,n;return(r=(n=this.get(e))==null?void 0:n.node.current)!=null?r:void 0}}const defaultPublicContext={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new DroppableContainersMap,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:noop$5},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:defaultMeasuringConfiguration,measureDroppableContainers:noop$5,windowRect:null,measuringScheduled:!1},defaultInternalContext={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:noop$5,draggableNodes:new Map,over:null,measureDroppableContainers:noop$5},InternalContext=reactExports.createContext(defaultInternalContext),PublicContext=reactExports.createContext(defaultPublicContext);function getInitialState(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new DroppableContainersMap}}}function reducer$1(t,e){switch(e.type){case Action.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Action.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case Action.DragEnd:case Action.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Action.RegisterDroppable:{const{element:r}=e,{id:n}=r,s=new DroppableContainersMap(t.droppable.containers);return s.set(n,r),{...t,droppable:{...t.droppable,containers:s}}}case Action.SetDroppableDisabled:{const{id:r,key:n,disabled:s}=e,a=t.droppable.containers.get(r);if(!a||n!==a.key)return t;const o=new DroppableContainersMap(t.droppable.containers);return o.set(r,{...a,disabled:s}),{...t,droppable:{...t.droppable,containers:o}}}case Action.UnregisterDroppable:{const{id:r,key:n}=e,s=t.droppable.containers.get(r);if(!s||n!==s.key)return t;const a=new DroppableContainersMap(t.droppable.containers);return a.delete(r),{...t,droppable:{...t.droppable,containers:a}}}default:return t}}function RestoreFocus(t){let{disabled:e}=t;const{active:r,activatorEvent:n,draggableNodes:s}=reactExports.useContext(InternalContext),a=usePrevious$1(n),o=usePrevious$1(r==null?void 0:r.id);return reactExports.useEffect(()=>{if(!e&&!n&&a&&o!=null){if(!isKeyboardEvent(a)||document.activeElement===a.target)return;const l=s.get(o);if(!l)return;const{activatorNode:u,node:c}=l;if(!u.current&&!c.current)return;requestAnimationFrame(()=>{for(const d of[u.current,c.current]){if(!d)continue;const p=findFirstFocusableNode(d);if(p){p.focus();break}}})}},[n,e,s,o,a]),null}function applyModifiers(t,e){let{transform:r,...n}=e;return t!=null&&t.length?t.reduce((s,a)=>a({transform:s,...n}),r):r}function useMeasuringConfiguration(t){return reactExports.useMemo(()=>({draggable:{...defaultMeasuringConfiguration.draggable,...t==null?void 0:t.draggable},droppable:{...defaultMeasuringConfiguration.droppable,...t==null?void 0:t.droppable},dragOverlay:{...defaultMeasuringConfiguration.dragOverlay,...t==null?void 0:t.dragOverlay}}),[t==null?void 0:t.draggable,t==null?void 0:t.droppable,t==null?void 0:t.dragOverlay])}function useLayoutShiftScrollCompensation(t){let{activeNode:e,measure:r,initialRect:n,config:s=!0}=t;const a=reactExports.useRef(!1),{x:o,y:l}=typeof s=="boolean"?{x:s,y:s}:s;useIsomorphicLayoutEffect$3(()=>{if(!o&&!l||!e){a.current=!1;return}if(a.current||!n)return;const c=e==null?void 0:e.node.current;if(!c||c.isConnected===!1)return;const d=r(c),p=getRectDelta(d,n);if(o||(p.x=0),l||(p.y=0),a.current=!0,Math.abs(p.x)>0||Math.abs(p.y)>0){const m=getFirstScrollableAncestor(c);m&&m.scrollBy({top:p.y,left:p.x})}},[e,o,l,n,r])}const ActiveDraggableContext=reactExports.createContext({...defaultCoordinates,scaleX:1,scaleY:1});var Status;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(Status||(Status={}));const DndContext=reactExports.memo(function(e){var r,n,s,a;let{id:o,accessibility:l,autoScroll:u=!0,children:c,sensors:d=defaultSensors$1,collisionDetection:p=rectIntersection,measuring:m,modifiers:y,...b}=e;const E=reactExports.useReducer(reducer$1,void 0,getInitialState),[T,S]=E,[P,A]=useDndMonitorProvider(),[I,j]=reactExports.useState(Status.Uninitialized),K=I===Status.Initialized,{draggable:{active:W,nodes:H,translate:ee},droppable:{containers:ue}}=T,de=W!=null?H.get(W):null,fe=reactExports.useRef({initial:null,translated:null}),ae=reactExports.useMemo(()=>{var Ir;return W!=null?{id:W,data:(Ir=de==null?void 0:de.data)!=null?Ir:defaultData,rect:fe}:null},[W,de]),ce=reactExports.useRef(null),[me,te]=reactExports.useState(null),[le,Z]=reactExports.useState(null),Y=useLatestValue(b,Object.values(b)),he=useUniqueId$1("DndDescribedBy",o),oe=reactExports.useMemo(()=>ue.getEnabled(),[ue]),ye=useMeasuringConfiguration(m),{droppableRects:Ee,measureDroppableContainers:Ae,measuringScheduled:je}=useDroppableMeasuring(oe,{dragging:K,dependencies:[ee.x,ee.y],config:ye.droppable}),Te=useCachedNode(H,W),Ve=reactExports.useMemo(()=>le?getEventCoordinates(le):null,[le]),Pe=Cr(),Ce=useInitialRect(Te,ye.draggable.measure);useLayoutShiftScrollCompensation({activeNode:W!=null?H.get(W):null,config:Pe.layoutShiftCompensation,initialRect:Ce,measure:ye.draggable.measure});const De=useRect(Te,ye.draggable.measure,Ce),ze=useRect(Te?Te.parentElement:null),Et=reactExports.useRef({activatorEvent:null,active:null,activeNode:Te,collisionRect:null,collisions:null,droppableRects:Ee,draggableNodes:H,draggingNode:null,draggingNodeRect:null,droppableContainers:ue,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ze=ue.getNodeFor((r=Et.current.over)==null?void 0:r.id),Ue=useDragOverlayMeasuring({measure:ye.dragOverlay.measure}),qt=(n=Ue.nodeRef.current)!=null?n:Te,or=K?(s=Ue.rect)!=null?s:De:null,Lt=!!(Ue.nodeRef.current&&Ue.rect),rt=useRectDelta(Lt?null:De),lr=useWindowRect(qt?getWindow$1(qt):null),ir=useScrollableAncestors(K?Ze??Te:null),er=useRects(ir),xr=applyModifiers(y,{transform:{x:ee.x-rt.x,y:ee.y-rt.y,scaleX:1,scaleY:1},activatorEvent:le,active:ae,activeNodeRect:De,containerNodeRect:ze,draggingNodeRect:or,over:Et.current.over,overlayNodeRect:Ue.rect,scrollableAncestors:ir,scrollableAncestorRects:er,windowRect:lr}),br=Ve?add$1(Ve,ee):null,Pr=useScrollOffsets(ir),zr=useScrollOffsetsDelta(Pr),pr=useScrollOffsetsDelta(Pr,[De]),dr=add$1(xr,zr),Ar=or?getAdjustedRect(or,xr):null,_r=ae&&Ar?p({active:ae,collisionRect:Ar,droppableRects:Ee,droppableContainers:oe,pointerCoordinates:br}):null,It=getFirstCollision(_r,"id"),[Bt,ur]=reactExports.useState(null),Vn=Lt?xr:add$1(xr,pr),gn=adjustScale(Vn,(a=Bt==null?void 0:Bt.rect)!=null?a:null,De),yn=reactExports.useRef(null),Dr=reactExports.useCallback((Ir,kr)=>{let{sensor:Er,options:Nn}=kr;if(ce.current==null)return;const Hr=H.get(ce.current);if(!Hr)return;const qr=Ir.nativeEvent,Fr=new Er({active:ce.current,activeNode:Hr,event:qr,options:Nn,context:Et,onAbort(yr){if(!H.get(yr))return;const{onDragAbort:vr}=Y.current,jr={id:yr};vr==null||vr(jr),P({type:"onDragAbort",event:jr})},onPending(yr,Wr,vr,jr){if(!H.get(yr))return;const{onDragPending:xn}=Y.current,Lr={id:yr,constraint:Wr,initialCoordinates:vr,offset:jr};xn==null||xn(Lr),P({type:"onDragPending",event:Lr})},onStart(yr){const Wr=ce.current;if(Wr==null)return;const vr=H.get(Wr);if(!vr)return;const{onDragStart:jr}=Y.current,Qr={activatorEvent:qr,active:{id:Wr,data:vr.data,rect:fe}};reactDomExports.unstable_batchedUpdates(()=>{jr==null||jr(Qr),j(Status.Initializing),S({type:Action.DragStart,initialCoordinates:yr,active:Wr}),P({type:"onDragStart",event:Qr}),te(yn.current),Z(qr)})},onMove(yr){S({type:Action.DragMove,coordinates:yr})},onEnd:Dn(Action.DragEnd),onCancel:Dn(Action.DragCancel)});yn.current=Fr;function Dn(yr){return async function(){const{active:vr,collisions:jr,over:Qr,scrollAdjustedTranslate:xn}=Et.current;let Lr=null;if(vr&&xn){const{cancelDrop:_s}=Y.current;Lr={activatorEvent:qr,active:vr,collisions:jr,delta:xn,over:Qr},yr===Action.DragEnd&&typeof _s=="function"&&await Promise.resolve(_s(Lr))&&(yr=Action.DragCancel)}ce.current=null,reactDomExports.unstable_batchedUpdates(()=>{S({type:yr}),j(Status.Uninitialized),ur(null),te(null),Z(null),yn.current=null;const _s=yr===Action.DragEnd?"onDragEnd":"onDragCancel";if(Lr){const Hs=Y.current[_s];Hs==null||Hs(Lr),P({type:_s,event:Lr})}})}}},[H]),Nr=reactExports.useCallback((Ir,kr)=>(Er,Nn)=>{const Hr=Er.nativeEvent,qr=H.get(Nn);if(ce.current!==null||!qr||Hr.dndKit||Hr.defaultPrevented)return;const Fr={active:qr};Ir(Er,kr.options,Fr)===!0&&(Hr.dndKit={capturedBy:kr.sensor},ce.current=Nn,Dr(Er,kr))},[H,Dr]),wn=useCombineActivators(d,Nr);useSensorSetup(d),useIsomorphicLayoutEffect$3(()=>{De&&I===Status.Initializing&&j(Status.Initialized)},[De,I]),reactExports.useEffect(()=>{const{onDragMove:Ir}=Y.current,{active:kr,activatorEvent:Er,collisions:Nn,over:Hr}=Et.current;if(!kr||!Er)return;const qr={active:kr,activatorEvent:Er,collisions:Nn,delta:{x:dr.x,y:dr.y},over:Hr};reactDomExports.unstable_batchedUpdates(()=>{Ir==null||Ir(qr),P({type:"onDragMove",event:qr})})},[dr.x,dr.y]),reactExports.useEffect(()=>{const{active:Ir,activatorEvent:kr,collisions:Er,droppableContainers:Nn,scrollAdjustedTranslate:Hr}=Et.current;if(!Ir||ce.current==null||!kr||!Hr)return;const{onDragOver:qr}=Y.current,Fr=Nn.get(It),Dn=Fr&&Fr.rect.current?{id:Fr.id,rect:Fr.rect.current,data:Fr.data,disabled:Fr.disabled}:null,yr={active:Ir,activatorEvent:kr,collisions:Er,delta:{x:Hr.x,y:Hr.y},over:Dn};reactDomExports.unstable_batchedUpdates(()=>{ur(Dn),qr==null||qr(yr),P({type:"onDragOver",event:yr})})},[It]),useIsomorphicLayoutEffect$3(()=>{Et.current={activatorEvent:le,active:ae,activeNode:Te,collisionRect:Ar,collisions:_r,droppableRects:Ee,draggableNodes:H,draggingNode:qt,draggingNodeRect:or,droppableContainers:ue,over:Bt,scrollableAncestors:ir,scrollAdjustedTranslate:dr},fe.current={initial:or,translated:Ar}},[ae,Te,_r,Ar,H,qt,or,Ee,ue,Bt,ir,dr]),useAutoScroller({...Pe,delta:ee,draggingRect:Ar,pointerCoordinates:br,scrollableAncestors:ir,scrollableAncestorRects:er});const jn=reactExports.useMemo(()=>({active:ae,activeNode:Te,activeNodeRect:De,activatorEvent:le,collisions:_r,containerNodeRect:ze,dragOverlay:Ue,draggableNodes:H,droppableContainers:ue,droppableRects:Ee,over:Bt,measureDroppableContainers:Ae,scrollableAncestors:ir,scrollableAncestorRects:er,measuringConfiguration:ye,measuringScheduled:je,windowRect:lr}),[ae,Te,De,le,_r,ze,Ue,H,ue,Ee,Bt,Ae,ir,er,ye,je,lr]),$r=reactExports.useMemo(()=>({activatorEvent:le,activators:wn,active:ae,activeNodeRect:De,ariaDescribedById:{draggable:he},dispatch:S,draggableNodes:H,over:Bt,measureDroppableContainers:Ae}),[le,wn,ae,De,S,he,H,Bt,Ae]);return React.createElement(DndMonitorContext.Provider,{value:A},React.createElement(InternalContext.Provider,{value:$r},React.createElement(PublicContext.Provider,{value:jn},React.createElement(ActiveDraggableContext.Provider,{value:gn},c)),React.createElement(RestoreFocus,{disabled:(l==null?void 0:l.restoreFocus)===!1})),React.createElement(Accessibility,{...l,hiddenTextDescribedById:he}));function Cr(){const Ir=(me==null?void 0:me.autoScrollEnabled)===!1,kr=typeof u=="object"?u.enabled===!1:u===!1,Er=K&&!Ir&&!kr;return typeof u=="object"?{...u,enabled:Er}:{enabled:Er}}}),NullContext=reactExports.createContext(null),defaultRole="button",ID_PREFIX="Draggable";function useDraggable(t){let{id:e,data:r,disabled:n=!1,attributes:s}=t;const a=useUniqueId$1(ID_PREFIX),{activators:o,activatorEvent:l,active:u,activeNodeRect:c,ariaDescribedById:d,draggableNodes:p,over:m}=reactExports.useContext(InternalContext),{role:y=defaultRole,roleDescription:b="draggable",tabIndex:E=0}=s??{},T=(u==null?void 0:u.id)===e,S=reactExports.useContext(T?ActiveDraggableContext:NullContext),[P,A]=useNodeRef(),[I,j]=useNodeRef(),K=useSyntheticListeners(o,e),W=useLatestValue(r);useIsomorphicLayoutEffect$3(()=>(p.set(e,{id:e,key:a,node:P,activatorNode:I,data:W}),()=>{const ee=p.get(e);ee&&ee.key===a&&p.delete(e)}),[p,e]);const H=reactExports.useMemo(()=>({role:y,tabIndex:E,"aria-disabled":n,"aria-pressed":T&&y===defaultRole?!0:void 0,"aria-roledescription":b,"aria-describedby":d.draggable}),[n,y,E,T,b,d.draggable]);return{active:u,activatorEvent:l,activeNodeRect:c,attributes:H,isDragging:T,listeners:n?void 0:K,node:P,over:m,setNodeRef:A,setActivatorNodeRef:j,transform:S}}const createStoreImpl$1=t=>{let e;const r=new Set,n=(c,d)=>{const p=typeof c=="function"?c(e):c;if(!Object.is(p,e)){const m=e;e=d??(typeof p!="object"||p===null)?p:Object.assign({},e,p),r.forEach(y=>y(e,m))}},s=()=>e,l={setState:n,getState:s,getInitialState:()=>u,subscribe:c=>(r.add(c),()=>r.delete(c))},u=e=t(n,s,l);return l},createStore$3=t=>t?createStoreImpl$1(t):createStoreImpl$1,identity$3=t=>t;function useStore$1(t,e=identity$3){const r=React.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return React.useDebugValue(r),r}const createImpl=t=>{const e=createStore$3(t),r=n=>useStore$1(e,n);return Object.assign(r,e),r},create$2=t=>t?createImpl(t):createImpl,SUBJECTS={CHINESE:"國語",ENGLISH:"英語",MATH:"數學",SCIENCE:"自然",SOCIAL:"社會",ARTS:"藝術",PE:"體育",CUSTOM:"自訂"},STORAGE_KEY="self_learning_goals",isDefaultGoal=t=>initialGoals.some(e=>e.id===t),initialGoals=[{id:"1",title:"探索唐詩之美",description:"透過詩歌感受唐代文人的情感與智慧",status:"in-progress",subject:SUBJECTS.CHINESE,bubbles:[{id:"bubble-1-1",title:"詩歌欣賞",parentId:"1",bubbleType:"background",content:"在課堂上讀到李白的詩，被他的豪邁氣概所吸引"},{id:"bubble-1-2",title:"詩詞創作",parentId:"1",bubbleType:"background",content:"詩歌、韻律、意境、典故、創作"}],steps:[{id:"1-1",title:"認識詩的韻律",tasks:[{id:"1-1-1",title:"詩韻優美",status:"idea"},{id:"1-1-2",title:"押韻好記",status:"idea"}]},{id:"1-2",title:"感受詩的意境",tasks:[{id:"1-2-1",title:"畫出詩中的畫面",status:"in_progress"},{id:"1-2-2",title:"分享詩中的情感",status:"todo"}]},{id:"1-3",title:"探索詩的典故",tasks:[{id:"1-3-1",title:"找出詩中的歷史故事",status:"todo"},{id:"1-3-2",title:"創作自己的典故",status:"todo"}]},{id:"1-4",title:"創作詩的想像",tasks:[{id:"1-4-1",title:"用現代語言改寫古詩",status:"todo"},{id:"1-4-2",title:"創作自己的詩句",status:"todo"}]}]},{id:"2",title:"探索分數的奧秘",description:"透過生活情境理解分數的概念",status:"active",subject:SUBJECTS.MATH,bubbles:[{id:"bubble-2-1",title:"生活應用",parentId:"2",bubbleType:"background",content:"在切蛋糕時發現需要平均分配，這讓我對分數產生興趣"},{id:"bubble-2-2",title:"分數概念",parentId:"2",bubbleType:"background",content:"分數、比例、除法、比較"}],steps:[{id:"2-1",title:"生活中的分數",tasks:[{id:"2-1-1",title:"平均分配",status:"idea"},{id:"2-1-2",title:"公平分享",status:"idea"}]},{id:"2-2",title:"分數的比較",tasks:[{id:"2-2-1",title:"比較不同分數的大小",status:"done",completedAt:new Date("2024-03-15").toISOString()},{id:"2-2-2",title:"用圖形解釋比較結果",status:"in_progress"}]},{id:"2-3",title:"分數的運算",tasks:[{id:"2-3-1",title:"學習分數加法",status:"in_progress"},{id:"2-3-2",title:"學習分數減法",status:"todo"},{id:"2-3-3",title:"學習分數乘法",status:"in_progress"},{id:"2-3-4",title:"學習分數除法",status:"todo"}]},{id:"2-4",title:"分數的應用",tasks:[{id:"2-4-1",title:"設計分數遊戲",status:"todo"},{id:"2-4-2",title:"用分數解決生活問題",status:"todo"}]}]},{id:"3",title:"探索英語故事創作",description:"透過故事學習英語表達",status:"active",subject:SUBJECTS.ENGLISH,bubbles:[{id:"bubble-3-1",title:"故事閱讀",parentId:"3",bubbleType:"background",content:"讀到有趣的英文故事，想要自己也能寫出這樣的故事"},{id:"bubble-3-2",title:"寫作技巧",parentId:"3",bubbleType:"background",content:"角色、場景、情節、對話"}],steps:[{id:"3-1",title:"故事元素探索",tasks:[{id:"3-1-1",title:"角色塑造",status:"idea"},{id:"3-1-2",title:"場景描寫",status:"idea"}]},{id:"3-2",title:"故事結構理解",tasks:[{id:"3-2-1",title:"分析故事開始、中間、結尾",status:"in_progress"},{id:"3-2-2",title:"找出故事中的轉折點",status:"todo"}]},{id:"3-3",title:"故事詞彙收集",tasks:[{id:"3-3-1",title:"收集故事中的動作詞",status:"todo"},{id:"3-3-2",title:"學習描述性詞彙",status:"todo"}]},{id:"3-4",title:"故事創作實踐",tasks:[{id:"3-4-1",title:"創作簡單的故事大綱",status:"todo"},{id:"3-4-2",title:"用英語寫出故事",status:"todo"}]}]},{id:"4",title:"探索植物生長",description:"透過觀察了解植物的生命週期",status:"active",subject:SUBJECTS.SCIENCE,bubbles:[{id:"bubble-4-1",title:"種子發芽",parentId:"4",bubbleType:"background",content:"看到種子發芽的過程，對植物的生長感到好奇"},{id:"bubble-4-2",title:"植物生長",parentId:"4",bubbleType:"background",content:"發芽、生長、開花、結果"}],steps:[{id:"4-1",title:"種子探索",tasks:[{id:"4-1-1",title:"種子變化",status:"idea"},{id:"4-1-2",title:"發芽過程",status:"idea"}]},{id:"4-2",title:"發芽過程",tasks:[{id:"4-2-1",title:"觀察種子發芽的變化",status:"in_progress"},{id:"4-2-2",title:"測量幼苗的生長",status:"todo"}]},{id:"4-3",title:"葉子研究",tasks:[{id:"4-3-1",title:"觀察葉子的形狀和顏色",status:"todo"},{id:"4-3-2",title:"研究葉子的功能",status:"todo"}]},{id:"4-4",title:"開花結果",tasks:[{id:"4-4-1",title:"觀察花朵的結構",status:"todo"},{id:"4-4-2",title:"記錄果實的形成",status:"todo"}]}]},{id:"5",title:"探索色彩藝術",description:"透過色彩認識藝術表現",status:"active",subject:SUBJECTS.ARTS,bubbles:[{id:"bubble-5-1",title:"美術課",parentId:"5",bubbleType:"background",content:"在美術課上看到同學用不同顏色畫出漂亮的畫，讓我很好奇顏色是怎麼搭配的"},{id:"bubble-5-2",title:"色彩學",parentId:"5",bubbleType:"background",content:"色彩學、色輪、色彩心理學、繪畫技巧"}],steps:[{id:"5-1",title:"色彩探索",tasks:[{id:"5-1-1",title:"不同的心情",status:"idea"},{id:"5-1-2",title:"顏色混合",status:"idea"}]},{id:"5-2",title:"色彩情感",tasks:[{id:"5-2-1",title:"試著用溫暖的顏色畫出快樂的場景",status:"in_progress"},{id:"5-2-2",title:"用冷色調表現下雨天的感覺",status:"todo"}]},{id:"5-3",title:"色彩構圖",tasks:[{id:"5-3-1",title:"學習如何讓顏色和諧地搭配在一起",status:"todo"},{id:"5-3-2",title:"練習用不同深淺的顏色創造層次感",status:"todo"}]},{id:"5-4",title:"色彩故事",tasks:[{id:"5-4-1",title:"用顏色來表達一個故事的情緒變化",status:"todo"},{id:"5-4-2",title:"創作一幅用顏色說故事的畫",status:"todo"}]}]},{id:"6",title:"探索身體運動",description:"透過運動了解身體機能",status:"active",subject:SUBJECTS.PE,bubbles:[{id:"bubble-6-1",title:"體育課",parentId:"6",bubbleType:"background",content:"看到同學在體育課上玩得很開心，我也想學會這些運動"},{id:"bubble-6-2",title:"體能訓練",parentId:"6",bubbleType:"background",content:"體能訓練、運動技巧、健康生活、團隊合作"}],steps:[{id:"6-1",title:"身體探索",tasks:[{id:"6-1-1",title:"心跳變化",status:"idea"},{id:"6-1-2",title:"肌肉伸展",status:"idea"}]},{id:"6-2",title:"基礎運動",tasks:[{id:"6-2-1",title:"學習正確的跑步姿勢，避免受傷",status:"in_progress"},{id:"6-2-2",title:"練習基本的跳躍和平衡動作",status:"todo"}]},{id:"6-3",title:"運動技能",tasks:[{id:"6-3-1",title:"學習投球和接球的技巧",status:"todo"},{id:"6-3-2",title:"練習團隊運動中的傳球和配合",status:"todo"}]},{id:"6-4",title:"運動應用",tasks:[{id:"6-4-1",title:"設計一個有趣的運動遊戲，讓大家都能參與",status:"todo"},{id:"6-4-2",title:"參加班際運動比賽，體驗團隊合作",status:"todo"}]}]},{id:"7",title:"為什麼要讀書",description:"探索讀書的意義與價值",status:"active",subject:SUBJECTS.SOCIAL,bubbles:[{id:"bubble-7-1",title:"爸媽建議",parentId:"7",bubbleType:"background",content:"爸媽常說讀書很重要，但我想知道為什麼"},{id:"bubble-7-2",title:"學習方法",parentId:"7",bubbleType:"background",content:"學習方法、知識獲取、思考能力、自我成長"}],steps:[{id:"7-1",title:"讀書的現況",tasks:[{id:"7-1-1",title:"想像場景",status:"idea"},{id:"7-1-2",title:"時間飛逝",status:"idea"},{id:"7-1-3",title:"訪問同學",status:"todo"}]},{id:"7-2",title:"體驗讀書",tasks:[{id:"7-2-1",title:"試著讀一本故事書，記錄下自己的感受和想法",status:"todo"},{id:"7-2-2",title:"讀一本科普書，看看能學到什麼新知識",status:"todo"}]},{id:"7-3",title:"讀書的收穫",tasks:[{id:"7-3-1",title:"整理讀書時學到的新詞彙和概念",status:"todo"},{id:"7-3-2",title:"思考讀書如何幫助我解決生活中的問題",status:"todo"},{id:"7-3-3",title:"記錄讀書後的想法和啟發",status:"todo"}]},{id:"7-4",title:"讀書的價值",tasks:[{id:"7-4-1",title:"製作一個讀書心得分享，說明讀書帶來的改變",status:"todo"},{id:"7-4-2",title:"和同學討論讀書的樂趣和收穫",status:"todo"}]}]},{id:"8",title:"火箭能飛多高",description:"透過觀察、行動、學習和分享，探索火箭飛行的原理",status:"active",subject:SUBJECTS.SCIENCE,bubbles:[{id:"bubble-8-1",title:"可以去月球嗎",parentId:"8",bubbleType:"background",content:"看到火箭發射的影片，想知道為什麼火箭能飛得這麼高"},{id:"bubble-8-2",title:"想知道飛行原理",parentId:"8",bubbleType:"background",content:"火箭、推力、重力、空氣阻力、牛頓運動定律"}],steps:[{id:"8-1",title:"觀察火箭",tasks:[{id:"8-1-1",title:"收集火箭發射的影片和圖片",status:"idea"},{id:"8-1-2",title:"觀察火箭發射時的變化",status:"idea"}]},{id:"8-2",title:"動手實驗",tasks:[{id:"8-2-1",title:"製作簡單的水火箭",status:"todo"},{id:"8-2-2",title:"測試不同水量對飛行高度的影響",status:"todo"}]},{id:"8-3",title:"學習原理",tasks:[{id:"8-3-1",title:"了解牛頓第三運動定律",status:"todo"},{id:"8-3-2",title:"探索空氣阻力和重力的影響",status:"todo"}]},{id:"8-4",title:"分享發現",tasks:[{id:"8-4-1",title:"製作實驗報告，記錄觀察結果",status:"todo"},{id:"8-4-2",title:"向同學展示水火箭實驗",status:"todo"}]}]},{id:"9",title:"火箭可以飛多高？",description:"探索火箭能飛多高與太空邊界",status:"active",subject:SUBJECTS.SCIENCE,bubbles:[{id:"bubble-9-1",title:"會離開地球嗎？",parentId:"9",bubbleType:"background",content:"我們知道火箭會飛上天，但它可以飛多高？會超過雲、飛機、太空站，還是可以飛到月球？"},{id:"bubble-9-2",title:"能飛到太陽嗎？",parentId:"9",bubbleType:"background",content:"地球外的大氣層有很多層，太空的起點是「卡門線」，大約在地面上方 100 公里。"}],steps:[{id:"9-1",title:"火箭飛到哪裡去？",tasks:[{id:"9-1-1",title:"火箭怎麼起飛",status:"done"},{id:"9-1-2",title:"查查太空從哪裡開始（卡門線）",status:"done"},{id:"9-1-3",title:"找出真實火箭可飛多高",status:"done"}]},{id:"9-2",title:"和其他飛行器比較",tasks:[{id:"9-2-1",title:"查飛機、太空站的高度並畫圖比較",status:"in_progress"},{id:"9-2-2",title:"整理你找到的高度資料做成表格",status:"todo"}]},{id:"9-3",title:"創作與分享你的發現",tasks:[{id:"9-3-1",title:"製作小報或簡報介紹火箭飛多高",status:"todo"},{id:"9-3-2",title:"錄一段影片：我是火箭小主播",status:"todo"}]}]}],getInitialGoals=()=>{if(typeof window>"u")return initialGoals;try{const t=localStorage.getItem(STORAGE_KEY);return t?JSON.parse(t).map(r=>({...r,steps:r.steps.map(n=>({...n,tasks:n.tasks.map(s=>({...s,completedAt:s.completedAt?new Date(s.completedAt).toISOString():void 0}))}))})):initialGoals}catch(t){return console.error("Failed to load goals from localStorage:",t),initialGoals}},saveGoals=t=>{if(!(typeof window>"u"))try{localStorage.setItem(STORAGE_KEY,JSON.stringify(t))}catch(e){console.error("Failed to save goals to localStorage:",e)}},useGoalStore=create$2((t,e)=>({goals:getInitialGoals(),selectedGoalId:null,setSelectedGoalId:r=>t({selectedGoalId:r}),addGoal:r=>{const n={...r,id:r.id||crypto.randomUUID()};return t(s=>({...s,goals:[...s.goals,n]})),saveGoals(e().goals),n},updateGoal:r=>t(n=>{const s={goals:n.goals.map(a=>a.id===r.id?r:a)};return saveGoals(s.goals),s}),deleteGoal:r=>t(n=>{const s={goals:n.goals.map(a=>a.id===r?{...a,status:"archived"}:a)};return saveGoals(s.goals),s}),addStep:(r,n)=>{let s=null;return t(a=>{if(!a.goals.find(u=>u.id===r))return a;s={...n,id:crypto.randomUUID(),tasks:n.tasks||[]};const l={goals:a.goals.map(u=>u.id===r?{...u,steps:[...u.steps,s]}:u)};return saveGoals(l.goals),l}),s},updateStep:(r,n)=>{let s=null;return t(a=>{const o=a.goals.find(c=>c.id===r);if(!o||!o.steps.find(c=>c.id===n.id))return a;s=n;const u={goals:a.goals.map(c=>c.id===r?{...c,steps:c.steps.map(d=>d.id===n.id?s:d)}:c)};return saveGoals(u.goals),u}),s},addTask:(r,n,s)=>{let a=null;return t(o=>{const l=o.goals.find(p=>p.id===r);if(!l)throw new Error(`Goal ${r} not found`);const u=l.steps.find(p=>p.id===n);if(!u)throw new Error(`Step ${n} not found in goal ${r}`);const c=u.tasks.length>0?Math.max(...u.tasks.map(p=>p.order||0)):-1;a={...s,id:crypto.randomUUID(),order:c+1};const d={goals:o.goals.map(p=>p.id===r?{...p,steps:p.steps.map(m=>m.id===n?{...m,tasks:[...m.tasks,a]}:m)}:p)};return saveGoals(d.goals),d}),a},updateTask:(r,n,s)=>{let a=null;return console.log("🔍 goalStore.updateTask 開始",{goalId:r,stepId:n,task:s}),t(o=>{const l=o.goals.find(p=>p.id===r);if(!l)return console.log("❌ goalStore.updateTask 失敗：找不到目標",{goalId:r}),o;const u=l.steps.find(p=>p.id===n);if(!u)return console.log("❌ goalStore.updateTask 失敗：找不到步驟",{stepId:n}),o;if(!u.tasks.find(p=>p.id===s.id))return console.log("❌ goalStore.updateTask 失敗：找不到任務",{taskId:s.id}),o;a=s,console.log("✅ goalStore.updateTask 更新任務",{updatedTask:a});const d={goals:o.goals.map(p=>p.id===r?{...p,steps:p.steps.map(m=>m.id===n?{...m,tasks:m.tasks.map(y=>y.id===s.id?a:y)}:m)}:p)};return saveGoals(d.goals),d}),console.log("🔄 goalStore.updateTask 結果",{updatedTask:a}),a},deleteStep:(r,n)=>{t(s=>{if(!s.goals.find(l=>l.id===r))return s;const o={goals:s.goals.map(l=>l.id===r?{...l,steps:l.steps.map(u=>u.id===n?{...u,status:"archived"}:u)}:l)};return saveGoals(o.goals),o})},deleteTask:(r,n,s)=>{t(a=>{const o=a.goals.find(d=>d.id===r);if(!o)return a;const l=o.steps.find(d=>d.id===n);if(!l||!l.tasks.find(d=>d.id===s))return a;const c={goals:a.goals.map(d=>d.id===r?{...d,steps:d.steps.map(p=>p.id===n?{...p,tasks:p.tasks.map(m=>m.id===s?{...m,status:"archived"}:m)}:p)}:d)};return saveGoals(c.goals),c})},setFocusElement:(r,n)=>t(s=>{const a={goals:s.goals.map(o=>o.id===r?{...o,focusElement:n}:o)};return saveGoals(a.goals),a}),dump:r=>{const n=e();r&&n.goals.find(a=>a.id===r)},getActiveSteps:r=>{const n=e().goals.find(s=>s.id===r);return n?n.steps.filter(s=>!s.status||s.status!=="archived").map(s=>({...s,tasks:s.tasks.filter(a=>!a.status||a.status!=="archived")})):[]},getActiveTasks:(r,n)=>{const s=e().goals.find(o=>o.id===r);if(!s)return[];const a=s.steps.find(o=>o.id===n);return!a||a.status==="archived"?[]:a.tasks.filter(o=>o.status!=="archived")},getCompletionRate:r=>{const n=e().getActiveSteps(r),s=n.reduce((o,l)=>o+l.tasks.length,0),a=n.reduce((o,l)=>o+l.tasks.filter(u=>u.status==="done").length,0);return s===0?0:Math.round(a/s*100)},addBubble:(r,n)=>{t(s=>{if(!s.goals.find(l=>l.id===r))return s;const o={goals:s.goals.map(l=>l.id===r?{...l,bubbles:[...l.bubbles||[],n]}:l)};return saveGoals(o.goals),o})},updateBubble:(r,n,s)=>{t(a=>{if(!a.goals.find(u=>u.id===r))return a;const l={goals:a.goals.map(u=>u.id===r?{...u,bubbles:(u.bubbles||[]).map(c=>c.id===n?{...c,...s}:c)}:u)};return saveGoals(l.goals),l})},deleteBubble:(r,n)=>{t(s=>{if(!s.goals.find(l=>l.id===r))return s;const o={goals:s.goals.map(l=>l.id===r?{...l,bubbles:(l.bubbles||[]).filter(u=>u.id!==n)}:l)};return saveGoals(o.goals),o})},reorderTasks:(r,n,s,a)=>{t(o=>{const l=o.goals.find(b=>b.id===r);if(!l)return o;const u=l.steps.find(b=>b.id===n);if(!u)return o;const c=Array.from(u.tasks),[d]=c.splice(s,1);c.splice(a,0,d);const p=c.map((b,E)=>({...b,order:E})),m={...u,tasks:p},y={goals:o.goals.map(b=>b.id===r?{...b,steps:b.steps.map(E=>E.id===n?m:E)}:b)};return saveGoals(y.goals),y})}})),CurriculumDialog=({goalId:t,onClose:e})=>{const{goals:r,updateTask:n}=useGoalStore(),s=r.find(l=>l.id===t);if(!s)return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-96",children:[jsxRuntimeExports.jsx("p",{className:"mb-4 text-gray-700 dark:text-gray-200",children:"找不到對應的課綱"}),jsxRuntimeExports.jsx("button",{onClick:e,className:"mt-2 px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md",children:"關閉"})]})});const a=(l,u)=>{const c=u.status==="done"?"todo":"done";n(s.id,l,{...u,status:c})},o=(l,u)=>{const c=window.prompt("修改任務名稱",u.title);c!==null&&c!==u.title&&n(s.id,l,{...u,title:c})};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 max-h-[80vh] overflow-y-auto w-full max-w-2xl p-6 rounded-lg shadow-xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:s.title}),jsxRuntimeExports.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700",children:"×"})]}),s.description&&jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:s.description}),jsxRuntimeExports.jsx("div",{className:"space-y-6",children:s.steps.map(l=>jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[jsxRuntimeExports.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-2",children:l.title}),jsxRuntimeExports.jsx("ul",{className:"space-y-2",children:l.tasks.map(u=>jsxRuntimeExports.jsxs("li",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",className:"mr-2",checked:u.status==="done",onChange:()=>a(l.id,u)}),jsxRuntimeExports.jsx("span",{className:`text-sm ${u.status==="done"?"line-through text-gray-500":"text-gray-800 dark:text-gray-100"}`,children:u.title})]}),jsxRuntimeExports.jsx("button",{onClick:()=>o(l.id,u),className:"text-sm text-indigo-600 hover:underline",children:"編輯"})]},u.id))})]},l.id))})]})})},Node$1=React.memo(({node:t,onNodeComplete:e,onAddBranch:r,onEditNode:n,onNodesChange:s,nodes:a,showRewardAnimation:o,isStudent:l,isEditable:u,dragStartPosition:c,allowDragOut:d})=>{var fe,ae,ce,me,te;const[p,m]=reactExports.useState(!1),[y,b]=reactExports.useState(!1),[E,T]=reactExports.useState(!1),S=reactExports.useRef(null),{attributes:P,listeners:A,setNodeRef:I}=useDraggable({id:t.id,disabled:!u||l}),j=c?{transform:`translate3d(${c.x}px, ${c.y}px, 0)`}:void 0,K={locked:"bg-gray-200 dark:bg-gray-700",unlocked:"bg-indigo-500 dark:bg-indigo-600",completed:"bg-green-500 dark:bg-green-600"},W=["from-blue-500 to-purple-500","from-purple-500 to-pink-500","from-pink-500 to-red-500","from-red-500 to-orange-500","from-orange-500 to-yellow-500"],H=le=>{if(le.stopPropagation(),r){const Z={x:t.position.x+300,y:t.position.y+100};r(t.id,Z)}},ee=le=>{le==null||le.stopPropagation(),b(!0)},ue=le=>{le.preventDefault();const Z=new FormData(le.currentTarget),Y={title:Z.get("title"),description:Z.get("description"),level:parseInt(Z.get("level")),rewards:[{type:Z.get("rewardType"),value:parseInt(Z.get("rewardValue")),icon:"star"}]};n==null||n(t.id,Y),b(!1)},de=()=>{y||T(!0)};return reactExports.useEffect(()=>{if(!d)return;const le=S.current;if(!le)return;const Z=he=>{he.stopPropagation(),he.dataTransfer&&(he.dataTransfer.setData("text/plain",t.id),he.dataTransfer.effectAllowed="move")},Y=()=>{if(c&&a){const he=a.map(oe=>oe.id===t.id?{...oe,position:c}:oe);s==null||s(he)}};return le.addEventListener("dragstart",Z),le.addEventListener("dragend",Y),()=>{le.removeEventListener("dragstart",Z),le.removeEventListener("dragend",Y)}},[t.id,d,c,a,s]),y&&u?jsxRuntimeExports.jsx("div",{style:{position:"absolute",left:t.position.x,top:t.position.y,width:"320px"},className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl p-4 z-50",children:jsxRuntimeExports.jsxs("form",{onSubmit:ue,className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"標題"}),jsxRuntimeExports.jsx("input",{name:"title",defaultValue:t.title,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"描述"}),jsxRuntimeExports.jsx("textarea",{name:"description",defaultValue:t.description,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"等級"}),jsxRuntimeExports.jsx("input",{name:"level",type:"number",defaultValue:t.level,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md"})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"獎勵類型"}),jsxRuntimeExports.jsxs("select",{name:"rewardType",defaultValue:(ae=(fe=t.rewards)==null?void 0:fe[0])==null?void 0:ae.type,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md",children:[jsxRuntimeExports.jsx("option",{value:"points",children:"點數"}),jsxRuntimeExports.jsx("option",{value:"badge",children:"徽章"}),jsxRuntimeExports.jsx("option",{value:"experience",children:"經驗值"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"獎勵值"}),jsxRuntimeExports.jsx("input",{name:"rewardValue",type:"number",defaultValue:(me=(ce=t.rewards)==null?void 0:ce[0])==null?void 0:me.value,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-2",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>b(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"取消"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700",children:"儲存"})]})]})}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(motion.div,{id:t.id,ref:le=>{S.current=le,I(le)},...P,...A,onClick:de,style:{position:"absolute",left:t.position.x,top:t.position.y,touchAction:"none",cursor:u&&!l?"grab":"default",...j},draggable:d,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},whileHover:{scale:1.05},onHoverStart:()=>m(!0),onHoverEnd:()=>m(!1),className:"relative",children:[jsxRuntimeExports.jsx("div",{className:`
        absolute -inset-2 rounded-xl bg-gradient-to-r ${W[t.level%W.length]}
        opacity-75 blur-lg transition-opacity duration-300
        ${p?"opacity-100":"opacity-50"}
      `}),jsxRuntimeExports.jsxs("div",{className:`
          w-64 p-4 rounded-xl relative bg-white dark:bg-gray-800
          border-2 ${t.status==="locked"?"border-gray-300 dark:border-gray-700":t.status==="completed"?"border-green-500 dark:border-green-600":"border-indigo-500 dark:border-indigo-600"}
          shadow-xl backdrop-blur-sm bg-opacity-90 dark:bg-opacity-90
        `,children:[u&&!l&&jsxRuntimeExports.jsx("button",{onClick:le=>ee(le),className:"absolute -left-4 top-1/2 transform -translate-y-1/2 w-8 h-8 rounded-full bg-indigo-600 text-white flex items-center justify-center hover:bg-indigo-700 transition-colors z-10",children:jsxRuntimeExports.jsx(Pen,{size:16})}),u&&!l&&jsxRuntimeExports.jsx("button",{onClick:H,className:"absolute -right-4 top-1/2 transform -translate-y-1/2 w-8 h-8 rounded-full bg-indigo-600 text-white flex items-center justify-center hover:bg-indigo-700 transition-colors z-10",children:jsxRuntimeExports.jsx(Plus,{size:16})}),jsxRuntimeExports.jsx("div",{className:`
          absolute -top-3 -right-3 w-8 h-8 rounded-full 
          flex items-center justify-center ${K[t.status]}
          shadow-lg transition-colors duration-300
        `,children:t.status==="locked"?jsxRuntimeExports.jsx(Lock,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"}):t.status==="completed"?jsxRuntimeExports.jsx(motion.div,{initial:{rotate:0},animate:{rotate:360},transition:{duration:.5},children:jsxRuntimeExports.jsx(Trophy,{className:"w-4 h-4 text-white"})}):jsxRuntimeExports.jsx(Map$1,{className:"w-4 h-4 text-white"})}),t.rewards.find(le=>le.type==="badge")&&jsxRuntimeExports.jsxs("div",{className:"absolute -top-3 right-12 px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-xs font-medium flex items-center",children:[jsxRuntimeExports.jsx(Tag,{size:12,className:"mr-1"}),(te=t.rewards.find(le=>le.type==="badge"))==null?void 0:te.icon]}),jsxRuntimeExports.jsxs("div",{className:"absolute -top-3 -left-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white text-xs font-bold px-2 py-1 rounded-full shadow-lg",children:["Level ",t.level]}),jsxRuntimeExports.jsxs("div",{className:"mb-3",children:[jsxRuntimeExports.jsx("h3",{className:`
            text-lg font-semibold
            ${t.status==="locked"?"text-gray-500 dark:text-gray-400":"text-gray-900 dark:text-white"}
          `,children:t.title}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:t.description})]}),t.requirements&&t.requirements.length>0&&jsxRuntimeExports.jsx("div",{className:"mb-3",children:jsxRuntimeExports.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["需要完成：",t.requirements.join(", ")]})}),t.rewards&&jsxRuntimeExports.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:t.rewards.map((le,Z)=>jsxRuntimeExports.jsxs(motion.div,{className:`
                  inline-flex items-center px-2 py-1 rounded-full text-xs font-medium
                  ${le.type==="badge"?"bg-gradient-to-r from-purple-500 to-pink-500 text-white":le.type==="experience"?"bg-gradient-to-r from-green-500 to-emerald-500 text-white":"bg-gradient-to-r from-yellow-500 to-orange-500 text-white"}
                `,whileHover:{scale:1.1},animate:o?{scale:[1,1.2,1],rotate:[0,10,-10,0]}:void 0,children:[le.type==="badge"?jsxRuntimeExports.jsx(Award,{className:"w-3 h-3 mr-1"}):le.type==="experience"?jsxRuntimeExports.jsx(Flag,{className:"w-3 h-3 mr-1"}):jsxRuntimeExports.jsx(Star,{className:"w-3 h-3 mr-1"}),le.value," ",le.type==="badge"?"徽章":le.type==="experience"?"EXP":"點數"]},Z))}),l&&t.status==="unlocked"&&jsxRuntimeExports.jsx(motion.button,{onClick:()=>e==null?void 0:e(t.id),className:"mt-3 w-full px-3 py-2 text-sm font-medium rounded-lg text-white bg-gradient-to-r from-indigo-500 to-purple-500 hover:from-indigo-600 hover:to-purple-600 transition-all duration-300",whileHover:{scale:1.02},whileTap:{scale:.98},children:"開始任務"})]})]}),E&&jsxRuntimeExports.jsx(CurriculumDialog,{goalId:t.id,onClose:()=>T(!1)})]})},(t,e)=>t.node.id===e.node.id&&t.node.position.x===e.node.position.x&&t.node.position.y===e.node.position.y&&t.showRewardAnimation===e.showRewardAnimation&&t.isEditable===e.isEditable&&t.isStudent===e.isStudent&&t.dragStartPosition===e.dragStartPosition),LearningMap=({nodes:t=[],onNodesChange:e,isStudent:r,isEditable:n=!r,allowDragOut:s=!1})=>{const[a,o]=reactExports.useState(!1),[l,u]=reactExports.useState(null),[c,d]=reactExports.useState(null),p=P=>{o(!0),setTimeout(()=>o(!1),1e3);const A=t.map(I=>{var j;return I.id===P?{...I,status:"completed"}:(j=I.requirements)!=null&&j.includes(P)?{...I,status:"unlocked"}:I});e==null||e(A)},m=(P,A)=>{var W;const I=`node-${Date.now()}`,j={id:I,title:"新任務",description:"點擊編輯任務內容",status:"locked",position:A,connections:[],requirements:[],level:((W=t.find(H=>H.id===P))==null?void 0:W.level)??2,rewards:[{type:"points",value:100,icon:"star"}]},K=t.map(H=>H.id===P?{...H,connections:[...H.connections,I]}:H);e==null||e([...K,j])},y=(P,A)=>{const I=t.map(j=>j.id===P?{...j,...A}:j);e==null||e(I)},b=P=>{const A=P.active.id,I=t.find(j=>j.id===A);I&&(d(I.position),u(A))},E=reactExports.useCallback(P=>{const{active:A,delta:I}=P;if(!A||!l||!c)return;const j=A.id,K=t.map(W=>W.id===j?{...W,position:{x:c.x+I.x,y:c.y+I.y}}:W);e(K)},[t,l,c,e]),T=P=>{const{active:A,delta:I}=P;if(!A||!c)return;const j=A.id;u(null),d(null);const K=t.map(W=>W.id===j?{...W,position:{x:c.x+I.x,y:c.y+I.y}}:W);e(K)},S=reactExports.useMemo(()=>t.flatMap(P=>P.connections.map(A=>jsxRuntimeExports.jsx(Xarrow,{start:P.id,end:A,path:"smooth",startAnchor:"right",endAnchor:"left",showHead:!0,strokeWidth:2,color:P.status==="completed"?"#22c55e":"#6366f1",dashness:P.status==="locked",curveness:.3},`${P.id}-${A}`))),[t]);return jsxRuntimeExports.jsxs("div",{className:"relative w-full bg-gradient-to-br from-gray-50 to-indigo-50 dark:from-gray-900 dark:to-indigo-900/30 rounded-xl shadow-inner",children:[jsxRuntimeExports.jsxs("div",{className:"absolute top-4 left-4 z-10 flex items-center space-x-2 text-gray-600 dark:text-gray-300",children:[jsxRuntimeExports.jsx(Compass,{className:"w-5 h-5"}),jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",children:"學習地圖"})]}),jsxRuntimeExports.jsx("div",{className:"min-h-[600px] relative p-8",style:{minWidth:"1200px",touchAction:"none",overflow:s?"visible":"hidden"},children:jsxRuntimeExports.jsxs(libExports.Xwrapper,{children:[S,jsxRuntimeExports.jsx(DndContext,{onDragStart:b,onDragMove:E,onDragEnd:T,children:t.map(P=>jsxRuntimeExports.jsx(Node$1,{node:P,nodes:t,onNodeComplete:p,onAddBranch:m,onEditNode:y,showRewardAnimation:a,isStudent:r,isEditable:n,dragStartPosition:c,allowDragOut:s},P.id))})]})})]})},initialNodes$1=[{id:"science-basics",title:"基本科學概念",description:"理解基本科學概念和原理",status:"unlocked",requirements:[],position:{x:100,y:100},connections:["observation-skills"],level:1,rewards:[{type:"points",value:100,icon:"star"}]},{id:"observation-skills",title:"觀察能力培養",description:"培養科學觀察能力和方法",status:"locked",requirements:["science-basics"],position:{x:400,y:100},connections:["experiment-methods"],level:2,rewards:[{type:"points",value:150,icon:"star"}]},{id:"experiment-methods",title:"實驗方法學習",description:"學習基礎實驗方法和步驟",status:"locked",requirements:["observation-skills"],position:{x:700,y:100},connections:[],level:3,rewards:[{type:"points",value:200,icon:"star"}]}],CurriculumContext=reactExports.createContext(null),CurriculumProvider=({children:t})=>{const[e,r]=reactExports.useState(initialNodes$1),n=(s,a)=>{r(o=>o.map(l=>l.id===s?{...l,status:a}:l))};return jsxRuntimeExports.jsx(CurriculumContext.Provider,{value:{nodes:e,setNodes:r,updateNodeStatus:n},children:t})},useCurriculum=()=>{const t=reactExports.useContext(CurriculumContext);if(!t)throw new Error("useCurriculum must be used within a CurriculumProvider");return t},MentorCurriculum=()=>{const{nodes:t,setNodes:e}=useCurriculum();return jsxRuntimeExports.jsx(PageLayout,{title:"教學規劃與任務管理",children:jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsx(CurriculumPlanner,{}),jsxRuntimeExports.jsx(LearningMap,{nodes:t,onNodesChange:e,isEditable:!0,allowDragOut:!1})]})})},WeeklyTaskColumns=({weeks:t,onAssignTask:e,onRemoveTask:r})=>{const{nodes:n}=useCurriculum(),s=a=>t.some(o=>o.tasks.some(l=>l.id===a));return jsxRuntimeExports.jsx("div",{className:"grid grid-cols-4 gap-4 h-full",children:t.map(a=>jsxRuntimeExports.jsxs("div",{className:"week-task-column bg-gray-50 dark:bg-gray-700/50 p-3 rounded-lg flex flex-col",onDragOver:o=>{o.preventDefault();const l=o.dataTransfer.getData("text/plain");s(l)||o.currentTarget.classList.add("bg-gray-100","dark:bg-gray-700")},onDragLeave:o=>{o.currentTarget.contains(o.relatedTarget)||o.currentTarget.classList.remove("bg-gray-100","dark:bg-gray-700")},onDrop:o=>{o.preventDefault(),o.currentTarget.classList.remove("bg-gray-100","dark:bg-gray-700");const l=o.dataTransfer.getData("text/plain");s(l)||e(l,a.id)},children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-2",children:[jsxRuntimeExports.jsxs("h3",{className:"font-medium text-gray-900 dark:text-white text-sm",children:["第 ",a.id," 週"]}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[a.tasks.length," 個任務"]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 space-y-2 overflow-y-auto",children:a.tasks.map(o=>jsxRuntimeExports.jsx("div",{className:"bg-white dark:bg-gray-800 p-2 rounded shadow-sm",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:o.title}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:o.description}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-indigo-100 dark:bg-indigo-900/30 text-indigo-800 dark:text-indigo-300 rounded",children:o.subject}),o.progress>0&&jsxRuntimeExports.jsxs("span",{className:"text-xs text-gray-500",children:[o.progress,"%"]}),o.endDate&&jsxRuntimeExports.jsxs("span",{className:"text-xs text-gray-500",children:["截止: ",new Date(o.endDate).toLocaleDateString()]})]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>r(o.id,a.id),className:"ml-2 p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:jsxRuntimeExports.jsx(Trash2,{size:14})})]})},o.id))})]},a.id))})},PlannerContext=reactExports.createContext(void 0),PlannerProvider=({children:t})=>{const[e,r]=reactExports.useState([]),[n,s]=reactExports.useState([]),[a,o]=reactExports.useState([]),{nodes:l}=useCurriculum(),u=(b,E)=>{r(T=>T.map(S=>{if(S.id===E){const P=n.find(A=>A.id===b);return P?{...S,tasks:[...S.tasks,{...P,weekId:E}]}:S}return S}))},c=(b,E)=>{r(T=>T.map(S=>S.id===E?{...S,tasks:S.tasks.filter(P=>P.id!==b)}:S))},d=(b,E)=>{s(T=>T.map(S=>S.id===b?{...S,status:E}:S)),r(T=>T.map(S=>({...S,tasks:S.tasks.map(P=>P.id===b?{...P,status:E}:P)})))},p=b=>{s(E=>E.map(T=>T.id===b.id?{...T,...b}:T)),r(E=>E.map(T=>({...T,tasks:T.tasks.map(S=>S.id===b.id?{...S,...b}:S)})))},m=async({weekId:b,taskIds:E,studentIds:T})=>{const S=T.flatMap(P=>E.map(A=>({id:`${A}-${P}-${b}`,taskId:A,studentId:P,weekId:b,status:"pending",assignedAt:new Date().toISOString(),assignedBy:"current-teacher-id"})));o(P=>[...P,...S]),E.forEach(P=>{d(P,"in_progress")})};React.useEffect(()=>{if(e.length===0){const b=Array.from({length:8},(E,T)=>({id:T+1,tasks:[],nodeIds:[],subjectId:"",creatorId:"current-teacher-id",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}));r(b)}},[]);const y={weeks:e,tasks:n,assignments:a,assignTaskToWeek:u,removeTaskFromWeek:c,updateTaskStatus:d,updateTask:p,assignTasksToStudents:m};return jsxRuntimeExports.jsx(PlannerContext.Provider,{value:y,children:t})},usePlanner=()=>{const t=reactExports.useContext(PlannerContext);if(t===void 0)throw new Error("usePlanner must be used within a PlannerProvider");return t},TaskPlannerContent=()=>{const{weeks:t,assignments:e}=usePlanner(),{nodes:r,setNodes:n,updateNodeStatus:s}=useCurriculum();return reactExports.useEffect(()=>{e.forEach(a=>{if(a.status==="accepted"){const o=t.find(u=>u.id===a.weekId),l=o==null?void 0:o.tasks.find(u=>u.id===a.taskId);l!=null&&l.courseId&&s(l.courseId,"completed")}})},[e,t,s]),jsxRuntimeExports.jsx(PageLayout,{title:"任務規劃",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-[calc(100vh-64px-60px)] overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 min-h-[300px] p-4 overflow-y-auto",children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm h-full p-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"週任務規劃"}),jsxRuntimeExports.jsx(WeeklyTaskColumns,{weeks:t,onAssignTask:(a,o)=>{},onRemoveTask:(a,o)=>{}})]})}),jsxRuntimeExports.jsx("div",{className:"h-1/2 min-h-[300px] p-4",children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm h-full p-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"學習地圖"}),jsxRuntimeExports.jsx(LearningMap,{nodes:r,onNodesChange:n,isEditable:!0,allowDragOut:!0})]})})]})})},MentorTaskPlanner=()=>jsxRuntimeExports.jsx(PlannerProvider,{children:jsxRuntimeExports.jsx(CurriculumProvider,{children:jsxRuntimeExports.jsx(TaskPlannerContent,{})})});function cc(t){if(typeof t=="string"||typeof t=="number")return""+t;let e="";if(Array.isArray(t))for(let r=0,n;r<t.length;r++)(n=cc(t[r]))!==""&&(e+=(e&&" ")+n);else for(let r in t)t[r]&&(e+=(e&&" ")+r);return e}var withSelector={exports:{}},withSelector_production={},shim={exports:{}},useSyncExternalStoreShim_production={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredUseSyncExternalStoreShim_production;function requireUseSyncExternalStoreShim_production(){if(hasRequiredUseSyncExternalStoreShim_production)return useSyncExternalStoreShim_production;hasRequiredUseSyncExternalStoreShim_production=1;var t=requireReact();function e(p,m){return p===m&&(p!==0||1/p===1/m)||p!==p&&m!==m}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,s=t.useEffect,a=t.useLayoutEffect,o=t.useDebugValue;function l(p,m){var y=m(),b=n({inst:{value:y,getSnapshot:m}}),E=b[0].inst,T=b[1];return a(function(){E.value=y,E.getSnapshot=m,u(E)&&T({inst:E})},[p,y,m]),s(function(){return u(E)&&T({inst:E}),p(function(){u(E)&&T({inst:E})})},[p]),o(y),y}function u(p){var m=p.getSnapshot;p=p.value;try{var y=m();return!r(p,y)}catch{return!0}}function c(p,m){return m()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:l;return useSyncExternalStoreShim_production.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:d,useSyncExternalStoreShim_production}var hasRequiredShim;function requireShim(){return hasRequiredShim||(hasRequiredShim=1,shim.exports=requireUseSyncExternalStoreShim_production()),shim.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredWithSelector_production;function requireWithSelector_production(){if(hasRequiredWithSelector_production)return withSelector_production;hasRequiredWithSelector_production=1;var t=requireReact(),e=requireShim();function r(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var n=typeof Object.is=="function"?Object.is:r,s=e.useSyncExternalStore,a=t.useRef,o=t.useEffect,l=t.useMemo,u=t.useDebugValue;return withSelector_production.useSyncExternalStoreWithSelector=function(c,d,p,m,y){var b=a(null);if(b.current===null){var E={hasValue:!1,value:null};b.current=E}else E=b.current;b=l(function(){function S(K){if(!P){if(P=!0,A=K,K=m(K),y!==void 0&&E.hasValue){var W=E.value;if(y(W,K))return I=W}return I=K}if(W=I,n(A,K))return W;var H=m(K);return y!==void 0&&y(W,H)?(A=K,W):(A=K,I=H)}var P=!1,A,I,j=p===void 0?null:p;return[function(){return S(d())},j===null?void 0:function(){return S(j())}]},[d,p,m,y]);var T=s(c,b[0],b[1]);return o(function(){E.hasValue=!0,E.value=T},[T]),u(T),T},withSelector_production}var hasRequiredWithSelector;function requireWithSelector(){return hasRequiredWithSelector||(hasRequiredWithSelector=1,withSelector.exports=requireWithSelector_production()),withSelector.exports}var withSelectorExports=requireWithSelector();const useSyncExternalStoreExports=getDefaultExportFromCjs(withSelectorExports),__vite_import_meta_env__={},createStoreImpl=t=>{let e;const r=new Set,n=(d,p)=>{const m=typeof d=="function"?d(e):d;if(!Object.is(m,e)){const y=e;e=p??(typeof m!="object"||m===null)?m:Object.assign({},e,m),r.forEach(b=>b(e,y))}},s=()=>e,u={setState:n,getState:s,getInitialState:()=>c,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(__vite_import_meta_env__?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},c=e=t(n,s,u);return u},createStore$2=t=>t?createStoreImpl(t):createStoreImpl,{useDebugValue}=React,{useSyncExternalStoreWithSelector}=useSyncExternalStoreExports,identity$2=t=>t;function useStoreWithEqualityFn(t,e=identity$2,r){const n=useSyncExternalStoreWithSelector(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,r);return useDebugValue(n),n}const createWithEqualityFnImpl=(t,e)=>{const r=createStore$2(t),n=(s,a=e)=>useStoreWithEqualityFn(r,s,a);return Object.assign(n,r),n},createWithEqualityFn=(t,e)=>t?createWithEqualityFnImpl(t,e):createWithEqualityFnImpl;function shallow$1$2(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[n,s]of t)if(!Object.is(s,e.get(n)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(e,n)||!Object.is(t[n],e[n]))return!1;return!0}var noop$4={value:()=>{}};function dispatch(){for(var t=0,e=arguments.length,r={},n;t<e;++t){if(!(n=arguments[t]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new Dispatch(r)}function Dispatch(t){this._=t}function parseTypenames$1(t,e){return t.trim().split(/^|\s+/).map(function(r){var n="",s=r.indexOf(".");if(s>=0&&(n=r.slice(s+1),r=r.slice(0,s)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(t,e){var r=this._,n=parseTypenames$1(t+"",r),s,a=-1,o=n.length;if(arguments.length<2){for(;++a<o;)if((s=(t=n[a]).type)&&(s=get$1(r[s],t.name)))return s;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<o;)if(s=(t=n[a]).type)r[s]=set$1(r[s],t.name,e);else if(e==null)for(s in r)r[s]=set$1(r[s],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new Dispatch(t)},call:function(t,e){if((s=arguments.length-2)>0)for(var r=new Array(s),n=0,s,a;n<s;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],n=0,s=a.length;n<s;++n)a[n].value.apply(e,r)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],s=0,a=n.length;s<a;++s)n[s].value.apply(e,r)}};function get$1(t,e){for(var r=0,n=t.length,s;r<n;++r)if((s=t[r]).name===e)return s.value}function set$1(t,e,r){for(var n=0,s=t.length;n<s;++n)if(t[n].name===e){t[n]=noop$4,t=t.slice(0,n).concat(t.slice(n+1));break}return r!=null&&t.push({name:e,value:r}),t}var xhtml="http://www.w3.org/1999/xhtml";const namespaces={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(t){var e=t+="",r=e.indexOf(":");return r>=0&&(e=t.slice(0,r))!=="xmlns"&&(t=t.slice(r+1)),namespaces.hasOwnProperty(e)?{space:namespaces[e],local:t}:t}function creatorInherit(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===xhtml&&e.documentElement.namespaceURI===xhtml?e.createElement(t):e.createElementNS(r,t)}}function creatorFixed(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function creator(t){var e=namespace(t);return(e.local?creatorFixed:creatorInherit)(e)}function none(){}function selector$h(t){return t==null?none:function(){return this.querySelector(t)}}function selection_select(t){typeof t!="function"&&(t=selector$h(t));for(var e=this._groups,r=e.length,n=new Array(r),s=0;s<r;++s)for(var a=e[s],o=a.length,l=n[s]=new Array(o),u,c,d=0;d<o;++d)(u=a[d])&&(c=t.call(u,u.__data__,d,a))&&("__data__"in u&&(c.__data__=u.__data__),l[d]=c);return new Selection$1(n,this._parents)}function array(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function empty$1(){return[]}function selectorAll(t){return t==null?empty$1:function(){return this.querySelectorAll(t)}}function arrayAll(t){return function(){return array(t.apply(this,arguments))}}function selection_selectAll(t){typeof t=="function"?t=arrayAll(t):t=selectorAll(t);for(var e=this._groups,r=e.length,n=[],s=[],a=0;a<r;++a)for(var o=e[a],l=o.length,u,c=0;c<l;++c)(u=o[c])&&(n.push(t.call(u,u.__data__,c,o)),s.push(u));return new Selection$1(n,s)}function matcher(t){return function(){return this.matches(t)}}function childMatcher(t){return function(e){return e.matches(t)}}var find$1=Array.prototype.find;function childFind(t){return function(){return find$1.call(this.children,t)}}function childFirst(){return this.firstElementChild}function selection_selectChild(t){return this.select(t==null?childFirst:childFind(typeof t=="function"?t:childMatcher(t)))}var filter=Array.prototype.filter;function children(){return Array.from(this.children)}function childrenFilter(t){return function(){return filter.call(this.children,t)}}function selection_selectChildren(t){return this.selectAll(t==null?children:childrenFilter(typeof t=="function"?t:childMatcher(t)))}function selection_filter(t){typeof t!="function"&&(t=matcher(t));for(var e=this._groups,r=e.length,n=new Array(r),s=0;s<r;++s)for(var a=e[s],o=a.length,l=n[s]=[],u,c=0;c<o;++c)(u=a[c])&&t.call(u,u.__data__,c,a)&&l.push(u);return new Selection$1(n,this._parents)}function sparse(t){return new Array(t.length)}function selection_enter(){return new Selection$1(this._enter||this._groups.map(sparse),this._parents)}function EnterNode(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}EnterNode.prototype={constructor:EnterNode,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function constant$3(t){return function(){return t}}function bindIndex(t,e,r,n,s,a){for(var o=0,l,u=e.length,c=a.length;o<c;++o)(l=e[o])?(l.__data__=a[o],n[o]=l):r[o]=new EnterNode(t,a[o]);for(;o<u;++o)(l=e[o])&&(s[o]=l)}function bindKey(t,e,r,n,s,a,o){var l,u,c=new Map,d=e.length,p=a.length,m=new Array(d),y;for(l=0;l<d;++l)(u=e[l])&&(m[l]=y=o.call(u,u.__data__,l,e)+"",c.has(y)?s[l]=u:c.set(y,u));for(l=0;l<p;++l)y=o.call(t,a[l],l,a)+"",(u=c.get(y))?(n[l]=u,u.__data__=a[l],c.delete(y)):r[l]=new EnterNode(t,a[l]);for(l=0;l<d;++l)(u=e[l])&&c.get(m[l])===u&&(s[l]=u)}function datum(t){return t.__data__}function selection_data(t,e){if(!arguments.length)return Array.from(this,datum);var r=e?bindKey:bindIndex,n=this._parents,s=this._groups;typeof t!="function"&&(t=constant$3(t));for(var a=s.length,o=new Array(a),l=new Array(a),u=new Array(a),c=0;c<a;++c){var d=n[c],p=s[c],m=p.length,y=arraylike(t.call(d,d&&d.__data__,c,n)),b=y.length,E=l[c]=new Array(b),T=o[c]=new Array(b),S=u[c]=new Array(m);r(d,p,E,T,S,y,e);for(var P=0,A=0,I,j;P<b;++P)if(I=E[P]){for(P>=A&&(A=P+1);!(j=T[A])&&++A<b;);I._next=j||null}}return o=new Selection$1(o,n),o._enter=l,o._exit=u,o}function arraylike(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function selection_exit(){return new Selection$1(this._exit||this._groups.map(sparse),this._parents)}function selection_join(t,e,r){var n=this.enter(),s=this,a=this.exit();return typeof t=="function"?(n=t(n),n&&(n=n.selection())):n=n.append(t+""),e!=null&&(s=e(s),s&&(s=s.selection())),r==null?a.remove():r(a),n&&s?n.merge(s).order():s}function selection_merge(t){for(var e=t.selection?t.selection():t,r=this._groups,n=e._groups,s=r.length,a=n.length,o=Math.min(s,a),l=new Array(s),u=0;u<o;++u)for(var c=r[u],d=n[u],p=c.length,m=l[u]=new Array(p),y,b=0;b<p;++b)(y=c[b]||d[b])&&(m[b]=y);for(;u<s;++u)l[u]=r[u];return new Selection$1(l,this._parents)}function selection_order(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n=t[e],s=n.length-1,a=n[s],o;--s>=0;)(o=n[s])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function selection_sort(t){t||(t=ascending);function e(p,m){return p&&m?t(p.__data__,m.__data__):!p-!m}for(var r=this._groups,n=r.length,s=new Array(n),a=0;a<n;++a){for(var o=r[a],l=o.length,u=s[a]=new Array(l),c,d=0;d<l;++d)(c=o[d])&&(u[d]=c);u.sort(e)}return new Selection$1(s,this._parents).order()}function ascending(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function selection_call(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function selection_nodes(){return Array.from(this)}function selection_node(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],s=0,a=n.length;s<a;++s){var o=n[s];if(o)return o}return null}function selection_size(){let t=0;for(const e of this)++t;return t}function selection_empty(){return!this.node()}function selection_each(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var s=e[r],a=0,o=s.length,l;a<o;++a)(l=s[a])&&t.call(l,l.__data__,a,s);return this}function attrRemove$1(t){return function(){this.removeAttribute(t)}}function attrRemoveNS$1(t){return function(){this.removeAttributeNS(t.space,t.local)}}function attrConstant$1(t,e){return function(){this.setAttribute(t,e)}}function attrConstantNS$1(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function attrFunction$1(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttribute(t):this.setAttribute(t,r)}}function attrFunctionNS$1(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function selection_attr(t,e){var r=namespace(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((e==null?r.local?attrRemoveNS$1:attrRemove$1:typeof e=="function"?r.local?attrFunctionNS$1:attrFunction$1:r.local?attrConstantNS$1:attrConstant$1)(r,e))}function defaultView(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function styleRemove$1(t){return function(){this.style.removeProperty(t)}}function styleConstant$1(t,e,r){return function(){this.style.setProperty(t,e,r)}}function styleFunction$1(t,e,r){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function selection_style(t,e,r){return arguments.length>1?this.each((e==null?styleRemove$1:typeof e=="function"?styleFunction$1:styleConstant$1)(t,e,r??"")):styleValue(this.node(),t)}function styleValue(t,e){return t.style.getPropertyValue(e)||defaultView(t).getComputedStyle(t,null).getPropertyValue(e)}function propertyRemove(t){return function(){delete this[t]}}function propertyConstant(t,e){return function(){this[t]=e}}function propertyFunction(t,e){return function(){var r=e.apply(this,arguments);r==null?delete this[t]:this[t]=r}}function selection_property(t,e){return arguments.length>1?this.each((e==null?propertyRemove:typeof e=="function"?propertyFunction:propertyConstant)(t,e)):this.node()[t]}function classArray(t){return t.trim().split(/^|\s+/)}function classList(t){return t.classList||new ClassList(t)}function ClassList(t){this._node=t,this._names=classArray(t.getAttribute("class")||"")}ClassList.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function classedAdd(t,e){for(var r=classList(t),n=-1,s=e.length;++n<s;)r.add(e[n])}function classedRemove(t,e){for(var r=classList(t),n=-1,s=e.length;++n<s;)r.remove(e[n])}function classedTrue(t){return function(){classedAdd(this,t)}}function classedFalse(t){return function(){classedRemove(this,t)}}function classedFunction(t,e){return function(){(e.apply(this,arguments)?classedAdd:classedRemove)(this,t)}}function selection_classed(t,e){var r=classArray(t+"");if(arguments.length<2){for(var n=classList(this.node()),s=-1,a=r.length;++s<a;)if(!n.contains(r[s]))return!1;return!0}return this.each((typeof e=="function"?classedFunction:e?classedTrue:classedFalse)(r,e))}function textRemove(){this.textContent=""}function textConstant$1(t){return function(){this.textContent=t}}function textFunction$1(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function selection_text(t){return arguments.length?this.each(t==null?textRemove:(typeof t=="function"?textFunction$1:textConstant$1)(t)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(t){return function(){this.innerHTML=t}}function htmlFunction(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function selection_html(t){return arguments.length?this.each(t==null?htmlRemove:(typeof t=="function"?htmlFunction:htmlConstant)(t)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower(){return this.each(lower)}function selection_append(t){var e=typeof t=="function"?t:creator(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function constantNull(){return null}function selection_insert(t,e){var r=typeof t=="function"?t:creator(t),n=e==null?constantNull:typeof e=="function"?e:selector$h(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function remove(){var t=this.parentNode;t&&t.removeChild(this)}function selection_remove(){return this.each(remove)}function selection_cloneShallow(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function selection_cloneDeep(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function selection_clone(t){return this.select(t?selection_cloneDeep:selection_cloneShallow)}function selection_datum(t){return arguments.length?this.property("__data__",t):this.node().__data__}function contextListener(t){return function(e){t.call(this,e,this.__data__)}}function parseTypenames(t){return t.trim().split(/^|\s+/).map(function(e){var r="",n=e.indexOf(".");return n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),{type:e,name:r}})}function onRemove(t){return function(){var e=this.__on;if(e){for(var r=0,n=-1,s=e.length,a;r<s;++r)a=e[r],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++n]=a;++n?e.length=n:delete this.__on}}}function onAdd(t,e,r){return function(){var n=this.__on,s,a=contextListener(e);if(n){for(var o=0,l=n.length;o<l;++o)if((s=n[o]).type===t.type&&s.name===t.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=a,s.options=r),s.value=e;return}}this.addEventListener(t.type,a,r),s={type:t.type,name:t.name,value:e,listener:a,options:r},n?n.push(s):this.__on=[s]}}function selection_on(t,e,r){var n=parseTypenames(t+""),s,a=n.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var u=0,c=l.length,d;u<c;++u)for(s=0,d=l[u];s<a;++s)if((o=n[s]).type===d.type&&o.name===d.name)return d.value}return}for(l=e?onAdd:onRemove,s=0;s<a;++s)this.each(l(n[s],e,r));return this}function dispatchEvent(t,e,r){var n=defaultView(t),s=n.CustomEvent;typeof s=="function"?s=new s(e,r):(s=n.document.createEvent("Event"),r?(s.initEvent(e,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(e,!1,!1)),t.dispatchEvent(s)}function dispatchConstant(t,e){return function(){return dispatchEvent(this,t,e)}}function dispatchFunction(t,e){return function(){return dispatchEvent(this,t,e.apply(this,arguments))}}function selection_dispatch(t,e){return this.each((typeof e=="function"?dispatchFunction:dispatchConstant)(t,e))}function*selection_iterator(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],s=0,a=n.length,o;s<a;++s)(o=n[s])&&(yield o)}var root$2=[null];function Selection$1(t,e){this._groups=t,this._parents=e}function selection(){return new Selection$1([[document.documentElement]],root$2)}function selection_selection(){return this}Selection$1.prototype=selection.prototype={constructor:Selection$1,select:selection_select,selectAll:selection_selectAll,selectChild:selection_selectChild,selectChildren:selection_selectChildren,filter:selection_filter,data:selection_data,enter:selection_enter,exit:selection_exit,join:selection_join,merge:selection_merge,selection:selection_selection,order:selection_order,sort:selection_sort,call:selection_call,nodes:selection_nodes,node:selection_node,size:selection_size,empty:selection_empty,each:selection_each,attr:selection_attr,style:selection_style,property:selection_property,classed:selection_classed,text:selection_text,html:selection_html,raise:selection_raise,lower:selection_lower,append:selection_append,insert:selection_insert,remove:selection_remove,clone:selection_clone,datum:selection_datum,on:selection_on,dispatch:selection_dispatch,[Symbol.iterator]:selection_iterator};function select(t){return typeof t=="string"?new Selection$1([[document.querySelector(t)]],[document.documentElement]):new Selection$1([[t]],root$2)}function sourceEvent(t){let e;for(;e=t.sourceEvent;)t=e;return t}function pointer(t,e){if(t=sourceEvent(t),e===void 0&&(e=t.currentTarget),e){var r=e.ownerSVGElement||e;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=t.clientX,n.y=t.clientY,n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}}return[t.pageX,t.pageY]}const nonpassive={passive:!1},nonpassivecapture={capture:!0,passive:!1};function nopropagation$1(t){t.stopImmediatePropagation()}function noevent$1(t){t.preventDefault(),t.stopImmediatePropagation()}function dragDisable(t){var e=t.document.documentElement,r=select(t).on("dragstart.drag",noevent$1,nonpassivecapture);"onselectstart"in e?r.on("selectstart.drag",noevent$1,nonpassivecapture):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function yesdrag(t,e){var r=t.document.documentElement,n=select(t).on("dragstart.drag",null);e&&(n.on("click.drag",noevent$1,nonpassivecapture),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const constant$2=t=>()=>t;function DragEvent(t,{sourceEvent:e,subject:r,target:n,identifier:s,active:a,x:o,y:l,dx:u,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}DragEvent.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function defaultFilter$1(t){return!t.ctrlKey&&!t.button}function defaultContainer(){return this.parentNode}function defaultSubject(t,e){return e??{x:t.x,y:t.y}}function defaultTouchable$1(){return navigator.maxTouchPoints||"ontouchstart"in this}function drag(){var t=defaultFilter$1,e=defaultContainer,r=defaultSubject,n=defaultTouchable$1,s={},a=dispatch("start","drag","end"),o=0,l,u,c,d,p=0;function m(I){I.on("mousedown.drag",y).filter(n).on("touchstart.drag",T).on("touchmove.drag",S,nonpassive).on("touchend.drag touchcancel.drag",P).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(I,j){if(!(d||!t.call(this,I,j))){var K=A(this,e.call(this,I,j),I,j,"mouse");K&&(select(I.view).on("mousemove.drag",b,nonpassivecapture).on("mouseup.drag",E,nonpassivecapture),dragDisable(I.view),nopropagation$1(I),c=!1,l=I.clientX,u=I.clientY,K("start",I))}}function b(I){if(noevent$1(I),!c){var j=I.clientX-l,K=I.clientY-u;c=j*j+K*K>p}s.mouse("drag",I)}function E(I){select(I.view).on("mousemove.drag mouseup.drag",null),yesdrag(I.view,c),noevent$1(I),s.mouse("end",I)}function T(I,j){if(t.call(this,I,j)){var K=I.changedTouches,W=e.call(this,I,j),H=K.length,ee,ue;for(ee=0;ee<H;++ee)(ue=A(this,W,I,j,K[ee].identifier,K[ee]))&&(nopropagation$1(I),ue("start",I,K[ee]))}}function S(I){var j=I.changedTouches,K=j.length,W,H;for(W=0;W<K;++W)(H=s[j[W].identifier])&&(noevent$1(I),H("drag",I,j[W]))}function P(I){var j=I.changedTouches,K=j.length,W,H;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),W=0;W<K;++W)(H=s[j[W].identifier])&&(nopropagation$1(I),H("end",I,j[W]))}function A(I,j,K,W,H,ee){var ue=a.copy(),de=pointer(ee||K,j),fe,ae,ce;if((ce=r.call(I,new DragEvent("beforestart",{sourceEvent:K,target:m,identifier:H,active:o,x:de[0],y:de[1],dx:0,dy:0,dispatch:ue}),W))!=null)return fe=ce.x-de[0]||0,ae=ce.y-de[1]||0,function me(te,le,Z){var Y=de,he;switch(te){case"start":s[H]=me,he=o++;break;case"end":delete s[H],--o;case"drag":de=pointer(Z||le,j),he=o;break}ue.call(te,I,new DragEvent(te,{sourceEvent:le,subject:ce,target:m,identifier:H,active:he,x:de[0]+fe,y:de[1]+ae,dx:de[0]-Y[0],dy:de[1]-Y[1],dispatch:ue}),W)}}return m.filter=function(I){return arguments.length?(t=typeof I=="function"?I:constant$2(!!I),m):t},m.container=function(I){return arguments.length?(e=typeof I=="function"?I:constant$2(I),m):e},m.subject=function(I){return arguments.length?(r=typeof I=="function"?I:constant$2(I),m):r},m.touchable=function(I){return arguments.length?(n=typeof I=="function"?I:constant$2(!!I),m):n},m.on=function(){var I=a.on.apply(a,arguments);return I===a?m:I},m.clickDistance=function(I){return arguments.length?(p=(I=+I)*I,m):Math.sqrt(p)},m}function define(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function extend(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color$1,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color$1(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=reHex.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?rgbn(e):r===3?new Rgb(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?rgba(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?rgba(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=reRgbInteger.exec(t))?new Rgb(e[1],e[2],e[3],1):(e=reRgbPercent.exec(t))?new Rgb(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=reRgbaInteger.exec(t))?rgba(e[1],e[2],e[3],e[4]):(e=reRgbaPercent.exec(t))?rgba(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=reHslPercent.exec(t))?hsla(e[1],e[2]/100,e[3]/100,1):(e=reHslaPercent.exec(t))?hsla(e[1],e[2]/100,e[3]/100,e[4]):named.hasOwnProperty(t)?rgbn(named[t]):t==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(t){return new Rgb(t>>16&255,t>>8&255,t&255,1)}function rgba(t,e,r,n){return n<=0&&(t=e=r=NaN),new Rgb(t,e,r,n)}function rgbConvert(t){return t instanceof Color||(t=color$1(t)),t?(t=t.rgb(),new Rgb(t.r,t.g,t.b,t.opacity)):new Rgb}function rgb(t,e,r,n){return arguments.length===1?rgbConvert(t):new Rgb(t,e,r,n??1)}function Rgb(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}define(Rgb,rgb,extend(Color,{brighter(t){return t=t==null?brighter:Math.pow(brighter,t),new Rgb(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?darker:Math.pow(darker,t),new Rgb(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const t=clampa(this.opacity);return`${t===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${t===1?")":`, ${t})`}`}function clampa(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function clampi(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function hex(t){return t=clampi(t),(t<16?"0":"")+t.toString(16)}function hsla(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Hsl(t,e,r,n)}function hslConvert(t){if(t instanceof Hsl)return new Hsl(t.h,t.s,t.l,t.opacity);if(t instanceof Color||(t=color$1(t)),!t)return new Hsl;if(t instanceof Hsl)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,s=Math.min(e,r,n),a=Math.max(e,r,n),o=NaN,l=a-s,u=(a+s)/2;return l?(e===a?o=(r-n)/l+(r<n)*6:r===a?o=(n-e)/l+2:o=(e-r)/l+4,l/=u<.5?a+s:2-a-s,o*=60):l=u>0&&u<1?0:o,new Hsl(o,l,u,t.opacity)}function hsl(t,e,r,n){return arguments.length===1?hslConvert(t):new Hsl(t,e,r,n??1)}function Hsl(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}define(Hsl,hsl,extend(Color,{brighter(t){return t=t==null?brighter:Math.pow(brighter,t),new Hsl(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?darker:Math.pow(darker,t),new Hsl(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,s=2*r-n;return new Rgb(hsl2rgb(t>=240?t-240:t+120,s,n),hsl2rgb(t,s,n),hsl2rgb(t<120?t+240:t-120,s,n),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=clampa(this.opacity);return`${t===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${t===1?")":`, ${t})`}`}}));function clamph(t){return t=(t||0)%360,t<0?t+360:t}function clampt(t){return Math.max(0,Math.min(1,t||0))}function hsl2rgb(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const constant$1=t=>()=>t;function linear(t,e){return function(r){return t+r*e}}function exponential(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function gamma(t){return(t=+t)==1?nogamma:function(e,r){return r-e?exponential(e,r,t):constant$1(isNaN(e)?r:e)}}function nogamma(t,e){var r=e-t;return r?linear(t,r):constant$1(isNaN(t)?e:t)}const interpolateRgb=function t(e){var r=gamma(e);function n(s,a){var o=r((s=rgb(s)).r,(a=rgb(a)).r),l=r(s.g,a.g),u=r(s.b,a.b),c=nogamma(s.opacity,a.opacity);return function(d){return s.r=o(d),s.g=l(d),s.b=u(d),s.opacity=c(d),s+""}}return n.gamma=t,n}(1);function interpolateNumber(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(t){return function(){return t}}function one(t){return function(e){return t(e)+""}}function interpolateString(t,e){var r=reA.lastIndex=reB.lastIndex=0,n,s,a,o=-1,l=[],u=[];for(t=t+"",e=e+"";(n=reA.exec(t))&&(s=reB.exec(e));)(a=s.index)>r&&(a=e.slice(r,a),l[o]?l[o]+=a:l[++o]=a),(n=n[0])===(s=s[0])?l[o]?l[o]+=s:l[++o]=s:(l[++o]=null,u.push({i:o,x:interpolateNumber(n,s)})),r=reB.lastIndex;return r<e.length&&(a=e.slice(r),l[o]?l[o]+=a:l[++o]=a),l.length<2?u[0]?one(u[0].x):zero(e):(e=u.length,function(c){for(var d=0,p;d<e;++d)l[(p=u[d]).i]=p.x(c);return l.join("")})}var degrees=180/Math.PI,identity$1={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose(t,e,r,n,s,a){var o,l,u;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(u=t*r+e*n)&&(r-=t*u,n-=e*u),(l=Math.sqrt(r*r+n*n))&&(r/=l,n/=l,u/=l),t*n<e*r&&(t=-t,e=-e,u=-u,o=-o),{translateX:s,translateY:a,rotate:Math.atan2(e,t)*degrees,skewX:Math.atan(u)*degrees,scaleX:o,scaleY:l}}var svgNode;function parseCss(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?identity$1:decompose(e.a,e.b,e.c,e.d,e.e,e.f)}function parseSvg(t){return t==null||(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",t),!(t=svgNode.transform.baseVal.consolidate()))?identity$1:(t=t.matrix,decompose(t.a,t.b,t.c,t.d,t.e,t.f))}function interpolateTransform(t,e,r,n){function s(c){return c.length?c.pop()+" ":""}function a(c,d,p,m,y,b){if(c!==p||d!==m){var E=y.push("translate(",null,e,null,r);b.push({i:E-4,x:interpolateNumber(c,p)},{i:E-2,x:interpolateNumber(d,m)})}else(p||m)&&y.push("translate("+p+e+m+r)}function o(c,d,p,m){c!==d?(c-d>180?d+=360:d-c>180&&(c+=360),m.push({i:p.push(s(p)+"rotate(",null,n)-2,x:interpolateNumber(c,d)})):d&&p.push(s(p)+"rotate("+d+n)}function l(c,d,p,m){c!==d?m.push({i:p.push(s(p)+"skewX(",null,n)-2,x:interpolateNumber(c,d)}):d&&p.push(s(p)+"skewX("+d+n)}function u(c,d,p,m,y,b){if(c!==p||d!==m){var E=y.push(s(y)+"scale(",null,",",null,")");b.push({i:E-4,x:interpolateNumber(c,p)},{i:E-2,x:interpolateNumber(d,m)})}else(p!==1||m!==1)&&y.push(s(y)+"scale("+p+","+m+")")}return function(c,d){var p=[],m=[];return c=t(c),d=t(d),a(c.translateX,c.translateY,d.translateX,d.translateY,p,m),o(c.rotate,d.rotate,p,m),l(c.skewX,d.skewX,p,m),u(c.scaleX,c.scaleY,d.scaleX,d.scaleY,p,m),c=d=null,function(y){for(var b=-1,E=m.length,T;++b<E;)p[(T=m[b]).i]=T.x(y);return p.join("")}}}var interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),epsilon2=1e-12;function cosh(t){return((t=Math.exp(t))+1/t)/2}function sinh(t){return((t=Math.exp(t))-1/t)/2}function tanh(t){return((t=Math.exp(2*t))-1)/(t+1)}const interpolateZoom=function t(e,r,n){function s(a,o){var l=a[0],u=a[1],c=a[2],d=o[0],p=o[1],m=o[2],y=d-l,b=p-u,E=y*y+b*b,T,S;if(E<epsilon2)S=Math.log(m/c)/e,T=function(W){return[l+W*y,u+W*b,c*Math.exp(e*W*S)]};else{var P=Math.sqrt(E),A=(m*m-c*c+n*E)/(2*c*r*P),I=(m*m-c*c-n*E)/(2*m*r*P),j=Math.log(Math.sqrt(A*A+1)-A),K=Math.log(Math.sqrt(I*I+1)-I);S=(K-j)/e,T=function(W){var H=W*S,ee=cosh(j),ue=c/(r*P)*(ee*tanh(e*H+j)-sinh(j));return[l+ue*y,u+ue*b,c*ee/cosh(e*H+j)]}}return T.duration=S*1e3*e/Math.SQRT2,T}return s.rho=function(a){var o=Math.max(.001,+a),l=o*o,u=l*l;return t(o,l,u)},s}(Math.SQRT2,2,4);var frame=0,timeout$1=0,interval=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock=typeof performance=="object"&&performance.now?performance:Date,setFrame=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}Timer.prototype=timer.prototype={constructor:Timer,restart:function(t,e,r){if(typeof t!="function")throw new TypeError("callback is not a function");r=(r==null?now():+r)+(e==null?0:+e),!this._next&&taskTail!==this&&(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=t,this._time=r,sleep$1()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep$1())}};function timer(t,e,r){var n=new Timer;return n.restart(t,e,r),n}function timerFlush(){now(),++frame;for(var t=taskHead,e;t;)(e=clockNow-t._time)>=0&&t._call.call(void 0,e),t=t._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout$1=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var t=clock.now(),e=t-clockLast;e>pokeDelay&&(clockSkew-=e,clockLast=t)}function nap(){for(var t,e=taskHead,r,n=1/0;e;)e._call?(n>e._time&&(n=e._time),t=e,e=e._next):(r=e._next,e._next=null,e=t?t._next=r:taskHead=r);taskTail=t,sleep$1(n)}function sleep$1(t){if(!frame){timeout$1&&(timeout$1=clearTimeout(timeout$1));var e=t-clockNow;e>24?(t<1/0&&(timeout$1=setTimeout(wake,t-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}function timeout(t,e,r){var n=new Timer;return e=e==null?0:+e,n.restart(s=>{n.stop(),t(s+e)},e,r),n}var emptyOn=dispatch("start","end","cancel","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule(t,e,r,n,s,a){var o=t.__transition;if(!o)t.__transition={};else if(r in o)return;create$1(t,r,{name:e,index:n,group:s,on:emptyOn,tween:emptyTween,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:CREATED})}function init$1(t,e){var r=get(t,e);if(r.state>CREATED)throw new Error("too late; already scheduled");return r}function set(t,e){var r=get(t,e);if(r.state>STARTED)throw new Error("too late; already running");return r}function get(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function create$1(t,e,r){var n=t.__transition,s;n[e]=r,r.timer=timer(a,0,r.time);function a(c){r.state=SCHEDULED,r.timer.restart(o,r.delay,r.time),r.delay<=c&&o(c-r.delay)}function o(c){var d,p,m,y;if(r.state!==SCHEDULED)return u();for(d in n)if(y=n[d],y.name===r.name){if(y.state===STARTED)return timeout(o);y.state===RUNNING?(y.state=ENDED,y.timer.stop(),y.on.call("interrupt",t,t.__data__,y.index,y.group),delete n[d]):+d<e&&(y.state=ENDED,y.timer.stop(),y.on.call("cancel",t,t.__data__,y.index,y.group),delete n[d])}if(timeout(function(){r.state===STARTED&&(r.state=RUNNING,r.timer.restart(l,r.delay,r.time),l(c))}),r.state=STARTING,r.on.call("start",t,t.__data__,r.index,r.group),r.state===STARTING){for(r.state=STARTED,s=new Array(m=r.tween.length),d=0,p=-1;d<m;++d)(y=r.tween[d].value.call(t,t.__data__,r.index,r.group))&&(s[++p]=y);s.length=p+1}}function l(c){for(var d=c<r.duration?r.ease.call(null,c/r.duration):(r.timer.restart(u),r.state=ENDING,1),p=-1,m=s.length;++p<m;)s[p].call(t,d);r.state===ENDING&&(r.on.call("end",t,t.__data__,r.index,r.group),u())}function u(){r.state=ENDED,r.timer.stop(),delete n[e];for(var c in n)return;delete t.__transition}}function interrupt(t,e){var r=t.__transition,n,s,a=!0,o;if(r){e=e==null?null:e+"";for(o in r){if((n=r[o]).name!==e){a=!1;continue}s=n.state>STARTING&&n.state<ENDING,n.state=ENDED,n.timer.stop(),n.on.call(s?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete r[o]}a&&delete t.__transition}}function selection_interrupt(t){return this.each(function(){interrupt(this,t)})}function tweenRemove(t,e){var r,n;return function(){var s=set(this,t),a=s.tween;if(a!==r){n=r=a;for(var o=0,l=n.length;o<l;++o)if(n[o].name===e){n=n.slice(),n.splice(o,1);break}}s.tween=n}}function tweenFunction(t,e,r){var n,s;if(typeof r!="function")throw new Error;return function(){var a=set(this,t),o=a.tween;if(o!==n){s=(n=o).slice();for(var l={name:e,value:r},u=0,c=s.length;u<c;++u)if(s[u].name===e){s[u]=l;break}u===c&&s.push(l)}a.tween=s}}function transition_tween(t,e){var r=this._id;if(t+="",arguments.length<2){for(var n=get(this.node(),r).tween,s=0,a=n.length,o;s<a;++s)if((o=n[s]).name===t)return o.value;return null}return this.each((e==null?tweenRemove:tweenFunction)(r,t,e))}function tweenValue(t,e,r){var n=t._id;return t.each(function(){var s=set(this,n);(s.value||(s.value={}))[e]=r.apply(this,arguments)}),function(s){return get(s,n).value[e]}}function interpolate(t,e){var r;return(typeof e=="number"?interpolateNumber:e instanceof color$1?interpolateRgb:(r=color$1(e))?(e=r,interpolateRgb):interpolateString)(t,e)}function attrRemove(t){return function(){this.removeAttribute(t)}}function attrRemoveNS(t){return function(){this.removeAttributeNS(t.space,t.local)}}function attrConstant(t,e,r){var n,s=r+"",a;return function(){var o=this.getAttribute(t);return o===s?null:o===n?a:a=e(n=o,r)}}function attrConstantNS(t,e,r){var n,s=r+"",a;return function(){var o=this.getAttributeNS(t.space,t.local);return o===s?null:o===n?a:a=e(n=o,r)}}function attrFunction(t,e,r){var n,s,a;return function(){var o,l=r(this),u;return l==null?void this.removeAttribute(t):(o=this.getAttribute(t),u=l+"",o===u?null:o===n&&u===s?a:(s=u,a=e(n=o,l)))}}function attrFunctionNS(t,e,r){var n,s,a;return function(){var o,l=r(this),u;return l==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),u=l+"",o===u?null:o===n&&u===s?a:(s=u,a=e(n=o,l)))}}function transition_attr(t,e){var r=namespace(t),n=r==="transform"?interpolateTransformSvg:interpolate;return this.attrTween(t,typeof e=="function"?(r.local?attrFunctionNS:attrFunction)(r,n,tweenValue(this,"attr."+t,e)):e==null?(r.local?attrRemoveNS:attrRemove)(r):(r.local?attrConstantNS:attrConstant)(r,n,e))}function attrInterpolate(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}function attrInterpolateNS(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}function attrTweenNS(t,e){var r,n;function s(){var a=e.apply(this,arguments);return a!==n&&(r=(n=a)&&attrInterpolateNS(t,a)),r}return s._value=e,s}function attrTween(t,e){var r,n;function s(){var a=e.apply(this,arguments);return a!==n&&(r=(n=a)&&attrInterpolate(t,a)),r}return s._value=e,s}function transition_attrTween(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;var n=namespace(t);return this.tween(r,(n.local?attrTweenNS:attrTween)(n,e))}function delayFunction(t,e){return function(){init$1(this,t).delay=+e.apply(this,arguments)}}function delayConstant(t,e){return e=+e,function(){init$1(this,t).delay=e}}function transition_delay(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?delayFunction:delayConstant)(e,t)):get(this.node(),e).delay}function durationFunction(t,e){return function(){set(this,t).duration=+e.apply(this,arguments)}}function durationConstant(t,e){return e=+e,function(){set(this,t).duration=e}}function transition_duration(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?durationFunction:durationConstant)(e,t)):get(this.node(),e).duration}function easeConstant(t,e){if(typeof e!="function")throw new Error;return function(){set(this,t).ease=e}}function transition_ease(t){var e=this._id;return arguments.length?this.each(easeConstant(e,t)):get(this.node(),e).ease}function easeVarying(t,e){return function(){var r=e.apply(this,arguments);if(typeof r!="function")throw new Error;set(this,t).ease=r}}function transition_easeVarying(t){if(typeof t!="function")throw new Error;return this.each(easeVarying(this._id,t))}function transition_filter(t){typeof t!="function"&&(t=matcher(t));for(var e=this._groups,r=e.length,n=new Array(r),s=0;s<r;++s)for(var a=e[s],o=a.length,l=n[s]=[],u,c=0;c<o;++c)(u=a[c])&&t.call(u,u.__data__,c,a)&&l.push(u);return new Transition(n,this._parents,this._name,this._id)}function transition_merge(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,n=e.length,s=r.length,a=Math.min(n,s),o=new Array(n),l=0;l<a;++l)for(var u=e[l],c=r[l],d=u.length,p=o[l]=new Array(d),m,y=0;y<d;++y)(m=u[y]||c[y])&&(p[y]=m);for(;l<n;++l)o[l]=e[l];return new Transition(o,this._parents,this._name,this._id)}function start(t){return(t+"").trim().split(/^|\s+/).every(function(e){var r=e.indexOf(".");return r>=0&&(e=e.slice(0,r)),!e||e==="start"})}function onFunction(t,e,r){var n,s,a=start(e)?init$1:set;return function(){var o=a(this,t),l=o.on;l!==n&&(s=(n=l).copy()).on(e,r),o.on=s}}function transition_on(t,e){var r=this._id;return arguments.length<2?get(this.node(),r).on.on(t):this.each(onFunction(r,t,e))}function removeFunction(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}function transition_remove(){return this.on("end.remove",removeFunction(this._id))}function transition_select(t){var e=this._name,r=this._id;typeof t!="function"&&(t=selector$h(t));for(var n=this._groups,s=n.length,a=new Array(s),o=0;o<s;++o)for(var l=n[o],u=l.length,c=a[o]=new Array(u),d,p,m=0;m<u;++m)(d=l[m])&&(p=t.call(d,d.__data__,m,l))&&("__data__"in d&&(p.__data__=d.__data__),c[m]=p,schedule(c[m],e,r,m,c,get(d,r)));return new Transition(a,this._parents,e,r)}function transition_selectAll(t){var e=this._name,r=this._id;typeof t!="function"&&(t=selectorAll(t));for(var n=this._groups,s=n.length,a=[],o=[],l=0;l<s;++l)for(var u=n[l],c=u.length,d,p=0;p<c;++p)if(d=u[p]){for(var m=t.call(d,d.__data__,p,u),y,b=get(d,r),E=0,T=m.length;E<T;++E)(y=m[E])&&schedule(y,e,r,E,m,b);a.push(m),o.push(d)}return new Transition(a,o,e,r)}var Selection=selection.prototype.constructor;function transition_selection(){return new Selection(this._groups,this._parents)}function styleNull(t,e){var r,n,s;return function(){var a=styleValue(this,t),o=(this.style.removeProperty(t),styleValue(this,t));return a===o?null:a===r&&o===n?s:s=e(r=a,n=o)}}function styleRemove(t){return function(){this.style.removeProperty(t)}}function styleConstant(t,e,r){var n,s=r+"",a;return function(){var o=styleValue(this,t);return o===s?null:o===n?a:a=e(n=o,r)}}function styleFunction(t,e,r){var n,s,a;return function(){var o=styleValue(this,t),l=r(this),u=l+"";return l==null&&(u=l=(this.style.removeProperty(t),styleValue(this,t))),o===u?null:o===n&&u===s?a:(s=u,a=e(n=o,l))}}function styleMaybeRemove(t,e){var r,n,s,a="style."+e,o="end."+a,l;return function(){var u=set(this,t),c=u.on,d=u.value[a]==null?l||(l=styleRemove(e)):void 0;(c!==r||s!==d)&&(n=(r=c).copy()).on(o,s=d),u.on=n}}function transition_style(t,e,r){var n=(t+="")=="transform"?interpolateTransformCss:interpolate;return e==null?this.styleTween(t,styleNull(t,n)).on("end.style."+t,styleRemove(t)):typeof e=="function"?this.styleTween(t,styleFunction(t,n,tweenValue(this,"style."+t,e))).each(styleMaybeRemove(this._id,t)):this.styleTween(t,styleConstant(t,n,e),r).on("end.style."+t,null)}function styleInterpolate(t,e,r){return function(n){this.style.setProperty(t,e.call(this,n),r)}}function styleTween(t,e,r){var n,s;function a(){var o=e.apply(this,arguments);return o!==s&&(n=(s=o)&&styleInterpolate(t,o,r)),n}return a._value=e,a}function transition_styleTween(t,e,r){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,styleTween(t,e,r??""))}function textConstant(t){return function(){this.textContent=t}}function textFunction(t){return function(){var e=t(this);this.textContent=e??""}}function transition_text(t){return this.tween("text",typeof t=="function"?textFunction(tweenValue(this,"text",t)):textConstant(t==null?"":t+""))}function textInterpolate(t){return function(e){this.textContent=t.call(this,e)}}function textTween(t){var e,r;function n(){var s=t.apply(this,arguments);return s!==r&&(e=(r=s)&&textInterpolate(s)),e}return n._value=t,n}function transition_textTween(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,textTween(t))}function transition_transition(){for(var t=this._name,e=this._id,r=newId(),n=this._groups,s=n.length,a=0;a<s;++a)for(var o=n[a],l=o.length,u,c=0;c<l;++c)if(u=o[c]){var d=get(u,e);schedule(u,t,r,c,o,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Transition(n,this._parents,t,r)}function transition_end(){var t,e,r=this,n=r._id,s=r.size();return new Promise(function(a,o){var l={value:o},u={value:function(){--s===0&&a()}};r.each(function(){var c=set(this,n),d=c.on;d!==t&&(e=(t=d).copy(),e._.cancel.push(l),e._.interrupt.push(l),e._.end.push(u)),c.on=e}),s===0&&a()})}var id=0;function Transition(t,e,r,n){this._groups=t,this._parents=e,this._name=r,this._id=n}function newId(){return++id}var selection_prototype=selection.prototype;Transition.prototype={constructor:Transition,select:transition_select,selectAll:transition_selectAll,selectChild:selection_prototype.selectChild,selectChildren:selection_prototype.selectChildren,filter:transition_filter,merge:transition_merge,selection:transition_selection,transition:transition_transition,call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:transition_on,attr:transition_attr,attrTween:transition_attrTween,style:transition_style,styleTween:transition_styleTween,text:transition_text,textTween:transition_textTween,remove:transition_remove,tween:transition_tween,delay:transition_delay,duration:transition_duration,ease:transition_ease,easeVarying:transition_easeVarying,end:transition_end,[Symbol.iterator]:selection_prototype[Symbol.iterator]};function cubicInOut(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut};function inherit(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function selection_transition(t){var e,r;t instanceof Transition?(e=t._id,t=t._name):(e=newId(),(r=defaultTiming).time=now(),t=t==null?null:t+"");for(var n=this._groups,s=n.length,a=0;a<s;++a)for(var o=n[a],l=o.length,u,c=0;c<l;++c)(u=o[c])&&schedule(u,t,e,c,o,r||inherit(u,e));return new Transition(n,this._parents,t,e)}selection.prototype.interrupt=selection_interrupt;selection.prototype.transition=selection_transition;const constant=t=>()=>t;function ZoomEvent(t,{sourceEvent:e,target:r,transform:n,dispatch:s}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:s}})}function Transform(t,e,r){this.k=t,this.x=e,this.y=r}Transform.prototype={constructor:Transform,scale:function(t){return t===1?this:new Transform(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Transform(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var identity=new Transform(1,0,0);Transform.prototype;function nopropagation(t){t.stopImmediatePropagation()}function noevent(t){t.preventDefault(),t.stopImmediatePropagation()}function defaultFilter(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function defaultExtent(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function defaultTransform(){return this.__zoom||identity}function defaultWheelDelta(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}function defaultConstrain(t,e,r){var n=t.invertX(e[0][0])-r[0][0],s=t.invertX(e[1][0])-r[1][0],a=t.invertY(e[0][1])-r[0][1],o=t.invertY(e[1][1])-r[1][1];return t.translate(s>n?(n+s)/2:Math.min(0,n)||Math.max(0,s),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}function zoom(){var t=defaultFilter,e=defaultExtent,r=defaultConstrain,n=defaultWheelDelta,s=defaultTouchable,a=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],l=250,u=interpolateZoom,c=dispatch("start","zoom","end"),d,p,m,y=500,b=150,E=0,T=10;function S(ce){ce.property("__zoom",defaultTransform).on("wheel.zoom",H,{passive:!1}).on("mousedown.zoom",ee).on("dblclick.zoom",ue).filter(s).on("touchstart.zoom",de).on("touchmove.zoom",fe).on("touchend.zoom touchcancel.zoom",ae).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}S.transform=function(ce,me,te,le){var Z=ce.selection?ce.selection():ce;Z.property("__zoom",defaultTransform),ce!==Z?j(ce,me,te,le):Z.interrupt().each(function(){K(this,arguments).event(le).start().zoom(null,typeof me=="function"?me.apply(this,arguments):me).end()})},S.scaleBy=function(ce,me,te,le){S.scaleTo(ce,function(){var Z=this.__zoom.k,Y=typeof me=="function"?me.apply(this,arguments):me;return Z*Y},te,le)},S.scaleTo=function(ce,me,te,le){S.transform(ce,function(){var Z=e.apply(this,arguments),Y=this.__zoom,he=te==null?I(Z):typeof te=="function"?te.apply(this,arguments):te,oe=Y.invert(he),ye=typeof me=="function"?me.apply(this,arguments):me;return r(A(P(Y,ye),he,oe),Z,o)},te,le)},S.translateBy=function(ce,me,te,le){S.transform(ce,function(){return r(this.__zoom.translate(typeof me=="function"?me.apply(this,arguments):me,typeof te=="function"?te.apply(this,arguments):te),e.apply(this,arguments),o)},null,le)},S.translateTo=function(ce,me,te,le,Z){S.transform(ce,function(){var Y=e.apply(this,arguments),he=this.__zoom,oe=le==null?I(Y):typeof le=="function"?le.apply(this,arguments):le;return r(identity.translate(oe[0],oe[1]).scale(he.k).translate(typeof me=="function"?-me.apply(this,arguments):-me,typeof te=="function"?-te.apply(this,arguments):-te),Y,o)},le,Z)};function P(ce,me){return me=Math.max(a[0],Math.min(a[1],me)),me===ce.k?ce:new Transform(me,ce.x,ce.y)}function A(ce,me,te){var le=me[0]-te[0]*ce.k,Z=me[1]-te[1]*ce.k;return le===ce.x&&Z===ce.y?ce:new Transform(ce.k,le,Z)}function I(ce){return[(+ce[0][0]+ +ce[1][0])/2,(+ce[0][1]+ +ce[1][1])/2]}function j(ce,me,te,le){ce.on("start.zoom",function(){K(this,arguments).event(le).start()}).on("interrupt.zoom end.zoom",function(){K(this,arguments).event(le).end()}).tween("zoom",function(){var Z=this,Y=arguments,he=K(Z,Y).event(le),oe=e.apply(Z,Y),ye=te==null?I(oe):typeof te=="function"?te.apply(Z,Y):te,Ee=Math.max(oe[1][0]-oe[0][0],oe[1][1]-oe[0][1]),Ae=Z.__zoom,je=typeof me=="function"?me.apply(Z,Y):me,Te=u(Ae.invert(ye).concat(Ee/Ae.k),je.invert(ye).concat(Ee/je.k));return function(Ve){if(Ve===1)Ve=je;else{var Pe=Te(Ve),Ce=Ee/Pe[2];Ve=new Transform(Ce,ye[0]-Pe[0]*Ce,ye[1]-Pe[1]*Ce)}he.zoom(null,Ve)}})}function K(ce,me,te){return!te&&ce.__zooming||new W(ce,me)}function W(ce,me){this.that=ce,this.args=me,this.active=0,this.sourceEvent=null,this.extent=e.apply(ce,me),this.taps=0}W.prototype={event:function(ce){return ce&&(this.sourceEvent=ce),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(ce,me){return this.mouse&&ce!=="mouse"&&(this.mouse[1]=me.invert(this.mouse[0])),this.touch0&&ce!=="touch"&&(this.touch0[1]=me.invert(this.touch0[0])),this.touch1&&ce!=="touch"&&(this.touch1[1]=me.invert(this.touch1[0])),this.that.__zoom=me,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(ce){var me=select(this.that).datum();c.call(ce,this.that,new ZoomEvent(ce,{sourceEvent:this.sourceEvent,target:S,transform:this.that.__zoom,dispatch:c}),me)}};function H(ce,...me){if(!t.apply(this,arguments))return;var te=K(this,me).event(ce),le=this.__zoom,Z=Math.max(a[0],Math.min(a[1],le.k*Math.pow(2,n.apply(this,arguments)))),Y=pointer(ce);if(te.wheel)(te.mouse[0][0]!==Y[0]||te.mouse[0][1]!==Y[1])&&(te.mouse[1]=le.invert(te.mouse[0]=Y)),clearTimeout(te.wheel);else{if(le.k===Z)return;te.mouse=[Y,le.invert(Y)],interrupt(this),te.start()}noevent(ce),te.wheel=setTimeout(he,b),te.zoom("mouse",r(A(P(le,Z),te.mouse[0],te.mouse[1]),te.extent,o));function he(){te.wheel=null,te.end()}}function ee(ce,...me){if(m||!t.apply(this,arguments))return;var te=ce.currentTarget,le=K(this,me,!0).event(ce),Z=select(ce.view).on("mousemove.zoom",ye,!0).on("mouseup.zoom",Ee,!0),Y=pointer(ce,te),he=ce.clientX,oe=ce.clientY;dragDisable(ce.view),nopropagation(ce),le.mouse=[Y,this.__zoom.invert(Y)],interrupt(this),le.start();function ye(Ae){if(noevent(Ae),!le.moved){var je=Ae.clientX-he,Te=Ae.clientY-oe;le.moved=je*je+Te*Te>E}le.event(Ae).zoom("mouse",r(A(le.that.__zoom,le.mouse[0]=pointer(Ae,te),le.mouse[1]),le.extent,o))}function Ee(Ae){Z.on("mousemove.zoom mouseup.zoom",null),yesdrag(Ae.view,le.moved),noevent(Ae),le.event(Ae).end()}}function ue(ce,...me){if(t.apply(this,arguments)){var te=this.__zoom,le=pointer(ce.changedTouches?ce.changedTouches[0]:ce,this),Z=te.invert(le),Y=te.k*(ce.shiftKey?.5:2),he=r(A(P(te,Y),le,Z),e.apply(this,me),o);noevent(ce),l>0?select(this).transition().duration(l).call(j,he,le,ce):select(this).call(S.transform,he,le,ce)}}function de(ce,...me){if(t.apply(this,arguments)){var te=ce.touches,le=te.length,Z=K(this,me,ce.changedTouches.length===le).event(ce),Y,he,oe,ye;for(nopropagation(ce),he=0;he<le;++he)oe=te[he],ye=pointer(oe,this),ye=[ye,this.__zoom.invert(ye),oe.identifier],Z.touch0?!Z.touch1&&Z.touch0[2]!==ye[2]&&(Z.touch1=ye,Z.taps=0):(Z.touch0=ye,Y=!0,Z.taps=1+!!d);d&&(d=clearTimeout(d)),Y&&(Z.taps<2&&(p=ye[0],d=setTimeout(function(){d=null},y)),interrupt(this),Z.start())}}function fe(ce,...me){if(this.__zooming){var te=K(this,me).event(ce),le=ce.changedTouches,Z=le.length,Y,he,oe,ye;for(noevent(ce),Y=0;Y<Z;++Y)he=le[Y],oe=pointer(he,this),te.touch0&&te.touch0[2]===he.identifier?te.touch0[0]=oe:te.touch1&&te.touch1[2]===he.identifier&&(te.touch1[0]=oe);if(he=te.that.__zoom,te.touch1){var Ee=te.touch0[0],Ae=te.touch0[1],je=te.touch1[0],Te=te.touch1[1],Ve=(Ve=je[0]-Ee[0])*Ve+(Ve=je[1]-Ee[1])*Ve,Pe=(Pe=Te[0]-Ae[0])*Pe+(Pe=Te[1]-Ae[1])*Pe;he=P(he,Math.sqrt(Ve/Pe)),oe=[(Ee[0]+je[0])/2,(Ee[1]+je[1])/2],ye=[(Ae[0]+Te[0])/2,(Ae[1]+Te[1])/2]}else if(te.touch0)oe=te.touch0[0],ye=te.touch0[1];else return;te.zoom("touch",r(A(he,oe,ye),te.extent,o))}}function ae(ce,...me){if(this.__zooming){var te=K(this,me).event(ce),le=ce.changedTouches,Z=le.length,Y,he;for(nopropagation(ce),m&&clearTimeout(m),m=setTimeout(function(){m=null},y),Y=0;Y<Z;++Y)he=le[Y],te.touch0&&te.touch0[2]===he.identifier?delete te.touch0:te.touch1&&te.touch1[2]===he.identifier&&delete te.touch1;if(te.touch1&&!te.touch0&&(te.touch0=te.touch1,delete te.touch1),te.touch0)te.touch0[1]=this.__zoom.invert(te.touch0[0]);else if(te.end(),te.taps===2&&(he=pointer(he,this),Math.hypot(p[0]-he[0],p[1]-he[1])<T)){var oe=select(this).on("dblclick.zoom");oe&&oe.apply(this,arguments)}}}return S.wheelDelta=function(ce){return arguments.length?(n=typeof ce=="function"?ce:constant(+ce),S):n},S.filter=function(ce){return arguments.length?(t=typeof ce=="function"?ce:constant(!!ce),S):t},S.touchable=function(ce){return arguments.length?(s=typeof ce=="function"?ce:constant(!!ce),S):s},S.extent=function(ce){return arguments.length?(e=typeof ce=="function"?ce:constant([[+ce[0][0],+ce[0][1]],[+ce[1][0],+ce[1][1]]]),S):e},S.scaleExtent=function(ce){return arguments.length?(a[0]=+ce[0],a[1]=+ce[1],S):[a[0],a[1]]},S.translateExtent=function(ce){return arguments.length?(o[0][0]=+ce[0][0],o[1][0]=+ce[1][0],o[0][1]=+ce[0][1],o[1][1]=+ce[1][1],S):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},S.constrain=function(ce){return arguments.length?(r=ce,S):r},S.duration=function(ce){return arguments.length?(l=+ce,S):l},S.interpolate=function(ce){return arguments.length?(u=ce,S):u},S.on=function(){var ce=c.on.apply(c,arguments);return ce===c?S:ce},S.clickDistance=function(ce){return arguments.length?(E=(ce=+ce)*ce,S):Math.sqrt(E)},S.tapDistance=function(ce){return arguments.length?(T=+ce,S):T},S}const StoreContext$1=reactExports.createContext(null),Provider$1$1=StoreContext$1.Provider,errorMessages={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,e)=>`Couldn't create edge for ${t?"target":"source"} handle id: "${t?e.targetHandle:e.sourceHandle}", edge id: ${e.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},zustandErrorMessage=errorMessages.error001();function useStore(t,e){const r=reactExports.useContext(StoreContext$1);if(r===null)throw new Error(zustandErrorMessage);return useStoreWithEqualityFn(r,t,e)}const useStoreApi=()=>{const t=reactExports.useContext(StoreContext$1);if(t===null)throw new Error(zustandErrorMessage);return reactExports.useMemo(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe,destroy:t.destroy}),[t])},selector$g=t=>t.userSelectionActive?"none":"all";function Panel({position:t,children:e,className:r,style:n,...s}){const a=useStore(selector$g),o=`${t}`.split("-");return React.createElement("div",{className:cc(["react-flow__panel",r,...o]),style:{...n,pointerEvents:a},...s},e)}function Attribution({proOptions:t,position:e="bottom-right"}){return t!=null&&t.hideAttribution?null:React.createElement(Panel,{position:e,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},React.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const EdgeText=({x:t,y:e,label:r,labelStyle:n={},labelShowBg:s=!0,labelBgStyle:a={},labelBgPadding:o=[2,4],labelBgBorderRadius:l=2,children:u,className:c,...d})=>{const p=reactExports.useRef(null),[m,y]=reactExports.useState({x:0,y:0,width:0,height:0}),b=cc(["react-flow__edge-textwrapper",c]);return reactExports.useEffect(()=>{if(p.current){const E=p.current.getBBox();y({x:E.x,y:E.y,width:E.width,height:E.height})}},[r]),typeof r>"u"||!r?null:React.createElement("g",{transform:`translate(${t-m.width/2} ${e-m.height/2})`,className:b,visibility:m.width?"visible":"hidden",...d},s&&React.createElement("rect",{width:m.width+2*o[0],x:-o[0],y:-o[1],height:m.height+2*o[1],className:"react-flow__edge-textbg",style:a,rx:l,ry:l}),React.createElement("text",{className:"react-flow__edge-text",y:m.height/2,dy:"0.3em",ref:p,style:n},r),u)};var EdgeText$1=reactExports.memo(EdgeText);const getDimensions$1=t=>({width:t.offsetWidth,height:t.offsetHeight}),clamp$1=(t,e=0,r=1)=>Math.min(Math.max(t,e),r),clampPosition=(t={x:0,y:0},e)=>({x:clamp$1(t.x,e[0][0],e[1][0]),y:clamp$1(t.y,e[0][1],e[1][1])}),calcAutoPanVelocity=(t,e,r)=>t<e?clamp$1(Math.abs(t-e),1,50)/50:t>r?-clamp$1(Math.abs(t-r),1,50)/50:0,calcAutoPan=(t,e)=>{const r=calcAutoPanVelocity(t.x,35,e.width-35)*20,n=calcAutoPanVelocity(t.y,35,e.height-35)*20;return[r,n]},getHostForElement=t=>{var e;return((e=t.getRootNode)==null?void 0:e.call(t))||(window==null?void 0:window.document)},getBoundsOfBoxes=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),rectToBox=({x:t,y:e,width:r,height:n})=>({x:t,y:e,x2:t+r,y2:e+n}),boxToRect=({x:t,y:e,x2:r,y2:n})=>({x:t,y:e,width:r-t,height:n-e}),nodeToRect=t=>({...t.positionAbsolute||{x:0,y:0},width:t.width||0,height:t.height||0}),getOverlappingArea=(t,e)=>{const r=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),n=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(r*n)},isRectObject=t=>isNumeric(t.width)&&isNumeric(t.height)&&isNumeric(t.x)&&isNumeric(t.y),isNumeric=t=>!isNaN(t)&&isFinite(t),internalsSymbol=Symbol.for("internals"),elementSelectionKeys=["Enter"," ","Escape"],devWarn=(t,e)=>{},isReactKeyboardEvent=t=>"nativeEvent"in t;function isInputDOMNode(t){var s,a;const e=isReactKeyboardEvent(t)?t.nativeEvent:t,r=((a=(s=e.composedPath)==null?void 0:s.call(e))==null?void 0:a[0])||t.target;return["INPUT","SELECT","TEXTAREA"].includes(r==null?void 0:r.nodeName)||(r==null?void 0:r.hasAttribute("contenteditable"))||!!(r!=null&&r.closest(".nokey"))}const isMouseEvent=t=>"clientX"in t,getEventPosition=(t,e)=>{var a,o;const r=isMouseEvent(t),n=r?t.clientX:(a=t.touches)==null?void 0:a[0].clientX,s=r?t.clientY:(o=t.touches)==null?void 0:o[0].clientY;return{x:n-((e==null?void 0:e.left)??0),y:s-((e==null?void 0:e.top)??0)}},isMacOs=()=>{var t;return typeof navigator<"u"&&((t=navigator==null?void 0:navigator.userAgent)==null?void 0:t.indexOf("Mac"))>=0},BaseEdge=({id:t,path:e,labelX:r,labelY:n,label:s,labelStyle:a,labelShowBg:o,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:c,style:d,markerEnd:p,markerStart:m,interactionWidth:y=20})=>React.createElement(React.Fragment,null,React.createElement("path",{id:t,style:d,d:e,fill:"none",className:"react-flow__edge-path",markerEnd:p,markerStart:m}),y&&React.createElement("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:y,className:"react-flow__edge-interaction"}),s&&isNumeric(r)&&isNumeric(n)?React.createElement(EdgeText$1,{x:r,y:n,label:s,labelStyle:a,labelShowBg:o,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:c}):null);BaseEdge.displayName="BaseEdge";function getMouseHandler$1(t,e,r){return r===void 0?r:n=>{const s=e().edges.find(a=>a.id===t);s&&r(n,{...s})}}function getEdgeCenter({sourceX:t,sourceY:e,targetX:r,targetY:n}){const s=Math.abs(r-t)/2,a=r<t?r+s:r-s,o=Math.abs(n-e)/2,l=n<e?n+o:n-o;return[a,l,s,o]}function getBezierEdgeCenter({sourceX:t,sourceY:e,targetX:r,targetY:n,sourceControlX:s,sourceControlY:a,targetControlX:o,targetControlY:l}){const u=t*.125+s*.375+o*.375+r*.125,c=e*.125+a*.375+l*.375+n*.125,d=Math.abs(u-t),p=Math.abs(c-e);return[u,c,d,p]}var ConnectionMode;(function(t){t.Strict="strict",t.Loose="loose"})(ConnectionMode||(ConnectionMode={}));var PanOnScrollMode;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(PanOnScrollMode||(PanOnScrollMode={}));var SelectionMode;(function(t){t.Partial="partial",t.Full="full"})(SelectionMode||(SelectionMode={}));var ConnectionLineType;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(ConnectionLineType||(ConnectionLineType={}));var MarkerType;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(MarkerType||(MarkerType={}));var Position;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(Position||(Position={}));function getControl({pos:t,x1:e,y1:r,x2:n,y2:s}){return t===Position.Left||t===Position.Right?[.5*(e+n),r]:[e,.5*(r+s)]}function getSimpleBezierPath({sourceX:t,sourceY:e,sourcePosition:r=Position.Bottom,targetX:n,targetY:s,targetPosition:a=Position.Top}){const[o,l]=getControl({pos:r,x1:t,y1:e,x2:n,y2:s}),[u,c]=getControl({pos:a,x1:n,y1:s,x2:t,y2:e}),[d,p,m,y]=getBezierEdgeCenter({sourceX:t,sourceY:e,targetX:n,targetY:s,sourceControlX:o,sourceControlY:l,targetControlX:u,targetControlY:c});return[`M${t},${e} C${o},${l} ${u},${c} ${n},${s}`,d,p,m,y]}const SimpleBezierEdge=reactExports.memo(({sourceX:t,sourceY:e,targetX:r,targetY:n,sourcePosition:s=Position.Bottom,targetPosition:a=Position.Top,label:o,labelStyle:l,labelShowBg:u,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:p,style:m,markerEnd:y,markerStart:b,interactionWidth:E})=>{const[T,S,P]=getSimpleBezierPath({sourceX:t,sourceY:e,sourcePosition:s,targetX:r,targetY:n,targetPosition:a});return React.createElement(BaseEdge,{path:T,labelX:S,labelY:P,label:o,labelStyle:l,labelShowBg:u,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:p,style:m,markerEnd:y,markerStart:b,interactionWidth:E})});SimpleBezierEdge.displayName="SimpleBezierEdge";const handleDirections={[Position.Left]:{x:-1,y:0},[Position.Right]:{x:1,y:0},[Position.Top]:{x:0,y:-1},[Position.Bottom]:{x:0,y:1}},getDirection=({source:t,sourcePosition:e=Position.Bottom,target:r})=>e===Position.Left||e===Position.Right?t.x<r.x?{x:1,y:0}:{x:-1,y:0}:t.y<r.y?{x:0,y:1}:{x:0,y:-1},distance$1=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function getPoints({source:t,sourcePosition:e=Position.Bottom,target:r,targetPosition:n=Position.Top,center:s,offset:a}){const o=handleDirections[e],l=handleDirections[n],u={x:t.x+o.x*a,y:t.y+o.y*a},c={x:r.x+l.x*a,y:r.y+l.y*a},d=getDirection({source:u,sourcePosition:e,target:c}),p=d.x!==0?"x":"y",m=d[p];let y=[],b,E;const T={x:0,y:0},S={x:0,y:0},[P,A,I,j]=getEdgeCenter({sourceX:t.x,sourceY:t.y,targetX:r.x,targetY:r.y});if(o[p]*l[p]===-1){b=s.x??P,E=s.y??A;const W=[{x:b,y:u.y},{x:b,y:c.y}],H=[{x:u.x,y:E},{x:c.x,y:E}];o[p]===m?y=p==="x"?W:H:y=p==="x"?H:W}else{const W=[{x:u.x,y:c.y}],H=[{x:c.x,y:u.y}];if(p==="x"?y=o.x===m?H:W:y=o.y===m?W:H,e===n){const ae=Math.abs(t[p]-r[p]);if(ae<=a){const ce=Math.min(a-1,a-ae);o[p]===m?T[p]=(u[p]>t[p]?-1:1)*ce:S[p]=(c[p]>r[p]?-1:1)*ce}}if(e!==n){const ae=p==="x"?"y":"x",ce=o[p]===l[ae],me=u[ae]>c[ae],te=u[ae]<c[ae];(o[p]===1&&(!ce&&me||ce&&te)||o[p]!==1&&(!ce&&te||ce&&me))&&(y=p==="x"?W:H)}const ee={x:u.x+T.x,y:u.y+T.y},ue={x:c.x+S.x,y:c.y+S.y},de=Math.max(Math.abs(ee.x-y[0].x),Math.abs(ue.x-y[0].x)),fe=Math.max(Math.abs(ee.y-y[0].y),Math.abs(ue.y-y[0].y));de>=fe?(b=(ee.x+ue.x)/2,E=y[0].y):(b=y[0].x,E=(ee.y+ue.y)/2)}return[[t,{x:u.x+T.x,y:u.y+T.y},...y,{x:c.x+S.x,y:c.y+S.y},r],b,E,I,j]}function getBend(t,e,r,n){const s=Math.min(distance$1(t,e)/2,distance$1(e,r)/2,n),{x:a,y:o}=e;if(t.x===a&&a===r.x||t.y===o&&o===r.y)return`L${a} ${o}`;if(t.y===o){const c=t.x<r.x?-1:1,d=t.y<r.y?1:-1;return`L ${a+s*c},${o}Q ${a},${o} ${a},${o+s*d}`}const l=t.x<r.x?1:-1,u=t.y<r.y?-1:1;return`L ${a},${o+s*u}Q ${a},${o} ${a+s*l},${o}`}function getSmoothStepPath({sourceX:t,sourceY:e,sourcePosition:r=Position.Bottom,targetX:n,targetY:s,targetPosition:a=Position.Top,borderRadius:o=5,centerX:l,centerY:u,offset:c=20}){const[d,p,m,y,b]=getPoints({source:{x:t,y:e},sourcePosition:r,target:{x:n,y:s},targetPosition:a,center:{x:l,y:u},offset:c});return[d.reduce((T,S,P)=>{let A="";return P>0&&P<d.length-1?A=getBend(d[P-1],S,d[P+1],o):A=`${P===0?"M":"L"}${S.x} ${S.y}`,T+=A,T},""),p,m,y,b]}const SmoothStepEdge=reactExports.memo(({sourceX:t,sourceY:e,targetX:r,targetY:n,label:s,labelStyle:a,labelShowBg:o,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:c,style:d,sourcePosition:p=Position.Bottom,targetPosition:m=Position.Top,markerEnd:y,markerStart:b,pathOptions:E,interactionWidth:T})=>{const[S,P,A]=getSmoothStepPath({sourceX:t,sourceY:e,sourcePosition:p,targetX:r,targetY:n,targetPosition:m,borderRadius:E==null?void 0:E.borderRadius,offset:E==null?void 0:E.offset});return React.createElement(BaseEdge,{path:S,labelX:P,labelY:A,label:s,labelStyle:a,labelShowBg:o,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:c,style:d,markerEnd:y,markerStart:b,interactionWidth:T})});SmoothStepEdge.displayName="SmoothStepEdge";const StepEdge=reactExports.memo(t=>{var e;return React.createElement(SmoothStepEdge,{...t,pathOptions:reactExports.useMemo(()=>{var r;return{borderRadius:0,offset:(r=t.pathOptions)==null?void 0:r.offset}},[(e=t.pathOptions)==null?void 0:e.offset])})});StepEdge.displayName="StepEdge";function getStraightPath({sourceX:t,sourceY:e,targetX:r,targetY:n}){const[s,a,o,l]=getEdgeCenter({sourceX:t,sourceY:e,targetX:r,targetY:n});return[`M ${t},${e}L ${r},${n}`,s,a,o,l]}const StraightEdge=reactExports.memo(({sourceX:t,sourceY:e,targetX:r,targetY:n,label:s,labelStyle:a,labelShowBg:o,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:c,style:d,markerEnd:p,markerStart:m,interactionWidth:y})=>{const[b,E,T]=getStraightPath({sourceX:t,sourceY:e,targetX:r,targetY:n});return React.createElement(BaseEdge,{path:b,labelX:E,labelY:T,label:s,labelStyle:a,labelShowBg:o,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:c,style:d,markerEnd:p,markerStart:m,interactionWidth:y})});StraightEdge.displayName="StraightEdge";function calculateControlOffset(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function getControlWithCurvature({pos:t,x1:e,y1:r,x2:n,y2:s,c:a}){switch(t){case Position.Left:return[e-calculateControlOffset(e-n,a),r];case Position.Right:return[e+calculateControlOffset(n-e,a),r];case Position.Top:return[e,r-calculateControlOffset(r-s,a)];case Position.Bottom:return[e,r+calculateControlOffset(s-r,a)]}}function getBezierPath({sourceX:t,sourceY:e,sourcePosition:r=Position.Bottom,targetX:n,targetY:s,targetPosition:a=Position.Top,curvature:o=.25}){const[l,u]=getControlWithCurvature({pos:r,x1:t,y1:e,x2:n,y2:s,c:o}),[c,d]=getControlWithCurvature({pos:a,x1:n,y1:s,x2:t,y2:e,c:o}),[p,m,y,b]=getBezierEdgeCenter({sourceX:t,sourceY:e,targetX:n,targetY:s,sourceControlX:l,sourceControlY:u,targetControlX:c,targetControlY:d});return[`M${t},${e} C${l},${u} ${c},${d} ${n},${s}`,p,m,y,b]}const BezierEdge=reactExports.memo(({sourceX:t,sourceY:e,targetX:r,targetY:n,sourcePosition:s=Position.Bottom,targetPosition:a=Position.Top,label:o,labelStyle:l,labelShowBg:u,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:p,style:m,markerEnd:y,markerStart:b,pathOptions:E,interactionWidth:T})=>{const[S,P,A]=getBezierPath({sourceX:t,sourceY:e,sourcePosition:s,targetX:r,targetY:n,targetPosition:a,curvature:E==null?void 0:E.curvature});return React.createElement(BaseEdge,{path:S,labelX:P,labelY:A,label:o,labelStyle:l,labelShowBg:u,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:p,style:m,markerEnd:y,markerStart:b,interactionWidth:T})});BezierEdge.displayName="BezierEdge";const NodeIdContext=reactExports.createContext(null),Provider$2=NodeIdContext.Provider;NodeIdContext.Consumer;const useNodeId=()=>reactExports.useContext(NodeIdContext),isEdge=t=>"id"in t&&"source"in t&&"target"in t,getEdgeId=({source:t,sourceHandle:e,target:r,targetHandle:n})=>`reactflow__edge-${t}${e||""}-${r}${n||""}`,getMarkerId=(t,e)=>typeof t>"u"?"":typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(n=>`${n}=${t[n]}`).join("&")}`,connectionExists=(t,e)=>e.some(r=>r.source===t.source&&r.target===t.target&&(r.sourceHandle===t.sourceHandle||!r.sourceHandle&&!t.sourceHandle)&&(r.targetHandle===t.targetHandle||!r.targetHandle&&!t.targetHandle)),addEdge=(t,e)=>{if(!t.source||!t.target)return e;let r;return isEdge(t)?r={...t}:r={...t,id:getEdgeId(t)},connectionExists(r,e)?e:e.concat(r)},pointToRendererPoint=({x:t,y:e},[r,n,s],a,[o,l])=>{const u={x:(t-r)/s,y:(e-n)/s};return a?{x:o*Math.round(u.x/o),y:l*Math.round(u.y/l)}:u},rendererPointToPoint=({x:t,y:e},[r,n,s])=>({x:t*s+r,y:e*s+n}),getNodePositionWithOrigin=(t,e=[0,0])=>{if(!t)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const r=(t.width??0)*e[0],n=(t.height??0)*e[1],s={x:t.position.x-r,y:t.position.y-n};return{...s,positionAbsolute:t.positionAbsolute?{x:t.positionAbsolute.x-r,y:t.positionAbsolute.y-n}:s}},getNodesBounds=(t,e=[0,0])=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const r=t.reduce((n,s)=>{const{x:a,y:o}=getNodePositionWithOrigin(s,e).positionAbsolute;return getBoundsOfBoxes(n,rectToBox({x:a,y:o,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return boxToRect(r)},getNodesInside=(t,e,[r,n,s]=[0,0,1],a=!1,o=!1,l=[0,0])=>{const u={x:(e.x-r)/s,y:(e.y-n)/s,width:e.width/s,height:e.height/s},c=[];return t.forEach(d=>{const{width:p,height:m,selectable:y=!0,hidden:b=!1}=d;if(o&&!y||b)return!1;const{positionAbsolute:E}=getNodePositionWithOrigin(d,l),T={x:E.x,y:E.y,width:p||0,height:m||0},S=getOverlappingArea(u,T),P=typeof p>"u"||typeof m>"u"||p===null||m===null,A=a&&S>0,I=(p||0)*(m||0);(P||A||S>=I||d.dragging)&&c.push(d)}),c},getConnectedEdges=(t,e)=>{const r=t.map(n=>n.id);return e.filter(n=>r.includes(n.source)||r.includes(n.target))},getViewportForBounds=(t,e,r,n,s,a=.1)=>{const o=e/(t.width*(1+a)),l=r/(t.height*(1+a)),u=Math.min(o,l),c=clamp$1(u,n,s),d=t.x+t.width/2,p=t.y+t.height/2,m=e/2-d*c,y=r/2-p*c;return{x:m,y,zoom:c}},getD3Transition=(t,e=0)=>t.transition().duration(e);function getHandles(t,e,r,n){return(e[r]||[]).reduce((s,a)=>{var o,l;return`${t.id}-${a.id}-${r}`!==n&&s.push({id:a.id||null,type:r,nodeId:t.id,x:(((o=t.positionAbsolute)==null?void 0:o.x)??0)+a.x+a.width/2,y:(((l=t.positionAbsolute)==null?void 0:l.y)??0)+a.y+a.height/2}),s},[])}function getClosestHandle(t,e,r,n,s,a){const{x:o,y:l}=getEventPosition(t),c=e.elementsFromPoint(o,l).find(b=>b.classList.contains("react-flow__handle"));if(c){const b=c.getAttribute("data-nodeid");if(b){const E=getHandleType(void 0,c),T=c.getAttribute("data-handleid"),S=a({nodeId:b,id:T,type:E});if(S){const P=s.find(A=>A.nodeId===b&&A.type===E&&A.id===T);return{handle:{id:T,type:E,nodeId:b,x:(P==null?void 0:P.x)||r.x,y:(P==null?void 0:P.y)||r.y},validHandleResult:S}}}}let d=[],p=1/0;if(s.forEach(b=>{const E=Math.sqrt((b.x-r.x)**2+(b.y-r.y)**2);if(E<=n){const T=a(b);E<=p&&(E<p?d=[{handle:b,validHandleResult:T}]:E===p&&d.push({handle:b,validHandleResult:T}),p=E)}}),!d.length)return{handle:null,validHandleResult:defaultResult()};if(d.length===1)return d[0];const m=d.some(({validHandleResult:b})=>b.isValid),y=d.some(({handle:b})=>b.type==="target");return d.find(({handle:b,validHandleResult:E})=>y?b.type==="target":m?E.isValid:!0)||d[0]}const nullConnection={source:null,target:null,sourceHandle:null,targetHandle:null},defaultResult=()=>({handleDomNode:null,isValid:!1,connection:nullConnection,endHandle:null});function isValidHandle(t,e,r,n,s,a,o){const l=s==="target",u=o.querySelector(`.react-flow__handle[data-id="${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`),c={...defaultResult(),handleDomNode:u};if(u){const d=getHandleType(void 0,u),p=u.getAttribute("data-nodeid"),m=u.getAttribute("data-handleid"),y=u.classList.contains("connectable"),b=u.classList.contains("connectableend"),E={source:l?p:r,sourceHandle:l?m:n,target:l?r:p,targetHandle:l?n:m};c.connection=E,y&&b&&(e===ConnectionMode.Strict?l&&d==="source"||!l&&d==="target":p!==r||m!==n)&&(c.endHandle={nodeId:p,handleId:m,type:d},c.isValid=a(E))}return c}function getHandleLookup({nodes:t,nodeId:e,handleId:r,handleType:n}){return t.reduce((s,a)=>{if(a[internalsSymbol]){const{handleBounds:o}=a[internalsSymbol];let l=[],u=[];o&&(l=getHandles(a,o,"source",`${e}-${r}-${n}`),u=getHandles(a,o,"target",`${e}-${r}-${n}`)),s.push(...l,...u)}return s},[])}function getHandleType(t,e){return t||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function resetRecentHandle(t){t==null||t.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function getConnectionStatus(t,e){let r=null;return e?r="valid":t&&!e&&(r="invalid"),r}function handlePointerDown({event:t,handleId:e,nodeId:r,onConnect:n,isTarget:s,getState:a,setState:o,isValidConnection:l,edgeUpdaterType:u,onReconnectEnd:c}){const d=getHostForElement(t.target),{connectionMode:p,domNode:m,autoPanOnConnect:y,connectionRadius:b,onConnectStart:E,panBy:T,getNodes:S,cancelConnection:P}=a();let A=0,I;const{x:j,y:K}=getEventPosition(t),W=d==null?void 0:d.elementFromPoint(j,K),H=getHandleType(u,W),ee=m==null?void 0:m.getBoundingClientRect();if(!ee||!H)return;let ue,de=getEventPosition(t,ee),fe=!1,ae=null,ce=!1,me=null;const te=getHandleLookup({nodes:S(),nodeId:r,handleId:e,handleType:H}),le=()=>{if(!y)return;const[he,oe]=calcAutoPan(de,ee);T({x:he,y:oe}),A=requestAnimationFrame(le)};o({connectionPosition:de,connectionStatus:null,connectionNodeId:r,connectionHandleId:e,connectionHandleType:H,connectionStartHandle:{nodeId:r,handleId:e,type:H},connectionEndHandle:null}),E==null||E(t,{nodeId:r,handleId:e,handleType:H});function Z(he){const{transform:oe}=a();de=getEventPosition(he,ee);const{handle:ye,validHandleResult:Ee}=getClosestHandle(he,d,pointToRendererPoint(de,oe,!1,[1,1]),b,te,Ae=>isValidHandle(Ae,p,r,e,s?"target":"source",l,d));if(I=ye,fe||(le(),fe=!0),me=Ee.handleDomNode,ae=Ee.connection,ce=Ee.isValid,o({connectionPosition:I&&ce?rendererPointToPoint({x:I.x,y:I.y},oe):de,connectionStatus:getConnectionStatus(!!I,ce),connectionEndHandle:Ee.endHandle}),!I&&!ce&&!me)return resetRecentHandle(ue);ae.source!==ae.target&&me&&(resetRecentHandle(ue),ue=me,me.classList.add("connecting","react-flow__handle-connecting"),me.classList.toggle("valid",ce),me.classList.toggle("react-flow__handle-valid",ce))}function Y(he){var oe,ye;(I||me)&&ae&&ce&&(n==null||n(ae)),(ye=(oe=a()).onConnectEnd)==null||ye.call(oe,he),u&&(c==null||c(he)),resetRecentHandle(ue),P(),cancelAnimationFrame(A),fe=!1,ce=!1,ae=null,me=null,d.removeEventListener("mousemove",Z),d.removeEventListener("mouseup",Y),d.removeEventListener("touchmove",Z),d.removeEventListener("touchend",Y)}d.addEventListener("mousemove",Z),d.addEventListener("mouseup",Y),d.addEventListener("touchmove",Z),d.addEventListener("touchend",Y)}const alwaysValid=()=>!0,selector$f=t=>({connectionStartHandle:t.connectionStartHandle,connectOnClick:t.connectOnClick,noPanClassName:t.noPanClassName}),connectingSelector=(t,e,r)=>n=>{const{connectionStartHandle:s,connectionEndHandle:a,connectionClickStartHandle:o}=n;return{connecting:(s==null?void 0:s.nodeId)===t&&(s==null?void 0:s.handleId)===e&&(s==null?void 0:s.type)===r||(a==null?void 0:a.nodeId)===t&&(a==null?void 0:a.handleId)===e&&(a==null?void 0:a.type)===r,clickConnecting:(o==null?void 0:o.nodeId)===t&&(o==null?void 0:o.handleId)===e&&(o==null?void 0:o.type)===r}},Handle=reactExports.forwardRef(({type:t="source",position:e=Position.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:s=!0,isConnectableEnd:a=!0,id:o,onConnect:l,children:u,className:c,onMouseDown:d,onTouchStart:p,...m},y)=>{var ee,ue;const b=o||null,E=t==="target",T=useStoreApi(),S=useNodeId(),{connectOnClick:P,noPanClassName:A}=useStore(selector$f,shallow$1$2),{connecting:I,clickConnecting:j}=useStore(connectingSelector(S,b,t),shallow$1$2);S||(ue=(ee=T.getState()).onError)==null||ue.call(ee,"010",errorMessages.error010());const K=de=>{const{defaultEdgeOptions:fe,onConnect:ae,hasDefaultEdges:ce}=T.getState(),me={...fe,...de};if(ce){const{edges:te,setEdges:le}=T.getState();le(addEdge(me,te))}ae==null||ae(me),l==null||l(me)},W=de=>{if(!S)return;const fe=isMouseEvent(de);s&&(fe&&de.button===0||!fe)&&handlePointerDown({event:de,handleId:b,nodeId:S,onConnect:K,isTarget:E,getState:T.getState,setState:T.setState,isValidConnection:r||T.getState().isValidConnection||alwaysValid}),fe?d==null||d(de):p==null||p(de)},H=de=>{const{onClickConnectStart:fe,onClickConnectEnd:ae,connectionClickStartHandle:ce,connectionMode:me,isValidConnection:te}=T.getState();if(!S||!ce&&!s)return;if(!ce){fe==null||fe(de,{nodeId:S,handleId:b,handleType:t}),T.setState({connectionClickStartHandle:{nodeId:S,type:t,handleId:b}});return}const le=getHostForElement(de.target),Z=r||te||alwaysValid,{connection:Y,isValid:he}=isValidHandle({nodeId:S,id:b,type:t},me,ce.nodeId,ce.handleId||null,ce.type,Z,le);he&&K(Y),ae==null||ae(de),T.setState({connectionClickStartHandle:null})};return React.createElement("div",{"data-handleid":b,"data-nodeid":S,"data-handlepos":e,"data-id":`${S}-${b}-${t}`,className:cc(["react-flow__handle",`react-flow__handle-${e}`,"nodrag",A,c,{source:!E,target:E,connectable:n,connectablestart:s,connectableend:a,connecting:j,connectionindicator:n&&(s&&!I||a&&I)}]),onMouseDown:W,onTouchStart:W,onClick:P?H:void 0,ref:y,...m},u)});Handle.displayName="Handle";var Handle$1=reactExports.memo(Handle);const DefaultNode=({data:t,isConnectable:e,targetPosition:r=Position.Top,sourcePosition:n=Position.Bottom})=>React.createElement(React.Fragment,null,React.createElement(Handle$1,{type:"target",position:r,isConnectable:e}),t==null?void 0:t.label,React.createElement(Handle$1,{type:"source",position:n,isConnectable:e}));DefaultNode.displayName="DefaultNode";var DefaultNode$1=reactExports.memo(DefaultNode);const InputNode=({data:t,isConnectable:e,sourcePosition:r=Position.Bottom})=>React.createElement(React.Fragment,null,t==null?void 0:t.label,React.createElement(Handle$1,{type:"source",position:r,isConnectable:e}));InputNode.displayName="InputNode";var InputNode$1=reactExports.memo(InputNode);const OutputNode=({data:t,isConnectable:e,targetPosition:r=Position.Top})=>React.createElement(React.Fragment,null,React.createElement(Handle$1,{type:"target",position:r,isConnectable:e}),t==null?void 0:t.label);OutputNode.displayName="OutputNode";var OutputNode$1=reactExports.memo(OutputNode);const GroupNode=()=>null;GroupNode.displayName="GroupNode";const selector$e=t=>({selectedNodes:t.getNodes().filter(e=>e.selected),selectedEdges:t.edges.filter(e=>e.selected).map(e=>({...e}))}),selectId=t=>t.id;function areEqual(t,e){return shallow$1$2(t.selectedNodes.map(selectId),e.selectedNodes.map(selectId))&&shallow$1$2(t.selectedEdges.map(selectId),e.selectedEdges.map(selectId))}const SelectionListener=reactExports.memo(({onSelectionChange:t})=>{const e=useStoreApi(),{selectedNodes:r,selectedEdges:n}=useStore(selector$e,areEqual);return reactExports.useEffect(()=>{const s={nodes:r,edges:n};t==null||t(s),e.getState().onSelectionChange.forEach(a=>a(s))},[r,n,t]),null});SelectionListener.displayName="SelectionListener";const changeSelector=t=>!!t.onSelectionChange;function Wrapper$1({onSelectionChange:t}){const e=useStore(changeSelector);return t||e?React.createElement(SelectionListener,{onSelectionChange:t}):null}const selector$d=t=>({setNodes:t.setNodes,setEdges:t.setEdges,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset});function useStoreUpdater(t,e){reactExports.useEffect(()=>{typeof t<"u"&&e(t)},[t])}function useDirectStoreUpdater(t,e,r){reactExports.useEffect(()=>{typeof e<"u"&&r({[t]:e})},[e])}const StoreUpdater=({nodes:t,edges:e,defaultNodes:r,defaultEdges:n,onConnect:s,onConnectStart:a,onConnectEnd:o,onClickConnectStart:l,onClickConnectEnd:u,nodesDraggable:c,nodesConnectable:d,nodesFocusable:p,edgesFocusable:m,edgesUpdatable:y,elevateNodesOnSelect:b,minZoom:E,maxZoom:T,nodeExtent:S,onNodesChange:P,onEdgesChange:A,elementsSelectable:I,connectionMode:j,snapGrid:K,snapToGrid:W,translateExtent:H,connectOnClick:ee,defaultEdgeOptions:ue,fitView:de,fitViewOptions:fe,onNodesDelete:ae,onEdgesDelete:ce,onNodeDrag:me,onNodeDragStart:te,onNodeDragStop:le,onSelectionDrag:Z,onSelectionDragStart:Y,onSelectionDragStop:he,noPanClassName:oe,nodeOrigin:ye,rfId:Ee,autoPanOnConnect:Ae,autoPanOnNodeDrag:je,onError:Te,connectionRadius:Ve,isValidConnection:Pe,nodeDragThreshold:Ce})=>{const{setNodes:De,setEdges:ze,setDefaultNodesAndEdges:Et,setMinZoom:Ze,setMaxZoom:Ue,setTranslateExtent:qt,setNodeExtent:or,reset:Lt}=useStore(selector$d,shallow$1$2),rt=useStoreApi();return reactExports.useEffect(()=>{const lr=n==null?void 0:n.map(ir=>({...ir,...ue}));return Et(r,lr),()=>{Lt()}},[]),useDirectStoreUpdater("defaultEdgeOptions",ue,rt.setState),useDirectStoreUpdater("connectionMode",j,rt.setState),useDirectStoreUpdater("onConnect",s,rt.setState),useDirectStoreUpdater("onConnectStart",a,rt.setState),useDirectStoreUpdater("onConnectEnd",o,rt.setState),useDirectStoreUpdater("onClickConnectStart",l,rt.setState),useDirectStoreUpdater("onClickConnectEnd",u,rt.setState),useDirectStoreUpdater("nodesDraggable",c,rt.setState),useDirectStoreUpdater("nodesConnectable",d,rt.setState),useDirectStoreUpdater("nodesFocusable",p,rt.setState),useDirectStoreUpdater("edgesFocusable",m,rt.setState),useDirectStoreUpdater("edgesUpdatable",y,rt.setState),useDirectStoreUpdater("elementsSelectable",I,rt.setState),useDirectStoreUpdater("elevateNodesOnSelect",b,rt.setState),useDirectStoreUpdater("snapToGrid",W,rt.setState),useDirectStoreUpdater("snapGrid",K,rt.setState),useDirectStoreUpdater("onNodesChange",P,rt.setState),useDirectStoreUpdater("onEdgesChange",A,rt.setState),useDirectStoreUpdater("connectOnClick",ee,rt.setState),useDirectStoreUpdater("fitViewOnInit",de,rt.setState),useDirectStoreUpdater("fitViewOnInitOptions",fe,rt.setState),useDirectStoreUpdater("onNodesDelete",ae,rt.setState),useDirectStoreUpdater("onEdgesDelete",ce,rt.setState),useDirectStoreUpdater("onNodeDrag",me,rt.setState),useDirectStoreUpdater("onNodeDragStart",te,rt.setState),useDirectStoreUpdater("onNodeDragStop",le,rt.setState),useDirectStoreUpdater("onSelectionDrag",Z,rt.setState),useDirectStoreUpdater("onSelectionDragStart",Y,rt.setState),useDirectStoreUpdater("onSelectionDragStop",he,rt.setState),useDirectStoreUpdater("noPanClassName",oe,rt.setState),useDirectStoreUpdater("nodeOrigin",ye,rt.setState),useDirectStoreUpdater("rfId",Ee,rt.setState),useDirectStoreUpdater("autoPanOnConnect",Ae,rt.setState),useDirectStoreUpdater("autoPanOnNodeDrag",je,rt.setState),useDirectStoreUpdater("onError",Te,rt.setState),useDirectStoreUpdater("connectionRadius",Ve,rt.setState),useDirectStoreUpdater("isValidConnection",Pe,rt.setState),useDirectStoreUpdater("nodeDragThreshold",Ce,rt.setState),useStoreUpdater(t,De),useStoreUpdater(e,ze),useStoreUpdater(E,Ze),useStoreUpdater(T,Ue),useStoreUpdater(H,qt),useStoreUpdater(S,or),null},style$1={display:"none"},ariaLiveStyle={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},ARIA_NODE_DESC_KEY="react-flow__node-desc",ARIA_EDGE_DESC_KEY="react-flow__edge-desc",ARIA_LIVE_MESSAGE="react-flow__aria-live",selector$c=t=>t.ariaLiveMessage;function AriaLiveMessage({rfId:t}){const e=useStore(selector$c);return React.createElement("div",{id:`${ARIA_LIVE_MESSAGE}-${t}`,"aria-live":"assertive","aria-atomic":"true",style:ariaLiveStyle},e)}function A11yDescriptions({rfId:t,disableKeyboardA11y:e}){return React.createElement(React.Fragment,null,React.createElement("div",{id:`${ARIA_NODE_DESC_KEY}-${t}`,style:style$1},"Press enter or space to select a node.",!e&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),React.createElement("div",{id:`${ARIA_EDGE_DESC_KEY}-${t}`,style:style$1},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!e&&React.createElement(AriaLiveMessage,{rfId:t}))}var useKeyPress=(t=null,e={actInsideInputWithModifier:!0})=>{const[r,n]=reactExports.useState(!1),s=reactExports.useRef(!1),a=reactExports.useRef(new Set([])),[o,l]=reactExports.useMemo(()=>{if(t!==null){const c=(Array.isArray(t)?t:[t]).filter(p=>typeof p=="string").map(p=>p.split("+")),d=c.reduce((p,m)=>p.concat(...m),[]);return[c,d]}return[[],[]]},[t]);return reactExports.useEffect(()=>{const u=typeof document<"u"?document:null,c=(e==null?void 0:e.target)||u;if(t!==null){const d=y=>{if(s.current=y.ctrlKey||y.metaKey||y.shiftKey,(!s.current||s.current&&!e.actInsideInputWithModifier)&&isInputDOMNode(y))return!1;const E=useKeyOrCode(y.code,l);a.current.add(y[E]),isMatchingKey(o,a.current,!1)&&(y.preventDefault(),n(!0))},p=y=>{if((!s.current||s.current&&!e.actInsideInputWithModifier)&&isInputDOMNode(y))return!1;const E=useKeyOrCode(y.code,l);isMatchingKey(o,a.current,!0)?(n(!1),a.current.clear()):a.current.delete(y[E]),y.key==="Meta"&&a.current.clear(),s.current=!1},m=()=>{a.current.clear(),n(!1)};return c==null||c.addEventListener("keydown",d),c==null||c.addEventListener("keyup",p),window.addEventListener("blur",m),()=>{c==null||c.removeEventListener("keydown",d),c==null||c.removeEventListener("keyup",p),window.removeEventListener("blur",m)}}},[t,n]),r};function isMatchingKey(t,e,r){return t.filter(n=>r||n.length===e.size).some(n=>n.every(s=>e.has(s)))}function useKeyOrCode(t,e){return e.includes(t)?"code":"key"}function calculateXYZPosition(t,e,r,n){var l,u;const s=t.parentNode||t.parentId;if(!s)return r;const a=e.get(s),o=getNodePositionWithOrigin(a,n);return calculateXYZPosition(a,e,{x:(r.x??0)+o.x,y:(r.y??0)+o.y,z:(((l=a[internalsSymbol])==null?void 0:l.z)??0)>(r.z??0)?((u=a[internalsSymbol])==null?void 0:u.z)??0:r.z??0},n)}function updateAbsoluteNodePositions(t,e,r){t.forEach(n=>{var a;const s=n.parentNode||n.parentId;if(s&&!t.has(s))throw new Error(`Parent node ${s} not found`);if(s||r!=null&&r[n.id]){const{x:o,y:l,z:u}=calculateXYZPosition(n,t,{...n.position,z:((a=n[internalsSymbol])==null?void 0:a.z)??0},e);n.positionAbsolute={x:o,y:l},n[internalsSymbol].z=u,r!=null&&r[n.id]&&(n[internalsSymbol].isParent=!0)}})}function createNodeInternals(t,e,r,n){const s=new Map,a={},o=n?1e3:0;return t.forEach(l=>{var y;const u=(isNumeric(l.zIndex)?l.zIndex:0)+(l.selected?o:0),c=e.get(l.id),d={...l,positionAbsolute:{x:l.position.x,y:l.position.y}},p=l.parentNode||l.parentId;p&&(a[p]=!0);const m=(c==null?void 0:c.type)&&(c==null?void 0:c.type)!==l.type;Object.defineProperty(d,internalsSymbol,{enumerable:!1,value:{handleBounds:m||(y=c==null?void 0:c[internalsSymbol])==null?void 0:y.handleBounds,z:u}}),s.set(l.id,d)}),updateAbsoluteNodePositions(s,r,a),s}function fitView(t,e={}){const{getNodes:r,width:n,height:s,minZoom:a,maxZoom:o,d3Zoom:l,d3Selection:u,fitViewOnInitDone:c,fitViewOnInit:d,nodeOrigin:p}=t(),m=e.initial&&!c&&d;if(l&&u&&(m||!e.initial)){const b=r().filter(T=>{var P;const S=e.includeHiddenNodes?T.width&&T.height:!T.hidden;return(P=e.nodes)!=null&&P.length?S&&e.nodes.some(A=>A.id===T.id):S}),E=b.every(T=>T.width&&T.height);if(b.length>0&&E){const T=getNodesBounds(b,p),{x:S,y:P,zoom:A}=getViewportForBounds(T,n,s,e.minZoom??a,e.maxZoom??o,e.padding??.1),I=identity.translate(S,P).scale(A);return typeof e.duration=="number"&&e.duration>0?l.transform(getD3Transition(u,e.duration),I):l.transform(u,I),!0}}return!1}function handleControlledNodeSelectionChange(t,e){return t.forEach(r=>{const n=e.get(r.id);n&&e.set(n.id,{...n,[internalsSymbol]:n[internalsSymbol],selected:r.selected})}),new Map(e)}function handleControlledEdgeSelectionChange(t,e){return e.map(r=>{const n=t.find(s=>s.id===r.id);return n&&(r.selected=n.selected),r})}function updateNodesAndEdgesSelections({changedNodes:t,changedEdges:e,get:r,set:n}){const{nodeInternals:s,edges:a,onNodesChange:o,onEdgesChange:l,hasDefaultNodes:u,hasDefaultEdges:c}=r();t!=null&&t.length&&(u&&n({nodeInternals:handleControlledNodeSelectionChange(t,s)}),o==null||o(t)),e!=null&&e.length&&(c&&n({edges:handleControlledEdgeSelectionChange(e,a)}),l==null||l(e))}const noop$3=()=>{},initialViewportHelper={zoomIn:noop$3,zoomOut:noop$3,zoomTo:noop$3,getZoom:()=>1,setViewport:noop$3,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:noop$3,fitBounds:noop$3,project:t=>t,screenToFlowPosition:t=>t,flowToScreenPosition:t=>t,viewportInitialized:!1},selector$b=t=>({d3Zoom:t.d3Zoom,d3Selection:t.d3Selection}),useViewportHelper=()=>{const t=useStoreApi(),{d3Zoom:e,d3Selection:r}=useStore(selector$b,shallow$1$2);return reactExports.useMemo(()=>r&&e?{zoomIn:s=>e.scaleBy(getD3Transition(r,s==null?void 0:s.duration),1.2),zoomOut:s=>e.scaleBy(getD3Transition(r,s==null?void 0:s.duration),1/1.2),zoomTo:(s,a)=>e.scaleTo(getD3Transition(r,a==null?void 0:a.duration),s),getZoom:()=>t.getState().transform[2],setViewport:(s,a)=>{const[o,l,u]=t.getState().transform,c=identity.translate(s.x??o,s.y??l).scale(s.zoom??u);e.transform(getD3Transition(r,a==null?void 0:a.duration),c)},getViewport:()=>{const[s,a,o]=t.getState().transform;return{x:s,y:a,zoom:o}},fitView:s=>fitView(t.getState,s),setCenter:(s,a,o)=>{const{width:l,height:u,maxZoom:c}=t.getState(),d=typeof(o==null?void 0:o.zoom)<"u"?o.zoom:c,p=l/2-s*d,m=u/2-a*d,y=identity.translate(p,m).scale(d);e.transform(getD3Transition(r,o==null?void 0:o.duration),y)},fitBounds:(s,a)=>{const{width:o,height:l,minZoom:u,maxZoom:c}=t.getState(),{x:d,y:p,zoom:m}=getViewportForBounds(s,o,l,u,c,(a==null?void 0:a.padding)??.1),y=identity.translate(d,p).scale(m);e.transform(getD3Transition(r,a==null?void 0:a.duration),y)},project:s=>{const{transform:a,snapToGrid:o,snapGrid:l}=t.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),pointToRendererPoint(s,a,o,l)},screenToFlowPosition:s=>{const{transform:a,snapToGrid:o,snapGrid:l,domNode:u}=t.getState();if(!u)return s;const{x:c,y:d}=u.getBoundingClientRect(),p={x:s.x-c,y:s.y-d};return pointToRendererPoint(p,a,o,l)},flowToScreenPosition:s=>{const{transform:a,domNode:o}=t.getState();if(!o)return s;const{x:l,y:u}=o.getBoundingClientRect(),c=rendererPointToPoint(s,a);return{x:c.x+l,y:c.y+u}},viewportInitialized:!0}:initialViewportHelper,[e,r])};function useReactFlow(){const t=useViewportHelper(),e=useStoreApi(),r=reactExports.useCallback(()=>e.getState().getNodes().map(E=>({...E})),[]),n=reactExports.useCallback(E=>e.getState().nodeInternals.get(E),[]),s=reactExports.useCallback(()=>{const{edges:E=[]}=e.getState();return E.map(T=>({...T}))},[]),a=reactExports.useCallback(E=>{const{edges:T=[]}=e.getState();return T.find(S=>S.id===E)},[]),o=reactExports.useCallback(E=>{const{getNodes:T,setNodes:S,hasDefaultNodes:P,onNodesChange:A}=e.getState(),I=T(),j=typeof E=="function"?E(I):E;if(P)S(j);else if(A){const K=j.length===0?I.map(W=>({type:"remove",id:W.id})):j.map(W=>({item:W,type:"reset"}));A(K)}},[]),l=reactExports.useCallback(E=>{const{edges:T=[],setEdges:S,hasDefaultEdges:P,onEdgesChange:A}=e.getState(),I=typeof E=="function"?E(T):E;if(P)S(I);else if(A){const j=I.length===0?T.map(K=>({type:"remove",id:K.id})):I.map(K=>({item:K,type:"reset"}));A(j)}},[]),u=reactExports.useCallback(E=>{const T=Array.isArray(E)?E:[E],{getNodes:S,setNodes:P,hasDefaultNodes:A,onNodesChange:I}=e.getState();if(A){const K=[...S(),...T];P(K)}else if(I){const j=T.map(K=>({item:K,type:"add"}));I(j)}},[]),c=reactExports.useCallback(E=>{const T=Array.isArray(E)?E:[E],{edges:S=[],setEdges:P,hasDefaultEdges:A,onEdgesChange:I}=e.getState();if(A)P([...S,...T]);else if(I){const j=T.map(K=>({item:K,type:"add"}));I(j)}},[]),d=reactExports.useCallback(()=>{const{getNodes:E,edges:T=[],transform:S}=e.getState(),[P,A,I]=S;return{nodes:E().map(j=>({...j})),edges:T.map(j=>({...j})),viewport:{x:P,y:A,zoom:I}}},[]),p=reactExports.useCallback(({nodes:E,edges:T})=>{const{nodeInternals:S,getNodes:P,edges:A,hasDefaultNodes:I,hasDefaultEdges:j,onNodesDelete:K,onEdgesDelete:W,onNodesChange:H,onEdgesChange:ee}=e.getState(),ue=(E||[]).map(me=>me.id),de=(T||[]).map(me=>me.id),fe=P().reduce((me,te)=>{const le=te.parentNode||te.parentId,Z=!ue.includes(te.id)&&le&&me.find(he=>he.id===le);return(typeof te.deletable=="boolean"?te.deletable:!0)&&(ue.includes(te.id)||Z)&&me.push(te),me},[]),ae=A.filter(me=>typeof me.deletable=="boolean"?me.deletable:!0),ce=ae.filter(me=>de.includes(me.id));if(fe||ce){const me=getConnectedEdges(fe,ae),te=[...ce,...me],le=te.reduce((Z,Y)=>(Z.includes(Y.id)||Z.push(Y.id),Z),[]);if((j||I)&&(j&&e.setState({edges:A.filter(Z=>!le.includes(Z.id))}),I&&(fe.forEach(Z=>{S.delete(Z.id)}),e.setState({nodeInternals:new Map(S)}))),le.length>0&&(W==null||W(te),ee&&ee(le.map(Z=>({id:Z,type:"remove"})))),fe.length>0&&(K==null||K(fe),H)){const Z=fe.map(Y=>({id:Y.id,type:"remove"}));H(Z)}}},[]),m=reactExports.useCallback(E=>{const T=isRectObject(E),S=T?null:e.getState().nodeInternals.get(E.id);return!T&&!S?[null,null,T]:[T?E:nodeToRect(S),S,T]},[]),y=reactExports.useCallback((E,T=!0,S)=>{const[P,A,I]=m(E);return P?(S||e.getState().getNodes()).filter(j=>{if(!I&&(j.id===A.id||!j.positionAbsolute))return!1;const K=nodeToRect(j),W=getOverlappingArea(K,P);return T&&W>0||W>=P.width*P.height}):[]},[]),b=reactExports.useCallback((E,T,S=!0)=>{const[P]=m(E);if(!P)return!1;const A=getOverlappingArea(P,T);return S&&A>0||A>=P.width*P.height},[]);return reactExports.useMemo(()=>({...t,getNodes:r,getNode:n,getEdges:s,getEdge:a,setNodes:o,setEdges:l,addNodes:u,addEdges:c,toObject:d,deleteElements:p,getIntersectingNodes:y,isNodeIntersecting:b}),[t,r,n,s,a,o,l,u,c,d,p,y,b])}const deleteKeyOptions={actInsideInputWithModifier:!1};var useGlobalKeyHandler=({deleteKeyCode:t,multiSelectionKeyCode:e})=>{const r=useStoreApi(),{deleteElements:n}=useReactFlow(),s=useKeyPress(t,deleteKeyOptions),a=useKeyPress(e);reactExports.useEffect(()=>{if(s){const{edges:o,getNodes:l}=r.getState(),u=l().filter(d=>d.selected),c=o.filter(d=>d.selected);n({nodes:u,edges:c}),r.setState({nodesSelectionActive:!1})}},[s]),reactExports.useEffect(()=>{r.setState({multiSelectionActive:a})},[a])};function useResizeHandler(t){const e=useStoreApi();reactExports.useEffect(()=>{let r;const n=()=>{var a,o;if(!t.current)return;const s=getDimensions$1(t.current);(s.height===0||s.width===0)&&((o=(a=e.getState()).onError)==null||o.call(a,"004",errorMessages.error004())),e.setState({width:s.width||500,height:s.height||500})};return n(),window.addEventListener("resize",n),t.current&&(r=new ResizeObserver(()=>n()),r.observe(t.current)),()=>{window.removeEventListener("resize",n),r&&t.current&&r.unobserve(t.current)}},[])}const containerStyle={position:"absolute",width:"100%",height:"100%",top:0,left:0},viewChanged=(t,e)=>t.x!==e.x||t.y!==e.y||t.zoom!==e.k,eventToFlowTransform=t=>({x:t.x,y:t.y,zoom:t.k}),isWrappedWithClass=(t,e)=>t.target.closest(`.${e}`),isRightClickPan=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),wheelDelta=t=>{const e=t.ctrlKey&&isMacOs()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e},selector$a=t=>({d3Zoom:t.d3Zoom,d3Selection:t.d3Selection,d3ZoomHandler:t.d3ZoomHandler,userSelectionActive:t.userSelectionActive}),ZoomPane=({onMove:t,onMoveStart:e,onMoveEnd:r,onPaneContextMenu:n,zoomOnScroll:s=!0,zoomOnPinch:a=!0,panOnScroll:o=!1,panOnScrollSpeed:l=.5,panOnScrollMode:u=PanOnScrollMode.Free,zoomOnDoubleClick:c=!0,elementsSelectable:d,panOnDrag:p=!0,defaultViewport:m,translateExtent:y,minZoom:b,maxZoom:E,zoomActivationKeyCode:T,preventScrolling:S=!0,children:P,noWheelClassName:A,noPanClassName:I})=>{const j=reactExports.useRef(),K=useStoreApi(),W=reactExports.useRef(!1),H=reactExports.useRef(!1),ee=reactExports.useRef(null),ue=reactExports.useRef({x:0,y:0,zoom:0}),{d3Zoom:de,d3Selection:fe,d3ZoomHandler:ae,userSelectionActive:ce}=useStore(selector$a,shallow$1$2),me=useKeyPress(T),te=reactExports.useRef(0),le=reactExports.useRef(!1),Z=reactExports.useRef();return useResizeHandler(ee),reactExports.useEffect(()=>{if(ee.current){const Y=ee.current.getBoundingClientRect(),he=zoom().scaleExtent([b,E]).translateExtent(y),oe=select(ee.current).call(he),ye=identity.translate(m.x,m.y).scale(clamp$1(m.zoom,b,E)),Ee=[[0,0],[Y.width,Y.height]],Ae=he.constrain()(ye,Ee,y);he.transform(oe,Ae),he.wheelDelta(wheelDelta),K.setState({d3Zoom:he,d3Selection:oe,d3ZoomHandler:oe.on("wheel.zoom"),transform:[Ae.x,Ae.y,Ae.k],domNode:ee.current.closest(".react-flow")})}},[]),reactExports.useEffect(()=>{fe&&de&&(o&&!me&&!ce?fe.on("wheel.zoom",Y=>{if(isWrappedWithClass(Y,A))return!1;Y.preventDefault(),Y.stopImmediatePropagation();const he=fe.property("__zoom").k||1;if(Y.ctrlKey&&a){const Pe=pointer(Y),Ce=wheelDelta(Y),De=he*Math.pow(2,Ce);de.scaleTo(fe,De,Pe,Y);return}const oe=Y.deltaMode===1?20:1;let ye=u===PanOnScrollMode.Vertical?0:Y.deltaX*oe,Ee=u===PanOnScrollMode.Horizontal?0:Y.deltaY*oe;!isMacOs()&&Y.shiftKey&&u!==PanOnScrollMode.Vertical&&(ye=Y.deltaY*oe,Ee=0),de.translateBy(fe,-(ye/he)*l,-(Ee/he)*l,{internal:!0});const Ae=eventToFlowTransform(fe.property("__zoom")),{onViewportChangeStart:je,onViewportChange:Te,onViewportChangeEnd:Ve}=K.getState();clearTimeout(Z.current),le.current||(le.current=!0,e==null||e(Y,Ae),je==null||je(Ae)),le.current&&(t==null||t(Y,Ae),Te==null||Te(Ae),Z.current=setTimeout(()=>{r==null||r(Y,Ae),Ve==null||Ve(Ae),le.current=!1},150))},{passive:!1}):typeof ae<"u"&&fe.on("wheel.zoom",function(Y,he){if(!S&&Y.type==="wheel"&&!Y.ctrlKey||isWrappedWithClass(Y,A))return null;Y.preventDefault(),ae.call(this,Y,he)},{passive:!1}))},[ce,o,u,fe,de,ae,me,a,S,A,e,t,r]),reactExports.useEffect(()=>{de&&de.on("start",Y=>{var ye,Ee;if(!Y.sourceEvent||Y.sourceEvent.internal)return null;te.current=(ye=Y.sourceEvent)==null?void 0:ye.button;const{onViewportChangeStart:he}=K.getState(),oe=eventToFlowTransform(Y.transform);W.current=!0,ue.current=oe,((Ee=Y.sourceEvent)==null?void 0:Ee.type)==="mousedown"&&K.setState({paneDragging:!0}),he==null||he(oe),e==null||e(Y.sourceEvent,oe)})},[de,e]),reactExports.useEffect(()=>{de&&(ce&&!W.current?de.on("zoom",null):ce||de.on("zoom",Y=>{var oe;const{onViewportChange:he}=K.getState();if(K.setState({transform:[Y.transform.x,Y.transform.y,Y.transform.k]}),H.current=!!(n&&isRightClickPan(p,te.current??0)),(t||he)&&!((oe=Y.sourceEvent)!=null&&oe.internal)){const ye=eventToFlowTransform(Y.transform);he==null||he(ye),t==null||t(Y.sourceEvent,ye)}}))},[ce,de,t,p,n]),reactExports.useEffect(()=>{de&&de.on("end",Y=>{if(!Y.sourceEvent||Y.sourceEvent.internal)return null;const{onViewportChangeEnd:he}=K.getState();if(W.current=!1,K.setState({paneDragging:!1}),n&&isRightClickPan(p,te.current??0)&&!H.current&&n(Y.sourceEvent),H.current=!1,(r||he)&&viewChanged(ue.current,Y.transform)){const oe=eventToFlowTransform(Y.transform);ue.current=oe,clearTimeout(j.current),j.current=setTimeout(()=>{he==null||he(oe),r==null||r(Y.sourceEvent,oe)},o?150:0)}})},[de,o,p,r,n]),reactExports.useEffect(()=>{de&&de.filter(Y=>{const he=me||s,oe=a&&Y.ctrlKey;if((p===!0||Array.isArray(p)&&p.includes(1))&&Y.button===1&&Y.type==="mousedown"&&(isWrappedWithClass(Y,"react-flow__node")||isWrappedWithClass(Y,"react-flow__edge")))return!0;if(!p&&!he&&!o&&!c&&!a||ce||!c&&Y.type==="dblclick"||isWrappedWithClass(Y,A)&&Y.type==="wheel"||isWrappedWithClass(Y,I)&&(Y.type!=="wheel"||o&&Y.type==="wheel"&&!me)||!a&&Y.ctrlKey&&Y.type==="wheel"||!he&&!o&&!oe&&Y.type==="wheel"||!p&&(Y.type==="mousedown"||Y.type==="touchstart")||Array.isArray(p)&&!p.includes(Y.button)&&Y.type==="mousedown")return!1;const ye=Array.isArray(p)&&p.includes(Y.button)||!Y.button||Y.button<=1;return(!Y.ctrlKey||Y.type==="wheel")&&ye})},[ce,de,s,a,o,c,p,d,me]),React.createElement("div",{className:"react-flow__renderer",ref:ee,style:containerStyle},P)},selector$9=t=>({userSelectionActive:t.userSelectionActive,userSelectionRect:t.userSelectionRect});function UserSelection(){const{userSelectionActive:t,userSelectionRect:e}=useStore(selector$9,shallow$1$2);return t&&e?React.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:e.width,height:e.height,transform:`translate(${e.x}px, ${e.y}px)`}}):null}function handleParentExpand(t,e){const r=e.parentNode||e.parentId,n=t.find(s=>s.id===r);if(n){const s=e.position.x+e.width-n.width,a=e.position.y+e.height-n.height;if(s>0||a>0||e.position.x<0||e.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,s>0&&(n.style.width+=s),a>0&&(n.style.height+=a),e.position.x<0){const o=Math.abs(e.position.x);n.position.x=n.position.x-o,n.style.width+=o,e.position.x=0}if(e.position.y<0){const o=Math.abs(e.position.y);n.position.y=n.position.y-o,n.style.height+=o,e.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function applyChanges(t,e){if(t.some(n=>n.type==="reset"))return t.filter(n=>n.type==="reset").map(n=>n.item);const r=t.filter(n=>n.type==="add").map(n=>n.item);return e.reduce((n,s)=>{const a=t.filter(l=>l.id===s.id);if(a.length===0)return n.push(s),n;const o={...s};for(const l of a)if(l)switch(l.type){case"select":{o.selected=l.selected;break}case"position":{typeof l.position<"u"&&(o.position=l.position),typeof l.positionAbsolute<"u"&&(o.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(o.dragging=l.dragging),o.expandParent&&handleParentExpand(n,o);break}case"dimensions":{typeof l.dimensions<"u"&&(o.width=l.dimensions.width,o.height=l.dimensions.height),typeof l.updateStyle<"u"&&(o.style={...o.style||{},...l.dimensions}),typeof l.resizing=="boolean"&&(o.resizing=l.resizing),o.expandParent&&handleParentExpand(n,o);break}case"remove":return n}return n.push(o),n},r)}function applyNodeChanges(t,e){return applyChanges(t,e)}function applyEdgeChanges(t,e){return applyChanges(t,e)}const createSelectionChange=(t,e)=>({id:t,type:"select",selected:e});function getSelectionChanges(t,e){return t.reduce((r,n)=>{const s=e.includes(n.id);return!n.selected&&s?(n.selected=!0,r.push(createSelectionChange(n.id,!0))):n.selected&&!s&&(n.selected=!1,r.push(createSelectionChange(n.id,!1))),r},[])}const wrapHandler=(t,e)=>r=>{r.target===e.current&&(t==null||t(r))},selector$8=t=>({userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable,dragging:t.paneDragging}),Pane=reactExports.memo(({isSelecting:t,selectionMode:e=SelectionMode.Full,panOnDrag:r,onSelectionStart:n,onSelectionEnd:s,onPaneClick:a,onPaneContextMenu:o,onPaneScroll:l,onPaneMouseEnter:u,onPaneMouseMove:c,onPaneMouseLeave:d,children:p})=>{const m=reactExports.useRef(null),y=useStoreApi(),b=reactExports.useRef(0),E=reactExports.useRef(0),T=reactExports.useRef(),{userSelectionActive:S,elementsSelectable:P,dragging:A}=useStore(selector$8,shallow$1$2),I=()=>{y.setState({userSelectionActive:!1,userSelectionRect:null}),b.current=0,E.current=0},j=ae=>{a==null||a(ae),y.getState().resetSelectedElements(),y.setState({nodesSelectionActive:!1})},K=ae=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){ae.preventDefault();return}o==null||o(ae)},W=l?ae=>l(ae):void 0,H=ae=>{const{resetSelectedElements:ce,domNode:me}=y.getState();if(T.current=me==null?void 0:me.getBoundingClientRect(),!P||!t||ae.button!==0||ae.target!==m.current||!T.current)return;const{x:te,y:le}=getEventPosition(ae,T.current);ce(),y.setState({userSelectionRect:{width:0,height:0,startX:te,startY:le,x:te,y:le}}),n==null||n(ae)},ee=ae=>{const{userSelectionRect:ce,nodeInternals:me,edges:te,transform:le,onNodesChange:Z,onEdgesChange:Y,nodeOrigin:he,getNodes:oe}=y.getState();if(!t||!T.current||!ce)return;y.setState({userSelectionActive:!0,nodesSelectionActive:!1});const ye=getEventPosition(ae,T.current),Ee=ce.startX??0,Ae=ce.startY??0,je={...ce,x:ye.x<Ee?ye.x:Ee,y:ye.y<Ae?ye.y:Ae,width:Math.abs(ye.x-Ee),height:Math.abs(ye.y-Ae)},Te=oe(),Ve=getNodesInside(me,je,le,e===SelectionMode.Partial,!0,he),Pe=getConnectedEdges(Ve,te).map(De=>De.id),Ce=Ve.map(De=>De.id);if(b.current!==Ce.length){b.current=Ce.length;const De=getSelectionChanges(Te,Ce);De.length&&(Z==null||Z(De))}if(E.current!==Pe.length){E.current=Pe.length;const De=getSelectionChanges(te,Pe);De.length&&(Y==null||Y(De))}y.setState({userSelectionRect:je})},ue=ae=>{if(ae.button!==0)return;const{userSelectionRect:ce}=y.getState();!S&&ce&&ae.target===m.current&&(j==null||j(ae)),y.setState({nodesSelectionActive:b.current>0}),I(),s==null||s(ae)},de=ae=>{S&&(y.setState({nodesSelectionActive:b.current>0}),s==null||s(ae)),I()},fe=P&&(t||S);return React.createElement("div",{className:cc(["react-flow__pane",{dragging:A,selection:t}]),onClick:fe?void 0:wrapHandler(j,m),onContextMenu:wrapHandler(K,m),onWheel:wrapHandler(W,m),onMouseEnter:fe?void 0:u,onMouseDown:fe?H:void 0,onMouseMove:fe?ee:c,onMouseUp:fe?ue:void 0,onMouseLeave:fe?de:d,ref:m,style:containerStyle},p,React.createElement(UserSelection,null))});Pane.displayName="Pane";function isParentSelected(t,e){const r=t.parentNode||t.parentId;if(!r)return!1;const n=e.get(r);return n?n.selected?!0:isParentSelected(n,e):!1}function hasSelector(t,e,r){let n=t;do{if(n!=null&&n.matches(e))return!0;if(n===r.current)return!1;n=n.parentElement}while(n);return!1}function getDragItems(t,e,r,n){return Array.from(t.values()).filter(s=>(s.selected||s.id===n)&&(!s.parentNode||s.parentId||!isParentSelected(s,t))&&(s.draggable||e&&typeof s.draggable>"u")).map(s=>{var a,o;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:r.x-(((a=s.positionAbsolute)==null?void 0:a.x)??0),y:r.y-(((o=s.positionAbsolute)==null?void 0:o.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}})}function clampNodeExtent(t,e){return!e||e==="parent"?e:[e[0],[e[1][0]-(t.width||0),e[1][1]-(t.height||0)]]}function calcNextPosition(t,e,r,n,s=[0,0],a){const o=clampNodeExtent(t,t.extent||n);let l=o;const u=t.parentNode||t.parentId;if(t.extent==="parent"&&!t.expandParent)if(u&&t.width&&t.height){const p=r.get(u),{x:m,y}=getNodePositionWithOrigin(p,s).positionAbsolute;l=p&&isNumeric(m)&&isNumeric(y)&&isNumeric(p.width)&&isNumeric(p.height)?[[m+t.width*s[0],y+t.height*s[1]],[m+p.width-t.width+t.width*s[0],y+p.height-t.height+t.height*s[1]]]:l}else a==null||a("005",errorMessages.error005()),l=o;else if(t.extent&&u&&t.extent!=="parent"){const p=r.get(u),{x:m,y}=getNodePositionWithOrigin(p,s).positionAbsolute;l=[[t.extent[0][0]+m,t.extent[0][1]+y],[t.extent[1][0]+m,t.extent[1][1]+y]]}let c={x:0,y:0};if(u){const p=r.get(u);c=getNodePositionWithOrigin(p,s).positionAbsolute}const d=l&&l!=="parent"?clampPosition(e,l):e;return{position:{x:d.x-c.x,y:d.y-c.y},positionAbsolute:d}}function getEventHandlerParams({nodeId:t,dragItems:e,nodeInternals:r}){const n=e.map(s=>({...r.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[t?n.find(s=>s.id===t):n[0],n]}const getHandleBounds=(t,e,r,n)=>{const s=e.querySelectorAll(t);if(!s||!s.length)return null;const a=Array.from(s),o=e.getBoundingClientRect(),l={x:o.width*n[0],y:o.height*n[1]};return a.map(u=>{const c=u.getBoundingClientRect();return{id:u.getAttribute("data-handleid"),position:u.getAttribute("data-handlepos"),x:(c.left-o.left-l.x)/r,y:(c.top-o.top-l.y)/r,...getDimensions$1(u)}})};function getMouseHandler(t,e,r){return r===void 0?r:n=>{const s=e().nodeInternals.get(t);s&&r(n,{...s})}}function handleNodeClick({id:t,store:e,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:s,unselectNodesAndEdges:a,multiSelectionActive:o,nodeInternals:l,onError:u}=e.getState(),c=l.get(t);if(!c){u==null||u("012",errorMessages.error012(t));return}e.setState({nodesSelectionActive:!1}),c.selected?(r||c.selected&&o)&&(a({nodes:[c],edges:[]}),requestAnimationFrame(()=>{var d;return(d=n==null?void 0:n.current)==null?void 0:d.blur()})):s([t])}function useGetPointerPosition(){const t=useStoreApi();return reactExports.useCallback(({sourceEvent:r})=>{const{transform:n,snapGrid:s,snapToGrid:a}=t.getState(),o=r.touches?r.touches[0].clientX:r.clientX,l=r.touches?r.touches[0].clientY:r.clientY,u={x:(o-n[0])/n[2],y:(l-n[1])/n[2]};return{xSnapped:a?s[0]*Math.round(u.x/s[0]):u.x,ySnapped:a?s[1]*Math.round(u.y/s[1]):u.y,...u}},[])}function wrapSelectionDragFunc(t){return(e,r,n)=>t==null?void 0:t(e,n)}function useDrag({nodeRef:t,disabled:e=!1,noDragClassName:r,handleSelector:n,nodeId:s,isSelectable:a,selectNodesOnDrag:o}){const l=useStoreApi(),[u,c]=reactExports.useState(!1),d=reactExports.useRef([]),p=reactExports.useRef({x:null,y:null}),m=reactExports.useRef(0),y=reactExports.useRef(null),b=reactExports.useRef({x:0,y:0}),E=reactExports.useRef(null),T=reactExports.useRef(!1),S=reactExports.useRef(!1),P=reactExports.useRef(!1),A=useGetPointerPosition();return reactExports.useEffect(()=>{if(t!=null&&t.current){const I=select(t.current),j=({x:H,y:ee})=>{const{nodeInternals:ue,onNodeDrag:de,onSelectionDrag:fe,updateNodePositions:ae,nodeExtent:ce,snapGrid:me,snapToGrid:te,nodeOrigin:le,onError:Z}=l.getState();p.current={x:H,y:ee};let Y=!1,he={x:0,y:0,x2:0,y2:0};if(d.current.length>1&&ce){const ye=getNodesBounds(d.current,le);he=rectToBox(ye)}if(d.current=d.current.map(ye=>{const Ee={x:H-ye.distance.x,y:ee-ye.distance.y};te&&(Ee.x=me[0]*Math.round(Ee.x/me[0]),Ee.y=me[1]*Math.round(Ee.y/me[1]));const Ae=[[ce[0][0],ce[0][1]],[ce[1][0],ce[1][1]]];d.current.length>1&&ce&&!ye.extent&&(Ae[0][0]=ye.positionAbsolute.x-he.x+ce[0][0],Ae[1][0]=ye.positionAbsolute.x+(ye.width??0)-he.x2+ce[1][0],Ae[0][1]=ye.positionAbsolute.y-he.y+ce[0][1],Ae[1][1]=ye.positionAbsolute.y+(ye.height??0)-he.y2+ce[1][1]);const je=calcNextPosition(ye,Ee,ue,Ae,le,Z);return Y=Y||ye.position.x!==je.position.x||ye.position.y!==je.position.y,ye.position=je.position,ye.positionAbsolute=je.positionAbsolute,ye}),!Y)return;ae(d.current,!0,!0),c(!0);const oe=s?de:wrapSelectionDragFunc(fe);if(oe&&E.current){const[ye,Ee]=getEventHandlerParams({nodeId:s,dragItems:d.current,nodeInternals:ue});oe(E.current,ye,Ee)}},K=()=>{if(!y.current)return;const[H,ee]=calcAutoPan(b.current,y.current);if(H!==0||ee!==0){const{transform:ue,panBy:de}=l.getState();p.current.x=(p.current.x??0)-H/ue[2],p.current.y=(p.current.y??0)-ee/ue[2],de({x:H,y:ee})&&j(p.current)}m.current=requestAnimationFrame(K)},W=H=>{var le;const{nodeInternals:ee,multiSelectionActive:ue,nodesDraggable:de,unselectNodesAndEdges:fe,onNodeDragStart:ae,onSelectionDragStart:ce}=l.getState();S.current=!0;const me=s?ae:wrapSelectionDragFunc(ce);(!o||!a)&&!ue&&s&&((le=ee.get(s))!=null&&le.selected||fe()),s&&a&&o&&handleNodeClick({id:s,store:l,nodeRef:t});const te=A(H);if(p.current=te,d.current=getDragItems(ee,de,te,s),me&&d.current){const[Z,Y]=getEventHandlerParams({nodeId:s,dragItems:d.current,nodeInternals:ee});me(H.sourceEvent,Z,Y)}};if(e)I.on(".drag",null);else{const H=drag().on("start",ee=>{const{domNode:ue,nodeDragThreshold:de}=l.getState();de===0&&W(ee),P.current=!1;const fe=A(ee);p.current=fe,y.current=(ue==null?void 0:ue.getBoundingClientRect())||null,b.current=getEventPosition(ee.sourceEvent,y.current)}).on("drag",ee=>{var ae,ce;const ue=A(ee),{autoPanOnNodeDrag:de,nodeDragThreshold:fe}=l.getState();if(ee.sourceEvent.type==="touchmove"&&ee.sourceEvent.touches.length>1&&(P.current=!0),!P.current){if(!T.current&&S.current&&de&&(T.current=!0,K()),!S.current){const me=ue.xSnapped-(((ae=p==null?void 0:p.current)==null?void 0:ae.x)??0),te=ue.ySnapped-(((ce=p==null?void 0:p.current)==null?void 0:ce.y)??0);Math.sqrt(me*me+te*te)>fe&&W(ee)}(p.current.x!==ue.xSnapped||p.current.y!==ue.ySnapped)&&d.current&&S.current&&(E.current=ee.sourceEvent,b.current=getEventPosition(ee.sourceEvent,y.current),j(ue))}}).on("end",ee=>{if(!(!S.current||P.current)&&(c(!1),T.current=!1,S.current=!1,cancelAnimationFrame(m.current),d.current)){const{updateNodePositions:ue,nodeInternals:de,onNodeDragStop:fe,onSelectionDragStop:ae}=l.getState(),ce=s?fe:wrapSelectionDragFunc(ae);if(ue(d.current,!1,!1),ce){const[me,te]=getEventHandlerParams({nodeId:s,dragItems:d.current,nodeInternals:de});ce(ee.sourceEvent,me,te)}}}).filter(ee=>{const ue=ee.target;return!ee.button&&(!r||!hasSelector(ue,`.${r}`,t))&&(!n||hasSelector(ue,n,t))});return I.call(H),()=>{I.on(".drag",null)}}}},[t,e,r,n,a,l,s,o,A]),u}function useUpdateNodePositions(){const t=useStoreApi();return reactExports.useCallback(r=>{const{nodeInternals:n,nodeExtent:s,updateNodePositions:a,getNodes:o,snapToGrid:l,snapGrid:u,onError:c,nodesDraggable:d}=t.getState(),p=o().filter(P=>P.selected&&(P.draggable||d&&typeof P.draggable>"u")),m=l?u[0]:5,y=l?u[1]:5,b=r.isShiftPressed?4:1,E=r.x*m*b,T=r.y*y*b,S=p.map(P=>{if(P.positionAbsolute){const A={x:P.positionAbsolute.x+E,y:P.positionAbsolute.y+T};l&&(A.x=u[0]*Math.round(A.x/u[0]),A.y=u[1]*Math.round(A.y/u[1]));const{positionAbsolute:I,position:j}=calcNextPosition(P,A,n,s,void 0,c);P.position=j,P.positionAbsolute=I}return P});a(S,!0,!1)},[])}const arrowKeyDiffs={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var wrapNode=t=>{const e=({id:r,type:n,data:s,xPos:a,yPos:o,xPosOrigin:l,yPosOrigin:u,selected:c,onClick:d,onMouseEnter:p,onMouseMove:m,onMouseLeave:y,onContextMenu:b,onDoubleClick:E,style:T,className:S,isDraggable:P,isSelectable:A,isConnectable:I,isFocusable:j,selectNodesOnDrag:K,sourcePosition:W,targetPosition:H,hidden:ee,resizeObserver:ue,dragHandle:de,zIndex:fe,isParent:ae,noDragClassName:ce,noPanClassName:me,initialized:te,disableKeyboardA11y:le,ariaLabel:Z,rfId:Y,hasHandleBounds:he})=>{const oe=useStoreApi(),ye=reactExports.useRef(null),Ee=reactExports.useRef(null),Ae=reactExports.useRef(W),je=reactExports.useRef(H),Te=reactExports.useRef(n),Ve=A||P||d||p||m||y,Pe=useUpdateNodePositions(),Ce=getMouseHandler(r,oe.getState,p),De=getMouseHandler(r,oe.getState,m),ze=getMouseHandler(r,oe.getState,y),Et=getMouseHandler(r,oe.getState,b),Ze=getMouseHandler(r,oe.getState,E),Ue=Lt=>{const{nodeDragThreshold:rt}=oe.getState();if(A&&(!K||!P||rt>0)&&handleNodeClick({id:r,store:oe,nodeRef:ye}),d){const lr=oe.getState().nodeInternals.get(r);lr&&d(Lt,{...lr})}},qt=Lt=>{if(!isInputDOMNode(Lt)&&!le)if(elementSelectionKeys.includes(Lt.key)&&A){const rt=Lt.key==="Escape";handleNodeClick({id:r,store:oe,unselect:rt,nodeRef:ye})}else P&&c&&Object.prototype.hasOwnProperty.call(arrowKeyDiffs,Lt.key)&&(oe.setState({ariaLiveMessage:`Moved selected node ${Lt.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~a}, y: ${~~o}`}),Pe({x:arrowKeyDiffs[Lt.key].x,y:arrowKeyDiffs[Lt.key].y,isShiftPressed:Lt.shiftKey}))};reactExports.useEffect(()=>()=>{Ee.current&&(ue==null||ue.unobserve(Ee.current),Ee.current=null)},[]),reactExports.useEffect(()=>{if(ye.current&&!ee){const Lt=ye.current;(!te||!he||Ee.current!==Lt)&&(Ee.current&&(ue==null||ue.unobserve(Ee.current)),ue==null||ue.observe(Lt),Ee.current=Lt)}},[ee,te,he]),reactExports.useEffect(()=>{const Lt=Te.current!==n,rt=Ae.current!==W,lr=je.current!==H;ye.current&&(Lt||rt||lr)&&(Lt&&(Te.current=n),rt&&(Ae.current=W),lr&&(je.current=H),oe.getState().updateNodeDimensions([{id:r,nodeElement:ye.current,forceUpdate:!0}]))},[r,n,W,H]);const or=useDrag({nodeRef:ye,disabled:ee||!P,noDragClassName:ce,handleSelector:de,nodeId:r,isSelectable:A,selectNodesOnDrag:K});return ee?null:React.createElement("div",{className:cc(["react-flow__node",`react-flow__node-${n}`,{[me]:P},S,{selected:c,selectable:A,parent:ae,dragging:or}]),ref:ye,style:{zIndex:fe,transform:`translate(${l}px,${u}px)`,pointerEvents:Ve?"all":"none",visibility:te?"visible":"hidden",...T},"data-id":r,"data-testid":`rf__node-${r}`,onMouseEnter:Ce,onMouseMove:De,onMouseLeave:ze,onContextMenu:Et,onClick:Ue,onDoubleClick:Ze,onKeyDown:j?qt:void 0,tabIndex:j?0:void 0,role:j?"button":void 0,"aria-describedby":le?void 0:`${ARIA_NODE_DESC_KEY}-${Y}`,"aria-label":Z},React.createElement(Provider$2,{value:r},React.createElement(t,{id:r,data:s,type:n,xPos:a,yPos:o,selected:c,isConnectable:I,sourcePosition:W,targetPosition:H,dragging:or,dragHandle:de,zIndex:fe})))};return e.displayName="NodeWrapper",reactExports.memo(e)};const selector$7=t=>{const e=t.getNodes().filter(r=>r.selected);return{...getNodesBounds(e,t.nodeOrigin),transformString:`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`,userSelectionActive:t.userSelectionActive}};function NodesSelection({onSelectionContextMenu:t,noPanClassName:e,disableKeyboardA11y:r}){const n=useStoreApi(),{width:s,height:a,x:o,y:l,transformString:u,userSelectionActive:c}=useStore(selector$7,shallow$1$2),d=useUpdateNodePositions(),p=reactExports.useRef(null);if(reactExports.useEffect(()=>{var b;r||(b=p.current)==null||b.focus({preventScroll:!0})},[r]),useDrag({nodeRef:p}),c||!s||!a)return null;const m=t?b=>{const E=n.getState().getNodes().filter(T=>T.selected);t(b,E)}:void 0,y=b=>{Object.prototype.hasOwnProperty.call(arrowKeyDiffs,b.key)&&d({x:arrowKeyDiffs[b.key].x,y:arrowKeyDiffs[b.key].y,isShiftPressed:b.shiftKey})};return React.createElement("div",{className:cc(["react-flow__nodesselection","react-flow__container",e]),style:{transform:u}},React.createElement("div",{ref:p,className:"react-flow__nodesselection-rect",onContextMenu:m,tabIndex:r?void 0:-1,onKeyDown:r?void 0:y,style:{width:s,height:a,top:l,left:o}}))}var NodesSelection$1=reactExports.memo(NodesSelection);const selector$6=t=>t.nodesSelectionActive,FlowRenderer=({children:t,onPaneClick:e,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:s,onPaneContextMenu:a,onPaneScroll:o,deleteKeyCode:l,onMove:u,onMoveStart:c,onMoveEnd:d,selectionKeyCode:p,selectionOnDrag:m,selectionMode:y,onSelectionStart:b,onSelectionEnd:E,multiSelectionKeyCode:T,panActivationKeyCode:S,zoomActivationKeyCode:P,elementsSelectable:A,zoomOnScroll:I,zoomOnPinch:j,panOnScroll:K,panOnScrollSpeed:W,panOnScrollMode:H,zoomOnDoubleClick:ee,panOnDrag:ue,defaultViewport:de,translateExtent:fe,minZoom:ae,maxZoom:ce,preventScrolling:me,onSelectionContextMenu:te,noWheelClassName:le,noPanClassName:Z,disableKeyboardA11y:Y})=>{const he=useStore(selector$6),oe=useKeyPress(p),ye=useKeyPress(S),Ee=ye||ue,Ae=ye||K,je=oe||m&&Ee!==!0;return useGlobalKeyHandler({deleteKeyCode:l,multiSelectionKeyCode:T}),React.createElement(ZoomPane,{onMove:u,onMoveStart:c,onMoveEnd:d,onPaneContextMenu:a,elementsSelectable:A,zoomOnScroll:I,zoomOnPinch:j,panOnScroll:Ae,panOnScrollSpeed:W,panOnScrollMode:H,zoomOnDoubleClick:ee,panOnDrag:!oe&&Ee,defaultViewport:de,translateExtent:fe,minZoom:ae,maxZoom:ce,zoomActivationKeyCode:P,preventScrolling:me,noWheelClassName:le,noPanClassName:Z},React.createElement(Pane,{onSelectionStart:b,onSelectionEnd:E,onPaneClick:e,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:s,onPaneContextMenu:a,onPaneScroll:o,panOnDrag:Ee,isSelecting:!!je,selectionMode:y},t,he&&React.createElement(NodesSelection$1,{onSelectionContextMenu:te,noPanClassName:Z,disableKeyboardA11y:Y})))};FlowRenderer.displayName="FlowRenderer";var FlowRenderer$1=reactExports.memo(FlowRenderer);function useVisibleNodes(t){return useStore(reactExports.useCallback(r=>t?getNodesInside(r.nodeInternals,{x:0,y:0,width:r.width,height:r.height},r.transform,!0):r.getNodes(),[t]))}function createNodeTypes(t){const e={input:wrapNode(t.input||InputNode$1),default:wrapNode(t.default||DefaultNode$1),output:wrapNode(t.output||OutputNode$1),group:wrapNode(t.group||GroupNode)},r={},n=Object.keys(t).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,a)=>(s[a]=wrapNode(t[a]||DefaultNode$1),s),r);return{...e,...n}}const getPositionWithOrigin=({x:t,y:e,width:r,height:n,origin:s})=>!r||!n?{x:t,y:e}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:t,y:e}:{x:t-r*s[0],y:e-n*s[1]},selector$5=t=>({nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,nodesFocusable:t.nodesFocusable,elementsSelectable:t.elementsSelectable,updateNodeDimensions:t.updateNodeDimensions,onError:t.onError}),NodeRenderer=t=>{const{nodesDraggable:e,nodesConnectable:r,nodesFocusable:n,elementsSelectable:s,updateNodeDimensions:a,onError:o}=useStore(selector$5,shallow$1$2),l=useVisibleNodes(t.onlyRenderVisibleElements),u=reactExports.useRef(),c=reactExports.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const d=new ResizeObserver(p=>{const m=p.map(y=>({id:y.target.getAttribute("data-id"),nodeElement:y.target,forceUpdate:!0}));a(m)});return u.current=d,d},[]);return reactExports.useEffect(()=>()=>{var d;(d=u==null?void 0:u.current)==null||d.disconnect()},[]),React.createElement("div",{className:"react-flow__nodes",style:containerStyle},l.map(d=>{var j,K,W;let p=d.type||"default";t.nodeTypes[p]||(o==null||o("003",errorMessages.error003(p)),p="default");const m=t.nodeTypes[p]||t.nodeTypes.default,y=!!(d.draggable||e&&typeof d.draggable>"u"),b=!!(d.selectable||s&&typeof d.selectable>"u"),E=!!(d.connectable||r&&typeof d.connectable>"u"),T=!!(d.focusable||n&&typeof d.focusable>"u"),S=t.nodeExtent?clampPosition(d.positionAbsolute,t.nodeExtent):d.positionAbsolute,P=(S==null?void 0:S.x)??0,A=(S==null?void 0:S.y)??0,I=getPositionWithOrigin({x:P,y:A,width:d.width??0,height:d.height??0,origin:t.nodeOrigin});return React.createElement(m,{key:d.id,id:d.id,className:d.className,style:d.style,type:p,data:d.data,sourcePosition:d.sourcePosition||Position.Bottom,targetPosition:d.targetPosition||Position.Top,hidden:d.hidden,xPos:P,yPos:A,xPosOrigin:I.x,yPosOrigin:I.y,selectNodesOnDrag:t.selectNodesOnDrag,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,selected:!!d.selected,isDraggable:y,isSelectable:b,isConnectable:E,isFocusable:T,resizeObserver:c,dragHandle:d.dragHandle,zIndex:((j=d[internalsSymbol])==null?void 0:j.z)??0,isParent:!!((K=d[internalsSymbol])!=null&&K.isParent),noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,initialized:!!d.width&&!!d.height,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,ariaLabel:d.ariaLabel,hasHandleBounds:!!((W=d[internalsSymbol])!=null&&W.handleBounds)})}))};NodeRenderer.displayName="NodeRenderer";var NodeRenderer$1=reactExports.memo(NodeRenderer);const shiftX=(t,e,r)=>r===Position.Left?t-e:r===Position.Right?t+e:t,shiftY=(t,e,r)=>r===Position.Top?t-e:r===Position.Bottom?t+e:t,EdgeUpdaterClassName="react-flow__edgeupdater",EdgeAnchor=({position:t,centerX:e,centerY:r,radius:n=10,onMouseDown:s,onMouseEnter:a,onMouseOut:o,type:l})=>React.createElement("circle",{onMouseDown:s,onMouseEnter:a,onMouseOut:o,className:cc([EdgeUpdaterClassName,`${EdgeUpdaterClassName}-${l}`]),cx:shiftX(e,n,t),cy:shiftY(r,n,t),r:n,stroke:"transparent",fill:"transparent"}),alwaysValidConnection=()=>!0;var wrapEdge=t=>{const e=({id:r,className:n,type:s,data:a,onClick:o,onEdgeDoubleClick:l,selected:u,animated:c,label:d,labelStyle:p,labelShowBg:m,labelBgStyle:y,labelBgPadding:b,labelBgBorderRadius:E,style:T,source:S,target:P,sourceX:A,sourceY:I,targetX:j,targetY:K,sourcePosition:W,targetPosition:H,elementsSelectable:ee,hidden:ue,sourceHandleId:de,targetHandleId:fe,onContextMenu:ae,onMouseEnter:ce,onMouseMove:me,onMouseLeave:te,reconnectRadius:le,onReconnect:Z,onReconnectStart:Y,onReconnectEnd:he,markerEnd:oe,markerStart:ye,rfId:Ee,ariaLabel:Ae,isFocusable:je,isReconnectable:Te,pathOptions:Ve,interactionWidth:Pe,disableKeyboardA11y:Ce})=>{const De=reactExports.useRef(null),[ze,Et]=reactExports.useState(!1),[Ze,Ue]=reactExports.useState(!1),qt=useStoreApi(),or=reactExports.useMemo(()=>`url('#${getMarkerId(ye,Ee)}')`,[ye,Ee]),Lt=reactExports.useMemo(()=>`url('#${getMarkerId(oe,Ee)}')`,[oe,Ee]);if(ue)return null;const rt=Bt=>{var Nr;const{edges:ur,addSelectedEdges:Vn,unselectNodesAndEdges:gn,multiSelectionActive:yn}=qt.getState(),Dr=ur.find(wn=>wn.id===r);Dr&&(ee&&(qt.setState({nodesSelectionActive:!1}),Dr.selected&&yn?(gn({nodes:[],edges:[Dr]}),(Nr=De.current)==null||Nr.blur()):Vn([r])),o&&o(Bt,Dr))},lr=getMouseHandler$1(r,qt.getState,l),ir=getMouseHandler$1(r,qt.getState,ae),er=getMouseHandler$1(r,qt.getState,ce),xr=getMouseHandler$1(r,qt.getState,me),br=getMouseHandler$1(r,qt.getState,te),Pr=(Bt,ur)=>{if(Bt.button!==0)return;const{edges:Vn,isValidConnection:gn}=qt.getState(),yn=ur?P:S,Dr=(ur?fe:de)||null,Nr=ur?"target":"source",wn=gn||alwaysValidConnection,jn=ur,$r=Vn.find(kr=>kr.id===r);Ue(!0),Y==null||Y(Bt,$r,Nr);const Cr=kr=>{Ue(!1),he==null||he(kr,$r,Nr)};handlePointerDown({event:Bt,handleId:Dr,nodeId:yn,onConnect:kr=>Z==null?void 0:Z($r,kr),isTarget:jn,getState:qt.getState,setState:qt.setState,isValidConnection:wn,edgeUpdaterType:Nr,onReconnectEnd:Cr})},zr=Bt=>Pr(Bt,!0),pr=Bt=>Pr(Bt,!1),dr=()=>Et(!0),Ar=()=>Et(!1),_r=!ee&&!o,It=Bt=>{var ur;if(!Ce&&elementSelectionKeys.includes(Bt.key)&&ee){const{unselectNodesAndEdges:Vn,addSelectedEdges:gn,edges:yn}=qt.getState();Bt.key==="Escape"?((ur=De.current)==null||ur.blur(),Vn({edges:[yn.find(Nr=>Nr.id===r)]})):gn([r])}};return React.createElement("g",{className:cc(["react-flow__edge",`react-flow__edge-${s}`,n,{selected:u,animated:c,inactive:_r,updating:ze}]),onClick:rt,onDoubleClick:lr,onContextMenu:ir,onMouseEnter:er,onMouseMove:xr,onMouseLeave:br,onKeyDown:je?It:void 0,tabIndex:je?0:void 0,role:je?"button":"img","data-testid":`rf__edge-${r}`,"aria-label":Ae===null?void 0:Ae||`Edge from ${S} to ${P}`,"aria-describedby":je?`${ARIA_EDGE_DESC_KEY}-${Ee}`:void 0,ref:De},!Ze&&React.createElement(t,{id:r,source:S,target:P,selected:u,animated:c,label:d,labelStyle:p,labelShowBg:m,labelBgStyle:y,labelBgPadding:b,labelBgBorderRadius:E,data:a,style:T,sourceX:A,sourceY:I,targetX:j,targetY:K,sourcePosition:W,targetPosition:H,sourceHandleId:de,targetHandleId:fe,markerStart:or,markerEnd:Lt,pathOptions:Ve,interactionWidth:Pe}),Te&&React.createElement(React.Fragment,null,(Te==="source"||Te===!0)&&React.createElement(EdgeAnchor,{position:W,centerX:A,centerY:I,radius:le,onMouseDown:zr,onMouseEnter:dr,onMouseOut:Ar,type:"source"}),(Te==="target"||Te===!0)&&React.createElement(EdgeAnchor,{position:H,centerX:j,centerY:K,radius:le,onMouseDown:pr,onMouseEnter:dr,onMouseOut:Ar,type:"target"})))};return e.displayName="EdgeWrapper",reactExports.memo(e)};function createEdgeTypes(t){const e={default:wrapEdge(t.default||BezierEdge),straight:wrapEdge(t.bezier||StraightEdge),step:wrapEdge(t.step||StepEdge),smoothstep:wrapEdge(t.step||SmoothStepEdge),simplebezier:wrapEdge(t.simplebezier||SimpleBezierEdge)},r={},n=Object.keys(t).filter(s=>!["default","bezier"].includes(s)).reduce((s,a)=>(s[a]=wrapEdge(t[a]||BezierEdge),s),r);return{...e,...n}}function getHandlePosition(t,e,r=null){const n=((r==null?void 0:r.x)||0)+e.x,s=((r==null?void 0:r.y)||0)+e.y,a=(r==null?void 0:r.width)||e.width,o=(r==null?void 0:r.height)||e.height;switch(t){case Position.Top:return{x:n+a/2,y:s};case Position.Right:return{x:n+a,y:s+o/2};case Position.Bottom:return{x:n+a/2,y:s+o};case Position.Left:return{x:n,y:s+o/2}}}function getHandle(t,e){return t?t.length===1||!e?t[0]:e&&t.find(r=>r.id===e)||null:null}const getEdgePositions=(t,e,r,n,s,a)=>{const o=getHandlePosition(r,t,e),l=getHandlePosition(a,n,s);return{sourceX:o.x,sourceY:o.y,targetX:l.x,targetY:l.y}};function isEdgeVisible({sourcePos:t,targetPos:e,sourceWidth:r,sourceHeight:n,targetWidth:s,targetHeight:a,width:o,height:l,transform:u}){const c={x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x+r,e.x+s),y2:Math.max(t.y+n,e.y+a)};c.x===c.x2&&(c.x2+=1),c.y===c.y2&&(c.y2+=1);const d=rectToBox({x:(0-u[0])/u[2],y:(0-u[1])/u[2],width:o/u[2],height:l/u[2]}),p=Math.max(0,Math.min(d.x2,c.x2)-Math.max(d.x,c.x)),m=Math.max(0,Math.min(d.y2,c.y2)-Math.max(d.y,c.y));return Math.ceil(p*m)>0}function getNodeData(t){var n,s,a,o,l;const e=((n=t==null?void 0:t[internalsSymbol])==null?void 0:n.handleBounds)||null,r=e&&(t==null?void 0:t.width)&&(t==null?void 0:t.height)&&typeof((s=t==null?void 0:t.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((a=t==null?void 0:t.positionAbsolute)==null?void 0:a.y)<"u";return[{x:((o=t==null?void 0:t.positionAbsolute)==null?void 0:o.x)||0,y:((l=t==null?void 0:t.positionAbsolute)==null?void 0:l.y)||0,width:(t==null?void 0:t.width)||0,height:(t==null?void 0:t.height)||0},e,!!r]}const defaultEdgeTree=[{level:0,isMaxLevel:!0,edges:[]}];function groupEdgesByZLevel(t,e,r=!1){let n=-1;const s=t.reduce((o,l)=>{var d,p;const u=isNumeric(l.zIndex);let c=u?l.zIndex:0;if(r){const m=e.get(l.target),y=e.get(l.source),b=l.selected||(m==null?void 0:m.selected)||(y==null?void 0:y.selected),E=Math.max(((d=y==null?void 0:y[internalsSymbol])==null?void 0:d.z)||0,((p=m==null?void 0:m[internalsSymbol])==null?void 0:p.z)||0,1e3);c=(u?l.zIndex:0)+(b?E:0)}return o[c]?o[c].push(l):o[c]=[l],n=c>n?c:n,o},{}),a=Object.entries(s).map(([o,l])=>{const u=+o;return{edges:l,level:u,isMaxLevel:u===n}});return a.length===0?defaultEdgeTree:a}function useVisibleEdges(t,e,r){const n=useStore(reactExports.useCallback(s=>t?s.edges.filter(a=>{const o=e.get(a.source),l=e.get(a.target);return(o==null?void 0:o.width)&&(o==null?void 0:o.height)&&(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&isEdgeVisible({sourcePos:o.positionAbsolute||{x:0,y:0},targetPos:l.positionAbsolute||{x:0,y:0},sourceWidth:o.width,sourceHeight:o.height,targetWidth:l.width,targetHeight:l.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[t,e]));return groupEdgesByZLevel(n,e,r)}const ArrowSymbol=({color:t="none",strokeWidth:e=1})=>React.createElement("polyline",{style:{stroke:t,strokeWidth:e},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),ArrowClosedSymbol=({color:t="none",strokeWidth:e=1})=>React.createElement("polyline",{style:{stroke:t,fill:t,strokeWidth:e},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),MarkerSymbols={[MarkerType.Arrow]:ArrowSymbol,[MarkerType.ArrowClosed]:ArrowClosedSymbol};function useMarkerSymbol(t){const e=useStoreApi();return reactExports.useMemo(()=>{var s,a;return Object.prototype.hasOwnProperty.call(MarkerSymbols,t)?MarkerSymbols[t]:((a=(s=e.getState()).onError)==null||a.call(s,"009",errorMessages.error009(t)),null)},[t])}const Marker=({id:t,type:e,color:r,width:n=12.5,height:s=12.5,markerUnits:a="strokeWidth",strokeWidth:o,orient:l="auto-start-reverse"})=>{const u=useMarkerSymbol(e);return u?React.createElement("marker",{className:"react-flow__arrowhead",id:t,markerWidth:`${n}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:a,orient:l,refX:"0",refY:"0"},React.createElement(u,{color:r,strokeWidth:o})):null},markerSelector=({defaultColor:t,rfId:e})=>r=>{const n=[];return r.edges.reduce((s,a)=>([a.markerStart,a.markerEnd].forEach(o=>{if(o&&typeof o=="object"){const l=getMarkerId(o,e);n.includes(l)||(s.push({id:l,color:o.color||t,...o}),n.push(l))}}),s),[]).sort((s,a)=>s.id.localeCompare(a.id))},MarkerDefinitions=({defaultColor:t,rfId:e})=>{const r=useStore(reactExports.useCallback(markerSelector({defaultColor:t,rfId:e}),[t,e]),(n,s)=>!(n.length!==s.length||n.some((a,o)=>a.id!==s[o].id)));return React.createElement("defs",null,r.map(n=>React.createElement(Marker,{id:n.id,key:n.id,type:n.type,color:n.color,width:n.width,height:n.height,markerUnits:n.markerUnits,strokeWidth:n.strokeWidth,orient:n.orient})))};MarkerDefinitions.displayName="MarkerDefinitions";var MarkerDefinitions$1=reactExports.memo(MarkerDefinitions);const selector$4=t=>({nodesConnectable:t.nodesConnectable,edgesFocusable:t.edgesFocusable,edgesUpdatable:t.edgesUpdatable,elementsSelectable:t.elementsSelectable,width:t.width,height:t.height,connectionMode:t.connectionMode,nodeInternals:t.nodeInternals,onError:t.onError}),EdgeRenderer=({defaultMarkerColor:t,onlyRenderVisibleElements:e,elevateEdgesOnSelect:r,rfId:n,edgeTypes:s,noPanClassName:a,onEdgeContextMenu:o,onEdgeMouseEnter:l,onEdgeMouseMove:u,onEdgeMouseLeave:c,onEdgeClick:d,onEdgeDoubleClick:p,onReconnect:m,onReconnectStart:y,onReconnectEnd:b,reconnectRadius:E,children:T,disableKeyboardA11y:S})=>{const{edgesFocusable:P,edgesUpdatable:A,elementsSelectable:I,width:j,height:K,connectionMode:W,nodeInternals:H,onError:ee}=useStore(selector$4,shallow$1$2),ue=useVisibleEdges(e,H,r);return j?React.createElement(React.Fragment,null,ue.map(({level:de,edges:fe,isMaxLevel:ae})=>React.createElement("svg",{key:de,style:{zIndex:de},width:j,height:K,className:"react-flow__edges react-flow__container"},ae&&React.createElement(MarkerDefinitions$1,{defaultColor:t,rfId:n}),React.createElement("g",null,fe.map(ce=>{const[me,te,le]=getNodeData(H.get(ce.source)),[Z,Y,he]=getNodeData(H.get(ce.target));if(!le||!he)return null;let oe=ce.type||"default";s[oe]||(ee==null||ee("011",errorMessages.error011(oe)),oe="default");const ye=s[oe]||s.default,Ee=W===ConnectionMode.Strict?Y.target:(Y.target??[]).concat(Y.source??[]),Ae=getHandle(te.source,ce.sourceHandle),je=getHandle(Ee,ce.targetHandle),Te=(Ae==null?void 0:Ae.position)||Position.Bottom,Ve=(je==null?void 0:je.position)||Position.Top,Pe=!!(ce.focusable||P&&typeof ce.focusable>"u"),Ce=ce.reconnectable||ce.updatable,De=typeof m<"u"&&(Ce||A&&typeof Ce>"u");if(!Ae||!je)return ee==null||ee("008",errorMessages.error008(Ae,ce)),null;const{sourceX:ze,sourceY:Et,targetX:Ze,targetY:Ue}=getEdgePositions(me,Ae,Te,Z,je,Ve);return React.createElement(ye,{key:ce.id,id:ce.id,className:cc([ce.className,a]),type:oe,data:ce.data,selected:!!ce.selected,animated:!!ce.animated,hidden:!!ce.hidden,label:ce.label,labelStyle:ce.labelStyle,labelShowBg:ce.labelShowBg,labelBgStyle:ce.labelBgStyle,labelBgPadding:ce.labelBgPadding,labelBgBorderRadius:ce.labelBgBorderRadius,style:ce.style,source:ce.source,target:ce.target,sourceHandleId:ce.sourceHandle,targetHandleId:ce.targetHandle,markerEnd:ce.markerEnd,markerStart:ce.markerStart,sourceX:ze,sourceY:Et,targetX:Ze,targetY:Ue,sourcePosition:Te,targetPosition:Ve,elementsSelectable:I,onContextMenu:o,onMouseEnter:l,onMouseMove:u,onMouseLeave:c,onClick:d,onEdgeDoubleClick:p,onReconnect:m,onReconnectStart:y,onReconnectEnd:b,reconnectRadius:E,rfId:n,ariaLabel:ce.ariaLabel,isFocusable:Pe,isReconnectable:De,pathOptions:"pathOptions"in ce?ce.pathOptions:void 0,interactionWidth:ce.interactionWidth,disableKeyboardA11y:S})})))),T):null};EdgeRenderer.displayName="EdgeRenderer";var EdgeRenderer$1=reactExports.memo(EdgeRenderer);const selector$3=t=>`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`;function Viewport({children:t}){const e=useStore(selector$3);return React.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:e}},t)}function useOnInitHandler(t){const e=useReactFlow(),r=reactExports.useRef(!1);reactExports.useEffect(()=>{!r.current&&e.viewportInitialized&&t&&(setTimeout(()=>t(e),1),r.current=!0)},[t,e.viewportInitialized])}const oppositePosition={[Position.Left]:Position.Right,[Position.Right]:Position.Left,[Position.Top]:Position.Bottom,[Position.Bottom]:Position.Top},ConnectionLine=({nodeId:t,handleType:e,style:r,type:n=ConnectionLineType.Bezier,CustomComponent:s,connectionStatus:a})=>{var K,W,H;const{fromNode:o,handleId:l,toX:u,toY:c,connectionMode:d}=useStore(reactExports.useCallback(ee=>({fromNode:ee.nodeInternals.get(t),handleId:ee.connectionHandleId,toX:(ee.connectionPosition.x-ee.transform[0])/ee.transform[2],toY:(ee.connectionPosition.y-ee.transform[1])/ee.transform[2],connectionMode:ee.connectionMode}),[t]),shallow$1$2),p=(K=o==null?void 0:o[internalsSymbol])==null?void 0:K.handleBounds;let m=p==null?void 0:p[e];if(d===ConnectionMode.Loose&&(m=m||(p==null?void 0:p[e==="source"?"target":"source"])),!o||!m)return null;const y=l?m.find(ee=>ee.id===l):m[0],b=y?y.x+y.width/2:(o.width??0)/2,E=y?y.y+y.height/2:o.height??0,T=(((W=o.positionAbsolute)==null?void 0:W.x)??0)+b,S=(((H=o.positionAbsolute)==null?void 0:H.y)??0)+E,P=y==null?void 0:y.position,A=P?oppositePosition[P]:null;if(!P||!A)return null;if(s)return React.createElement(s,{connectionLineType:n,connectionLineStyle:r,fromNode:o,fromHandle:y,fromX:T,fromY:S,toX:u,toY:c,fromPosition:P,toPosition:A,connectionStatus:a});let I="";const j={sourceX:T,sourceY:S,sourcePosition:P,targetX:u,targetY:c,targetPosition:A};return n===ConnectionLineType.Bezier?[I]=getBezierPath(j):n===ConnectionLineType.Step?[I]=getSmoothStepPath({...j,borderRadius:0}):n===ConnectionLineType.SmoothStep?[I]=getSmoothStepPath(j):n===ConnectionLineType.SimpleBezier?[I]=getSimpleBezierPath(j):I=`M${T},${S} ${u},${c}`,React.createElement("path",{d:I,fill:"none",className:"react-flow__connection-path",style:r})};ConnectionLine.displayName="ConnectionLine";const selector$2=t=>({nodeId:t.connectionNodeId,handleType:t.connectionHandleType,nodesConnectable:t.nodesConnectable,connectionStatus:t.connectionStatus,width:t.width,height:t.height});function ConnectionLineWrapper({containerStyle:t,style:e,type:r,component:n}){const{nodeId:s,handleType:a,nodesConnectable:o,width:l,height:u,connectionStatus:c}=useStore(selector$2,shallow$1$2);return!(s&&a&&l&&o)?null:React.createElement("svg",{style:t,width:l,height:u,className:"react-flow__edges react-flow__connectionline react-flow__container"},React.createElement("g",{className:cc(["react-flow__connection",c])},React.createElement(ConnectionLine,{nodeId:s,handleType:a,style:e,type:r,CustomComponent:n,connectionStatus:c})))}function useNodeOrEdgeTypes(t,e){return reactExports.useRef(null),useStoreApi(),reactExports.useMemo(()=>e(t),[t])}const GraphView=({nodeTypes:t,edgeTypes:e,onMove:r,onMoveStart:n,onMoveEnd:s,onInit:a,onNodeClick:o,onEdgeClick:l,onNodeDoubleClick:u,onEdgeDoubleClick:c,onNodeMouseEnter:d,onNodeMouseMove:p,onNodeMouseLeave:m,onNodeContextMenu:y,onSelectionContextMenu:b,onSelectionStart:E,onSelectionEnd:T,connectionLineType:S,connectionLineStyle:P,connectionLineComponent:A,connectionLineContainerStyle:I,selectionKeyCode:j,selectionOnDrag:K,selectionMode:W,multiSelectionKeyCode:H,panActivationKeyCode:ee,zoomActivationKeyCode:ue,deleteKeyCode:de,onlyRenderVisibleElements:fe,elementsSelectable:ae,selectNodesOnDrag:ce,defaultViewport:me,translateExtent:te,minZoom:le,maxZoom:Z,preventScrolling:Y,defaultMarkerColor:he,zoomOnScroll:oe,zoomOnPinch:ye,panOnScroll:Ee,panOnScrollSpeed:Ae,panOnScrollMode:je,zoomOnDoubleClick:Te,panOnDrag:Ve,onPaneClick:Pe,onPaneMouseEnter:Ce,onPaneMouseMove:De,onPaneMouseLeave:ze,onPaneScroll:Et,onPaneContextMenu:Ze,onEdgeContextMenu:Ue,onEdgeMouseEnter:qt,onEdgeMouseMove:or,onEdgeMouseLeave:Lt,onReconnect:rt,onReconnectStart:lr,onReconnectEnd:ir,reconnectRadius:er,noDragClassName:xr,noWheelClassName:br,noPanClassName:Pr,elevateEdgesOnSelect:zr,disableKeyboardA11y:pr,nodeOrigin:dr,nodeExtent:Ar,rfId:_r})=>{const It=useNodeOrEdgeTypes(t,createNodeTypes),Bt=useNodeOrEdgeTypes(e,createEdgeTypes);return useOnInitHandler(a),React.createElement(FlowRenderer$1,{onPaneClick:Pe,onPaneMouseEnter:Ce,onPaneMouseMove:De,onPaneMouseLeave:ze,onPaneContextMenu:Ze,onPaneScroll:Et,deleteKeyCode:de,selectionKeyCode:j,selectionOnDrag:K,selectionMode:W,onSelectionStart:E,onSelectionEnd:T,multiSelectionKeyCode:H,panActivationKeyCode:ee,zoomActivationKeyCode:ue,elementsSelectable:ae,onMove:r,onMoveStart:n,onMoveEnd:s,zoomOnScroll:oe,zoomOnPinch:ye,zoomOnDoubleClick:Te,panOnScroll:Ee,panOnScrollSpeed:Ae,panOnScrollMode:je,panOnDrag:Ve,defaultViewport:me,translateExtent:te,minZoom:le,maxZoom:Z,onSelectionContextMenu:b,preventScrolling:Y,noDragClassName:xr,noWheelClassName:br,noPanClassName:Pr,disableKeyboardA11y:pr},React.createElement(Viewport,null,React.createElement(EdgeRenderer$1,{edgeTypes:Bt,onEdgeClick:l,onEdgeDoubleClick:c,onlyRenderVisibleElements:fe,onEdgeContextMenu:Ue,onEdgeMouseEnter:qt,onEdgeMouseMove:or,onEdgeMouseLeave:Lt,onReconnect:rt,onReconnectStart:lr,onReconnectEnd:ir,reconnectRadius:er,defaultMarkerColor:he,noPanClassName:Pr,elevateEdgesOnSelect:!!zr,disableKeyboardA11y:pr,rfId:_r},React.createElement(ConnectionLineWrapper,{style:P,type:S,component:A,containerStyle:I})),React.createElement("div",{className:"react-flow__edgelabel-renderer"}),React.createElement(NodeRenderer$1,{nodeTypes:It,onNodeClick:o,onNodeDoubleClick:u,onNodeMouseEnter:d,onNodeMouseMove:p,onNodeMouseLeave:m,onNodeContextMenu:y,selectNodesOnDrag:ce,onlyRenderVisibleElements:fe,noPanClassName:Pr,noDragClassName:xr,disableKeyboardA11y:pr,nodeOrigin:dr,nodeExtent:Ar,rfId:_r})))};GraphView.displayName="GraphView";var GraphView$1=reactExports.memo(GraphView);const infiniteExtent=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],initialState={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:infiniteExtent,nodeExtent:infiniteExtent,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:ConnectionMode.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:devWarn,isValidConnection:void 0},createRFStore=()=>createWithEqualityFn((t,e)=>({...initialState,setNodes:r=>{const{nodeInternals:n,nodeOrigin:s,elevateNodesOnSelect:a}=e();t({nodeInternals:createNodeInternals(r,n,s,a)})},getNodes:()=>Array.from(e().nodeInternals.values()),setEdges:r=>{const{defaultEdgeOptions:n={}}=e();t({edges:r.map(s=>({...n,...s}))})},setDefaultNodesAndEdges:(r,n)=>{const s=typeof r<"u",a=typeof n<"u",o=s?createNodeInternals(r,new Map,e().nodeOrigin,e().elevateNodesOnSelect):new Map;t({nodeInternals:o,edges:a?n:[],hasDefaultNodes:s,hasDefaultEdges:a})},updateNodeDimensions:r=>{const{onNodesChange:n,nodeInternals:s,fitViewOnInit:a,fitViewOnInitDone:o,fitViewOnInitOptions:l,domNode:u,nodeOrigin:c}=e(),d=u==null?void 0:u.querySelector(".react-flow__viewport");if(!d)return;const p=window.getComputedStyle(d),{m22:m}=new window.DOMMatrixReadOnly(p.transform),y=r.reduce((E,T)=>{const S=s.get(T.id);if(S!=null&&S.hidden)s.set(S.id,{...S,[internalsSymbol]:{...S[internalsSymbol],handleBounds:void 0}});else if(S){const P=getDimensions$1(T.nodeElement);!!(P.width&&P.height&&(S.width!==P.width||S.height!==P.height||T.forceUpdate))&&(s.set(S.id,{...S,[internalsSymbol]:{...S[internalsSymbol],handleBounds:{source:getHandleBounds(".source",T.nodeElement,m,c),target:getHandleBounds(".target",T.nodeElement,m,c)}},...P}),E.push({id:S.id,type:"dimensions",dimensions:P}))}return E},[]);updateAbsoluteNodePositions(s,c);const b=o||a&&!o&&fitView(e,{initial:!0,...l});t({nodeInternals:new Map(s),fitViewOnInitDone:b}),(y==null?void 0:y.length)>0&&(n==null||n(y))},updateNodePositions:(r,n=!0,s=!1)=>{const{triggerNodeChanges:a}=e(),o=r.map(l=>{const u={id:l.id,type:"position",dragging:s};return n&&(u.positionAbsolute=l.positionAbsolute,u.position=l.position),u});a(o)},triggerNodeChanges:r=>{const{onNodesChange:n,nodeInternals:s,hasDefaultNodes:a,nodeOrigin:o,getNodes:l,elevateNodesOnSelect:u}=e();if(r!=null&&r.length){if(a){const c=applyNodeChanges(r,l()),d=createNodeInternals(c,s,o,u);t({nodeInternals:d})}n==null||n(r)}},addSelectedNodes:r=>{const{multiSelectionActive:n,edges:s,getNodes:a}=e();let o,l=null;n?o=r.map(u=>createSelectionChange(u,!0)):(o=getSelectionChanges(a(),r),l=getSelectionChanges(s,[])),updateNodesAndEdgesSelections({changedNodes:o,changedEdges:l,get:e,set:t})},addSelectedEdges:r=>{const{multiSelectionActive:n,edges:s,getNodes:a}=e();let o,l=null;n?o=r.map(u=>createSelectionChange(u,!0)):(o=getSelectionChanges(s,r),l=getSelectionChanges(a(),[])),updateNodesAndEdgesSelections({changedNodes:l,changedEdges:o,get:e,set:t})},unselectNodesAndEdges:({nodes:r,edges:n}={})=>{const{edges:s,getNodes:a}=e(),o=r||a(),l=n||s,u=o.map(d=>(d.selected=!1,createSelectionChange(d.id,!1))),c=l.map(d=>createSelectionChange(d.id,!1));updateNodesAndEdgesSelections({changedNodes:u,changedEdges:c,get:e,set:t})},setMinZoom:r=>{const{d3Zoom:n,maxZoom:s}=e();n==null||n.scaleExtent([r,s]),t({minZoom:r})},setMaxZoom:r=>{const{d3Zoom:n,minZoom:s}=e();n==null||n.scaleExtent([s,r]),t({maxZoom:r})},setTranslateExtent:r=>{var n;(n=e().d3Zoom)==null||n.translateExtent(r),t({translateExtent:r})},resetSelectedElements:()=>{const{edges:r,getNodes:n}=e(),a=n().filter(l=>l.selected).map(l=>createSelectionChange(l.id,!1)),o=r.filter(l=>l.selected).map(l=>createSelectionChange(l.id,!1));updateNodesAndEdgesSelections({changedNodes:a,changedEdges:o,get:e,set:t})},setNodeExtent:r=>{const{nodeInternals:n}=e();n.forEach(s=>{s.positionAbsolute=clampPosition(s.position,r)}),t({nodeExtent:r,nodeInternals:new Map(n)})},panBy:r=>{const{transform:n,width:s,height:a,d3Zoom:o,d3Selection:l,translateExtent:u}=e();if(!o||!l||!r.x&&!r.y)return!1;const c=identity.translate(n[0]+r.x,n[1]+r.y).scale(n[2]),d=[[0,0],[s,a]],p=o==null?void 0:o.constrain()(c,d,u);return o.transform(l,p),n[0]!==p.x||n[1]!==p.y||n[2]!==p.k},cancelConnection:()=>t({connectionNodeId:initialState.connectionNodeId,connectionHandleId:initialState.connectionHandleId,connectionHandleType:initialState.connectionHandleType,connectionStatus:initialState.connectionStatus,connectionStartHandle:initialState.connectionStartHandle,connectionEndHandle:initialState.connectionEndHandle}),reset:()=>t({...initialState})}),Object.is),ReactFlowProvider=({children:t})=>{const e=reactExports.useRef(null);return e.current||(e.current=createRFStore()),React.createElement(Provider$1$1,{value:e.current},t)};ReactFlowProvider.displayName="ReactFlowProvider";const Wrapper=({children:t})=>reactExports.useContext(StoreContext$1)?React.createElement(React.Fragment,null,t):React.createElement(ReactFlowProvider,null,t);Wrapper.displayName="ReactFlowWrapper";const defaultNodeTypes={input:InputNode$1,default:DefaultNode$1,output:OutputNode$1,group:GroupNode},defaultEdgeTypes={default:BezierEdge,straight:StraightEdge,step:StepEdge,smoothstep:SmoothStepEdge,simplebezier:SimpleBezierEdge},initNodeOrigin=[0,0],initSnapGrid=[15,15],initDefaultViewport={x:0,y:0,zoom:1},wrapperStyle={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},ReactFlow=reactExports.forwardRef(({nodes:t,edges:e,defaultNodes:r,defaultEdges:n,className:s,nodeTypes:a=defaultNodeTypes,edgeTypes:o=defaultEdgeTypes,onNodeClick:l,onEdgeClick:u,onInit:c,onMove:d,onMoveStart:p,onMoveEnd:m,onConnect:y,onConnectStart:b,onConnectEnd:E,onClickConnectStart:T,onClickConnectEnd:S,onNodeMouseEnter:P,onNodeMouseMove:A,onNodeMouseLeave:I,onNodeContextMenu:j,onNodeDoubleClick:K,onNodeDragStart:W,onNodeDrag:H,onNodeDragStop:ee,onNodesDelete:ue,onEdgesDelete:de,onSelectionChange:fe,onSelectionDragStart:ae,onSelectionDrag:ce,onSelectionDragStop:me,onSelectionContextMenu:te,onSelectionStart:le,onSelectionEnd:Z,connectionMode:Y=ConnectionMode.Strict,connectionLineType:he=ConnectionLineType.Bezier,connectionLineStyle:oe,connectionLineComponent:ye,connectionLineContainerStyle:Ee,deleteKeyCode:Ae="Backspace",selectionKeyCode:je="Shift",selectionOnDrag:Te=!1,selectionMode:Ve=SelectionMode.Full,panActivationKeyCode:Pe="Space",multiSelectionKeyCode:Ce=isMacOs()?"Meta":"Control",zoomActivationKeyCode:De=isMacOs()?"Meta":"Control",snapToGrid:ze=!1,snapGrid:Et=initSnapGrid,onlyRenderVisibleElements:Ze=!1,selectNodesOnDrag:Ue=!0,nodesDraggable:qt,nodesConnectable:or,nodesFocusable:Lt,nodeOrigin:rt=initNodeOrigin,edgesFocusable:lr,edgesUpdatable:ir,elementsSelectable:er,defaultViewport:xr=initDefaultViewport,minZoom:br=.5,maxZoom:Pr=2,translateExtent:zr=infiniteExtent,preventScrolling:pr=!0,nodeExtent:dr,defaultMarkerColor:Ar="#b1b1b7",zoomOnScroll:_r=!0,zoomOnPinch:It=!0,panOnScroll:Bt=!1,panOnScrollSpeed:ur=.5,panOnScrollMode:Vn=PanOnScrollMode.Free,zoomOnDoubleClick:gn=!0,panOnDrag:yn=!0,onPaneClick:Dr,onPaneMouseEnter:Nr,onPaneMouseMove:wn,onPaneMouseLeave:jn,onPaneScroll:$r,onPaneContextMenu:Cr,children:Ir,onEdgeContextMenu:kr,onEdgeDoubleClick:Er,onEdgeMouseEnter:Nn,onEdgeMouseMove:Hr,onEdgeMouseLeave:qr,onEdgeUpdate:Fr,onEdgeUpdateStart:Dn,onEdgeUpdateEnd:yr,onReconnect:Wr,onReconnectStart:vr,onReconnectEnd:jr,reconnectRadius:Qr=10,edgeUpdaterRadius:xn=10,onNodesChange:Lr,onEdgesChange:_s,noDragClassName:Hs="nodrag",noWheelClassName:Bn="nowheel",noPanClassName:Hn="nopan",fitView:Tn=!1,fitViewOptions:Mn,connectOnClick:os=!0,attributionPosition:es,proOptions:ci,defaultEdgeOptions:ti,elevateNodesOnSelect:Se=!0,elevateEdgesOnSelect:We=!1,disableKeyboardA11y:et=!1,autoPanOnConnect:Ye=!0,autoPanOnNodeDrag:Xe=!0,connectionRadius:qe=20,isValidConnection:kt,onError:Wt,style:cr,id:nr,nodeDragThreshold:Kr,...un},An)=>{const Sn=nr||"1";return React.createElement("div",{...un,style:{...cr,...wrapperStyle},ref:An,className:cc(["react-flow",s]),"data-testid":"rf__wrapper",id:nr},React.createElement(Wrapper,null,React.createElement(GraphView$1,{onInit:c,onMove:d,onMoveStart:p,onMoveEnd:m,onNodeClick:l,onEdgeClick:u,onNodeMouseEnter:P,onNodeMouseMove:A,onNodeMouseLeave:I,onNodeContextMenu:j,onNodeDoubleClick:K,nodeTypes:a,edgeTypes:o,connectionLineType:he,connectionLineStyle:oe,connectionLineComponent:ye,connectionLineContainerStyle:Ee,selectionKeyCode:je,selectionOnDrag:Te,selectionMode:Ve,deleteKeyCode:Ae,multiSelectionKeyCode:Ce,panActivationKeyCode:Pe,zoomActivationKeyCode:De,onlyRenderVisibleElements:Ze,selectNodesOnDrag:Ue,defaultViewport:xr,translateExtent:zr,minZoom:br,maxZoom:Pr,preventScrolling:pr,zoomOnScroll:_r,zoomOnPinch:It,zoomOnDoubleClick:gn,panOnScroll:Bt,panOnScrollSpeed:ur,panOnScrollMode:Vn,panOnDrag:yn,onPaneClick:Dr,onPaneMouseEnter:Nr,onPaneMouseMove:wn,onPaneMouseLeave:jn,onPaneScroll:$r,onPaneContextMenu:Cr,onSelectionContextMenu:te,onSelectionStart:le,onSelectionEnd:Z,onEdgeContextMenu:kr,onEdgeDoubleClick:Er,onEdgeMouseEnter:Nn,onEdgeMouseMove:Hr,onEdgeMouseLeave:qr,onReconnect:Wr??Fr,onReconnectStart:vr??Dn,onReconnectEnd:jr??yr,reconnectRadius:Qr??xn,defaultMarkerColor:Ar,noDragClassName:Hs,noWheelClassName:Bn,noPanClassName:Hn,elevateEdgesOnSelect:We,rfId:Sn,disableKeyboardA11y:et,nodeOrigin:rt,nodeExtent:dr}),React.createElement(StoreUpdater,{nodes:t,edges:e,defaultNodes:r,defaultEdges:n,onConnect:y,onConnectStart:b,onConnectEnd:E,onClickConnectStart:T,onClickConnectEnd:S,nodesDraggable:qt,nodesConnectable:or,nodesFocusable:Lt,edgesFocusable:lr,edgesUpdatable:ir,elementsSelectable:er,elevateNodesOnSelect:Se,minZoom:br,maxZoom:Pr,nodeExtent:dr,onNodesChange:Lr,onEdgesChange:_s,snapToGrid:ze,snapGrid:Et,connectionMode:Y,translateExtent:zr,connectOnClick:os,defaultEdgeOptions:ti,fitView:Tn,fitViewOptions:Mn,onNodesDelete:ue,onEdgesDelete:de,onNodeDragStart:W,onNodeDrag:H,onNodeDragStop:ee,onSelectionDrag:ce,onSelectionDragStart:ae,onSelectionDragStop:me,noPanClassName:Hn,nodeOrigin:rt,rfId:Sn,autoPanOnConnect:Ye,autoPanOnNodeDrag:Xe,onError:Wt,connectionRadius:qe,isValidConnection:kt,nodeDragThreshold:Kr}),React.createElement(Wrapper$1,{onSelectionChange:fe}),Ir,React.createElement(Attribution,{proOptions:ci,position:es}),React.createElement(A11yDescriptions,{rfId:Sn,disableKeyboardA11y:et})))});ReactFlow.displayName="ReactFlow";function shallow$1$1(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[n,s]of t)if(!Object.is(s,e.get(n)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(e,n)||!Object.is(t[n],e[n]))return!1;return!0}function PlusIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},React.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function MinusIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},React.createElement("path",{d:"M0 0h32v4.2H0z"}))}function FitViewIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},React.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function LockIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},React.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function UnlockIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},React.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const ControlButton=({children:t,className:e,...r})=>React.createElement("button",{type:"button",className:cc(["react-flow__controls-button",e]),...r},t);ControlButton.displayName="ControlButton";const selector$1=t=>({isInteractive:t.nodesDraggable||t.nodesConnectable||t.elementsSelectable,minZoomReached:t.transform[2]<=t.minZoom,maxZoomReached:t.transform[2]>=t.maxZoom}),Controls=({style:t,showZoom:e=!0,showFitView:r=!0,showInteractive:n=!0,fitViewOptions:s,onZoomIn:a,onZoomOut:o,onFitView:l,onInteractiveChange:u,className:c,children:d,position:p="bottom-left"})=>{const m=useStoreApi(),[y,b]=reactExports.useState(!1),{isInteractive:E,minZoomReached:T,maxZoomReached:S}=useStore(selector$1,shallow$1$1),{zoomIn:P,zoomOut:A,fitView:I}=useReactFlow();if(reactExports.useEffect(()=>{b(!0)},[]),!y)return null;const j=()=>{P(),a==null||a()},K=()=>{A(),o==null||o()},W=()=>{I(s),l==null||l()},H=()=>{m.setState({nodesDraggable:!E,nodesConnectable:!E,elementsSelectable:!E}),u==null||u(!E)};return React.createElement(Panel,{className:cc(["react-flow__controls",c]),position:p,style:t,"data-testid":"rf__controls"},e&&React.createElement(React.Fragment,null,React.createElement(ControlButton,{onClick:j,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:S},React.createElement(PlusIcon,null)),React.createElement(ControlButton,{onClick:K,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:T},React.createElement(MinusIcon,null))),r&&React.createElement(ControlButton,{className:"react-flow__controls-fitview",onClick:W,title:"fit view","aria-label":"fit view"},React.createElement(FitViewIcon,null)),n&&React.createElement(ControlButton,{className:"react-flow__controls-interactive",onClick:H,title:"toggle interactivity","aria-label":"toggle interactivity"},E?React.createElement(UnlockIcon,null):React.createElement(LockIcon,null)),d)};Controls.displayName="Controls";var Controls$1=reactExports.memo(Controls);function shallow$1(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[n,s]of t)if(!Object.is(s,e.get(n)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(e,n)||!Object.is(t[n],e[n]))return!1;return!0}var BackgroundVariant;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(BackgroundVariant||(BackgroundVariant={}));function LinePattern({color:t,dimensions:e,lineWidth:r}){return React.createElement("path",{stroke:t,strokeWidth:r,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`})}function DotPattern({color:t,radius:e}){return React.createElement("circle",{cx:e,cy:e,r:e,fill:t})}const defaultColor={[BackgroundVariant.Dots]:"#91919a",[BackgroundVariant.Lines]:"#eee",[BackgroundVariant.Cross]:"#e2e2e2"},defaultSize={[BackgroundVariant.Dots]:1,[BackgroundVariant.Lines]:1,[BackgroundVariant.Cross]:6},selector=t=>({transform:t.transform,patternId:`pattern-${t.rfId}`});function Background({id:t,variant:e=BackgroundVariant.Dots,gap:r=20,size:n,lineWidth:s=1,offset:a=2,color:o,style:l,className:u}){const c=reactExports.useRef(null),{transform:d,patternId:p}=useStore(selector,shallow$1),m=o||defaultColor[e],y=n||defaultSize[e],b=e===BackgroundVariant.Dots,E=e===BackgroundVariant.Cross,T=Array.isArray(r)?r:[r,r],S=[T[0]*d[2]||1,T[1]*d[2]||1],P=y*d[2],A=E?[P,P]:S,I=b?[P/a,P/a]:[A[0]/a,A[1]/a];return React.createElement("svg",{className:cc(["react-flow__background",u]),style:{...l,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:c,"data-testid":"rf__background"},React.createElement("pattern",{id:p+t,x:d[0]%S[0],y:d[1]%S[1],width:S[0],height:S[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${I[0]},-${I[1]})`},b?React.createElement(DotPattern,{color:m,radius:P/a}):React.createElement(LinePattern,{dimensions:A,color:m,lineWidth:s})),React.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${p+t})`}))}Background.displayName="Background";var Background$1=reactExports.memo(Background);const baseStyle={padding:"1rem",borderRadius:"0.75rem",minWidth:"240px",background:"white",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",border:"1px solid rgba(0, 0, 0, 0.1)"},getNodeIcon=t=>{switch(t){case"phase":return jsxRuntimeExports.jsx(Lock,{className:"w-4 h-4"});case"goal":return jsxRuntimeExports.jsx(Target,{className:"w-4 h-4"});case"syllabus":return jsxRuntimeExports.jsx(BookOpen,{className:"w-4 h-4"});case"task":return jsxRuntimeExports.jsx(SquareCheckBig,{className:"w-4 h-4"});default:return null}},getNodeColor=t=>{switch(t){case"phase":return"from-blue-500 to-blue-600";case"goal":return"from-green-500 to-green-600";case"syllabus":return"from-orange-500 to-orange-600";case"task":return"from-yellow-500 to-yellow-600";default:return"from-gray-500 to-gray-600"}},NodeCard=({type:t,data:e})=>jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},whileHover:{scale:1.02},className:`relative ${baseStyle}`,children:[jsxRuntimeExports.jsx(Handle$1,{type:"target",position:Position.Left}),jsxRuntimeExports.jsx(Handle$1,{type:"source",position:Position.Right}),jsxRuntimeExports.jsx("div",{className:`absolute -inset-2 rounded-xl bg-gradient-to-r ${getNodeColor(t)} opacity-75 blur-lg`}),jsxRuntimeExports.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[getNodeIcon(t),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e.label})]}),e.description&&jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:e.description})]})]}),nodeTypes={phase:({data:t})=>jsxRuntimeExports.jsx(NodeCard,{type:"phase",data:t}),goal:({data:t})=>jsxRuntimeExports.jsx(NodeCard,{type:"goal",data:t}),syllabus:({data:t})=>jsxRuntimeExports.jsx(NodeCard,{type:"syllabus",data:t}),task:({data:t})=>jsxRuntimeExports.jsx(NodeCard,{type:"task",data:t})},initialNodes=[{id:"phase-1",type:"phase",position:{x:0,y:0},data:{label:"階段一：方法體驗期",description:"探索不同的學習方法，找到最適合自己的方式"}},{id:"goal-1",type:"goal",position:{x:200,y:0},data:{label:"能寫出一份學習計畫",description:"根據個人特點制定有效的學習計畫"}},{id:"syllabus-1",type:"syllabus",position:{x:400,y:-100},data:{label:"訪談別人探索學習方法",description:"與同學交流，了解不同的學習策略"}},{id:"syllabus-2",type:"syllabus",position:{x:400,y:100},data:{label:"觀察自己學習的模式",description:"記錄並分析自己的學習習慣"}},{id:"task-1",type:"task",position:{x:600,y:-100},data:{label:"設計 5 題訪談提問",description:"準備訪談問題，深入了解他人的學習方法"}},{id:"task-2",type:"task",position:{x:600,y:100},data:{label:"用日記記錄一週學習活動",description:"詳細記錄每天的學習過程和感受"}}],initialEdges=[{id:"e1-2",source:"phase-1",target:"goal-1",type:"smoothstep",animated:!0,style:{stroke:"#94a3b8",strokeWidth:2}},{id:"e2-3",source:"goal-1",target:"syllabus-1",type:"smoothstep",animated:!0,style:{stroke:"#94a3b8",strokeWidth:2}},{id:"e2-4",source:"goal-1",target:"syllabus-2",type:"smoothstep",animated:!0,style:{stroke:"#94a3b8",strokeWidth:2}},{id:"e3-5",source:"syllabus-1",target:"task-1",type:"smoothstep",animated:!0,style:{stroke:"#94a3b8",strokeWidth:2}},{id:"e4-6",source:"syllabus-2",target:"task-2",type:"smoothstep",animated:!0,style:{stroke:"#94a3b8",strokeWidth:2}}],CourseBluePrint=()=>{const[t,e]=React.useState(initialNodes),[r,n]=React.useState(initialEdges),s=React.useCallback(l=>e(u=>applyNodeChanges(l,u)),[]),a=React.useCallback(l=>n(u=>applyEdgeChanges(l,u)),[]),o=React.useCallback(l=>n(u=>addEdge(l,u)),[]);return jsxRuntimeExports.jsx(PageLayout,{title:"課程藍圖設計",children:jsxRuntimeExports.jsx("div",{style:{width:"100%",height:"calc(100vh - 100px)"},children:jsxRuntimeExports.jsxs(ReactFlow,{nodes:t,edges:r,onNodesChange:s,onEdgesChange:a,onConnect:o,nodeTypes,fitView:!0,defaultEdgeOptions:{type:"smoothstep",animated:!0,style:{stroke:"#0f172a",strokeWidth:2}},connectionMode:ConnectionMode.Loose,snapToGrid:!0,snapGrid:[15,15],children:[jsxRuntimeExports.jsx(Background$1,{}),jsxRuntimeExports.jsx(Controls$1,{})]})})})},GOAL_CATEGORIES={LEARNING:"learning",PERSONAL:"personal",PROJECT:"project"},GOAL_STATUSES={ARCHIVED:"archived"},goalTemplates=[{icon:React.createElement(Brain,{className:"h-5 w-5 text-purple-500"}),title:"學習目標",description:"設定特定科目或技能的學習目標",category:GOAL_CATEGORIES.LEARNING,tagColor:"purple"},{icon:React.createElement(Target,{className:"h-5 w-5 text-blue-500"}),title:"個人成長",description:"培養習慣、發展興趣或自我提升",category:GOAL_CATEGORIES.PERSONAL,tagColor:"blue"},{icon:React.createElement(Sparkles,{className:"h-5 w-5 text-green-500"}),title:"專案計畫",description:"規劃並執行一個完整的學習專案",category:GOAL_CATEGORIES.PROJECT,tagColor:"green"},{icon:React.createElement(PartyPopper,{className:"h-5 w-5 text-orange-500"}),title:"活動規劃",description:"規劃各種有趣的活動，從比賽參與到節日慶祝，培養規劃和組織能力",category:GOAL_CATEGORIES.PROJECT,tagColor:"orange",suggestedActions:["確定活動類型和目的","選擇時間和地點","列出所需準備項目","安排活動流程","準備預算計畫","邀請參與人員"]}],TaskItem=({task:t,onStatusChange:e,onEdit:r})=>{const n=a=>{switch(a){case"high":return"text-error-500";case"medium":return"text-warning-500";case"low":return"text-success-500";default:return"text-gray-500"}},s=a=>{switch(a){case"explore":return"bg-primary-100 text-primary-700";case"work":return"bg-secondary-100 text-secondary-700";case"present":return"bg-accent-100 text-accent-700";default:return"bg-gray-100 text-gray-700"}};return jsxRuntimeExports.jsxs("div",{className:"flex items-center p-2 hover:bg-gray-50 rounded-md",children:[jsxRuntimeExports.jsx("div",{onClick:e,className:"mr-3 flex-shrink-0 cursor-pointer",role:"button",tabIndex:0,onKeyPress:a=>{(a.key==="Enter"||a.key===" ")&&e()},children:t.status==="done"?jsxRuntimeExports.jsx(CircleCheck,{className:"h-5 w-5 text-success-500"}):jsxRuntimeExports.jsx(Circle,{className:"h-5 w-5 text-gray-300"})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("p",{className:`text-sm ${t.status==="done"?"text-gray-500 line-through":"text-gray-900"}`,children:t.title}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[t.dueDate&&jsxRuntimeExports.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[jsxRuntimeExports.jsx(Clock,{className:"h-3 w-3 mr-1"}),format(new Date(t.dueDate),"MM/dd")]}),t.priority&&jsxRuntimeExports.jsxs("div",{className:`flex items-center text-xs ${n(t.priority)}`,children:[jsxRuntimeExports.jsx(Flag,{className:"h-3 w-3 mr-1"}),t.priority]}),t.role&&jsxRuntimeExports.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${s(t.role)}`,children:[jsxRuntimeExports.jsx(User$1,{className:"h-3 w-3 mr-1"}),t.role]})]})]}),jsxRuntimeExports.jsx("div",{onClick:r,className:"ml-2 p-1 text-gray-400 hover:text-gray-600 cursor-pointer",role:"button",tabIndex:0,onKeyPress:a=>{(a.key==="Enter"||a.key===" ")&&r()},children:jsxRuntimeExports.jsx(Pen,{className:"h-4 w-4"})})]})},StepItem=({step:t,isExpanded:e,onToggle:r,onTaskStatusChange:n,onTaskEdit:s,onAddTask:a})=>jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[jsxRuntimeExports.jsxs("button",{className:"w-full px-4 py-3 flex items-center justify-between text-left",onClick:r,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[e?jsxRuntimeExports.jsx(ChevronDown,{className:"h-5 w-5 text-gray-400 mr-2"}):jsxRuntimeExports.jsx(ChevronRight,{className:"h-5 w-5 text-gray-400 mr-2"}),jsxRuntimeExports.jsx("span",{className:"font-medium text-gray-900",children:t.title})]}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-gray-500",children:[t.tasks.filter(o=>o.status==="done").length," /"," ",t.tasks.length," 個任務"]})]}),jsxRuntimeExports.jsx(AnimatePresence,{children:e&&jsxRuntimeExports.jsx(motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:jsxRuntimeExports.jsxs("div",{className:"px-4 pb-3 space-y-2",children:[t.tasks.map(o=>jsxRuntimeExports.jsx(TaskItem,{task:o,onStatusChange:()=>n(o),onEdit:()=>s(o)},o.id)),jsxRuntimeExports.jsxs("button",{onClick:a,className:"w-full mt-2 py-2 flex items-center justify-center text-sm text-gray-500 hover:text-gray-700",children:[jsxRuntimeExports.jsx(Plus,{className:"h-4 w-4 mr-1"}),"新增任務"]})]})})})]});var lottie$2={exports:{}},lottie$1=lottie$2.exports,hasRequiredLottie;function requireLottie(){return hasRequiredLottie||(hasRequiredLottie=1,function(module,exports){typeof document<"u"&&typeof navigator<"u"&&function(t,e){module.exports=e()}(lottie$1,function(){var svgNS="http://www.w3.org/2000/svg",locationHref="",_useWebWorker=!1,initialDefaultFrame=-999999,setWebWorker=function(e){_useWebWorker=!!e},getWebWorker=function(){return _useWebWorker},setLocationHref=function(e){locationHref=e},getLocationHref=function(){return locationHref};function createTag(t){return document.createElement(t)}function extendPrototype(t,e){var r,n=t.length,s;for(r=0;r<n;r+=1){s=t[r].prototype;for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e.prototype[a]=s[a])}}function getDescriptor(t,e){return Object.getOwnPropertyDescriptor(t,e)}function createProxyFunction(t){function e(){}return e.prototype=t,e}var audioControllerFactory=function(){function t(e){this.audios=[],this.audioFactory=e,this._volume=1,this._isMuted=!1}return t.prototype={addAudio:function(r){this.audios.push(r)},pause:function(){var r,n=this.audios.length;for(r=0;r<n;r+=1)this.audios[r].pause()},resume:function(){var r,n=this.audios.length;for(r=0;r<n;r+=1)this.audios[r].resume()},setRate:function(r){var n,s=this.audios.length;for(n=0;n<s;n+=1)this.audios[n].setRate(r)},createAudio:function(r){return this.audioFactory?this.audioFactory(r):window.Howl?new window.Howl({src:[r]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(r){this.audioFactory=r},setVolume:function(r){this._volume=r,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){var r,n=this.audios.length;for(r=0;r<n;r+=1)this.audios[r].volume(this._volume*(this._isMuted?0:1))}},function(){return new t}}(),createTypedArray=function(){function t(r,n){var s=0,a=[],o;switch(r){case"int16":case"uint8c":o=1;break;default:o=1.1;break}for(s=0;s<n;s+=1)a.push(o);return a}function e(r,n){return r==="float32"?new Float32Array(n):r==="int16"?new Int16Array(n):r==="uint8c"?new Uint8ClampedArray(n):t(r,n)}return typeof Uint8ClampedArray=="function"&&typeof Float32Array=="function"?e:t}();function createSizedArray(t){return Array.apply(null,{length:t})}function _typeof$6(t){"@babel/helpers - typeof";return _typeof$6=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$6(t)}var subframeEnabled=!0,expressionsPlugin=null,expressionsInterfaces=null,idPrefix$1="",isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMax=Math.max,bmMin=Math.min,BMMath={};(function(){var t=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],e,r=t.length;for(e=0;e<r;e+=1)BMMath[t[e]]=Math[t[e]]})(),BMMath.random=Math.random,BMMath.abs=function(t){var e=_typeof$6(t);if(e==="object"&&t.length){var r=createSizedArray(t.length),n,s=t.length;for(n=0;n<s;n+=1)r[n]=Math.abs(t[n]);return r}return Math.abs(t)};var defaultCurveSegments=150,degToRads=Math.PI/180,roundCorner=.5519;function styleDiv(t){t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.display="block",t.style.transformOrigin="0 0",t.style.webkitTransformOrigin="0 0",t.style.backfaceVisibility="visible",t.style.webkitBackfaceVisibility="visible",t.style.transformStyle="preserve-3d",t.style.webkitTransformStyle="preserve-3d",t.style.mozTransformStyle="preserve-3d"}function BMEnterFrameEvent(t,e,r,n){this.type=t,this.currentTime=e,this.totalTime=r,this.direction=n<0?-1:1}function BMCompleteEvent(t,e){this.type=t,this.direction=e<0?-1:1}function BMCompleteLoopEvent(t,e,r,n){this.type=t,this.currentLoop=r,this.totalLoops=e,this.direction=n<0?-1:1}function BMSegmentStartEvent(t,e,r){this.type=t,this.firstFrame=e,this.totalFrames=r}function BMDestroyEvent(t,e){this.type=t,this.target=e}function BMRenderFrameErrorEvent(t,e){this.type="renderFrameError",this.nativeError=t,this.currentTime=e}function BMConfigErrorEvent(t){this.type="configError",this.nativeError=t}var createElementID=function(){var t=0;return function(){return t+=1,idPrefix$1+"__lottie_element_"+t}}();function HSVtoRGB(t,e,r){var n,s,a,o,l,u,c,d;switch(o=Math.floor(t*6),l=t*6-o,u=r*(1-e),c=r*(1-l*e),d=r*(1-(1-l)*e),o%6){case 0:n=r,s=d,a=u;break;case 1:n=c,s=r,a=u;break;case 2:n=u,s=r,a=d;break;case 3:n=u,s=c,a=r;break;case 4:n=d,s=u,a=r;break;case 5:n=r,s=u,a=c;break}return[n,s,a]}function RGBtoHSV(t,e,r){var n=Math.max(t,e,r),s=Math.min(t,e,r),a=n-s,o,l=n===0?0:a/n,u=n/255;switch(n){case s:o=0;break;case t:o=e-r+a*(e<r?6:0),o/=6*a;break;case e:o=r-t+a*2,o/=6*a;break;case r:o=t-e+a*4,o/=6*a;break}return[o,l,u]}function addSaturationToRGB(t,e){var r=RGBtoHSV(t[0]*255,t[1]*255,t[2]*255);return r[1]+=e,r[1]>1?r[1]=1:r[1]<=0&&(r[1]=0),HSVtoRGB(r[0],r[1],r[2])}function addBrightnessToRGB(t,e){var r=RGBtoHSV(t[0]*255,t[1]*255,t[2]*255);return r[2]+=e,r[2]>1?r[2]=1:r[2]<0&&(r[2]=0),HSVtoRGB(r[0],r[1],r[2])}function addHueToRGB(t,e){var r=RGBtoHSV(t[0]*255,t[1]*255,t[2]*255);return r[0]+=e/360,r[0]>1?r[0]-=1:r[0]<0&&(r[0]+=1),HSVtoRGB(r[0],r[1],r[2])}var rgbToHex=function(){var t=[],e,r;for(e=0;e<256;e+=1)r=e.toString(16),t[e]=r.length===1?"0"+r:r;return function(n,s,a){return n<0&&(n=0),s<0&&(s=0),a<0&&(a=0),"#"+t[n]+t[s]+t[a]}}(),setSubframeEnabled=function(e){subframeEnabled=!!e},getSubframeEnabled=function(){return subframeEnabled},setExpressionsPlugin=function(e){expressionsPlugin=e},getExpressionsPlugin=function(){return expressionsPlugin},setExpressionInterfaces=function(e){expressionsInterfaces=e},getExpressionInterfaces=function(){return expressionsInterfaces},setDefaultCurveSegments=function(e){defaultCurveSegments=e},getDefaultCurveSegments=function(){return defaultCurveSegments},setIdPrefix=function(e){idPrefix$1=e};function createNS(t){return document.createElementNS(svgNS,t)}function _typeof$5(t){"@babel/helpers - typeof";return _typeof$5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$5(t)}var dataManager=function(){var t=1,e=[],r,n,s={onmessage:function(){},postMessage:function(y){r({data:y})}},a={postMessage:function(y){s.onmessage({data:y})}};function o(m){if(window.Worker&&window.Blob&&getWebWorker()){var y=new Blob(["var _workerSelf = self; self.onmessage = ",m.toString()],{type:"text/javascript"}),b=URL.createObjectURL(y);return new Worker(b)}return r=m,s}function l(){n||(n=o(function(y){function b(){function T(me,te){var le,Z,Y=me.length,he,oe,ye,Ee;for(Z=0;Z<Y;Z+=1)if(le=me[Z],"ks"in le&&!le.completed){if(le.completed=!0,le.hasMask){var Ae=le.masksProperties;for(oe=Ae.length,he=0;he<oe;he+=1)if(Ae[he].pt.k.i)j(Ae[he].pt.k);else for(Ee=Ae[he].pt.k.length,ye=0;ye<Ee;ye+=1)Ae[he].pt.k[ye].s&&j(Ae[he].pt.k[ye].s[0]),Ae[he].pt.k[ye].e&&j(Ae[he].pt.k[ye].e[0])}le.ty===0?(le.layers=A(le.refId,te),T(le.layers,te)):le.ty===4?I(le.shapes):le.ty===5&&ae(le)}}function S(me,te){if(me){var le=0,Z=me.length;for(le=0;le<Z;le+=1)me[le].t===1&&(me[le].data.layers=A(me[le].data.refId,te),T(me[le].data.layers,te))}}function P(me,te){for(var le=0,Z=te.length;le<Z;){if(te[le].id===me)return te[le];le+=1}return null}function A(me,te){var le=P(me,te);return le?le.layers.__used?JSON.parse(JSON.stringify(le.layers)):(le.layers.__used=!0,le.layers):null}function I(me){var te,le=me.length,Z,Y;for(te=le-1;te>=0;te-=1)if(me[te].ty==="sh")if(me[te].ks.k.i)j(me[te].ks.k);else for(Y=me[te].ks.k.length,Z=0;Z<Y;Z+=1)me[te].ks.k[Z].s&&j(me[te].ks.k[Z].s[0]),me[te].ks.k[Z].e&&j(me[te].ks.k[Z].e[0]);else me[te].ty==="gr"&&I(me[te].it)}function j(me){var te,le=me.i.length;for(te=0;te<le;te+=1)me.i[te][0]+=me.v[te][0],me.i[te][1]+=me.v[te][1],me.o[te][0]+=me.v[te][0],me.o[te][1]+=me.v[te][1]}function K(me,te){var le=te?te.split("."):[100,100,100];return me[0]>le[0]?!0:le[0]>me[0]?!1:me[1]>le[1]?!0:le[1]>me[1]?!1:me[2]>le[2]?!0:le[2]>me[2]?!1:null}var W=function(){var me=[4,4,14];function te(Z){var Y=Z.t.d;Z.t.d={k:[{s:Y,t:0}]}}function le(Z){var Y,he=Z.length;for(Y=0;Y<he;Y+=1)Z[Y].ty===5&&te(Z[Y])}return function(Z){if(K(me,Z.v)&&(le(Z.layers),Z.assets)){var Y,he=Z.assets.length;for(Y=0;Y<he;Y+=1)Z.assets[Y].layers&&le(Z.assets[Y].layers)}}}(),H=function(){var me=[4,7,99];return function(te){if(te.chars&&!K(me,te.v)){var le,Z=te.chars.length;for(le=0;le<Z;le+=1){var Y=te.chars[le];Y.data&&Y.data.shapes&&(I(Y.data.shapes),Y.data.ip=0,Y.data.op=99999,Y.data.st=0,Y.data.sr=1,Y.data.ks={p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0}},te.chars[le].t||(Y.data.shapes.push({ty:"no"}),Y.data.shapes[0].it.push({p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0},sk:{k:0,a:0},sa:{k:0,a:0},ty:"tr"})))}}}}(),ee=function(){var me=[5,7,15];function te(Z){var Y=Z.t.p;typeof Y.a=="number"&&(Y.a={a:0,k:Y.a}),typeof Y.p=="number"&&(Y.p={a:0,k:Y.p}),typeof Y.r=="number"&&(Y.r={a:0,k:Y.r})}function le(Z){var Y,he=Z.length;for(Y=0;Y<he;Y+=1)Z[Y].ty===5&&te(Z[Y])}return function(Z){if(K(me,Z.v)&&(le(Z.layers),Z.assets)){var Y,he=Z.assets.length;for(Y=0;Y<he;Y+=1)Z.assets[Y].layers&&le(Z.assets[Y].layers)}}}(),ue=function(){var me=[4,1,9];function te(Z){var Y,he=Z.length,oe,ye;for(Y=0;Y<he;Y+=1)if(Z[Y].ty==="gr")te(Z[Y].it);else if(Z[Y].ty==="fl"||Z[Y].ty==="st")if(Z[Y].c.k&&Z[Y].c.k[0].i)for(ye=Z[Y].c.k.length,oe=0;oe<ye;oe+=1)Z[Y].c.k[oe].s&&(Z[Y].c.k[oe].s[0]/=255,Z[Y].c.k[oe].s[1]/=255,Z[Y].c.k[oe].s[2]/=255,Z[Y].c.k[oe].s[3]/=255),Z[Y].c.k[oe].e&&(Z[Y].c.k[oe].e[0]/=255,Z[Y].c.k[oe].e[1]/=255,Z[Y].c.k[oe].e[2]/=255,Z[Y].c.k[oe].e[3]/=255);else Z[Y].c.k[0]/=255,Z[Y].c.k[1]/=255,Z[Y].c.k[2]/=255,Z[Y].c.k[3]/=255}function le(Z){var Y,he=Z.length;for(Y=0;Y<he;Y+=1)Z[Y].ty===4&&te(Z[Y].shapes)}return function(Z){if(K(me,Z.v)&&(le(Z.layers),Z.assets)){var Y,he=Z.assets.length;for(Y=0;Y<he;Y+=1)Z.assets[Y].layers&&le(Z.assets[Y].layers)}}}(),de=function(){var me=[4,4,18];function te(Z){var Y,he=Z.length,oe,ye;for(Y=he-1;Y>=0;Y-=1)if(Z[Y].ty==="sh")if(Z[Y].ks.k.i)Z[Y].ks.k.c=Z[Y].closed;else for(ye=Z[Y].ks.k.length,oe=0;oe<ye;oe+=1)Z[Y].ks.k[oe].s&&(Z[Y].ks.k[oe].s[0].c=Z[Y].closed),Z[Y].ks.k[oe].e&&(Z[Y].ks.k[oe].e[0].c=Z[Y].closed);else Z[Y].ty==="gr"&&te(Z[Y].it)}function le(Z){var Y,he,oe=Z.length,ye,Ee,Ae,je;for(he=0;he<oe;he+=1){if(Y=Z[he],Y.hasMask){var Te=Y.masksProperties;for(Ee=Te.length,ye=0;ye<Ee;ye+=1)if(Te[ye].pt.k.i)Te[ye].pt.k.c=Te[ye].cl;else for(je=Te[ye].pt.k.length,Ae=0;Ae<je;Ae+=1)Te[ye].pt.k[Ae].s&&(Te[ye].pt.k[Ae].s[0].c=Te[ye].cl),Te[ye].pt.k[Ae].e&&(Te[ye].pt.k[Ae].e[0].c=Te[ye].cl)}Y.ty===4&&te(Y.shapes)}}return function(Z){if(K(me,Z.v)&&(le(Z.layers),Z.assets)){var Y,he=Z.assets.length;for(Y=0;Y<he;Y+=1)Z.assets[Y].layers&&le(Z.assets[Y].layers)}}}();function fe(me){me.__complete||(ue(me),W(me),H(me),ee(me),de(me),T(me.layers,me.assets),S(me.chars,me.assets),me.__complete=!0)}function ae(me){me.t.a.length===0&&"m"in me.t.p}var ce={};return ce.completeData=fe,ce.checkColors=ue,ce.checkChars=H,ce.checkPathProperties=ee,ce.checkShapes=de,ce.completeLayers=T,ce}if(a.dataManager||(a.dataManager=b()),a.assetLoader||(a.assetLoader=function(){function T(P){var A=P.getResponseHeader("content-type");return A&&P.responseType==="json"&&A.indexOf("json")!==-1||P.response&&_typeof$5(P.response)==="object"?P.response:P.response&&typeof P.response=="string"?JSON.parse(P.response):P.responseText?JSON.parse(P.responseText):null}function S(P,A,I,j){var K,W=new XMLHttpRequest;try{W.responseType="json"}catch{}W.onreadystatechange=function(){if(W.readyState===4)if(W.status===200)K=T(W),I(K);else try{K=T(W),I(K)}catch(H){j&&j(H)}};try{W.open(["G","E","T"].join(""),P,!0)}catch{W.open(["G","E","T"].join(""),A+"/"+P,!0)}W.send()}return{load:S}}()),y.data.type==="loadAnimation")a.assetLoader.load(y.data.path,y.data.fullPath,function(T){a.dataManager.completeData(T),a.postMessage({id:y.data.id,payload:T,status:"success"})},function(){a.postMessage({id:y.data.id,status:"error"})});else if(y.data.type==="complete"){var E=y.data.animation;a.dataManager.completeData(E),a.postMessage({id:y.data.id,payload:E,status:"success"})}else y.data.type==="loadData"&&a.assetLoader.load(y.data.path,y.data.fullPath,function(T){a.postMessage({id:y.data.id,payload:T,status:"success"})},function(){a.postMessage({id:y.data.id,status:"error"})})}),n.onmessage=function(m){var y=m.data,b=y.id,E=e[b];e[b]=null,y.status==="success"?E.onComplete(y.payload):E.onError&&E.onError()})}function u(m,y){t+=1;var b="processId_"+t;return e[b]={onComplete:m,onError:y},b}function c(m,y,b){l();var E=u(y,b);n.postMessage({type:"loadAnimation",path:m,fullPath:window.location.origin+window.location.pathname,id:E})}function d(m,y,b){l();var E=u(y,b);n.postMessage({type:"loadData",path:m,fullPath:window.location.origin+window.location.pathname,id:E})}function p(m,y,b){l();var E=u(y,b);n.postMessage({type:"complete",animation:m,id:E})}return{loadAnimation:c,loadData:d,completeAnimation:p}}(),ImagePreloader=function(){var t=function(){var S=createTag("canvas");S.width=1,S.height=1;var P=S.getContext("2d");return P.fillStyle="rgba(0,0,0,0)",P.fillRect(0,0,1,1),S}();function e(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function r(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function n(S,P,A){var I="";if(S.e)I=S.p;else if(P){var j=S.p;j.indexOf("images/")!==-1&&(j=j.split("/")[1]),I=P+j}else I=A,I+=S.u?S.u:"",I+=S.p;return I}function s(S){var P=0,A=setInterval((function(){var I=S.getBBox();(I.width||P>500)&&(this._imageLoaded(),clearInterval(A)),P+=1}).bind(this),50)}function a(S){var P=n(S,this.assetsPath,this.path),A=createNS("image");isSafari?this.testImageLoaded(A):A.addEventListener("load",this._imageLoaded,!1),A.addEventListener("error",(function(){I.img=t,this._imageLoaded()}).bind(this),!1),A.setAttributeNS("http://www.w3.org/1999/xlink","href",P),this._elementHelper.append?this._elementHelper.append(A):this._elementHelper.appendChild(A);var I={img:A,assetData:S};return I}function o(S){var P=n(S,this.assetsPath,this.path),A=createTag("img");A.crossOrigin="anonymous",A.addEventListener("load",this._imageLoaded,!1),A.addEventListener("error",(function(){I.img=t,this._imageLoaded()}).bind(this),!1),A.src=P;var I={img:A,assetData:S};return I}function l(S){var P={assetData:S},A=n(S,this.assetsPath,this.path);return dataManager.loadData(A,(function(I){P.img=I,this._footageLoaded()}).bind(this),(function(){P.img={},this._footageLoaded()}).bind(this)),P}function u(S,P){this.imagesLoadedCb=P;var A,I=S.length;for(A=0;A<I;A+=1)S[A].layers||(!S[A].t||S[A].t==="seq"?(this.totalImages+=1,this.images.push(this._createImageData(S[A]))):S[A].t===3&&(this.totalFootages+=1,this.images.push(this.createFootageData(S[A]))))}function c(S){this.path=S||""}function d(S){this.assetsPath=S||""}function p(S){for(var P=0,A=this.images.length;P<A;){if(this.images[P].assetData===S)return this.images[P].img;P+=1}return null}function m(){this.imagesLoadedCb=null,this.images.length=0}function y(){return this.totalImages===this.loadedAssets}function b(){return this.totalFootages===this.loadedFootagesCount}function E(S,P){S==="svg"?(this._elementHelper=P,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}function T(){this._imageLoaded=e.bind(this),this._footageLoaded=r.bind(this),this.testImageLoaded=s.bind(this),this.createFootageData=l.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return T.prototype={loadAssets:u,setAssetsPath:d,setPath:c,loadedImages:y,loadedFootages:b,destroy:m,getAsset:p,createImgData:o,createImageData:a,imageLoaded:e,footageLoaded:r,setCacheType:E},T}();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(e,r){if(this._cbs[e])for(var n=this._cbs[e],s=0;s<n.length;s+=1)n[s](r)},addEventListener:function(e,r){return this._cbs[e]||(this._cbs[e]=[]),this._cbs[e].push(r),(function(){this.removeEventListener(e,r)}).bind(this)},removeEventListener:function(e,r){if(!r)this._cbs[e]=null;else if(this._cbs[e]){for(var n=0,s=this._cbs[e].length;n<s;)this._cbs[e][n]===r&&(this._cbs[e].splice(n,1),n-=1,s-=1),n+=1;this._cbs[e].length||(this._cbs[e]=null)}}};var markerParser=function(){function t(e){for(var r=e.split(`\r
`),n={},s,a=0,o=0;o<r.length;o+=1)s=r[o].split(":"),s.length===2&&(n[s[0]]=s[1].trim(),a+=1);if(a===0)throw new Error;return n}return function(e){for(var r=[],n=0;n<e.length;n+=1){var s=e[n],a={time:s.tm,duration:s.dr};try{a.payload=JSON.parse(e[n].cm)}catch{try{a.payload=t(e[n].cm)}catch{a.payload={name:e[n].cm}}}r.push(a)}return r}}(),ProjectInterface=function(){function t(e){this.compositions.push(e)}return function(){function e(r){for(var n=0,s=this.compositions.length;n<s;){if(this.compositions[n].data&&this.compositions[n].data.nm===r)return this.compositions[n].prepareFrame&&this.compositions[n].data.xt&&this.compositions[n].prepareFrame(this.currentFrame),this.compositions[n].compInterface;n+=1}return null}return e.compositions=[],e.currentFrame=0,e.registerComposition=t,e}}(),renderers={},registerRenderer=function(e,r){renderers[e]=r};function getRenderer(t){return renderers[t]}function getRegisteredRenderer(){if(renderers.canvas)return"canvas";for(var t in renderers)if(renderers[t])return t;return""}function _typeof$4(t){"@babel/helpers - typeof";return _typeof$4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$4(t)}var AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=getSubframeEnabled(),this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader,this.audioController=audioControllerFactory(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this),this.drawnFrameEvent=new BMEnterFrameEvent("drawnFrame",0,0,0),this.expressionsPlugin=getExpressionsPlugin()};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(t){(t.wrapper||t.container)&&(this.wrapper=t.wrapper||t.container);var e="svg";t.animType?e=t.animType:t.renderer&&(e=t.renderer);var r=getRenderer(e);this.renderer=new r(this,t.rendererSettings),this.imagePreloader.setCacheType(e,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=e,t.loop===""||t.loop===null||t.loop===void 0||t.loop===!0?this.loop=!0:t.loop===!1?this.loop=!1:this.loop=parseInt(t.loop,10),this.autoplay="autoplay"in t?t.autoplay:!0,this.name=t.name?t.name:"",this.autoloadSegments=Object.prototype.hasOwnProperty.call(t,"autoloadSegments")?t.autoloadSegments:!0,this.assetsPath=t.assetsPath,this.initialSegment=t.initialSegment,t.audioFactory&&this.audioController.setAudioFactory(t.audioFactory),t.animationData?this.setupAnimation(t.animationData):t.path&&(t.path.lastIndexOf("\\")!==-1?this.path=t.path.substr(0,t.path.lastIndexOf("\\")+1):this.path=t.path.substr(0,t.path.lastIndexOf("/")+1),this.fileName=t.path.substr(t.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),dataManager.loadAnimation(t.path,this.configAnimation,this.onSetupError))},AnimationItem.prototype.onSetupError=function(){this.trigger("data_failed")},AnimationItem.prototype.setupAnimation=function(t){dataManager.completeAnimation(t,this.configAnimation)},AnimationItem.prototype.setData=function(t,e){e&&_typeof$4(e)!=="object"&&(e=JSON.parse(e));var r={wrapper:t,animationData:e},n=t.attributes;r.path=n.getNamedItem("data-animation-path")?n.getNamedItem("data-animation-path").value:n.getNamedItem("data-bm-path")?n.getNamedItem("data-bm-path").value:n.getNamedItem("bm-path")?n.getNamedItem("bm-path").value:"",r.animType=n.getNamedItem("data-anim-type")?n.getNamedItem("data-anim-type").value:n.getNamedItem("data-bm-type")?n.getNamedItem("data-bm-type").value:n.getNamedItem("bm-type")?n.getNamedItem("bm-type").value:n.getNamedItem("data-bm-renderer")?n.getNamedItem("data-bm-renderer").value:n.getNamedItem("bm-renderer")?n.getNamedItem("bm-renderer").value:getRegisteredRenderer()||"canvas";var s=n.getNamedItem("data-anim-loop")?n.getNamedItem("data-anim-loop").value:n.getNamedItem("data-bm-loop")?n.getNamedItem("data-bm-loop").value:n.getNamedItem("bm-loop")?n.getNamedItem("bm-loop").value:"";s==="false"?r.loop=!1:s==="true"?r.loop=!0:s!==""&&(r.loop=parseInt(s,10));var a=n.getNamedItem("data-anim-autoplay")?n.getNamedItem("data-anim-autoplay").value:n.getNamedItem("data-bm-autoplay")?n.getNamedItem("data-bm-autoplay").value:n.getNamedItem("bm-autoplay")?n.getNamedItem("bm-autoplay").value:!0;r.autoplay=a!=="false",r.name=n.getNamedItem("data-name")?n.getNamedItem("data-name").value:n.getNamedItem("data-bm-name")?n.getNamedItem("data-bm-name").value:n.getNamedItem("bm-name")?n.getNamedItem("bm-name").value:"";var o=n.getNamedItem("data-anim-prerender")?n.getNamedItem("data-anim-prerender").value:n.getNamedItem("data-bm-prerender")?n.getNamedItem("data-bm-prerender").value:n.getNamedItem("bm-prerender")?n.getNamedItem("bm-prerender").value:"";o==="false"&&(r.prerender=!1),r.path?this.setParams(r):this.trigger("destroy")},AnimationItem.prototype.includeLayers=function(t){t.op>this.animationData.op&&(this.animationData.op=t.op,this.totalFrames=Math.floor(t.op-this.animationData.ip));var e=this.animationData.layers,r,n=e.length,s=t.layers,a,o=s.length;for(a=0;a<o;a+=1)for(r=0;r<n;){if(e[r].id===s[a].id){e[r]=s[a];break}r+=1}if((t.chars||t.fonts)&&(this.renderer.globalData.fontManager.addChars(t.chars),this.renderer.globalData.fontManager.addFonts(t.fonts,this.renderer.globalData.defs)),t.assets)for(n=t.assets.length,r=0;r<n;r+=1)this.animationData.assets.push(t.assets[r]);this.animationData.__complete=!1,dataManager.completeAnimation(this.animationData,this.onSegmentComplete)},AnimationItem.prototype.onSegmentComplete=function(t){this.animationData=t;var e=getExpressionsPlugin();e&&e.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var t=this.animationData.segments;if(!t||t.length===0||!this.autoloadSegments){this.trigger("data_ready"),this.timeCompleted=this.totalFrames;return}var e=t.shift();this.timeCompleted=e.time*this.frameRate;var r=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,dataManager.loadData(r,this.includeLayers.bind(this),(function(){this.trigger("data_failed")}).bind(this))},AnimationItem.prototype.loadSegments=function(){var t=this.animationData.segments;t||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(t){if(this.renderer)try{this.animationData=t,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(t),t.assets||(t.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(t.assets),this.markers=markerParser(t.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(e){this.triggerConfigError(e)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){if(!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||this.renderer.rendererType!=="canvas")&&this.imagePreloader.loadedFootages()){this.isLoaded=!0;var t=getExpressionsPlugin();t&&t.initExpressions(this),this.renderer.initItems(),setTimeout((function(){this.trigger("DOMLoaded")}).bind(this),0),this.gotoFrame(),this.autoplay&&this.play()}},AnimationItem.prototype.resize=function(t,e){var r=typeof t=="number"?t:void 0,n=typeof e=="number"?e:void 0;this.renderer.updateContainerSize(r,n)},AnimationItem.prototype.setSubframe=function(t){this.isSubframeEnabled=!!t},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame")},AnimationItem.prototype.renderFrame=function(){if(!(this.isLoaded===!1||!this.renderer))try{this.expressionsPlugin&&this.expressionsPlugin.resetFrame(),this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(t){this.triggerRenderFrameError(t)}},AnimationItem.prototype.play=function(t){t&&this.name!==t||this.isPaused===!0&&(this.isPaused=!1,this.trigger("_play"),this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")))},AnimationItem.prototype.pause=function(t){t&&this.name!==t||this.isPaused===!1&&(this.isPaused=!0,this.trigger("_pause"),this._idle=!0,this.trigger("_idle"),this.audioController.pause())},AnimationItem.prototype.togglePause=function(t){t&&this.name!==t||(this.isPaused===!0?this.play():this.pause())},AnimationItem.prototype.stop=function(t){t&&this.name!==t||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.getMarkerData=function(t){for(var e,r=0;r<this.markers.length;r+=1)if(e=this.markers[r],e.payload&&e.payload.name===t)return e;return null},AnimationItem.prototype.goToAndStop=function(t,e,r){if(!(r&&this.name!==r)){var n=Number(t);if(isNaN(n)){var s=this.getMarkerData(t);s&&this.goToAndStop(s.time,!0)}else e?this.setCurrentRawFrameValue(t):this.setCurrentRawFrameValue(t*this.frameModifier);this.pause()}},AnimationItem.prototype.goToAndPlay=function(t,e,r){if(!(r&&this.name!==r)){var n=Number(t);if(isNaN(n)){var s=this.getMarkerData(t);s&&(s.duration?this.playSegments([s.time,s.time+s.duration],!0):this.goToAndStop(s.time,!0))}else this.goToAndStop(n,e,r);this.play()}},AnimationItem.prototype.advanceTime=function(t){if(!(this.isPaused===!0||this.isLoaded===!1)){var e=this.currentRawFrame+t*this.frameModifier,r=!1;e>=this.totalFrames-1&&this.frameModifier>0?!this.loop||this.playCount===this.loop?this.checkSegments(e>this.totalFrames?e%this.totalFrames:0)||(r=!0,e=this.totalFrames-1):e>=this.totalFrames?(this.playCount+=1,this.checkSegments(e%this.totalFrames)||(this.setCurrentRawFrameValue(e%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(e):e<0?this.checkSegments(e%this.totalFrames)||(this.loop&&!(this.playCount--<=0&&this.loop!==!0)?(this.setCurrentRawFrameValue(this.totalFrames+e%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0):(r=!0,e=0)):this.setCurrentRawFrameValue(e),r&&(this.setCurrentRawFrameValue(e),this.pause(),this.trigger("complete"))}},AnimationItem.prototype.adjustSegment=function(t,e){this.playCount=0,t[1]<t[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=t[0]-t[1],this.timeCompleted=this.totalFrames,this.firstFrame=t[1],this.setCurrentRawFrameValue(this.totalFrames-.001-e)):t[1]>t[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=t[1]-t[0],this.timeCompleted=this.totalFrames,this.firstFrame=t[0],this.setCurrentRawFrameValue(.001+e)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(t,e){var r=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<t?r=t:this.currentRawFrame+this.firstFrame>e&&(r=e-t)),this.firstFrame=t,this.totalFrames=e-t,this.timeCompleted=this.totalFrames,r!==-1&&this.goToAndStop(r,!0)},AnimationItem.prototype.playSegments=function(t,e){if(e&&(this.segments.length=0),_typeof$4(t[0])==="object"){var r,n=t.length;for(r=0;r<n;r+=1)this.segments.push(t[r])}else this.segments.push(t);this.segments.length&&e&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(t){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),t&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(t){return this.segments.length?(this.adjustSegment(this.segments.shift(),t),!0):!1},AnimationItem.prototype.destroy=function(t){t&&this.name!==t||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.expressionsPlugin=null,this.imagePreloader=null,this.projectInterface=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(t){this.currentRawFrame=t,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(t){this.playSpeed=t,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(t){this.playDirection=t<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.setLoop=function(t){this.loop=t},AnimationItem.prototype.setVolume=function(t,e){e&&this.name!==e||this.audioController.setVolume(t)},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume()},AnimationItem.prototype.mute=function(t){t&&this.name!==t||this.audioController.mute()},AnimationItem.prototype.unmute=function(t){t&&this.name!==t||this.audioController.unmute()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(t){var e="";if(t.e)e=t.p;else if(this.assetsPath){var r=t.p;r.indexOf("images/")!==-1&&(r=r.split("/")[1]),e=this.assetsPath+r}else e=this.path,e+=t.u?t.u:"",e+=t.p;return e},AnimationItem.prototype.getAssetData=function(t){for(var e=0,r=this.assets.length;e<r;){if(t===this.assets[e].id)return this.assets[e];e+=1}return null},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(t){return t?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.updateDocumentData=function(t,e,r){try{var n=this.renderer.getElementByPath(t);n.updateDocumentData(e,r)}catch{}},AnimationItem.prototype.trigger=function(t){if(this._cbs&&this._cbs[t])switch(t){case"enterFrame":this.triggerEvent(t,new BMEnterFrameEvent(t,this.currentFrame,this.totalFrames,this.frameModifier));break;case"drawnFrame":this.drawnFrameEvent.currentTime=this.currentFrame,this.drawnFrameEvent.totalTime=this.totalFrames,this.drawnFrameEvent.direction=this.frameModifier,this.triggerEvent(t,this.drawnFrameEvent);break;case"loopComplete":this.triggerEvent(t,new BMCompleteLoopEvent(t,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(t,new BMCompleteEvent(t,this.frameMult));break;case"segmentStart":this.triggerEvent(t,new BMSegmentStartEvent(t,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(t,new BMDestroyEvent(t,this));break;default:this.triggerEvent(t)}t==="enterFrame"&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(t,this.currentFrame,this.totalFrames,this.frameMult)),t==="loopComplete"&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(t,this.loop,this.playCount,this.frameMult)),t==="complete"&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(t,this.frameMult)),t==="segmentStart"&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(t,this.firstFrame,this.totalFrames)),t==="destroy"&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(t,this))},AnimationItem.prototype.triggerRenderFrameError=function(t){var e=new BMRenderFrameErrorEvent(t,this.currentFrame);this.triggerEvent("error",e),this.onError&&this.onError.call(this,e)},AnimationItem.prototype.triggerConfigError=function(t){var e=new BMConfigErrorEvent(t,this.currentFrame);this.triggerEvent("error",e),this.onError&&this.onError.call(this,e)};var animationManager=function(){var t={},e=[],r=0,n=0,s=0,a=!0,o=!1;function l(te){for(var le=0,Z=te.target;le<n;)e[le].animation===Z&&(e.splice(le,1),le-=1,n-=1,Z.isPaused||p()),le+=1}function u(te,le){if(!te)return null;for(var Z=0;Z<n;){if(e[Z].elem===te&&e[Z].elem!==null)return e[Z].animation;Z+=1}var Y=new AnimationItem;return m(Y,te),Y.setData(te,le),Y}function c(){var te,le=e.length,Z=[];for(te=0;te<le;te+=1)Z.push(e[te].animation);return Z}function d(){s+=1,ue()}function p(){s-=1}function m(te,le){te.addEventListener("destroy",l),te.addEventListener("_active",d),te.addEventListener("_idle",p),e.push({elem:le,animation:te}),n+=1}function y(te){var le=new AnimationItem;return m(le,null),le.setParams(te),le}function b(te,le){var Z;for(Z=0;Z<n;Z+=1)e[Z].animation.setSpeed(te,le)}function E(te,le){var Z;for(Z=0;Z<n;Z+=1)e[Z].animation.setDirection(te,le)}function T(te){var le;for(le=0;le<n;le+=1)e[le].animation.play(te)}function S(te){var le=te-r,Z;for(Z=0;Z<n;Z+=1)e[Z].animation.advanceTime(le);r=te,s&&!o?window.requestAnimationFrame(S):a=!0}function P(te){r=te,window.requestAnimationFrame(S)}function A(te){var le;for(le=0;le<n;le+=1)e[le].animation.pause(te)}function I(te,le,Z){var Y;for(Y=0;Y<n;Y+=1)e[Y].animation.goToAndStop(te,le,Z)}function j(te){var le;for(le=0;le<n;le+=1)e[le].animation.stop(te)}function K(te){var le;for(le=0;le<n;le+=1)e[le].animation.togglePause(te)}function W(te){var le;for(le=n-1;le>=0;le-=1)e[le].animation.destroy(te)}function H(te,le,Z){var Y=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),he,oe=Y.length;for(he=0;he<oe;he+=1)Z&&Y[he].setAttribute("data-bm-type",Z),u(Y[he],te);if(le&&oe===0){Z||(Z="svg");var ye=document.getElementsByTagName("body")[0];ye.innerText="";var Ee=createTag("div");Ee.style.width="100%",Ee.style.height="100%",Ee.setAttribute("data-bm-type",Z),ye.appendChild(Ee),u(Ee,te)}}function ee(){var te;for(te=0;te<n;te+=1)e[te].animation.resize()}function ue(){!o&&s&&a&&(window.requestAnimationFrame(P),a=!1)}function de(){o=!0}function fe(){o=!1,ue()}function ae(te,le){var Z;for(Z=0;Z<n;Z+=1)e[Z].animation.setVolume(te,le)}function ce(te){var le;for(le=0;le<n;le+=1)e[le].animation.mute(te)}function me(te){var le;for(le=0;le<n;le+=1)e[le].animation.unmute(te)}return t.registerAnimation=u,t.loadAnimation=y,t.setSpeed=b,t.setDirection=E,t.play=T,t.pause=A,t.stop=j,t.togglePause=K,t.searchAnimations=H,t.resize=ee,t.goToAndStop=I,t.destroy=W,t.freeze=de,t.unfreeze=fe,t.setVolume=ae,t.mute=ce,t.unmute=me,t.getRegisteredAnimations=c,t}(),BezierFactory=function(){var t={};t.getBezierEasing=r;var e={};function r(P,A,I,j,K){var W=K||("bez_"+P+"_"+A+"_"+I+"_"+j).replace(/\./g,"p");if(e[W])return e[W];var H=new S([P,A,I,j]);return e[W]=H,H}var n=4,s=.001,a=1e-7,o=10,l=11,u=1/(l-1),c=typeof Float32Array=="function";function d(P,A){return 1-3*A+3*P}function p(P,A){return 3*A-6*P}function m(P){return 3*P}function y(P,A,I){return((d(A,I)*P+p(A,I))*P+m(A))*P}function b(P,A,I){return 3*d(A,I)*P*P+2*p(A,I)*P+m(A)}function E(P,A,I,j,K){var W,H,ee=0;do H=A+(I-A)/2,W=y(H,j,K)-P,W>0?I=H:A=H;while(Math.abs(W)>a&&++ee<o);return H}function T(P,A,I,j){for(var K=0;K<n;++K){var W=b(A,I,j);if(W===0)return A;var H=y(A,I,j)-P;A-=H/W}return A}function S(P){this._p=P,this._mSampleValues=c?new Float32Array(l):new Array(l),this._precomputed=!1,this.get=this.get.bind(this)}return S.prototype={get:function(A){var I=this._p[0],j=this._p[1],K=this._p[2],W=this._p[3];return this._precomputed||this._precompute(),I===j&&K===W?A:A===0?0:A===1?1:y(this._getTForX(A),j,W)},_precompute:function(){var A=this._p[0],I=this._p[1],j=this._p[2],K=this._p[3];this._precomputed=!0,(A!==I||j!==K)&&this._calcSampleValues()},_calcSampleValues:function(){for(var A=this._p[0],I=this._p[2],j=0;j<l;++j)this._mSampleValues[j]=y(j*u,A,I)},_getTForX:function(A){for(var I=this._p[0],j=this._p[2],K=this._mSampleValues,W=0,H=1,ee=l-1;H!==ee&&K[H]<=A;++H)W+=u;--H;var ue=(A-K[H])/(K[H+1]-K[H]),de=W+ue*u,fe=b(de,I,j);return fe>=s?T(A,de,I,j):fe===0?de:E(A,W,W+u,I,j)}},t}(),pooling=function(){function t(e){return e.concat(createSizedArray(e.length))}return{double:t}}(),poolFactory=function(){return function(t,e,r){var n=0,s=t,a=createSizedArray(s),o={newElement:l,release:u};function l(){var c;return n?(n-=1,c=a[n]):c=e(),c}function u(c){n===s&&(a=pooling.double(a),s*=2),r&&r(c),a[n]=c,n+=1}return o}}(),bezierLengthPool=function(){function t(){return{addedLength:0,percents:createTypedArray("float32",getDefaultCurveSegments()),lengths:createTypedArray("float32",getDefaultCurveSegments())}}return poolFactory(8,t)}(),segmentsLengthPool=function(){function t(){return{lengths:[],totalLength:0}}function e(r){var n,s=r.lengths.length;for(n=0;n<s;n+=1)bezierLengthPool.release(r.lengths[n]);r.lengths.length=0}return poolFactory(8,t,e)}();function bezFunction(){var t=Math;function e(m,y,b,E,T,S){var P=m*E+y*T+b*S-T*E-S*m-b*y;return P>-.001&&P<.001}function r(m,y,b,E,T,S,P,A,I){if(b===0&&S===0&&I===0)return e(m,y,E,T,P,A);var j=t.sqrt(t.pow(E-m,2)+t.pow(T-y,2)+t.pow(S-b,2)),K=t.sqrt(t.pow(P-m,2)+t.pow(A-y,2)+t.pow(I-b,2)),W=t.sqrt(t.pow(P-E,2)+t.pow(A-T,2)+t.pow(I-S,2)),H;return j>K?j>W?H=j-K-W:H=W-K-j:W>K?H=W-K-j:H=K-j-W,H>-1e-4&&H<1e-4}var n=function(){return function(m,y,b,E){var T=getDefaultCurveSegments(),S,P,A,I,j,K=0,W,H=[],ee=[],ue=bezierLengthPool.newElement();for(A=b.length,S=0;S<T;S+=1){for(j=S/(T-1),W=0,P=0;P<A;P+=1)I=bmPow(1-j,3)*m[P]+3*bmPow(1-j,2)*j*b[P]+3*(1-j)*bmPow(j,2)*E[P]+bmPow(j,3)*y[P],H[P]=I,ee[P]!==null&&(W+=bmPow(H[P]-ee[P],2)),ee[P]=H[P];W&&(W=bmSqrt(W),K+=W),ue.percents[S]=j,ue.lengths[S]=K}return ue.addedLength=K,ue}}();function s(m){var y=segmentsLengthPool.newElement(),b=m.c,E=m.v,T=m.o,S=m.i,P,A=m._length,I=y.lengths,j=0;for(P=0;P<A-1;P+=1)I[P]=n(E[P],E[P+1],T[P],S[P+1]),j+=I[P].addedLength;return b&&A&&(I[P]=n(E[P],E[0],T[P],S[0]),j+=I[P].addedLength),y.totalLength=j,y}function a(m){this.segmentLength=0,this.points=new Array(m)}function o(m,y){this.partialLength=m,this.point=y}var l=function(){var m={};return function(y,b,E,T){var S=(y[0]+"_"+y[1]+"_"+b[0]+"_"+b[1]+"_"+E[0]+"_"+E[1]+"_"+T[0]+"_"+T[1]).replace(/\./g,"p");if(!m[S]){var P=getDefaultCurveSegments(),A,I,j,K,W,H=0,ee,ue,de=null;y.length===2&&(y[0]!==b[0]||y[1]!==b[1])&&e(y[0],y[1],b[0],b[1],y[0]+E[0],y[1]+E[1])&&e(y[0],y[1],b[0],b[1],b[0]+T[0],b[1]+T[1])&&(P=2);var fe=new a(P);for(j=E.length,A=0;A<P;A+=1){for(ue=createSizedArray(j),W=A/(P-1),ee=0,I=0;I<j;I+=1)K=bmPow(1-W,3)*y[I]+3*bmPow(1-W,2)*W*(y[I]+E[I])+3*(1-W)*bmPow(W,2)*(b[I]+T[I])+bmPow(W,3)*b[I],ue[I]=K,de!==null&&(ee+=bmPow(ue[I]-de[I],2));ee=bmSqrt(ee),H+=ee,fe.points[A]=new o(ee,ue),de=ue}fe.segmentLength=H,m[S]=fe}return m[S]}}();function u(m,y){var b=y.percents,E=y.lengths,T=b.length,S=bmFloor((T-1)*m),P=m*y.addedLength,A=0;if(S===T-1||S===0||P===E[S])return b[S];for(var I=E[S]>P?-1:1,j=!0;j;)if(E[S]<=P&&E[S+1]>P?(A=(P-E[S])/(E[S+1]-E[S]),j=!1):S+=I,S<0||S>=T-1){if(S===T-1)return b[S];j=!1}return b[S]+(b[S+1]-b[S])*A}function c(m,y,b,E,T,S){var P=u(T,S),A=1-P,I=t.round((A*A*A*m[0]+(P*A*A+A*P*A+A*A*P)*b[0]+(P*P*A+A*P*P+P*A*P)*E[0]+P*P*P*y[0])*1e3)/1e3,j=t.round((A*A*A*m[1]+(P*A*A+A*P*A+A*A*P)*b[1]+(P*P*A+A*P*P+P*A*P)*E[1]+P*P*P*y[1])*1e3)/1e3;return[I,j]}var d=createTypedArray("float32",8);function p(m,y,b,E,T,S,P){T<0?T=0:T>1&&(T=1);var A=u(T,P);S=S>1?1:S;var I=u(S,P),j,K=m.length,W=1-A,H=1-I,ee=W*W*W,ue=A*W*W*3,de=A*A*W*3,fe=A*A*A,ae=W*W*H,ce=A*W*H+W*A*H+W*W*I,me=A*A*H+W*A*I+A*W*I,te=A*A*I,le=W*H*H,Z=A*H*H+W*I*H+W*H*I,Y=A*I*H+W*I*I+A*H*I,he=A*I*I,oe=H*H*H,ye=I*H*H+H*I*H+H*H*I,Ee=I*I*H+H*I*I+I*H*I,Ae=I*I*I;for(j=0;j<K;j+=1)d[j*4]=t.round((ee*m[j]+ue*b[j]+de*E[j]+fe*y[j])*1e3)/1e3,d[j*4+1]=t.round((ae*m[j]+ce*b[j]+me*E[j]+te*y[j])*1e3)/1e3,d[j*4+2]=t.round((le*m[j]+Z*b[j]+Y*E[j]+he*y[j])*1e3)/1e3,d[j*4+3]=t.round((oe*m[j]+ye*b[j]+Ee*E[j]+Ae*y[j])*1e3)/1e3;return d}return{getSegmentsLength:s,getNewSegment:p,getPointInSegment:c,buildBezierData:l,pointOnLine2D:e,pointOnLine3D:r}}var bez=bezFunction(),initFrame=initialDefaultFrame,mathAbs=Math.abs;function interpolateValue(t,e){var r=this.offsetTime,n;this.propType==="multidimensional"&&(n=createTypedArray("float32",this.pv.length));for(var s=e.lastIndex,a=s,o=this.keyframes.length-1,l=!0,u,c,d;l;){if(u=this.keyframes[a],c=this.keyframes[a+1],a===o-1&&t>=c.t-r){u.h&&(u=c),s=0;break}if(c.t-r>t){s=a;break}a<o-1?a+=1:(s=0,l=!1)}d=this.keyframesMetadata[a]||{};var p,m,y,b,E,T,S=c.t-r,P=u.t-r,A;if(u.to){d.bezierData||(d.bezierData=bez.buildBezierData(u.s,c.s||u.e,u.to,u.ti));var I=d.bezierData;if(t>=S||t<P){var j=t>=S?I.points.length-1:0;for(m=I.points[j].point.length,p=0;p<m;p+=1)n[p]=I.points[j].point[p]}else{d.__fnct?T=d.__fnct:(T=BezierFactory.getBezierEasing(u.o.x,u.o.y,u.i.x,u.i.y,u.n).get,d.__fnct=T),y=T((t-P)/(S-P));var K=I.segmentLength*y,W,H=e.lastFrame<t&&e._lastKeyframeIndex===a?e._lastAddedLength:0;for(E=e.lastFrame<t&&e._lastKeyframeIndex===a?e._lastPoint:0,l=!0,b=I.points.length;l;){if(H+=I.points[E].partialLength,K===0||y===0||E===I.points.length-1){for(m=I.points[E].point.length,p=0;p<m;p+=1)n[p]=I.points[E].point[p];break}else if(K>=H&&K<H+I.points[E+1].partialLength){for(W=(K-H)/I.points[E+1].partialLength,m=I.points[E].point.length,p=0;p<m;p+=1)n[p]=I.points[E].point[p]+(I.points[E+1].point[p]-I.points[E].point[p])*W;break}E<b-1?E+=1:l=!1}e._lastPoint=E,e._lastAddedLength=H-I.points[E].partialLength,e._lastKeyframeIndex=a}}else{var ee,ue,de,fe,ae;if(o=u.s.length,A=c.s||u.e,this.sh&&u.h!==1)if(t>=S)n[0]=A[0],n[1]=A[1],n[2]=A[2];else if(t<=P)n[0]=u.s[0],n[1]=u.s[1],n[2]=u.s[2];else{var ce=createQuaternion(u.s),me=createQuaternion(A),te=(t-P)/(S-P);quaternionToEuler(n,slerp(ce,me,te))}else for(a=0;a<o;a+=1)u.h!==1&&(t>=S?y=1:t<P?y=0:(u.o.x.constructor===Array?(d.__fnct||(d.__fnct=[]),d.__fnct[a]?T=d.__fnct[a]:(ee=u.o.x[a]===void 0?u.o.x[0]:u.o.x[a],ue=u.o.y[a]===void 0?u.o.y[0]:u.o.y[a],de=u.i.x[a]===void 0?u.i.x[0]:u.i.x[a],fe=u.i.y[a]===void 0?u.i.y[0]:u.i.y[a],T=BezierFactory.getBezierEasing(ee,ue,de,fe).get,d.__fnct[a]=T)):d.__fnct?T=d.__fnct:(ee=u.o.x,ue=u.o.y,de=u.i.x,fe=u.i.y,T=BezierFactory.getBezierEasing(ee,ue,de,fe).get,u.keyframeMetadata=T),y=T((t-P)/(S-P)))),A=c.s||u.e,ae=u.h===1?u.s[a]:u.s[a]+(A[a]-u.s[a])*y,this.propType==="multidimensional"?n[a]=ae:n=ae}return e.lastIndex=s,n}function slerp(t,e,r){var n=[],s=t[0],a=t[1],o=t[2],l=t[3],u=e[0],c=e[1],d=e[2],p=e[3],m,y,b,E,T;return y=s*u+a*c+o*d+l*p,y<0&&(y=-y,u=-u,c=-c,d=-d,p=-p),1-y>1e-6?(m=Math.acos(y),b=Math.sin(m),E=Math.sin((1-r)*m)/b,T=Math.sin(r*m)/b):(E=1-r,T=r),n[0]=E*s+T*u,n[1]=E*a+T*c,n[2]=E*o+T*d,n[3]=E*l+T*p,n}function quaternionToEuler(t,e){var r=e[0],n=e[1],s=e[2],a=e[3],o=Math.atan2(2*n*a-2*r*s,1-2*n*n-2*s*s),l=Math.asin(2*r*n+2*s*a),u=Math.atan2(2*r*a-2*n*s,1-2*r*r-2*s*s);t[0]=o/degToRads,t[1]=l/degToRads,t[2]=u/degToRads}function createQuaternion(t){var e=t[0]*degToRads,r=t[1]*degToRads,n=t[2]*degToRads,s=Math.cos(e/2),a=Math.cos(r/2),o=Math.cos(n/2),l=Math.sin(e/2),u=Math.sin(r/2),c=Math.sin(n/2),d=s*a*o-l*u*c,p=l*u*o+s*a*c,m=l*a*o+s*u*c,y=s*u*o-l*a*c;return[p,m,y,d]}function getValueAtCurrentTime(){var t=this.comp.renderedFrame-this.offsetTime,e=this.keyframes[0].t-this.offsetTime,r=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(t===this._caching.lastFrame||this._caching.lastFrame!==initFrame&&(this._caching.lastFrame>=r&&t>=r||this._caching.lastFrame<e&&t<e))){this._caching.lastFrame>=t&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var n=this.interpolateValue(t,this._caching);this.pv=n}return this._caching.lastFrame=t,this.pv}function setVValue(t){var e;if(this.propType==="unidimensional")e=t*this.mult,mathAbs(this.v-e)>1e-5&&(this.v=e,this._mdf=!0);else for(var r=0,n=this.v.length;r<n;)e=t[r]*this.mult,mathAbs(this.v[r]-e)>1e-5&&(this.v[r]=e,this._mdf=!0),r+=1}function processEffectsSequence(){if(!(this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)){if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=this._isFirstFrame;var t,e=this.effectsSequence.length,r=this.kf?this.pv:this.data.k;for(t=0;t<e;t+=1)r=this.effectsSequence[t](r);this.setVValue(r),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function addEffect(t){this.effectsSequence.push(t),this.container.addDynamicProperty(this)}function ValueProperty(t,e,r,n){this.propType="unidimensional",this.mult=r||1,this.data=e,this.v=r?e.k*r:e.k,this.pv=e.k,this._mdf=!1,this.elem=t,this.container=n,this.comp=t.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function MultiDimensionalProperty(t,e,r,n){this.propType="multidimensional",this.mult=r||1,this.data=e,this._mdf=!1,this.elem=t,this.container=n,this.comp=t.comp,this.k=!1,this.kf=!1,this.frameId=-1;var s,a=e.k.length;for(this.v=createTypedArray("float32",a),this.pv=createTypedArray("float32",a),this.vel=createTypedArray("float32",a),s=0;s<a;s+=1)this.v[s]=e.k[s]*this.mult,this.pv[s]=e.k[s];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function KeyframedValueProperty(t,e,r,n){this.propType="unidimensional",this.keyframes=e.k,this.keyframesMetadata=[],this.offsetTime=t.data.st,this.frameId=-1,this._caching={lastFrame:initFrame,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=e,this.mult=r||1,this.elem=t,this.container=n,this.comp=t.comp,this.v=initFrame,this.pv=initFrame,this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.addEffect=addEffect}function KeyframedMultidimensionalProperty(t,e,r,n){this.propType="multidimensional";var s,a=e.k.length,o,l,u,c;for(s=0;s<a-1;s+=1)e.k[s].to&&e.k[s].s&&e.k[s+1]&&e.k[s+1].s&&(o=e.k[s].s,l=e.k[s+1].s,u=e.k[s].to,c=e.k[s].ti,(o.length===2&&!(o[0]===l[0]&&o[1]===l[1])&&bez.pointOnLine2D(o[0],o[1],l[0],l[1],o[0]+u[0],o[1]+u[1])&&bez.pointOnLine2D(o[0],o[1],l[0],l[1],l[0]+c[0],l[1]+c[1])||o.length===3&&!(o[0]===l[0]&&o[1]===l[1]&&o[2]===l[2])&&bez.pointOnLine3D(o[0],o[1],o[2],l[0],l[1],l[2],o[0]+u[0],o[1]+u[1],o[2]+u[2])&&bez.pointOnLine3D(o[0],o[1],o[2],l[0],l[1],l[2],l[0]+c[0],l[1]+c[1],l[2]+c[2]))&&(e.k[s].to=null,e.k[s].ti=null),o[0]===l[0]&&o[1]===l[1]&&u[0]===0&&u[1]===0&&c[0]===0&&c[1]===0&&(o.length===2||o[2]===l[2]&&u[2]===0&&c[2]===0)&&(e.k[s].to=null,e.k[s].ti=null));this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.data=e,this.keyframes=e.k,this.keyframesMetadata=[],this.offsetTime=t.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=r||1,this.elem=t,this.container=n,this.comp=t.comp,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.frameId=-1;var d=e.k[0].s.length;for(this.v=createTypedArray("float32",d),this.pv=createTypedArray("float32",d),s=0;s<d;s+=1)this.v[s]=initFrame,this.pv[s]=initFrame;this._caching={lastFrame:initFrame,lastIndex:0,value:createTypedArray("float32",d)},this.addEffect=addEffect}var PropertyFactory=function(){function t(r,n,s,a,o){n.sid&&(n=r.globalData.slotManager.getProp(n));var l;if(!n.k.length)l=new ValueProperty(r,n,a,o);else if(typeof n.k[0]=="number")l=new MultiDimensionalProperty(r,n,a,o);else switch(s){case 0:l=new KeyframedValueProperty(r,n,a,o);break;case 1:l=new KeyframedMultidimensionalProperty(r,n,a,o);break}return l.effectsSequence.length&&o.addDynamicProperty(l),l}var e={getProp:t};return e}();function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(e){this.dynamicProperties.indexOf(e)===-1&&(this.dynamicProperties.push(e),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){this._mdf=!1;var e,r=this.dynamicProperties.length;for(e=0;e<r;e+=1)this.dynamicProperties[e].getValue(),this.dynamicProperties[e]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(e){this.container=e,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var pointPool=function(){function t(){return createTypedArray("float32",2)}return poolFactory(8,t)}();function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(t,e){this.c=t,this.setLength(e);for(var r=0;r<e;)this.v[r]=pointPool.newElement(),this.o[r]=pointPool.newElement(),this.i[r]=pointPool.newElement(),r+=1},ShapePath.prototype.setLength=function(t){for(;this._maxLength<t;)this.doubleArrayLength();this._length=t},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(t,e,r,n,s){var a;switch(this._length=Math.max(this._length,n+1),this._length>=this._maxLength&&this.doubleArrayLength(),r){case"v":a=this.v;break;case"i":a=this.i;break;case"o":a=this.o;break;default:a=[];break}(!a[n]||a[n]&&!s)&&(a[n]=pointPool.newElement()),a[n][0]=t,a[n][1]=e},ShapePath.prototype.setTripleAt=function(t,e,r,n,s,a,o,l){this.setXYAt(t,e,"v",o,l),this.setXYAt(r,n,"o",o,l),this.setXYAt(s,a,"i",o,l)},ShapePath.prototype.reverse=function(){var t=new ShapePath;t.setPathData(this.c,this._length);var e=this.v,r=this.o,n=this.i,s=0;this.c&&(t.setTripleAt(e[0][0],e[0][1],n[0][0],n[0][1],r[0][0],r[0][1],0,!1),s=1);var a=this._length-1,o=this._length,l;for(l=s;l<o;l+=1)t.setTripleAt(e[a][0],e[a][1],n[a][0],n[a][1],r[a][0],r[a][1],l,!1),a-=1;return t},ShapePath.prototype.length=function(){return this._length};var shapePool=function(){function t(){return new ShapePath}function e(s){var a=s._length,o;for(o=0;o<a;o+=1)pointPool.release(s.v[o]),pointPool.release(s.i[o]),pointPool.release(s.o[o]),s.v[o]=null,s.i[o]=null,s.o[o]=null;s._length=0,s.c=!1}function r(s){var a=n.newElement(),o,l=s._length===void 0?s.v.length:s._length;for(a.setLength(l),a.c=s.c,o=0;o<l;o+=1)a.setTripleAt(s.v[o][0],s.v[o][1],s.o[o][0],s.o[o][1],s.i[o][0],s.i[o][1],o);return a}var n=poolFactory(4,t,e);return n.clone=r,n}();function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}ShapeCollection.prototype.addShape=function(t){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=t,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){var t;for(t=0;t<this._length;t+=1)shapePool.release(this.shapes[t]);this._length=0};var shapeCollectionPool=function(){var t={newShapeCollection:s,release:a},e=0,r=4,n=createSizedArray(r);function s(){var o;return e?(e-=1,o=n[e]):o=new ShapeCollection,o}function a(o){var l,u=o._length;for(l=0;l<u;l+=1)shapePool.release(o.shapes[l]);o._length=0,e===r&&(n=pooling.double(n),r*=2),n[e]=o,e+=1}return t}(),ShapePropertyFactory=function(){var t=-999999;function e(S,P,A){var I=A.lastIndex,j,K,W,H,ee,ue,de,fe,ae,ce=this.keyframes;if(S<ce[0].t-this.offsetTime)j=ce[0].s[0],W=!0,I=0;else if(S>=ce[ce.length-1].t-this.offsetTime)j=ce[ce.length-1].s?ce[ce.length-1].s[0]:ce[ce.length-2].e[0],W=!0;else{for(var me=I,te=ce.length-1,le=!0,Z,Y,he;le&&(Z=ce[me],Y=ce[me+1],!(Y.t-this.offsetTime>S));)me<te-1?me+=1:le=!1;if(he=this.keyframesMetadata[me]||{},W=Z.h===1,I=me,!W){if(S>=Y.t-this.offsetTime)fe=1;else if(S<Z.t-this.offsetTime)fe=0;else{var oe;he.__fnct?oe=he.__fnct:(oe=BezierFactory.getBezierEasing(Z.o.x,Z.o.y,Z.i.x,Z.i.y).get,he.__fnct=oe),fe=oe((S-(Z.t-this.offsetTime))/(Y.t-this.offsetTime-(Z.t-this.offsetTime)))}K=Y.s?Y.s[0]:Z.e[0]}j=Z.s[0]}for(ue=P._length,de=j.i[0].length,A.lastIndex=I,H=0;H<ue;H+=1)for(ee=0;ee<de;ee+=1)ae=W?j.i[H][ee]:j.i[H][ee]+(K.i[H][ee]-j.i[H][ee])*fe,P.i[H][ee]=ae,ae=W?j.o[H][ee]:j.o[H][ee]+(K.o[H][ee]-j.o[H][ee])*fe,P.o[H][ee]=ae,ae=W?j.v[H][ee]:j.v[H][ee]+(K.v[H][ee]-j.v[H][ee])*fe,P.v[H][ee]=ae}function r(){var S=this.comp.renderedFrame-this.offsetTime,P=this.keyframes[0].t-this.offsetTime,A=this.keyframes[this.keyframes.length-1].t-this.offsetTime,I=this._caching.lastFrame;return I!==t&&(I<P&&S<P||I>A&&S>A)||(this._caching.lastIndex=I<S?this._caching.lastIndex:0,this.interpolateShape(S,this.pv,this._caching)),this._caching.lastFrame=S,this.pv}function n(){this.paths=this.localShapeCollection}function s(S,P){if(S._length!==P._length||S.c!==P.c)return!1;var A,I=S._length;for(A=0;A<I;A+=1)if(S.v[A][0]!==P.v[A][0]||S.v[A][1]!==P.v[A][1]||S.o[A][0]!==P.o[A][0]||S.o[A][1]!==P.o[A][1]||S.i[A][0]!==P.i[A][0]||S.i[A][1]!==P.i[A][1])return!1;return!0}function a(S){s(this.v,S)||(this.v=shapePool.clone(S),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function o(){if(this.elem.globalData.frameId!==this.frameId){if(!this.effectsSequence.length){this._mdf=!1;return}if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=!1;var S;this.kf?S=this.pv:this.data.ks?S=this.data.ks.k:S=this.data.pt.k;var P,A=this.effectsSequence.length;for(P=0;P<A;P+=1)S=this.effectsSequence[P](S);this.setVValue(S),this.lock=!1,this.frameId=this.elem.globalData.frameId}}function l(S,P,A){this.propType="shape",this.comp=S.comp,this.container=S,this.elem=S,this.data=P,this.k=!1,this.kf=!1,this._mdf=!1;var I=A===3?P.pt.k:P.ks.k;this.v=shapePool.clone(I),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=n,this.effectsSequence=[]}function u(S){this.effectsSequence.push(S),this.container.addDynamicProperty(this)}l.prototype.interpolateShape=e,l.prototype.getValue=o,l.prototype.setVValue=a,l.prototype.addEffect=u;function c(S,P,A){this.propType="shape",this.comp=S.comp,this.elem=S,this.container=S,this.offsetTime=S.data.st,this.keyframes=A===3?P.pt.k:P.ks.k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;var I=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,I),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=t,this.reset=n,this._caching={lastFrame:t,lastIndex:0},this.effectsSequence=[r.bind(this)]}c.prototype.getValue=o,c.prototype.interpolateShape=e,c.prototype.setVValue=a,c.prototype.addEffect=u;var d=function(){var S=roundCorner;function P(A,I){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=I.d,this.elem=A,this.comp=A.comp,this.frameId=-1,this.initDynamicPropertyContainer(A),this.p=PropertyFactory.getProp(A,I.p,1,0,this),this.s=PropertyFactory.getProp(A,I.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return P.prototype={reset:n,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var I=this.p.v[0],j=this.p.v[1],K=this.s.v[0]/2,W=this.s.v[1]/2,H=this.d!==3,ee=this.v;ee.v[0][0]=I,ee.v[0][1]=j-W,ee.v[1][0]=H?I+K:I-K,ee.v[1][1]=j,ee.v[2][0]=I,ee.v[2][1]=j+W,ee.v[3][0]=H?I-K:I+K,ee.v[3][1]=j,ee.i[0][0]=H?I-K*S:I+K*S,ee.i[0][1]=j-W,ee.i[1][0]=H?I+K:I-K,ee.i[1][1]=j-W*S,ee.i[2][0]=H?I+K*S:I-K*S,ee.i[2][1]=j+W,ee.i[3][0]=H?I-K:I+K,ee.i[3][1]=j+W*S,ee.o[0][0]=H?I+K*S:I-K*S,ee.o[0][1]=j-W,ee.o[1][0]=H?I+K:I-K,ee.o[1][1]=j+W*S,ee.o[2][0]=H?I-K*S:I+K*S,ee.o[2][1]=j+W,ee.o[3][0]=H?I-K:I+K,ee.o[3][1]=j-W*S}},extendPrototype([DynamicPropertyContainer],P),P}(),p=function(){function S(P,A){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=P,this.comp=P.comp,this.data=A,this.frameId=-1,this.d=A.d,this.initDynamicPropertyContainer(P),A.sy===1?(this.ir=PropertyFactory.getProp(P,A.ir,0,0,this),this.is=PropertyFactory.getProp(P,A.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(P,A.pt,0,0,this),this.p=PropertyFactory.getProp(P,A.p,1,0,this),this.r=PropertyFactory.getProp(P,A.r,0,degToRads,this),this.or=PropertyFactory.getProp(P,A.or,0,0,this),this.os=PropertyFactory.getProp(P,A.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return S.prototype={reset:n,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var A=Math.floor(this.pt.v)*2,I=Math.PI*2/A,j=!0,K=this.or.v,W=this.ir.v,H=this.os.v,ee=this.is.v,ue=2*Math.PI*K/(A*2),de=2*Math.PI*W/(A*2),fe,ae,ce,me,te=-Math.PI/2;te+=this.r.v;var le=this.data.d===3?-1:1;for(this.v._length=0,fe=0;fe<A;fe+=1){ae=j?K:W,ce=j?H:ee,me=j?ue:de;var Z=ae*Math.cos(te),Y=ae*Math.sin(te),he=Z===0&&Y===0?0:Y/Math.sqrt(Z*Z+Y*Y),oe=Z===0&&Y===0?0:-Z/Math.sqrt(Z*Z+Y*Y);Z+=+this.p.v[0],Y+=+this.p.v[1],this.v.setTripleAt(Z,Y,Z-he*me*ce*le,Y-oe*me*ce*le,Z+he*me*ce*le,Y+oe*me*ce*le,fe,!0),j=!j,te+=I*le}},convertPolygonToPath:function(){var A=Math.floor(this.pt.v),I=Math.PI*2/A,j=this.or.v,K=this.os.v,W=2*Math.PI*j/(A*4),H,ee=-Math.PI*.5,ue=this.data.d===3?-1:1;for(ee+=this.r.v,this.v._length=0,H=0;H<A;H+=1){var de=j*Math.cos(ee),fe=j*Math.sin(ee),ae=de===0&&fe===0?0:fe/Math.sqrt(de*de+fe*fe),ce=de===0&&fe===0?0:-de/Math.sqrt(de*de+fe*fe);de+=+this.p.v[0],fe+=+this.p.v[1],this.v.setTripleAt(de,fe,de-ae*W*K*ue,fe-ce*W*K*ue,de+ae*W*K*ue,fe+ce*W*K*ue,H,!0),ee+=I*ue}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],S),S}(),m=function(){function S(P,A){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=P,this.comp=P.comp,this.frameId=-1,this.d=A.d,this.initDynamicPropertyContainer(P),this.p=PropertyFactory.getProp(P,A.p,1,0,this),this.s=PropertyFactory.getProp(P,A.s,1,0,this),this.r=PropertyFactory.getProp(P,A.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return S.prototype={convertRectToPath:function(){var A=this.p.v[0],I=this.p.v[1],j=this.s.v[0]/2,K=this.s.v[1]/2,W=bmMin(j,K,this.r.v),H=W*(1-roundCorner);this.v._length=0,this.d===2||this.d===1?(this.v.setTripleAt(A+j,I-K+W,A+j,I-K+W,A+j,I-K+H,0,!0),this.v.setTripleAt(A+j,I+K-W,A+j,I+K-H,A+j,I+K-W,1,!0),W!==0?(this.v.setTripleAt(A+j-W,I+K,A+j-W,I+K,A+j-H,I+K,2,!0),this.v.setTripleAt(A-j+W,I+K,A-j+H,I+K,A-j+W,I+K,3,!0),this.v.setTripleAt(A-j,I+K-W,A-j,I+K-W,A-j,I+K-H,4,!0),this.v.setTripleAt(A-j,I-K+W,A-j,I-K+H,A-j,I-K+W,5,!0),this.v.setTripleAt(A-j+W,I-K,A-j+W,I-K,A-j+H,I-K,6,!0),this.v.setTripleAt(A+j-W,I-K,A+j-H,I-K,A+j-W,I-K,7,!0)):(this.v.setTripleAt(A-j,I+K,A-j+H,I+K,A-j,I+K,2),this.v.setTripleAt(A-j,I-K,A-j,I-K+H,A-j,I-K,3))):(this.v.setTripleAt(A+j,I-K+W,A+j,I-K+H,A+j,I-K+W,0,!0),W!==0?(this.v.setTripleAt(A+j-W,I-K,A+j-W,I-K,A+j-H,I-K,1,!0),this.v.setTripleAt(A-j+W,I-K,A-j+H,I-K,A-j+W,I-K,2,!0),this.v.setTripleAt(A-j,I-K+W,A-j,I-K+W,A-j,I-K+H,3,!0),this.v.setTripleAt(A-j,I+K-W,A-j,I+K-H,A-j,I+K-W,4,!0),this.v.setTripleAt(A-j+W,I+K,A-j+W,I+K,A-j+H,I+K,5,!0),this.v.setTripleAt(A+j-W,I+K,A+j-H,I+K,A+j-W,I+K,6,!0),this.v.setTripleAt(A+j,I+K-W,A+j,I+K-W,A+j,I+K-H,7,!0)):(this.v.setTripleAt(A-j,I-K,A-j+H,I-K,A-j,I-K,1,!0),this.v.setTripleAt(A-j,I+K,A-j,I+K-H,A-j,I+K,2,!0),this.v.setTripleAt(A+j,I+K,A+j-H,I+K,A+j,I+K,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:n},extendPrototype([DynamicPropertyContainer],S),S}();function y(S,P,A){var I;if(A===3||A===4){var j=A===3?P.pt:P.ks,K=j.k;K.length?I=new c(S,P,A):I=new l(S,P,A)}else A===5?I=new m(S,P):A===6?I=new d(S,P):A===7&&(I=new p(S,P));return I.k&&S.addDynamicProperty(I),I}function b(){return l}function E(){return c}var T={};return T.getShapeProp=y,T.getConstructorFunction=b,T.getKeyframedConstructorFunction=E,T}();/*!
 Transformation Matrix v2.0
 (c) Epistemex 2014-2015
 www.epistemex.com
 By Ken Fyrstenberg
 Contributions by leeoniya.
 License: MIT, header required.
 */var Matrix=function(){var t=Math.cos,e=Math.sin,r=Math.tan,n=Math.round;function s(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function a(Z){if(Z===0)return this;var Y=t(Z),he=e(Z);return this._t(Y,-he,0,0,he,Y,0,0,0,0,1,0,0,0,0,1)}function o(Z){if(Z===0)return this;var Y=t(Z),he=e(Z);return this._t(1,0,0,0,0,Y,-he,0,0,he,Y,0,0,0,0,1)}function l(Z){if(Z===0)return this;var Y=t(Z),he=e(Z);return this._t(Y,0,he,0,0,1,0,0,-he,0,Y,0,0,0,0,1)}function u(Z){if(Z===0)return this;var Y=t(Z),he=e(Z);return this._t(Y,-he,0,0,he,Y,0,0,0,0,1,0,0,0,0,1)}function c(Z,Y){return this._t(1,Y,Z,1,0,0)}function d(Z,Y){return this.shear(r(Z),r(Y))}function p(Z,Y){var he=t(Y),oe=e(Y);return this._t(he,oe,0,0,-oe,he,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,r(Z),1,0,0,0,0,1,0,0,0,0,1)._t(he,-oe,0,0,oe,he,0,0,0,0,1,0,0,0,0,1)}function m(Z,Y,he){return!he&&he!==0&&(he=1),Z===1&&Y===1&&he===1?this:this._t(Z,0,0,0,0,Y,0,0,0,0,he,0,0,0,0,1)}function y(Z,Y,he,oe,ye,Ee,Ae,je,Te,Ve,Pe,Ce,De,ze,Et,Ze){return this.props[0]=Z,this.props[1]=Y,this.props[2]=he,this.props[3]=oe,this.props[4]=ye,this.props[5]=Ee,this.props[6]=Ae,this.props[7]=je,this.props[8]=Te,this.props[9]=Ve,this.props[10]=Pe,this.props[11]=Ce,this.props[12]=De,this.props[13]=ze,this.props[14]=Et,this.props[15]=Ze,this}function b(Z,Y,he){return he=he||0,Z!==0||Y!==0||he!==0?this._t(1,0,0,0,0,1,0,0,0,0,1,0,Z,Y,he,1):this}function E(Z,Y,he,oe,ye,Ee,Ae,je,Te,Ve,Pe,Ce,De,ze,Et,Ze){var Ue=this.props;if(Z===1&&Y===0&&he===0&&oe===0&&ye===0&&Ee===1&&Ae===0&&je===0&&Te===0&&Ve===0&&Pe===1&&Ce===0)return Ue[12]=Ue[12]*Z+Ue[15]*De,Ue[13]=Ue[13]*Ee+Ue[15]*ze,Ue[14]=Ue[14]*Pe+Ue[15]*Et,Ue[15]*=Ze,this._identityCalculated=!1,this;var qt=Ue[0],or=Ue[1],Lt=Ue[2],rt=Ue[3],lr=Ue[4],ir=Ue[5],er=Ue[6],xr=Ue[7],br=Ue[8],Pr=Ue[9],zr=Ue[10],pr=Ue[11],dr=Ue[12],Ar=Ue[13],_r=Ue[14],It=Ue[15];return Ue[0]=qt*Z+or*ye+Lt*Te+rt*De,Ue[1]=qt*Y+or*Ee+Lt*Ve+rt*ze,Ue[2]=qt*he+or*Ae+Lt*Pe+rt*Et,Ue[3]=qt*oe+or*je+Lt*Ce+rt*Ze,Ue[4]=lr*Z+ir*ye+er*Te+xr*De,Ue[5]=lr*Y+ir*Ee+er*Ve+xr*ze,Ue[6]=lr*he+ir*Ae+er*Pe+xr*Et,Ue[7]=lr*oe+ir*je+er*Ce+xr*Ze,Ue[8]=br*Z+Pr*ye+zr*Te+pr*De,Ue[9]=br*Y+Pr*Ee+zr*Ve+pr*ze,Ue[10]=br*he+Pr*Ae+zr*Pe+pr*Et,Ue[11]=br*oe+Pr*je+zr*Ce+pr*Ze,Ue[12]=dr*Z+Ar*ye+_r*Te+It*De,Ue[13]=dr*Y+Ar*Ee+_r*Ve+It*ze,Ue[14]=dr*he+Ar*Ae+_r*Pe+It*Et,Ue[15]=dr*oe+Ar*je+_r*Ce+It*Ze,this._identityCalculated=!1,this}function T(Z){var Y=Z.props;return this.transform(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5],Y[6],Y[7],Y[8],Y[9],Y[10],Y[11],Y[12],Y[13],Y[14],Y[15])}function S(){return this._identityCalculated||(this._identity=!(this.props[0]!==1||this.props[1]!==0||this.props[2]!==0||this.props[3]!==0||this.props[4]!==0||this.props[5]!==1||this.props[6]!==0||this.props[7]!==0||this.props[8]!==0||this.props[9]!==0||this.props[10]!==1||this.props[11]!==0||this.props[12]!==0||this.props[13]!==0||this.props[14]!==0||this.props[15]!==1),this._identityCalculated=!0),this._identity}function P(Z){for(var Y=0;Y<16;){if(Z.props[Y]!==this.props[Y])return!1;Y+=1}return!0}function A(Z){var Y;for(Y=0;Y<16;Y+=1)Z.props[Y]=this.props[Y];return Z}function I(Z){var Y;for(Y=0;Y<16;Y+=1)this.props[Y]=Z[Y]}function j(Z,Y,he){return{x:Z*this.props[0]+Y*this.props[4]+he*this.props[8]+this.props[12],y:Z*this.props[1]+Y*this.props[5]+he*this.props[9]+this.props[13],z:Z*this.props[2]+Y*this.props[6]+he*this.props[10]+this.props[14]}}function K(Z,Y,he){return Z*this.props[0]+Y*this.props[4]+he*this.props[8]+this.props[12]}function W(Z,Y,he){return Z*this.props[1]+Y*this.props[5]+he*this.props[9]+this.props[13]}function H(Z,Y,he){return Z*this.props[2]+Y*this.props[6]+he*this.props[10]+this.props[14]}function ee(){var Z=this.props[0]*this.props[5]-this.props[1]*this.props[4],Y=this.props[5]/Z,he=-this.props[1]/Z,oe=-this.props[4]/Z,ye=this.props[0]/Z,Ee=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/Z,Ae=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/Z,je=new Matrix;return je.props[0]=Y,je.props[1]=he,je.props[4]=oe,je.props[5]=ye,je.props[12]=Ee,je.props[13]=Ae,je}function ue(Z){var Y=this.getInverseMatrix();return Y.applyToPointArray(Z[0],Z[1],Z[2]||0)}function de(Z){var Y,he=Z.length,oe=[];for(Y=0;Y<he;Y+=1)oe[Y]=ue(Z[Y]);return oe}function fe(Z,Y,he){var oe=createTypedArray("float32",6);if(this.isIdentity())oe[0]=Z[0],oe[1]=Z[1],oe[2]=Y[0],oe[3]=Y[1],oe[4]=he[0],oe[5]=he[1];else{var ye=this.props[0],Ee=this.props[1],Ae=this.props[4],je=this.props[5],Te=this.props[12],Ve=this.props[13];oe[0]=Z[0]*ye+Z[1]*Ae+Te,oe[1]=Z[0]*Ee+Z[1]*je+Ve,oe[2]=Y[0]*ye+Y[1]*Ae+Te,oe[3]=Y[0]*Ee+Y[1]*je+Ve,oe[4]=he[0]*ye+he[1]*Ae+Te,oe[5]=he[0]*Ee+he[1]*je+Ve}return oe}function ae(Z,Y,he){var oe;return this.isIdentity()?oe=[Z,Y,he]:oe=[Z*this.props[0]+Y*this.props[4]+he*this.props[8]+this.props[12],Z*this.props[1]+Y*this.props[5]+he*this.props[9]+this.props[13],Z*this.props[2]+Y*this.props[6]+he*this.props[10]+this.props[14]],oe}function ce(Z,Y){if(this.isIdentity())return Z+","+Y;var he=this.props;return Math.round((Z*he[0]+Y*he[4]+he[12])*100)/100+","+Math.round((Z*he[1]+Y*he[5]+he[13])*100)/100}function me(){for(var Z=0,Y=this.props,he="matrix3d(",oe=1e4;Z<16;)he+=n(Y[Z]*oe)/oe,he+=Z===15?")":",",Z+=1;return he}function te(Z){var Y=1e4;return Z<1e-6&&Z>0||Z>-1e-6&&Z<0?n(Z*Y)/Y:Z}function le(){var Z=this.props,Y=te(Z[0]),he=te(Z[1]),oe=te(Z[4]),ye=te(Z[5]),Ee=te(Z[12]),Ae=te(Z[13]);return"matrix("+Y+","+he+","+oe+","+ye+","+Ee+","+Ae+")"}return function(){this.reset=s,this.rotate=a,this.rotateX=o,this.rotateY=l,this.rotateZ=u,this.skew=d,this.skewFromAxis=p,this.shear=c,this.scale=m,this.setTransform=y,this.translate=b,this.transform=E,this.multiply=T,this.applyToPoint=j,this.applyToX=K,this.applyToY=W,this.applyToZ=H,this.applyToPointArray=ae,this.applyToTriplePoints=fe,this.applyToPointStringified=ce,this.toCSS=me,this.to2dCSS=le,this.clone=A,this.cloneFromProps=I,this.equals=P,this.inversePoints=de,this.inversePoint=ue,this.getInverseMatrix=ee,this._t=this.transform,this.isIdentity=S,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}}();function _typeof$3(t){"@babel/helpers - typeof";return _typeof$3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$3(t)}var lottie={};function setLocation(t){setLocationHref(t)}function searchAnimations(){animationManager.searchAnimations()}function setSubframeRendering(t){setSubframeEnabled(t)}function setPrefix(t){setIdPrefix(t)}function loadAnimation(t){return animationManager.loadAnimation(t)}function setQuality(t){if(typeof t=="string")switch(t){case"high":setDefaultCurveSegments(200);break;default:case"medium":setDefaultCurveSegments(50);break;case"low":setDefaultCurveSegments(10);break}else!isNaN(t)&&t>1&&setDefaultCurveSegments(t)}function inBrowser(){return typeof navigator<"u"}function installPlugin(t,e){t==="expressions"&&setExpressionsPlugin(e)}function getFactory(t){switch(t){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null}}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocation,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.useWebWorker=setWebWorker,lottie.setIDPrefix=setPrefix,lottie.__getFactory=getFactory,lottie.version="5.13.0";function checkReady(){document.readyState==="complete"&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(t){for(var e=queryString.split("&"),r=0;r<e.length;r+=1){var n=e[r].split("=");if(decodeURIComponent(n[0])==t)return decodeURIComponent(n[1])}return null}var queryString="";{var scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""};queryString=myScript.src?myScript.src.replace(/^[^\?]+\??/,""):"",getQueryVariable("renderer")}var readyStateCheckInterval=setInterval(checkReady,100);try{_typeof$3(exports)!=="object"&&(window.bodymovin=lottie)}catch(t){}var ShapeModifiers=function(){var t={},e={};t.registerModifier=r,t.getModifier=n;function r(s,a){e[s]||(e[s]=a)}function n(s,a,o){return new e[s](a,o)}return t}();function ShapeModifier(){}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(t){if(!this.closed){t.sh.container.addDynamicProperty(t.sh);var e={shape:t.sh,data:t,localShapeCollection:shapeCollectionPool.newShapeCollection()};this.shapes.push(e),this.addShapeToModifier(e),this._isAnimated&&t.setAsAnimated()}},ShapeModifier.prototype.init=function(t,e){this.shapes=[],this.elem=t,this.initDynamicPropertyContainer(t),this.initModifierProperties(t,e),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier);function TrimModifier(){}extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(t,e){this.s=PropertyFactory.getProp(t,e.s,0,.01,this),this.e=PropertyFactory.getProp(t,e.e,0,.01,this),this.o=PropertyFactory.getProp(t,e.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=e.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(t){t.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(t,e,r,n,s){var a=[];e<=1?a.push({s:t,e}):t>=1?a.push({s:t-1,e:e-1}):(a.push({s:t,e:1}),a.push({s:0,e:e-1}));var o=[],l,u=a.length,c;for(l=0;l<u;l+=1)if(c=a[l],!(c.e*s<n||c.s*s>n+r)){var d,p;c.s*s<=n?d=0:d=(c.s*s-n)/r,c.e*s>=n+r?p=1:p=(c.e*s-n)/r,o.push([d,p])}return o.length||o.push([0,0]),o},TrimModifier.prototype.releasePathsData=function(t){var e,r=t.length;for(e=0;e<r;e+=1)segmentsLengthPool.release(t[e]);return t.length=0,t},TrimModifier.prototype.processShapes=function(t){var e,r;if(this._mdf||t){var n=this.o.v%360/360;if(n<0&&(n+=1),this.s.v>1?e=1+n:this.s.v<0?e=0+n:e=this.s.v+n,this.e.v>1?r=1+n:this.e.v<0?r=0+n:r=this.e.v+n,e>r){var s=e;e=r,r=s}e=Math.round(e*1e4)*1e-4,r=Math.round(r*1e4)*1e-4,this.sValue=e,this.eValue=r}else e=this.sValue,r=this.eValue;var a,o,l=this.shapes.length,u,c,d,p,m,y=0;if(r===e)for(o=0;o<l;o+=1)this.shapes[o].localShapeCollection.releaseShapes(),this.shapes[o].shape._mdf=!0,this.shapes[o].shape.paths=this.shapes[o].localShapeCollection,this._mdf&&(this.shapes[o].pathsData.length=0);else if(r===1&&e===0||r===0&&e===1){if(this._mdf)for(o=0;o<l;o+=1)this.shapes[o].pathsData.length=0,this.shapes[o].shape._mdf=!0}else{var b=[],E,T;for(o=0;o<l;o+=1)if(E=this.shapes[o],!E.shape._mdf&&!this._mdf&&!t&&this.m!==2)E.shape.paths=E.localShapeCollection;else{if(a=E.shape.paths,c=a._length,m=0,!E.shape._mdf&&E.pathsData.length)m=E.totalShapeLength;else{for(d=this.releasePathsData(E.pathsData),u=0;u<c;u+=1)p=bez.getSegmentsLength(a.shapes[u]),d.push(p),m+=p.totalLength;E.totalShapeLength=m,E.pathsData=d}y+=m,E.shape._mdf=!0}var S=e,P=r,A=0,I;for(o=l-1;o>=0;o-=1)if(E=this.shapes[o],E.shape._mdf){for(T=E.localShapeCollection,T.releaseShapes(),this.m===2&&l>1?(I=this.calculateShapeEdges(e,r,E.totalShapeLength,A,y),A+=E.totalShapeLength):I=[[S,P]],c=I.length,u=0;u<c;u+=1){S=I[u][0],P=I[u][1],b.length=0,P<=1?b.push({s:E.totalShapeLength*S,e:E.totalShapeLength*P}):S>=1?b.push({s:E.totalShapeLength*(S-1),e:E.totalShapeLength*(P-1)}):(b.push({s:E.totalShapeLength*S,e:E.totalShapeLength}),b.push({s:0,e:E.totalShapeLength*(P-1)}));var j=this.addShapes(E,b[0]);if(b[0].s!==b[0].e){if(b.length>1){var K=E.shape.paths.shapes[E.shape.paths._length-1];if(K.c){var W=j.pop();this.addPaths(j,T),j=this.addShapes(E,b[1],W)}else this.addPaths(j,T),j=this.addShapes(E,b[1])}this.addPaths(j,T)}}E.shape.paths=T}}},TrimModifier.prototype.addPaths=function(t,e){var r,n=t.length;for(r=0;r<n;r+=1)e.addShape(t[r])},TrimModifier.prototype.addSegment=function(t,e,r,n,s,a,o){s.setXYAt(e[0],e[1],"o",a),s.setXYAt(r[0],r[1],"i",a+1),o&&s.setXYAt(t[0],t[1],"v",a),s.setXYAt(n[0],n[1],"v",a+1)},TrimModifier.prototype.addSegmentFromArray=function(t,e,r,n){e.setXYAt(t[1],t[5],"o",r),e.setXYAt(t[2],t[6],"i",r+1),n&&e.setXYAt(t[0],t[4],"v",r),e.setXYAt(t[3],t[7],"v",r+1)},TrimModifier.prototype.addShapes=function(t,e,r){var n=t.pathsData,s=t.shape.paths.shapes,a,o=t.shape.paths._length,l,u,c=0,d,p,m,y,b=[],E,T=!0;for(r?(p=r._length,E=r._length):(r=shapePool.newElement(),p=0,E=0),b.push(r),a=0;a<o;a+=1){for(m=n[a].lengths,r.c=s[a].c,u=s[a].c?m.length:m.length+1,l=1;l<u;l+=1)if(d=m[l-1],c+d.addedLength<e.s)c+=d.addedLength,r.c=!1;else if(c>e.e){r.c=!1;break}else e.s<=c&&e.e>=c+d.addedLength?(this.addSegment(s[a].v[l-1],s[a].o[l-1],s[a].i[l],s[a].v[l],r,p,T),T=!1):(y=bez.getNewSegment(s[a].v[l-1],s[a].v[l],s[a].o[l-1],s[a].i[l],(e.s-c)/d.addedLength,(e.e-c)/d.addedLength,m[l-1]),this.addSegmentFromArray(y,r,p,T),T=!1,r.c=!1),c+=d.addedLength,p+=1;if(s[a].c&&m.length){if(d=m[l-1],c<=e.e){var S=m[l-1].addedLength;e.s<=c&&e.e>=c+S?(this.addSegment(s[a].v[l-1],s[a].o[l-1],s[a].i[0],s[a].v[0],r,p,T),T=!1):(y=bez.getNewSegment(s[a].v[l-1],s[a].v[0],s[a].o[l-1],s[a].i[0],(e.s-c)/S,(e.e-c)/S,m[l-1]),this.addSegmentFromArray(y,r,p,T),T=!1,r.c=!1)}else r.c=!1;c+=d.addedLength,p+=1}if(r._length&&(r.setXYAt(r.v[E][0],r.v[E][1],"i",E),r.setXYAt(r.v[r._length-1][0],r.v[r._length-1][1],"o",r._length-1)),c>e.e)break;a<o-1&&(r=shapePool.newElement(),T=!0,b.push(r),p=0)}return b};function PuckerAndBloatModifier(){}extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(t,e.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},PuckerAndBloatModifier.prototype.processPath=function(t,e){var r=e/100,n=[0,0],s=t._length,a=0;for(a=0;a<s;a+=1)n[0]+=t.v[a][0],n[1]+=t.v[a][1];n[0]/=s,n[1]/=s;var o=shapePool.newElement();o.c=t.c;var l,u,c,d,p,m;for(a=0;a<s;a+=1)l=t.v[a][0]+(n[0]-t.v[a][0])*r,u=t.v[a][1]+(n[1]-t.v[a][1])*r,c=t.o[a][0]+(n[0]-t.o[a][0])*-r,d=t.o[a][1]+(n[1]-t.o[a][1])*-r,p=t.i[a][0]+(n[0]-t.i[a][0])*-r,m=t.i[a][1]+(n[1]-t.i[a][1])*-r,o.setTripleAt(l,u,c,d,p,m,a);return o},PuckerAndBloatModifier.prototype.processShapes=function(t){var e,r,n=this.shapes.length,s,a,o=this.amount.v;if(o!==0){var l,u;for(r=0;r<n;r+=1){if(l=this.shapes[r],u=l.localShapeCollection,!(!l.shape._mdf&&!this._mdf&&!t))for(u.releaseShapes(),l.shape._mdf=!0,e=l.shape.paths.shapes,a=l.shape.paths._length,s=0;s<a;s+=1)u.addShape(this.processPath(e[s],o));l.shape.paths=l.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};var TransformPropertyFactory=function(){var t=[0,0];function e(u){var c=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||c,this.a&&u.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&u.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&u.skewFromAxis(-this.sk.v,this.sa.v),this.r?u.rotate(-this.r.v):u.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?u.translate(this.px.v,this.py.v,-this.pz.v):u.translate(this.px.v,this.py.v,0):u.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}function r(u){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||u){var c;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var d,p;if(c=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(d=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/c,0),p=this.p.getValueAtTime(this.p.keyframes[0].t/c,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(d=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/c,0),p=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/c,0)):(d=this.p.pv,p=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/c,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){d=[],p=[];var m=this.px,y=this.py;m._caching.lastFrame+m.offsetTime<=m.keyframes[0].t?(d[0]=m.getValueAtTime((m.keyframes[0].t+.01)/c,0),d[1]=y.getValueAtTime((y.keyframes[0].t+.01)/c,0),p[0]=m.getValueAtTime(m.keyframes[0].t/c,0),p[1]=y.getValueAtTime(y.keyframes[0].t/c,0)):m._caching.lastFrame+m.offsetTime>=m.keyframes[m.keyframes.length-1].t?(d[0]=m.getValueAtTime(m.keyframes[m.keyframes.length-1].t/c,0),d[1]=y.getValueAtTime(y.keyframes[y.keyframes.length-1].t/c,0),p[0]=m.getValueAtTime((m.keyframes[m.keyframes.length-1].t-.01)/c,0),p[1]=y.getValueAtTime((y.keyframes[y.keyframes.length-1].t-.01)/c,0)):(d=[m.pv,y.pv],p[0]=m.getValueAtTime((m._caching.lastFrame+m.offsetTime-.01)/c,m.offsetTime),p[1]=y.getValueAtTime((y._caching.lastFrame+y.offsetTime-.01)/c,y.offsetTime))}else p=t,d=p;this.v.rotate(-Math.atan2(d[1]-p[1],d[0]-p[0]))}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}}function n(){if(this.appliedTransformations=0,this.pre.reset(),!this.a.effectsSequence.length)this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1;else return;if(!this.s.effectsSequence.length)this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2;else return;if(this.sk)if(!this.sk.effectsSequence.length&&!this.sa.effectsSequence.length)this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3;else return;this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):!this.rz.effectsSequence.length&&!this.ry.effectsSequence.length&&!this.rx.effectsSequence.length&&!this.or.effectsSequence.length&&(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}function s(){}function a(u){this._addDynamicProperty(u),this.elem.addDynamicProperty(u),this._isDirty=!0}function o(u,c,d){if(this.elem=u,this.frameId=-1,this.propType="transform",this.data=c,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(d||u),c.p&&c.p.s?(this.px=PropertyFactory.getProp(u,c.p.x,0,0,this),this.py=PropertyFactory.getProp(u,c.p.y,0,0,this),c.p.z&&(this.pz=PropertyFactory.getProp(u,c.p.z,0,0,this))):this.p=PropertyFactory.getProp(u,c.p||{k:[0,0,0]},1,0,this),c.rx){if(this.rx=PropertyFactory.getProp(u,c.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(u,c.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(u,c.rz,0,degToRads,this),c.or.k[0].ti){var p,m=c.or.k.length;for(p=0;p<m;p+=1)c.or.k[p].to=null,c.or.k[p].ti=null}this.or=PropertyFactory.getProp(u,c.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(u,c.r||{k:0},0,degToRads,this);c.sk&&(this.sk=PropertyFactory.getProp(u,c.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(u,c.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(u,c.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(u,c.s||{k:[100,100,100]},1,.01,this),c.o?this.o=PropertyFactory.getProp(u,c.o,0,.01,u):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}o.prototype={applyToMatrix:e,getValue:r,precalculateMatrix:n,autoOrient:s},extendPrototype([DynamicPropertyContainer],o),o.prototype.addDynamicProperty=a,o.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty;function l(u,c,d){return new o(u,c,d)}return{getTransformProperty:l}}();function RepeaterModifier(){}extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(t,e.c,0,null,this),this.o=PropertyFactory.getProp(t,e.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(t,e.tr,this),this.so=PropertyFactory.getProp(t,e.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(t,e.tr.eo,0,.01,this),this.data=e,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(t,e,r,n,s,a){var o=a?-1:1,l=n.s.v[0]+(1-n.s.v[0])*(1-s),u=n.s.v[1]+(1-n.s.v[1])*(1-s);t.translate(n.p.v[0]*o*s,n.p.v[1]*o*s,n.p.v[2]),e.translate(-n.a.v[0],-n.a.v[1],n.a.v[2]),e.rotate(-n.r.v*o*s),e.translate(n.a.v[0],n.a.v[1],n.a.v[2]),r.translate(-n.a.v[0],-n.a.v[1],n.a.v[2]),r.scale(a?1/l:l,a?1/u:u),r.translate(n.a.v[0],n.a.v[1],n.a.v[2])},RepeaterModifier.prototype.init=function(t,e,r,n){for(this.elem=t,this.arr=e,this.pos=r,this.elemsData=n,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(t),this.initModifierProperties(t,e[r]);r>0;)r-=1,this._elements.unshift(e[r]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(t){var e,r=t.length;for(e=0;e<r;e+=1)t[e]._processed=!1,t[e].ty==="gr"&&this.resetElements(t[e].it)},RepeaterModifier.prototype.cloneElements=function(t){var e=JSON.parse(JSON.stringify(t));return this.resetElements(e),e},RepeaterModifier.prototype.changeGroupRender=function(t,e){var r,n=t.length;for(r=0;r<n;r+=1)t[r]._render=e,t[r].ty==="gr"&&this.changeGroupRender(t[r].it,e)},RepeaterModifier.prototype.processShapes=function(t){var e,r,n,s,a,o=!1;if(this._mdf||t){var l=Math.ceil(this.c.v);if(this._groups.length<l){for(;this._groups.length<l;){var u={it:this.cloneElements(this._elements),ty:"gr"};u.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,u),this._groups.splice(0,0,u),this._currentCopies+=1}this.elem.reloadShapes(),o=!0}a=0;var c;for(n=0;n<=this._groups.length-1;n+=1){if(c=a<l,this._groups[n]._render=c,this.changeGroupRender(this._groups[n].it,c),!c){var d=this.elemsData[n].it,p=d[d.length-1];p.transform.op.v!==0?(p.transform.op._mdf=!0,p.transform.op.v=0):p.transform.op._mdf=!1}a+=1}this._currentCopies=l;var m=this.o.v,y=m%1,b=m>0?Math.floor(m):Math.ceil(m),E=this.pMatrix.props,T=this.rMatrix.props,S=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var P=0;if(m>0){for(;P<b;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),P+=1;y&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,y,!1),P+=y)}else if(m<0){for(;P>b;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),P-=1;y&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-y,!0),P-=y)}n=this.data.m===1?0:this._currentCopies-1,s=this.data.m===1?1:-1,a=this._currentCopies;for(var A,I;a;){if(e=this.elemsData[n].it,r=e[e.length-1].transform.mProps.v.props,I=r.length,e[e.length-1].transform.mProps._mdf=!0,e[e.length-1].transform.op._mdf=!0,e[e.length-1].transform.op.v=this._currentCopies===1?this.so.v:this.so.v+(this.eo.v-this.so.v)*(n/(this._currentCopies-1)),P!==0){for((n!==0&&s===1||n!==this._currentCopies-1&&s===-1)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(T[0],T[1],T[2],T[3],T[4],T[5],T[6],T[7],T[8],T[9],T[10],T[11],T[12],T[13],T[14],T[15]),this.matrix.transform(S[0],S[1],S[2],S[3],S[4],S[5],S[6],S[7],S[8],S[9],S[10],S[11],S[12],S[13],S[14],S[15]),this.matrix.transform(E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],E[8],E[9],E[10],E[11],E[12],E[13],E[14],E[15]),A=0;A<I;A+=1)r[A]=this.matrix.props[A];this.matrix.reset()}else for(this.matrix.reset(),A=0;A<I;A+=1)r[A]=this.matrix.props[A];P+=1,a-=1,n+=s}}else for(a=this._currentCopies,n=0,s=1;a;)e=this.elemsData[n].it,r=e[e.length-1].transform.mProps.v.props,e[e.length-1].transform.mProps._mdf=!1,e[e.length-1].transform.op._mdf=!1,a-=1,n+=s;return o},RepeaterModifier.prototype.addShape=function(){};function RoundCornersModifier(){}extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(t,e.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(t,e){var r=shapePool.newElement();r.c=t.c;var n,s=t._length,a,o,l,u,c,d,p=0,m,y,b,E,T,S;for(n=0;n<s;n+=1)a=t.v[n],l=t.o[n],o=t.i[n],a[0]===l[0]&&a[1]===l[1]&&a[0]===o[0]&&a[1]===o[1]?(n===0||n===s-1)&&!t.c?(r.setTripleAt(a[0],a[1],l[0],l[1],o[0],o[1],p),p+=1):(n===0?u=t.v[s-1]:u=t.v[n-1],c=Math.sqrt(Math.pow(a[0]-u[0],2)+Math.pow(a[1]-u[1],2)),d=c?Math.min(c/2,e)/c:0,T=a[0]+(u[0]-a[0])*d,m=T,S=a[1]-(a[1]-u[1])*d,y=S,b=m-(m-a[0])*roundCorner,E=y-(y-a[1])*roundCorner,r.setTripleAt(m,y,b,E,T,S,p),p+=1,n===s-1?u=t.v[0]:u=t.v[n+1],c=Math.sqrt(Math.pow(a[0]-u[0],2)+Math.pow(a[1]-u[1],2)),d=c?Math.min(c/2,e)/c:0,b=a[0]+(u[0]-a[0])*d,m=b,E=a[1]+(u[1]-a[1])*d,y=E,T=m-(m-a[0])*roundCorner,S=y-(y-a[1])*roundCorner,r.setTripleAt(m,y,b,E,T,S,p),p+=1):(r.setTripleAt(t.v[n][0],t.v[n][1],t.o[n][0],t.o[n][1],t.i[n][0],t.i[n][1],p),p+=1);return r},RoundCornersModifier.prototype.processShapes=function(t){var e,r,n=this.shapes.length,s,a,o=this.rd.v;if(o!==0){var l,u;for(r=0;r<n;r+=1){if(l=this.shapes[r],u=l.localShapeCollection,!(!l.shape._mdf&&!this._mdf&&!t))for(u.releaseShapes(),l.shape._mdf=!0,e=l.shape.paths.shapes,a=l.shape.paths._length,s=0;s<a;s+=1)u.addShape(this.processPath(e[s],o));l.shape.paths=l.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function floatEqual(t,e){return Math.abs(t-e)*1e5<=Math.min(Math.abs(t),Math.abs(e))}function floatZero(t){return Math.abs(t)<=1e-5}function lerp(t,e,r){return t*(1-r)+e*r}function lerpPoint(t,e,r){return[lerp(t[0],e[0],r),lerp(t[1],e[1],r)]}function quadRoots(t,e,r){if(t===0)return[];var n=e*e-4*t*r;if(n<0)return[];var s=-e/(2*t);if(n===0)return[s];var a=Math.sqrt(n)/(2*t);return[s-a,s+a]}function polynomialCoefficients(t,e,r,n){return[-t+3*e-3*r+n,3*t-6*e+3*r,-3*t+3*e,t]}function singlePoint(t){return new PolynomialBezier(t,t,t,t,!1)}function PolynomialBezier(t,e,r,n,s){s&&pointEqual(t,e)&&(e=lerpPoint(t,n,1/3)),s&&pointEqual(r,n)&&(r=lerpPoint(t,n,2/3));var a=polynomialCoefficients(t[0],e[0],r[0],n[0]),o=polynomialCoefficients(t[1],e[1],r[1],n[1]);this.a=[a[0],o[0]],this.b=[a[1],o[1]],this.c=[a[2],o[2]],this.d=[a[3],o[3]],this.points=[t,e,r,n]}PolynomialBezier.prototype.point=function(t){return[((this.a[0]*t+this.b[0])*t+this.c[0])*t+this.d[0],((this.a[1]*t+this.b[1])*t+this.c[1])*t+this.d[1]]},PolynomialBezier.prototype.derivative=function(t){return[(3*t*this.a[0]+2*this.b[0])*t+this.c[0],(3*t*this.a[1]+2*this.b[1])*t+this.c[1]]},PolynomialBezier.prototype.tangentAngle=function(t){var e=this.derivative(t);return Math.atan2(e[1],e[0])},PolynomialBezier.prototype.normalAngle=function(t){var e=this.derivative(t);return Math.atan2(e[0],e[1])},PolynomialBezier.prototype.inflectionPoints=function(){var t=this.a[1]*this.b[0]-this.a[0]*this.b[1];if(floatZero(t))return[];var e=-.5*(this.a[1]*this.c[0]-this.a[0]*this.c[1])/t,r=e*e-1/3*(this.b[1]*this.c[0]-this.b[0]*this.c[1])/t;if(r<0)return[];var n=Math.sqrt(r);return floatZero(n)?n>0&&n<1?[e]:[]:[e-n,e+n].filter(function(s){return s>0&&s<1})},PolynomialBezier.prototype.split=function(t){if(t<=0)return[singlePoint(this.points[0]),this];if(t>=1)return[this,singlePoint(this.points[this.points.length-1])];var e=lerpPoint(this.points[0],this.points[1],t),r=lerpPoint(this.points[1],this.points[2],t),n=lerpPoint(this.points[2],this.points[3],t),s=lerpPoint(e,r,t),a=lerpPoint(r,n,t),o=lerpPoint(s,a,t);return[new PolynomialBezier(this.points[0],e,s,o,!0),new PolynomialBezier(o,a,n,this.points[3],!0)]};function extrema(t,e){var r=t.points[0][e],n=t.points[t.points.length-1][e];if(r>n){var s=n;n=r,r=s}for(var a=quadRoots(3*t.a[e],2*t.b[e],t.c[e]),o=0;o<a.length;o+=1)if(a[o]>0&&a[o]<1){var l=t.point(a[o])[e];l<r?r=l:l>n&&(n=l)}return{min:r,max:n}}PolynomialBezier.prototype.bounds=function(){return{x:extrema(this,0),y:extrema(this,1)}},PolynomialBezier.prototype.boundingBox=function(){var t=this.bounds();return{left:t.x.min,right:t.x.max,top:t.y.min,bottom:t.y.max,width:t.x.max-t.x.min,height:t.y.max-t.y.min,cx:(t.x.max+t.x.min)/2,cy:(t.y.max+t.y.min)/2}};function intersectData(t,e,r){var n=t.boundingBox();return{cx:n.cx,cy:n.cy,width:n.width,height:n.height,bez:t,t:(e+r)/2,t1:e,t2:r}}function splitData(t){var e=t.bez.split(.5);return[intersectData(e[0],t.t1,t.t),intersectData(e[1],t.t,t.t2)]}function boxIntersect(t,e){return Math.abs(t.cx-e.cx)*2<t.width+e.width&&Math.abs(t.cy-e.cy)*2<t.height+e.height}function intersectsImpl(t,e,r,n,s,a){if(boxIntersect(t,e)){if(r>=a||t.width<=n&&t.height<=n&&e.width<=n&&e.height<=n){s.push([t.t,e.t]);return}var o=splitData(t),l=splitData(e);intersectsImpl(o[0],l[0],r+1,n,s,a),intersectsImpl(o[0],l[1],r+1,n,s,a),intersectsImpl(o[1],l[0],r+1,n,s,a),intersectsImpl(o[1],l[1],r+1,n,s,a)}}PolynomialBezier.prototype.intersections=function(t,e,r){e===void 0&&(e=2),r===void 0&&(r=7);var n=[];return intersectsImpl(intersectData(this,0,1),intersectData(t,0,1),0,e,n,r),n},PolynomialBezier.shapeSegment=function(t,e){var r=(e+1)%t.length();return new PolynomialBezier(t.v[e],t.o[e],t.i[r],t.v[r],!0)},PolynomialBezier.shapeSegmentInverted=function(t,e){var r=(e+1)%t.length();return new PolynomialBezier(t.v[r],t.i[r],t.o[e],t.v[e],!0)};function crossProduct(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function lineIntersection(t,e,r,n){var s=[t[0],t[1],1],a=[e[0],e[1],1],o=[r[0],r[1],1],l=[n[0],n[1],1],u=crossProduct(crossProduct(s,a),crossProduct(o,l));return floatZero(u[2])?null:[u[0]/u[2],u[1]/u[2]]}function polarOffset(t,e,r){return[t[0]+Math.cos(e)*r,t[1]-Math.sin(e)*r]}function pointDistance(t,e){return Math.hypot(t[0]-e[0],t[1]-e[1])}function pointEqual(t,e){return floatEqual(t[0],e[0])&&floatEqual(t[1],e[1])}function ZigZagModifier(){}extendPrototype([ShapeModifier],ZigZagModifier),ZigZagModifier.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.amplitude=PropertyFactory.getProp(t,e.s,0,null,this),this.frequency=PropertyFactory.getProp(t,e.r,0,null,this),this.pointsType=PropertyFactory.getProp(t,e.pt,0,null,this),this._isAnimated=this.amplitude.effectsSequence.length!==0||this.frequency.effectsSequence.length!==0||this.pointsType.effectsSequence.length!==0};function setPoint(t,e,r,n,s,a,o){var l=r-Math.PI/2,u=r+Math.PI/2,c=e[0]+Math.cos(r)*n*s,d=e[1]-Math.sin(r)*n*s;t.setTripleAt(c,d,c+Math.cos(l)*a,d-Math.sin(l)*a,c+Math.cos(u)*o,d-Math.sin(u)*o,t.length())}function getPerpendicularVector(t,e){var r=[e[0]-t[0],e[1]-t[1]],n=-Math.PI*.5,s=[Math.cos(n)*r[0]-Math.sin(n)*r[1],Math.sin(n)*r[0]+Math.cos(n)*r[1]];return s}function getProjectingAngle(t,e){var r=e===0?t.length()-1:e-1,n=(e+1)%t.length(),s=t.v[r],a=t.v[n],o=getPerpendicularVector(s,a);return Math.atan2(0,1)-Math.atan2(o[1],o[0])}function zigZagCorner(t,e,r,n,s,a,o){var l=getProjectingAngle(e,r),u=e.v[r%e._length],c=e.v[r===0?e._length-1:r-1],d=e.v[(r+1)%e._length],p=a===2?Math.sqrt(Math.pow(u[0]-c[0],2)+Math.pow(u[1]-c[1],2)):0,m=a===2?Math.sqrt(Math.pow(u[0]-d[0],2)+Math.pow(u[1]-d[1],2)):0;setPoint(t,e.v[r%e._length],l,o,n,m/((s+1)*2),p/((s+1)*2))}function zigZagSegment(t,e,r,n,s,a){for(var o=0;o<n;o+=1){var l=(o+1)/(n+1),u=s===2?Math.sqrt(Math.pow(e.points[3][0]-e.points[0][0],2)+Math.pow(e.points[3][1]-e.points[0][1],2)):0,c=e.normalAngle(l),d=e.point(l);setPoint(t,d,c,a,r,u/((n+1)*2),u/((n+1)*2)),a=-a}return a}ZigZagModifier.prototype.processPath=function(t,e,r,n){var s=t._length,a=shapePool.newElement();if(a.c=t.c,t.c||(s-=1),s===0)return a;var o=-1,l=PolynomialBezier.shapeSegment(t,0);zigZagCorner(a,t,0,e,r,n,o);for(var u=0;u<s;u+=1)o=zigZagSegment(a,l,e,r,n,-o),u===s-1&&!t.c?l=null:l=PolynomialBezier.shapeSegment(t,(u+1)%s),zigZagCorner(a,t,u+1,e,r,n,o);return a},ZigZagModifier.prototype.processShapes=function(t){var e,r,n=this.shapes.length,s,a,o=this.amplitude.v,l=Math.max(0,Math.round(this.frequency.v)),u=this.pointsType.v;if(o!==0){var c,d;for(r=0;r<n;r+=1){if(c=this.shapes[r],d=c.localShapeCollection,!(!c.shape._mdf&&!this._mdf&&!t))for(d.releaseShapes(),c.shape._mdf=!0,e=c.shape.paths.shapes,a=c.shape.paths._length,s=0;s<a;s+=1)d.addShape(this.processPath(e[s],o,l,u));c.shape.paths=c.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function linearOffset(t,e,r){var n=Math.atan2(e[0]-t[0],e[1]-t[1]);return[polarOffset(t,n,r),polarOffset(e,n,r)]}function offsetSegment(t,e){var r,n,s,a,o,l,u;u=linearOffset(t.points[0],t.points[1],e),r=u[0],n=u[1],u=linearOffset(t.points[1],t.points[2],e),s=u[0],a=u[1],u=linearOffset(t.points[2],t.points[3],e),o=u[0],l=u[1];var c=lineIntersection(r,n,s,a);c===null&&(c=n);var d=lineIntersection(o,l,s,a);return d===null&&(d=o),new PolynomialBezier(r,c,d,l)}function joinLines(t,e,r,n,s){var a=e.points[3],o=r.points[0];if(n===3||pointEqual(a,o))return a;if(n===2){var l=-e.tangentAngle(1),u=-r.tangentAngle(0)+Math.PI,c=lineIntersection(a,polarOffset(a,l+Math.PI/2,100),o,polarOffset(o,l+Math.PI/2,100)),d=c?pointDistance(c,a):pointDistance(a,o)/2,p=polarOffset(a,l,2*d*roundCorner);return t.setXYAt(p[0],p[1],"o",t.length()-1),p=polarOffset(o,u,2*d*roundCorner),t.setTripleAt(o[0],o[1],o[0],o[1],p[0],p[1],t.length()),o}var m=pointEqual(a,e.points[2])?e.points[0]:e.points[2],y=pointEqual(o,r.points[1])?r.points[3]:r.points[1],b=lineIntersection(m,a,o,y);return b&&pointDistance(b,a)<s?(t.setTripleAt(b[0],b[1],b[0],b[1],b[0],b[1],t.length()),b):a}function getIntersection(t,e){var r=t.intersections(e);return r.length&&floatEqual(r[0][0],1)&&r.shift(),r.length?r[0]:null}function pruneSegmentIntersection(t,e){var r=t.slice(),n=e.slice(),s=getIntersection(t[t.length-1],e[0]);return s&&(r[t.length-1]=t[t.length-1].split(s[0])[0],n[0]=e[0].split(s[1])[1]),t.length>1&&e.length>1&&(s=getIntersection(t[0],e[e.length-1]),s)?[[t[0].split(s[0])[0]],[e[e.length-1].split(s[1])[1]]]:[r,n]}function pruneIntersections(t){for(var e,r=1;r<t.length;r+=1)e=pruneSegmentIntersection(t[r-1],t[r]),t[r-1]=e[0],t[r]=e[1];return t.length>1&&(e=pruneSegmentIntersection(t[t.length-1],t[0]),t[t.length-1]=e[0],t[0]=e[1]),t}function offsetSegmentSplit(t,e){var r=t.inflectionPoints(),n,s,a,o;if(r.length===0)return[offsetSegment(t,e)];if(r.length===1||floatEqual(r[1],1))return a=t.split(r[0]),n=a[0],s=a[1],[offsetSegment(n,e),offsetSegment(s,e)];a=t.split(r[0]),n=a[0];var l=(r[1]-r[0])/(1-r[0]);return a=a[1].split(l),o=a[0],s=a[1],[offsetSegment(n,e),offsetSegment(o,e),offsetSegment(s,e)]}function OffsetPathModifier(){}extendPrototype([ShapeModifier],OffsetPathModifier),OffsetPathModifier.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(t,e.a,0,null,this),this.miterLimit=PropertyFactory.getProp(t,e.ml,0,null,this),this.lineJoin=e.lj,this._isAnimated=this.amount.effectsSequence.length!==0},OffsetPathModifier.prototype.processPath=function(t,e,r,n){var s=shapePool.newElement();s.c=t.c;var a=t.length();t.c||(a-=1);var o,l,u,c=[];for(o=0;o<a;o+=1)u=PolynomialBezier.shapeSegment(t,o),c.push(offsetSegmentSplit(u,e));if(!t.c)for(o=a-1;o>=0;o-=1)u=PolynomialBezier.shapeSegmentInverted(t,o),c.push(offsetSegmentSplit(u,e));c=pruneIntersections(c);var d=null,p=null;for(o=0;o<c.length;o+=1){var m=c[o];for(p&&(d=joinLines(s,p,m[0],r,n)),p=m[m.length-1],l=0;l<m.length;l+=1)u=m[l],d&&pointEqual(u.points[0],d)?s.setXYAt(u.points[1][0],u.points[1][1],"o",s.length()-1):s.setTripleAt(u.points[0][0],u.points[0][1],u.points[1][0],u.points[1][1],u.points[0][0],u.points[0][1],s.length()),s.setTripleAt(u.points[3][0],u.points[3][1],u.points[3][0],u.points[3][1],u.points[2][0],u.points[2][1],s.length()),d=u.points[3]}return c.length&&joinLines(s,p,c[0][0],r,n),s},OffsetPathModifier.prototype.processShapes=function(t){var e,r,n=this.shapes.length,s,a,o=this.amount.v,l=this.miterLimit.v,u=this.lineJoin;if(o!==0){var c,d;for(r=0;r<n;r+=1){if(c=this.shapes[r],d=c.localShapeCollection,!(!c.shape._mdf&&!this._mdf&&!t))for(d.releaseShapes(),c.shape._mdf=!0,e=c.shape.paths.shapes,a=c.shape.paths._length,s=0;s<a;s+=1)d.addShape(this.processPath(e[s],o,u,l));c.shape.paths=c.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function getFontProperties(t){for(var e=t.fStyle?t.fStyle.split(" "):[],r="normal",n="normal",s=e.length,a,o=0;o<s;o+=1)switch(a=e[o].toLowerCase(),a){case"italic":n="italic";break;case"bold":r="700";break;case"black":r="900";break;case"medium":r="500";break;case"regular":case"normal":r="400";break;case"light":case"thin":r="200";break}return{style:n,weight:t.fWeight||r}}var FontManager=function(){var t=5e3,e={w:0,size:0,shapes:[],data:{shapes:[]}},r=[];r=r.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var n=127988,s=917631,a=917601,o=917626,l=65039,u=8205,c=127462,d=127487,p=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"];function m(te){var le=te.split(","),Z,Y=le.length,he=[];for(Z=0;Z<Y;Z+=1)le[Z]!=="sans-serif"&&le[Z]!=="monospace"&&he.push(le[Z]);return he.join(",")}function y(te,le){var Z=createTag("span");Z.setAttribute("aria-hidden",!0),Z.style.fontFamily=le;var Y=createTag("span");Y.innerText="giItT1WQy@!-/#",Z.style.position="absolute",Z.style.left="-10000px",Z.style.top="-10000px",Z.style.fontSize="300px",Z.style.fontVariant="normal",Z.style.fontStyle="normal",Z.style.fontWeight="normal",Z.style.letterSpacing="0",Z.appendChild(Y),document.body.appendChild(Z);var he=Y.offsetWidth;return Y.style.fontFamily=m(te)+", "+le,{node:Y,w:he,parent:Z}}function b(){var te,le=this.fonts.length,Z,Y,he=le;for(te=0;te<le;te+=1)this.fonts[te].loaded?he-=1:this.fonts[te].fOrigin==="n"||this.fonts[te].origin===0?this.fonts[te].loaded=!0:(Z=this.fonts[te].monoCase.node,Y=this.fonts[te].monoCase.w,Z.offsetWidth!==Y?(he-=1,this.fonts[te].loaded=!0):(Z=this.fonts[te].sansCase.node,Y=this.fonts[te].sansCase.w,Z.offsetWidth!==Y&&(he-=1,this.fonts[te].loaded=!0)),this.fonts[te].loaded&&(this.fonts[te].sansCase.parent.parentNode.removeChild(this.fonts[te].sansCase.parent),this.fonts[te].monoCase.parent.parentNode.removeChild(this.fonts[te].monoCase.parent)));he!==0&&Date.now()-this.initTime<t?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)}function E(te,le){var Z=document.body&&le?"svg":"canvas",Y,he=getFontProperties(te);if(Z==="svg"){var oe=createNS("text");oe.style.fontSize="100px",oe.setAttribute("font-family",te.fFamily),oe.setAttribute("font-style",he.style),oe.setAttribute("font-weight",he.weight),oe.textContent="1",te.fClass?(oe.style.fontFamily="inherit",oe.setAttribute("class",te.fClass)):oe.style.fontFamily=te.fFamily,le.appendChild(oe),Y=oe}else{var ye=new OffscreenCanvas(500,500).getContext("2d");ye.font=he.style+" "+he.weight+" 100px "+te.fFamily,Y=ye}function Ee(Ae){return Z==="svg"?(Y.textContent=Ae,Y.getComputedTextLength()):Y.measureText(Ae).width}return{measureText:Ee}}function T(te,le){if(!te){this.isLoaded=!0;return}if(this.chars){this.isLoaded=!0,this.fonts=te.list;return}if(!document.body){this.isLoaded=!0,te.list.forEach(function(Pe){Pe.helper=E(Pe),Pe.cache={}}),this.fonts=te.list;return}var Z=te.list,Y,he=Z.length,oe=he;for(Y=0;Y<he;Y+=1){var ye=!0,Ee,Ae;if(Z[Y].loaded=!1,Z[Y].monoCase=y(Z[Y].fFamily,"monospace"),Z[Y].sansCase=y(Z[Y].fFamily,"sans-serif"),!Z[Y].fPath)Z[Y].loaded=!0,oe-=1;else if(Z[Y].fOrigin==="p"||Z[Y].origin===3){if(Ee=document.querySelectorAll('style[f-forigin="p"][f-family="'+Z[Y].fFamily+'"], style[f-origin="3"][f-family="'+Z[Y].fFamily+'"]'),Ee.length>0&&(ye=!1),ye){var je=createTag("style");je.setAttribute("f-forigin",Z[Y].fOrigin),je.setAttribute("f-origin",Z[Y].origin),je.setAttribute("f-family",Z[Y].fFamily),je.type="text/css",je.innerText="@font-face {font-family: "+Z[Y].fFamily+"; font-style: normal; src: url('"+Z[Y].fPath+"');}",le.appendChild(je)}}else if(Z[Y].fOrigin==="g"||Z[Y].origin===1){for(Ee=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),Ae=0;Ae<Ee.length;Ae+=1)Ee[Ae].href.indexOf(Z[Y].fPath)!==-1&&(ye=!1);if(ye){var Te=createTag("link");Te.setAttribute("f-forigin",Z[Y].fOrigin),Te.setAttribute("f-origin",Z[Y].origin),Te.type="text/css",Te.rel="stylesheet",Te.href=Z[Y].fPath,document.body.appendChild(Te)}}else if(Z[Y].fOrigin==="t"||Z[Y].origin===2){for(Ee=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),Ae=0;Ae<Ee.length;Ae+=1)Z[Y].fPath===Ee[Ae].src&&(ye=!1);if(ye){var Ve=createTag("link");Ve.setAttribute("f-forigin",Z[Y].fOrigin),Ve.setAttribute("f-origin",Z[Y].origin),Ve.setAttribute("rel","stylesheet"),Ve.setAttribute("href",Z[Y].fPath),le.appendChild(Ve)}}Z[Y].helper=E(Z[Y],le),Z[Y].cache={},this.fonts.push(Z[Y])}oe===0?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}function S(te){if(te){this.chars||(this.chars=[]);var le,Z=te.length,Y,he=this.chars.length,oe;for(le=0;le<Z;le+=1){for(Y=0,oe=!1;Y<he;)this.chars[Y].style===te[le].style&&this.chars[Y].fFamily===te[le].fFamily&&this.chars[Y].ch===te[le].ch&&(oe=!0),Y+=1;oe||(this.chars.push(te[le]),he+=1)}}}function P(te,le,Z){for(var Y=0,he=this.chars.length;Y<he;){if(this.chars[Y].ch===te&&this.chars[Y].style===le&&this.chars[Y].fFamily===Z)return this.chars[Y];Y+=1}return(typeof te=="string"&&te.charCodeAt(0)!==13||!te)&&console&&console.warn&&!this._warned&&(this._warned=!0,console.warn("Missing character from exported characters list: ",te,le,Z)),e}function A(te,le,Z){var Y=this.getFontByName(le),he=te;if(!Y.cache[he]){var oe=Y.helper;if(te===" "){var ye=oe.measureText("|"+te+"|"),Ee=oe.measureText("||");Y.cache[he]=(ye-Ee)/100}else Y.cache[he]=oe.measureText(te)/100}return Y.cache[he]*Z}function I(te){for(var le=0,Z=this.fonts.length;le<Z;){if(this.fonts[le].fName===te)return this.fonts[le];le+=1}return this.fonts[0]}function j(te){var le=0,Z=te.charCodeAt(0);if(Z>=55296&&Z<=56319){var Y=te.charCodeAt(1);Y>=56320&&Y<=57343&&(le=(Z-55296)*1024+Y-56320+65536)}return le}function K(te,le){var Z=te.toString(16)+le.toString(16);return p.indexOf(Z)!==-1}function W(te){return te===u}function H(te){return te===l}function ee(te){var le=j(te);return le>=c&&le<=d}function ue(te){return ee(te.substr(0,2))&&ee(te.substr(2,2))}function de(te){return r.indexOf(te)!==-1}function fe(te,le){var Z=j(te.substr(le,2));if(Z!==n)return!1;var Y=0;for(le+=2;Y<5;){if(Z=j(te.substr(le,2)),Z<a||Z>o)return!1;Y+=1,le+=2}return j(te.substr(le,2))===s}function ae(){this.isLoaded=!0}var ce=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)};ce.isModifier=K,ce.isZeroWidthJoiner=W,ce.isFlagEmoji=ue,ce.isRegionalCode=ee,ce.isCombinedCharacter=de,ce.isRegionalFlag=fe,ce.isVariationSelector=H,ce.BLACK_FLAG_CODE_POINT=n;var me={addChars:S,addFonts:T,getCharData:P,getFontByName:I,measureText:A,checkLoadedFonts:b,setIsLoaded:ae};return ce.prototype=me,ce}();function SlotManager(t){this.animationData=t}SlotManager.prototype.getProp=function(t){return this.animationData.slots&&this.animationData.slots[t.sid]?Object.assign(t,this.animationData.slots[t.sid].p):t};function slotFactory(t){return new SlotManager(t)}function RenderableElement(){}RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(e){this.renderableComponents.indexOf(e)===-1&&this.renderableComponents.push(e)},removeRenderableComponent:function(e){this.renderableComponents.indexOf(e)!==-1&&this.renderableComponents.splice(this.renderableComponents.indexOf(e),1)},prepareRenderableFrame:function(e){this.checkLayerLimits(e)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(e){this.data.ip-this.data.st<=e&&this.data.op-this.data.st>e?this.isInRange!==!0&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):this.isInRange!==!1&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var e,r=this.renderableComponents.length;for(e=0;e<r;e+=1)this.renderableComponents[e].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return this.data.ty===5?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}};var getBlendMode=function(){var t={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"};return function(e){return t[e]||""}}();function SliderEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,0,0,r)}function AngleEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,0,0,r)}function ColorEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,1,0,r)}function PointEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,1,0,r)}function LayerIndexEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,0,0,r)}function MaskIndexEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,0,0,r)}function CheckboxEffect(t,e,r){this.p=PropertyFactory.getProp(e,t.v,0,0,r)}function NoValueEffect(){this.p={}}function EffectsManager(t,e){var r=t.ef||[];this.effectElements=[];var n,s=r.length,a;for(n=0;n<s;n+=1)a=new GroupEffect(r[n],e),this.effectElements.push(a)}function GroupEffect(t,e){this.init(t,e)}extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(t,e){this.data=t,this.effectElements=[],this.initDynamicPropertyContainer(e);var r,n=this.data.ef.length,s,a=this.data.ef;for(r=0;r<n;r+=1){switch(s=null,a[r].ty){case 0:s=new SliderEffect(a[r],e,this);break;case 1:s=new AngleEffect(a[r],e,this);break;case 2:s=new ColorEffect(a[r],e,this);break;case 3:s=new PointEffect(a[r],e,this);break;case 4:case 7:s=new CheckboxEffect(a[r],e,this);break;case 10:s=new LayerIndexEffect(a[r],e,this);break;case 11:s=new MaskIndexEffect(a[r],e,this);break;case 5:s=new EffectsManager(a[r],e);break;default:s=new NoValueEffect(a[r]);break}s&&this.effectElements.push(s)}};function BaseElement(){}BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var e=0,r=this.data.masksProperties.length;e<r;){if(this.data.masksProperties[e].mode!=="n"&&this.data.masksProperties[e].cl!==!1)return!0;e+=1}return!1},initExpressions:function(){var e=getExpressionInterfaces();if(e){var r=e("layer"),n=e("effects"),s=e("shape"),a=e("text"),o=e("comp");this.layerInterface=r(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var l=n.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(l),this.data.ty===0||this.data.xt?this.compInterface=o(this):this.data.ty===4?(this.layerInterface.shapeInterface=s(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):this.data.ty===5&&(this.layerInterface.textInterface=a(this),this.layerInterface.text=this.layerInterface.textInterface)}},setBlendMode:function(){var e=getBlendMode(this.data.bm),r=this.baseElement||this.layerElement;r.style["mix-blend-mode"]=e},initBaseData:function(e,r,n){this.globalData=r,this.comp=n,this.data=e,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}};function FrameElement(){}FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(e,r){var n,s=this.dynamicProperties.length;for(n=0;n<s;n+=1)(r||this._isParent&&this.dynamicProperties[n].propType==="transform")&&(this.dynamicProperties[n].getValue(),this.dynamicProperties[n]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(e){this.dynamicProperties.indexOf(e)===-1&&this.dynamicProperties.push(e)}};function FootageElement(t,e,r){this.initFrame(),this.initRenderable(),this.assetData=e.getAssetData(t.refId),this.footageData=e.imageLoader.getAsset(this.assetData),this.initBaseData(t,e,r)}FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){var t=getExpressionInterfaces();if(t){var e=t("footage");this.layerInterface=e(this)}},FootageElement.prototype.getFootageData=function(){return this.footageData};function AudioElement(t,e,r){this.initFrame(),this.initRenderable(),this.assetData=e.getAssetData(t.refId),this.initBaseData(t,e,r),this._isPlaying=!1,this._canPlay=!1;var n=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio(n),this._currentTime=0,this.globalData.audioController.addAudio(this),this._volumeMultiplier=1,this._volume=1,this._previousVolume=null,this.tm=t.tm?PropertyFactory.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0},this.lv=PropertyFactory.getProp(this,t.au&&t.au.lv?t.au.lv:{k:[100]},1,.01,this)}AudioElement.prototype.prepareFrame=function(t){if(this.prepareRenderableFrame(t,!0),this.prepareProperties(t,!0),this.tm._placeholder)this._currentTime=t/this.data.sr;else{var e=this.tm.v;this._currentTime=e}this._volume=this.lv.v[0];var r=this._volume*this._volumeMultiplier;this._previousVolume!==r&&(this._previousVolume=r,this.audio.volume(r))},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},AudioElement.prototype.resume=function(){this._canPlay=!0},AudioElement.prototype.setRate=function(t){this.audio.rate(t)},AudioElement.prototype.volume=function(t){this._volumeMultiplier=t,this._previousVolume=t*this._volume,this.audio.volume(this._previousVolume)},AudioElement.prototype.getBaseElement=function(){return null},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){};function BaseRenderer(){}BaseRenderer.prototype.checkLayers=function(t){var e,r=this.layers.length,n;for(this.completeLayers=!0,e=r-1;e>=0;e-=1)this.elements[e]||(n=this.layers[e],n.ip-n.st<=t-this.layers[e].st&&n.op-n.st>t-this.layers[e].st&&this.buildItem(e)),this.completeLayers=this.elements[e]?this.completeLayers:!1;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(t){switch(t.ty){case 2:return this.createImage(t);case 0:return this.createComp(t);case 1:return this.createSolid(t);case 3:return this.createNull(t);case 4:return this.createShape(t);case 5:return this.createText(t);case 6:return this.createAudio(t);case 13:return this.createCamera(t);case 15:return this.createFootage(t);default:return this.createNull(t)}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.createAudio=function(t){return new AudioElement(t,this.globalData,this)},BaseRenderer.prototype.createFootage=function(t){return new FootageElement(t,this.globalData,this)},BaseRenderer.prototype.buildAllItems=function(){var t,e=this.layers.length;for(t=0;t<e;t+=1)this.buildItem(t);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(t){this.completeLayers=!1;var e,r=t.length,n,s=this.layers.length;for(e=0;e<r;e+=1)for(n=0;n<s;){if(this.layers[n].id===t[e].id){this.layers[n]=t[e];break}n+=1}},BaseRenderer.prototype.setProjectInterface=function(t){this.globalData.projectInterface=t},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(t,e,r){for(var n=this.elements,s=this.layers,a=0,o=s.length;a<o;)s[a].ind==e&&(!n[a]||n[a]===!0?(this.buildItem(a),this.addPendingElement(t)):(r.push(n[a]),n[a].setAsParent(),s[a].parent!==void 0?this.buildElementParenting(t,s[a].parent,r):t.setHierarchy(r))),a+=1},BaseRenderer.prototype.addPendingElement=function(t){this.pendingElements.push(t)},BaseRenderer.prototype.searchExtraCompositions=function(t){var e,r=t.length;for(e=0;e<r;e+=1)if(t[e].xt){var n=this.createComp(t[e]);n.initExpressions(),this.globalData.projectInterface.registerComposition(n)}},BaseRenderer.prototype.getElementById=function(t){var e,r=this.elements.length;for(e=0;e<r;e+=1)if(this.elements[e].data.ind===t)return this.elements[e];return null},BaseRenderer.prototype.getElementByPath=function(t){var e=t.shift(),r;if(typeof e=="number")r=this.elements[e];else{var n,s=this.elements.length;for(n=0;n<s;n+=1)if(this.elements[n].data.nm===e){r=this.elements[n];break}}return t.length===0?r:r.getElementByPath(t)},BaseRenderer.prototype.setupGlobalData=function(t,e){this.globalData.fontManager=new FontManager,this.globalData.slotManager=slotFactory(t),this.globalData.fontManager.addChars(t.chars),this.globalData.fontManager.addFonts(t.fonts,e),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=t.fr,this.globalData.nm=t.nm,this.globalData.compSize={w:t.w,h:t.h}};var effectTypes={TRANSFORM_EFFECT:"transformEFfect"};function TransformElement(){}TransformElement.prototype={initTransform:function(){var e=new Matrix;this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_localMatMdf:!1,_opMdf:!1,mat:e,localMat:e,localOpacity:1},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var e,r=this.finalTransform.mat,n=0,s=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;n<s;){if(this.hierarchy[n].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}n+=1}if(this.finalTransform._matMdf)for(e=this.finalTransform.mProp.v.props,r.cloneFromProps(e),n=0;n<s;n+=1)r.multiply(this.hierarchy[n].finalTransform.mProp.v)}(!this.localTransforms||this.finalTransform._matMdf)&&(this.finalTransform._localMatMdf=this.finalTransform._matMdf),this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v)},renderLocalTransform:function(){if(this.localTransforms){var e=0,r=this.localTransforms.length;if(this.finalTransform._localMatMdf=this.finalTransform._matMdf,!this.finalTransform._localMatMdf||!this.finalTransform._opMdf)for(;e<r;)this.localTransforms[e]._mdf&&(this.finalTransform._localMatMdf=!0),this.localTransforms[e]._opMdf&&!this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v,this.finalTransform._opMdf=!0),e+=1;if(this.finalTransform._localMatMdf){var n=this.finalTransform.localMat;for(this.localTransforms[0].matrix.clone(n),e=1;e<r;e+=1){var s=this.localTransforms[e].matrix;n.multiply(s)}n.multiply(this.finalTransform.mat)}if(this.finalTransform._opMdf){var a=this.finalTransform.localOpacity;for(e=0;e<r;e+=1)a*=this.localTransforms[e].opacity*.01;this.finalTransform.localOpacity=a}}},searchEffectTransforms:function(){if(this.renderableEffectsManager){var e=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT);if(e.length){this.localTransforms=[],this.finalTransform.localMat=new Matrix;var r=0,n=e.length;for(r=0;r<n;r+=1)this.localTransforms.push(e[r])}}},globalToLocal:function(e){var r=[];r.push(this.finalTransform);for(var n=!0,s=this.comp;n;)s.finalTransform?(s.data.hasMask&&r.splice(0,0,s.finalTransform),s=s.comp):n=!1;var a,o=r.length,l;for(a=0;a<o;a+=1)l=r[a].mat.applyToPointArray(0,0,0),e=[e[0]-l[0],e[1]-l[1],0];return e},mHelper:new Matrix};function MaskElement(t,e,r){this.data=t,this.element=e,this.globalData=r,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var n=this.globalData.defs,s,a=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(a),this.solidPath="";var o,l=this.masksProperties,u=0,c=[],d,p,m=createElementID(),y,b,E,T,S="clipPath",P="clip-path";for(s=0;s<a;s+=1)if((l[s].mode!=="a"&&l[s].mode!=="n"||l[s].inv||l[s].o.k!==100||l[s].o.x)&&(S="mask",P="mask"),(l[s].mode==="s"||l[s].mode==="i")&&u===0?(y=createNS("rect"),y.setAttribute("fill","#ffffff"),y.setAttribute("width",this.element.comp.data.w||0),y.setAttribute("height",this.element.comp.data.h||0),c.push(y)):y=null,o=createNS("path"),l[s].mode==="n")this.viewData[s]={op:PropertyFactory.getProp(this.element,l[s].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,l[s],3),elem:o,lastPath:""},n.appendChild(o);else{u+=1,o.setAttribute("fill",l[s].mode==="s"?"#000000":"#ffffff"),o.setAttribute("clip-rule","nonzero");var A;if(l[s].x.k!==0?(S="mask",P="mask",T=PropertyFactory.getProp(this.element,l[s].x,0,null,this.element),A=createElementID(),b=createNS("filter"),b.setAttribute("id",A),E=createNS("feMorphology"),E.setAttribute("operator","erode"),E.setAttribute("in","SourceGraphic"),E.setAttribute("radius","0"),b.appendChild(E),n.appendChild(b),o.setAttribute("stroke",l[s].mode==="s"?"#000000":"#ffffff")):(E=null,T=null),this.storedData[s]={elem:o,x:T,expan:E,lastPath:"",lastOperator:"",filterId:A,lastRadius:0},l[s].mode==="i"){p=c.length;var I=createNS("g");for(d=0;d<p;d+=1)I.appendChild(c[d]);var j=createNS("mask");j.setAttribute("mask-type","alpha"),j.setAttribute("id",m+"_"+u),j.appendChild(o),n.appendChild(j),I.setAttribute("mask","url("+getLocationHref()+"#"+m+"_"+u+")"),c.length=0,c.push(I)}else c.push(o);l[s].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[s]={elem:o,lastPath:"",op:PropertyFactory.getProp(this.element,l[s].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,l[s],3),invRect:y},this.viewData[s].prop.k||this.drawPath(l[s],this.viewData[s].prop.v,this.viewData[s])}for(this.maskElement=createNS(S),a=c.length,s=0;s<a;s+=1)this.maskElement.appendChild(c[s]);u>0&&(this.maskElement.setAttribute("id",m),this.element.maskedElement.setAttribute(P,"url("+getLocationHref()+"#"+m+")"),n.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}MaskElement.prototype.getMaskProperty=function(t){return this.viewData[t].prop},MaskElement.prototype.renderFrame=function(t){var e=this.element.finalTransform.mat,r,n=this.masksProperties.length;for(r=0;r<n;r+=1)if((this.viewData[r].prop._mdf||t)&&this.drawPath(this.masksProperties[r],this.viewData[r].prop.v,this.viewData[r]),(this.viewData[r].op._mdf||t)&&this.viewData[r].elem.setAttribute("fill-opacity",this.viewData[r].op.v),this.masksProperties[r].mode!=="n"&&(this.viewData[r].invRect&&(this.element.finalTransform.mProp._mdf||t)&&this.viewData[r].invRect.setAttribute("transform",e.getInverseMatrix().to2dCSS()),this.storedData[r].x&&(this.storedData[r].x._mdf||t))){var s=this.storedData[r].expan;this.storedData[r].x.v<0?(this.storedData[r].lastOperator!=="erode"&&(this.storedData[r].lastOperator="erode",this.storedData[r].elem.setAttribute("filter","url("+getLocationHref()+"#"+this.storedData[r].filterId+")")),s.setAttribute("radius",-this.storedData[r].x.v)):(this.storedData[r].lastOperator!=="dilate"&&(this.storedData[r].lastOperator="dilate",this.storedData[r].elem.setAttribute("filter",null)),this.storedData[r].elem.setAttribute("stroke-width",this.storedData[r].x.v*2))}},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var t="M0,0 ";return t+=" h"+this.globalData.compSize.w,t+=" v"+this.globalData.compSize.h,t+=" h-"+this.globalData.compSize.w,t+=" v-"+this.globalData.compSize.h+" ",t},MaskElement.prototype.drawPath=function(t,e,r){var n=" M"+e.v[0][0]+","+e.v[0][1],s,a;for(a=e._length,s=1;s<a;s+=1)n+=" C"+e.o[s-1][0]+","+e.o[s-1][1]+" "+e.i[s][0]+","+e.i[s][1]+" "+e.v[s][0]+","+e.v[s][1];if(e.c&&a>1&&(n+=" C"+e.o[s-1][0]+","+e.o[s-1][1]+" "+e.i[0][0]+","+e.i[0][1]+" "+e.v[0][0]+","+e.v[0][1]),r.lastPath!==n){var o="";r.elem&&(e.c&&(o=t.inv?this.solidPath+n:n),r.elem.setAttribute("d",o)),r.lastPath=n}},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null};var filtersFactory=function(){var t={};t.createFilter=e,t.createAlphaToLuminanceFilter=r;function e(n,s){var a=createNS("filter");return a.setAttribute("id",n),s!==!0&&(a.setAttribute("filterUnits","objectBoundingBox"),a.setAttribute("x","0%"),a.setAttribute("y","0%"),a.setAttribute("width","100%"),a.setAttribute("height","100%")),a}function r(){var n=createNS("feColorMatrix");return n.setAttribute("type","matrix"),n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),n}return t}(),featureSupport=function(){var t={maskType:!0,svgLumaHidden:!0,offscreenCanvas:typeof OffscreenCanvas<"u"};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(t.maskType=!1),/firefox/i.test(navigator.userAgent)&&(t.svgLumaHidden=!1),t}(),registeredEffects$1={},idPrefix="filter_result_";function SVGEffects(t){var e,r="SourceGraphic",n=t.data.ef?t.data.ef.length:0,s=createElementID(),a=filtersFactory.createFilter(s,!0),o=0;this.filters=[];var l;for(e=0;e<n;e+=1){l=null;var u=t.data.ef[e].ty;if(registeredEffects$1[u]){var c=registeredEffects$1[u].effect;l=new c(a,t.effectsManager.effectElements[e],t,idPrefix+o,r),r=idPrefix+o,registeredEffects$1[u].countsAsEffect&&(o+=1)}l&&this.filters.push(l)}o&&(t.globalData.defs.appendChild(a),t.layerElement.setAttribute("filter","url("+getLocationHref()+"#"+s+")")),this.filters.length&&t.addRenderableComponent(this)}SVGEffects.prototype.renderFrame=function(t){var e,r=this.filters.length;for(e=0;e<r;e+=1)this.filters[e].renderFrame(t)},SVGEffects.prototype.getEffects=function(t){var e,r=this.filters.length,n=[];for(e=0;e<r;e+=1)this.filters[e].type===t&&n.push(this.filters[e]);return n};function registerEffect$1(t,e,r){registeredEffects$1[t]={effect:e,countsAsEffect:r}}function SVGBaseElement(){}SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var e=null;if(this.data.td){this.matteMasks={};var r=createNS("g");r.setAttribute("id",this.layerId),r.appendChild(this.layerElement),e=r,this.globalData.defs.appendChild(r)}else this.data.tt?(this.matteElement.appendChild(this.layerElement),e=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.ty===0&&!this.data.hd){var n=createNS("clipPath"),s=createNS("path");s.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var a=createElementID();if(n.setAttribute("id",a),n.appendChild(s),this.globalData.defs.appendChild(n),this.checkMasks()){var o=createNS("g");o.setAttribute("clip-path","url("+getLocationHref()+"#"+a+")"),o.appendChild(this.layerElement),this.transformedElement=o,e?e.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+a+")")}this.data.bm!==0&&this.setBlendMode()},renderElement:function(){this.finalTransform._localMatMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.localMat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.localOpacity)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this),this.searchEffectTransforms()},getMatte:function(e){if(this.matteMasks||(this.matteMasks={}),!this.matteMasks[e]){var r=this.layerId+"_"+e,n,s,a,o;if(e===1||e===3){var l=createNS("mask");l.setAttribute("id",r),l.setAttribute("mask-type",e===3?"luminance":"alpha"),a=createNS("use"),a.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),l.appendChild(a),this.globalData.defs.appendChild(l),!featureSupport.maskType&&e===1&&(l.setAttribute("mask-type","luminance"),n=createElementID(),s=filtersFactory.createFilter(n),this.globalData.defs.appendChild(s),s.appendChild(filtersFactory.createAlphaToLuminanceFilter()),o=createNS("g"),o.appendChild(a),l.appendChild(o),o.setAttribute("filter","url("+getLocationHref()+"#"+n+")"))}else if(e===2){var u=createNS("mask");u.setAttribute("id",r),u.setAttribute("mask-type","alpha");var c=createNS("g");u.appendChild(c),n=createElementID(),s=filtersFactory.createFilter(n);var d=createNS("feComponentTransfer");d.setAttribute("in","SourceGraphic"),s.appendChild(d);var p=createNS("feFuncA");p.setAttribute("type","table"),p.setAttribute("tableValues","1.0 0.0"),d.appendChild(p),this.globalData.defs.appendChild(s);var m=createNS("rect");m.setAttribute("width",this.comp.data.w),m.setAttribute("height",this.comp.data.h),m.setAttribute("x","0"),m.setAttribute("y","0"),m.setAttribute("fill","#ffffff"),m.setAttribute("opacity","0"),c.setAttribute("filter","url("+getLocationHref()+"#"+n+")"),c.appendChild(m),a=createNS("use"),a.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),c.appendChild(a),featureSupport.maskType||(u.setAttribute("mask-type","luminance"),s.appendChild(filtersFactory.createAlphaToLuminanceFilter()),o=createNS("g"),c.appendChild(m),o.appendChild(this.layerElement),c.appendChild(o)),this.globalData.defs.appendChild(u)}this.matteMasks[e]=r}return this.matteMasks[e]},setMatte:function(e){this.matteElement&&this.matteElement.setAttribute("mask","url("+getLocationHref()+"#"+e+")")}};function HierarchyElement(){}HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(e){this.hierarchy=e},setAsParent:function(){this._isParent=!0},checkParenting:function(){this.data.parent!==void 0&&this.comp.buildElementParenting(this,this.data.parent,[])}};function RenderableDOMElement(){}(function(){var t={initElement:function(r,n,s){this.initFrame(),this.initBaseData(r,n,s),this.initTransform(r,n,s),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){if(!this.hidden&&(!this.isInRange||this.isTransparent)){var r=this.baseElement||this.layerElement;r.style.display="none",this.hidden=!0}},show:function(){if(this.isInRange&&!this.isTransparent){if(!this.data.hd){var r=this.baseElement||this.layerElement;r.style.display="block"}this.hidden=!1,this._isFirstFrame=!0}},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(r){this._mdf=!1,this.prepareRenderableFrame(r),this.prepareProperties(r,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}};extendPrototype([RenderableElement,createProxyFunction(t)],RenderableDOMElement)})();function IImageElement(t,e,r){this.assetData=e.getAssetData(t.refId),this.assetData&&this.assetData.sid&&(this.assetData=e.slotManager.getProp(this.assetData)),this.initElement(t,e,r),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var t=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",t),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect};function ProcessedElement(t,e){this.elem=t,this.pos=e}function IShapeElement(){}IShapeElement.prototype={addShapeToModifiers:function(e){var r,n=this.shapeModifiers.length;for(r=0;r<n;r+=1)this.shapeModifiers[r].addShape(e)},isShapeInAnimatedModifiers:function(e){for(var r=0,n=this.shapeModifiers.length;r<n;)if(this.shapeModifiers[r].isAnimatedWithShape(e))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var e,r=this.shapes.length;for(e=0;e<r;e+=1)this.shapes[e].sh.reset();r=this.shapeModifiers.length;var n;for(e=r-1;e>=0&&(n=this.shapeModifiers[e].processShapes(this._isFirstFrame),!n);e-=1);}},searchProcessedElement:function(e){for(var r=this.processedElements,n=0,s=r.length;n<s;){if(r[n].elem===e)return r[n].pos;n+=1}return 0},addProcessedElement:function(e,r){for(var n=this.processedElements,s=n.length;s;)if(s-=1,n[s].elem===e){n[s].pos=r;return}n.push(new ProcessedElement(e,r))},prepareFrame:function(e){this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange)}};var lineCapEnum={1:"butt",2:"round",3:"square"},lineJoinEnum={1:"miter",2:"round",3:"bevel"};function SVGShapeData(t,e,r){this.caches=[],this.styles=[],this.transformers=t,this.lStr="",this.sh=r,this.lvl=e,this._isAnimated=!!r.k;for(var n=0,s=t.length;n<s;){if(t[n].mProps.dynamicProperties.length){this._isAnimated=!0;break}n+=1}}SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0};function SVGStyleData(t,e){this.data=t,this.type=t.ty,this.d="",this.lvl=e,this._mdf=!1,this.closed=t.hd===!0,this.pElem=createNS("path"),this.msElem=null}SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1};function DashProperty(t,e,r,n){this.elem=t,this.frameId=-1,this.dataProps=createSizedArray(e.length),this.renderer=r,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",e.length?e.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer(n);var s,a=e.length||0,o;for(s=0;s<a;s+=1)o=PropertyFactory.getProp(t,e[s].v,0,0,this),this.k=o.k||this.k,this.dataProps[s]={n:e[s].n,p:o};this.k||this.getValue(!0),this._isAnimated=this.k}DashProperty.prototype.getValue=function(t){if(!(this.elem.globalData.frameId===this.frameId&&!t)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||t,this._mdf)){var e=0,r=this.dataProps.length;for(this.renderer==="svg"&&(this.dashStr=""),e=0;e<r;e+=1)this.dataProps[e].n!=="o"?this.renderer==="svg"?this.dashStr+=" "+this.dataProps[e].p.v:this.dashArray[e]=this.dataProps[e].p.v:this.dashoffset[0]=this.dataProps[e].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty);function SVGStrokeStyleData(t,e,r){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(t,e.o,0,.01,this),this.w=PropertyFactory.getProp(t,e.w,0,null,this),this.d=new DashProperty(t,e.d||{},"svg",this),this.c=PropertyFactory.getProp(t,e.c,1,255,this),this.style=r,this._isAnimated=!!this._isAnimated}extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData);function SVGFillStyleData(t,e,r){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(t,e.o,0,.01,this),this.c=PropertyFactory.getProp(t,e.c,1,255,this),this.style=r}extendPrototype([DynamicPropertyContainer],SVGFillStyleData);function SVGNoStyleData(t,e,r){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.style=r}extendPrototype([DynamicPropertyContainer],SVGNoStyleData);function GradientProperty(t,e,r){this.data=e,this.c=createTypedArray("uint8c",e.p*4);var n=e.k.k[0].s?e.k.k[0].s.length-e.p*4:e.k.k.length-e.p*4;this.o=createTypedArray("float32",n),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=n,this.initDynamicPropertyContainer(r),this.prop=PropertyFactory.getProp(t,e.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}GradientProperty.prototype.comparePoints=function(t,e){for(var r=0,n=this.o.length/2,s;r<n;){if(s=Math.abs(t[r*4]-t[e*4+r*2]),s>.01)return!1;r+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!==this.c.length/4)return!1;if(this.data.k.k[0].s)for(var t=0,e=this.data.k.k.length;t<e;){if(!this.comparePoints(this.data.k.k[t].s,this.data.p))return!1;t+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(t){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||t){var e,r=this.data.p*4,n,s;for(e=0;e<r;e+=1)n=e%4===0?100:255,s=Math.round(this.prop.v[e]*n),this.c[e]!==s&&(this.c[e]=s,this._cmdf=!t);if(this.o.length)for(r=this.prop.v.length,e=this.data.p*4;e<r;e+=1)n=e%2===0?100:1,s=e%2===0?Math.round(this.prop.v[e]*100):this.prop.v[e],this.o[e-this.data.p*4]!==s&&(this.o[e-this.data.p*4]=s,this._omdf=!t);this._mdf=!t}},extendPrototype([DynamicPropertyContainer],GradientProperty);function SVGGradientFillStyleData(t,e,r){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.initGradientData(t,e,r)}SVGGradientFillStyleData.prototype.initGradientData=function(t,e,r){this.o=PropertyFactory.getProp(t,e.o,0,.01,this),this.s=PropertyFactory.getProp(t,e.s,1,null,this),this.e=PropertyFactory.getProp(t,e.e,1,null,this),this.h=PropertyFactory.getProp(t,e.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(t,e.a||{k:0},0,degToRads,this),this.g=new GradientProperty(t,e.g,this),this.style=r,this.stops=[],this.setGradientData(r.pElem,e),this.setGradientOpacity(e,r),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(t,e){var r=createElementID(),n=createNS(e.t===1?"linearGradient":"radialGradient");n.setAttribute("id",r),n.setAttribute("spreadMethod","pad"),n.setAttribute("gradientUnits","userSpaceOnUse");var s=[],a,o,l;for(l=e.g.p*4,o=0;o<l;o+=4)a=createNS("stop"),n.appendChild(a),s.push(a);t.setAttribute(e.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+r+")"),this.gf=n,this.cst=s},SVGGradientFillStyleData.prototype.setGradientOpacity=function(t,e){if(this.g._hasOpacity&&!this.g._collapsable){var r,n,s,a=createNS("mask"),o=createNS("path");a.appendChild(o);var l=createElementID(),u=createElementID();a.setAttribute("id",u);var c=createNS(t.t===1?"linearGradient":"radialGradient");c.setAttribute("id",l),c.setAttribute("spreadMethod","pad"),c.setAttribute("gradientUnits","userSpaceOnUse"),s=t.g.k.k[0].s?t.g.k.k[0].s.length:t.g.k.k.length;var d=this.stops;for(n=t.g.p*4;n<s;n+=2)r=createNS("stop"),r.setAttribute("stop-color","rgb(255,255,255)"),c.appendChild(r),d.push(r);o.setAttribute(t.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+l+")"),t.ty==="gs"&&(o.setAttribute("stroke-linecap",lineCapEnum[t.lc||2]),o.setAttribute("stroke-linejoin",lineJoinEnum[t.lj||2]),t.lj===1&&o.setAttribute("stroke-miterlimit",t.ml)),this.of=c,this.ms=a,this.ost=d,this.maskId=u,e.msElem=o}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData);function SVGGradientStrokeStyleData(t,e,r){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(t,e.w,0,null,this),this.d=new DashProperty(t,e.d||{},"svg",this),this.initGradientData(t,e,r),this._isAnimated=!!this._isAnimated}extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}function SVGTransformData(t,e,r){this.transform={mProps:t,op:e,container:r},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}var buildShapeString=function(e,r,n,s){if(r===0)return"";var a=e.o,o=e.i,l=e.v,u,c=" M"+s.applyToPointStringified(l[0][0],l[0][1]);for(u=1;u<r;u+=1)c+=" C"+s.applyToPointStringified(a[u-1][0],a[u-1][1])+" "+s.applyToPointStringified(o[u][0],o[u][1])+" "+s.applyToPointStringified(l[u][0],l[u][1]);return n&&r&&(c+=" C"+s.applyToPointStringified(a[u-1][0],a[u-1][1])+" "+s.applyToPointStringified(o[0][0],o[0][1])+" "+s.applyToPointStringified(l[0][0],l[0][1]),c+="z"),c},SVGElementsRenderer=function(){var t=new Matrix,e=new Matrix,r={createRenderFunction:n};function n(p){switch(p.ty){case"fl":return l;case"gf":return c;case"gs":return u;case"st":return d;case"sh":case"el":case"rc":case"sr":return o;case"tr":return s;case"no":return a;default:return null}}function s(p,m,y){(y||m.transform.op._mdf)&&m.transform.container.setAttribute("opacity",m.transform.op.v),(y||m.transform.mProps._mdf)&&m.transform.container.setAttribute("transform",m.transform.mProps.v.to2dCSS())}function a(){}function o(p,m,y){var b,E,T,S,P,A,I=m.styles.length,j=m.lvl,K,W,H,ee;for(A=0;A<I;A+=1){if(S=m.sh._mdf||y,m.styles[A].lvl<j){for(W=e.reset(),H=j-m.styles[A].lvl,ee=m.transformers.length-1;!S&&H>0;)S=m.transformers[ee].mProps._mdf||S,H-=1,ee-=1;if(S)for(H=j-m.styles[A].lvl,ee=m.transformers.length-1;H>0;)W.multiply(m.transformers[ee].mProps.v),H-=1,ee-=1}else W=t;if(K=m.sh.paths,E=K._length,S){for(T="",b=0;b<E;b+=1)P=K.shapes[b],P&&P._length&&(T+=buildShapeString(P,P._length,P.c,W));m.caches[A]=T}else T=m.caches[A];m.styles[A].d+=p.hd===!0?"":T,m.styles[A]._mdf=S||m.styles[A]._mdf}}function l(p,m,y){var b=m.style;(m.c._mdf||y)&&b.pElem.setAttribute("fill","rgb("+bmFloor(m.c.v[0])+","+bmFloor(m.c.v[1])+","+bmFloor(m.c.v[2])+")"),(m.o._mdf||y)&&b.pElem.setAttribute("fill-opacity",m.o.v)}function u(p,m,y){c(p,m,y),d(p,m,y)}function c(p,m,y){var b=m.gf,E=m.g._hasOpacity,T=m.s.v,S=m.e.v;if(m.o._mdf||y){var P=p.ty==="gf"?"fill-opacity":"stroke-opacity";m.style.pElem.setAttribute(P,m.o.v)}if(m.s._mdf||y){var A=p.t===1?"x1":"cx",I=A==="x1"?"y1":"cy";b.setAttribute(A,T[0]),b.setAttribute(I,T[1]),E&&!m.g._collapsable&&(m.of.setAttribute(A,T[0]),m.of.setAttribute(I,T[1]))}var j,K,W,H;if(m.g._cmdf||y){j=m.cst;var ee=m.g.c;for(W=j.length,K=0;K<W;K+=1)H=j[K],H.setAttribute("offset",ee[K*4]+"%"),H.setAttribute("stop-color","rgb("+ee[K*4+1]+","+ee[K*4+2]+","+ee[K*4+3]+")")}if(E&&(m.g._omdf||y)){var ue=m.g.o;for(m.g._collapsable?j=m.cst:j=m.ost,W=j.length,K=0;K<W;K+=1)H=j[K],m.g._collapsable||H.setAttribute("offset",ue[K*2]+"%"),H.setAttribute("stop-opacity",ue[K*2+1])}if(p.t===1)(m.e._mdf||y)&&(b.setAttribute("x2",S[0]),b.setAttribute("y2",S[1]),E&&!m.g._collapsable&&(m.of.setAttribute("x2",S[0]),m.of.setAttribute("y2",S[1])));else{var de;if((m.s._mdf||m.e._mdf||y)&&(de=Math.sqrt(Math.pow(T[0]-S[0],2)+Math.pow(T[1]-S[1],2)),b.setAttribute("r",de),E&&!m.g._collapsable&&m.of.setAttribute("r",de)),m.s._mdf||m.e._mdf||m.h._mdf||m.a._mdf||y){de||(de=Math.sqrt(Math.pow(T[0]-S[0],2)+Math.pow(T[1]-S[1],2)));var fe=Math.atan2(S[1]-T[1],S[0]-T[0]),ae=m.h.v;ae>=1?ae=.99:ae<=-1&&(ae=-.99);var ce=de*ae,me=Math.cos(fe+m.a.v)*ce+T[0],te=Math.sin(fe+m.a.v)*ce+T[1];b.setAttribute("fx",me),b.setAttribute("fy",te),E&&!m.g._collapsable&&(m.of.setAttribute("fx",me),m.of.setAttribute("fy",te))}}}function d(p,m,y){var b=m.style,E=m.d;E&&(E._mdf||y)&&E.dashStr&&(b.pElem.setAttribute("stroke-dasharray",E.dashStr),b.pElem.setAttribute("stroke-dashoffset",E.dashoffset[0])),m.c&&(m.c._mdf||y)&&b.pElem.setAttribute("stroke","rgb("+bmFloor(m.c.v[0])+","+bmFloor(m.c.v[1])+","+bmFloor(m.c.v[2])+")"),(m.o._mdf||y)&&b.pElem.setAttribute("stroke-opacity",m.o.v),(m.w._mdf||y)&&(b.pElem.setAttribute("stroke-width",m.w.v),b.msElem&&b.msElem.setAttribute("stroke-width",m.w.v))}return r}();function SVGShapeElement(t,e,r){this.shapes=[],this.shapesData=t.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(t,e,r),this.prevViewData=[]}extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){var t,e=this.shapes.length,r,n,s=this.stylesList.length,a,o=[],l=!1;for(n=0;n<s;n+=1){for(a=this.stylesList[n],l=!1,o.length=0,t=0;t<e;t+=1)r=this.shapes[t],r.styles.indexOf(a)!==-1&&(o.push(r),l=r._isAnimated||l);o.length>1&&l&&this.setShapesAsAnimated(o)}},SVGShapeElement.prototype.setShapesAsAnimated=function(t){var e,r=t.length;for(e=0;e<r;e+=1)t[e].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(t,e){var r,n=new SVGStyleData(t,e),s=n.pElem;if(t.ty==="st")r=new SVGStrokeStyleData(this,t,n);else if(t.ty==="fl")r=new SVGFillStyleData(this,t,n);else if(t.ty==="gf"||t.ty==="gs"){var a=t.ty==="gf"?SVGGradientFillStyleData:SVGGradientStrokeStyleData;r=new a(this,t,n),this.globalData.defs.appendChild(r.gf),r.maskId&&(this.globalData.defs.appendChild(r.ms),this.globalData.defs.appendChild(r.of),s.setAttribute("mask","url("+getLocationHref()+"#"+r.maskId+")"))}else t.ty==="no"&&(r=new SVGNoStyleData(this,t,n));return(t.ty==="st"||t.ty==="gs")&&(s.setAttribute("stroke-linecap",lineCapEnum[t.lc||2]),s.setAttribute("stroke-linejoin",lineJoinEnum[t.lj||2]),s.setAttribute("fill-opacity","0"),t.lj===1&&s.setAttribute("stroke-miterlimit",t.ml)),t.r===2&&s.setAttribute("fill-rule","evenodd"),t.ln&&s.setAttribute("id",t.ln),t.cl&&s.setAttribute("class",t.cl),t.bm&&(s.style["mix-blend-mode"]=getBlendMode(t.bm)),this.stylesList.push(n),this.addToAnimatedContents(t,r),r},SVGShapeElement.prototype.createGroupElement=function(t){var e=new ShapeGroupData;return t.ln&&e.gr.setAttribute("id",t.ln),t.cl&&e.gr.setAttribute("class",t.cl),t.bm&&(e.gr.style["mix-blend-mode"]=getBlendMode(t.bm)),e},SVGShapeElement.prototype.createTransformElement=function(t,e){var r=TransformPropertyFactory.getTransformProperty(this,t,this),n=new SVGTransformData(r,r.o,e);return this.addToAnimatedContents(t,n),n},SVGShapeElement.prototype.createShapeElement=function(t,e,r){var n=4;t.ty==="rc"?n=5:t.ty==="el"?n=6:t.ty==="sr"&&(n=7);var s=ShapePropertyFactory.getShapeProp(this,t,n,this),a=new SVGShapeData(e,r,s);return this.shapes.push(a),this.addShapeToModifiers(a),this.addToAnimatedContents(t,a),a},SVGShapeElement.prototype.addToAnimatedContents=function(t,e){for(var r=0,n=this.animatedContents.length;r<n;){if(this.animatedContents[r].element===e)return;r+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(t),element:e,data:t})},SVGShapeElement.prototype.setElementStyles=function(t){var e=t.styles,r,n=this.stylesList.length;for(r=0;r<n;r+=1)e.indexOf(this.stylesList[r])===-1&&!this.stylesList[r].closed&&e.push(this.stylesList[r])},SVGShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var t,e=this.itemsData.length;for(t=0;t<e;t+=1)this.prevViewData[t]=this.itemsData[t];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),e=this.dynamicProperties.length,t=0;t<e;t+=1)this.dynamicProperties[t].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(t,e,r,n,s,a,o){var l=[].concat(a),u,c=t.length-1,d,p,m=[],y=[],b,E,T;for(u=c;u>=0;u-=1){if(T=this.searchProcessedElement(t[u]),T?e[u]=r[T-1]:t[u]._render=o,t[u].ty==="fl"||t[u].ty==="st"||t[u].ty==="gf"||t[u].ty==="gs"||t[u].ty==="no")T?e[u].style.closed=t[u].hd:e[u]=this.createStyleElement(t[u],s),t[u]._render&&e[u].style.pElem.parentNode!==n&&n.appendChild(e[u].style.pElem),m.push(e[u].style);else if(t[u].ty==="gr"){if(!T)e[u]=this.createGroupElement(t[u]);else for(p=e[u].it.length,d=0;d<p;d+=1)e[u].prevViewData[d]=e[u].it[d];this.searchShapes(t[u].it,e[u].it,e[u].prevViewData,e[u].gr,s+1,l,o),t[u]._render&&e[u].gr.parentNode!==n&&n.appendChild(e[u].gr)}else t[u].ty==="tr"?(T||(e[u]=this.createTransformElement(t[u],n)),b=e[u].transform,l.push(b)):t[u].ty==="sh"||t[u].ty==="rc"||t[u].ty==="el"||t[u].ty==="sr"?(T||(e[u]=this.createShapeElement(t[u],l,s)),this.setElementStyles(e[u])):t[u].ty==="tm"||t[u].ty==="rd"||t[u].ty==="ms"||t[u].ty==="pb"||t[u].ty==="zz"||t[u].ty==="op"?(T?(E=e[u],E.closed=!1):(E=ShapeModifiers.getModifier(t[u].ty),E.init(this,t[u]),e[u]=E,this.shapeModifiers.push(E)),y.push(E)):t[u].ty==="rp"&&(T?(E=e[u],E.closed=!0):(E=ShapeModifiers.getModifier(t[u].ty),e[u]=E,E.init(this,t,u,e),this.shapeModifiers.push(E),o=!1),y.push(E));this.addProcessedElement(t[u],u+1)}for(c=m.length,u=0;u<c;u+=1)m[u].closed=!0;for(c=y.length,u=0;u<c;u+=1)y[u].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){this.renderModifiers();var t,e=this.stylesList.length;for(t=0;t<e;t+=1)this.stylesList[t].reset();for(this.renderShape(),t=0;t<e;t+=1)(this.stylesList[t]._mdf||this._isFirstFrame)&&(this.stylesList[t].msElem&&(this.stylesList[t].msElem.setAttribute("d",this.stylesList[t].d),this.stylesList[t].d="M0 0"+this.stylesList[t].d),this.stylesList[t].pElem.setAttribute("d",this.stylesList[t].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){var t,e=this.animatedContents.length,r;for(t=0;t<e;t+=1)r=this.animatedContents[t],(this._isFirstFrame||r.element._isAnimated)&&r.data!==!0&&r.fn(r.data,r.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null};function LetterProps(t,e,r,n,s,a){this.o=t,this.sw=e,this.sc=r,this.fc=n,this.m=s,this.p=a,this._mdf={o:!0,sw:!!e,sc:!!r,fc:!!n,m:!0,p:!0}}LetterProps.prototype.update=function(t,e,r,n,s,a){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var o=!1;return this.o!==t&&(this.o=t,this._mdf.o=!0,o=!0),this.sw!==e&&(this.sw=e,this._mdf.sw=!0,o=!0),this.sc!==r&&(this.sc=r,this._mdf.sc=!0,o=!0),this.fc!==n&&(this.fc=n,this._mdf.fc=!0,o=!0),this.m!==s&&(this.m=s,this._mdf.m=!0,o=!0),a.length&&(this.p[0]!==a[0]||this.p[1]!==a[1]||this.p[4]!==a[4]||this.p[5]!==a[5]||this.p[12]!==a[12]||this.p[13]!==a[13])&&(this.p=a,this._mdf.p=!0,o=!0),o};function TextProperty(t,e){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,e.d&&e.d.sid&&(e.d=t.globalData.slotManager.getProp(e.d)),this.data=e,this.elem=t,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},TextProperty.prototype.setCurrentData=function(t){t.__complete||this.completeTextData(t),this.currentData=t,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(t){this.effectsSequence.push(t),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(t){if(!((this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)&&!t)){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var e=this.currentData,r=this.keysIndex;if(this.lock){this.setCurrentData(this.currentData);return}this.lock=!0,this._mdf=!1;var n,s=this.effectsSequence.length,a=t||this.data.d.k[this.keysIndex].s;for(n=0;n<s;n+=1)r!==this.keysIndex?a=this.effectsSequence[n](a,a.t):a=this.effectsSequence[n](this.currentData,a.t);e!==a&&this.setCurrentData(a),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}},TextProperty.prototype.getKeyframeValue=function(){for(var t=this.data.d.k,e=this.elem.comp.renderedFrame,r=0,n=t.length;r<=n-1&&!(r===n-1||t[r+1].t>e);)r+=1;return this.keysIndex!==r&&(this.keysIndex=r),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(t){for(var e=[],r=0,n=t.length,s,a,o=!1,l=!1,u="";r<n;)o=l,l=!1,s=t.charCodeAt(r),u=t.charAt(r),FontManager.isCombinedCharacter(s)?o=!0:s>=55296&&s<=56319?FontManager.isRegionalFlag(t,r)?u=t.substr(r,14):(a=t.charCodeAt(r+1),a>=56320&&a<=57343&&(FontManager.isModifier(s,a)?(u=t.substr(r,2),o=!0):FontManager.isFlagEmoji(t.substr(r,4))?u=t.substr(r,4):u=t.substr(r,2))):s>56319?(a=t.charCodeAt(r+1),FontManager.isVariationSelector(s)&&(o=!0)):FontManager.isZeroWidthJoiner(s)&&(o=!0,l=!0),o?(e[e.length-1]+=u,o=!1):e.push(u),r+=u.length;return e},TextProperty.prototype.completeTextData=function(t){t.__complete=!0;var e=this.elem.globalData.fontManager,r=this.data,n=[],s,a,o,l=0,u,c=r.m.g,d=0,p=0,m=0,y=[],b=0,E=0,T,S,P=e.getFontByName(t.f),A,I=0,j=getFontProperties(P);t.fWeight=j.weight,t.fStyle=j.style,t.finalSize=t.s,t.finalText=this.buildFinalText(t.t),a=t.finalText.length,t.finalLineHeight=t.lh;var K=t.tr/1e3*t.finalSize,W;if(t.sz)for(var H=!0,ee=t.sz[0],ue=t.sz[1],de,fe;H;){fe=this.buildFinalText(t.t),de=0,b=0,a=fe.length,K=t.tr/1e3*t.finalSize;var ae=-1;for(s=0;s<a;s+=1)W=fe[s].charCodeAt(0),o=!1,fe[s]===" "?ae=s:(W===13||W===3)&&(b=0,o=!0,de+=t.finalLineHeight||t.finalSize*1.2),e.chars?(A=e.getCharData(fe[s],P.fStyle,P.fFamily),I=o?0:A.w*t.finalSize/100):I=e.measureText(fe[s],t.f,t.finalSize),b+I>ee&&fe[s]!==" "?(ae===-1?a+=1:s=ae,de+=t.finalLineHeight||t.finalSize*1.2,fe.splice(s,ae===s?1:0,"\r"),ae=-1,b=0):(b+=I,b+=K);de+=P.ascent*t.finalSize/100,this.canResize&&t.finalSize>this.minimumFontSize&&ue<de?(t.finalSize-=1,t.finalLineHeight=t.finalSize*t.lh/t.s):(t.finalText=fe,a=t.finalText.length,H=!1)}b=-K,I=0;var ce=0,me;for(s=0;s<a;s+=1)if(o=!1,me=t.finalText[s],W=me.charCodeAt(0),W===13||W===3?(ce=0,y.push(b),E=b>E?b:E,b=-2*K,u="",o=!0,m+=1):u=me,e.chars?(A=e.getCharData(me,P.fStyle,e.getFontByName(t.f).fFamily),I=o?0:A.w*t.finalSize/100):I=e.measureText(u,t.f,t.finalSize),me===" "?ce+=I+K:(b+=I+K+ce,ce=0),n.push({l:I,an:I,add:d,n:o,anIndexes:[],val:u,line:m,animatorJustifyOffset:0}),c==2){if(d+=I,u===""||u===" "||s===a-1){for((u===""||u===" ")&&(d-=I);p<=s;)n[p].an=d,n[p].ind=l,n[p].extra=I,p+=1;l+=1,d=0}}else if(c==3){if(d+=I,u===""||s===a-1){for(u===""&&(d-=I);p<=s;)n[p].an=d,n[p].ind=l,n[p].extra=I,p+=1;d=0,l+=1}}else n[l].ind=l,n[l].extra=0,l+=1;if(t.l=n,E=b>E?b:E,y.push(b),t.sz)t.boxWidth=t.sz[0],t.justifyOffset=0;else switch(t.boxWidth=E,t.j){case 1:t.justifyOffset=-t.boxWidth;break;case 2:t.justifyOffset=-t.boxWidth/2;break;default:t.justifyOffset=0}t.lineWidths=y;var te=r.a,le,Z;S=te.length;var Y,he,oe=[];for(T=0;T<S;T+=1){for(le=te[T],le.a.sc&&(t.strokeColorAnim=!0),le.a.sw&&(t.strokeWidthAnim=!0),(le.a.fc||le.a.fh||le.a.fs||le.a.fb)&&(t.fillColorAnim=!0),he=0,Y=le.s.b,s=0;s<a;s+=1)Z=n[s],Z.anIndexes[T]=he,(Y==1&&Z.val!==""||Y==2&&Z.val!==""&&Z.val!==" "||Y==3&&(Z.n||Z.val==" "||s==a-1)||Y==4&&(Z.n||s==a-1))&&(le.s.rn===1&&oe.push(he),he+=1);r.a[T].s.totalChars=he;var ye=-1,Ee;if(le.s.rn===1)for(s=0;s<a;s+=1)Z=n[s],ye!=Z.anIndexes[T]&&(ye=Z.anIndexes[T],Ee=oe.splice(Math.floor(Math.random()*oe.length),1)[0]),Z.anIndexes[T]=Ee}t.yOffset=t.finalLineHeight||t.finalSize*1.2,t.ls=t.ls||0,t.ascent=P.ascent*t.finalSize/100},TextProperty.prototype.updateDocumentData=function(t,e){e=e===void 0?this.keysIndex:e;var r=this.copyData({},this.data.d.k[e].s);r=this.copyData(r,t),this.data.d.k[e].s=r,this.recalculate(e),this.setCurrentData(r),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(t){var e=this.data.d.k[t].s;e.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(e)},TextProperty.prototype.canResizeFont=function(t){this.canResize=t,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(t){this.minimumFontSize=Math.floor(t)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var TextSelectorProp=function(){var t=Math.max,e=Math.min,r=Math.floor;function n(a,o){this._currentTextLength=-1,this.k=!1,this.data=o,this.elem=a,this.comp=a.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(a),this.s=PropertyFactory.getProp(a,o.s||{k:0},0,0,this),"e"in o?this.e=PropertyFactory.getProp(a,o.e,0,0,this):this.e={v:100},this.o=PropertyFactory.getProp(a,o.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(a,o.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(a,o.ne||{k:0},0,0,this),this.sm=PropertyFactory.getProp(a,o.sm||{k:100},0,0,this),this.a=PropertyFactory.getProp(a,o.a,0,.01,this),this.dynamicProperties.length||this.getValue()}n.prototype={getMult:function(o){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var l=0,u=0,c=1,d=1;this.ne.v>0?l=this.ne.v/100:u=-this.ne.v/100,this.xe.v>0?c=1-this.xe.v/100:d=1+this.xe.v/100;var p=BezierFactory.getBezierEasing(l,u,c,d).get,m=0,y=this.finalS,b=this.finalE,E=this.data.sh;if(E===2)b===y?m=o>=b?1:0:m=t(0,e(.5/(b-y)+(o-y)/(b-y),1)),m=p(m);else if(E===3)b===y?m=o>=b?0:1:m=1-t(0,e(.5/(b-y)+(o-y)/(b-y),1)),m=p(m);else if(E===4)b===y?m=0:(m=t(0,e(.5/(b-y)+(o-y)/(b-y),1)),m<.5?m*=2:m=1-2*(m-.5)),m=p(m);else if(E===5){if(b===y)m=0;else{var T=b-y;o=e(t(0,o+.5-y),b-y);var S=-T/2+o,P=T/2;m=Math.sqrt(1-S*S/(P*P))}m=p(m)}else E===6?(b===y?m=0:(o=e(t(0,o+.5-y),b-y),m=(1+Math.cos(Math.PI+Math.PI*2*o/(b-y)))/2),m=p(m)):(o>=r(y)&&(o-y<0?m=t(0,e(e(b,1)-(y-o),1)):m=t(0,e(b-o,1))),m=p(m));if(this.sm.v!==100){var A=this.sm.v*.01;A===0&&(A=1e-8);var I=.5-A*.5;m<I?m=0:(m=(m-I)/A,m>1&&(m=1))}return m*this.a.v},getValue:function(o){this.iterateDynamicProperties(),this._mdf=o||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,o&&this.data.r===2&&(this.e.v=this._currentTextLength);var l=this.data.r===2?1:100/this.data.totalChars,u=this.o.v/l,c=this.s.v/l+u,d=this.e.v/l+u;if(c>d){var p=c;c=d,d=p}this.finalS=c,this.finalE=d}},extendPrototype([DynamicPropertyContainer],n);function s(a,o,l){return new n(a,o)}return{getTextSelectorProp:s}}();function TextAnimatorDataProperty(t,e,r){var n={propType:!1},s=PropertyFactory.getProp,a=e.a;this.a={r:a.r?s(t,a.r,0,degToRads,r):n,rx:a.rx?s(t,a.rx,0,degToRads,r):n,ry:a.ry?s(t,a.ry,0,degToRads,r):n,sk:a.sk?s(t,a.sk,0,degToRads,r):n,sa:a.sa?s(t,a.sa,0,degToRads,r):n,s:a.s?s(t,a.s,1,.01,r):n,a:a.a?s(t,a.a,1,0,r):n,o:a.o?s(t,a.o,0,.01,r):n,p:a.p?s(t,a.p,1,0,r):n,sw:a.sw?s(t,a.sw,0,0,r):n,sc:a.sc?s(t,a.sc,1,0,r):n,fc:a.fc?s(t,a.fc,1,0,r):n,fh:a.fh?s(t,a.fh,0,0,r):n,fs:a.fs?s(t,a.fs,0,.01,r):n,fb:a.fb?s(t,a.fb,0,.01,r):n,t:a.t?s(t,a.t,0,0,r):n},this.s=TextSelectorProp.getTextSelectorProp(t,e.s,r),this.s.t=e.s.t}function TextAnimatorProperty(t,e,r){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=t,this._renderType=e,this._elem=r,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(r)}TextAnimatorProperty.prototype.searchProperties=function(){var t,e=this._textData.a.length,r,n=PropertyFactory.getProp;for(t=0;t<e;t+=1)r=this._textData.a[t],this._animatorsData[t]=new TextAnimatorDataProperty(this._elem,r,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:n(this._elem,this._textData.p.a,0,0,this),f:n(this._elem,this._textData.p.f,0,0,this),l:n(this._elem,this._textData.p.l,0,0,this),r:n(this._elem,this._textData.p.r,0,0,this),p:n(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=n(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(t,e){if(this.lettersChangedFlag=e,!(!this._mdf&&!this._isFirstFrame&&!e&&(!this._hasMaskedPath||!this._pathData.m._mdf))){this._isFirstFrame=!1;var r=this._moreOptions.alignment.v,n=this._animatorsData,s=this._textData,a=this.mHelper,o=this._renderType,l=this.renderedLetters.length,u,c,d,p,m=t.l,y,b,E,T,S,P,A,I,j,K,W,H,ee,ue,de;if(this._hasMaskedPath){if(de=this._pathData.m,!this._pathData.n||this._pathData._mdf){var fe=de.v;this._pathData.r.v&&(fe=fe.reverse()),y={tLength:0,segments:[]},p=fe._length-1;var ae;for(H=0,d=0;d<p;d+=1)ae=bez.buildBezierData(fe.v[d],fe.v[d+1],[fe.o[d][0]-fe.v[d][0],fe.o[d][1]-fe.v[d][1]],[fe.i[d+1][0]-fe.v[d+1][0],fe.i[d+1][1]-fe.v[d+1][1]]),y.tLength+=ae.segmentLength,y.segments.push(ae),H+=ae.segmentLength;d=p,de.v.c&&(ae=bez.buildBezierData(fe.v[d],fe.v[0],[fe.o[d][0]-fe.v[d][0],fe.o[d][1]-fe.v[d][1]],[fe.i[0][0]-fe.v[0][0],fe.i[0][1]-fe.v[0][1]]),y.tLength+=ae.segmentLength,y.segments.push(ae),H+=ae.segmentLength),this._pathData.pi=y}if(y=this._pathData.pi,b=this._pathData.f.v,A=0,P=1,T=0,S=!0,K=y.segments,b<0&&de.v.c)for(y.tLength<Math.abs(b)&&(b=-Math.abs(b)%y.tLength),A=K.length-1,j=K[A].points,P=j.length-1;b<0;)b+=j[P].partialLength,P-=1,P<0&&(A-=1,j=K[A].points,P=j.length-1);j=K[A].points,I=j[P-1],E=j[P],W=E.partialLength}p=m.length,u=0,c=0;var ce=t.finalSize*1.2*.714,me=!0,te,le,Z,Y,he;Y=n.length;var oe,ye=-1,Ee,Ae,je,Te=b,Ve=A,Pe=P,Ce=-1,De,ze,Et,Ze,Ue,qt,or,Lt,rt="",lr=this.defaultPropsArray,ir;if(t.j===2||t.j===1){var er=0,xr=0,br=t.j===2?-.5:-1,Pr=0,zr=!0;for(d=0;d<p;d+=1)if(m[d].n){for(er&&(er+=xr);Pr<d;)m[Pr].animatorJustifyOffset=er,Pr+=1;er=0,zr=!0}else{for(Z=0;Z<Y;Z+=1)te=n[Z].a,te.t.propType&&(zr&&t.j===2&&(xr+=te.t.v*br),le=n[Z].s,oe=le.getMult(m[d].anIndexes[Z],s.a[Z].s.totalChars),oe.length?er+=te.t.v*oe[0]*br:er+=te.t.v*oe*br);zr=!1}for(er&&(er+=xr);Pr<d;)m[Pr].animatorJustifyOffset=er,Pr+=1}for(d=0;d<p;d+=1){if(a.reset(),De=1,m[d].n)u=0,c+=t.yOffset,c+=me?1:0,b=Te,me=!1,this._hasMaskedPath&&(A=Ve,P=Pe,j=K[A].points,I=j[P-1],E=j[P],W=E.partialLength,T=0),rt="",Lt="",qt="",ir="",lr=this.defaultPropsArray;else{if(this._hasMaskedPath){if(Ce!==m[d].line){switch(t.j){case 1:b+=H-t.lineWidths[m[d].line];break;case 2:b+=(H-t.lineWidths[m[d].line])/2;break}Ce=m[d].line}ye!==m[d].ind&&(m[ye]&&(b+=m[ye].extra),b+=m[d].an/2,ye=m[d].ind),b+=r[0]*m[d].an*.005;var pr=0;for(Z=0;Z<Y;Z+=1)te=n[Z].a,te.p.propType&&(le=n[Z].s,oe=le.getMult(m[d].anIndexes[Z],s.a[Z].s.totalChars),oe.length?pr+=te.p.v[0]*oe[0]:pr+=te.p.v[0]*oe),te.a.propType&&(le=n[Z].s,oe=le.getMult(m[d].anIndexes[Z],s.a[Z].s.totalChars),oe.length?pr+=te.a.v[0]*oe[0]:pr+=te.a.v[0]*oe);for(S=!0,this._pathData.a.v&&(b=m[0].an*.5+(H-this._pathData.f.v-m[0].an*.5-m[m.length-1].an*.5)*ye/(p-1),b+=this._pathData.f.v);S;)T+W>=b+pr||!j?(ee=(b+pr-T)/E.partialLength,Ae=I.point[0]+(E.point[0]-I.point[0])*ee,je=I.point[1]+(E.point[1]-I.point[1])*ee,a.translate(-r[0]*m[d].an*.005,-(r[1]*ce)*.01),S=!1):j&&(T+=E.partialLength,P+=1,P>=j.length&&(P=0,A+=1,K[A]?j=K[A].points:de.v.c?(P=0,A=0,j=K[A].points):(T-=E.partialLength,j=null)),j&&(I=E,E=j[P],W=E.partialLength));Ee=m[d].an/2-m[d].add,a.translate(-Ee,0,0)}else Ee=m[d].an/2-m[d].add,a.translate(-Ee,0,0),a.translate(-r[0]*m[d].an*.005,-r[1]*ce*.01,0);for(Z=0;Z<Y;Z+=1)te=n[Z].a,te.t.propType&&(le=n[Z].s,oe=le.getMult(m[d].anIndexes[Z],s.a[Z].s.totalChars),(u!==0||t.j!==0)&&(this._hasMaskedPath?oe.length?b+=te.t.v*oe[0]:b+=te.t.v*oe:oe.length?u+=te.t.v*oe[0]:u+=te.t.v*oe));for(t.strokeWidthAnim&&(Et=t.sw||0),t.strokeColorAnim&&(t.sc?ze=[t.sc[0],t.sc[1],t.sc[2]]:ze=[0,0,0]),t.fillColorAnim&&t.fc&&(Ze=[t.fc[0],t.fc[1],t.fc[2]]),Z=0;Z<Y;Z+=1)te=n[Z].a,te.a.propType&&(le=n[Z].s,oe=le.getMult(m[d].anIndexes[Z],s.a[Z].s.totalChars),oe.length?a.translate(-te.a.v[0]*oe[0],-te.a.v[1]*oe[1],te.a.v[2]*oe[2]):a.translate(-te.a.v[0]*oe,-te.a.v[1]*oe,te.a.v[2]*oe));for(Z=0;Z<Y;Z+=1)te=n[Z].a,te.s.propType&&(le=n[Z].s,oe=le.getMult(m[d].anIndexes[Z],s.a[Z].s.totalChars),oe.length?a.scale(1+(te.s.v[0]-1)*oe[0],1+(te.s.v[1]-1)*oe[1],1):a.scale(1+(te.s.v[0]-1)*oe,1+(te.s.v[1]-1)*oe,1));for(Z=0;Z<Y;Z+=1){if(te=n[Z].a,le=n[Z].s,oe=le.getMult(m[d].anIndexes[Z],s.a[Z].s.totalChars),te.sk.propType&&(oe.length?a.skewFromAxis(-te.sk.v*oe[0],te.sa.v*oe[1]):a.skewFromAxis(-te.sk.v*oe,te.sa.v*oe)),te.r.propType&&(oe.length?a.rotateZ(-te.r.v*oe[2]):a.rotateZ(-te.r.v*oe)),te.ry.propType&&(oe.length?a.rotateY(te.ry.v*oe[1]):a.rotateY(te.ry.v*oe)),te.rx.propType&&(oe.length?a.rotateX(te.rx.v*oe[0]):a.rotateX(te.rx.v*oe)),te.o.propType&&(oe.length?De+=(te.o.v*oe[0]-De)*oe[0]:De+=(te.o.v*oe-De)*oe),t.strokeWidthAnim&&te.sw.propType&&(oe.length?Et+=te.sw.v*oe[0]:Et+=te.sw.v*oe),t.strokeColorAnim&&te.sc.propType)for(Ue=0;Ue<3;Ue+=1)oe.length?ze[Ue]+=(te.sc.v[Ue]-ze[Ue])*oe[0]:ze[Ue]+=(te.sc.v[Ue]-ze[Ue])*oe;if(t.fillColorAnim&&t.fc){if(te.fc.propType)for(Ue=0;Ue<3;Ue+=1)oe.length?Ze[Ue]+=(te.fc.v[Ue]-Ze[Ue])*oe[0]:Ze[Ue]+=(te.fc.v[Ue]-Ze[Ue])*oe;te.fh.propType&&(oe.length?Ze=addHueToRGB(Ze,te.fh.v*oe[0]):Ze=addHueToRGB(Ze,te.fh.v*oe)),te.fs.propType&&(oe.length?Ze=addSaturationToRGB(Ze,te.fs.v*oe[0]):Ze=addSaturationToRGB(Ze,te.fs.v*oe)),te.fb.propType&&(oe.length?Ze=addBrightnessToRGB(Ze,te.fb.v*oe[0]):Ze=addBrightnessToRGB(Ze,te.fb.v*oe))}}for(Z=0;Z<Y;Z+=1)te=n[Z].a,te.p.propType&&(le=n[Z].s,oe=le.getMult(m[d].anIndexes[Z],s.a[Z].s.totalChars),this._hasMaskedPath?oe.length?a.translate(0,te.p.v[1]*oe[0],-te.p.v[2]*oe[1]):a.translate(0,te.p.v[1]*oe,-te.p.v[2]*oe):oe.length?a.translate(te.p.v[0]*oe[0],te.p.v[1]*oe[1],-te.p.v[2]*oe[2]):a.translate(te.p.v[0]*oe,te.p.v[1]*oe,-te.p.v[2]*oe));if(t.strokeWidthAnim&&(qt=Et<0?0:Et),t.strokeColorAnim&&(or="rgb("+Math.round(ze[0]*255)+","+Math.round(ze[1]*255)+","+Math.round(ze[2]*255)+")"),t.fillColorAnim&&t.fc&&(Lt="rgb("+Math.round(Ze[0]*255)+","+Math.round(Ze[1]*255)+","+Math.round(Ze[2]*255)+")"),this._hasMaskedPath){if(a.translate(0,-t.ls),a.translate(0,r[1]*ce*.01+c,0),this._pathData.p.v){ue=(E.point[1]-I.point[1])/(E.point[0]-I.point[0]);var dr=Math.atan(ue)*180/Math.PI;E.point[0]<I.point[0]&&(dr+=180),a.rotate(-dr*Math.PI/180)}a.translate(Ae,je,0),b-=r[0]*m[d].an*.005,m[d+1]&&ye!==m[d+1].ind&&(b+=m[d].an/2,b+=t.tr*.001*t.finalSize)}else{switch(a.translate(u,c,0),t.ps&&a.translate(t.ps[0],t.ps[1]+t.ascent,0),t.j){case 1:a.translate(m[d].animatorJustifyOffset+t.justifyOffset+(t.boxWidth-t.lineWidths[m[d].line]),0,0);break;case 2:a.translate(m[d].animatorJustifyOffset+t.justifyOffset+(t.boxWidth-t.lineWidths[m[d].line])/2,0,0);break}a.translate(0,-t.ls),a.translate(Ee,0,0),a.translate(r[0]*m[d].an*.005,r[1]*ce*.01,0),u+=m[d].l+t.tr*.001*t.finalSize}o==="html"?rt=a.toCSS():o==="svg"?rt=a.to2dCSS():lr=[a.props[0],a.props[1],a.props[2],a.props[3],a.props[4],a.props[5],a.props[6],a.props[7],a.props[8],a.props[9],a.props[10],a.props[11],a.props[12],a.props[13],a.props[14],a.props[15]],ir=De}l<=d?(he=new LetterProps(ir,qt,or,Lt,rt,lr),this.renderedLetters.push(he),l+=1,this.lettersChangedFlag=!0):(he=this.renderedLetters[d],this.lettersChangedFlag=he.update(ir,qt,or,Lt,rt,lr)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty);function ITextElement(){}ITextElement.prototype.initElement=function(t,e,r){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(t,e,r),this.textProperty=new TextProperty(this,t.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(t.t,this.renderType,this),this.initTransform(t,e,r),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(t){this._mdf=!1,this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange)},ITextElement.prototype.createPathShape=function(t,e){var r,n=e.length,s,a="";for(r=0;r<n;r+=1)e[r].ty==="sh"&&(s=e[r].ks.k,a+=buildShapeString(s,s.i.length,!0,t));return a},ITextElement.prototype.updateDocumentData=function(t,e){this.textProperty.updateDocumentData(t,e)},ITextElement.prototype.canResizeFont=function(t){this.textProperty.canResizeFont(t)},ITextElement.prototype.setMinimumFontSize=function(t){this.textProperty.setMinimumFontSize(t)},ITextElement.prototype.applyTextPropertiesToMatrix=function(t,e,r,n,s){switch(t.ps&&e.translate(t.ps[0],t.ps[1]+t.ascent,0),e.translate(0,-t.ls,0),t.j){case 1:e.translate(t.justifyOffset+(t.boxWidth-t.lineWidths[r]),0,0);break;case 2:e.translate(t.justifyOffset+(t.boxWidth-t.lineWidths[r])/2,0,0);break}e.translate(n,s,0)},ITextElement.prototype.buildColor=function(t){return"rgb("+Math.round(t[0]*255)+","+Math.round(t[1]*255)+","+Math.round(t[2]*255)+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){},ITextElement.prototype.validateText=function(){(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)};var emptyShapeData={shapes:[]};function SVGTextLottieElement(t,e,r){this.textSpans=[],this.renderType="svg",this.initElement(t,e,r)}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextLottieElement.prototype.buildTextContents=function(t){for(var e=0,r=t.length,n=[],s="";e<r;)t[e]==="\r"||t[e]===""?(n.push(s),s=""):s+=t[e],e+=1;return n.push(s),n},SVGTextLottieElement.prototype.buildShapeData=function(t,e){if(t.shapes&&t.shapes.length){var r=t.shapes[0];if(r.it){var n=r.it[r.it.length-1];n.s&&(n.s.k[0]=e,n.s.k[1]=e)}}return t},SVGTextLottieElement.prototype.buildNewText=function(){this.addDynamicProperty(this);var t,e,r=this.textProperty.currentData;this.renderedLetters=createSizedArray(r?r.l.length:0),r.fc?this.layerElement.setAttribute("fill",this.buildColor(r.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),r.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(r.sc)),this.layerElement.setAttribute("stroke-width",r.sw)),this.layerElement.setAttribute("font-size",r.finalSize);var n=this.globalData.fontManager.getFontByName(r.f);if(n.fClass)this.layerElement.setAttribute("class",n.fClass);else{this.layerElement.setAttribute("font-family",n.fFamily);var s=r.fWeight,a=r.fStyle;this.layerElement.setAttribute("font-style",a),this.layerElement.setAttribute("font-weight",s)}this.layerElement.setAttribute("aria-label",r.t);var o=r.l||[],l=!!this.globalData.fontManager.chars;e=o.length;var u,c=this.mHelper,d="",p=this.data.singleShape,m=0,y=0,b=!0,E=r.tr*.001*r.finalSize;if(p&&!l&&!r.sz){var T=this.textContainer,S="start";switch(r.j){case 1:S="end";break;case 2:S="middle";break;default:S="start";break}T.setAttribute("text-anchor",S),T.setAttribute("letter-spacing",E);var P=this.buildTextContents(r.finalText);for(e=P.length,y=r.ps?r.ps[1]+r.ascent:0,t=0;t<e;t+=1)u=this.textSpans[t].span||createNS("tspan"),u.textContent=P[t],u.setAttribute("x",0),u.setAttribute("y",y),u.style.display="inherit",T.appendChild(u),this.textSpans[t]||(this.textSpans[t]={span:null,glyph:null}),this.textSpans[t].span=u,y+=r.finalLineHeight;this.layerElement.appendChild(T)}else{var A=this.textSpans.length,I;for(t=0;t<e;t+=1){if(this.textSpans[t]||(this.textSpans[t]={span:null,childSpan:null,glyph:null}),!l||!p||t===0){if(u=A>t?this.textSpans[t].span:createNS(l?"g":"text"),A<=t){if(u.setAttribute("stroke-linecap","butt"),u.setAttribute("stroke-linejoin","round"),u.setAttribute("stroke-miterlimit","4"),this.textSpans[t].span=u,l){var j=createNS("g");u.appendChild(j),this.textSpans[t].childSpan=j}this.textSpans[t].span=u,this.layerElement.appendChild(u)}u.style.display="inherit"}if(c.reset(),p&&(o[t].n&&(m=-E,y+=r.yOffset,y+=b?1:0,b=!1),this.applyTextPropertiesToMatrix(r,c,o[t].line,m,y),m+=o[t].l||0,m+=E),l){I=this.globalData.fontManager.getCharData(r.finalText[t],n.fStyle,this.globalData.fontManager.getFontByName(r.f).fFamily);var K;if(I.t===1)K=new SVGCompElement(I.data,this.globalData,this);else{var W=emptyShapeData;I.data&&I.data.shapes&&(W=this.buildShapeData(I.data,r.finalSize)),K=new SVGShapeElement(W,this.globalData,this)}if(this.textSpans[t].glyph){var H=this.textSpans[t].glyph;this.textSpans[t].childSpan.removeChild(H.layerElement),H.destroy()}this.textSpans[t].glyph=K,K._debug=!0,K.prepareFrame(0),K.renderFrame(),this.textSpans[t].childSpan.appendChild(K.layerElement),I.t===1&&this.textSpans[t].childSpan.setAttribute("transform","scale("+r.finalSize/100+","+r.finalSize/100+")")}else p&&u.setAttribute("transform","translate("+c.props[12]+","+c.props[13]+")"),u.textContent=o[t].val,u.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve")}p&&u&&u.setAttribute("d",d)}for(;t<this.textSpans.length;)this.textSpans[t].span.style.display="none",t+=1;this._sizeChanged=!0},SVGTextLottieElement.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var t=this.layerElement.getBBox();this.bbox={top:t.y,left:t.x,width:t.width,height:t.height}}return this.bbox},SVGTextLottieElement.prototype.getValue=function(){var t,e=this.textSpans.length,r;for(this.renderedFrame=this.comp.renderedFrame,t=0;t<e;t+=1)r=this.textSpans[t].glyph,r&&(r.prepareFrame(this.comp.renderedFrame-this.data.st),r._mdf&&(this._mdf=!0))},SVGTextLottieElement.prototype.renderInnerContent=function(){if(this.validateText(),(!this.data.singleShape||this._mdf)&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){this._sizeChanged=!0;var t,e,r=this.textAnimator.renderedLetters,n=this.textProperty.currentData.l;e=n.length;var s,a,o;for(t=0;t<e;t+=1)n[t].n||(s=r[t],a=this.textSpans[t].span,o=this.textSpans[t].glyph,o&&o.renderFrame(),s._mdf.m&&a.setAttribute("transform",s.m),s._mdf.o&&a.setAttribute("opacity",s.o),s._mdf.sw&&a.setAttribute("stroke-width",s.sw),s._mdf.sc&&a.setAttribute("stroke",s.sc),s._mdf.fc&&a.setAttribute("fill",s.fc))}};function ISolidElement(t,e,r){this.initElement(t,e,r)}extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var t=createNS("rect");t.setAttribute("width",this.data.sw),t.setAttribute("height",this.data.sh),t.setAttribute("fill",this.data.sc),this.layerElement.appendChild(t)};function NullElement(t,e,r){this.initFrame(),this.initBaseData(t,e,r),this.initFrame(),this.initTransform(t,e,r),this.initHierarchy()}NullElement.prototype.prepareFrame=function(t){this.prepareProperties(t,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement);function SVGRendererBase(){}extendPrototype([BaseRenderer],SVGRendererBase),SVGRendererBase.prototype.createNull=function(t){return new NullElement(t,this.globalData,this)},SVGRendererBase.prototype.createShape=function(t){return new SVGShapeElement(t,this.globalData,this)},SVGRendererBase.prototype.createText=function(t){return new SVGTextLottieElement(t,this.globalData,this)},SVGRendererBase.prototype.createImage=function(t){return new IImageElement(t,this.globalData,this)},SVGRendererBase.prototype.createSolid=function(t){return new ISolidElement(t,this.globalData,this)},SVGRendererBase.prototype.configAnimation=function(t){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.svgElement.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+t.w+" "+t.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",t.w),this.svgElement.setAttribute("height",t.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.width&&this.svgElement.setAttribute("width",this.renderConfig.width),this.renderConfig.height&&this.svgElement.setAttribute("height",this.renderConfig.height),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),this.renderConfig.focusable!==void 0&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var e=this.globalData.defs;this.setupGlobalData(t,e),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=t;var r=createNS("clipPath"),n=createNS("rect");n.setAttribute("width",t.w),n.setAttribute("height",t.h),n.setAttribute("x",0),n.setAttribute("y",0);var s=createElementID();r.setAttribute("id",s),r.appendChild(n),this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+s+")"),e.appendChild(r),this.layers=t.layers,this.elements=createSizedArray(t.layers.length)},SVGRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var t,e=this.layers?this.layers.length:0;for(t=0;t<e;t+=1)this.elements[t]&&this.elements[t].destroy&&this.elements[t].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRendererBase.prototype.updateContainerSize=function(){},SVGRendererBase.prototype.findIndexByInd=function(t){var e=0,r=this.layers.length;for(e=0;e<r;e+=1)if(this.layers[e].ind===t)return e;return-1},SVGRendererBase.prototype.buildItem=function(t){var e=this.elements;if(!(e[t]||this.layers[t].ty===99)){e[t]=!0;var r=this.createItem(this.layers[t]);if(e[t]=r,getExpressionsPlugin()&&(this.layers[t].ty===0&&this.globalData.projectInterface.registerComposition(r),r.initExpressions()),this.appendElementInPos(r,t),this.layers[t].tt){var n="tp"in this.layers[t]?this.findIndexByInd(this.layers[t].tp):t-1;if(n===-1)return;if(!this.elements[n]||this.elements[n]===!0)this.buildItem(n),this.addPendingElement(r);else{var s=e[n],a=s.getMatte(this.layers[t].tt);r.setMatte(a)}}}},SVGRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var t=this.pendingElements.pop();if(t.checkParenting(),t.data.tt)for(var e=0,r=this.elements.length;e<r;){if(this.elements[e]===t){var n="tp"in t.data?this.findIndexByInd(t.data.tp):e-1,s=this.elements[n],a=s.getMatte(this.layers[e].tt);t.setMatte(a);break}e+=1}}},SVGRendererBase.prototype.renderFrame=function(t){if(!(this.renderedFrame===t||this.destroyed)){t===null?t=this.renderedFrame:this.renderedFrame=t,this.globalData.frameNum=t,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=t,this.globalData._mdf=!1;var e,r=this.layers.length;for(this.completeLayers||this.checkLayers(t),e=r-1;e>=0;e-=1)(this.completeLayers||this.elements[e])&&this.elements[e].prepareFrame(t-this.layers[e].st);if(this.globalData._mdf)for(e=0;e<r;e+=1)(this.completeLayers||this.elements[e])&&this.elements[e].renderFrame()}},SVGRendererBase.prototype.appendElementInPos=function(t,e){var r=t.getBaseElement();if(r){for(var n=0,s;n<e;)this.elements[n]&&this.elements[n]!==!0&&this.elements[n].getBaseElement()&&(s=this.elements[n].getBaseElement()),n+=1;s?this.layerElement.insertBefore(r,s):this.layerElement.appendChild(r)}},SVGRendererBase.prototype.hide=function(){this.layerElement.style.display="none"},SVGRendererBase.prototype.show=function(){this.layerElement.style.display="block"};function ICompElement(){}extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(t,e,r){this.initFrame(),this.initBaseData(t,e,r),this.initTransform(t,e,r),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),(this.data.xt||!e.progressiveLoad)&&this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(t){if(this._mdf=!1,this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange),!(!this.isInRange&&!this.data.xt)){if(this.tm._placeholder)this.renderedFrame=t/this.data.sr;else{var e=this.tm.v;e===this.data.op&&(e=this.data.op-1),this.renderedFrame=e}var r,n=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),r=n-1;r>=0;r-=1)(this.completeLayers||this.elements[r])&&(this.elements[r].prepareFrame(this.renderedFrame-this.layers[r].st),this.elements[r]._mdf&&(this._mdf=!0))}},ICompElement.prototype.renderInnerContent=function(){var t,e=this.layers.length;for(t=0;t<e;t+=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()},ICompElement.prototype.setElements=function(t){this.elements=t},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){var t,e=this.layers.length;for(t=0;t<e;t+=1)this.elements[t]&&this.elements[t].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()};function SVGCompElement(t,e,r){this.layers=t.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(t,e,r),this.tm=t.tm?PropertyFactory.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0}}extendPrototype([SVGRendererBase,ICompElement,SVGBaseElement],SVGCompElement),SVGCompElement.prototype.createComp=function(t){return new SVGCompElement(t,this.globalData,this)};function SVGRenderer(t,e){this.animationItem=t,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var r="";if(e&&e.title){var n=createNS("title"),s=createElementID();n.setAttribute("id",s),n.textContent=e.title,this.svgElement.appendChild(n),r+=s}if(e&&e.description){var a=createNS("desc"),o=createElementID();a.setAttribute("id",o),a.textContent=e.description,this.svgElement.appendChild(a),r+=" "+o}r&&this.svgElement.setAttribute("aria-labelledby",r);var l=createNS("defs");this.svgElement.appendChild(l);var u=createNS("g");this.svgElement.appendChild(u),this.layerElement=u,this.renderConfig={preserveAspectRatio:e&&e.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:e&&e.contentVisibility||"visible",progressiveLoad:e&&e.progressiveLoad||!1,hideOnTransparent:!(e&&e.hideOnTransparent===!1),viewBoxOnly:e&&e.viewBoxOnly||!1,viewBoxSize:e&&e.viewBoxSize||!1,className:e&&e.className||"",id:e&&e.id||"",focusable:e&&e.focusable,filterSize:{width:e&&e.filterSize&&e.filterSize.width||"100%",height:e&&e.filterSize&&e.filterSize.height||"100%",x:e&&e.filterSize&&e.filterSize.x||"0%",y:e&&e.filterSize&&e.filterSize.y||"0%"},width:e&&e.width,height:e&&e.height,runExpressions:!e||e.runExpressions===void 0||e.runExpressions},this.globalData={_mdf:!1,frameNum:-1,defs:l,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}extendPrototype([SVGRendererBase],SVGRenderer),SVGRenderer.prototype.createComp=function(t){return new SVGCompElement(t,this.globalData,this)};function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}ShapeTransformManager.prototype={addTransformSequence:function(e){var r,n=e.length,s="_";for(r=0;r<n;r+=1)s+=e[r].transform.key+"_";var a=this.sequences[s];return a||(a={transforms:[].concat(e),finalTransform:new Matrix,_mdf:!1},this.sequences[s]=a,this.sequenceList.push(a)),a},processSequence:function(e,r){for(var n=0,s=e.transforms.length,a=r;n<s&&!r;){if(e.transforms[n].transform.mProps._mdf){a=!0;break}n+=1}if(a)for(e.finalTransform.reset(),n=s-1;n>=0;n-=1)e.finalTransform.multiply(e.transforms[n].transform.mProps.v);e._mdf=a},processSequences:function(e){var r,n=this.sequenceList.length;for(r=0;r<n;r+=1)this.processSequence(this.sequenceList[r],e)},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count}};var lumaLoader=function(){var e="__lottie_element_luma_buffer",r=null,n=null,s=null;function a(){var u=createNS("svg"),c=createNS("filter"),d=createNS("feColorMatrix");return c.setAttribute("id",e),d.setAttribute("type","matrix"),d.setAttribute("color-interpolation-filters","sRGB"),d.setAttribute("values","0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0"),c.appendChild(d),u.appendChild(c),u.setAttribute("id",e+"_svg"),featureSupport.svgLumaHidden&&(u.style.display="none"),u}function o(){r||(s=a(),document.body.appendChild(s),r=createTag("canvas"),n=r.getContext("2d"),n.filter="url(#"+e+")",n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1))}function l(u){return r||o(),r.width=u.width,r.height=u.height,n.filter="url(#"+e+")",r}return{load:o,get:l}};function createCanvas(t,e){if(featureSupport.offscreenCanvas)return new OffscreenCanvas(t,e);var r=createTag("canvas");return r.width=t,r.height=e,r}var assetLoader=function(){return{loadLumaCanvas:lumaLoader.load,getLumaCanvas:lumaLoader.get,createCanvas}}(),registeredEffects={};function CVEffects(t){var e,r=t.data.ef?t.data.ef.length:0;this.filters=[];var n;for(e=0;e<r;e+=1){n=null;var s=t.data.ef[e].ty;if(registeredEffects[s]){var a=registeredEffects[s].effect;n=new a(t.effectsManager.effectElements[e],t)}n&&this.filters.push(n)}this.filters.length&&t.addRenderableComponent(this)}CVEffects.prototype.renderFrame=function(t){var e,r=this.filters.length;for(e=0;e<r;e+=1)this.filters[e].renderFrame(t)},CVEffects.prototype.getEffects=function(t){var e,r=this.filters.length,n=[];for(e=0;e<r;e+=1)this.filters[e].type===t&&n.push(this.filters[e]);return n};function registerEffect(t,e){registeredEffects[t]={effect:e}}function CVMaskElement(t,e){this.data=t,this.element=e,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);var r,n=this.masksProperties.length,s=!1;for(r=0;r<n;r+=1)this.masksProperties[r].mode!=="n"&&(s=!0),this.viewData[r]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[r],3);this.hasMasks=s,s&&this.element.addRenderableComponent(this)}CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var t=this.element.finalTransform.mat,e=this.element.canvasContext,r,n=this.masksProperties.length,s,a,o;for(e.beginPath(),r=0;r<n;r+=1)if(this.masksProperties[r].mode!=="n"){this.masksProperties[r].inv&&(e.moveTo(0,0),e.lineTo(this.element.globalData.compSize.w,0),e.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),e.lineTo(0,this.element.globalData.compSize.h),e.lineTo(0,0)),o=this.viewData[r].v,s=t.applyToPointArray(o.v[0][0],o.v[0][1],0),e.moveTo(s[0],s[1]);var l,u=o._length;for(l=1;l<u;l+=1)a=t.applyToTriplePoints(o.o[l-1],o.i[l],o.v[l]),e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);a=t.applyToTriplePoints(o.o[l-1],o.i[0],o.v[0]),e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}this.element.globalData.renderer.save(!0),e.clip()}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null};function CVBaseElement(){}var operationsMap={1:"source-in",2:"source-out",3:"source-in",4:"source-out"};CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){if(this.data.tt>=1){this.buffers=[];var e=this.globalData.canvasContext,r=assetLoader.createCanvas(e.canvas.width,e.canvas.height);this.buffers.push(r);var n=assetLoader.createCanvas(e.canvas.width,e.canvas.height);this.buffers.push(n),this.data.tt>=3&&!document._isProxy&&assetLoader.loadLumaCanvas()}this.canvasContext=this.globalData.canvasContext,this.transformCanvas=this.globalData.transformCanvas,this.renderableEffectsManager=new CVEffects(this),this.searchEffectTransforms()},createContent:function(){},setBlendMode:function(){var e=this.globalData;if(e.blendMode!==this.data.bm){e.blendMode=this.data.bm;var r=getBlendMode(this.data.bm);e.canvasContext.globalCompositeOperation=r}},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this),this.transformEffects=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT)},hideElement:function(){!this.hidden&&(!this.isInRange||this.isTransparent)&&(this.hidden=!0)},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0)},clearCanvas:function(e){e.clearRect(this.transformCanvas.tx,this.transformCanvas.ty,this.transformCanvas.w*this.transformCanvas.sx,this.transformCanvas.h*this.transformCanvas.sy)},prepareLayer:function(){if(this.data.tt>=1){var e=this.buffers[0],r=e.getContext("2d");this.clearCanvas(r),r.drawImage(this.canvasContext.canvas,0,0),this.currentTransform=this.canvasContext.getTransform(),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform)}},exitLayer:function(){if(this.data.tt>=1){var e=this.buffers[1],r=e.getContext("2d");this.clearCanvas(r),r.drawImage(this.canvasContext.canvas,0,0),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform);var n=this.comp.getElementById("tp"in this.data?this.data.tp:this.data.ind-1);if(n.renderFrame(!0),this.canvasContext.setTransform(1,0,0,1,0,0),this.data.tt>=3&&!document._isProxy){var s=assetLoader.getLumaCanvas(this.canvasContext.canvas),a=s.getContext("2d");a.drawImage(this.canvasContext.canvas,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.drawImage(s,0,0)}this.canvasContext.globalCompositeOperation=operationsMap[this.data.tt],this.canvasContext.drawImage(e,0,0),this.canvasContext.globalCompositeOperation="destination-over",this.canvasContext.drawImage(this.buffers[0],0,0),this.canvasContext.setTransform(this.currentTransform),this.canvasContext.globalCompositeOperation="source-over"}},renderFrame:function(e){if(!(this.hidden||this.data.hd)&&!(this.data.td===1&&!e)){this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.setBlendMode();var r=this.data.ty===0;this.prepareLayer(),this.globalData.renderer.save(r),this.globalData.renderer.ctxTransform(this.finalTransform.localMat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.localOpacity),this.renderInnerContent(),this.globalData.renderer.restore(r),this.exitLayer(),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame&&(this._isFirstFrame=!1)}},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy()},mHelper:new Matrix},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement;function CVShapeData(t,e,r,n){this.styledShapes=[],this.tr=[0,0,0,0,0,0];var s=4;e.ty==="rc"?s=5:e.ty==="el"?s=6:e.ty==="sr"&&(s=7),this.sh=ShapePropertyFactory.getShapeProp(t,e,s,t);var a,o=r.length,l;for(a=0;a<o;a+=1)r[a].closed||(l={transforms:n.addTransformSequence(r[a].transforms),trNodes:[]},this.styledShapes.push(l),r[a].elements.push(l))}CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated;function CVShapeElement(t,e,r){this.shapes=[],this.shapesData=t.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager,this.initElement(t,e,r)}extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[])},CVShapeElement.prototype.createStyleElement=function(t,e){var r={data:t,type:t.ty,preTransforms:this.transformsManager.addTransformSequence(e),transforms:[],elements:[],closed:t.hd===!0},n={};if(t.ty==="fl"||t.ty==="st"?(n.c=PropertyFactory.getProp(this,t.c,1,255,this),n.c.k||(r.co="rgb("+bmFloor(n.c.v[0])+","+bmFloor(n.c.v[1])+","+bmFloor(n.c.v[2])+")")):(t.ty==="gf"||t.ty==="gs")&&(n.s=PropertyFactory.getProp(this,t.s,1,null,this),n.e=PropertyFactory.getProp(this,t.e,1,null,this),n.h=PropertyFactory.getProp(this,t.h||{k:0},0,.01,this),n.a=PropertyFactory.getProp(this,t.a||{k:0},0,degToRads,this),n.g=new GradientProperty(this,t.g,this)),n.o=PropertyFactory.getProp(this,t.o,0,.01,this),t.ty==="st"||t.ty==="gs"){if(r.lc=lineCapEnum[t.lc||2],r.lj=lineJoinEnum[t.lj||2],t.lj==1&&(r.ml=t.ml),n.w=PropertyFactory.getProp(this,t.w,0,null,this),n.w.k||(r.wi=n.w.v),t.d){var s=new DashProperty(this,t.d,"canvas",this);n.d=s,n.d.k||(r.da=n.d.dashArray,r.do=n.d.dashoffset[0])}}else r.r=t.r===2?"evenodd":"nonzero";return this.stylesList.push(r),n.style=r,n},CVShapeElement.prototype.createGroupElement=function(){var t={it:[],prevViewData:[]};return t},CVShapeElement.prototype.createTransformElement=function(t){var e={transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,t.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,t,this)}};return e},CVShapeElement.prototype.createShapeElement=function(t){var e=new CVShapeData(this,t,this.stylesList,this.transformsManager);return this.shapes.push(e),this.addShapeToModifiers(e),e},CVShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var t,e=this.itemsData.length;for(t=0;t<e;t+=1)this.prevViewData[t]=this.itemsData[t];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),e=this.dynamicProperties.length,t=0;t<e;t+=1)this.dynamicProperties[t].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame)},CVShapeElement.prototype.addTransformToStyleList=function(t){var e,r=this.stylesList.length;for(e=0;e<r;e+=1)this.stylesList[e].closed||this.stylesList[e].transforms.push(t)},CVShapeElement.prototype.removeTransformFromStyleList=function(){var t,e=this.stylesList.length;for(t=0;t<e;t+=1)this.stylesList[t].closed||this.stylesList[t].transforms.pop()},CVShapeElement.prototype.closeStyles=function(t){var e,r=t.length;for(e=0;e<r;e+=1)t[e].closed=!0},CVShapeElement.prototype.searchShapes=function(t,e,r,n,s){var a,o=t.length-1,l,u,c=[],d=[],p,m,y,b=[].concat(s);for(a=o;a>=0;a-=1){if(p=this.searchProcessedElement(t[a]),p?e[a]=r[p-1]:t[a]._shouldRender=n,t[a].ty==="fl"||t[a].ty==="st"||t[a].ty==="gf"||t[a].ty==="gs")p?e[a].style.closed=!1:e[a]=this.createStyleElement(t[a],b),c.push(e[a].style);else if(t[a].ty==="gr"){if(!p)e[a]=this.createGroupElement(t[a]);else for(u=e[a].it.length,l=0;l<u;l+=1)e[a].prevViewData[l]=e[a].it[l];this.searchShapes(t[a].it,e[a].it,e[a].prevViewData,n,b)}else t[a].ty==="tr"?(p||(y=this.createTransformElement(t[a]),e[a]=y),b.push(e[a]),this.addTransformToStyleList(e[a])):t[a].ty==="sh"||t[a].ty==="rc"||t[a].ty==="el"||t[a].ty==="sr"?p||(e[a]=this.createShapeElement(t[a])):t[a].ty==="tm"||t[a].ty==="rd"||t[a].ty==="pb"||t[a].ty==="zz"||t[a].ty==="op"?(p?(m=e[a],m.closed=!1):(m=ShapeModifiers.getModifier(t[a].ty),m.init(this,t[a]),e[a]=m,this.shapeModifiers.push(m)),d.push(m)):t[a].ty==="rp"&&(p?(m=e[a],m.closed=!0):(m=ShapeModifiers.getModifier(t[a].ty),e[a]=m,m.init(this,t,a,e),this.shapeModifiers.push(m),n=!1),d.push(m));this.addProcessedElement(t[a],a+1)}for(this.removeTransformFromStyleList(),this.closeStyles(c),o=d.length,a=0;a<o;a+=1)d[a].closed=!0},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0)},CVShapeElement.prototype.renderShapeTransform=function(t,e){(t._opMdf||e.op._mdf||this._isFirstFrame)&&(e.opacity=t.opacity,e.opacity*=e.op.v,e._opMdf=!0)},CVShapeElement.prototype.drawLayer=function(){var t,e=this.stylesList.length,r,n,s,a,o,l,u=this.globalData.renderer,c=this.globalData.canvasContext,d,p;for(t=0;t<e;t+=1)if(p=this.stylesList[t],d=p.type,!((d==="st"||d==="gs")&&p.wi===0||!p.data._shouldRender||p.coOp===0||this.globalData.currentGlobalAlpha===0)){for(u.save(),o=p.elements,d==="st"||d==="gs"?(u.ctxStrokeStyle(d==="st"?p.co:p.grd),u.ctxLineWidth(p.wi),u.ctxLineCap(p.lc),u.ctxLineJoin(p.lj),u.ctxMiterLimit(p.ml||0)):u.ctxFillStyle(d==="fl"?p.co:p.grd),u.ctxOpacity(p.coOp),d!=="st"&&d!=="gs"&&c.beginPath(),u.ctxTransform(p.preTransforms.finalTransform.props),n=o.length,r=0;r<n;r+=1){for((d==="st"||d==="gs")&&(c.beginPath(),p.da&&(c.setLineDash(p.da),c.lineDashOffset=p.do)),l=o[r].trNodes,a=l.length,s=0;s<a;s+=1)l[s].t==="m"?c.moveTo(l[s].p[0],l[s].p[1]):l[s].t==="c"?c.bezierCurveTo(l[s].pts[0],l[s].pts[1],l[s].pts[2],l[s].pts[3],l[s].pts[4],l[s].pts[5]):c.closePath();(d==="st"||d==="gs")&&(u.ctxStroke(),p.da&&c.setLineDash(this.dashResetter))}d!=="st"&&d!=="gs"&&this.globalData.renderer.ctxFill(p.r),u.restore()}},CVShapeElement.prototype.renderShape=function(t,e,r,n){var s,a=e.length-1,o;for(o=t,s=a;s>=0;s-=1)e[s].ty==="tr"?(o=r[s].transform,this.renderShapeTransform(t,o)):e[s].ty==="sh"||e[s].ty==="el"||e[s].ty==="rc"||e[s].ty==="sr"?this.renderPath(e[s],r[s]):e[s].ty==="fl"?this.renderFill(e[s],r[s],o):e[s].ty==="st"?this.renderStroke(e[s],r[s],o):e[s].ty==="gf"||e[s].ty==="gs"?this.renderGradientFill(e[s],r[s],o):e[s].ty==="gr"?this.renderShape(o,e[s].it,r[s].it):e[s].ty;n&&this.drawLayer()},CVShapeElement.prototype.renderStyledShape=function(t,e){if(this._isFirstFrame||e._mdf||t.transforms._mdf){var r=t.trNodes,n=e.paths,s,a,o,l=n._length;r.length=0;var u=t.transforms.finalTransform;for(o=0;o<l;o+=1){var c=n.shapes[o];if(c&&c.v){for(a=c._length,s=1;s<a;s+=1)s===1&&r.push({t:"m",p:u.applyToPointArray(c.v[0][0],c.v[0][1],0)}),r.push({t:"c",pts:u.applyToTriplePoints(c.o[s-1],c.i[s],c.v[s])});a===1&&r.push({t:"m",p:u.applyToPointArray(c.v[0][0],c.v[0][1],0)}),c.c&&a&&(r.push({t:"c",pts:u.applyToTriplePoints(c.o[s-1],c.i[0],c.v[0])}),r.push({t:"z"}))}}t.trNodes=r}},CVShapeElement.prototype.renderPath=function(t,e){if(t.hd!==!0&&t._shouldRender){var r,n=e.styledShapes.length;for(r=0;r<n;r+=1)this.renderStyledShape(e.styledShapes[r],e.sh)}},CVShapeElement.prototype.renderFill=function(t,e,r){var n=e.style;(e.c._mdf||this._isFirstFrame)&&(n.co="rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||r._opMdf||this._isFirstFrame)&&(n.coOp=e.o.v*r.opacity)},CVShapeElement.prototype.renderGradientFill=function(t,e,r){var n=e.style,s;if(!n.grd||e.g._mdf||e.s._mdf||e.e._mdf||t.t!==1&&(e.h._mdf||e.a._mdf)){var a=this.globalData.canvasContext,o=e.s.v,l=e.e.v;if(t.t===1)s=a.createLinearGradient(o[0],o[1],l[0],l[1]);else{var u=Math.sqrt(Math.pow(o[0]-l[0],2)+Math.pow(o[1]-l[1],2)),c=Math.atan2(l[1]-o[1],l[0]-o[0]),d=e.h.v;d>=1?d=.99:d<=-1&&(d=-.99);var p=u*d,m=Math.cos(c+e.a.v)*p+o[0],y=Math.sin(c+e.a.v)*p+o[1];s=a.createRadialGradient(m,y,0,o[0],o[1],u)}var b,E=t.g.p,T=e.g.c,S=1;for(b=0;b<E;b+=1)e.g._hasOpacity&&e.g._collapsable&&(S=e.g.o[b*2+1]),s.addColorStop(T[b*4]/100,"rgba("+T[b*4+1]+","+T[b*4+2]+","+T[b*4+3]+","+S+")");n.grd=s}n.coOp=e.o.v*r.opacity},CVShapeElement.prototype.renderStroke=function(t,e,r){var n=e.style,s=e.d;s&&(s._mdf||this._isFirstFrame)&&(n.da=s.dashArray,n.do=s.dashoffset[0]),(e.c._mdf||this._isFirstFrame)&&(n.co="rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||r._opMdf||this._isFirstFrame)&&(n.coOp=e.o.v*r.opacity),(e.w._mdf||this._isFirstFrame)&&(n.wi=e.w.v)},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0};function CVTextElement(t,e,r){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(t,e,r)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){var t=this.textProperty.currentData;this.renderedLetters=createSizedArray(t.l?t.l.length:0);var e=!1;t.fc?(e=!0,this.values.fill=this.buildColor(t.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=e;var r=!1;t.sc&&(r=!0,this.values.stroke=this.buildColor(t.sc),this.values.sWidth=t.sw);var n=this.globalData.fontManager.getFontByName(t.f),s,a,o=t.l,l=this.mHelper;this.stroke=r,this.values.fValue=t.finalSize+"px "+this.globalData.fontManager.getFontByName(t.f).fFamily,a=t.finalText.length;var u,c,d,p,m,y,b,E,T,S,P=this.data.singleShape,A=t.tr*.001*t.finalSize,I=0,j=0,K=!0,W=0;for(s=0;s<a;s+=1){u=this.globalData.fontManager.getCharData(t.finalText[s],n.fStyle,this.globalData.fontManager.getFontByName(t.f).fFamily),c=u&&u.data||{},l.reset(),P&&o[s].n&&(I=-A,j+=t.yOffset,j+=K?1:0,K=!1),m=c.shapes?c.shapes[0].it:[],b=m.length,l.scale(t.finalSize/100,t.finalSize/100),P&&this.applyTextPropertiesToMatrix(t,l,o[s].line,I,j),T=createSizedArray(b-1);var H=0;for(y=0;y<b;y+=1)if(m[y].ty==="sh"){for(p=m[y].ks.k.i.length,E=m[y].ks.k,S=[],d=1;d<p;d+=1)d===1&&S.push(l.applyToX(E.v[0][0],E.v[0][1],0),l.applyToY(E.v[0][0],E.v[0][1],0)),S.push(l.applyToX(E.o[d-1][0],E.o[d-1][1],0),l.applyToY(E.o[d-1][0],E.o[d-1][1],0),l.applyToX(E.i[d][0],E.i[d][1],0),l.applyToY(E.i[d][0],E.i[d][1],0),l.applyToX(E.v[d][0],E.v[d][1],0),l.applyToY(E.v[d][0],E.v[d][1],0));S.push(l.applyToX(E.o[d-1][0],E.o[d-1][1],0),l.applyToY(E.o[d-1][0],E.o[d-1][1],0),l.applyToX(E.i[0][0],E.i[0][1],0),l.applyToY(E.i[0][0],E.i[0][1],0),l.applyToX(E.v[0][0],E.v[0][1],0),l.applyToY(E.v[0][0],E.v[0][1],0)),T[H]=S,H+=1}P&&(I+=o[s].l,I+=A),this.textSpans[W]?this.textSpans[W].elem=T:this.textSpans[W]={elem:T},W+=1}},CVTextElement.prototype.renderInnerContent=function(){this.validateText();var t=this.canvasContext;t.font=this.values.fValue,this.globalData.renderer.ctxLineCap("butt"),this.globalData.renderer.ctxLineJoin("miter"),this.globalData.renderer.ctxMiterLimit(4),this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);var e,r,n,s,a,o,l=this.textAnimator.renderedLetters,u=this.textProperty.currentData.l;r=u.length;var c,d=null,p=null,m=null,y,b,E=this.globalData.renderer;for(e=0;e<r;e+=1)if(!u[e].n){if(c=l[e],c&&(E.save(),E.ctxTransform(c.p),E.ctxOpacity(c.o)),this.fill){for(c&&c.fc?d!==c.fc&&(E.ctxFillStyle(c.fc),d=c.fc):d!==this.values.fill&&(d=this.values.fill,E.ctxFillStyle(this.values.fill)),y=this.textSpans[e].elem,s=y.length,this.globalData.canvasContext.beginPath(),n=0;n<s;n+=1)for(b=y[n],o=b.length,this.globalData.canvasContext.moveTo(b[0],b[1]),a=2;a<o;a+=6)this.globalData.canvasContext.bezierCurveTo(b[a],b[a+1],b[a+2],b[a+3],b[a+4],b[a+5]);this.globalData.canvasContext.closePath(),E.ctxFill()}if(this.stroke){for(c&&c.sw?m!==c.sw&&(m=c.sw,E.ctxLineWidth(c.sw)):m!==this.values.sWidth&&(m=this.values.sWidth,E.ctxLineWidth(this.values.sWidth)),c&&c.sc?p!==c.sc&&(p=c.sc,E.ctxStrokeStyle(c.sc)):p!==this.values.stroke&&(p=this.values.stroke,E.ctxStrokeStyle(this.values.stroke)),y=this.textSpans[e].elem,s=y.length,this.globalData.canvasContext.beginPath(),n=0;n<s;n+=1)for(b=y[n],o=b.length,this.globalData.canvasContext.moveTo(b[0],b[1]),a=2;a<o;a+=6)this.globalData.canvasContext.bezierCurveTo(b[a],b[a+1],b[a+2],b[a+3],b[a+4],b[a+5]);this.globalData.canvasContext.closePath(),E.ctxStroke()}c&&this.globalData.renderer.restore()}};function CVImageElement(t,e,r){this.assetData=e.getAssetData(t.refId),this.img=e.imageLoader.getAsset(this.assetData),this.initElement(t,e,r)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){if(this.img.width&&(this.assetData.w!==this.img.width||this.assetData.h!==this.img.height)){var t=createTag("canvas");t.width=this.assetData.w,t.height=this.assetData.h;var e=t.getContext("2d"),r=this.img.width,n=this.img.height,s=r/n,a=this.assetData.w/this.assetData.h,o,l,u=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio;s>a&&u==="xMidYMid slice"||s<a&&u!=="xMidYMid slice"?(l=n,o=l*a):(o=r,l=o/a),e.drawImage(this.img,(r-o)/2,(n-l)/2,o,l,0,0,this.assetData.w,this.assetData.h),this.img=t}},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0)},CVImageElement.prototype.destroy=function(){this.img=null};function CVSolidElement(t,e,r){this.initElement(t,e,r)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){this.globalData.renderer.ctxFillStyle(this.data.sc),this.globalData.renderer.ctxFillRect(0,0,this.data.sw,this.data.sh)};function CanvasRendererBase(){}extendPrototype([BaseRenderer],CanvasRendererBase),CanvasRendererBase.prototype.createShape=function(t){return new CVShapeElement(t,this.globalData,this)},CanvasRendererBase.prototype.createText=function(t){return new CVTextElement(t,this.globalData,this)},CanvasRendererBase.prototype.createImage=function(t){return new CVImageElement(t,this.globalData,this)},CanvasRendererBase.prototype.createSolid=function(t){return new CVSolidElement(t,this.globalData,this)},CanvasRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRendererBase.prototype.ctxTransform=function(t){t[0]===1&&t[1]===0&&t[4]===0&&t[5]===1&&t[12]===0&&t[13]===0||this.canvasContext.transform(t[0],t[1],t[4],t[5],t[12],t[13])},CanvasRendererBase.prototype.ctxOpacity=function(t){this.canvasContext.globalAlpha*=t<0?0:t},CanvasRendererBase.prototype.ctxFillStyle=function(t){this.canvasContext.fillStyle=t},CanvasRendererBase.prototype.ctxStrokeStyle=function(t){this.canvasContext.strokeStyle=t},CanvasRendererBase.prototype.ctxLineWidth=function(t){this.canvasContext.lineWidth=t},CanvasRendererBase.prototype.ctxLineCap=function(t){this.canvasContext.lineCap=t},CanvasRendererBase.prototype.ctxLineJoin=function(t){this.canvasContext.lineJoin=t},CanvasRendererBase.prototype.ctxMiterLimit=function(t){this.canvasContext.miterLimit=t},CanvasRendererBase.prototype.ctxFill=function(t){this.canvasContext.fill(t)},CanvasRendererBase.prototype.ctxFillRect=function(t,e,r,n){this.canvasContext.fillRect(t,e,r,n)},CanvasRendererBase.prototype.ctxStroke=function(){this.canvasContext.stroke()},CanvasRendererBase.prototype.reset=function(){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}this.contextData.reset()},CanvasRendererBase.prototype.save=function(){this.canvasContext.save()},CanvasRendererBase.prototype.restore=function(t){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}t&&(this.globalData.blendMode="source-over"),this.contextData.restore(t)},CanvasRendererBase.prototype.configAnimation=function(t){if(this.animationItem.wrapper){this.animationItem.container=createTag("canvas");var e=this.animationItem.container.style;e.width="100%",e.height="100%";var r="0px 0px 0px";e.transformOrigin=r,e.mozTransformOrigin=r,e.webkitTransformOrigin=r,e["-webkit-transform"]=r,e.contentVisibility=this.renderConfig.contentVisibility,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id)}else this.canvasContext=this.renderConfig.context;this.contextData.setContext(this.canvasContext),this.data=t,this.layers=t.layers,this.transformCanvas={w:t.w,h:t.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(t,document.body),this.globalData.canvasContext=this.canvasContext,this.globalData.renderer=this,this.globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(t.layers.length),this.updateContainerSize()},CanvasRendererBase.prototype.updateContainerSize=function(t,e){this.reset();var r,n;t?(r=t,n=e,this.canvasContext.canvas.width=r,this.canvasContext.canvas.height=n):(this.animationItem.wrapper&&this.animationItem.container?(r=this.animationItem.wrapper.offsetWidth,n=this.animationItem.wrapper.offsetHeight):(r=this.canvasContext.canvas.width,n=this.canvasContext.canvas.height),this.canvasContext.canvas.width=r*this.renderConfig.dpr,this.canvasContext.canvas.height=n*this.renderConfig.dpr);var s,a;if(this.renderConfig.preserveAspectRatio.indexOf("meet")!==-1||this.renderConfig.preserveAspectRatio.indexOf("slice")!==-1){var o=this.renderConfig.preserveAspectRatio.split(" "),l=o[1]||"meet",u=o[0]||"xMidYMid",c=u.substr(0,4),d=u.substr(4);s=r/n,a=this.transformCanvas.w/this.transformCanvas.h,a>s&&l==="meet"||a<s&&l==="slice"?(this.transformCanvas.sx=r/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=r/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=n/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=n/(this.transformCanvas.h/this.renderConfig.dpr)),c==="xMid"&&(a<s&&l==="meet"||a>s&&l==="slice")?this.transformCanvas.tx=(r-this.transformCanvas.w*(n/this.transformCanvas.h))/2*this.renderConfig.dpr:c==="xMax"&&(a<s&&l==="meet"||a>s&&l==="slice")?this.transformCanvas.tx=(r-this.transformCanvas.w*(n/this.transformCanvas.h))*this.renderConfig.dpr:this.transformCanvas.tx=0,d==="YMid"&&(a>s&&l==="meet"||a<s&&l==="slice")?this.transformCanvas.ty=(n-this.transformCanvas.h*(r/this.transformCanvas.w))/2*this.renderConfig.dpr:d==="YMax"&&(a>s&&l==="meet"||a<s&&l==="slice")?this.transformCanvas.ty=(n-this.transformCanvas.h*(r/this.transformCanvas.w))*this.renderConfig.dpr:this.transformCanvas.ty=0}else this.renderConfig.preserveAspectRatio==="none"?(this.transformCanvas.sx=r/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=n/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr,this.transformCanvas.tx=0,this.transformCanvas.ty=0);this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0)},CanvasRendererBase.prototype.destroy=function(){this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText="");var t,e=this.layers?this.layers.length:0;for(t=e-1;t>=0;t-=1)this.elements[t]&&this.elements[t].destroy&&this.elements[t].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0},CanvasRendererBase.prototype.renderFrame=function(t,e){if(!(this.renderedFrame===t&&this.renderConfig.clearCanvas===!0&&!e||this.destroyed||t===-1)){this.renderedFrame=t,this.globalData.frameNum=t-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||e,this.globalData.projectInterface.currentFrame=t;var r,n=this.layers.length;for(this.completeLayers||this.checkLayers(t),r=n-1;r>=0;r-=1)(this.completeLayers||this.elements[r])&&this.elements[r].prepareFrame(t-this.layers[r].st);if(this.globalData._mdf){for(this.renderConfig.clearCanvas===!0?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),r=n-1;r>=0;r-=1)(this.completeLayers||this.elements[r])&&this.elements[r].renderFrame();this.renderConfig.clearCanvas!==!0&&this.restore()}}},CanvasRendererBase.prototype.buildItem=function(t){var e=this.elements;if(!(e[t]||this.layers[t].ty===99)){var r=this.createItem(this.layers[t],this,this.globalData);e[t]=r,r.initExpressions()}},CanvasRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var t=this.pendingElements.pop();t.checkParenting()}},CanvasRendererBase.prototype.hide=function(){this.animationItem.container.style.display="none"},CanvasRendererBase.prototype.show=function(){this.animationItem.container.style.display="block"};function CanvasContext(){this.opacity=-1,this.transform=createTypedArray("float32",16),this.fillStyle="",this.strokeStyle="",this.lineWidth="",this.lineCap="",this.lineJoin="",this.miterLimit="",this.id=Math.random()}function CVContextData(){this.stack=[],this.cArrPos=0,this.cTr=new Matrix;var t,e=15;for(t=0;t<e;t+=1){var r=new CanvasContext;this.stack[t]=r}this._length=e,this.nativeContext=null,this.transformMat=new Matrix,this.currentOpacity=1,this.currentFillStyle="",this.appliedFillStyle="",this.currentStrokeStyle="",this.appliedStrokeStyle="",this.currentLineWidth="",this.appliedLineWidth="",this.currentLineCap="",this.appliedLineCap="",this.currentLineJoin="",this.appliedLineJoin="",this.appliedMiterLimit="",this.currentMiterLimit=""}CVContextData.prototype.duplicate=function(){var t=this._length*2,e=0;for(e=this._length;e<t;e+=1)this.stack[e]=new CanvasContext;this._length=t},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.stack[this.cArrPos].opacity=1},CVContextData.prototype.restore=function(t){this.cArrPos-=1;var e=this.stack[this.cArrPos],r=e.transform,n,s=this.cTr.props;for(n=0;n<16;n+=1)s[n]=r[n];if(t){this.nativeContext.restore();var a=this.stack[this.cArrPos+1];this.appliedFillStyle=a.fillStyle,this.appliedStrokeStyle=a.strokeStyle,this.appliedLineWidth=a.lineWidth,this.appliedLineCap=a.lineCap,this.appliedLineJoin=a.lineJoin,this.appliedMiterLimit=a.miterLimit}this.nativeContext.setTransform(r[0],r[1],r[4],r[5],r[12],r[13]),(t||e.opacity!==-1&&this.currentOpacity!==e.opacity)&&(this.nativeContext.globalAlpha=e.opacity,this.currentOpacity=e.opacity),this.currentFillStyle=e.fillStyle,this.currentStrokeStyle=e.strokeStyle,this.currentLineWidth=e.lineWidth,this.currentLineCap=e.lineCap,this.currentLineJoin=e.lineJoin,this.currentMiterLimit=e.miterLimit},CVContextData.prototype.save=function(t){t&&this.nativeContext.save();var e=this.cTr.props;this._length<=this.cArrPos&&this.duplicate();var r=this.stack[this.cArrPos],n;for(n=0;n<16;n+=1)r.transform[n]=e[n];this.cArrPos+=1;var s=this.stack[this.cArrPos];s.opacity=r.opacity,s.fillStyle=r.fillStyle,s.strokeStyle=r.strokeStyle,s.lineWidth=r.lineWidth,s.lineCap=r.lineCap,s.lineJoin=r.lineJoin,s.miterLimit=r.miterLimit},CVContextData.prototype.setOpacity=function(t){this.stack[this.cArrPos].opacity=t},CVContextData.prototype.setContext=function(t){this.nativeContext=t},CVContextData.prototype.fillStyle=function(t){this.stack[this.cArrPos].fillStyle!==t&&(this.currentFillStyle=t,this.stack[this.cArrPos].fillStyle=t)},CVContextData.prototype.strokeStyle=function(t){this.stack[this.cArrPos].strokeStyle!==t&&(this.currentStrokeStyle=t,this.stack[this.cArrPos].strokeStyle=t)},CVContextData.prototype.lineWidth=function(t){this.stack[this.cArrPos].lineWidth!==t&&(this.currentLineWidth=t,this.stack[this.cArrPos].lineWidth=t)},CVContextData.prototype.lineCap=function(t){this.stack[this.cArrPos].lineCap!==t&&(this.currentLineCap=t,this.stack[this.cArrPos].lineCap=t)},CVContextData.prototype.lineJoin=function(t){this.stack[this.cArrPos].lineJoin!==t&&(this.currentLineJoin=t,this.stack[this.cArrPos].lineJoin=t)},CVContextData.prototype.miterLimit=function(t){this.stack[this.cArrPos].miterLimit!==t&&(this.currentMiterLimit=t,this.stack[this.cArrPos].miterLimit=t)},CVContextData.prototype.transform=function(t){this.transformMat.cloneFromProps(t);var e=this.cTr;this.transformMat.multiply(e),e.cloneFromProps(this.transformMat.props);var r=e.props;this.nativeContext.setTransform(r[0],r[1],r[4],r[5],r[12],r[13])},CVContextData.prototype.opacity=function(t){var e=this.stack[this.cArrPos].opacity;e*=t<0?0:t,this.stack[this.cArrPos].opacity!==e&&(this.currentOpacity!==t&&(this.nativeContext.globalAlpha=t,this.currentOpacity=t),this.stack[this.cArrPos].opacity=e)},CVContextData.prototype.fill=function(t){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fill(t)},CVContextData.prototype.fillRect=function(t,e,r,n){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fillRect(t,e,r,n)},CVContextData.prototype.stroke=function(){this.appliedStrokeStyle!==this.currentStrokeStyle&&(this.appliedStrokeStyle=this.currentStrokeStyle,this.nativeContext.strokeStyle=this.appliedStrokeStyle),this.appliedLineWidth!==this.currentLineWidth&&(this.appliedLineWidth=this.currentLineWidth,this.nativeContext.lineWidth=this.appliedLineWidth),this.appliedLineCap!==this.currentLineCap&&(this.appliedLineCap=this.currentLineCap,this.nativeContext.lineCap=this.appliedLineCap),this.appliedLineJoin!==this.currentLineJoin&&(this.appliedLineJoin=this.currentLineJoin,this.nativeContext.lineJoin=this.appliedLineJoin),this.appliedMiterLimit!==this.currentMiterLimit&&(this.appliedMiterLimit=this.currentMiterLimit,this.nativeContext.miterLimit=this.appliedMiterLimit),this.nativeContext.stroke()};function CVCompElement(t,e,r){this.completeLayers=!1,this.layers=t.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(t,e,r),this.tm=t.tm?PropertyFactory.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0}}extendPrototype([CanvasRendererBase,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var t=this.canvasContext;t.beginPath(),t.moveTo(0,0),t.lineTo(this.data.w,0),t.lineTo(this.data.w,this.data.h),t.lineTo(0,this.data.h),t.lineTo(0,0),t.clip();var e,r=this.layers.length;for(e=r-1;e>=0;e-=1)(this.completeLayers||this.elements[e])&&this.elements[e].renderFrame()},CVCompElement.prototype.destroy=function(){var t,e=this.layers.length;for(t=e-1;t>=0;t-=1)this.elements[t]&&this.elements[t].destroy();this.layers=null,this.elements=null},CVCompElement.prototype.createComp=function(t){return new CVCompElement(t,this.globalData,this)};function CanvasRenderer(t,e){this.animationItem=t,this.renderConfig={clearCanvas:e&&e.clearCanvas!==void 0?e.clearCanvas:!0,context:e&&e.context||null,progressiveLoad:e&&e.progressiveLoad||!1,preserveAspectRatio:e&&e.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:e&&e.contentVisibility||"visible",className:e&&e.className||"",id:e&&e.id||"",runExpressions:!e||e.runExpressions===void 0||e.runExpressions},this.renderConfig.dpr=e&&e.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=e&&e.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas",this.renderConfig.clearCanvas&&(this.ctxTransform=this.contextData.transform.bind(this.contextData),this.ctxOpacity=this.contextData.opacity.bind(this.contextData),this.ctxFillStyle=this.contextData.fillStyle.bind(this.contextData),this.ctxStrokeStyle=this.contextData.strokeStyle.bind(this.contextData),this.ctxLineWidth=this.contextData.lineWidth.bind(this.contextData),this.ctxLineCap=this.contextData.lineCap.bind(this.contextData),this.ctxLineJoin=this.contextData.lineJoin.bind(this.contextData),this.ctxMiterLimit=this.contextData.miterLimit.bind(this.contextData),this.ctxFill=this.contextData.fill.bind(this.contextData),this.ctxFillRect=this.contextData.fillRect.bind(this.contextData),this.ctxStroke=this.contextData.stroke.bind(this.contextData),this.save=this.contextData.save.bind(this.contextData))}extendPrototype([CanvasRendererBase],CanvasRenderer),CanvasRenderer.prototype.createComp=function(t){return new CVCompElement(t,this.globalData,this)};function HBaseElement(){}HBaseElement.prototype={checkBlendMode:function(){},initRendererElement:function(){this.baseElement=createTag(this.data.tg||"div"),this.data.hasMask?(this.svgElement=createNS("svg"),this.layerElement=createNS("g"),this.maskedElement=this.layerElement,this.svgElement.appendChild(this.layerElement),this.baseElement.appendChild(this.svgElement)):this.layerElement=this.baseElement,styleDiv(this.baseElement)},createContainerElements:function(){this.renderableEffectsManager=new CVEffects(this),this.transformedElement=this.baseElement,this.maskedElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.bm!==0&&this.setBlendMode()},renderElement:function(){var e=this.transformedElement?this.transformedElement.style:{};if(this.finalTransform._matMdf){var r=this.finalTransform.mat.toCSS();e.transform=r,e.webkitTransform=r}this.finalTransform._opMdf&&(e.opacity=this.finalTransform.mProp.o.v)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},destroy:function(){this.layerElement=null,this.transformedElement=null,this.matteElement&&(this.matteElement=null),this.maskManager&&(this.maskManager.destroy(),this.maskManager=null)},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData)},addEffects:function(){},setMatte:function(){}},HBaseElement.prototype.getBaseElement=SVGBaseElement.prototype.getBaseElement,HBaseElement.prototype.destroyBaseElement=HBaseElement.prototype.destroy,HBaseElement.prototype.buildElementParenting=BaseRenderer.prototype.buildElementParenting;function HSolidElement(t,e,r){this.initElement(t,e,r)}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],HSolidElement),HSolidElement.prototype.createContent=function(){var t;this.data.hasMask?(t=createNS("rect"),t.setAttribute("width",this.data.sw),t.setAttribute("height",this.data.sh),t.setAttribute("fill",this.data.sc),this.svgElement.setAttribute("width",this.data.sw),this.svgElement.setAttribute("height",this.data.sh)):(t=createTag("div"),t.style.width=this.data.sw+"px",t.style.height=this.data.sh+"px",t.style.backgroundColor=this.data.sc),this.layerElement.appendChild(t)};function HShapeElement(t,e,r){this.shapes=[],this.shapesData=t.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.shapesContainer=createNS("g"),this.initElement(t,e,r),this.prevViewData=[],this.currentBBox={x:999999,y:-999999,h:0,w:0}}extendPrototype([BaseElement,TransformElement,HSolidElement,SVGShapeElement,HBaseElement,HierarchyElement,FrameElement,RenderableElement],HShapeElement),HShapeElement.prototype._renderShapeFrame=HShapeElement.prototype.renderInnerContent,HShapeElement.prototype.createContent=function(){var t;if(this.baseElement.style.fontSize=0,this.data.hasMask)this.layerElement.appendChild(this.shapesContainer),t=this.svgElement;else{t=createNS("svg");var e=this.comp.data?this.comp.data:this.globalData.compSize;t.setAttribute("width",e.w),t.setAttribute("height",e.h),t.appendChild(this.shapesContainer),this.layerElement.appendChild(t)}this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.shapesContainer,0,[],!0),this.filterUniqueShapes(),this.shapeCont=t},HShapeElement.prototype.getTransformedPoint=function(t,e){var r,n=t.length;for(r=0;r<n;r+=1)e=t[r].mProps.v.applyToPointArray(e[0],e[1],0);return e},HShapeElement.prototype.calculateShapeBoundingBox=function(t,e){var r=t.sh.v,n=t.transformers,s,a=r._length,o,l,u,c;if(!(a<=1)){for(s=0;s<a-1;s+=1)o=this.getTransformedPoint(n,r.v[s]),l=this.getTransformedPoint(n,r.o[s]),u=this.getTransformedPoint(n,r.i[s+1]),c=this.getTransformedPoint(n,r.v[s+1]),this.checkBounds(o,l,u,c,e);r.c&&(o=this.getTransformedPoint(n,r.v[s]),l=this.getTransformedPoint(n,r.o[s]),u=this.getTransformedPoint(n,r.i[0]),c=this.getTransformedPoint(n,r.v[0]),this.checkBounds(o,l,u,c,e))}},HShapeElement.prototype.checkBounds=function(t,e,r,n,s){this.getBoundsOfCurve(t,e,r,n);var a=this.shapeBoundingBox;s.x=bmMin(a.left,s.x),s.xMax=bmMax(a.right,s.xMax),s.y=bmMin(a.top,s.y),s.yMax=bmMax(a.bottom,s.yMax)},HShapeElement.prototype.shapeBoundingBox={left:0,right:0,top:0,bottom:0},HShapeElement.prototype.tempBoundingBox={x:0,xMax:0,y:0,yMax:0,width:0,height:0},HShapeElement.prototype.getBoundsOfCurve=function(t,e,r,n){for(var s=[[t[0],n[0]],[t[1],n[1]]],a,o,l,u,c,d,p,m=0;m<2;++m)o=6*t[m]-12*e[m]+6*r[m],a=-3*t[m]+9*e[m]-9*r[m]+3*n[m],l=3*e[m]-3*t[m],o|=0,a|=0,l|=0,a===0&&o===0||(a===0?(u=-l/o,u>0&&u<1&&s[m].push(this.calculateF(u,t,e,r,n,m))):(c=o*o-4*l*a,c>=0&&(d=(-o+bmSqrt(c))/(2*a),d>0&&d<1&&s[m].push(this.calculateF(d,t,e,r,n,m)),p=(-o-bmSqrt(c))/(2*a),p>0&&p<1&&s[m].push(this.calculateF(p,t,e,r,n,m)))));this.shapeBoundingBox.left=bmMin.apply(null,s[0]),this.shapeBoundingBox.top=bmMin.apply(null,s[1]),this.shapeBoundingBox.right=bmMax.apply(null,s[0]),this.shapeBoundingBox.bottom=bmMax.apply(null,s[1])},HShapeElement.prototype.calculateF=function(t,e,r,n,s,a){return bmPow(1-t,3)*e[a]+3*bmPow(1-t,2)*t*r[a]+3*(1-t)*bmPow(t,2)*n[a]+bmPow(t,3)*s[a]},HShapeElement.prototype.calculateBoundingBox=function(t,e){var r,n=t.length;for(r=0;r<n;r+=1)t[r]&&t[r].sh?this.calculateShapeBoundingBox(t[r],e):t[r]&&t[r].it?this.calculateBoundingBox(t[r].it,e):t[r]&&t[r].style&&t[r].w&&this.expandStrokeBoundingBox(t[r].w,e)},HShapeElement.prototype.expandStrokeBoundingBox=function(t,e){var r=0;if(t.keyframes){for(var n=0;n<t.keyframes.length;n+=1){var s=t.keyframes[n].s;s>r&&(r=s)}r*=t.mult}else r=t.v*t.mult;e.x-=r,e.xMax+=r,e.y-=r,e.yMax+=r},HShapeElement.prototype.currentBoxContains=function(t){return this.currentBBox.x<=t.x&&this.currentBBox.y<=t.y&&this.currentBBox.width+this.currentBBox.x>=t.x+t.width&&this.currentBBox.height+this.currentBBox.y>=t.y+t.height},HShapeElement.prototype.renderInnerContent=function(){if(this._renderShapeFrame(),!this.hidden&&(this._isFirstFrame||this._mdf)){var t=this.tempBoundingBox,e=999999;if(t.x=e,t.xMax=-e,t.y=e,t.yMax=-e,this.calculateBoundingBox(this.itemsData,t),t.width=t.xMax<t.x?0:t.xMax-t.x,t.height=t.yMax<t.y?0:t.yMax-t.y,this.currentBoxContains(t))return;var r=!1;if(this.currentBBox.w!==t.width&&(this.currentBBox.w=t.width,this.shapeCont.setAttribute("width",t.width),r=!0),this.currentBBox.h!==t.height&&(this.currentBBox.h=t.height,this.shapeCont.setAttribute("height",t.height),r=!0),r||this.currentBBox.x!==t.x||this.currentBBox.y!==t.y){this.currentBBox.w=t.width,this.currentBBox.h=t.height,this.currentBBox.x=t.x,this.currentBBox.y=t.y,this.shapeCont.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h);var n=this.shapeCont.style,s="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";n.transform=s,n.webkitTransform=s}}};function HTextElement(t,e,r){this.textSpans=[],this.textPaths=[],this.currentBBox={x:999999,y:-999999,h:0,w:0},this.renderType="svg",this.isMasked=!1,this.initElement(t,e,r)}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],HTextElement),HTextElement.prototype.createContent=function(){if(this.isMasked=this.checkMasks(),this.isMasked){this.renderType="svg",this.compW=this.comp.data.w,this.compH=this.comp.data.h,this.svgElement.setAttribute("width",this.compW),this.svgElement.setAttribute("height",this.compH);var t=createNS("g");this.maskedElement.appendChild(t),this.innerElem=t}else this.renderType="html",this.innerElem=this.layerElement;this.checkParenting()},HTextElement.prototype.buildNewText=function(){var t=this.textProperty.currentData;this.renderedLetters=createSizedArray(t.l?t.l.length:0);var e=this.innerElem.style,r=t.fc?this.buildColor(t.fc):"rgba(0,0,0,0)";e.fill=r,e.color=r,t.sc&&(e.stroke=this.buildColor(t.sc),e.strokeWidth=t.sw+"px");var n=this.globalData.fontManager.getFontByName(t.f);if(!this.globalData.fontManager.chars)if(e.fontSize=t.finalSize+"px",e.lineHeight=t.finalSize+"px",n.fClass)this.innerElem.className=n.fClass;else{e.fontFamily=n.fFamily;var s=t.fWeight,a=t.fStyle;e.fontStyle=a,e.fontWeight=s}var o,l,u=t.l;l=u.length;var c,d,p,m=this.mHelper,y,b="",E=0;for(o=0;o<l;o+=1){if(this.globalData.fontManager.chars?(this.textPaths[E]?c=this.textPaths[E]:(c=createNS("path"),c.setAttribute("stroke-linecap",lineCapEnum[1]),c.setAttribute("stroke-linejoin",lineJoinEnum[2]),c.setAttribute("stroke-miterlimit","4")),this.isMasked||(this.textSpans[E]?(d=this.textSpans[E],p=d.children[0]):(d=createTag("div"),d.style.lineHeight=0,p=createNS("svg"),p.appendChild(c),styleDiv(d)))):this.isMasked?c=this.textPaths[E]?this.textPaths[E]:createNS("text"):this.textSpans[E]?(d=this.textSpans[E],c=this.textPaths[E]):(d=createTag("span"),styleDiv(d),c=createTag("span"),styleDiv(c),d.appendChild(c)),this.globalData.fontManager.chars){var T=this.globalData.fontManager.getCharData(t.finalText[o],n.fStyle,this.globalData.fontManager.getFontByName(t.f).fFamily),S;if(T?S=T.data:S=null,m.reset(),S&&S.shapes&&S.shapes.length&&(y=S.shapes[0].it,m.scale(t.finalSize/100,t.finalSize/100),b=this.createPathShape(m,y),c.setAttribute("d",b)),this.isMasked)this.innerElem.appendChild(c);else{if(this.innerElem.appendChild(d),S&&S.shapes){document.body.appendChild(p);var P=p.getBBox();p.setAttribute("width",P.width+2),p.setAttribute("height",P.height+2),p.setAttribute("viewBox",P.x-1+" "+(P.y-1)+" "+(P.width+2)+" "+(P.height+2));var A=p.style,I="translate("+(P.x-1)+"px,"+(P.y-1)+"px)";A.transform=I,A.webkitTransform=I,u[o].yOffset=P.y-1}else p.setAttribute("width",1),p.setAttribute("height",1);d.appendChild(p)}}else if(c.textContent=u[o].val,c.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.isMasked)this.innerElem.appendChild(c);else{this.innerElem.appendChild(d);var j=c.style,K="translate3d(0,"+-t.finalSize/1.2+"px,0)";j.transform=K,j.webkitTransform=K}this.isMasked?this.textSpans[E]=c:this.textSpans[E]=d,this.textSpans[E].style.display="block",this.textPaths[E]=c,E+=1}for(;E<this.textSpans.length;)this.textSpans[E].style.display="none",E+=1},HTextElement.prototype.renderInnerContent=function(){this.validateText();var t;if(this.data.singleShape){if(!this._isFirstFrame&&!this.lettersChangedFlag)return;if(this.isMasked&&this.finalTransform._matMdf){this.svgElement.setAttribute("viewBox",-this.finalTransform.mProp.p.v[0]+" "+-this.finalTransform.mProp.p.v[1]+" "+this.compW+" "+this.compH),t=this.svgElement.style;var e="translate("+-this.finalTransform.mProp.p.v[0]+"px,"+-this.finalTransform.mProp.p.v[1]+"px)";t.transform=e,t.webkitTransform=e}}if(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),!(!this.lettersChangedFlag&&!this.textAnimator.lettersChangedFlag)){var r,n,s=0,a=this.textAnimator.renderedLetters,o=this.textProperty.currentData.l;n=o.length;var l,u,c;for(r=0;r<n;r+=1)o[r].n?s+=1:(u=this.textSpans[r],c=this.textPaths[r],l=a[s],s+=1,l._mdf.m&&(this.isMasked?u.setAttribute("transform",l.m):(u.style.webkitTransform=l.m,u.style.transform=l.m)),u.style.opacity=l.o,l.sw&&l._mdf.sw&&c.setAttribute("stroke-width",l.sw),l.sc&&l._mdf.sc&&c.setAttribute("stroke",l.sc),l.fc&&l._mdf.fc&&(c.setAttribute("fill",l.fc),c.style.color=l.fc));if(this.innerElem.getBBox&&!this.hidden&&(this._isFirstFrame||this._mdf)){var d=this.innerElem.getBBox();this.currentBBox.w!==d.width&&(this.currentBBox.w=d.width,this.svgElement.setAttribute("width",d.width)),this.currentBBox.h!==d.height&&(this.currentBBox.h=d.height,this.svgElement.setAttribute("height",d.height));var p=1;if(this.currentBBox.w!==d.width+p*2||this.currentBBox.h!==d.height+p*2||this.currentBBox.x!==d.x-p||this.currentBBox.y!==d.y-p){this.currentBBox.w=d.width+p*2,this.currentBBox.h=d.height+p*2,this.currentBBox.x=d.x-p,this.currentBBox.y=d.y-p,this.svgElement.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),t=this.svgElement.style;var m="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";t.transform=m,t.webkitTransform=m}}}};function HCameraElement(t,e,r){this.initFrame(),this.initBaseData(t,e,r),this.initHierarchy();var n=PropertyFactory.getProp;if(this.pe=n(this,t.pe,0,0,this),t.ks.p.s?(this.px=n(this,t.ks.p.x,1,0,this),this.py=n(this,t.ks.p.y,1,0,this),this.pz=n(this,t.ks.p.z,1,0,this)):this.p=n(this,t.ks.p,1,0,this),t.ks.a&&(this.a=n(this,t.ks.a,1,0,this)),t.ks.or.k.length&&t.ks.or.k[0].to){var s,a=t.ks.or.k.length;for(s=0;s<a;s+=1)t.ks.or.k[s].to=null,t.ks.or.k[s].ti=null}this.or=n(this,t.ks.or,1,degToRads,this),this.or.sh=!0,this.rx=n(this,t.ks.rx,0,degToRads,this),this.ry=n(this,t.ks.ry,0,degToRads,this),this.rz=n(this,t.ks.rz,0,degToRads,this),this.mat=new Matrix,this._prevMat=new Matrix,this._isFirstFrame=!0,this.finalTransform={mProp:this}}extendPrototype([BaseElement,FrameElement,HierarchyElement],HCameraElement),HCameraElement.prototype.setup=function(){var t,e=this.comp.threeDElements.length,r,n,s;for(t=0;t<e;t+=1)if(r=this.comp.threeDElements[t],r.type==="3d"){n=r.perspectiveElem.style,s=r.container.style;var a=this.pe.v+"px",o="0px 0px 0px",l="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";n.perspective=a,n.webkitPerspective=a,s.transformOrigin=o,s.mozTransformOrigin=o,s.webkitTransformOrigin=o,n.transform=l,n.webkitTransform=l}},HCameraElement.prototype.createElements=function(){},HCameraElement.prototype.hide=function(){},HCameraElement.prototype.renderFrame=function(){var t=this._isFirstFrame,e,r;if(this.hierarchy)for(r=this.hierarchy.length,e=0;e<r;e+=1)t=this.hierarchy[e].finalTransform.mProp._mdf||t;if(t||this.pe._mdf||this.p&&this.p._mdf||this.px&&(this.px._mdf||this.py._mdf||this.pz._mdf)||this.rx._mdf||this.ry._mdf||this.rz._mdf||this.or._mdf||this.a&&this.a._mdf){if(this.mat.reset(),this.hierarchy)for(r=this.hierarchy.length-1,e=r;e>=0;e-=1){var n=this.hierarchy[e].finalTransform.mProp;this.mat.translate(-n.p.v[0],-n.p.v[1],n.p.v[2]),this.mat.rotateX(-n.or.v[0]).rotateY(-n.or.v[1]).rotateZ(n.or.v[2]),this.mat.rotateX(-n.rx.v).rotateY(-n.ry.v).rotateZ(n.rz.v),this.mat.scale(1/n.s.v[0],1/n.s.v[1],1/n.s.v[2]),this.mat.translate(n.a.v[0],n.a.v[1],n.a.v[2])}if(this.p?this.mat.translate(-this.p.v[0],-this.p.v[1],this.p.v[2]):this.mat.translate(-this.px.v,-this.py.v,this.pz.v),this.a){var s;this.p?s=[this.p.v[0]-this.a.v[0],this.p.v[1]-this.a.v[1],this.p.v[2]-this.a.v[2]]:s=[this.px.v-this.a.v[0],this.py.v-this.a.v[1],this.pz.v-this.a.v[2]];var a=Math.sqrt(Math.pow(s[0],2)+Math.pow(s[1],2)+Math.pow(s[2],2)),o=[s[0]/a,s[1]/a,s[2]/a],l=Math.sqrt(o[2]*o[2]+o[0]*o[0]),u=Math.atan2(o[1],l),c=Math.atan2(o[0],-o[2]);this.mat.rotateY(c).rotateX(-u)}this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),this.mat.translate(this.globalData.compSize.w/2,this.globalData.compSize.h/2,0),this.mat.translate(0,0,this.pe.v);var d=!this._prevMat.equals(this.mat);if((d||this.pe._mdf)&&this.comp.threeDElements){r=this.comp.threeDElements.length;var p,m,y;for(e=0;e<r;e+=1)if(p=this.comp.threeDElements[e],p.type==="3d"){if(d){var b=this.mat.toCSS();y=p.container.style,y.transform=b,y.webkitTransform=b}this.pe._mdf&&(m=p.perspectiveElem.style,m.perspective=this.pe.v+"px",m.webkitPerspective=this.pe.v+"px")}this.mat.clone(this._prevMat)}}this._isFirstFrame=!1},HCameraElement.prototype.prepareFrame=function(t){this.prepareProperties(t,!0)},HCameraElement.prototype.destroy=function(){},HCameraElement.prototype.getBaseElement=function(){return null};function HImageElement(t,e,r){this.assetData=e.getAssetData(t.refId),this.initElement(t,e,r)}extendPrototype([BaseElement,TransformElement,HBaseElement,HSolidElement,HierarchyElement,FrameElement,RenderableElement],HImageElement),HImageElement.prototype.createContent=function(){var t=this.globalData.getAssetsPath(this.assetData),e=new Image;this.data.hasMask?(this.imageElem=createNS("image"),this.imageElem.setAttribute("width",this.assetData.w+"px"),this.imageElem.setAttribute("height",this.assetData.h+"px"),this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink","href",t),this.layerElement.appendChild(this.imageElem),this.baseElement.setAttribute("width",this.assetData.w),this.baseElement.setAttribute("height",this.assetData.h)):this.layerElement.appendChild(e),e.crossOrigin="anonymous",e.src=t,this.data.ln&&this.baseElement.setAttribute("id",this.data.ln)};function HybridRendererBase(t,e){this.animationItem=t,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:e&&e.className||"",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(e&&e.hideOnTransparent===!1),filterSize:{width:e&&e.filterSize&&e.filterSize.width||"400%",height:e&&e.filterSize&&e.filterSize.height||"400%",x:e&&e.filterSize&&e.filterSize.x||"-100%",y:e&&e.filterSize&&e.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([BaseRenderer],HybridRendererBase),HybridRendererBase.prototype.buildItem=SVGRenderer.prototype.buildItem,HybridRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var t=this.pendingElements.pop();t.checkParenting()}},HybridRendererBase.prototype.appendElementInPos=function(t,e){var r=t.getBaseElement();if(r){var n=this.layers[e];if(!n.ddd||!this.supports3d)if(this.threeDElements)this.addTo3dContainer(r,e);else{for(var s=0,a,o,l;s<e;)this.elements[s]&&this.elements[s]!==!0&&this.elements[s].getBaseElement&&(o=this.elements[s],l=this.layers[s].ddd?this.getThreeDContainerByPos(s):o.getBaseElement(),a=l||a),s+=1;a?(!n.ddd||!this.supports3d)&&this.layerElement.insertBefore(r,a):(!n.ddd||!this.supports3d)&&this.layerElement.appendChild(r)}else this.addTo3dContainer(r,e)}},HybridRendererBase.prototype.createShape=function(t){return this.supports3d?new HShapeElement(t,this.globalData,this):new SVGShapeElement(t,this.globalData,this)},HybridRendererBase.prototype.createText=function(t){return this.supports3d?new HTextElement(t,this.globalData,this):new SVGTextLottieElement(t,this.globalData,this)},HybridRendererBase.prototype.createCamera=function(t){return this.camera=new HCameraElement(t,this.globalData,this),this.camera},HybridRendererBase.prototype.createImage=function(t){return this.supports3d?new HImageElement(t,this.globalData,this):new IImageElement(t,this.globalData,this)},HybridRendererBase.prototype.createSolid=function(t){return this.supports3d?new HSolidElement(t,this.globalData,this):new ISolidElement(t,this.globalData,this)},HybridRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,HybridRendererBase.prototype.getThreeDContainerByPos=function(t){for(var e=0,r=this.threeDElements.length;e<r;){if(this.threeDElements[e].startPos<=t&&this.threeDElements[e].endPos>=t)return this.threeDElements[e].perspectiveElem;e+=1}return null},HybridRendererBase.prototype.createThreeDContainer=function(t,e){var r=createTag("div"),n,s;styleDiv(r);var a=createTag("div");if(styleDiv(a),e==="3d"){n=r.style,n.width=this.globalData.compSize.w+"px",n.height=this.globalData.compSize.h+"px";var o="50% 50%";n.webkitTransformOrigin=o,n.mozTransformOrigin=o,n.transformOrigin=o,s=a.style;var l="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";s.transform=l,s.webkitTransform=l}r.appendChild(a);var u={container:a,perspectiveElem:r,startPos:t,endPos:t,type:e};return this.threeDElements.push(u),u},HybridRendererBase.prototype.build3dContainers=function(){var t,e=this.layers.length,r,n="";for(t=0;t<e;t+=1)this.layers[t].ddd&&this.layers[t].ty!==3?(n!=="3d"&&(n="3d",r=this.createThreeDContainer(t,"3d")),r.endPos=Math.max(r.endPos,t)):(n!=="2d"&&(n="2d",r=this.createThreeDContainer(t,"2d")),r.endPos=Math.max(r.endPos,t));for(e=this.threeDElements.length,t=e-1;t>=0;t-=1)this.resizerElem.appendChild(this.threeDElements[t].perspectiveElem)},HybridRendererBase.prototype.addTo3dContainer=function(t,e){for(var r=0,n=this.threeDElements.length;r<n;){if(e<=this.threeDElements[r].endPos){for(var s=this.threeDElements[r].startPos,a;s<e;)this.elements[s]&&this.elements[s].getBaseElement&&(a=this.elements[s].getBaseElement()),s+=1;a?this.threeDElements[r].container.insertBefore(t,a):this.threeDElements[r].container.appendChild(t);break}r+=1}},HybridRendererBase.prototype.configAnimation=function(t){var e=createTag("div"),r=this.animationItem.wrapper,n=e.style;n.width=t.w+"px",n.height=t.h+"px",this.resizerElem=e,styleDiv(e),n.transformStyle="flat",n.mozTransformStyle="flat",n.webkitTransformStyle="flat",this.renderConfig.className&&e.setAttribute("class",this.renderConfig.className),r.appendChild(e),n.overflow="hidden";var s=createNS("svg");s.setAttribute("width","1"),s.setAttribute("height","1"),styleDiv(s),this.resizerElem.appendChild(s);var a=createNS("defs");s.appendChild(a),this.data=t,this.setupGlobalData(t,s),this.globalData.defs=a,this.layers=t.layers,this.layerElement=this.resizerElem,this.build3dContainers(),this.updateContainerSize()},HybridRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.animationItem.container=null,this.globalData.defs=null;var t,e=this.layers?this.layers.length:0;for(t=0;t<e;t+=1)this.elements[t]&&this.elements[t].destroy&&this.elements[t].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},HybridRendererBase.prototype.updateContainerSize=function(){var t=this.animationItem.wrapper.offsetWidth,e=this.animationItem.wrapper.offsetHeight,r=t/e,n=this.globalData.compSize.w/this.globalData.compSize.h,s,a,o,l;n>r?(s=t/this.globalData.compSize.w,a=t/this.globalData.compSize.w,o=0,l=(e-this.globalData.compSize.h*(t/this.globalData.compSize.w))/2):(s=e/this.globalData.compSize.h,a=e/this.globalData.compSize.h,o=(t-this.globalData.compSize.w*(e/this.globalData.compSize.h))/2,l=0);var u=this.resizerElem.style;u.webkitTransform="matrix3d("+s+",0,0,0,0,"+a+",0,0,0,0,1,0,"+o+","+l+",0,1)",u.transform=u.webkitTransform},HybridRendererBase.prototype.renderFrame=SVGRenderer.prototype.renderFrame,HybridRendererBase.prototype.hide=function(){this.resizerElem.style.display="none"},HybridRendererBase.prototype.show=function(){this.resizerElem.style.display="block"},HybridRendererBase.prototype.initItems=function(){if(this.buildAllItems(),this.camera)this.camera.setup();else{var t=this.globalData.compSize.w,e=this.globalData.compSize.h,r,n=this.threeDElements.length;for(r=0;r<n;r+=1){var s=this.threeDElements[r].perspectiveElem.style;s.webkitPerspective=Math.sqrt(Math.pow(t,2)+Math.pow(e,2))+"px",s.perspective=s.webkitPerspective}}},HybridRendererBase.prototype.searchExtraCompositions=function(t){var e,r=t.length,n=createTag("div");for(e=0;e<r;e+=1)if(t[e].xt){var s=this.createComp(t[e],n,this.globalData.comp,null);s.initExpressions(),this.globalData.projectInterface.registerComposition(s)}};function HCompElement(t,e,r){this.layers=t.layers,this.supports3d=!t.hasMask,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(t,e,r),this.tm=t.tm?PropertyFactory.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0}}extendPrototype([HybridRendererBase,ICompElement,HBaseElement],HCompElement),HCompElement.prototype._createBaseContainerElements=HCompElement.prototype.createContainerElements,HCompElement.prototype.createContainerElements=function(){this._createBaseContainerElements(),this.data.hasMask?(this.svgElement.setAttribute("width",this.data.w),this.svgElement.setAttribute("height",this.data.h),this.transformedElement=this.baseElement):this.transformedElement=this.layerElement},HCompElement.prototype.addTo3dContainer=function(t,e){for(var r=0,n;r<e;)this.elements[r]&&this.elements[r].getBaseElement&&(n=this.elements[r].getBaseElement()),r+=1;n?this.layerElement.insertBefore(t,n):this.layerElement.appendChild(t)},HCompElement.prototype.createComp=function(t){return this.supports3d?new HCompElement(t,this.globalData,this):new SVGCompElement(t,this.globalData,this)};function HybridRenderer(t,e){this.animationItem=t,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:e&&e.className||"",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(e&&e.hideOnTransparent===!1),filterSize:{width:e&&e.filterSize&&e.filterSize.width||"400%",height:e&&e.filterSize&&e.filterSize.height||"400%",x:e&&e.filterSize&&e.filterSize.x||"-100%",y:e&&e.filterSize&&e.filterSize.y||"-100%"},runExpressions:!e||e.runExpressions===void 0||e.runExpressions},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([HybridRendererBase],HybridRenderer),HybridRenderer.prototype.createComp=function(t){return this.supports3d?new HCompElement(t,this.globalData,this):new SVGCompElement(t,this.globalData,this)};var CompExpressionInterface=function(){return function(t){function e(r){for(var n=0,s=t.layers.length;n<s;){if(t.layers[n].nm===r||t.layers[n].ind===r)return t.elements[n].layerInterface;n+=1}return null}return Object.defineProperty(e,"_name",{value:t.data.nm}),e.layer=e,e.pixelAspect=1,e.height=t.data.h||t.globalData.compSize.h,e.width=t.data.w||t.globalData.compSize.w,e.pixelAspect=1,e.frameDuration=1/t.globalData.frameRate,e.displayStartTime=0,e.numLayers=t.layers.length,e}}();function _typeof$2(t){"@babel/helpers - typeof";return _typeof$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$2(t)}function seedRandom(t,e){var r=this,n=256,s=6,a=52,o="random",l=e.pow(n,s),u=e.pow(2,a),c=u*2,d=n-1,p;function m(A,I,j){var K=[];I=I===!0?{entropy:!0}:I||{};var W=T(E(I.entropy?[A,P(t)]:A===null?S():A,3),K),H=new y(K),ee=function(){for(var de=H.g(s),fe=l,ae=0;de<u;)de=(de+ae)*n,fe*=n,ae=H.g(1);for(;de>=c;)de/=2,fe/=2,ae>>>=1;return(de+ae)/fe};return ee.int32=function(){return H.g(4)|0},ee.quick=function(){return H.g(4)/4294967296},ee.double=ee,T(P(H.S),t),(I.pass||j||function(ue,de,fe,ae){return ae&&(ae.S&&b(ae,H),ue.state=function(){return b(H,{})}),fe?(e[o]=ue,de):ue})(ee,W,"global"in I?I.global:this==e,I.state)}e["seed"+o]=m;function y(A){var I,j=A.length,K=this,W=0,H=K.i=K.j=0,ee=K.S=[];for(j||(A=[j++]);W<n;)ee[W]=W++;for(W=0;W<n;W++)ee[W]=ee[H=d&H+A[W%j]+(I=ee[W])],ee[H]=I;K.g=function(ue){for(var de,fe=0,ae=K.i,ce=K.j,me=K.S;ue--;)de=me[ae=d&ae+1],fe=fe*n+me[d&(me[ae]=me[ce=d&ce+de])+(me[ce]=de)];return K.i=ae,K.j=ce,fe}}function b(A,I){return I.i=A.i,I.j=A.j,I.S=A.S.slice(),I}function E(A,I){var j=[],K=_typeof$2(A),W;if(I&&K=="object")for(W in A)try{j.push(E(A[W],I-1))}catch{}return j.length?j:K=="string"?A:A+"\0"}function T(A,I){for(var j=A+"",K,W=0;W<j.length;)I[d&W]=d&(K^=I[d&W]*19)+j.charCodeAt(W++);return P(I)}function S(){try{var A=new Uint8Array(n);return(r.crypto||r.msCrypto).getRandomValues(A),P(A)}catch{var I=r.navigator,j=I&&I.plugins;return[+new Date,r,j,r.screen,P(t)]}}function P(A){return String.fromCharCode.apply(0,A)}T(e.random(),t)}function initialize$2(t){seedRandom([],t)}var propTypes={SHAPE:"shape"};function _typeof$1(t){"@babel/helpers - typeof";return _typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$1(t)}var ExpressionManager=function(){var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null,frames=null,_lottieGlobal={};initialize$2(BMMath);function resetFrame(){_lottieGlobal={}}function $bm_isInstanceOfArray(t){return t.constructor===Array||t.constructor===Float32Array}function isNumerable(t,e){return t==="number"||e instanceof Number||t==="boolean"||t==="string"}function $bm_neg(t){var e=_typeof$1(t);if(e==="number"||t instanceof Number||e==="boolean")return-t;if($bm_isInstanceOfArray(t)){var r,n=t.length,s=[];for(r=0;r<n;r+=1)s[r]=-t[r];return s}return t.propType?t.v:-t}var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(t,e){var r=_typeof$1(t),n=_typeof$1(e);if(isNumerable(r,t)&&isNumerable(n,e)||r==="string"||n==="string")return t+e;if($bm_isInstanceOfArray(t)&&isNumerable(n,e))return t=t.slice(0),t[0]+=e,t;if(isNumerable(r,t)&&$bm_isInstanceOfArray(e))return e=e.slice(0),e[0]=t+e[0],e;if($bm_isInstanceOfArray(t)&&$bm_isInstanceOfArray(e)){for(var s=0,a=t.length,o=e.length,l=[];s<a||s<o;)(typeof t[s]=="number"||t[s]instanceof Number)&&(typeof e[s]=="number"||e[s]instanceof Number)?l[s]=t[s]+e[s]:l[s]=e[s]===void 0?t[s]:t[s]||e[s],s+=1;return l}return 0}var add=sum;function sub(t,e){var r=_typeof$1(t),n=_typeof$1(e);if(isNumerable(r,t)&&isNumerable(n,e))return r==="string"&&(t=parseInt(t,10)),n==="string"&&(e=parseInt(e,10)),t-e;if($bm_isInstanceOfArray(t)&&isNumerable(n,e))return t=t.slice(0),t[0]-=e,t;if(isNumerable(r,t)&&$bm_isInstanceOfArray(e))return e=e.slice(0),e[0]=t-e[0],e;if($bm_isInstanceOfArray(t)&&$bm_isInstanceOfArray(e)){for(var s=0,a=t.length,o=e.length,l=[];s<a||s<o;)(typeof t[s]=="number"||t[s]instanceof Number)&&(typeof e[s]=="number"||e[s]instanceof Number)?l[s]=t[s]-e[s]:l[s]=e[s]===void 0?t[s]:t[s]||e[s],s+=1;return l}return 0}function mul(t,e){var r=_typeof$1(t),n=_typeof$1(e),s;if(isNumerable(r,t)&&isNumerable(n,e))return t*e;var a,o;if($bm_isInstanceOfArray(t)&&isNumerable(n,e)){for(o=t.length,s=createTypedArray("float32",o),a=0;a<o;a+=1)s[a]=t[a]*e;return s}if(isNumerable(r,t)&&$bm_isInstanceOfArray(e)){for(o=e.length,s=createTypedArray("float32",o),a=0;a<o;a+=1)s[a]=t*e[a];return s}return 0}function div(t,e){var r=_typeof$1(t),n=_typeof$1(e),s;if(isNumerable(r,t)&&isNumerable(n,e))return t/e;var a,o;if($bm_isInstanceOfArray(t)&&isNumerable(n,e)){for(o=t.length,s=createTypedArray("float32",o),a=0;a<o;a+=1)s[a]=t[a]/e;return s}if(isNumerable(r,t)&&$bm_isInstanceOfArray(e)){for(o=e.length,s=createTypedArray("float32",o),a=0;a<o;a+=1)s[a]=t/e[a];return s}return 0}function mod(t,e){return typeof t=="string"&&(t=parseInt(t,10)),typeof e=="string"&&(e=parseInt(e,10)),t%e}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(t,e,r){if(e>r){var n=r;r=e,e=n}return Math.min(Math.max(t,e),r)}function radiansToDegrees(t){return t/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(t){return t*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(t,e){if(typeof t=="number"||t instanceof Number)return e=e||0,Math.abs(t-e);e||(e=helperLengthArray);var r,n=Math.min(t.length,e.length),s=0;for(r=0;r<n;r+=1)s+=Math.pow(e[r]-t[r],2);return Math.sqrt(s)}function normalize(t){return div(t,length(t))}function rgbToHsl(t){var e=t[0],r=t[1],n=t[2],s=Math.max(e,r,n),a=Math.min(e,r,n),o,l,u=(s+a)/2;if(s===a)o=0,l=0;else{var c=s-a;switch(l=u>.5?c/(2-s-a):c/(s+a),s){case e:o=(r-n)/c+(r<n?6:0);break;case r:o=(n-e)/c+2;break;case n:o=(e-r)/c+4;break}o/=6}return[o,l,u,t[3]]}function hue2rgb(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function hslToRgb(t){var e=t[0],r=t[1],n=t[2],s,a,o;if(r===0)s=n,o=n,a=n;else{var l=n<.5?n*(1+r):n+r-n*r,u=2*n-l;s=hue2rgb(u,l,e+1/3),a=hue2rgb(u,l,e),o=hue2rgb(u,l,e-1/3)}return[s,a,o,t[3]]}function linear(t,e,r,n,s){if((n===void 0||s===void 0)&&(n=e,s=r,e=0,r=1),r<e){var a=r;r=e,e=a}if(t<=e)return n;if(t>=r)return s;var o=r===e?0:(t-e)/(r-e);if(!n.length)return n+(s-n)*o;var l,u=n.length,c=createTypedArray("float32",u);for(l=0;l<u;l+=1)c[l]=n[l]+(s[l]-n[l])*o;return c}function random(t,e){if(e===void 0&&(t===void 0?(t=0,e=1):(e=t,t=void 0)),e.length){var r,n=e.length;t||(t=createTypedArray("float32",n));var s=createTypedArray("float32",n),a=BMMath.random();for(r=0;r<n;r+=1)s[r]=t[r]+a*(e[r]-t[r]);return s}t===void 0&&(t=0);var o=BMMath.random();return t+o*(e-t)}function createPath(t,e,r,n){var s,a=t.length,o=shapePool.newElement();o.setPathData(!!n,a);var l=[0,0],u,c;for(s=0;s<a;s+=1)u=e&&e[s]?e[s]:l,c=r&&r[s]?r[s]:l,o.setTripleAt(t[s][0],t[s][1],c[0]+t[s][0],c[1]+t[s][1],u[0]+t[s][0],u[1]+t[s][1],s,!0);return o}function initiateExpression(elem,data,property){function noOp(t){return t}if(!elem.globalData.renderConfig.runExpressions)return noOp;var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=val.indexOf("random")!==-1,elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty._name=elem.data.nm,thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||this.data.hd!==!0,wiggle=(function t(e,r){var n,s,a=this.pv.length?this.pv.length:1,o=createTypedArray("float32",a);e=5;var l=Math.floor(time*e);for(n=0,s=0;n<l;){for(s=0;s<a;s+=1)o[s]+=-r+r*2*BMMath.random();n+=1}var u=time*e,c=u-Math.floor(u),d=createTypedArray("float32",a);if(a>1){for(s=0;s<a;s+=1)d[s]=this.pv[s]+o[s]+(-r+r*2*BMMath.random())*c;return d}return this.pv+o[0]+(-r+r*2*BMMath.random())*c}).bind(this);thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty));function loopInDuration(t,e){return loopIn(t,e,!0)}function loopOutDuration(t,e){return loopOut(t,e,!0)}this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface);function lookAt(t,e){var r=[e[0]-t[0],e[1]-t[1],e[2]-t[2]],n=Math.atan2(r[0],Math.sqrt(r[1]*r[1]+r[2]*r[2]))/degToRads,s=-Math.atan2(r[1],r[2])/degToRads;return[s,n,0]}function easeOut(t,e,r,n,s){return applyEase(easeOutBez,t,e,r,n,s)}function easeIn(t,e,r,n,s){return applyEase(easeInBez,t,e,r,n,s)}function ease(t,e,r,n,s){return applyEase(easeInOutBez,t,e,r,n,s)}function applyEase(t,e,r,n,s,a){s===void 0?(s=r,a=n):e=(e-r)/(n-r),e>1?e=1:e<0&&(e=0);var o=t(e);if($bm_isInstanceOfArray(s)){var l,u=s.length,c=createTypedArray("float32",u);for(l=0;l<u;l+=1)c[l]=(a[l]-s[l])*o+s[l];return c}return(a-s)*o+s}function nearestKey(t){var e,r=data.k.length,n,s;if(!data.k.length||typeof data.k[0]=="number")n=0,s=0;else if(n=-1,t*=elem.comp.globalData.frameRate,t<data.k[0].t)n=1,s=data.k[0].t;else{for(e=0;e<r-1;e+=1)if(t===data.k[e].t){n=e+1,s=data.k[e].t;break}else if(t>data.k[e].t&&t<data.k[e+1].t){t-data.k[e].t>data.k[e+1].t-t?(n=e+2,s=data.k[e+1].t):(n=e+1,s=data.k[e].t);break}n===-1&&(n=e+1,s=data.k[e].t)}var a={};return a.index=n,a.time=s/elem.comp.globalData.frameRate,a}function key(t){var e,r,n;if(!data.k.length||typeof data.k[0]=="number")throw new Error("The property has no keyframe at index "+t);t-=1,e={time:data.k[t].t/elem.comp.globalData.frameRate,value:[]};var s=Object.prototype.hasOwnProperty.call(data.k[t],"s")?data.k[t].s:data.k[t-1].e;for(n=s.length,r=0;r<n;r+=1)e[r]=s[r],e.value[r]=s[r];return e}function framesToTime(t,e){return e||(e=elem.comp.globalData.frameRate),t/e}function timeToFrames(t,e){return!t&&t!==0&&(t=time),e||(e=elem.comp.globalData.frameRate),t*e}function seedRandom(t){BMMath.seedrandom(randSeed+t)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(t,e){return typeof value=="string"?e===void 0?value.substring(t):value.substring(t,e):""}function substr(t,e){return typeof value=="string"?e===void 0?value.substr(t):value.substr(t,e):""}function posterizeTime(t){time=t===0?0:Math.floor(time*t)/t,value=valueAtTime(time)}var time,velocity,value,text,textIndex,textTotal,selectorValue,index=elem.data.ind,hasParent=!!(elem.hierarchy&&elem.hierarchy.length),parent,randSeed=Math.floor(Math.random()*1e6),globalData=elem.globalData;function executeExpression(t){return value=t,this.frameExpressionId===elem.globalData.frameId&&this.propType!=="textSelector"?value:(this.propType==="textSelector"&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform,transform&&(anchorPoint=transform.anchorPoint)),elemType===4&&!content&&(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),hasParent=!!(elem.hierarchy&&elem.hierarchy.length),hasParent&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,_needsRandom&&seedRandom(randSeed+time),needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,scoped_bm_rt=scoped_bm_rt.propType===propTypes.SHAPE?scoped_bm_rt.v:scoped_bm_rt,scoped_bm_rt)}return executeExpression.__preventDeadCodeRemoval=[$bm_transform,anchorPoint,time,velocity,inPoint,outPoint,width,height,name,loop_in,loop_out,smooth,toComp,fromCompToSurface,toWorld,fromWorld,mask,position,rotation,scale,thisComp,numKeys,active,wiggle,loopInDuration,loopOutDuration,comp,lookAt,easeOut,easeIn,ease,nearestKey,key,text,textIndex,textTotal,selectorValue,framesToTime,timeToFrames,sourceRectAtTime,substring,substr,posterizeTime,index,globalData],executeExpression}return ob.initiateExpression=initiateExpression,ob.__preventDeadCodeRemoval=[window,document,XMLHttpRequest,fetch,frames,$bm_neg,add,$bm_sum,$bm_sub,$bm_mul,$bm_div,$bm_mod,clamp,radians_to_degrees,degreesToRadians,degrees_to_radians,normalize,rgbToHsl,hslToRgb,linear,random,createPath,_lottieGlobal],ob.resetFrame=resetFrame,ob}(),Expressions=function(){var t={};t.initExpressions=e,t.resetFrame=ExpressionManager.resetFrame;function e(r){var n=0,s=[];function a(){n+=1}function o(){n-=1,n===0&&u()}function l(c){s.indexOf(c)===-1&&s.push(c)}function u(){var c,d=s.length;for(c=0;c<d;c+=1)s[c].release();s.length=0}r.renderer.compInterface=CompExpressionInterface(r.renderer),r.renderer.globalData.projectInterface.registerComposition(r.renderer),r.renderer.globalData.pushExpression=a,r.renderer.globalData.popExpression=o,r.renderer.globalData.registerExpressionProperty=l}return t}(),MaskManagerInterface=function(){function t(r,n){this._mask=r,this._data=n}Object.defineProperty(t.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(t.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),this._mask.op.v*100}});var e=function(n){var s=createSizedArray(n.viewData.length),a,o=n.viewData.length;for(a=0;a<o;a+=1)s[a]=new t(n.viewData[a],n.masksProperties[a]);var l=function(c){for(a=0;a<o;){if(n.masksProperties[a].nm===c)return s[a];a+=1}return null};return l};return e}(),ExpressionPropertyInterface=function(){var t={pv:0,v:0,mult:1},e={pv:[0,0,0],v:[0,0,0],mult:1};function r(o,l,u){Object.defineProperty(o,"velocity",{get:function(){return l.getVelocityAtTime(l.comp.currentFrame)}}),o.numKeys=l.keyframes?l.keyframes.length:0,o.key=function(c){if(!o.numKeys)return 0;var d="";"s"in l.keyframes[c-1]?d=l.keyframes[c-1].s:"e"in l.keyframes[c-2]?d=l.keyframes[c-2].e:d=l.keyframes[c-2].s;var p=u==="unidimensional"?new Number(d):Object.assign({},d);return p.time=l.keyframes[c-1].t/l.elem.comp.globalData.frameRate,p.value=u==="unidimensional"?d[0]:d,p},o.valueAtTime=l.getValueAtTime,o.speedAtTime=l.getSpeedAtTime,o.velocityAtTime=l.getVelocityAtTime,o.propertyGroup=l.propertyGroup}function n(o){(!o||!("pv"in o))&&(o=t);var l=1/o.mult,u=o.pv*l,c=new Number(u);return c.value=u,r(c,o,"unidimensional"),function(){return o.k&&o.getValue(),u=o.v*l,c.value!==u&&(c=new Number(u),c.value=u,c[0]=u,r(c,o,"unidimensional")),c}}function s(o){(!o||!("pv"in o))&&(o=e);var l=1/o.mult,u=o.data&&o.data.l||o.pv.length,c=createTypedArray("float32",u),d=createTypedArray("float32",u);return c.value=d,r(c,o,"multidimensional"),function(){o.k&&o.getValue();for(var p=0;p<u;p+=1)d[p]=o.v[p]*l,c[p]=d[p];return c}}function a(){return t}return function(o){return o?o.propType==="unidimensional"?n(o):s(o):a}}(),TransformExpressionInterface=function(){return function(t){function e(o){switch(o){case"scale":case"Scale":case"ADBE Scale":case 6:return e.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return e.rotation;case"ADBE Rotate X":return e.xRotation;case"ADBE Rotate Y":return e.yRotation;case"position":case"Position":case"ADBE Position":case 2:return e.position;case"ADBE Position_0":return e.xPosition;case"ADBE Position_1":return e.yPosition;case"ADBE Position_2":return e.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return e.anchorPoint;case"opacity":case"Opacity":case 11:return e.opacity;default:return null}}Object.defineProperty(e,"rotation",{get:ExpressionPropertyInterface(t.r||t.rz)}),Object.defineProperty(e,"zRotation",{get:ExpressionPropertyInterface(t.rz||t.r)}),Object.defineProperty(e,"xRotation",{get:ExpressionPropertyInterface(t.rx)}),Object.defineProperty(e,"yRotation",{get:ExpressionPropertyInterface(t.ry)}),Object.defineProperty(e,"scale",{get:ExpressionPropertyInterface(t.s)});var r,n,s,a;return t.p?a=ExpressionPropertyInterface(t.p):(r=ExpressionPropertyInterface(t.px),n=ExpressionPropertyInterface(t.py),t.pz&&(s=ExpressionPropertyInterface(t.pz))),Object.defineProperty(e,"position",{get:function(){return t.p?a():[r(),n(),s?s():0]}}),Object.defineProperty(e,"xPosition",{get:ExpressionPropertyInterface(t.px)}),Object.defineProperty(e,"yPosition",{get:ExpressionPropertyInterface(t.py)}),Object.defineProperty(e,"zPosition",{get:ExpressionPropertyInterface(t.pz)}),Object.defineProperty(e,"anchorPoint",{get:ExpressionPropertyInterface(t.a)}),Object.defineProperty(e,"opacity",{get:ExpressionPropertyInterface(t.o)}),Object.defineProperty(e,"skew",{get:ExpressionPropertyInterface(t.sk)}),Object.defineProperty(e,"skewAxis",{get:ExpressionPropertyInterface(t.sa)}),Object.defineProperty(e,"orientation",{get:ExpressionPropertyInterface(t.or)}),e}}(),LayerExpressionInterface=function(){function t(c){var d=new Matrix;if(c!==void 0){var p=this._elem.finalTransform.mProp.getValueAtTime(c);p.clone(d)}else{var m=this._elem.finalTransform.mProp;m.applyToMatrix(d)}return d}function e(c,d){var p=this.getMatrix(d);return p.props[12]=0,p.props[13]=0,p.props[14]=0,this.applyPoint(p,c)}function r(c,d){var p=this.getMatrix(d);return this.applyPoint(p,c)}function n(c,d){var p=this.getMatrix(d);return p.props[12]=0,p.props[13]=0,p.props[14]=0,this.invertPoint(p,c)}function s(c,d){var p=this.getMatrix(d);return this.invertPoint(p,c)}function a(c,d){if(this._elem.hierarchy&&this._elem.hierarchy.length){var p,m=this._elem.hierarchy.length;for(p=0;p<m;p+=1)this._elem.hierarchy[p].finalTransform.mProp.applyToMatrix(c)}return c.applyToPointArray(d[0],d[1],d[2]||0)}function o(c,d){if(this._elem.hierarchy&&this._elem.hierarchy.length){var p,m=this._elem.hierarchy.length;for(p=0;p<m;p+=1)this._elem.hierarchy[p].finalTransform.mProp.applyToMatrix(c)}return c.inversePoint(d)}function l(c){var d=new Matrix;if(d.reset(),this._elem.finalTransform.mProp.applyToMatrix(d),this._elem.hierarchy&&this._elem.hierarchy.length){var p,m=this._elem.hierarchy.length;for(p=0;p<m;p+=1)this._elem.hierarchy[p].finalTransform.mProp.applyToMatrix(d);return d.inversePoint(c)}return d.inversePoint(c)}function u(){return[1,1,1,1]}return function(c){var d;function p(E){y.mask=new MaskManagerInterface(E,c)}function m(E){y.effect=E}function y(E){switch(E){case"ADBE Root Vectors Group":case"Contents":case 2:return y.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return d;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return y.effect;case"ADBE Text Properties":return y.textInterface;default:return null}}y.getMatrix=t,y.invertPoint=o,y.applyPoint=a,y.toWorld=r,y.toWorldVec=e,y.fromWorld=s,y.fromWorldVec=n,y.toComp=r,y.fromComp=l,y.sampleImage=u,y.sourceRectAtTime=c.sourceRectAtTime.bind(c),y._elem=c,d=TransformExpressionInterface(c.finalTransform.mProp);var b=getDescriptor(d,"anchorPoint");return Object.defineProperties(y,{hasParent:{get:function(){return c.hierarchy.length}},parent:{get:function(){return c.hierarchy[0].layerInterface}},rotation:getDescriptor(d,"rotation"),scale:getDescriptor(d,"scale"),position:getDescriptor(d,"position"),opacity:getDescriptor(d,"opacity"),anchorPoint:b,anchor_point:b,transform:{get:function(){return d}},active:{get:function(){return c.isInRange}}}),y.startTime=c.data.st,y.index=c.data.ind,y.source=c.data.refId,y.height=c.data.ty===0?c.data.h:100,y.width=c.data.ty===0?c.data.w:100,y.inPoint=c.data.ip/c.comp.globalData.frameRate,y.outPoint=c.data.op/c.comp.globalData.frameRate,y._name=c.data.nm,y.registerMaskInterface=p,y.registerEffectsInterface=m,y}}(),propertyGroupFactory=function(){return function(t,e){return function(r){return r=r===void 0?1:r,r<=0?t:e(r-1)}}}(),PropertyInterface=function(){return function(t,e){var r={_name:t};function n(s){return s=s===void 0?1:s,s<=0?r:e(s-1)}return n}}(),EffectsExpressionInterface=function(){var t={createEffectsInterface:e};function e(s,a){if(s.effectsManager){var o=[],l=s.data.ef,u,c=s.effectsManager.effectElements.length;for(u=0;u<c;u+=1)o.push(r(l[u],s.effectsManager.effectElements[u],a,s));var d=s.data.ef||[],p=function(y){for(u=0,c=d.length;u<c;){if(y===d[u].nm||y===d[u].mn||y===d[u].ix)return o[u];u+=1}return null};return Object.defineProperty(p,"numProperties",{get:function(){return d.length}}),p}return null}function r(s,a,o,l){function u(y){for(var b=s.ef,E=0,T=b.length;E<T;){if(y===b[E].nm||y===b[E].mn||y===b[E].ix)return b[E].ty===5?d[E]:d[E]();E+=1}throw new Error}var c=propertyGroupFactory(u,o),d=[],p,m=s.ef.length;for(p=0;p<m;p+=1)s.ef[p].ty===5?d.push(r(s.ef[p],a.effectElements[p],a.effectElements[p].propertyGroup,l)):d.push(n(a.effectElements[p],s.ef[p].ty,l,c));return s.mn==="ADBE Color Control"&&Object.defineProperty(u,"color",{get:function(){return d[0]()}}),Object.defineProperties(u,{numProperties:{get:function(){return s.np}},_name:{value:s.nm},propertyGroup:{value:c}}),u.enabled=s.en!==0,u.active=u.enabled,u}function n(s,a,o,l){var u=ExpressionPropertyInterface(s.p);function c(){return a===10?o.comp.compInterface(s.p.v):u()}return s.p.setGroupProperty&&s.p.setGroupProperty(PropertyInterface("",l)),c}return t}(),ShapePathInterface=function(){return function(e,r,n){var s=r.sh;function a(l){return l==="Shape"||l==="shape"||l==="Path"||l==="path"||l==="ADBE Vector Shape"||l===2?a.path:null}var o=propertyGroupFactory(a,n);return s.setGroupProperty(PropertyInterface("Path",o)),Object.defineProperties(a,{path:{get:function(){return s.k&&s.getValue(),s}},shape:{get:function(){return s.k&&s.getValue(),s}},_name:{value:e.nm},ix:{value:e.ix},propertyIndex:{value:e.ix},mn:{value:e.mn},propertyGroup:{value:n}}),a}}(),ShapeExpressionInterface=function(){function t(b,E,T){var S=[],P,A=b?b.length:0;for(P=0;P<A;P+=1)b[P].ty==="gr"?S.push(r(b[P],E[P],T)):b[P].ty==="fl"?S.push(n(b[P],E[P],T)):b[P].ty==="st"?S.push(o(b[P],E[P],T)):b[P].ty==="tm"?S.push(l(b[P],E[P],T)):b[P].ty==="tr"||(b[P].ty==="el"?S.push(c(b[P],E[P],T)):b[P].ty==="sr"?S.push(d(b[P],E[P],T)):b[P].ty==="sh"?S.push(ShapePathInterface(b[P],E[P],T)):b[P].ty==="rc"?S.push(p(b[P],E[P],T)):b[P].ty==="rd"?S.push(m(b[P],E[P],T)):b[P].ty==="rp"?S.push(y(b[P],E[P],T)):b[P].ty==="gf"?S.push(s(b[P],E[P],T)):S.push(a(b[P],E[P])));return S}function e(b,E,T){var S,P=function(j){for(var K=0,W=S.length;K<W;){if(S[K]._name===j||S[K].mn===j||S[K].propertyIndex===j||S[K].ix===j||S[K].ind===j)return S[K];K+=1}return typeof j=="number"?S[j-1]:null};P.propertyGroup=propertyGroupFactory(P,T),S=t(b.it,E.it,P.propertyGroup),P.numProperties=S.length;var A=u(b.it[b.it.length-1],E.it[E.it.length-1],P.propertyGroup);return P.transform=A,P.propertyIndex=b.cix,P._name=b.nm,P}function r(b,E,T){var S=function(j){switch(j){case"ADBE Vectors Group":case"Contents":case 2:return S.content;default:return S.transform}};S.propertyGroup=propertyGroupFactory(S,T);var P=e(b,E,S.propertyGroup),A=u(b.it[b.it.length-1],E.it[E.it.length-1],S.propertyGroup);return S.content=P,S.transform=A,Object.defineProperty(S,"_name",{get:function(){return b.nm}}),S.numProperties=b.np,S.propertyIndex=b.ix,S.nm=b.nm,S.mn=b.mn,S}function n(b,E,T){function S(P){return P==="Color"||P==="color"?S.color:P==="Opacity"||P==="opacity"?S.opacity:null}return Object.defineProperties(S,{color:{get:ExpressionPropertyInterface(E.c)},opacity:{get:ExpressionPropertyInterface(E.o)},_name:{value:b.nm},mn:{value:b.mn}}),E.c.setGroupProperty(PropertyInterface("Color",T)),E.o.setGroupProperty(PropertyInterface("Opacity",T)),S}function s(b,E,T){function S(P){return P==="Start Point"||P==="start point"?S.startPoint:P==="End Point"||P==="end point"?S.endPoint:P==="Opacity"||P==="opacity"?S.opacity:null}return Object.defineProperties(S,{startPoint:{get:ExpressionPropertyInterface(E.s)},endPoint:{get:ExpressionPropertyInterface(E.e)},opacity:{get:ExpressionPropertyInterface(E.o)},type:{get:function(){return"a"}},_name:{value:b.nm},mn:{value:b.mn}}),E.s.setGroupProperty(PropertyInterface("Start Point",T)),E.e.setGroupProperty(PropertyInterface("End Point",T)),E.o.setGroupProperty(PropertyInterface("Opacity",T)),S}function a(){function b(){return null}return b}function o(b,E,T){var S=propertyGroupFactory(W,T),P=propertyGroupFactory(K,S);function A(H){Object.defineProperty(K,b.d[H].nm,{get:ExpressionPropertyInterface(E.d.dataProps[H].p)})}var I,j=b.d?b.d.length:0,K={};for(I=0;I<j;I+=1)A(I),E.d.dataProps[I].p.setGroupProperty(P);function W(H){return H==="Color"||H==="color"?W.color:H==="Opacity"||H==="opacity"?W.opacity:H==="Stroke Width"||H==="stroke width"?W.strokeWidth:null}return Object.defineProperties(W,{color:{get:ExpressionPropertyInterface(E.c)},opacity:{get:ExpressionPropertyInterface(E.o)},strokeWidth:{get:ExpressionPropertyInterface(E.w)},dash:{get:function(){return K}},_name:{value:b.nm},mn:{value:b.mn}}),E.c.setGroupProperty(PropertyInterface("Color",S)),E.o.setGroupProperty(PropertyInterface("Opacity",S)),E.w.setGroupProperty(PropertyInterface("Stroke Width",S)),W}function l(b,E,T){function S(A){return A===b.e.ix||A==="End"||A==="end"?S.end:A===b.s.ix?S.start:A===b.o.ix?S.offset:null}var P=propertyGroupFactory(S,T);return S.propertyIndex=b.ix,E.s.setGroupProperty(PropertyInterface("Start",P)),E.e.setGroupProperty(PropertyInterface("End",P)),E.o.setGroupProperty(PropertyInterface("Offset",P)),S.propertyIndex=b.ix,S.propertyGroup=T,Object.defineProperties(S,{start:{get:ExpressionPropertyInterface(E.s)},end:{get:ExpressionPropertyInterface(E.e)},offset:{get:ExpressionPropertyInterface(E.o)},_name:{value:b.nm}}),S.mn=b.mn,S}function u(b,E,T){function S(A){return b.a.ix===A||A==="Anchor Point"?S.anchorPoint:b.o.ix===A||A==="Opacity"?S.opacity:b.p.ix===A||A==="Position"?S.position:b.r.ix===A||A==="Rotation"||A==="ADBE Vector Rotation"?S.rotation:b.s.ix===A||A==="Scale"?S.scale:b.sk&&b.sk.ix===A||A==="Skew"?S.skew:b.sa&&b.sa.ix===A||A==="Skew Axis"?S.skewAxis:null}var P=propertyGroupFactory(S,T);return E.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",P)),E.transform.mProps.p.setGroupProperty(PropertyInterface("Position",P)),E.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",P)),E.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",P)),E.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",P)),E.transform.mProps.sk&&(E.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",P)),E.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",P))),E.transform.op.setGroupProperty(PropertyInterface("Opacity",P)),Object.defineProperties(S,{opacity:{get:ExpressionPropertyInterface(E.transform.mProps.o)},position:{get:ExpressionPropertyInterface(E.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(E.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(E.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(E.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(E.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(E.transform.mProps.sa)},_name:{value:b.nm}}),S.ty="tr",S.mn=b.mn,S.propertyGroup=T,S}function c(b,E,T){function S(I){return b.p.ix===I?S.position:b.s.ix===I?S.size:null}var P=propertyGroupFactory(S,T);S.propertyIndex=b.ix;var A=E.sh.ty==="tm"?E.sh.prop:E.sh;return A.s.setGroupProperty(PropertyInterface("Size",P)),A.p.setGroupProperty(PropertyInterface("Position",P)),Object.defineProperties(S,{size:{get:ExpressionPropertyInterface(A.s)},position:{get:ExpressionPropertyInterface(A.p)},_name:{value:b.nm}}),S.mn=b.mn,S}function d(b,E,T){function S(I){return b.p.ix===I?S.position:b.r.ix===I?S.rotation:b.pt.ix===I?S.points:b.or.ix===I||I==="ADBE Vector Star Outer Radius"?S.outerRadius:b.os.ix===I?S.outerRoundness:b.ir&&(b.ir.ix===I||I==="ADBE Vector Star Inner Radius")?S.innerRadius:b.is&&b.is.ix===I?S.innerRoundness:null}var P=propertyGroupFactory(S,T),A=E.sh.ty==="tm"?E.sh.prop:E.sh;return S.propertyIndex=b.ix,A.or.setGroupProperty(PropertyInterface("Outer Radius",P)),A.os.setGroupProperty(PropertyInterface("Outer Roundness",P)),A.pt.setGroupProperty(PropertyInterface("Points",P)),A.p.setGroupProperty(PropertyInterface("Position",P)),A.r.setGroupProperty(PropertyInterface("Rotation",P)),b.ir&&(A.ir.setGroupProperty(PropertyInterface("Inner Radius",P)),A.is.setGroupProperty(PropertyInterface("Inner Roundness",P))),Object.defineProperties(S,{position:{get:ExpressionPropertyInterface(A.p)},rotation:{get:ExpressionPropertyInterface(A.r)},points:{get:ExpressionPropertyInterface(A.pt)},outerRadius:{get:ExpressionPropertyInterface(A.or)},outerRoundness:{get:ExpressionPropertyInterface(A.os)},innerRadius:{get:ExpressionPropertyInterface(A.ir)},innerRoundness:{get:ExpressionPropertyInterface(A.is)},_name:{value:b.nm}}),S.mn=b.mn,S}function p(b,E,T){function S(I){return b.p.ix===I?S.position:b.r.ix===I?S.roundness:b.s.ix===I||I==="Size"||I==="ADBE Vector Rect Size"?S.size:null}var P=propertyGroupFactory(S,T),A=E.sh.ty==="tm"?E.sh.prop:E.sh;return S.propertyIndex=b.ix,A.p.setGroupProperty(PropertyInterface("Position",P)),A.s.setGroupProperty(PropertyInterface("Size",P)),A.r.setGroupProperty(PropertyInterface("Rotation",P)),Object.defineProperties(S,{position:{get:ExpressionPropertyInterface(A.p)},roundness:{get:ExpressionPropertyInterface(A.r)},size:{get:ExpressionPropertyInterface(A.s)},_name:{value:b.nm}}),S.mn=b.mn,S}function m(b,E,T){function S(I){return b.r.ix===I||I==="Round Corners 1"?S.radius:null}var P=propertyGroupFactory(S,T),A=E;return S.propertyIndex=b.ix,A.rd.setGroupProperty(PropertyInterface("Radius",P)),Object.defineProperties(S,{radius:{get:ExpressionPropertyInterface(A.rd)},_name:{value:b.nm}}),S.mn=b.mn,S}function y(b,E,T){function S(I){return b.c.ix===I||I==="Copies"?S.copies:b.o.ix===I||I==="Offset"?S.offset:null}var P=propertyGroupFactory(S,T),A=E;return S.propertyIndex=b.ix,A.c.setGroupProperty(PropertyInterface("Copies",P)),A.o.setGroupProperty(PropertyInterface("Offset",P)),Object.defineProperties(S,{copies:{get:ExpressionPropertyInterface(A.c)},offset:{get:ExpressionPropertyInterface(A.o)},_name:{value:b.nm}}),S.mn=b.mn,S}return function(b,E,T){var S;function P(I){if(typeof I=="number")return I=I===void 0?1:I,I===0?T:S[I-1];for(var j=0,K=S.length;j<K;){if(S[j]._name===I)return S[j];j+=1}return null}function A(){return T}return P.propertyGroup=propertyGroupFactory(P,A),S=t(b,E,P.propertyGroup),P.numProperties=S.length,P._name="Contents",P}}(),TextExpressionInterface=function(){return function(t){var e;function r(n){switch(n){case"ADBE Text Document":return r.sourceText;default:return null}}return Object.defineProperty(r,"sourceText",{get:function(){t.textProperty.getValue();var s=t.textProperty.currentData.t;return(!e||s!==e.value)&&(e=new String(s),e.value=s||new String(s),Object.defineProperty(e,"style",{get:function(){return{fillColor:t.textProperty.currentData.fc}}})),e}}),r}}();function _typeof(t){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(t)}var FootageInterface=function(){var t=function(n){var s="",a=n.getFootageData();function o(){return s="",a=n.getFootageData(),l}function l(u){if(a[u])return s=u,a=a[u],_typeof(a)==="object"?l:a;var c=u.indexOf(s);if(c!==-1){var d=parseInt(u.substr(c+s.length),10);return a=a[d],_typeof(a)==="object"?l:a}return""}return o},e=function(n){function s(a){return a==="Outline"?s.outlineInterface():null}return s._name="Outline",s.outlineInterface=t(n),s};return function(r){function n(s){return s==="Data"?n.dataInterface:null}return n._name="Data",n.dataInterface=e(r),n}}(),interfaces={layer:LayerExpressionInterface,effects:EffectsExpressionInterface,comp:CompExpressionInterface,shape:ShapeExpressionInterface,text:TextExpressionInterface,footage:FootageInterface};function getInterface(t){return interfaces[t]||null}var expressionHelpers=function(){function t(o,l,u){l.x&&(u.k=!0,u.x=!0,u.initiateExpression=ExpressionManager.initiateExpression,u.effectsSequence.push(u.initiateExpression(o,l,u).bind(u)))}function e(o){return o*=this.elem.globalData.frameRate,o-=this.offsetTime,o!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<o?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(o,this._cachingAtTime),this._cachingAtTime.lastFrame=o),this._cachingAtTime.value}function r(o){var l=-.01,u=this.getValueAtTime(o),c=this.getValueAtTime(o+l),d=0;if(u.length){var p;for(p=0;p<u.length;p+=1)d+=Math.pow(c[p]-u[p],2);d=Math.sqrt(d)*100}else d=0;return d}function n(o){if(this.vel!==void 0)return this.vel;var l=-.001,u=this.getValueAtTime(o),c=this.getValueAtTime(o+l),d;if(u.length){d=createTypedArray("float32",u.length);var p;for(p=0;p<u.length;p+=1)d[p]=(c[p]-u[p])/l}else d=(c-u)/l;return d}function s(){return this.pv}function a(o){this.propertyGroup=o}return{searchExpressions:t,getSpeedAtTime:r,getVelocityAtTime:n,getValueAtTime:e,getStaticValueAtTime:s,setGroupProperty:a}}();function addPropertyDecorator(){function t(m,y,b){if(!this.k||!this.keyframes)return this.pv;m=m?m.toLowerCase():"";var E=this.comp.renderedFrame,T=this.keyframes,S=T[T.length-1].t;if(E<=S)return this.pv;var P,A;b?(y?P=Math.abs(S-this.elem.comp.globalData.frameRate*y):P=Math.max(0,S-this.elem.data.ip),A=S-P):((!y||y>T.length-1)&&(y=T.length-1),A=T[T.length-1-y].t,P=S-A);var I,j,K;if(m==="pingpong"){var W=Math.floor((E-A)/P);if(W%2!==0)return this.getValueAtTime((P-(E-A)%P+A)/this.comp.globalData.frameRate,0)}else if(m==="offset"){var H=this.getValueAtTime(A/this.comp.globalData.frameRate,0),ee=this.getValueAtTime(S/this.comp.globalData.frameRate,0),ue=this.getValueAtTime(((E-A)%P+A)/this.comp.globalData.frameRate,0),de=Math.floor((E-A)/P);if(this.pv.length){for(K=new Array(H.length),j=K.length,I=0;I<j;I+=1)K[I]=(ee[I]-H[I])*de+ue[I];return K}return(ee-H)*de+ue}else if(m==="continue"){var fe=this.getValueAtTime(S/this.comp.globalData.frameRate,0),ae=this.getValueAtTime((S-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(K=new Array(fe.length),j=K.length,I=0;I<j;I+=1)K[I]=fe[I]+(fe[I]-ae[I])*((E-S)/this.comp.globalData.frameRate)/5e-4;return K}return fe+(fe-ae)*((E-S)/.001)}return this.getValueAtTime(((E-A)%P+A)/this.comp.globalData.frameRate,0)}function e(m,y,b){if(!this.k)return this.pv;m=m?m.toLowerCase():"";var E=this.comp.renderedFrame,T=this.keyframes,S=T[0].t;if(E>=S)return this.pv;var P,A;b?(y?P=Math.abs(this.elem.comp.globalData.frameRate*y):P=Math.max(0,this.elem.data.op-S),A=S+P):((!y||y>T.length-1)&&(y=T.length-1),A=T[y].t,P=A-S);var I,j,K;if(m==="pingpong"){var W=Math.floor((S-E)/P);if(W%2===0)return this.getValueAtTime(((S-E)%P+S)/this.comp.globalData.frameRate,0)}else if(m==="offset"){var H=this.getValueAtTime(S/this.comp.globalData.frameRate,0),ee=this.getValueAtTime(A/this.comp.globalData.frameRate,0),ue=this.getValueAtTime((P-(S-E)%P+S)/this.comp.globalData.frameRate,0),de=Math.floor((S-E)/P)+1;if(this.pv.length){for(K=new Array(H.length),j=K.length,I=0;I<j;I+=1)K[I]=ue[I]-(ee[I]-H[I])*de;return K}return ue-(ee-H)*de}else if(m==="continue"){var fe=this.getValueAtTime(S/this.comp.globalData.frameRate,0),ae=this.getValueAtTime((S+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(K=new Array(fe.length),j=K.length,I=0;I<j;I+=1)K[I]=fe[I]+(fe[I]-ae[I])*(S-E)/.001;return K}return fe+(fe-ae)*(S-E)/.001}return this.getValueAtTime((P-((S-E)%P+S))/this.comp.globalData.frameRate,0)}function r(m,y){if(!this.k)return this.pv;if(m=(m||.4)*.5,y=Math.floor(y||5),y<=1)return this.pv;var b=this.comp.renderedFrame/this.comp.globalData.frameRate,E=b-m,T=b+m,S=y>1?(T-E)/(y-1):1,P=0,A=0,I;this.pv.length?I=createTypedArray("float32",this.pv.length):I=0;for(var j;P<y;){if(j=this.getValueAtTime(E+P*S),this.pv.length)for(A=0;A<this.pv.length;A+=1)I[A]+=j[A];else I+=j;P+=1}if(this.pv.length)for(A=0;A<this.pv.length;A+=1)I[A]/=y;else I/=y;return I}function n(m){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix});var y=this._transformCachingAtTime.v;if(y.cloneFromProps(this.pre.props),this.appliedTransformations<1){var b=this.a.getValueAtTime(m);y.translate(-b[0]*this.a.mult,-b[1]*this.a.mult,b[2]*this.a.mult)}if(this.appliedTransformations<2){var E=this.s.getValueAtTime(m);y.scale(E[0]*this.s.mult,E[1]*this.s.mult,E[2]*this.s.mult)}if(this.sk&&this.appliedTransformations<3){var T=this.sk.getValueAtTime(m),S=this.sa.getValueAtTime(m);y.skewFromAxis(-T*this.sk.mult,S*this.sa.mult)}if(this.r&&this.appliedTransformations<4){var P=this.r.getValueAtTime(m);y.rotate(-P*this.r.mult)}else if(!this.r&&this.appliedTransformations<4){var A=this.rz.getValueAtTime(m),I=this.ry.getValueAtTime(m),j=this.rx.getValueAtTime(m),K=this.or.getValueAtTime(m);y.rotateZ(-A*this.rz.mult).rotateY(I*this.ry.mult).rotateX(j*this.rx.mult).rotateZ(-K[2]*this.or.mult).rotateY(K[1]*this.or.mult).rotateX(K[0]*this.or.mult)}if(this.data.p&&this.data.p.s){var W=this.px.getValueAtTime(m),H=this.py.getValueAtTime(m);if(this.data.p.z){var ee=this.pz.getValueAtTime(m);y.translate(W*this.px.mult,H*this.py.mult,-ee*this.pz.mult)}else y.translate(W*this.px.mult,H*this.py.mult,0)}else{var ue=this.p.getValueAtTime(m);y.translate(ue[0]*this.p.mult,ue[1]*this.p.mult,-ue[2]*this.p.mult)}return y}function s(){return this.v.clone(new Matrix)}var a=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(m,y,b){var E=a(m,y,b);return E.dynamicProperties.length?E.getValueAtTime=n.bind(E):E.getValueAtTime=s.bind(E),E.setGroupProperty=expressionHelpers.setGroupProperty,E};var o=PropertyFactory.getProp;PropertyFactory.getProp=function(m,y,b,E,T){var S=o(m,y,b,E,T);S.kf?S.getValueAtTime=expressionHelpers.getValueAtTime.bind(S):S.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(S),S.setGroupProperty=expressionHelpers.setGroupProperty,S.loopOut=t,S.loopIn=e,S.smooth=r,S.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(S),S.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(S),S.numKeys=y.a===1?y.k.length:0,S.propertyIndex=y.ix;var P=0;return b!==0&&(P=createTypedArray("float32",y.a===1?y.k[0].s.length:y.k.length)),S._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:P},expressionHelpers.searchExpressions(m,y,S),S.k&&T.addDynamicProperty(S),S};function l(m){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),m*=this.elem.globalData.frameRate,m-=this.offsetTime,m!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<m?this._caching.lastIndex:0,this._cachingAtTime.lastTime=m,this.interpolateShape(m,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue}var u=ShapePropertyFactory.getConstructorFunction(),c=ShapePropertyFactory.getKeyframedConstructorFunction();function d(){}d.prototype={vertices:function(y,b){this.k&&this.getValue();var E=this.v;b!==void 0&&(E=this.getValueAtTime(b,0));var T,S=E._length,P=E[y],A=E.v,I=createSizedArray(S);for(T=0;T<S;T+=1)y==="i"||y==="o"?I[T]=[P[T][0]-A[T][0],P[T][1]-A[T][1]]:I[T]=[P[T][0],P[T][1]];return I},points:function(y){return this.vertices("v",y)},inTangents:function(y){return this.vertices("i",y)},outTangents:function(y){return this.vertices("o",y)},isClosed:function(){return this.v.c},pointOnPath:function(y,b){var E=this.v;b!==void 0&&(E=this.getValueAtTime(b,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(E));for(var T=this._segmentsLength,S=T.lengths,P=T.totalLength*y,A=0,I=S.length,j=0,K;A<I;){if(j+S[A].addedLength>P){var W=A,H=E.c&&A===I-1?0:A+1,ee=(P-j)/S[A].addedLength;K=bez.getPointInSegment(E.v[W],E.v[H],E.o[W],E.i[H],ee,S[A]);break}else j+=S[A].addedLength;A+=1}return K||(K=E.c?[E.v[0][0],E.v[0][1]]:[E.v[E._length-1][0],E.v[E._length-1][1]]),K},vectorOnPath:function(y,b,E){y==1?y=this.v.c:y==0&&(y=.999);var T=this.pointOnPath(y,b),S=this.pointOnPath(y+.001,b),P=S[0]-T[0],A=S[1]-T[1],I=Math.sqrt(Math.pow(P,2)+Math.pow(A,2));if(I===0)return[0,0];var j=E==="tangent"?[P/I,A/I]:[-A/I,P/I];return j},tangentOnPath:function(y,b){return this.vectorOnPath(y,b,"tangent")},normalOnPath:function(y,b){return this.vectorOnPath(y,b,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([d],u),extendPrototype([d],c),c.prototype.getValueAtTime=l,c.prototype.initiateExpression=ExpressionManager.initiateExpression;var p=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(m,y,b,E,T){var S=p(m,y,b,E,T);return S.propertyIndex=y.ix,S.lock=!1,b===3?expressionHelpers.searchExpressions(m,y.pt,S):b===4&&expressionHelpers.searchExpressions(m,y.ks,S),S.k&&m.addDynamicProperty(S),S}}function initialize$1(){addPropertyDecorator()}function addDecorator(){function t(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null}TextProperty.prototype.getExpressionValue=function(e,r){var n=this.calculateExpression(r);if(e.t!==n){var s={};return this.copyData(s,e),s.t=n.toString(),s.__complete=!1,s}return e},TextProperty.prototype.searchProperty=function(){var e=this.searchKeyframes(),r=this.searchExpressions();return this.kf=e||r,this.kf},TextProperty.prototype.searchExpressions=t}function initialize(){addDecorator()}function SVGComposableEffect(){}SVGComposableEffect.prototype={createMergeNode:function t(e,r){var n=createNS("feMerge");n.setAttribute("result",e);var s,a;for(a=0;a<r.length;a+=1)s=createNS("feMergeNode"),s.setAttribute("in",r[a]),n.appendChild(s),n.appendChild(s);return n}};var linearFilterValue="0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0";function SVGTintFilter(t,e,r,n,s){this.filterManager=e;var a=createNS("feColorMatrix");a.setAttribute("type","matrix"),a.setAttribute("color-interpolation-filters","linearRGB"),a.setAttribute("values",linearFilterValue+" 1 0"),this.linearFilter=a,a.setAttribute("result",n+"_tint_1"),t.appendChild(a),a=createNS("feColorMatrix"),a.setAttribute("type","matrix"),a.setAttribute("color-interpolation-filters","sRGB"),a.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),a.setAttribute("result",n+"_tint_2"),t.appendChild(a),this.matrixFilter=a;var o=this.createMergeNode(n,[s,n+"_tint_1",n+"_tint_2"]);t.appendChild(o)}extendPrototype([SVGComposableEffect],SVGTintFilter),SVGTintFilter.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e=this.filterManager.effectElements[0].p.v,r=this.filterManager.effectElements[1].p.v,n=this.filterManager.effectElements[2].p.v/100;this.linearFilter.setAttribute("values",linearFilterValue+" "+n+" 0"),this.matrixFilter.setAttribute("values",r[0]-e[0]+" 0 0 0 "+e[0]+" "+(r[1]-e[1])+" 0 0 0 "+e[1]+" "+(r[2]-e[2])+" 0 0 0 "+e[2]+" 0 0 0 1 0")}};function SVGFillFilter(t,e,r,n){this.filterManager=e;var s=createNS("feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),s.setAttribute("result",n),t.appendChild(s),this.matrixFilter=s}SVGFillFilter.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e=this.filterManager.effectElements[2].p.v,r=this.filterManager.effectElements[6].p.v;this.matrixFilter.setAttribute("values","0 0 0 0 "+e[0]+" 0 0 0 0 "+e[1]+" 0 0 0 0 "+e[2]+" 0 0 0 "+r+" 0")}};function SVGStrokeEffect(t,e,r){this.initialized=!1,this.filterManager=e,this.elem=r,this.paths=[]}SVGStrokeEffect.prototype.initialize=function(){var t=this.elem.layerElement.children||this.elem.layerElement.childNodes,e,r,n,s;for(this.filterManager.effectElements[1].p.v===1?(s=this.elem.maskManager.masksProperties.length,n=0):(n=this.filterManager.effectElements[0].p.v-1,s=n+1),r=createNS("g"),r.setAttribute("fill","none"),r.setAttribute("stroke-linecap","round"),r.setAttribute("stroke-dashoffset",1),n;n<s;n+=1)e=createNS("path"),r.appendChild(e),this.paths.push({p:e,m:n});if(this.filterManager.effectElements[10].p.v===3){var a=createNS("mask"),o=createElementID();a.setAttribute("id",o),a.setAttribute("mask-type","alpha"),a.appendChild(r),this.elem.globalData.defs.appendChild(a);var l=createNS("g");for(l.setAttribute("mask","url("+getLocationHref()+"#"+o+")");t[0];)l.appendChild(t[0]);this.elem.layerElement.appendChild(l),this.masker=a,r.setAttribute("stroke","#fff")}else if(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2){if(this.filterManager.effectElements[10].p.v===2)for(t=this.elem.layerElement.children||this.elem.layerElement.childNodes;t.length;)this.elem.layerElement.removeChild(t[0]);this.elem.layerElement.appendChild(r),this.elem.layerElement.removeAttribute("mask"),r.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=r},SVGStrokeEffect.prototype.renderFrame=function(t){this.initialized||this.initialize();var e,r=this.paths.length,n,s;for(e=0;e<r;e+=1)if(this.paths[e].m!==-1&&(n=this.elem.maskManager.viewData[this.paths[e].m],s=this.paths[e].p,(t||this.filterManager._mdf||n.prop._mdf)&&s.setAttribute("d",n.lastPath),t||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||n.prop._mdf)){var a;if(this.filterManager.effectElements[7].p.v!==0||this.filterManager.effectElements[8].p.v!==100){var o=Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,l=Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,u=s.getTotalLength();a="0 0 0 "+u*o+" ";var c=u*(l-o),d=1+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01,p=Math.floor(c/d),m;for(m=0;m<p;m+=1)a+="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01+" ";a+="0 "+u*10+" 0 0"}else a="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01;s.setAttribute("stroke-dasharray",a)}if((t||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",this.filterManager.effectElements[4].p.v*2),(t||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2)&&(t||this.filterManager.effectElements[3].p._mdf)){var y=this.filterManager.effectElements[3].p.v;this.pathMasker.setAttribute("stroke","rgb("+bmFloor(y[0]*255)+","+bmFloor(y[1]*255)+","+bmFloor(y[2]*255)+")")}};function SVGTritoneFilter(t,e,r,n){this.filterManager=e;var s=createNS("feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("color-interpolation-filters","linearRGB"),s.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),t.appendChild(s);var a=createNS("feComponentTransfer");a.setAttribute("color-interpolation-filters","sRGB"),a.setAttribute("result",n),this.matrixFilter=a;var o=createNS("feFuncR");o.setAttribute("type","table"),a.appendChild(o),this.feFuncR=o;var l=createNS("feFuncG");l.setAttribute("type","table"),a.appendChild(l),this.feFuncG=l;var u=createNS("feFuncB");u.setAttribute("type","table"),a.appendChild(u),this.feFuncB=u,t.appendChild(a)}SVGTritoneFilter.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e=this.filterManager.effectElements[0].p.v,r=this.filterManager.effectElements[1].p.v,n=this.filterManager.effectElements[2].p.v,s=n[0]+" "+r[0]+" "+e[0],a=n[1]+" "+r[1]+" "+e[1],o=n[2]+" "+r[2]+" "+e[2];this.feFuncR.setAttribute("tableValues",s),this.feFuncG.setAttribute("tableValues",a),this.feFuncB.setAttribute("tableValues",o)}};function SVGProLevelsFilter(t,e,r,n){this.filterManager=e;var s=this.filterManager.effectElements,a=createNS("feComponentTransfer");(s[10].p.k||s[10].p.v!==0||s[11].p.k||s[11].p.v!==1||s[12].p.k||s[12].p.v!==1||s[13].p.k||s[13].p.v!==0||s[14].p.k||s[14].p.v!==1)&&(this.feFuncR=this.createFeFunc("feFuncR",a)),(s[17].p.k||s[17].p.v!==0||s[18].p.k||s[18].p.v!==1||s[19].p.k||s[19].p.v!==1||s[20].p.k||s[20].p.v!==0||s[21].p.k||s[21].p.v!==1)&&(this.feFuncG=this.createFeFunc("feFuncG",a)),(s[24].p.k||s[24].p.v!==0||s[25].p.k||s[25].p.v!==1||s[26].p.k||s[26].p.v!==1||s[27].p.k||s[27].p.v!==0||s[28].p.k||s[28].p.v!==1)&&(this.feFuncB=this.createFeFunc("feFuncB",a)),(s[31].p.k||s[31].p.v!==0||s[32].p.k||s[32].p.v!==1||s[33].p.k||s[33].p.v!==1||s[34].p.k||s[34].p.v!==0||s[35].p.k||s[35].p.v!==1)&&(this.feFuncA=this.createFeFunc("feFuncA",a)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(a.setAttribute("color-interpolation-filters","sRGB"),t.appendChild(a)),(s[3].p.k||s[3].p.v!==0||s[4].p.k||s[4].p.v!==1||s[5].p.k||s[5].p.v!==1||s[6].p.k||s[6].p.v!==0||s[7].p.k||s[7].p.v!==1)&&(a=createNS("feComponentTransfer"),a.setAttribute("color-interpolation-filters","sRGB"),a.setAttribute("result",n),t.appendChild(a),this.feFuncRComposed=this.createFeFunc("feFuncR",a),this.feFuncGComposed=this.createFeFunc("feFuncG",a),this.feFuncBComposed=this.createFeFunc("feFuncB",a))}SVGProLevelsFilter.prototype.createFeFunc=function(t,e){var r=createNS(t);return r.setAttribute("type","table"),e.appendChild(r),r},SVGProLevelsFilter.prototype.getTableValue=function(t,e,r,n,s){for(var a=0,o=256,l,u=Math.min(t,e),c=Math.max(t,e),d=Array.call(null,{length:o}),p,m=0,y=s-n,b=e-t;a<=256;)l=a/256,l<=u?p=b<0?s:n:l>=c?p=b<0?n:s:p=n+y*Math.pow((l-t)/b,1/r),d[m]=p,m+=1,a+=256/(o-1);return d.join(" ")},SVGProLevelsFilter.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e,r=this.filterManager.effectElements;this.feFuncRComposed&&(t||r[3].p._mdf||r[4].p._mdf||r[5].p._mdf||r[6].p._mdf||r[7].p._mdf)&&(e=this.getTableValue(r[3].p.v,r[4].p.v,r[5].p.v,r[6].p.v,r[7].p.v),this.feFuncRComposed.setAttribute("tableValues",e),this.feFuncGComposed.setAttribute("tableValues",e),this.feFuncBComposed.setAttribute("tableValues",e)),this.feFuncR&&(t||r[10].p._mdf||r[11].p._mdf||r[12].p._mdf||r[13].p._mdf||r[14].p._mdf)&&(e=this.getTableValue(r[10].p.v,r[11].p.v,r[12].p.v,r[13].p.v,r[14].p.v),this.feFuncR.setAttribute("tableValues",e)),this.feFuncG&&(t||r[17].p._mdf||r[18].p._mdf||r[19].p._mdf||r[20].p._mdf||r[21].p._mdf)&&(e=this.getTableValue(r[17].p.v,r[18].p.v,r[19].p.v,r[20].p.v,r[21].p.v),this.feFuncG.setAttribute("tableValues",e)),this.feFuncB&&(t||r[24].p._mdf||r[25].p._mdf||r[26].p._mdf||r[27].p._mdf||r[28].p._mdf)&&(e=this.getTableValue(r[24].p.v,r[25].p.v,r[26].p.v,r[27].p.v,r[28].p.v),this.feFuncB.setAttribute("tableValues",e)),this.feFuncA&&(t||r[31].p._mdf||r[32].p._mdf||r[33].p._mdf||r[34].p._mdf||r[35].p._mdf)&&(e=this.getTableValue(r[31].p.v,r[32].p.v,r[33].p.v,r[34].p.v,r[35].p.v),this.feFuncA.setAttribute("tableValues",e))}};function SVGDropShadowEffect(t,e,r,n,s){var a=e.container.globalData.renderConfig.filterSize,o=e.data.fs||a;t.setAttribute("x",o.x||a.x),t.setAttribute("y",o.y||a.y),t.setAttribute("width",o.width||a.width),t.setAttribute("height",o.height||a.height),this.filterManager=e;var l=createNS("feGaussianBlur");l.setAttribute("in","SourceAlpha"),l.setAttribute("result",n+"_drop_shadow_1"),l.setAttribute("stdDeviation","0"),this.feGaussianBlur=l,t.appendChild(l);var u=createNS("feOffset");u.setAttribute("dx","25"),u.setAttribute("dy","0"),u.setAttribute("in",n+"_drop_shadow_1"),u.setAttribute("result",n+"_drop_shadow_2"),this.feOffset=u,t.appendChild(u);var c=createNS("feFlood");c.setAttribute("flood-color","#00ff00"),c.setAttribute("flood-opacity","1"),c.setAttribute("result",n+"_drop_shadow_3"),this.feFlood=c,t.appendChild(c);var d=createNS("feComposite");d.setAttribute("in",n+"_drop_shadow_3"),d.setAttribute("in2",n+"_drop_shadow_2"),d.setAttribute("operator","in"),d.setAttribute("result",n+"_drop_shadow_4"),t.appendChild(d);var p=this.createMergeNode(n,[n+"_drop_shadow_4",s]);t.appendChild(p)}extendPrototype([SVGComposableEffect],SVGDropShadowEffect),SVGDropShadowEffect.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){if((t||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),t||this.filterManager.effectElements[0].p._mdf){var e=this.filterManager.effectElements[0].p.v;this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(e[0]*255),Math.round(e[1]*255),Math.round(e[2]*255)))}if((t||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),t||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf){var r=this.filterManager.effectElements[3].p.v,n=(this.filterManager.effectElements[2].p.v-90)*degToRads,s=r*Math.cos(n),a=r*Math.sin(n);this.feOffset.setAttribute("dx",s),this.feOffset.setAttribute("dy",a)}}};var _svgMatteSymbols=[];function SVGMatte3Effect(t,e,r){this.initialized=!1,this.filterManager=e,this.filterElem=t,this.elem=r,r.matteElement=createNS("g"),r.matteElement.appendChild(r.layerElement),r.matteElement.appendChild(r.transformedElement),r.baseElement=r.matteElement}SVGMatte3Effect.prototype.findSymbol=function(t){for(var e=0,r=_svgMatteSymbols.length;e<r;){if(_svgMatteSymbols[e]===t)return _svgMatteSymbols[e];e+=1}return null},SVGMatte3Effect.prototype.replaceInParent=function(t,e){var r=t.layerElement.parentNode;if(r){for(var n=r.children,s=0,a=n.length;s<a&&n[s]!==t.layerElement;)s+=1;var o;s<=a-2&&(o=n[s+1]);var l=createNS("use");l.setAttribute("href","#"+e),o?r.insertBefore(l,o):r.appendChild(l)}},SVGMatte3Effect.prototype.setElementAsMask=function(t,e){if(!this.findSymbol(e)){var r=createElementID(),n=createNS("mask");n.setAttribute("id",e.layerId),n.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(e);var s=t.globalData.defs;s.appendChild(n);var a=createNS("symbol");a.setAttribute("id",r),this.replaceInParent(e,r),a.appendChild(e.layerElement),s.appendChild(a);var o=createNS("use");o.setAttribute("href","#"+r),n.appendChild(o),e.data.hd=!1,e.show()}t.setMatte(e.layerId)},SVGMatte3Effect.prototype.initialize=function(){for(var t=this.filterManager.effectElements[0].p.v,e=this.elem.comp.elements,r=0,n=e.length;r<n;)e[r]&&e[r].data.ind===t&&this.setElementAsMask(this.elem,e[r]),r+=1;this.initialized=!0},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize()};function SVGGaussianBlurEffect(t,e,r,n){t.setAttribute("x","-100%"),t.setAttribute("y","-100%"),t.setAttribute("width","300%"),t.setAttribute("height","300%"),this.filterManager=e;var s=createNS("feGaussianBlur");s.setAttribute("result",n),t.appendChild(s),this.feGaussianBlur=s}SVGGaussianBlurEffect.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e=.3,r=this.filterManager.effectElements[0].p.v*e,n=this.filterManager.effectElements[1].p.v,s=n==3?0:r,a=n==2?0:r;this.feGaussianBlur.setAttribute("stdDeviation",s+" "+a);var o=this.filterManager.effectElements[2].p.v==1?"wrap":"duplicate";this.feGaussianBlur.setAttribute("edgeMode",o)}};function TransformEffect(){}TransformEffect.prototype.init=function(t){this.effectsManager=t,this.type=effectTypes.TRANSFORM_EFFECT,this.matrix=new Matrix,this.opacity=-1,this._mdf=!1,this._opMdf=!1},TransformEffect.prototype.renderFrame=function(t){if(this._opMdf=!1,this._mdf=!1,t||this.effectsManager._mdf){var e=this.effectsManager.effectElements,r=e[0].p.v,n=e[1].p.v,s=e[2].p.v===1,a=e[3].p.v,o=s?a:e[4].p.v,l=e[5].p.v,u=e[6].p.v,c=e[7].p.v;this.matrix.reset(),this.matrix.translate(-r[0],-r[1],r[2]),this.matrix.scale(o*.01,a*.01,1),this.matrix.rotate(-c*degToRads),this.matrix.skewFromAxis(-l*degToRads,(u+90)*degToRads),this.matrix.translate(n[0],n[1],0),this._mdf=!0,this.opacity!==e[8].p.v&&(this.opacity=e[8].p.v,this._opMdf=!0)}};function SVGTransformEffect(t,e){this.init(e)}extendPrototype([TransformEffect],SVGTransformEffect);function CVTransformEffect(t){this.init(t)}return extendPrototype([TransformEffect],CVTransformEffect),registerRenderer("canvas",CanvasRenderer),registerRenderer("html",HybridRenderer),registerRenderer("svg",SVGRenderer),ShapeModifiers.registerModifier("tm",TrimModifier),ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeModifiers.registerModifier("rd",RoundCornersModifier),ShapeModifiers.registerModifier("zz",ZigZagModifier),ShapeModifiers.registerModifier("op",OffsetPathModifier),setExpressionsPlugin(Expressions),setExpressionInterfaces(getInterface),initialize$1(),initialize(),registerEffect$1(20,SVGTintFilter,!0),registerEffect$1(21,SVGFillFilter,!0),registerEffect$1(22,SVGStrokeEffect,!1),registerEffect$1(23,SVGTritoneFilter,!0),registerEffect$1(24,SVGProLevelsFilter,!0),registerEffect$1(25,SVGDropShadowEffect,!0),registerEffect$1(28,SVGMatte3Effect,!1),registerEffect$1(29,SVGGaussianBlurEffect,!0),registerEffect$1(35,SVGTransformEffect,!1),registerEffect(35,CVTransformEffect),lottie})}(lottie$2,lottie$2.exports)),lottie$2.exports}var lottieExports=requireLottie();const lottie=getDefaultExportFromCjs(lottieExports);function _arrayLikeToArray(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _defineProperty$1(t,e,r){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _iterableToArrayLimit(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,a,o,l=[],u=!0,c=!1;try{if(a=(r=r.call(t)).next,e!==0)for(;!(u=(n=a.call(r)).done)&&(l.push(n.value),l.length!==e);u=!0);}catch(d){c=!0,s=d}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw s}}return l}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ownKeys$1(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function _objectSpread2$1(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ownKeys$1(Object(r),!0).forEach(function(n){_defineProperty$1(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys$1(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function _objectWithoutProperties(t,e){if(t==null)return{};var r,n,s=_objectWithoutPropertiesLoose$1(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function _objectWithoutPropertiesLoose$1(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _toPrimitive(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return typeof e=="symbol"?e:e+""}function _unsupportedIterableToArray(t,e){if(t){if(typeof t=="string")return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}var _excluded$1$1=["animationData","loop","autoplay","initialSegment","onComplete","onLoopComplete","onEnterFrame","onSegmentStart","onConfigReady","onDataReady","onDataFailed","onLoadedImages","onDOMLoaded","onDestroy","lottieRef","renderer","name","assetsPath","rendererSettings"],useLottie=function t(e,r){var n=e.animationData,s=e.loop,a=e.autoplay,o=e.initialSegment,l=e.onComplete,u=e.onLoopComplete,c=e.onEnterFrame,d=e.onSegmentStart,p=e.onConfigReady,m=e.onDataReady,y=e.onDataFailed,b=e.onLoadedImages,E=e.onDOMLoaded,T=e.onDestroy;e.lottieRef,e.renderer,e.name,e.assetsPath,e.rendererSettings;var S=_objectWithoutProperties(e,_excluded$1$1),P=reactExports.useState(!1),A=_slicedToArray(P,2),I=A[0],j=A[1],K=reactExports.useRef(),W=reactExports.useRef(null),H=function(){var ye;(ye=K.current)===null||ye===void 0||ye.play()},ee=function(){var ye;(ye=K.current)===null||ye===void 0||ye.stop()},ue=function(){var ye;(ye=K.current)===null||ye===void 0||ye.pause()},de=function(ye){var Ee;(Ee=K.current)===null||Ee===void 0||Ee.setSpeed(ye)},fe=function(ye,Ee){var Ae;(Ae=K.current)===null||Ae===void 0||Ae.goToAndPlay(ye,Ee)},ae=function(ye,Ee){var Ae;(Ae=K.current)===null||Ae===void 0||Ae.goToAndStop(ye,Ee)},ce=function(ye){var Ee;(Ee=K.current)===null||Ee===void 0||Ee.setDirection(ye)},me=function(ye,Ee){var Ae;(Ae=K.current)===null||Ae===void 0||Ae.playSegments(ye,Ee)},te=function(ye){var Ee;(Ee=K.current)===null||Ee===void 0||Ee.setSubframe(ye)},le=function(ye){var Ee;return(Ee=K.current)===null||Ee===void 0?void 0:Ee.getDuration(ye)},Z=function(){var ye;(ye=K.current)===null||ye===void 0||ye.destroy(),K.current=void 0},Y=function(){var ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ee;if(W.current){(Ee=K.current)===null||Ee===void 0||Ee.destroy();var Ae=_objectSpread2$1(_objectSpread2$1(_objectSpread2$1({},e),ye),{},{container:W.current});return K.current=lottie.loadAnimation(Ae),j(!!K.current),function(){var je;(je=K.current)===null||je===void 0||je.destroy(),K.current=void 0}}};reactExports.useEffect(function(){var oe=Y();return function(){return oe==null?void 0:oe()}},[n,s]),reactExports.useEffect(function(){K.current&&(K.current.autoplay=!!a)},[a]),reactExports.useEffect(function(){if(K.current){if(!o){K.current.resetSegments(!0);return}!Array.isArray(o)||!o.length||((K.current.currentRawFrame<o[0]||K.current.currentRawFrame>o[1])&&(K.current.currentRawFrame=o[0]),K.current.setSegment(o[0],o[1]))}},[o]),reactExports.useEffect(function(){var oe=[{name:"complete",handler:l},{name:"loopComplete",handler:u},{name:"enterFrame",handler:c},{name:"segmentStart",handler:d},{name:"config_ready",handler:p},{name:"data_ready",handler:m},{name:"data_failed",handler:y},{name:"loaded_images",handler:b},{name:"DOMLoaded",handler:E},{name:"destroy",handler:T}],ye=oe.filter(function(Ae){return Ae.handler!=null});if(ye.length){var Ee=ye.map(function(Ae){var je;return(je=K.current)===null||je===void 0||je.addEventListener(Ae.name,Ae.handler),function(){var Te;(Te=K.current)===null||Te===void 0||Te.removeEventListener(Ae.name,Ae.handler)}});return function(){Ee.forEach(function(Ae){return Ae()})}}},[l,u,c,d,p,m,y,b,E,T]);var he=React.createElement("div",_objectSpread2$1({style:r,ref:W},S));return{View:he,play:H,stop:ee,pause:ue,setSpeed:de,goToAndStop:ae,goToAndPlay:fe,setDirection:ce,playSegments:me,setSubframe:te,getDuration:le,destroy:Z,animationContainerRef:W,animationLoaded:I,animationItem:K.current}};function getContainerVisibility(t){var e=t.getBoundingClientRect(),r=e.top,n=e.height,s=window.innerHeight-r,a=window.innerHeight+n;return s/a}function getContainerCursorPosition(t,e,r){var n=t.getBoundingClientRect(),s=n.top,a=n.left,o=n.width,l=n.height,u=(e-a)/o,c=(r-s)/l;return{x:u,y:c}}var useInitInteractivity=function t(e){var r=e.wrapperRef,n=e.animationItem,s=e.mode,a=e.actions;reactExports.useEffect(function(){var o=r.current;if(!(!o||!n||!a.length)){n.stop();var l=function(){var d=null,p=function(){var y=getContainerVisibility(o),b=a.find(function(T){var S=T.visibility;return S&&y>=S[0]&&y<=S[1]});if(b){if(b.type==="seek"&&b.visibility&&b.frames.length===2){var E=b.frames[0]+Math.ceil((y-b.visibility[0])/(b.visibility[1]-b.visibility[0])*b.frames[1]);//! goToAndStop must be relative to the start of the current segment
n.goToAndStop(E-n.firstFrame-1,!0)}b.type==="loop"&&(d===null||d!==b.frames||n.isPaused)&&(n.playSegments(b.frames,!0),d=b.frames),b.type==="play"&&n.isPaused&&(n.resetSegments(!0),n.play()),b.type==="stop"&&n.goToAndStop(b.frames[0]-n.firstFrame-1,!0)}};return document.addEventListener("scroll",p),function(){document.removeEventListener("scroll",p)}},u=function(){var d=function(b,E){var T=b,S=E;if(T!==-1&&S!==-1){var P=getContainerCursorPosition(o,T,S);T=P.x,S=P.y}var A=a.find(function(K){var W=K.position;return W&&Array.isArray(W.x)&&Array.isArray(W.y)?T>=W.x[0]&&T<=W.x[1]&&S>=W.y[0]&&S<=W.y[1]:W&&!Number.isNaN(W.x)&&!Number.isNaN(W.y)?T===W.x&&S===W.y:!1});if(A){if(A.type==="seek"&&A.position&&Array.isArray(A.position.x)&&Array.isArray(A.position.y)&&A.frames.length===2){var I=(T-A.position.x[0])/(A.position.x[1]-A.position.x[0]),j=(S-A.position.y[0])/(A.position.y[1]-A.position.y[0]);n.playSegments(A.frames,!0),n.goToAndStop(Math.ceil((I+j)/2*(A.frames[1]-A.frames[0])),!0)}A.type==="loop"&&n.playSegments(A.frames,!0),A.type==="play"&&(n.isPaused&&n.resetSegments(!1),n.playSegments(A.frames)),A.type==="stop"&&n.goToAndStop(A.frames[0],!0)}},p=function(b){d(b.clientX,b.clientY)},m=function(){d(-1,-1)};return o.addEventListener("mousemove",p),o.addEventListener("mouseout",m),function(){o.removeEventListener("mousemove",p),o.removeEventListener("mouseout",m)}};switch(s){case"scroll":return l();case"cursor":return u()}}},[s,n])},useLottieInteractivity=function t(e){var r=e.actions,n=e.mode,s=e.lottieObj,a=s.animationItem,o=s.View,l=s.animationContainerRef;return useInitInteractivity({actions:r,animationItem:a,mode:n,wrapperRef:l}),o},_excluded$3=["style","interactivity"],Lottie=function t(e){var r,n,s,a=e.style,o=e.interactivity,l=_objectWithoutProperties(e,_excluded$3),u=useLottie(l,a),c=u.View,d=u.play,p=u.stop,m=u.pause,y=u.setSpeed,b=u.goToAndStop,E=u.goToAndPlay,T=u.setDirection,S=u.playSegments,P=u.setSubframe,A=u.getDuration,I=u.destroy,j=u.animationContainerRef,K=u.animationLoaded,W=u.animationItem;return reactExports.useEffect(function(){e.lottieRef&&(e.lottieRef.current={play:d,stop:p,pause:m,setSpeed:y,goToAndPlay:E,goToAndStop:b,setDirection:T,playSegments:S,setSubframe:P,getDuration:A,destroy:I,animationContainerRef:j,animationLoaded:K,animationItem:W})},[(r=e.lottieRef)===null||r===void 0?void 0:r.current]),useLottieInteractivity({lottieObj:{View:c,play:d,stop:p,pause:m,setSpeed:y,goToAndStop:b,goToAndPlay:E,setDirection:T,playSegments:S,setSubframe:P,getDuration:A,destroy:I,animationContainerRef:j,animationLoaded:K,animationItem:W},actions:(n=o==null?void 0:o.actions)!==null&&n!==void 0?n:[],mode:(s=o==null?void 0:o.mode)!==null&&s!==void 0?s:"scroll"})};const v$1="4.8.0",meta={g:"LottieFiles AE 1.0.0",a:"",k:"",d:"",tc:"#FFFFFF"},fr$1=30,ip$1=0,op$1=150,w$1=500,h$1=500,nm$1="Sloth Full",ddd$1=0,assets$1=JSON.parse('[{"id":"comp_0","layers":[{"ddd":0,"ind":1,"ty":3,"nm":"Full sloth controller ","sr":1,"ks":{"o":{"a":0,"k":0,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":1,"k":[{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":30,"s":[2000,2388,0],"to":[0,-85.5,0],"ti":[0,64.667,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":60.5,"s":[2000,1875,0],"to":[0,-64.667,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.167,"y":0},"t":91,"s":[2000,2000,0],"to":[0,0,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":120,"s":[2000,1875,0],"to":[0,0,0],"ti":[0,-20.833,0]},{"t":149,"s":[2000,2000,0]}],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"R Eye 2","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":1,"k":[{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":30,"s":[-324,-500,0],"to":[0,-2.667,0],"ti":[0,2.667,0]},{"t":31,"s":[-324,-516,0]}],"ix":2},"a":{"a":0,"k":[352,-482,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":0,"s":[100,100,100]},{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":4,"s":[100,10,100]},{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":8,"s":[100,100,100]},{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":12,"s":[100,100,100]},{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":16,"s":[100,10,100]},{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":20,"s":[100,100,100]},{"i":{"x":[0.833,0.833,0.833],"y":[1,1,1]},"o":{"x":[0.167,0.167,0.167],"y":[0,0,0]},"t":27,"s":[100,100,100]},{"t":34,"s":[0,0,100]}],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[200,200],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"st","c":{"a":0,"k":[0.709803981407,0.780391977348,0.776471007104,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":0,"ix":5},"lc":1,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"fl","c":{"a":0,"k":[0.450980422076,0.141176470588,0.341176470588,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[352,-482],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"L Eye","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":1,"k":[{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":30,"s":[346,-484,0],"to":[0,-5,0],"ti":[0,5,0]},{"t":31,"s":[346,-514,0]}],"ix":2},"a":{"a":0,"k":[352,-484,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":0,"s":[100,100,100]},{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":4,"s":[100,10,100]},{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":8,"s":[100,100,100]},{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":12,"s":[100,100,100]},{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":16,"s":[100,10,100]},{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":20,"s":[100,100,100]},{"i":{"x":[0.833,0.833,0.833],"y":[1,1,1]},"o":{"x":[0.167,0.167,0.167],"y":[0,0,0]},"t":27,"s":[100,100,100]},{"t":34,"s":[0,0,100]}],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[200,200],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"st","c":{"a":0,"k":[0.709803981407,0.780391977348,0.776471007104,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":0,"ix":5},"lc":1,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"fl","c":{"a":0,"k":[0.450980422076,0.141176470588,0.341176470588,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[352,-482],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":4,"ty":4,"nm":"Close eye R","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[367.129,-495.252,0],"ix":2},"a":{"a":0,"k":[121.72,44.569,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":27,"s":[0,100,100]},{"t":34,"s":[100,100,100]}],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[1.908,0.73],[0,0],[4.027,1.45],[7.948,2.467],[15.803,2.06],[7.931,0.202],[8.044,-0.525],[17.494,-3.524],[0,0],[1.907,9.467],[-4.733,3.981],[-20.728,5.501],[-10.779,0.684],[-10.654,-1.417],[-18.536,-9.695],[-8.195,-6.38],[-3.756,-3.653],[-1.823,-1.935],[-2.161,-2.607],[7.203,-5.967],[5.121,1.371]],"o":[[-1.427,-0.393],[0,0],[-3.982,-1.602],[-7.95,-3.071],[-15.853,-5.055],[-7.915,-0.91],[-7.928,-0.163],[-16.072,1.323],[0,0],[-9.466,1.906],[-1.307,-6.491],[15.904,-13.318],[10.391,-2.681],[10.777,-0.484],[21.283,2.965],[9.251,4.9],[4.059,3.25],[1.884,1.81],[1.862,2.039],[5.969,7.202],[-4.392,3.642],[0,0]],"v":[[93.245,41.621],[87.761,39.385],[81.879,36.864],[69.99,32.056],[46.179,23.633],[-1.318,12.948],[-25.058,11.261],[-48.967,11.959],[-98.764,19.826],[-99.57,19.988],[-120.163,6.3],[-114.248,-10.559],[-58.192,-38.856],[-26.318,-43.835],[5.934,-42.507],[66.25,-23.209],[92.499,-6.336],[104.345,3.817],[109.92,9.394],[115.501,15.782],[113.267,39.629],[98.067,42.948]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[121.72,44.569],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":4,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":5,"ty":4,"nm":"Close eye L","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[-345.053,-492.572,0],"ix":2},"a":{"a":0,"k":[121.663,45.434,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":27,"s":[0,100,100]},{"t":34,"s":[100,100,100]}],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-3.333,4.124],[-1.851,2.047],[-1.876,1.819],[-4.042,3.271],[-9.224,4.949],[-21.265,3.078],[-10.78,-0.426],[-10.405,-2.626],[-15.976,-13.233],[6.159,-7.437],[6.07,1.175],[0,0],[16.079,1.238],[7.929,-0.206],[7.91,-0.95],[15.825,-5.139],[7.933,-3.113],[3.975,-1.623],[0,0],[1.426,-0.399],[0,0],[2.528,9.007]],"o":[[2.147,-2.619],[1.814,-1.946],[3.735,-3.674],[8.161,-6.425],[18.484,-9.793],[10.646,-1.475],[10.782,0.627],[20.757,5.392],[7.436,6.16],[-4.224,5.098],[0,0],[-17.513,-3.43],[-8.046,-0.484],[-7.927,0.244],[-15.792,2.145],[-7.934,2.509],[-4.02,1.472],[0,0],[-1.904,0.739],[0,0],[-9.005,2.528],[-1.542,-5.492]],"v":[[-116.663,15.611],[-111.117,9.194],[-105.57,3.588],[-93.779,-6.628],[-67.62,-23.641],[-7.408,-43.259],[24.837,-44.758],[56.737,-39.949],[112.943,-11.95],[115.254,12.67],[98.451,18.682],[97.62,18.516],[47.781,10.915],[23.868,10.344],[0.138,12.155],[-47.3,23.094],[-71.067,31.643],[-82.931,36.514],[-88.798,39.067],[-94.271,41.331],[-98.988,42.656],[-119.871,30.926]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[121.663,45.434],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":4,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":6,"ty":4,"nm":"Head","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[15.223,-691.616,0],"ix":2},"a":{"a":0,"k":[896.508,805.093,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[4.114,-3.847],[4.194,-3.093],[4.317,-2.687],[9.615,-3.632],[21.619,0.286],[18.847,8.248],[8.441,5.608],[3.928,3.237],[4.109,4.162],[-6.341,6.26],[-5.484,-1.672],[0,0],[-3.971,-1.347],[-4.071,-1.262],[-7.973,-2.022],[-14.984,-0.216],[-7.909,1],[-8.095,1.602],[-8.205,2.216],[-4.131,1.173],[-3.525,0.854],[0,0],[-2.099,-8.664]],"o":[[-4.32,4.02],[-4.103,3.01],[-8.711,5.197],[-19.18,7.307],[-21.989,-0.404],[-9.421,-4.178],[-4.17,-2.903],[-4.041,-3.244],[-6.26,-6.34],[4.366,-4.311],[0,0],[3.497,1.075],[4.063,1.395],[8.092,2.629],[15.938,4.115],[7.646,-0.003],[7.927,-0.752],[8.095,-1.602],[4.142,-1.022],[4.014,-1.132],[0,0],[8.664,-2.101],[1.421,5.865]],"v":[[113.477,-4.755],[101.271,5.308],[88.568,13.692],[61.021,26.896],[-0.735,38.087],[-62.517,24.218],[-89.381,9.609],[-101.641,0.626],[-113.327,-9.934],[-113.182,-32.749],[-97.128,-36.701],[-94.695,-35.951],[-82.91,-31.808],[-70.77,-27.679],[-46.668,-20.648],[-0.077,-13.903],[23.321,-15.182],[47.343,-18.965],[71.805,-24.754],[84.156,-28.19],[96.125,-31.642],[98.678,-32.26],[118.167,-20.374]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[880.725,1215.598],"ix":2},"a":{"a":0,"k":[-3,14],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.667,0.667],"y":[1,1]},"o":{"x":[0.333,0.333],"y":[0,0]},"t":30,"s":[50,50]},{"t":36,"s":[100,100]}],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":4,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-0.614,0.38],[-8.569,4.464],[-8.589,4.065],[-8.735,3.436],[-9.304,1.983],[0,0],[-1.751,-8.212],[5.485,-3.228],[9.275,-2.934],[9.599,-1.785],[9.756,-0.963],[9.985,0.351],[-0.043,1.235]],"o":[[8.506,-5.171],[8.598,-4.359],[8.594,-4.058],[8.734,-3.46],[0,0],[8.211,-1.751],[1.4,6.567],[-8.49,4.981],[-9.271,2.953],[-9.603,1.78],[-9.784,0.858],[-1.235,-0.042],[0.026,-0.775]],"v":[[-61.266,22.167],[-35.579,8.05],[-9.816,-4.618],[16.021,-16.278],[42.86,-24.898],[42.946,-24.917],[60.985,-13.219],[53.809,3.064],[26.936,14.474],[-1.537,21.156],[-30.599,25.229],[-60.183,26.318],[-62.342,24.003]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[1308.078,1542.832],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 2","np":4,"cix":2,"bm":0,"ix":2,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0.605,227.643],[298.836,138.877],[0,0],[-1.6,49.847],[24.198,-21.818],[55.371,-8.523]],"o":[[212.144,-84.84],[-0.723,-272.119],[0,0],[18.547,-40.13],[1.045,-32.565],[-44.158,39.815],[0,0]],"v":[[-34.796,691.083],[315.402,224.601],[-120.929,-487.887],[-119.511,-490.865],[-93.138,-640.864],[-154.86,-669.264],[-316.007,-574.659]],"c":false},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":2,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[1397.01,838.537],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 3","np":2,"cix":2,"bm":0,"ix":3,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[17.964,53.379],[14.871,-25.664],[0,0]],"o":[[46.096,-49.586],[-9.461,-28.113],[-81.575,140.775],[0,0]],"v":[[121.82,103.108],[139.719,-71.359],[77.537,-77.444],[-167.915,96.733]],"c":false},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[942.815,183.108],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 4","np":2,"cix":2,"bm":0,"ix":4,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-0.065,-24.521],[97.382,-89.666],[75.117,29.939],[17.044,116.44],[-120.088,14.807],[-72.632,-72.209],[0,0]],"o":[[0.285,107.498],[-34.777,-39.42],[-122.62,-48.91],[-12.232,-83.565],[158.969,-19.598],[0,0],[4.4,23.27]],"v":[[268.532,-51.096],[139.165,261.865],[-23.064,148.328],[-256.585,-44.161],[-82.015,-242.268],[261.756,-122.938],[261.756,-122.899]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.468252383961,0.472034349629,0.44265313242,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[1282.638,1064.761],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 5","np":4,"cix":2,"bm":0,"ix":5,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[11.787,-83.628],[122.359,-49.561],[34.486,-40.341],[0.289,108.66],[-3.47,21.083],[-164.185,-19.32]],"o":[[-16.425,116.53],[-76.774,31.079],[-100.338,-89.568],[-0.058,-22.081],[71.969,-75.188],[120.165,14.169]],"v":[[259.518,-47.271],[27.021,146.457],[-137.033,263.767],[-271.247,-51.4],[-266.073,-116.262],[83.896,-244.447]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.468252383961,0.472034349629,0.44265313242,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[486.343,1068.616],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 6","np":4,"cix":2,"bm":0,"ix":6,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0.692,-0.029],[9.053,0.852],[8.859,1.743],[8.51,2.88],[7.7,4.859],[-4.49,7.115],[-6.082,-1.322],[0,0],[-7.971,-3.378],[-7.805,-4.003],[-7.792,-4.328],[-7.67,-5.164],[0.693,-1.034]],"o":[[-9.278,0.323],[-9.021,-0.958],[-8.853,-1.748],[-8.513,-2.86],[-7.116,-4.49],[3.514,-5.568],[0,0],[8.582,1.883],[7.975,3.357],[7.802,4.008],[7.76,4.432],[1.034,0.694],[-0.417,0.619]],"v":[[55.892,25.777],[28.476,24.655],[1.633,20.641],[-24.585,14.118],[-49.137,2.996],[-53.889,-18.019],[-37.767,-24.779],[-37.642,-24.746],[-13.037,-16.402],[10.467,-4.948],[33.84,7.59],[57.07,21.652],[57.686,24.781]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[463.196,1537.386],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 7","np":4,"cix":2,"bm":0,"ix":7,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[0.586,220.809],[-481.454,56.559]],"o":[[-201.905,-85.253],[-0.908,-341.797],[0,0]],"v":[[-12.79,622.253],[-346.54,165.367],[347.448,-622.253]],"c":false},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[427.448,902.105],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 8","np":2,"cix":2,"bm":0,"ix":8,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-0.021,-7.833],[22.405,-0.06],[0.021,7.833],[-22.404,0.06]],"o":[[0.021,7.832],[-22.404,0.06],[-0.02,-7.832],[22.404,-0.059]],"v":[[40.563,-3.173],[0.042,14.18],[-40.57,-2.958],[-0.033,-14.184]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.996211152918,0.981041882085,0.984832883349,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[885.96,1024.214],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 9","np":4,"cix":2,"bm":0,"ix":9,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-0.089,-33.494],[55.027,-0.146],[0.089,33.493],[-55.026,0.146]],"o":[[0.089,33.494],[-55.025,0.146],[-0.088,-33.494],[55.026,-0.147]],"v":[[99.633,-13.366],[0.195,60.646],[-99.634,-12.836],[-0.127,-60.646]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[883.198,1052.745],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 10","np":4,"cix":2,"bm":0,"ix":10,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-0.065,-24.521],[97.382,-89.666],[270.353,-0.719],[0,0],[100.377,89.606],[0.288,108.66],[-3.469,21.083],[-195.2,0.518],[-71.035,-68.881],[-106.762,0.284],[-34.228,-182.947],[0,0]],"o":[[0.285,107.498],[-99.508,91.726],[0,0],[-267.524,0.711],[-100.338,-89.568],[-0.059,-22.081],[30.418,-186.566],[106.763,-0.284],[70.708,-69.258],[192.799,-0.512],[0,0],[4.4,23.27]],"v":[[667.924,-38.815],[538.556,274.146],[1.169,431.07],[1.13,431.07],[-533.937,279.902],[-668.15,-35.265],[-662.977,-100.126],[-275.696,-429.811],[-0.863,-318.937],[273.377,-431.27],[661.147,-110.656],[661.147,-110.618]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.996211152918,0.981041882085,0.984832883349,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[883.246,1052.48],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 11","np":4,"cix":2,"bm":0,"ix":11,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-0.04,-13.64],[450.559,-1.2],[1,368.88],[-0.8,15.08],[-436.841,1.16],[-22.8,343.68]],"o":[[0.96,368.92],[-450.521,1.199],[-0.04,-14.92],[22.16,346.2],[435.239,-1.16],[0.761,13.76]],"v":[[815.763,-252.264],[1.443,293.336],[-815.758,-247.904],[-814.638,-292.904],[1.443,215.296],[814.601,-293.344]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.749019622803,0.525490224361,0.47058826685,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[896.665,1315.395],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 13","np":4,"cix":2,"bm":0,"ix":12,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-0.721,-271.316],[450.528,-1.198],[0.98,368.902],[-517.311,34.275],[-47.484,81.976],[-9.482,-28.15],[24.93,-63.549],[-22.593,20.389],[1.029,-32.547],[13.002,-55.984]],"o":[[0.98,368.901],[-450.528,1.197],[-0.939,-353.566],[62.461,-32.086],[14.866,-25.629],[12.582,37.414],[69.144,-33.797],[24.194,-21.82],[-1.031,31.477],[297.009,139.372]],"v":[[815.731,218.161],[1.446,763.762],[-815.772,222.496],[-70.93,-569.763],[123.66,-739.33],[185.866,-733.209],[185.061,-583.104],[345.483,-675.723],[407.213,-647.311],[381.99,-493.084]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.928911635455,0.76966827991,0.580090092678,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[896.68,844.977],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 14","np":4,"cix":2,"bm":0,"ix":13,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":7,"ty":4,"nm":"R Nail ","parent":10,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":30,"s":[-20]},{"t":36,"s":[0]}],"ix":10},"p":{"a":0,"k":[592.669,461.719,0],"ix":2},"a":{"a":0,"k":[130.703,166.769,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-7.733,-8.045],[-8.447,7.902],[-61.338,1.04],[75.047,-6.223],[20.811,-18.38],[-12.379,-7.272],[-13.168,-10.259]],"o":[[8.016,8.34],[21.745,-20.339],[47.495,-0.805],[-52.358,4.342],[-10.759,9.504],[9.248,5.432],[6.983,5.439]],"v":[[-66.556,61.963],[-36.825,62.867],[91.209,8.048],[-18.225,-64.546],[-127.944,-17.886],[-124.457,16.099],[-90.506,39.35]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[218.703,150.769],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-13.88,-8.4],[-11.881,-9.24],[-7.4,-7.64],[-9.439,8.64],[-59.76,1],[28.279,20.04],[21.64,-19.76],[8.92,9.24],[6.52,5.08],[7.2,4.64],[0.4,-0.32]],"o":[[8.72,5.28],[6.52,5.08],[8.919,9.2],[22.361,-20.48],[25.639,-0.44],[-56.801,2.92],[-9.44,8.68],[-7.4,-7.6],[-8.961,-6.96],[-0.4,0.28],[-12.361,10.48]],"v":[[-107.665,1.681],[-76.545,23.241],[-54.145,44.281],[-21.186,45.201],[105.135,-8.039],[90.455,-51.439],[-30.025,1.601],[-62.985,0.681],[-85.385,-20.319],[-109.705,-37.639],[-110.905,-36.679]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.796078503132,0.68235296011,0.756862819195,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[204.762,166.867],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 2","np":4,"cix":2,"bm":0,"ix":2,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-7.395,-7.631],[-9.459,8.655],[-59.768,1.012],[75.047,-6.224],[21.252,-17.951],[-13.882,-8.393],[-11.854,-9.234]],"o":[[8.923,9.207],[22.341,-20.443],[47.495,-0.805],[-49.837,4.133],[-12.392,10.466],[8.73,5.277],[6.524,5.082]],"v":[[-68.841,60.782],[-35.851,61.697],[90.467,8.466],[-18.966,-64.128],[-125.57,-20.159],[-122.362,18.207],[-91.247,39.766]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[219.445,150.352],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 3","np":4,"cix":2,"bm":0,"ix":3,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":8,"ty":4,"nm":"R Nail ","parent":10,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":30,"s":[-18]},{"t":36,"s":[0]}],"ix":10},"p":{"a":0,"k":[624.826,645.493,0],"ix":2},"a":{"a":0,"k":[104.768,149.414,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-43.066,-43.484],[-51.45,9.36],[25.369,27.036],[44.554,-1.788],[18.389,0]],"o":[[14.408,14.548],[105.191,-19.136],[-17.122,-18.247],[-78.761,3.16],[-40.766,0]],"v":[[-113.702,52.023],[-27.014,64.054],[131.399,-55.167],[34.362,-56.503],[-83.598,-67.977]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[236.768,153.414],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-30.36,-30.64],[-51.48,9.36],[19.84,28.519],[61.559,-11.2],[14.4,14.56],[-0.96,19.08]],"o":[[14.399,14.56],[102.639,-18.64],[-27.84,28.08],[-51.441,9.36],[-15.48,-15.64],[-21.16,25.12]],"v":[[-114.715,44.376],[-28.035,56.416],[132.005,-60.704],[-9.835,8.256],[-96.515,-3.784],[-116.795,-58.424]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.796078503132,0.68235296011,0.756862819195,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[237.8,161.043],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 2","np":4,"cix":2,"bm":0,"ix":2,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-43.066,-43.484],[-51.45,9.36],[25.369,27.036],[44.554,-1.788],[18.389,0]],"o":[[14.408,14.548],[105.191,-19.136],[-17.122,-18.247],[-78.761,3.16],[-40.766,0]],"v":[[-113.702,52.023],[-27.014,64.054],[131.399,-55.167],[34.362,-56.503],[-83.598,-67.977]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[236.768,153.414],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 3","np":4,"cix":2,"bm":0,"ix":3,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":9,"ty":4,"nm":"R Nail M","parent":10,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":30,"s":[47]},{"t":36,"s":[0]}],"ix":10},"p":{"a":0,"k":[719.413,625.498,0],"ix":2},"a":{"a":0,"k":[141.379,302.47,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-37.936,-30.454],[-26.316,85.37],[19.277,-6.331],[63.167,-56.084]],"o":[[0,0],[36.131,-117.213],[-19.277,6.331],[-23.333,20.717]],"v":[[-41.172,110.058],[57.248,45.099],[-14.338,-124.138],[-70.046,4.771]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[173.379,210.47],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-37.921,-30.44],[-26.319,85.399],[7.04,24.88],[1.281,-4.2],[0,0],[6.52,10.561],[1.2,-1.08]],"o":[[0,0],[11.241,-36.44],[-0.96,4.04],[-26.319,85.4],[-10.28,-8.24],[-1.16,1.081],[-23.359,20.719]],"v":[[-33.42,77.451],[65.019,12.491],[68.38,-79.589],[65.019,-67.269],[-33.42,-2.309],[-58.74,-31.07],[-62.261,-27.829]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.796078503132,0.68235296011,0.756862819195,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[165.609,243.058],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 2","np":4,"cix":2,"bm":0,"ix":2,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-37.936,-30.454],[-26.316,85.37],[19.277,-6.331],[63.167,-56.084]],"o":[[0,0],[36.131,-117.213],[-19.277,6.331],[-23.333,20.717]],"v":[[-41.172,110.058],[57.248,45.099],[-14.338,-124.138],[-70.046,4.771]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[173.379,210.47],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 3","np":4,"cix":2,"bm":0,"ix":3,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":10,"ty":4,"nm":"R hand","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":23,"s":[-5]},{"t":36,"s":[0]}],"ix":10},"p":{"a":0,"k":[317.205,29.034,0],"ix":2},"a":{"a":0,"k":[-4.052,57.79,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-2.13,-0.22],[-36.075,-17.821],[-30.692,-26.078],[-25.941,-30.296],[-22.897,-31.633],[-11.933,-14.873],[-13.612,-12.03],[-16.054,-5.822],[-18.675,-4.243],[-77.108,-10.58],[0,0],[0,0],[-1.967,-5.741],[-1.613,-5.711],[-2.06,-11.737],[2.792,-24.42],[13.121,-21.785],[21.205,-12.852],[23.197,-5.6],[0,0],[5.858,-0.796],[11.707,-0.767],[2.914,-0.024],[0,0],[0,0],[5.785,0.33],[0,0],[0,0],[0,0],[0,0],[5.88,1.021],[0,0],[38.816,26.708],[16.894,16.195],[14.622,18.088],[23.164,39.979],[8.048,21.669],[2.643,11.323],[0.379,12.099],[-3.052,0.096],[-1.036,-1.471],[0,0],[-5.558,-9.766],[-5.181,-9.868],[0,0],[-27.865,-34.119],[-15.897,-15.04],[-17.935,-12.224],[-19.752,-8.589],[-20.99,-4.458],[0,0],[-5.47,-0.671],[0,0],[0,0],[0,0],[0,0],[-5.494,0.116],[0,0],[0,0],[-2.733,0.131],[-10.67,1.735],[-5.323,0.853],[0,0],[-17.465,10.752],[-10.317,17.11],[-2.28,20.627],[3.552,21.127],[2.993,10.367],[1.729,5.082],[1.825,4.286],[0,0],[77.565,16.397],[20.003,6.965],[15.654,13.857],[12.589,15.626],[11.527,15.867],[24.775,29.355],[13.707,13.272],[6.898,6.57],[7.548,5.773],[33.137,18.685],[34.886,18.672],[0,0],[-1.416,2.645]],"o":[[39.972,4.184],[36.2,17.673],[30.896,25.902],[25.732,30.492],[11.473,15.799],[11.937,14.837],[13.591,12.026],[16.966,5.937],[75.637,16.004],[0,0],[0,0],[2.608,6.14],[1.917,5.64],[3.286,11.402],[3.943,23.484],[-2.669,24.314],[-13.108,21.798],[-21.287,13.03],[0,0],[-5.853,0.946],[-11.731,1.862],[-2.924,0.137],[0,0],[0,0],[-5.841,0.11],[0,0],[0,0],[0,0],[0,0],[-5.767,-0.708],[0,0],[-46.738,-9.177],[-19.478,-13.275],[-17,-16.079],[-29.666,-35.92],[-11.48,-20.073],[-4.052,-10.817],[-2.647,-11.345],[-0.096,-3.054],[1.931,-0.06],[0,0],[6.564,9.464],[5.712,9.731],[0,0],[19.882,39.704],[13.853,17.152],[15.803,15.167],[17.82,12.445],[19.67,8.913],[0,0],[5.276,0.941],[0,0],[0,0],[0,0],[0,0],[5.523,0.319],[0,0],[0,0],[2.747,-0.022],[10.889,-0.729],[5.361,-0.731],[0,0],[20.686,-4.993],[17.455,-10.641],[10.284,-17.126],[2.404,-20.647],[-1.858,-10.565],[-1.465,-5.185],[-1.687,-4.976],[0,0],[-77.969,-10.711],[-19.457,-4.454],[-20.824,-7.534],[-15.722,-13.915],[-12.562,-15.659],[-22.99,-31.77],[-12.496,-14.545],[-6.658,-6.845],[-7.297,-6.103],[-29.74,-23.666],[-33.296,-18.502],[0,0],[-2.643,-1.416],[1.072,-2.004]],"v":[[-402.702,-378.733],[-288.004,-344.065],[-187.288,-277.63],[-102.735,-192.207],[-30.77,-97.983],[4.092,-51.713],[42.085,-10.714],[86.549,16.896],[141.238,31.427],[371.537,69.579],[380.632,70.828],[384.111,79.024],[390.568,96.198],[395.845,113.219],[403.739,147.973],[406.68,220.085],[383.774,290.811],[330.335,343.318],[262.529,369.565],[245.012,373.229],[227.436,375.603],[192.305,378.49],[183.533,378.926],[174.799,378.901],[157.325,378.843],[139.931,378.182],[122.582,377.168],[113.908,376.652],[105.305,375.729],[88.097,373.88],[70.82,371.823],[53.218,368.828],[-76.841,313.45],[-131.625,269.229],[-179.243,217.99],[-256.711,102.75],[-286.123,40.051],[-296.201,6.812],[-301.277,-28.074],[-295.923,-33.776],[-291.225,-31.429],[-291.089,-31.233],[-273.138,-2.194],[-257.112,27.302],[-226.925,86.704],[-154.496,197.702],[-109.676,245.943],[-58.846,286.989],[-2.134,318.293],[59.367,337.424],[75.262,340.13],[91.713,342.083],[108.29,343.869],[116.576,344.763],[124.863,345.25],[141.433,346.216],[157.98,346.849],[174.485,346.903],[182.738,346.937],[190.93,346.52],[223.491,343.845],[239.584,341.694],[255.321,338.386],[313.761,315.944],[356.418,274.205],[374.867,216.62],[372.204,153.405],[365.053,121.925],[360.271,106.499],[354.801,91.865],[367.375,101.308],[134.407,62.688],[75.712,47.005],[20.917,13.286],[-20.853,-31.668],[-56.653,-79.163],[-127.174,-171.548],[-166.085,-213.716],[-186.814,-233.402],[-208.654,-251.75],[-303.173,-315.054],[-405.8,-368.525],[-405.832,-368.542],[-408.056,-375.893]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[409.722,379.203],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":4,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[12.92,32.6],[-113.84,-94.36],[-0.84,-0.68],[-2.121,-1.64],[-64.441,-8.4],[0,0],[75.08,12.88],[0,-54.302],[45.751,-9.747],[64.248,50.125],[0.429,0.338]],"o":[[17.479,48.32],[0.84,0.72],[2.08,1.72],[46.6,36.641],[437.04,56.88],[0,0],[-32.6,63.88],[0,53.402],[-79.7,16.98],[-0.432,-0.337],[-119.16,-93.559]],"v":[[-341.405,-188.474],[-149.605,102.286],[-147.086,104.366],[-140.805,109.406],[25.435,181.846],[318.795,-89.194],[71.115,-131.234],[137.579,12.237],[67.115,94.582],[-160.313,41.619],[-161.605,40.606]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.749019622803,0.525490224361,0.47058826685,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[460.388,553.852],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 2","np":4,"cix":2,"bm":0,"ix":2,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[50.92,15.44],[0,0],[0,0],[0,0],[-143.88,-113],[-64.44,-8.4],[0,0],[72.04,24.601],[143.88,116.48],[20.399,12.72],[4.399,2.6]],"o":[[0,0],[0,0],[0,0],[0,0],[46.601,36.64],[437.04,56.88],[0,0],[-97.84,-33.439],[-17.279,-13.961],[-4.281,-2.681],[-38,-22.24]],"v":[[-458.7,-393.5],[-440.7,-336.22],[-406.42,-227.101],[-350.62,-49.54],[-144.58,264.18],[21.66,336.62],[315.021,65.58],[28.62,12.859],[-256.66,-288.18],[-313.059,-328.34],[-326.099,-336.22]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.928911635455,0.76966827991,0.580090092678,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[464.162,399.078],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 3","np":4,"cix":2,"bm":0,"ix":3,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":11,"ty":4,"nm":"L Nail","parent":14,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":33,"s":[18]},{"t":39,"s":[0]}],"ix":10},"p":{"a":0,"k":[298.287,655.584,0],"ix":2},"a":{"a":0,"k":[368.768,159.414,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[43.066,-43.484],[51.45,9.36],[-25.369,27.036],[-44.555,-1.788],[-18.389,0]],"o":[[-14.408,14.548],[-105.191,-19.136],[17.121,-18.247],[78.76,3.16],[40.767,0]],"v":[[113.702,52.023],[27.013,64.054],[-131.399,-55.167],[-34.362,-56.503],[83.597,-67.977]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[236.768,153.414],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[30.36,-30.64],[51.48,9.36],[-19.84,28.519],[-61.559,-11.2],[-14.4,14.56],[0.96,19.08]],"o":[[-14.399,14.56],[-102.639,-18.64],[27.84,28.08],[51.441,9.36],[15.48,-15.64],[21.16,25.12]],"v":[[114.716,44.376],[28.036,56.416],[-132.004,-60.704],[9.836,8.256],[96.516,-3.784],[116.796,-58.424]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.796078503132,0.68235296011,0.756862819195,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[235.734,161.043],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 2","np":4,"cix":2,"bm":0,"ix":2,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[43.066,-43.484],[51.45,9.36],[-25.369,27.036],[-44.555,-1.788],[-18.389,0]],"o":[[-14.408,14.548],[-105.191,-19.136],[17.121,-18.247],[78.76,3.16],[40.767,0]],"v":[[113.702,52.023],[27.013,64.054],[-131.399,-55.167],[-34.362,-56.503],[83.597,-67.977]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[236.768,153.414],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 3","np":4,"cix":2,"bm":0,"ix":3,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":12,"ty":4,"nm":"L Nail M","parent":14,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":33,"s":[-47]},{"t":39,"s":[0]}],"ix":10},"p":{"a":0,"k":[207.699,637.59,0],"ix":2},"a":{"a":0,"k":[209.379,314.469,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[37.936,-30.454],[26.316,85.37],[-19.278,-6.331],[-63.167,-56.084]],"o":[[0,0],[-36.131,-117.213],[19.277,6.331],[23.333,20.717]],"v":[[41.172,110.058],[-57.248,45.099],[14.339,-124.138],[70.046,4.771]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[173.379,210.47],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[37.921,-30.44],[26.319,85.399],[-7.04,24.88],[-1.281,-4.2],[0,0],[-6.521,10.561],[-1.2,-1.08]],"o":[[0,0],[-11.241,-36.44],[0.96,4.04],[26.319,85.4],[10.28,-8.24],[1.16,1.081],[23.359,20.719]],"v":[[33.419,77.451],[-65.02,12.491],[-68.381,-79.589],[-65.02,-67.269],[33.419,-2.309],[58.739,-31.07],[62.26,-27.829]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.796078503132,0.68235296011,0.756862819195,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[181.15,243.058],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 2","np":4,"cix":2,"bm":0,"ix":2,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[37.936,-30.454],[26.316,85.37],[-19.278,-6.331],[-63.167,-56.084]],"o":[[0,0],[-36.131,-117.213],[19.277,6.331],[23.333,20.717]],"v":[[41.172,110.058],[-57.248,45.099],[14.339,-124.138],[70.046,4.771]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[173.379,210.47],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 3","np":4,"cix":2,"bm":0,"ix":3,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":13,"ty":4,"nm":"L Nail","parent":14,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":33,"s":[20]},{"t":39,"s":[0]}],"ix":10},"p":{"a":0,"k":[332.443,481.81,0],"ix":2},"a":{"a":0,"k":[308.703,186.769,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[7.733,-8.045],[8.447,7.902],[61.339,1.04],[-75.046,-6.223],[-20.811,-18.38],[12.379,-7.272],[13.169,-10.259]],"o":[[-8.016,8.34],[-21.744,-20.339],[-47.494,-0.805],[52.359,4.342],[10.76,9.504],[-9.248,5.432],[-6.982,5.439]],"v":[[66.557,61.963],[36.824,62.867],[-91.21,8.048],[18.224,-64.546],[127.943,-17.886],[124.458,16.099],[90.505,39.35]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[218.703,150.769],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[13.88,-8.4],[11.881,-9.24],[7.4,-7.64],[9.439,8.64],[59.76,1],[-28.279,20.04],[-21.64,-19.76],[-8.92,9.24],[-6.52,5.08],[-7.2,4.64],[-0.4,-0.32]],"o":[[-8.72,5.28],[-6.52,5.08],[-8.919,9.2],[-22.361,-20.48],[-25.64,-0.44],[56.801,2.92],[9.44,8.68],[7.4,-7.6],[8.961,-6.96],[0.4,0.28],[12.361,10.48]],"v":[[107.667,1.681],[76.547,23.241],[54.147,44.281],[21.188,45.201],[-105.133,-8.039],[-90.453,-51.439],[30.027,1.601],[62.987,0.681],[85.387,-20.319],[109.707,-37.639],[110.907,-36.679]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.796078503132,0.68235296011,0.756862819195,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[232.643,166.867],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 2","np":4,"cix":2,"bm":0,"ix":2,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[7.394,-7.631],[9.459,8.655],[59.768,1.012],[-75.047,-6.224],[-21.251,-17.951],[13.883,-8.393],[11.854,-9.234]],"o":[[-8.923,9.207],[-22.341,-20.443],[-47.495,-0.805],[49.837,4.133],[12.393,10.466],[-8.729,5.277],[-6.524,5.082]],"v":[[68.841,60.782],[35.851,61.697],[-90.467,8.466],[18.966,-64.128],[125.569,-20.159],[122.362,18.207],[91.247,39.766]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[217.961,150.352],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 3","np":4,"cix":2,"bm":0,"ix":3,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":14,"ty":4,"nm":"L Hand","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":26,"s":[5]},{"t":39,"s":[0]}],"ix":10},"p":{"a":0,"k":[-319.096,47.612,0],"ix":2},"a":{"a":0,"k":[925.273,76.46,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[33.296,-18.502],[29.741,-23.666],[7.298,-6.104],[6.658,-6.845],[12.495,-14.545],[22.99,-31.771],[12.561,-15.659],[15.721,-13.915],[20.824,-7.534],[19.458,-4.454],[77.969,-10.71],[0,0],[1.686,-4.977],[1.465,-5.186],[1.859,-10.564],[-2.403,-20.646],[-10.283,-17.126],[-17.455,-10.64],[-20.686,-4.994],[0,0],[-5.36,-0.732],[-10.89,-0.728],[-2.747,-0.021],[0,0],[0,0],[-5.523,0.318],[0,0],[0,0],[0,0],[0,0],[-5.276,0.94],[0,0],[-19.668,8.913],[-17.819,12.445],[-15.803,15.167],[-13.853,17.152],[-19.882,39.704],[0,0],[-5.712,9.73],[-6.564,9.464],[0,0],[-2.51,-1.741],[0.043,-1.798],[2.648,-11.344],[4.052,-10.818],[11.481,-20.073],[29.666,-35.92],[17.001,-16.079],[19.479,-13.274],[46.739,-9.177],[0,0],[5.768,-0.708],[0,0],[0,0],[0,0],[0,0],[5.841,0.109],[0,0],[0,0],[2.924,0.138],[11.731,1.863],[5.852,0.947],[0,0],[21.287,13.031],[13.108,21.798],[2.668,24.313],[-3.942,23.484],[-3.285,11.402],[-1.918,5.641],[-2.608,6.14],[0,0],[0,0],[-75.637,16.004],[-16.966,5.938],[-13.59,12.026],[-11.937,14.838],[-11.474,15.799],[-25.733,30.491],[-30.895,25.902],[-36.201,17.673],[-39.971,4.184],[-0.313,-2.983],[1.885,-1.012]],"o":[[-34.886,18.672],[-33.136,18.686],[-7.547,5.772],[-6.897,6.57],[-13.708,13.273],[-24.775,29.356],[-11.528,15.866],[-12.59,15.626],[-15.654,13.857],[-20.003,6.965],[-77.564,16.398],[0,0],[-1.824,4.286],[-1.729,5.082],[-2.993,10.367],[-3.552,21.127],[2.281,20.628],[10.318,17.109],[17.466,10.752],[0,0],[5.322,0.854],[10.67,1.735],[2.732,0.131],[0,0],[0,0],[5.494,0.116],[0,0],[0,0],[0,0],[0,0],[5.47,-0.672],[0,0],[20.99,-4.458],[19.753,-8.589],[17.935,-12.223],[15.897,-15.04],[27.864,-34.118],[0,0],[5.181,-9.869],[5.559,-9.766],[0,0],[1.741,-2.509],[1.588,1.101],[-0.379,12.098],[-2.642,11.324],[-8.047,21.669],[-23.164,39.978],[-14.621,18.088],[-16.893,16.196],[-38.816,26.708],[0,0],[-5.88,1.022],[0,0],[0,0],[0,0],[0,0],[-5.785,0.33],[0,0],[0,0],[-2.914,-0.025],[-11.706,-0.766],[-5.859,-0.795],[0,0],[-23.197,-5.599],[-21.205,-12.851],[-13.121,-21.785],[-2.792,-24.42],[2.06,-11.738],[1.613,-5.711],[1.966,-5.74],[0,0],[0,0],[77.108,-10.58],[18.676,-4.244],[16.054,-5.822],[13.612,-12.029],[11.933,-14.872],[22.896,-31.632],[25.94,-30.296],[30.692,-26.077],[36.075,-17.82],[2.985,-0.311],[0.235,2.26],[0,0]],"v":[[406.082,-368.479],[303.455,-315.009],[208.936,-251.703],[187.097,-233.356],[166.369,-213.671],[127.457,-171.502],[56.936,-79.117],[21.136,-31.622],[-20.635,13.332],[-75.429,47.051],[-134.125,62.734],[-367.092,101.354],[-354.518,91.911],[-359.987,106.545],[-364.77,121.971],[-371.921,153.45],[-374.585,216.666],[-356.136,274.252],[-313.478,315.99],[-255.038,338.433],[-239.3,341.74],[-223.208,343.892],[-190.647,346.565],[-182.455,346.982],[-174.203,346.949],[-157.697,346.896],[-141.149,346.263],[-124.58,345.296],[-116.294,344.81],[-108.007,343.914],[-91.431,342.13],[-74.979,340.177],[-59.085,337.471],[2.415,318.34],[59.129,287.034],[109.958,245.989],[154.779,197.747],[227.207,86.75],[257.395,27.348],[273.421,-2.148],[291.371,-31.187],[291.487,-31.354],[299.183,-32.747],[301.56,-28.028],[296.484,6.857],[286.405,40.097],[256.994,102.797],[179.526,218.035],[131.908,269.275],[77.123,313.496],[-52.935,368.874],[-70.537,371.868],[-87.815,373.926],[-105.022,375.775],[-113.626,376.698],[-122.299,377.215],[-139.649,378.228],[-157.043,378.889],[-174.515,378.947],[-183.251,378.972],[-192.023,378.536],[-227.152,375.648],[-244.728,373.275],[-262.246,369.611],[-330.053,343.364],[-383.491,290.856],[-406.397,220.132],[-403.456,148.019],[-395.563,113.266],[-390.284,96.243],[-383.828,79.069],[-380.348,70.874],[-371.253,69.626],[-140.955,31.473],[-86.266,16.941],[-41.802,-10.668],[-3.809,-51.667],[31.054,-97.937],[103.018,-192.16],[187.57,-277.585],[288.287,-344.02],[402.985,-378.687],[408.954,-373.85],[406.119,-368.497]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[513.107,379.248],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":4,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-12.92,32.6],[113.84,-94.36],[0.84,-0.68],[2.121,-1.64],[64.441,-8.4],[0,0],[-75.08,12.88],[0,-54.302],[-45.752,-9.747],[-64.247,50.125],[-0.43,0.338]],"o":[[-17.479,48.32],[-0.84,0.72],[-2.08,1.72],[-46.6,36.641],[-437.04,56.88],[0,0],[32.6,63.88],[0,53.402],[79.699,16.98],[0.432,-0.337],[119.16,-93.559]],"v":[[341.405,-188.474],[149.605,102.286],[147.086,104.366],[140.805,109.406],[-25.435,181.846],[-318.795,-89.194],[-71.115,-131.234],[-137.58,12.237],[-67.115,94.582],[160.312,41.619],[161.605,40.606]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.749019622803,0.525490224361,0.47058826685,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[462.724,553.944],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 2","np":4,"cix":2,"bm":0,"ix":2,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-50.92,15.44],[0,0],[0,0],[0,0],[143.88,-113],[64.44,-8.4],[0,0],[-72.04,24.601],[-143.88,116.48],[-20.399,12.72],[-4.399,2.6]],"o":[[0,0],[0,0],[0,0],[0,0],[-46.601,36.64],[-437.04,56.88],[0,0],[97.84,-33.439],[17.279,-13.961],[4.281,-2.681],[38,-22.24]],"v":[[458.7,-393.5],[440.7,-336.22],[406.42,-227.101],[350.62,-49.54],[144.58,264.18],[-21.66,336.62],[-315.021,65.58],[-28.62,12.859],[256.66,-288.18],[313.059,-328.34],[326.099,-336.22]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.928911635455,0.76966827991,0.580090092678,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[458.95,399.17],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 3","np":4,"cix":2,"bm":0,"ix":3,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":15,"ty":4,"nm":"R Leg","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[745.182,732.342,0],"ix":2},"a":{"a":0,"k":[986.124,187.528,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-78.184,-50.863],[-138.784,138.529],[171.587,-17.056],[389.591,-120.829]],"o":[[134.838,87.72],[231.584,-231.162],[-166.418,16.541],[-172.934,53.634]],"v":[[-353.355,210.284],[260.62,145.417],[153.917,-280.948],[-319.27,-116.536]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[680.467,378.004],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[105.279,-105.079],[134.841,87.72],[-26.28,85.24],[-29.641,-19.28],[-138.801,138.519],[-13.801,52.88]],"o":[[-138.801,138.561],[-51.76,-33.681],[12.8,50],[134.841,87.72],[58.919,-58.84],[22.359,77.521]],"v":[[288.843,81.934],[-325.119,146.815],[-394.678,-80.826],[-325.119,32.374],[288.843,-32.505],[394.722,-201.826]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.749019622803,0.525490224361,0.470588237047,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[652.242,441.473],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 2","np":4,"cix":2,"bm":0,"ix":2,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-78.184,-50.863],[-138.784,138.529],[171.587,-17.056],[389.591,-120.829]],"o":[[134.838,87.72],[231.584,-231.162],[-166.418,16.541],[-172.934,53.634]],"v":[[-353.355,210.284],[260.62,145.417],[153.917,-280.948],[-319.27,-116.536]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.928911635455,0.76966827991,0.580090092678,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[680.467,378.004],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 3","np":4,"cix":2,"bm":0,"ix":3,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[30.561,20.532],[38.765,-9.458],[6.138,-10.369],[-104.556,38.528]],"o":[[-20.743,-13.937],[-69.587,16.978],[-17.383,29.366],[82.478,-30.392]],"v":[[60.681,-72.803],[-19.165,-61.314],[-164.718,-22.827],[99.623,48.212]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[283.418,361.16],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 4","np":2,"cix":2,"bm":0,"ix":4,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[30.561,20.532],[38.765,-9.458],[6.138,-10.369],[-104.556,38.528]],"o":[[-20.743,-13.937],[-69.587,16.978],[-17.383,29.366],[82.478,-30.392]],"v":[[60.681,-72.803],[-19.165,-61.314],[-164.718,-22.827],[99.623,48.212]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[283.418,361.16],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 5","np":4,"cix":2,"bm":0,"ix":5,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[31.02,19.831],[38.54,-10.338],[5.9,-10.505],[-103.653,40.897]],"o":[[-21.055,-13.46],[-69.182,18.557],[-16.711,29.754],[81.764,-32.262]],"v":[[58.732,-73.768],[-20.833,-60.463],[-165.471,-18.674],[100.418,46.331]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[262.182,461.593],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 6","np":2,"cix":2,"bm":0,"ix":6,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[5.9,-10.505],[-103.652,40.897]],"o":[[-69.182,18.558],[-16.711,29.754],[0,0]],"v":[[20.05,-73.846],[-124.589,-32.057],[141.3,32.948]],"c":false},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[221.3,474.974],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 7","np":4,"cix":2,"bm":0,"ix":7,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[31.134,19.653],[38.478,-10.559],[5.84,-10.538],[-103.416,41.492]],"o":[[-21.131,-13.339],[-69.076,18.954],[-16.54,29.85],[81.579,-32.729]],"v":[[58.235,-74.005],[-21.25,-60.245],[-165.648,-17.628],[100.609,45.852]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[305.363,559.044],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 8","np":2,"cix":2,"bm":0,"ix":8,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[5.839,-10.538],[-103.416,41.491]],"o":[[-69.075,18.954],[-16.54,29.85],[0,0]],"v":[[19.539,-73.794],[-124.858,-31.177],[141.398,32.303]],"c":false},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[264.574,572.594],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 9","np":4,"cix":2,"bm":0,"ix":9,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-78.184,-50.863],[-138.784,138.529],[171.587,-17.056],[389.591,-120.829]],"o":[[134.838,87.72],[231.584,-231.162],[-166.418,16.541],[-172.934,53.634]],"v":[[-353.355,210.284],[260.62,145.417],[153.917,-280.948],[-319.27,-116.536]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.836017922794,0.65023354923,0.524163579006,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 2","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"fl","c":{"a":0,"k":[0.836017922794,0.65023354923,0.524163579006,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[680.467,378.004],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 10","np":5,"cix":2,"bm":0,"ix":10,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":16,"ty":4,"nm":"L Leg","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[-752.42,795.834,0],"ix":2},"a":{"a":0,"k":[245.383,251.02,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[78.183,-50.863],[138.783,138.529],[-171.587,-17.056],[-389.591,-120.829]],"o":[[-134.838,87.72],[-231.584,-231.162],[166.417,16.541],[172.933,53.634]],"v":[[353.356,210.284],[-260.619,145.417],[-153.917,-280.948],[319.271,-116.536]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[572.203,378.004],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[51.52,-33.521],[138.8,138.561],[-21.8,77.36],[-59.4,-59.279],[-134.84,87.721],[-12.64,50.6]],"o":[[-134.84,87.72],[-104.72,-104.519],[13.56,53.28],[138.8,138.521],[29.92,-19.439],[25.52,85.081]],"v":[[325.107,146.195],[-288.853,81.314],[-395.053,-201.205],[-288.853,-30.566],[325.107,34.274],[395.027,-80.326]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.749019622803,0.525490224361,0.47058826685,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[600.438,442.093],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 2","np":4,"cix":2,"bm":0,"ix":2,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[78.201,-50.881],[138.8,138.561],[-87,73.601],[-55,-5.481],[-199,-73.519],[-70.24,-21.8]],"o":[[-134.84,87.72],[-157.36,-157.079],[41.04,-34.72],[136.4,13.559],[43.76,16.201],[172.96,53.601]],"v":[[316.22,204.5],[-297.74,139.62],[-341.58,-239.38],[-191.02,-286.739],[113.3,-179.02],[282.14,-122.3]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.928911635455,0.76966827991,0.580090092678,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[609.324,383.787],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 3","np":4,"cix":2,"bm":0,"ix":3,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[78.183,-50.863],[138.783,138.529],[-171.587,-17.056],[-389.591,-120.829]],"o":[[-134.838,87.72],[-231.584,-231.162],[166.417,16.541],[172.933,53.634]],"v":[[353.356,210.284],[-260.619,145.417],[-153.917,-280.948],[319.271,-116.536]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.836017922794,0.65023354923,0.524163579006,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 2","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"fl","c":{"a":0,"k":[0.836017922794,0.65023354923,0.524163579006,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[572.203,378.004],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 4","np":5,"cix":2,"bm":0,"ix":4,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-30.561,20.532],[-38.764,-9.458],[-6.137,-10.369],[104.557,38.528]],"o":[[20.742,-13.937],[69.587,16.978],[17.383,29.366],[-82.477,-30.392]],"v":[[-60.68,-72.803],[19.164,-61.314],[164.717,-22.827],[-99.624,48.212]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[969.253,361.16],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 5","np":2,"cix":2,"bm":0,"ix":5,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-30.561,20.532],[-38.764,-9.458],[-6.137,-10.369],[104.557,38.528]],"o":[[20.742,-13.937],[69.587,16.978],[17.383,29.366],[-82.477,-30.392]],"v":[[-60.68,-72.803],[19.164,-61.314],[164.717,-22.827],[-99.624,48.212]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[969.253,361.16],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 6","np":4,"cix":2,"bm":0,"ix":6,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-31.021,19.831],[-38.539,-10.338],[-5.9,-10.505],[103.653,40.897]],"o":[[21.054,-13.46],[69.182,18.557],[16.711,29.754],[-81.765,-32.262]],"v":[[-58.73,-73.768],[20.833,-60.463],[165.471,-18.674],[-100.417,46.331]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[990.488,461.593],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 7","np":2,"cix":2,"bm":0,"ix":7,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[-5.901,-10.505],[103.652,40.897]],"o":[[69.182,18.558],[16.711,29.754],[0,0]],"v":[[-20.05,-73.846],[124.589,-32.057],[-141.3,32.948]],"c":false},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[1031.371,474.974],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 8","np":4,"cix":2,"bm":0,"ix":8,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-31.134,19.653],[-38.479,-10.559],[-5.839,-10.538],[103.417,41.492]],"o":[[21.131,-13.339],[69.075,18.954],[16.54,29.85],[-81.578,-32.729]],"v":[[-58.234,-74.005],[21.251,-60.245],[165.647,-17.628],[-100.609,45.852]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[947.307,559.044],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 9","np":2,"cix":2,"bm":0,"ix":9,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[-5.839,-10.538],[103.417,41.491]],"o":[[69.075,18.954],[16.54,29.85],[0,0]],"v":[[-19.538,-73.794],[124.859,-31.177],[-141.398,32.303]],"c":false},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[988.096,572.594],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 10","np":4,"cix":2,"bm":0,"ix":10,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":17,"ty":4,"nm":"Body","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[-13.626,989.579,0],"ix":2},"a":{"a":0,"k":[743.795,1035.478,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-0.08,0.199],[0,0]],"o":[[0,0],[0.16,-0.48]],"v":[[0.16,-0.519],[-0.16,0.521]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[322.381,367.44],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":4,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[2.56,-6.56],[-0.72,2.199],[0,0]],"o":[[2.56,-7.119],[0,0],[0,0]],"v":[[-2.44,7.1],[2.44,-7.099],[1.24,-3.059]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[319.781,375.061],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 2","np":4,"cix":2,"bm":0,"ix":2,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[180.965,-80.688],[0,0],[255.244,115.333],[0,0],[-44.518,192.121],[-29.813,77.729],[0,0],[0,0],[-44.881,-120.907],[-22.895,-98.322]],"o":[[0,0],[-255.814,114.064],[0,0],[-179.717,-81.206],[25.429,-109.746],[41.217,-107.387],[0,0],[0,0],[27.241,73.32],[44.936,192.976]],"v":[[403.586,406.761],[397.637,409.415],[-405.792,407.417],[-405.792,407.417],[-639.277,-62.635],[-550.961,-348.948],[-474.787,-523.479],[474.772,-523.479],[559.721,-325.665],[638.859,-64.526]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.450238485897,0.141227752087,0.342166885675,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":32,"ix":5},"lc":2,"lj":1,"ml":10,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[763.795,603.479],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 3","np":2,"cix":2,"bm":0,"ix":3,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-1.561,-0.601],[14.64,-40.239],[105.84,-47.161],[0,0],[128.44,-3.04],[7.28,16.04],[9.519,-12.12],[119.72,54.16],[36.721,103.64],[1.08,43.88],[-2.56,0.759],[0,2.56],[-7.201,31.04],[-29.841,77.72],[-12.88,28.799],[-0.96,2.16],[-4.519,9.04],[0,0],[0,0],[0,0],[0,0],[99.92,-153.24],[1.44,-2.081],[-352.16,-109.24],[-17.439,-28.72],[-42.721,13.24],[-125.44,17.16],[1.08,1.64],[0,0],[0,0],[0,0],[0,0],[-2.56,-5.16],[-10.48,-23.08],[-1.041,-2.28],[-17.161,-44.68],[-25.44,-109.761],[0,-30.76],[0.08,-3.36],[0.039,-0.4]],"o":[[-1.521,43.56],[-37.44,102.841],[0,0],[-119.961,53.52],[-9.521,-12.16],[-7.279,16],[-128.481,-3.64],[-106,-47.88],[-14.439,-40.6],[2.521,-0.84],[-0.04,-2.56],[0,-30.76],[25.439,-109.761],[17.159,-44.68],[1.04,-2.28],[10.48,-23.08],[2.561,-5.16],[0,0],[0,0],[0,0],[0,0],[-1.359,2.12],[113.16,17.52],[42.72,13.24],[17.4,-28.72],[362.16,-112.32],[-1.121,-1.6],[-99.92,-153.24],[0,0],[0,0],[0,0],[0,0],[4.52,9.04],[0.959,2.16],[12.879,28.799],[29.839,77.72],[7.2,31.04],[0,3.359],[0,0.4],[1.56,0.56]],"v":[[649.56,57.86],[624.96,184.259],[403.8,421.42],[397.88,424.06],[21.52,508.82],[-3.96,466.06],[-29.399,508.7],[-405.56,422.06],[-625.96,182.42],[-649.56,54.98],[-641.92,52.58],[-642,44.94],[-631.359,-47.98],[-543.039,-334.3],[-496.92,-445.54],[-493.92,-452.18],[-470.84,-500.94],[-466.88,-508.82],[-429.96,-508.82],[-429.88,-505.26],[-425.64,-319.22],[-519.88,44.1],[-524.08,50.42],[-92.6,209.74],[-3.96,275.22],[84.64,209.74],[526.16,48.98],[522.919,44.1],[428.68,-319.22],[432.919,-505.26],[432.999,-508.82],[469.919,-508.82],[473.88,-500.94],[496.96,-452.18],[499.96,-445.54],[546.08,-334.3],[634.4,-47.98],[645.039,44.94],[644.919,54.98],[644.88,56.14]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.749019622803,0.525490224361,0.47058826685,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[755.901,588.821],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 4","np":4,"cix":2,"bm":0,"ix":4,"mn":"ADBE Vector Group","hd":false},{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[1.28,-35.521],[1.361,-11.28],[10.8,-29.639],[105.84,-47.161],[0,0],[128.44,-3.04],[17,0.48],[119.72,54.16],[36.72,103.64],[2.72,10.36],[2.319,20.4],[0.281,12.279],[0,3.359],[-7.2,31.04],[-29.841,77.72],[-12.88,28.799],[-0.96,2.16],[-4.519,9.04],[0,0],[0,0],[-2.88,-5.84],[-11.279,-25.121],[-1.04,-2.28],[-19.28,-51.96],[-22.88,-98.32]],"o":[[-0.4,11.479],[-3.76,31.64],[-37.44,102.841],[0,0],[-119.96,53.52],[-16.96,0.4],[-128.48,-3.64],[-106,-47.88],[-3.601,-10.081],[-5.36,-19.64],[-1.4,-12.12],[-0.08,-3.36],[0,-30.76],[25.439,-109.761],[17.159,-44.68],[1.04,-2.28],[10.481,-23.08],[2.561,-5.16],[0,0],[0,0],[4.96,10],[0.96,2.16],[14.721,33.12],[27.241,73.319],[8.399,36]],"v":[[648.98,57.66],[646.34,91.82],[624.38,184.059],[403.22,421.22],[397.3,423.86],[20.94,508.62],[-29.979,508.5],[-406.14,421.86],[-626.539,182.22],[-636.06,151.5],[-647.579,91.38],[-650.14,54.78],[-650.26,44.74],[-639.619,-48.18],[-551.299,-334.5],[-505.18,-445.74],[-502.18,-452.38],[-479.1,-501.14],[-475.14,-509.02],[474.42,-509.02],[478.9,-500.14],[503.98,-446.78],[506.98,-440.14],[559.38,-311.22],[638.501,-50.06]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.928911635455,0.76966827991,0.580090092678,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[764.161,589.021],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 5","np":4,"cix":2,"bm":0,"ix":5,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":18,"ty":4,"nm":"Outer shadow","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[2000,3536.535,0],"ix":2},"a":{"a":0,"k":[850.85,75.075,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":30,"s":[20,20,100]},{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":61,"s":[90,90,100]},{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":91,"s":[100,100,100]},{"i":{"x":[0.667,0.667,0.667],"y":[1,1,1]},"o":{"x":[0.333,0.333,0.333],"y":[0,0,0]},"t":120,"s":[90,90,100]},{"t":149,"s":[100,100,100]}],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,-41.463],[469.912,0],[0,41.463],[-469.911,0]],"o":[[0,41.463],[-469.911,0],[0,-41.463],[469.912,0]],"v":[[850.85,0],[0,75.075],[-850.85,0],[0,-75.075]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[0.705882370472,0.696993052959,0.694809734821,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[850.85,75.075],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Group 1","np":4,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":150,"st":0,"bm":0}]}]'),layers$1=[{ddd:0,ind:1,ty:0,nm:"Cute sloth yoga",refId:"comp_0",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[247.778,224.847,0],ix:2},a:{a:0,k:[2e3,2e3,0],ix:1},s:{a:0,k:[12,12,100],ix:6}},ao:0,w:4e3,h:4e3,ip:0,op:150,st:0,bm:0}],markers=[],slothAnimation={v:v$1,meta,fr:fr$1,ip:ip$1,op:op$1,w:w$1,h:h$1,nm:nm$1,ddd:ddd$1,assets:assets$1,layers:layers$1,markers},actions={suggest_topics:{description:"建議主題",params:{suggestions:{type:"array",items:{type:"string"},required:!0,description:"建議的主題列表"}}},suggest_steps:{description:"建議步驟",params:{suggestions:{type:"array",items:{type:"string"},required:!0,description:"建議的步驟列表"}}},suggest_tasks:{description:"建議任務",params:{suggestions:{type:"array",items:{type:"object",properties:{task_name:{type:"string",description:"任務名稱"},step_id:{type:"string",description:"步驟的唯一識別碼"}},required:["task_name","step_id"]},required:!0,description:"建議的任務列表，每個任務必須指定所屬步驟的 ID"}}},use_template_steps:{description:"建立觀察/行動/紀錄/分享",params:{}},chat:{description:"與孩子聊天",params:{}}},actions$1={actions};function parseJsonMarkdown(t,e=parsePartialJson){t=t.trim();const r=t.indexOf("```");if(r===-1)return e(t);let n=t.substring(r+3);n.startsWith(`json
`)?n=n.substring(5):n.startsWith("json")?n=n.substring(4):n.startsWith(`
`)&&(n=n.substring(1));const s=n.indexOf("```");let a=n;return s!==-1&&(a=n.substring(0,s)),e(a.trim())}function parsePartialJson(t){if(typeof t>"u")return null;try{return JSON.parse(t)}catch{}let e="";const r=[];let n=!1,s=!1;for(let a of t){if(n)a==='"'&&!s?n=!1:a===`
`&&!s?a="\\n":a==="\\"?s=!s:s=!1;else if(a==='"')n=!0,s=!1;else if(a==="{")r.push("}");else if(a==="[")r.push("]");else if(a==="}"||a==="]")if(r&&r[r.length-1]===a)r.pop();else return null;e+=a}n&&(e+='"');for(let a=r.length-1;a>=0;a-=1)e+=r[a];try{return JSON.parse(e)}catch{return null}}var decamelize,hasRequiredDecamelize;function requireDecamelize(){return hasRequiredDecamelize||(hasRequiredDecamelize=1,decamelize=function(t,e){if(typeof t!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,t.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()}),decamelize}var decamelizeExports=requireDecamelize();const snakeCase=getDefaultExportFromCjs(decamelizeExports);var camelcase={exports:{}},hasRequiredCamelcase;function requireCamelcase(){if(hasRequiredCamelcase)return camelcase.exports;hasRequiredCamelcase=1;const t=/[\p{Lu}]/u,e=/[\p{Ll}]/u,r=/^[\p{Lu}](?![\p{Lu}])/gu,n=/([\p{Alpha}\p{N}_]|$)/u,s=/[_.\- ]+/,a=new RegExp("^"+s.source),o=new RegExp(s.source+n.source,"gu"),l=new RegExp("\\d+"+n.source,"gu"),u=(m,y,b)=>{let E=!1,T=!1,S=!1;for(let P=0;P<m.length;P++){const A=m[P];E&&t.test(A)?(m=m.slice(0,P)+"-"+m.slice(P),E=!1,S=T,T=!0,P++):T&&S&&e.test(A)?(m=m.slice(0,P-1)+"-"+m.slice(P-1),S=T,T=!1,E=!0):(E=y(A)===A&&b(A)!==A,S=T,T=b(A)===A&&y(A)!==A)}return m},c=(m,y)=>(r.lastIndex=0,m.replace(r,b=>y(b))),d=(m,y)=>(o.lastIndex=0,l.lastIndex=0,m.replace(o,(b,E)=>y(E)).replace(l,b=>y(b))),p=(m,y)=>{if(!(typeof m=="string"||Array.isArray(m)))throw new TypeError("Expected the input to be `string | string[]`");if(y={pascalCase:!1,preserveConsecutiveUppercase:!1,...y},Array.isArray(m)?m=m.map(S=>S.trim()).filter(S=>S.length).join("-"):m=m.trim(),m.length===0)return"";const b=y.locale===!1?S=>S.toLowerCase():S=>S.toLocaleLowerCase(y.locale),E=y.locale===!1?S=>S.toUpperCase():S=>S.toLocaleUpperCase(y.locale);return m.length===1?y.pascalCase?E(m):b(m):(m!==b(m)&&(m=u(m,b,E)),m=m.replace(a,""),y.preserveConsecutiveUppercase?m=c(m,b):m=b(m),y.pascalCase&&(m=E(m.charAt(0))+m.slice(1)),d(m,E))};return camelcase.exports=p,camelcase.exports.default=p,camelcase.exports}requireCamelcase();function keyToJson(t,e){return(e==null?void 0:e[t])||snakeCase(t)}function mapKeys(t,e,r){const n={};for(const s in t)Object.hasOwn(t,s)&&(n[e(s,r)]=t[s]);return n}function shallowCopy(t){return Array.isArray(t)?[...t]:{...t}}function replaceSecrets(t,e){const r=shallowCopy(t);for(const[n,s]of Object.entries(e)){const[a,...o]=n.split(".").reverse();let l=r;for(const u of o.reverse()){if(l[u]===void 0)break;l[u]=shallowCopy(l[u]),l=l[u]}l[a]!==void 0&&(l[a]={lc:1,type:"secret",id:[s]})}return r}function get_lc_unique_name(t){const e=Object.getPrototypeOf(t);return typeof t.lc_name=="function"&&(typeof e.lc_name!="function"||t.lc_name()!==e.lc_name())?t.lc_name():t.name}class Serializable{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,get_lc_unique_name(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}constructor(e,...r){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_serializable_keys!==void 0?this.lc_kwargs=Object.fromEntries(Object.entries(e||{}).filter(([n])=>{var s;return(s=this.lc_serializable_keys)==null?void 0:s.includes(n)})):this.lc_kwargs=e??{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof Serializable||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},r={},n=Object.keys(this.lc_kwargs).reduce((s,a)=>(s[a]=a in this?this[a]:this.lc_kwargs[a],s),{});for(let s=Object.getPrototypeOf(this);s;s=Object.getPrototypeOf(s))Object.assign(e,Reflect.get(s,"lc_aliases",this)),Object.assign(r,Reflect.get(s,"lc_secrets",this)),Object.assign(n,Reflect.get(s,"lc_attributes",this));return Object.keys(r).forEach(s=>{let a=this,o=n;const[l,...u]=s.split(".").reverse();for(const c of u.reverse()){if(!(c in a)||a[c]===void 0)return;(!(c in o)||o[c]===void 0)&&(typeof a[c]=="object"&&a[c]!=null?o[c]={}:Array.isArray(a[c])&&(o[c]=[])),a=a[c],o=o[c]}l in a&&a[l]!==void 0&&(o[l]=o[l]||a[l])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:mapKeys(Object.keys(r).length?replaceSecrets(n,r):n,keyToJson,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}function isDataContentBlock(t){return typeof t=="object"&&t!==null&&"type"in t&&typeof t.type=="string"&&"source_type"in t&&(t.source_type==="url"||t.source_type==="base64"||t.source_type==="text"||t.source_type==="id")}function isURLContentBlock(t){return isDataContentBlock(t)&&t.source_type==="url"&&"url"in t&&typeof t.url=="string"}function isBase64ContentBlock(t){return isDataContentBlock(t)&&t.source_type==="base64"&&"data"in t&&typeof t.data=="string"}function convertToOpenAIImageBlock(t){if(isDataContentBlock(t)){if(t.source_type==="url")return{type:"image_url",image_url:{url:t.url}};if(t.source_type==="base64"){if(!t.mime_type)throw new Error("mime_type key is required for base64 data.");return{type:"image_url",image_url:{url:`data:${t.mime_type};base64,${t.data}`}}}}throw new Error("Unsupported source type. Only 'url' and 'base64' are supported.")}function parseMimeType(t){const e=t.split(";")[0].split("/");if(e.length!==2)throw new Error(`Invalid mime type: "${t}" - does not match type/subtype format.`);const r=e[0].trim(),n=e[1].trim();if(r===""||n==="")throw new Error(`Invalid mime type: "${t}" - type or subtype is empty.`);const s={};for(const a of t.split(";").slice(1)){const o=a.split("=");if(o.length!==2)throw new Error(`Invalid parameter syntax in mime type: "${t}".`);const l=o[0].trim(),u=o[1].trim();if(l==="")throw new Error(`Invalid parameter syntax in mime type: "${t}".`);s[l]=u}return{type:r,subtype:n,parameters:s}}function parseBase64DataUrl({dataUrl:t,asTypedArray:e=!1}){const r=t.match(/^data:(\w+\/\w+);base64,([A-Za-z0-9+/]+=*)$/);let n;if(r){n=r[1].toLowerCase();const s=e?Uint8Array.from(atob(r[2]),a=>a.charCodeAt(0)):r[2];return{mime_type:n,data:s}}}function convertToProviderContentBlock(t,e){if(t.type==="text"){if(!e.fromStandardTextBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardTextBlock\` method.`);return e.fromStandardTextBlock(t)}if(t.type==="image"){if(!e.fromStandardImageBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardImageBlock\` method.`);return e.fromStandardImageBlock(t)}if(t.type==="audio"){if(!e.fromStandardAudioBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardAudioBlock\` method.`);return e.fromStandardAudioBlock(t)}if(t.type==="file"){if(!e.fromStandardFileBlock)throw new Error(`Converter for ${e.providerName} does not implement \`fromStandardFileBlock\` method.`);return e.fromStandardFileBlock(t)}throw new Error(`Unable to convert content block type '${t.type}' to provider-specific format: not recognized.`)}function mergeContent(t,e){return typeof t=="string"?t===""?e:typeof e=="string"?t+e:Array.isArray(e)&&e.some(r=>isDataContentBlock(r))?[{type:"text",source_type:"text",text:t},...e]:[{type:"text",text:t},...e]:Array.isArray(e)?_mergeLists(t,e)??[...t,...e]:e===""?t:Array.isArray(t)&&t.some(r=>isDataContentBlock(r))?[...t,{type:"file",source_type:"text",text:e}]:[...t,{type:"text",text:e}]}function _mergeStatus(t,e){return t==="error"||e==="error"?"error":"success"}function stringifyWithDepthLimit(t,e){function r(n,s){if(typeof n!="object"||n===null||n===void 0)return n;if(s>=e)return Array.isArray(n)?"[Array]":"[Object]";if(Array.isArray(n))return n.map(o=>r(o,s+1));const a={};for(const o of Object.keys(n))a[o]=r(n[o],s+1);return a}return JSON.stringify(r(t,0),null,2)}class BaseMessage extends Serializable{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:Array.isArray(this.content)?this.content.map(e=>typeof e=="string"?e:e.type==="text"?e.text:"").join(""):""}getType(){return this._getType()}constructor(e,r){typeof e=="string"&&(e={content:e,additional_kwargs:r,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;const r=stringifyWithDepthLimit(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${r}`}}function _mergeDicts(t,e){const r={...t};for(const[n,s]of Object.entries(e))if(r[n]==null)r[n]=s;else{if(s==null)continue;if(typeof r[n]!=typeof s||Array.isArray(r[n])!==Array.isArray(s))throw new Error(`field[${n}] already exists in the message chunk, but with a different type.`);if(typeof r[n]=="string"){if(n==="type")continue;r[n]+=s}else if(typeof r[n]=="object"&&!Array.isArray(r[n]))r[n]=_mergeDicts(r[n],s);else if(Array.isArray(r[n]))r[n]=_mergeLists(r[n],s);else{if(r[n]===s)continue;console.warn(`field[${n}] already exists in this message chunk and value has unsupported type.`)}}return r}function _mergeLists(t,e){if(!(t===void 0&&e===void 0)){if(t===void 0||e===void 0)return t||e;{const r=[...t];for(const n of e)if(typeof n=="object"&&"index"in n&&typeof n.index=="number"){const s=r.findIndex(a=>a.index===n.index);s!==-1?r[s]=_mergeDicts(r[s],n):r.push(n)}else{if(typeof n=="object"&&"text"in n&&n.text==="")continue;r.push(n)}return r}}}function _mergeObj(t,e){if(!t&&!e)throw new Error("Cannot merge two undefined objects.");if(!t||!e)return t||e;if(typeof t!=typeof e)throw new Error(`Cannot merge objects of different types.
Left ${typeof t}
Right ${typeof e}`);if(typeof t=="string"&&typeof e=="string")return t+e;if(Array.isArray(t)&&Array.isArray(e))return _mergeLists(t,e);if(typeof t=="object"&&typeof e=="object")return _mergeDicts(t,e);if(t===e)return t;throw new Error(`Can not merge objects of different types.
Left ${t}
Right ${e}`)}class BaseMessageChunk extends BaseMessage{}function _isMessageFieldWithRole(t){return typeof t.role=="string"}function isBaseMessage(t){return typeof(t==null?void 0:t._getType)=="function"}function isBaseMessageChunk(t){return isBaseMessage(t)&&typeof t.concat=="function"}class ToolMessage extends BaseMessage{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(e,r,n){typeof e=="string"&&(e={content:e,name:n,tool_call_id:r}),super(e),Object.defineProperty(this,"lc_direct_tool_output",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}_getType(){return"tool"}static isInstance(e){return e._getType()==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}class ToolMessageChunk extends BaseMessageChunk{constructor(e){super(e),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}static lc_name(){return"ToolMessageChunk"}_getType(){return"tool"}concat(e){return new ToolMessageChunk({content:mergeContent(this.content,e.content),additional_kwargs:_mergeDicts(this.additional_kwargs,e.additional_kwargs),response_metadata:_mergeDicts(this.response_metadata,e.response_metadata),artifact:_mergeObj(this.artifact,e.artifact),tool_call_id:this.tool_call_id,id:this.id??e.id,status:_mergeStatus(this.status,e.status)})}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}function defaultToolCallParser(t){const e=[],r=[];for(const n of t)if(n.function){const s=n.function.name;try{const a=JSON.parse(n.function.arguments),o={name:s||"",args:a||{},id:n.id};e.push(o)}catch{r.push({name:s,args:n.function.arguments,id:n.id,error:"Malformed args."})}}else continue;return[e,r]}class AIMessage extends BaseMessage{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,r){var s;let n;if(typeof e=="string")n={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:r??{}};else{n=e;const a=(s=n.additional_kwargs)==null?void 0:s.tool_calls,o=n.tool_calls;a!=null&&a.length>0&&(o===void 0||o.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(a!=null&&o===void 0){const[l,u]=defaultToolCallParser(a);n.tool_calls=l??[],n.invalid_tool_calls=u??[]}else n.tool_calls=n.tool_calls??[],n.invalid_tool_calls=n.invalid_tool_calls??[]}catch{n.tool_calls=[],n.invalid_tool_calls=[]}}super(n),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof n!="string"&&(this.tool_calls=n.tool_calls??this.tool_calls,this.invalid_tool_calls=n.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=n.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}}function isAIMessage(t){return t._getType()==="ai"}function isAIMessageChunk(t){return t._getType()==="ai"}class AIMessageChunk extends BaseMessageChunk{constructor(e){let r;if(typeof e=="string")r={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0)r={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0};else{const n=[],s=[];for(const a of e.tool_call_chunks){let o={};try{if(o=parsePartialJson(a.args||"{}"),o===null||typeof o!="object"||Array.isArray(o))throw new Error("Malformed tool call chunk args.");n.push({name:a.name??"",args:o,id:a.id,type:"tool_call"})}catch{s.push({name:a.name,args:a.args,id:a.id,error:"Malformed args.",type:"invalid_tool_call"})}}r={...e,tool_calls:n,invalid_tool_calls:s,usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0}}super(r),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=r.tool_call_chunks??this.tool_call_chunks,this.tool_calls=r.tool_calls??this.tool_calls,this.invalid_tool_calls=r.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=r.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){var n,s,a,o,l,u,c,d,p,m,y,b,E,T,S,P,A,I,j,K,W,H,ee,ue,de,fe,ae,ce,me,te,le,Z,Y,he,oe,ye,Ee,Ae,je,Te;const r={content:mergeContent(this.content,e.content),additional_kwargs:_mergeDicts(this.additional_kwargs,e.additional_kwargs),response_metadata:_mergeDicts(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){const Ve=_mergeLists(this.tool_call_chunks,e.tool_call_chunks);Ve!==void 0&&Ve.length>0&&(r.tool_call_chunks=Ve)}if(this.usage_metadata!==void 0||e.usage_metadata!==void 0){const Ve={...(((s=(n=this.usage_metadata)==null?void 0:n.input_token_details)==null?void 0:s.audio)!==void 0||((o=(a=e.usage_metadata)==null?void 0:a.input_token_details)==null?void 0:o.audio)!==void 0)&&{audio:(((u=(l=this.usage_metadata)==null?void 0:l.input_token_details)==null?void 0:u.audio)??0)+(((d=(c=e.usage_metadata)==null?void 0:c.input_token_details)==null?void 0:d.audio)??0)},...(((m=(p=this.usage_metadata)==null?void 0:p.input_token_details)==null?void 0:m.cache_read)!==void 0||((b=(y=e.usage_metadata)==null?void 0:y.input_token_details)==null?void 0:b.cache_read)!==void 0)&&{cache_read:(((T=(E=this.usage_metadata)==null?void 0:E.input_token_details)==null?void 0:T.cache_read)??0)+(((P=(S=e.usage_metadata)==null?void 0:S.input_token_details)==null?void 0:P.cache_read)??0)},...(((I=(A=this.usage_metadata)==null?void 0:A.input_token_details)==null?void 0:I.cache_creation)!==void 0||((K=(j=e.usage_metadata)==null?void 0:j.input_token_details)==null?void 0:K.cache_creation)!==void 0)&&{cache_creation:(((H=(W=this.usage_metadata)==null?void 0:W.input_token_details)==null?void 0:H.cache_creation)??0)+(((ue=(ee=e.usage_metadata)==null?void 0:ee.input_token_details)==null?void 0:ue.cache_creation)??0)}},Pe={...(((fe=(de=this.usage_metadata)==null?void 0:de.output_token_details)==null?void 0:fe.audio)!==void 0||((ce=(ae=e.usage_metadata)==null?void 0:ae.output_token_details)==null?void 0:ce.audio)!==void 0)&&{audio:(((te=(me=this.usage_metadata)==null?void 0:me.output_token_details)==null?void 0:te.audio)??0)+(((Z=(le=e.usage_metadata)==null?void 0:le.output_token_details)==null?void 0:Z.audio)??0)},...(((he=(Y=this.usage_metadata)==null?void 0:Y.output_token_details)==null?void 0:he.reasoning)!==void 0||((ye=(oe=e.usage_metadata)==null?void 0:oe.output_token_details)==null?void 0:ye.reasoning)!==void 0)&&{reasoning:(((Ae=(Ee=this.usage_metadata)==null?void 0:Ee.output_token_details)==null?void 0:Ae.reasoning)??0)+(((Te=(je=e.usage_metadata)==null?void 0:je.output_token_details)==null?void 0:Te.reasoning)??0)}},Ce=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},De=e.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},ze={input_tokens:Ce.input_tokens+De.input_tokens,output_tokens:Ce.output_tokens+De.output_tokens,total_tokens:Ce.total_tokens+De.total_tokens,...Object.keys(Ve).length>0&&{input_token_details:Ve},...Object.keys(Pe).length>0&&{output_token_details:Pe}};r.usage_metadata=ze}return new AIMessageChunk(r)}}class ChatMessage extends BaseMessage{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return ChatMessage}constructor(e,r){typeof e=="string"&&(e={content:e,role:r}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return e._getType()==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}}class ChatMessageChunk extends BaseMessageChunk{static lc_name(){return"ChatMessageChunk"}constructor(e,r){typeof e=="string"&&(e={content:e,role:r}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new ChatMessageChunk({content:mergeContent(this.content,e.content),additional_kwargs:_mergeDicts(this.additional_kwargs,e.additional_kwargs),response_metadata:_mergeDicts(this.response_metadata,e.response_metadata),role:this.role,id:this.id??e.id})}get _printableFields(){return{...super._printableFields,role:this.role}}}class FunctionMessageChunk extends BaseMessageChunk{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new FunctionMessageChunk({content:mergeContent(this.content,e.content),additional_kwargs:_mergeDicts(this.additional_kwargs,e.additional_kwargs),response_metadata:_mergeDicts(this.response_metadata,e.response_metadata),name:this.name??"",id:this.id??e.id})}}class HumanMessage extends BaseMessage{static lc_name(){return"HumanMessage"}_getType(){return"human"}constructor(e,r){super(e,r)}}class HumanMessageChunk extends BaseMessageChunk{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}constructor(e,r){super(e,r)}concat(e){return new HumanMessageChunk({content:mergeContent(this.content,e.content),additional_kwargs:_mergeDicts(this.additional_kwargs,e.additional_kwargs),response_metadata:_mergeDicts(this.response_metadata,e.response_metadata),id:this.id??e.id})}}class SystemMessage extends BaseMessage{static lc_name(){return"SystemMessage"}_getType(){return"system"}constructor(e,r){super(e,r)}}class SystemMessageChunk extends BaseMessageChunk{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}constructor(e,r){super(e,r)}concat(e){return new SystemMessageChunk({content:mergeContent(this.content,e.content),additional_kwargs:_mergeDicts(this.additional_kwargs,e.additional_kwargs),response_metadata:_mergeDicts(this.response_metadata,e.response_metadata),id:this.id??e.id})}}function addLangChainErrorFields$1(t,e){return t.lc_error_code=e,t.message=`${t.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,t}function _isToolCall(t){return!!(t&&typeof t=="object"&&"type"in t&&t.type==="tool_call")}class ToolInputParsingException extends Error{constructor(e,r){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=r}}function _coerceToolCall(t){return _isToolCall(t)?t:typeof t.id=="string"&&t.type==="function"&&typeof t.function=="object"&&t.function!==null&&"arguments"in t.function&&typeof t.function.arguments=="string"&&"name"in t.function&&typeof t.function.name=="string"?{id:t.id,args:JSON.parse(t.function.arguments),name:t.function.name,type:"tool_call"}:t}function isSerializedConstructor(t){return typeof t=="object"&&t!=null&&t.lc===1&&Array.isArray(t.id)&&t.kwargs!=null&&typeof t.kwargs=="object"}function _constructMessageFromParams(t){let e,r;if(isSerializedConstructor(t)){const n=t.id.at(-1);n==="HumanMessage"||n==="HumanMessageChunk"?e="user":n==="AIMessage"||n==="AIMessageChunk"?e="assistant":n==="SystemMessage"||n==="SystemMessageChunk"?e="system":n==="FunctionMessage"||n==="FunctionMessageChunk"?e="function":n==="ToolMessage"||n==="ToolMessageChunk"?e="tool":e="unknown",r=t.kwargs}else{const{type:n,...s}=t;e=n,r=s}if(e==="human"||e==="user")return new HumanMessage(r);if(e==="ai"||e==="assistant"){const{tool_calls:n,...s}=r;if(!Array.isArray(n))return new AIMessage(r);const a=n.map(_coerceToolCall);return new AIMessage({...s,tool_calls:a})}else{if(e==="system")return new SystemMessage(r);if(e==="developer")return new SystemMessage({...r,additional_kwargs:{...r.additional_kwargs,__openai_role__:"developer"}});if(e==="tool"&&"tool_call_id"in r)return new ToolMessage({...r,content:r.content,tool_call_id:r.tool_call_id,name:r.name});throw addLangChainErrorFields$1(new Error(`Unable to coerce message from array: only human, AI, system, developer, or tool message coercion is currently supported.

Received: ${JSON.stringify(t,null,2)}`),"MESSAGE_COERCION_FAILURE")}}function coerceMessageLikeToMessage(t){if(typeof t=="string")return new HumanMessage(t);if(isBaseMessage(t))return t;if(Array.isArray(t)){const[e,r]=t;return _constructMessageFromParams({type:e,content:r})}else if(_isMessageFieldWithRole(t)){const{role:e,...r}=t;return _constructMessageFromParams({...r,type:e})}else return _constructMessageFromParams(t)}function getBufferString(t,e="Human",r="AI"){const n=[];for(const s of t){let a;if(s._getType()==="human")a=e;else if(s._getType()==="ai")a=r;else if(s._getType()==="system")a="System";else if(s._getType()==="function")a="Function";else if(s._getType()==="tool")a="Tool";else if(s._getType()==="generic")a=s.role;else throw new Error(`Got unsupported message type: ${s._getType()}`);const o=s.name?`${s.name}, `:"",l=typeof s.content=="string"?s.content:JSON.stringify(s.content,null,2);n.push(`${a}: ${o}${l}`)}return n.join(`
`)}function convertToChunk(t){var r;const e=t._getType();if(e==="human")return new HumanMessageChunk({...t});if(e==="ai"){let n={...t};return"tool_calls"in n&&(n={...n,tool_call_chunks:(r=n.tool_calls)==null?void 0:r.map(s=>({...s,type:"tool_call_chunk",index:void 0,args:JSON.stringify(s.args)}))}),new AIMessageChunk({...n})}else{if(e==="system")return new SystemMessageChunk({...t});if(e==="function")return new FunctionMessageChunk({...t});if(ChatMessage.isInstance(t))return new ChatMessageChunk({...t});throw new Error("Unknown message type.")}}var util;(function(t){t.assertEqual=s=>{};function e(s){}t.assertIs=e;function r(s){throw new Error}t.assertNever=r,t.arrayToEnum=s=>{const a={};for(const o of s)a[o]=o;return a},t.getValidEnumValues=s=>{const a=t.objectKeys(s).filter(l=>typeof s[s[l]]!="number"),o={};for(const l of a)o[l]=s[l];return t.objectValues(o)},t.objectValues=s=>t.objectKeys(s).map(function(a){return s[a]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const a=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&a.push(o);return a},t.find=(s,a)=>{for(const o of s)if(a(o))return o},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function n(s,a=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(a)}t.joinValues=n,t.jsonStringifyReplacer=(s,a)=>typeof a=="bigint"?a.toString():a})(util||(util={}));var objectUtil;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(objectUtil||(objectUtil={}));const ZodParsedType=util.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),getParsedType=t=>{switch(typeof t){case"undefined":return ZodParsedType.undefined;case"string":return ZodParsedType.string;case"number":return Number.isNaN(t)?ZodParsedType.nan:ZodParsedType.number;case"boolean":return ZodParsedType.boolean;case"function":return ZodParsedType.function;case"bigint":return ZodParsedType.bigint;case"symbol":return ZodParsedType.symbol;case"object":return Array.isArray(t)?ZodParsedType.array:t===null?ZodParsedType.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ZodParsedType.promise:typeof Map<"u"&&t instanceof Map?ZodParsedType.map:typeof Set<"u"&&t instanceof Set?ZodParsedType.set:typeof Date<"u"&&t instanceof Date?ZodParsedType.date:ZodParsedType.object;default:return ZodParsedType.unknown}},ZodIssueCode=util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ZodError extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){const r=e||function(a){return a.message},n={_errors:[]},s=a=>{for(const o of a.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)n._errors.push(r(o));else{let l=n,u=0;for(;u<o.path.length;){const c=o.path[u];u===o.path.length-1?(l[c]=l[c]||{_errors:[]},l[c]._errors.push(r(o))):l[c]=l[c]||{_errors:[]},l=l[c],u++}}};return s(this),n}static assert(e){if(!(e instanceof ZodError))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,util.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},n=[];for(const s of this.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}ZodError.create=t=>new ZodError(t);const errorMap=(t,e)=>{let r;switch(t.code){case ZodIssueCode.invalid_type:t.received===ZodParsedType.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case ZodIssueCode.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,util.jsonStringifyReplacer)}`;break;case ZodIssueCode.unrecognized_keys:r=`Unrecognized key(s) in object: ${util.joinValues(t.keys,", ")}`;break;case ZodIssueCode.invalid_union:r="Invalid input";break;case ZodIssueCode.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${util.joinValues(t.options)}`;break;case ZodIssueCode.invalid_enum_value:r=`Invalid enum value. Expected ${util.joinValues(t.options)}, received '${t.received}'`;break;case ZodIssueCode.invalid_arguments:r="Invalid function arguments";break;case ZodIssueCode.invalid_return_type:r="Invalid function return type";break;case ZodIssueCode.invalid_date:r="Invalid date";break;case ZodIssueCode.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:util.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case ZodIssueCode.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case ZodIssueCode.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case ZodIssueCode.custom:r="Invalid input";break;case ZodIssueCode.invalid_intersection_types:r="Intersection results could not be merged";break;case ZodIssueCode.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case ZodIssueCode.not_finite:r="Number must be finite";break;default:r=e.defaultError,util.assertNever(t)}return{message:r}};let overrideErrorMap=errorMap;function getErrorMap(){return overrideErrorMap}const makeIssue=t=>{const{data:e,path:r,errorMaps:n,issueData:s}=t,a=[...r,...s.path||[]],o={...s,path:a};if(s.message!==void 0)return{...s,path:a,message:s.message};let l="";const u=n.filter(c=>!!c).slice().reverse();for(const c of u)l=c(o,{data:e,defaultError:l}).message;return{...s,path:a,message:l}};function addIssueToContext(t,e){const r=getErrorMap(),n=makeIssue({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===errorMap?void 0:errorMap].filter(s=>!!s)});t.common.issues.push(n)}class ParseStatus{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const n=[];for(const s of r){if(s.status==="aborted")return INVALID;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){const n=[];for(const s of r){const a=await s.key,o=await s.value;n.push({key:a,value:o})}return ParseStatus.mergeObjectSync(e,n)}static mergeObjectSync(e,r){const n={};for(const s of r){const{key:a,value:o}=s;if(a.status==="aborted"||o.status==="aborted")return INVALID;a.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(n[a.value]=o.value)}return{status:e.value,value:n}}}const INVALID=Object.freeze({status:"aborted"}),DIRTY=t=>({status:"dirty",value:t}),OK=t=>({status:"valid",value:t}),isAborted=t=>t.status==="aborted",isDirty=t=>t.status==="dirty",isValid=t=>t.status==="valid",isAsync=t=>typeof Promise<"u"&&t instanceof Promise;var errorUtil;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(errorUtil||(errorUtil={}));var __classPrivateFieldGet$7=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},__classPrivateFieldSet$6=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},_ZodEnum_cache,_ZodNativeEnum_cache;class ParseInputLazyPath{constructor(e,r,n,s){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const handleResult=(t,e)=>{if(isValid(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new ZodError(t.common.issues);return this._error=r,this._error}}};function processCreateParams(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:n,description:s}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,l)=>{const{message:u}=t;return o.code==="invalid_enum_value"?{message:u??l.defaultError}:typeof l.data>"u"?{message:u??n??l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:u??r??l.defaultError}},description:s}}class ZodType{get description(){return this._def.description}_getType(e){return getParsedType(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:getParsedType(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:getParsedType(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(isAsync(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){const n={common:{issues:[],async:(r==null?void 0:r.async)??!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)},s=this._parseSync({data:e,path:n.path,parent:n});return handleResult(n,s)}"~validate"(e){var n,s;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:r});return isValid(a)?{value:a.value}:{issues:r.common.issues}}catch(a){(s=(n=a==null?void 0:a.message)==null?void 0:n.toLowerCase())!=null&&s.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(a=>isValid(a)?{value:a.value}:{issues:r.common.issues})}async parseAsync(e,r){const n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)},s=this._parse({data:e,path:n.path,parent:n}),a=await(isAsync(s)?s:Promise.resolve(s));return handleResult(n,a)}refine(e,r){const n=s=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(s):r;return this._refinement((s,a)=>{const o=e(s),l=()=>a.addIssue({code:ZodIssueCode.custom,...n(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(u=>u?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,r){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof r=="function"?r(n,s):r),!1))}_refinement(e){return new ZodEffects({schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this)}promise(){return ZodPromise.create(this,this._def)}or(e){return ZodUnion.create([this,e],this._def)}and(e){return ZodIntersection.create(this,e,this._def)}transform(e){return new ZodEffects({...processCreateParams(this._def),schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new ZodDefault({...processCreateParams(this._def),innerType:this,defaultValue:r,typeName:ZodFirstPartyTypeKind.ZodDefault})}brand(){return new ZodBranded({typeName:ZodFirstPartyTypeKind.ZodBranded,type:this,...processCreateParams(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new ZodCatch({...processCreateParams(this._def),innerType:this,catchValue:r,typeName:ZodFirstPartyTypeKind.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return ZodPipeline.create(this,e)}readonly(){return ZodReadonly.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const cuidRegex=/^c[^\s-]{8,}$/i,cuid2Regex=/^[0-9a-z]+$/,ulidRegex=/^[0-9A-HJKMNP-TV-Z]{26}$/i,uuidRegex=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,nanoidRegex=/^[a-z0-9_-]{21}$/i,jwtRegex=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,durationRegex=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,emailRegex=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,_emojiRegex="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let emojiRegex$2;const ipv4Regex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4CidrRegex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6Regex=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,ipv6CidrRegex=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64Regex=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64urlRegex=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,dateRegexSource="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dateRegex=new RegExp(`^${dateRegexSource}$`);function timeRegexSource(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function timeRegex(t){return new RegExp(`^${timeRegexSource(t)}$`)}function datetimeRegex(t){let e=`${dateRegexSource}T${timeRegexSource(t)}`;const r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function isValidIP(t,e){return!!((e==="v4"||!e)&&ipv4Regex.test(t)||(e==="v6"||!e)&&ipv6Regex.test(t))}function isValidJWT(t,e){if(!jwtRegex.test(t))return!1;try{const[r]=t.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||"typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||e&&s.alg!==e)}catch{return!1}}function isValidCidr(t,e){return!!((e==="v4"||!e)&&ipv4CidrRegex.test(t)||(e==="v6"||!e)&&ipv6CidrRegex.test(t))}class ZodString extends ZodType{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ZodParsedType.string){const a=this._getOrReturnCtx(e);return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.string,received:a.parsedType}),INVALID}const n=new ParseStatus;let s;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{code:ZodIssueCode.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="max")e.data.length>a.value&&(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{code:ZodIssueCode.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="length"){const o=e.data.length>a.value,l=e.data.length<a.value;(o||l)&&(s=this._getOrReturnCtx(e,s),o?addIssueToContext(s,{code:ZodIssueCode.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):l&&addIssueToContext(s,{code:ZodIssueCode.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind==="email")emailRegex.test(e.data)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{validation:"email",code:ZodIssueCode.invalid_string,message:a.message}),n.dirty());else if(a.kind==="emoji")emojiRegex$2||(emojiRegex$2=new RegExp(_emojiRegex,"u")),emojiRegex$2.test(e.data)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{validation:"emoji",code:ZodIssueCode.invalid_string,message:a.message}),n.dirty());else if(a.kind==="uuid")uuidRegex.test(e.data)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{validation:"uuid",code:ZodIssueCode.invalid_string,message:a.message}),n.dirty());else if(a.kind==="nanoid")nanoidRegex.test(e.data)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{validation:"nanoid",code:ZodIssueCode.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid")cuidRegex.test(e.data)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{validation:"cuid",code:ZodIssueCode.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid2")cuid2Regex.test(e.data)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{validation:"cuid2",code:ZodIssueCode.invalid_string,message:a.message}),n.dirty());else if(a.kind==="ulid")ulidRegex.test(e.data)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{validation:"ulid",code:ZodIssueCode.invalid_string,message:a.message}),n.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),addIssueToContext(s,{validation:"url",code:ZodIssueCode.invalid_string,message:a.message}),n.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{validation:"regex",code:ZodIssueCode.invalid_string,message:a.message}),n.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{code:ZodIssueCode.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{code:ZodIssueCode.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{code:ZodIssueCode.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind==="datetime"?datetimeRegex(a).test(e.data)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{code:ZodIssueCode.invalid_string,validation:"datetime",message:a.message}),n.dirty()):a.kind==="date"?dateRegex.test(e.data)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{code:ZodIssueCode.invalid_string,validation:"date",message:a.message}),n.dirty()):a.kind==="time"?timeRegex(a).test(e.data)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{code:ZodIssueCode.invalid_string,validation:"time",message:a.message}),n.dirty()):a.kind==="duration"?durationRegex.test(e.data)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{validation:"duration",code:ZodIssueCode.invalid_string,message:a.message}),n.dirty()):a.kind==="ip"?isValidIP(e.data,a.version)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{validation:"ip",code:ZodIssueCode.invalid_string,message:a.message}),n.dirty()):a.kind==="jwt"?isValidJWT(e.data,a.alg)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{validation:"jwt",code:ZodIssueCode.invalid_string,message:a.message}),n.dirty()):a.kind==="cidr"?isValidCidr(e.data,a.version)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{validation:"cidr",code:ZodIssueCode.invalid_string,message:a.message}),n.dirty()):a.kind==="base64"?base64Regex.test(e.data)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{validation:"base64",code:ZodIssueCode.invalid_string,message:a.message}),n.dirty()):a.kind==="base64url"?base64urlRegex.test(e.data)||(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{validation:"base64url",code:ZodIssueCode.invalid_string,message:a.message}),n.dirty()):util.assertNever(a);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(s=>e.test(s),{validation:r,code:ZodIssueCode.invalid_string,...errorUtil.errToObj(n)})}_addCheck(e){return new ZodString({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...errorUtil.errToObj(e)})}url(e){return this._addCheck({kind:"url",...errorUtil.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...errorUtil.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...errorUtil.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...errorUtil.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...errorUtil.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...errorUtil.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...errorUtil.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...errorUtil.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...errorUtil.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...errorUtil.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...errorUtil.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...errorUtil.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...errorUtil.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...errorUtil.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...errorUtil.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...errorUtil.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r==null?void 0:r.position,...errorUtil.errToObj(r==null?void 0:r.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...errorUtil.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...errorUtil.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...errorUtil.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...errorUtil.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...errorUtil.errToObj(r)})}nonempty(e){return this.min(1,errorUtil.errToObj(e))}trim(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}ZodString.create=t=>new ZodString({checks:[],typeName:ZodFirstPartyTypeKind.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...processCreateParams(t)});function floatSafeRemainder(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=r>n?r:n,a=Number.parseInt(t.toFixed(s).replace(".","")),o=Number.parseInt(e.toFixed(s).replace(".",""));return a%o/10**s}class ZodNumber extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ZodParsedType.number){const a=this._getOrReturnCtx(e);return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.number,received:a.parsedType}),INVALID}let n;const s=new ParseStatus;for(const a of this._def.checks)a.kind==="int"?util.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:"integer",received:"float",message:a.message}),s.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:ZodIssueCode.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:ZodIssueCode.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="multipleOf"?floatSafeRemainder(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:ZodIssueCode.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:ZodIssueCode.not_finite,message:a.message}),s.dirty()):util.assertNever(a);return{status:s.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,errorUtil.toString(r))}gt(e,r){return this.setLimit("min",e,!1,errorUtil.toString(r))}lte(e,r){return this.setLimit("max",e,!0,errorUtil.toString(r))}lt(e,r){return this.setLimit("max",e,!1,errorUtil.toString(r))}setLimit(e,r,n,s){return new ZodNumber({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:errorUtil.toString(s)}]})}_addCheck(e){return new ZodNumber({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:errorUtil.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:errorUtil.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:errorUtil.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:errorUtil.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:errorUtil.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:errorUtil.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&util.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}}ZodNumber.create=t=>new ZodNumber({checks:[],typeName:ZodFirstPartyTypeKind.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...processCreateParams(t)});class ZodBigInt extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ZodParsedType.bigint)return this._getInvalidInput(e);let n;const s=new ParseStatus;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:ZodIssueCode.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:ZodIssueCode.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:ZodIssueCode.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):util.assertNever(a);return{status:s.value,value:e.data}}_getInvalidInput(e){const r=this._getOrReturnCtx(e);return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.bigint,received:r.parsedType}),INVALID}gte(e,r){return this.setLimit("min",e,!0,errorUtil.toString(r))}gt(e,r){return this.setLimit("min",e,!1,errorUtil.toString(r))}lte(e,r){return this.setLimit("max",e,!0,errorUtil.toString(r))}lt(e,r){return this.setLimit("max",e,!1,errorUtil.toString(r))}setLimit(e,r,n,s){return new ZodBigInt({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:errorUtil.toString(s)}]})}_addCheck(e){return new ZodBigInt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:errorUtil.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:errorUtil.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}ZodBigInt.create=t=>new ZodBigInt({checks:[],typeName:ZodFirstPartyTypeKind.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...processCreateParams(t)});class ZodBoolean extends ZodType{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ZodParsedType.boolean){const n=this._getOrReturnCtx(e);return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.boolean,received:n.parsedType}),INVALID}return OK(e.data)}}ZodBoolean.create=t=>new ZodBoolean({typeName:ZodFirstPartyTypeKind.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...processCreateParams(t)});class ZodDate extends ZodType{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ZodParsedType.date){const a=this._getOrReturnCtx(e);return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.date,received:a.parsedType}),INVALID}if(Number.isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return addIssueToContext(a,{code:ZodIssueCode.invalid_date}),INVALID}const n=new ParseStatus;let s;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{code:ZodIssueCode.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),n.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(s=this._getOrReturnCtx(e,s),addIssueToContext(s,{code:ZodIssueCode.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),n.dirty()):util.assertNever(a);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ZodDate({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:errorUtil.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:errorUtil.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}ZodDate.create=t=>new ZodDate({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:ZodFirstPartyTypeKind.ZodDate,...processCreateParams(t)});class ZodSymbol extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.symbol){const n=this._getOrReturnCtx(e);return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.symbol,received:n.parsedType}),INVALID}return OK(e.data)}}ZodSymbol.create=t=>new ZodSymbol({typeName:ZodFirstPartyTypeKind.ZodSymbol,...processCreateParams(t)});class ZodUndefined extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.undefined){const n=this._getOrReturnCtx(e);return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.undefined,received:n.parsedType}),INVALID}return OK(e.data)}}ZodUndefined.create=t=>new ZodUndefined({typeName:ZodFirstPartyTypeKind.ZodUndefined,...processCreateParams(t)});class ZodNull extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.null){const n=this._getOrReturnCtx(e);return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.null,received:n.parsedType}),INVALID}return OK(e.data)}}ZodNull.create=t=>new ZodNull({typeName:ZodFirstPartyTypeKind.ZodNull,...processCreateParams(t)});class ZodAny extends ZodType{constructor(){super(...arguments),this._any=!0}_parse(e){return OK(e.data)}}ZodAny.create=t=>new ZodAny({typeName:ZodFirstPartyTypeKind.ZodAny,...processCreateParams(t)});class ZodUnknown extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse(e){return OK(e.data)}}ZodUnknown.create=t=>new ZodUnknown({typeName:ZodFirstPartyTypeKind.ZodUnknown,...processCreateParams(t)});class ZodNever extends ZodType{_parse(e){const r=this._getOrReturnCtx(e);return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.never,received:r.parsedType}),INVALID}}ZodNever.create=t=>new ZodNever({typeName:ZodFirstPartyTypeKind.ZodNever,...processCreateParams(t)});class ZodVoid extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.undefined){const n=this._getOrReturnCtx(e);return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.void,received:n.parsedType}),INVALID}return OK(e.data)}}ZodVoid.create=t=>new ZodVoid({typeName:ZodFirstPartyTypeKind.ZodVoid,...processCreateParams(t)});class ZodArray extends ZodType{_parse(e){const{ctx:r,status:n}=this._processInputParams(e),s=this._def;if(r.parsedType!==ZodParsedType.array)return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:r.parsedType}),INVALID;if(s.exactLength!==null){const o=r.data.length>s.exactLength.value,l=r.data.length<s.exactLength.value;(o||l)&&(addIssueToContext(r,{code:o?ZodIssueCode.too_big:ZodIssueCode.too_small,minimum:l?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(addIssueToContext(r,{code:ZodIssueCode.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(addIssueToContext(r,{code:ZodIssueCode.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((o,l)=>s.type._parseAsync(new ParseInputLazyPath(r,o,r.path,l)))).then(o=>ParseStatus.mergeArray(n,o));const a=[...r.data].map((o,l)=>s.type._parseSync(new ParseInputLazyPath(r,o,r.path,l)));return ParseStatus.mergeArray(n,a)}get element(){return this._def.type}min(e,r){return new ZodArray({...this._def,minLength:{value:e,message:errorUtil.toString(r)}})}max(e,r){return new ZodArray({...this._def,maxLength:{value:e,message:errorUtil.toString(r)}})}length(e,r){return new ZodArray({...this._def,exactLength:{value:e,message:errorUtil.toString(r)}})}nonempty(e){return this.min(1,e)}}ZodArray.create=(t,e)=>new ZodArray({type:t,minLength:null,maxLength:null,exactLength:null,typeName:ZodFirstPartyTypeKind.ZodArray,...processCreateParams(e)});function deepPartialify(t){if(t instanceof ZodObject){const e={};for(const r in t.shape){const n=t.shape[r];e[r]=ZodOptional.create(deepPartialify(n))}return new ZodObject({...t._def,shape:()=>e})}else return t instanceof ZodArray?new ZodArray({...t._def,type:deepPartialify(t.element)}):t instanceof ZodOptional?ZodOptional.create(deepPartialify(t.unwrap())):t instanceof ZodNullable?ZodNullable.create(deepPartialify(t.unwrap())):t instanceof ZodTuple?ZodTuple.create(t.items.map(e=>deepPartialify(e))):t}class ZodObject extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=util.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==ZodParsedType.object){const c=this._getOrReturnCtx(e);return addIssueToContext(c,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:c.parsedType}),INVALID}const{status:n,ctx:s}=this._processInputParams(e),{shape:a,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof ZodNever&&this._def.unknownKeys==="strip"))for(const c in s.data)o.includes(c)||l.push(c);const u=[];for(const c of o){const d=a[c],p=s.data[c];u.push({key:{status:"valid",value:c},value:d._parse(new ParseInputLazyPath(s,p,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof ZodNever){const c=this._def.unknownKeys;if(c==="passthrough")for(const d of l)u.push({key:{status:"valid",value:d},value:{status:"valid",value:s.data[d]}});else if(c==="strict")l.length>0&&(addIssueToContext(s,{code:ZodIssueCode.unrecognized_keys,keys:l}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const d of l){const p=s.data[d];u.push({key:{status:"valid",value:d},value:c._parse(new ParseInputLazyPath(s,p,s.path,d)),alwaysSet:d in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const d of u){const p=await d.key,m=await d.value;c.push({key:p,value:m,alwaysSet:d.alwaysSet})}return c}).then(c=>ParseStatus.mergeObjectSync(n,c)):ParseStatus.mergeObjectSync(n,u)}get shape(){return this._def.shape()}strict(e){return errorUtil.errToObj,new ZodObject({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{var a,o;const s=((o=(a=this._def).errorMap)==null?void 0:o.call(a,r,n).message)??n.defaultError;return r.code==="unrecognized_keys"?{message:errorUtil.errToObj(e).message??s}:{message:s}}}:{}})}strip(){return new ZodObject({...this._def,unknownKeys:"strip"})}passthrough(){return new ZodObject({...this._def,unknownKeys:"passthrough"})}extend(e){return new ZodObject({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ZodObject({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ZodFirstPartyTypeKind.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new ZodObject({...this._def,catchall:e})}pick(e){const r={};for(const n of util.objectKeys(e))e[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new ZodObject({...this._def,shape:()=>r})}omit(e){const r={};for(const n of util.objectKeys(this.shape))e[n]||(r[n]=this.shape[n]);return new ZodObject({...this._def,shape:()=>r})}deepPartial(){return deepPartialify(this)}partial(e){const r={};for(const n of util.objectKeys(this.shape)){const s=this.shape[n];e&&!e[n]?r[n]=s:r[n]=s.optional()}return new ZodObject({...this._def,shape:()=>r})}required(e){const r={};for(const n of util.objectKeys(this.shape))if(e&&!e[n])r[n]=this.shape[n];else{let a=this.shape[n];for(;a instanceof ZodOptional;)a=a._def.innerType;r[n]=a}return new ZodObject({...this._def,shape:()=>r})}keyof(){return createZodEnum(util.objectKeys(this.shape))}}ZodObject.create=(t,e)=>new ZodObject({shape:()=>t,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(e)});ZodObject.strictCreate=(t,e)=>new ZodObject({shape:()=>t,unknownKeys:"strict",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(e)});ZodObject.lazycreate=(t,e)=>new ZodObject({shape:t,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(e)});class ZodUnion extends ZodType{_parse(e){const{ctx:r}=this._processInputParams(e),n=this._def.options;function s(a){for(const l of a)if(l.result.status==="valid")return l.result;for(const l of a)if(l.result.status==="dirty")return r.common.issues.push(...l.ctx.common.issues),l.result;const o=a.map(l=>new ZodError(l.ctx.common.issues));return addIssueToContext(r,{code:ZodIssueCode.invalid_union,unionErrors:o}),INVALID}if(r.common.async)return Promise.all(n.map(async a=>{const o={...r,common:{...r.common,issues:[]},parent:null};return{result:await a._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(s);{let a;const o=[];for(const u of n){const c={...r,common:{...r.common,issues:[]},parent:null},d=u._parseSync({data:r.data,path:r.path,parent:c});if(d.status==="valid")return d;d.status==="dirty"&&!a&&(a={result:d,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(a)return r.common.issues.push(...a.ctx.common.issues),a.result;const l=o.map(u=>new ZodError(u));return addIssueToContext(r,{code:ZodIssueCode.invalid_union,unionErrors:l}),INVALID}}get options(){return this._def.options}}ZodUnion.create=(t,e)=>new ZodUnion({options:t,typeName:ZodFirstPartyTypeKind.ZodUnion,...processCreateParams(e)});function mergeValues(t,e){const r=getParsedType(t),n=getParsedType(e);if(t===e)return{valid:!0,data:t};if(r===ZodParsedType.object&&n===ZodParsedType.object){const s=util.objectKeys(e),a=util.objectKeys(t).filter(l=>s.indexOf(l)!==-1),o={...t,...e};for(const l of a){const u=mergeValues(t[l],e[l]);if(!u.valid)return{valid:!1};o[l]=u.data}return{valid:!0,data:o}}else if(r===ZodParsedType.array&&n===ZodParsedType.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let a=0;a<t.length;a++){const o=t[a],l=e[a],u=mergeValues(o,l);if(!u.valid)return{valid:!1};s.push(u.data)}return{valid:!0,data:s}}else return r===ZodParsedType.date&&n===ZodParsedType.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class ZodIntersection extends ZodType{_parse(e){const{status:r,ctx:n}=this._processInputParams(e),s=(a,o)=>{if(isAborted(a)||isAborted(o))return INVALID;const l=mergeValues(a.value,o.value);return l.valid?((isDirty(a)||isDirty(o))&&r.dirty(),{status:r.value,value:l.data}):(addIssueToContext(n,{code:ZodIssueCode.invalid_intersection_types}),INVALID)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([a,o])=>s(a,o)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}ZodIntersection.create=(t,e,r)=>new ZodIntersection({left:t,right:e,typeName:ZodFirstPartyTypeKind.ZodIntersection,...processCreateParams(r)});class ZodTuple extends ZodType{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ZodParsedType.array)return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:n.parsedType}),INVALID;if(n.data.length<this._def.items.length)return addIssueToContext(n,{code:ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),INVALID;!this._def.rest&&n.data.length>this._def.items.length&&(addIssueToContext(n,{code:ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const a=[...n.data].map((o,l)=>{const u=this._def.items[l]||this._def.rest;return u?u._parse(new ParseInputLazyPath(n,o,n.path,l)):null}).filter(o=>!!o);return n.common.async?Promise.all(a).then(o=>ParseStatus.mergeArray(r,o)):ParseStatus.mergeArray(r,a)}get items(){return this._def.items}rest(e){return new ZodTuple({...this._def,rest:e})}}ZodTuple.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:t,typeName:ZodFirstPartyTypeKind.ZodTuple,rest:null,...processCreateParams(e)})};class ZodMap extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ZodParsedType.map)return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.map,received:n.parsedType}),INVALID;const s=this._def.keyType,a=this._def.valueType,o=[...n.data.entries()].map(([l,u],c)=>({key:s._parse(new ParseInputLazyPath(n,l,n.path,[c,"key"])),value:a._parse(new ParseInputLazyPath(n,u,n.path,[c,"value"]))}));if(n.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const u of o){const c=await u.key,d=await u.value;if(c.status==="aborted"||d.status==="aborted")return INVALID;(c.status==="dirty"||d.status==="dirty")&&r.dirty(),l.set(c.value,d.value)}return{status:r.value,value:l}})}else{const l=new Map;for(const u of o){const c=u.key,d=u.value;if(c.status==="aborted"||d.status==="aborted")return INVALID;(c.status==="dirty"||d.status==="dirty")&&r.dirty(),l.set(c.value,d.value)}return{status:r.value,value:l}}}}ZodMap.create=(t,e,r)=>new ZodMap({valueType:e,keyType:t,typeName:ZodFirstPartyTypeKind.ZodMap,...processCreateParams(r)});class ZodSet extends ZodType{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ZodParsedType.set)return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.set,received:n.parsedType}),INVALID;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(addIssueToContext(n,{code:ZodIssueCode.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(addIssueToContext(n,{code:ZodIssueCode.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());const a=this._def.valueType;function o(u){const c=new Set;for(const d of u){if(d.status==="aborted")return INVALID;d.status==="dirty"&&r.dirty(),c.add(d.value)}return{status:r.value,value:c}}const l=[...n.data.values()].map((u,c)=>a._parse(new ParseInputLazyPath(n,u,n.path,c)));return n.common.async?Promise.all(l).then(u=>o(u)):o(l)}min(e,r){return new ZodSet({...this._def,minSize:{value:e,message:errorUtil.toString(r)}})}max(e,r){return new ZodSet({...this._def,maxSize:{value:e,message:errorUtil.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}ZodSet.create=(t,e)=>new ZodSet({valueType:t,minSize:null,maxSize:null,typeName:ZodFirstPartyTypeKind.ZodSet,...processCreateParams(e)});class ZodLazy extends ZodType{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}ZodLazy.create=(t,e)=>new ZodLazy({getter:t,typeName:ZodFirstPartyTypeKind.ZodLazy,...processCreateParams(e)});class ZodLiteral extends ZodType{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return addIssueToContext(r,{received:r.data,code:ZodIssueCode.invalid_literal,expected:this._def.value}),INVALID}return{status:"valid",value:e.data}}get value(){return this._def.value}}ZodLiteral.create=(t,e)=>new ZodLiteral({value:t,typeName:ZodFirstPartyTypeKind.ZodLiteral,...processCreateParams(e)});function createZodEnum(t,e){return new ZodEnum({values:t,typeName:ZodFirstPartyTypeKind.ZodEnum,...processCreateParams(e)})}class ZodEnum extends ZodType{constructor(){super(...arguments),_ZodEnum_cache.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),n=this._def.values;return addIssueToContext(r,{expected:util.joinValues(n),received:r.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet$7(this,_ZodEnum_cache,"f")||__classPrivateFieldSet$6(this,_ZodEnum_cache,new Set(this._def.values),"f"),!__classPrivateFieldGet$7(this,_ZodEnum_cache,"f").has(e.data)){const r=this._getOrReturnCtx(e),n=this._def.values;return addIssueToContext(r,{received:r.data,code:ZodIssueCode.invalid_enum_value,options:n}),INVALID}return OK(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return ZodEnum.create(e,{...this._def,...r})}exclude(e,r=this._def){return ZodEnum.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}}_ZodEnum_cache=new WeakMap;ZodEnum.create=createZodEnum;class ZodNativeEnum extends ZodType{constructor(){super(...arguments),_ZodNativeEnum_cache.set(this,void 0)}_parse(e){const r=util.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==ZodParsedType.string&&n.parsedType!==ZodParsedType.number){const s=util.objectValues(r);return addIssueToContext(n,{expected:util.joinValues(s),received:n.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet$7(this,_ZodNativeEnum_cache,"f")||__classPrivateFieldSet$6(this,_ZodNativeEnum_cache,new Set(util.getValidEnumValues(this._def.values)),"f"),!__classPrivateFieldGet$7(this,_ZodNativeEnum_cache,"f").has(e.data)){const s=util.objectValues(r);return addIssueToContext(n,{received:n.data,code:ZodIssueCode.invalid_enum_value,options:s}),INVALID}return OK(e.data)}get enum(){return this._def.values}}_ZodNativeEnum_cache=new WeakMap;ZodNativeEnum.create=(t,e)=>new ZodNativeEnum({values:t,typeName:ZodFirstPartyTypeKind.ZodNativeEnum,...processCreateParams(e)});class ZodPromise extends ZodType{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==ZodParsedType.promise&&r.common.async===!1)return addIssueToContext(r,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.promise,received:r.parsedType}),INVALID;const n=r.parsedType===ZodParsedType.promise?r.data:Promise.resolve(r.data);return OK(n.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}}ZodPromise.create=(t,e)=>new ZodPromise({type:t,typeName:ZodFirstPartyTypeKind.ZodPromise,...processCreateParams(e)});class ZodEffects extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ZodFirstPartyTypeKind.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:n}=this._processInputParams(e),s=this._def.effect||null,a={addIssue:o=>{addIssueToContext(n,o),o.fatal?r.abort():r.dirty()},get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),s.type==="preprocess"){const o=s.transform(n.data,a);if(n.common.async)return Promise.resolve(o).then(async l=>{if(r.value==="aborted")return INVALID;const u=await this._def.schema._parseAsync({data:l,path:n.path,parent:n});return u.status==="aborted"?INVALID:u.status==="dirty"||r.value==="dirty"?DIRTY(u.value):u});{if(r.value==="aborted")return INVALID;const l=this._def.schema._parseSync({data:o,path:n.path,parent:n});return l.status==="aborted"?INVALID:l.status==="dirty"||r.value==="dirty"?DIRTY(l.value):l}}if(s.type==="refinement"){const o=l=>{const u=s.refinement(l,a);if(n.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return l.status==="aborted"?INVALID:(l.status==="dirty"&&r.dirty(),o(l.value),{status:r.value,value:l.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>l.status==="aborted"?INVALID:(l.status==="dirty"&&r.dirty(),o(l.value).then(()=>({status:r.value,value:l.value}))))}if(s.type==="transform")if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!isValid(o))return o;const l=s.transform(o.value,a);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:l}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>isValid(o)?Promise.resolve(s.transform(o.value,a)).then(l=>({status:r.value,value:l})):o);util.assertNever(s)}}ZodEffects.create=(t,e,r)=>new ZodEffects({schema:t,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:e,...processCreateParams(r)});ZodEffects.createWithPreprocess=(t,e,r)=>new ZodEffects({schema:e,effect:{type:"preprocess",transform:t},typeName:ZodFirstPartyTypeKind.ZodEffects,...processCreateParams(r)});class ZodOptional extends ZodType{_parse(e){return this._getType(e)===ZodParsedType.undefined?OK(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ZodOptional.create=(t,e)=>new ZodOptional({innerType:t,typeName:ZodFirstPartyTypeKind.ZodOptional,...processCreateParams(e)});class ZodNullable extends ZodType{_parse(e){return this._getType(e)===ZodParsedType.null?OK(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ZodNullable.create=(t,e)=>new ZodNullable({innerType:t,typeName:ZodFirstPartyTypeKind.ZodNullable,...processCreateParams(e)});class ZodDefault extends ZodType{_parse(e){const{ctx:r}=this._processInputParams(e);let n=r.data;return r.parsedType===ZodParsedType.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}ZodDefault.create=(t,e)=>new ZodDefault({innerType:t,typeName:ZodFirstPartyTypeKind.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...processCreateParams(e)});class ZodCatch extends ZodType{_parse(e){const{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return isAsync(s)?s.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new ZodError(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ZodError(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}ZodCatch.create=(t,e)=>new ZodCatch({innerType:t,typeName:ZodFirstPartyTypeKind.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...processCreateParams(e)});class ZodNaN extends ZodType{_parse(e){if(this._getType(e)!==ZodParsedType.nan){const n=this._getOrReturnCtx(e);return addIssueToContext(n,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.nan,received:n.parsedType}),INVALID}return{status:"valid",value:e.data}}}ZodNaN.create=t=>new ZodNaN({typeName:ZodFirstPartyTypeKind.ZodNaN,...processCreateParams(t)});class ZodBranded extends ZodType{_parse(e){const{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class ZodPipeline extends ZodType{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?INVALID:a.status==="dirty"?(r.dirty(),DIRTY(a.value)):this._def.out._parseAsync({data:a.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?INVALID:s.status==="dirty"?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,r){return new ZodPipeline({in:e,out:r,typeName:ZodFirstPartyTypeKind.ZodPipeline})}}class ZodReadonly extends ZodType{_parse(e){const r=this._def.innerType._parse(e),n=s=>(isValid(s)&&(s.value=Object.freeze(s.value)),s);return isAsync(r)?r.then(s=>n(s)):n(r)}unwrap(){return this._def.innerType}}ZodReadonly.create=(t,e)=>new ZodReadonly({innerType:t,typeName:ZodFirstPartyTypeKind.ZodReadonly,...processCreateParams(e)});var ZodFirstPartyTypeKind;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(ZodFirstPartyTypeKind||(ZodFirstPartyTypeKind={}));const stringType=ZodString.create,anyType=ZodAny.create;ZodNever.create;ZodArray.create;const objectType=ZodObject.create;ZodUnion.create;ZodIntersection.create;ZodTuple.create;ZodEnum.create;ZodPromise.create;ZodOptional.create;ZodNullable.create;var pRetry$1={exports:{}},retry$1={},retry_operation,hasRequiredRetry_operation;function requireRetry_operation(){if(hasRequiredRetry_operation)return retry_operation;hasRequiredRetry_operation=1;function t(e,r){typeof r=="boolean"&&(r={forever:r}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=r||{},this._maxRetryTime=r&&r.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}return retry_operation=t,t.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},t.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},t.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var r=new Date().getTime();if(e&&r-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var n=this._timeouts.shift();if(n===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1);else return!1;var s=this;return this._timer=setTimeout(function(){s._attempts++,s._operationTimeoutCb&&(s._timeout=setTimeout(function(){s._operationTimeoutCb(s._attempts)},s._operationTimeout),s._options.unref&&s._timeout.unref()),s._fn(s._attempts)},n),this._options.unref&&this._timer.unref(),!0},t.prototype.attempt=function(e,r){this._fn=e,r&&(r.timeout&&(this._operationTimeout=r.timeout),r.cb&&(this._operationTimeoutCb=r.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){n._operationTimeoutCb()},n._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},t.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},t.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},t.prototype.start=t.prototype.try,t.prototype.errors=function(){return this._errors},t.prototype.attempts=function(){return this._attempts},t.prototype.mainError=function(){if(this._errors.length===0)return null;for(var e={},r=null,n=0,s=0;s<this._errors.length;s++){var a=this._errors[s],o=a.message,l=(e[o]||0)+1;e[o]=l,l>=n&&(r=a,n=l)}return r},retry_operation}var hasRequiredRetry$1;function requireRetry$1(){return hasRequiredRetry$1||(hasRequiredRetry$1=1,function(t){var e=requireRetry_operation();t.operation=function(r){var n=t.timeouts(r);return new e(n,{forever:r&&(r.forever||r.retries===1/0),unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})},t.timeouts=function(r){if(r instanceof Array)return[].concat(r);var n={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var s in r)n[s]=r[s];if(n.minTimeout>n.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var a=[],o=0;o<n.retries;o++)a.push(this.createTimeout(o,n));return r&&r.forever&&!a.length&&a.push(this.createTimeout(o,n)),a.sort(function(l,u){return l-u}),a},t.createTimeout=function(r,n){var s=n.randomize?Math.random()+1:1,a=Math.round(s*Math.max(n.minTimeout,1)*Math.pow(n.factor,r));return a=Math.min(a,n.maxTimeout),a},t.wrap=function(r,n,s){if(n instanceof Array&&(s=n,n=null),!s){s=[];for(var a in r)typeof r[a]=="function"&&s.push(a)}for(var o=0;o<s.length;o++){var l=s[o],u=r[l];r[l]=(function(d){var p=t.operation(n),m=Array.prototype.slice.call(arguments,1),y=m.pop();m.push(function(b){p.retry(b)||(b&&(arguments[0]=p.mainError()),y.apply(this,arguments))}),p.attempt(function(){d.apply(r,m)})}).bind(r,u),r[l].options=n}}}(retry$1)),retry$1}var retry,hasRequiredRetry;function requireRetry(){return hasRequiredRetry||(hasRequiredRetry=1,retry=requireRetry$1()),retry}var hasRequiredPRetry;function requirePRetry(){if(hasRequiredPRetry)return pRetry$1.exports;hasRequiredPRetry=1;const t=requireRetry(),e=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class r extends Error{constructor(l){super(),l instanceof Error?(this.originalError=l,{message:l}=l):(this.originalError=new Error(l),this.originalError.stack=this.stack),this.name="AbortError",this.message=l}}const n=(o,l,u)=>{const c=u.retries-(l-1);return o.attemptNumber=l,o.retriesLeft=c,o},s=o=>e.includes(o),a=(o,l)=>new Promise((u,c)=>{l={onFailedAttempt:()=>{},retries:10,...l};const d=t.operation(l);d.attempt(async p=>{try{u(await o(p))}catch(m){if(!(m instanceof Error)){c(new TypeError(`Non-error was thrown: "${m}". You should only throw errors.`));return}if(m instanceof r)d.stop(),c(m.originalError);else if(m instanceof TypeError&&!s(m.message))d.stop(),c(m);else{n(m,p,l);try{await l.onFailedAttempt(m)}catch(y){c(y);return}d.retry(m)||c(d.mainError())}}})});return pRetry$1.exports=a,pRetry$1.exports.default=a,pRetry$1.exports.AbortError=r,pRetry$1.exports}var pRetryExports=requirePRetry();const pRetry=getDefaultExportFromCjs(pRetryExports),REGEX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function validate$1(t){return typeof t=="string"&&REGEX.test(t)}var byteToHex=[];for(var i=0;i<256;++i)byteToHex.push((i+256).toString(16).slice(1));function unsafeStringify(t,e=0){return(byteToHex[t[e+0]]+byteToHex[t[e+1]]+byteToHex[t[e+2]]+byteToHex[t[e+3]]+"-"+byteToHex[t[e+4]]+byteToHex[t[e+5]]+"-"+byteToHex[t[e+6]]+byteToHex[t[e+7]]+"-"+byteToHex[t[e+8]]+byteToHex[t[e+9]]+"-"+byteToHex[t[e+10]]+byteToHex[t[e+11]]+byteToHex[t[e+12]]+byteToHex[t[e+13]]+byteToHex[t[e+14]]+byteToHex[t[e+15]]).toLowerCase()}var getRandomValues,rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}var randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const native={randomUUID};function v4(t,e,r){if(native.randomUUID&&!t)return native.randomUUID();t=t||{};var n=t.random||(t.rng||rng)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,unsafeStringify(n)}var dist={},eventemitter3={exports:{}},hasRequiredEventemitter3;function requireEventemitter3(){return hasRequiredEventemitter3||(hasRequiredEventemitter3=1,function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function s(u,c,d){this.fn=u,this.context=c,this.once=d||!1}function a(u,c,d,p,m){if(typeof d!="function")throw new TypeError("The listener must be a function");var y=new s(d,p||u,m),b=r?r+c:c;return u._events[b]?u._events[b].fn?u._events[b]=[u._events[b],y]:u._events[b].push(y):(u._events[b]=y,u._eventsCount++),u}function o(u,c){--u._eventsCount===0?u._events=new n:delete u._events[c]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var c=[],d,p;if(this._eventsCount===0)return c;for(p in d=this._events)e.call(d,p)&&c.push(r?p.slice(1):p);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(d)):c},l.prototype.listeners=function(c){var d=r?r+c:c,p=this._events[d];if(!p)return[];if(p.fn)return[p.fn];for(var m=0,y=p.length,b=new Array(y);m<y;m++)b[m]=p[m].fn;return b},l.prototype.listenerCount=function(c){var d=r?r+c:c,p=this._events[d];return p?p.fn?1:p.length:0},l.prototype.emit=function(c,d,p,m,y,b){var E=r?r+c:c;if(!this._events[E])return!1;var T=this._events[E],S=arguments.length,P,A;if(T.fn){switch(T.once&&this.removeListener(c,T.fn,void 0,!0),S){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,d),!0;case 3:return T.fn.call(T.context,d,p),!0;case 4:return T.fn.call(T.context,d,p,m),!0;case 5:return T.fn.call(T.context,d,p,m,y),!0;case 6:return T.fn.call(T.context,d,p,m,y,b),!0}for(A=1,P=new Array(S-1);A<S;A++)P[A-1]=arguments[A];T.fn.apply(T.context,P)}else{var I=T.length,j;for(A=0;A<I;A++)switch(T[A].once&&this.removeListener(c,T[A].fn,void 0,!0),S){case 1:T[A].fn.call(T[A].context);break;case 2:T[A].fn.call(T[A].context,d);break;case 3:T[A].fn.call(T[A].context,d,p);break;case 4:T[A].fn.call(T[A].context,d,p,m);break;default:if(!P)for(j=1,P=new Array(S-1);j<S;j++)P[j-1]=arguments[j];T[A].fn.apply(T[A].context,P)}}return!0},l.prototype.on=function(c,d,p){return a(this,c,d,p,!1)},l.prototype.once=function(c,d,p){return a(this,c,d,p,!0)},l.prototype.removeListener=function(c,d,p,m){var y=r?r+c:c;if(!this._events[y])return this;if(!d)return o(this,y),this;var b=this._events[y];if(b.fn)b.fn===d&&(!m||b.once)&&(!p||b.context===p)&&o(this,y);else{for(var E=0,T=[],S=b.length;E<S;E++)(b[E].fn!==d||m&&!b[E].once||p&&b[E].context!==p)&&T.push(b[E]);T.length?this._events[y]=T.length===1?T[0]:T:o(this,y)}return this},l.prototype.removeAllListeners=function(c){var d;return c?(d=r?r+c:c,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,t.exports=l}(eventemitter3)),eventemitter3.exports}var pTimeout={exports:{}},pFinally,hasRequiredPFinally;function requirePFinally(){return hasRequiredPFinally||(hasRequiredPFinally=1,pFinally=(t,e)=>(e=e||(()=>{}),t.then(r=>new Promise(n=>{n(e())}).then(()=>r),r=>new Promise(n=>{n(e())}).then(()=>{throw r})))),pFinally}var hasRequiredPTimeout;function requirePTimeout(){if(hasRequiredPTimeout)return pTimeout.exports;hasRequiredPTimeout=1;const t=requirePFinally();class e extends Error{constructor(s){super(s),this.name="TimeoutError"}}const r=(n,s,a)=>new Promise((o,l)=>{if(typeof s!="number"||s<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(s===1/0){o(n);return}const u=setTimeout(()=>{if(typeof a=="function"){try{o(a())}catch(p){l(p)}return}const c=typeof a=="string"?a:`Promise timed out after ${s} milliseconds`,d=a instanceof Error?a:new e(c);typeof n.cancel=="function"&&n.cancel(),l(d)},s);t(n.then(o,l),()=>{clearTimeout(u)})});return pTimeout.exports=r,pTimeout.exports.default=r,pTimeout.exports.TimeoutError=e,pTimeout.exports}var priorityQueue={},lowerBound={},hasRequiredLowerBound;function requireLowerBound(){if(hasRequiredLowerBound)return lowerBound;hasRequiredLowerBound=1,Object.defineProperty(lowerBound,"__esModule",{value:!0});function t(e,r,n){let s=0,a=e.length;for(;a>0;){const o=a/2|0;let l=s+o;n(e[l],r)<=0?(s=++l,a-=o+1):a=o}return s}return lowerBound.default=t,lowerBound}var hasRequiredPriorityQueue;function requirePriorityQueue(){if(hasRequiredPriorityQueue)return priorityQueue;hasRequiredPriorityQueue=1,Object.defineProperty(priorityQueue,"__esModule",{value:!0});const t=requireLowerBound();class e{constructor(){this._queue=[]}enqueue(n,s){s=Object.assign({priority:0},s);const a={priority:s.priority,run:n};if(this.size&&this._queue[this.size-1].priority>=s.priority){this._queue.push(a);return}const o=t.default(this._queue,a,(l,u)=>u.priority-l.priority);this._queue.splice(o,0,a)}dequeue(){const n=this._queue.shift();return n==null?void 0:n.run}filter(n){return this._queue.filter(s=>s.priority===n.priority).map(s=>s.run)}get size(){return this._queue.length}}return priorityQueue.default=e,priorityQueue}var hasRequiredDist;function requireDist(){if(hasRequiredDist)return dist;hasRequiredDist=1,Object.defineProperty(dist,"__esModule",{value:!0});const t=requireEventemitter3(),e=requirePTimeout(),r=requirePriorityQueue(),n=()=>{},s=new e.TimeoutError;class a extends t{constructor(l){var u,c,d,p;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=n,this._resolveIdle=n,l=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:r.default},l),!(typeof l.intervalCap=="number"&&l.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(c=(u=l.intervalCap)===null||u===void 0?void 0:u.toString())!==null&&c!==void 0?c:""}\` (${typeof l.intervalCap})`);if(l.interval===void 0||!(Number.isFinite(l.interval)&&l.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(p=(d=l.interval)===null||d===void 0?void 0:d.toString())!==null&&p!==void 0?p:""}\` (${typeof l.interval})`);this._carryoverConcurrencyCount=l.carryoverConcurrencyCount,this._isIntervalIgnored=l.intervalCap===1/0||l.interval===0,this._intervalCap=l.intervalCap,this._interval=l.interval,this._queue=new l.queueClass,this._queueClass=l.queueClass,this.concurrency=l.concurrency,this._timeout=l.timeout,this._throwOnTimeout=l.throwOnTimeout===!0,this._isPaused=l.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=n,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=n,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const l=Date.now();if(this._intervalId===void 0){const u=this._intervalEnd-l;if(u<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},u)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const l=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const u=this._queue.dequeue();return u?(this.emit("active"),u(),l&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(l){if(!(typeof l=="number"&&l>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${l}\` (${typeof l})`);this._concurrency=l,this._processQueue()}async add(l,u={}){return new Promise((c,d)=>{const p=async()=>{this._pendingCount++,this._intervalCount++;try{const m=this._timeout===void 0&&u.timeout===void 0?l():e.default(Promise.resolve(l()),u.timeout===void 0?this._timeout:u.timeout,()=>{(u.throwOnTimeout===void 0?this._throwOnTimeout:u.throwOnTimeout)&&d(s)});c(await m)}catch(m){d(m)}this._next()};this._queue.enqueue(p,u),this._tryToStartAnother(),this.emit("add")})}async addAll(l,u){return Promise.all(l.map(async c=>this.add(c,u)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(l=>{const u=this._resolveEmpty;this._resolveEmpty=()=>{u(),l()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(l=>{const u=this._resolveIdle;this._resolveIdle=()=>{u(),l()}})}get size(){return this._queue.size}sizeBy(l){return this._queue.filter(l).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(l){this._timeout=l}}return dist.default=a,dist}var distExports=requireDist();const PQueueMod=getDefaultExportFromCjs(distExports),DEFAULT_FETCH_IMPLEMENTATION=(...t)=>fetch(...t),LANGSMITH_FETCH_IMPLEMENTATION_KEY=Symbol.for("ls:fetch_implementation"),_globalFetchImplementationIsNodeFetch=()=>{const t=globalThis[LANGSMITH_FETCH_IMPLEMENTATION_KEY];return t?typeof t=="function"&&"Headers"in t&&"Request"in t&&"Response"in t:!1},_getFetchImplementation=t=>async(...e)=>{if(t||getLangSmithEnvironmentVariable("DEBUG")==="true"){const[n,s]=e;console.log(`→ ${(s==null?void 0:s.method)||"GET"} ${n}`)}const r=await(globalThis[LANGSMITH_FETCH_IMPLEMENTATION_KEY]??DEFAULT_FETCH_IMPLEMENTATION)(...e);return(t||getLangSmithEnvironmentVariable("DEBUG")==="true")&&console.log(`← ${r.status} ${r.statusText} ${r.url}`),r},STATUS_NO_RETRY$1=[400,401,403,404,405,406,407,408],STATUS_IGNORE=[409];let AsyncCaller$1=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.debug=e.debug,"default"in PQueueMod?this.queue=new PQueueMod.default({concurrency:this.maxConcurrency}):this.queue=new PQueueMod({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e==null?void 0:e.onFailedResponseHook}call(e,...r){const n=this.onFailedResponseHook;return this.queue.add(()=>pRetry(()=>e(...r).catch(s=>{throw s instanceof Error?s:new Error(s)}),{async onFailedAttempt(s){if(s.message.startsWith("Cancel")||s.message.startsWith("TimeoutError")||s.message.startsWith("AbortError")||(s==null?void 0:s.code)==="ECONNABORTED")throw s;const a=s==null?void 0:s.response,o=a==null?void 0:a.status;if(o){if(STATUS_NO_RETRY$1.includes(+o))throw s;if(STATUS_IGNORE.includes(+o))return;n&&await n(a)}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,r,...n){return e.signal?Promise.race([this.call(r,...n),new Promise((s,a)=>{var o;(o=e.signal)==null||o.addEventListener("abort",()=>{a(new Error("AbortError"))})})]):this.call(r,...n)}fetch(...e){return this.call(()=>_getFetchImplementation(this.debug)(...e).then(r=>r.ok?r:Promise.reject(r)))}};function isLangChainMessage(t){return typeof(t==null?void 0:t._getType)=="function"}function convertLangChainMessageToExample(t){const e={type:t._getType(),data:{content:t.content}};return t!=null&&t.additional_kwargs&&Object.keys(t.additional_kwargs).length>0&&(e.data.additional_kwargs={...t.additional_kwargs}),e}function assertUuid(t,e){if(!validate$1(t)){const r=e!==void 0?`Invalid UUID for ${e}: ${t}`:`Invalid UUID: ${t}`;throw new Error(r)}return t}const warnedMessages={};function warnOnce(t){warnedMessages[t]||(console.warn(t),warnedMessages[t]=!0)}var re={exports:{}},constants,hasRequiredConstants;function requireConstants(){if(hasRequiredConstants)return constants;hasRequiredConstants=1;const t="2.0.0",e=256,r=Number.MAX_SAFE_INTEGER||9007199254740991,n=16,s=e-6;return constants={MAX_LENGTH:e,MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:s,MAX_SAFE_INTEGER:r,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:t,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},constants}var debug_1,hasRequiredDebug;function requireDebug(){if(hasRequiredDebug)return debug_1;hasRequiredDebug=1;var t={};return debug_1=typeof process=="object"&&t&&t.NODE_DEBUG&&/\bsemver\b/i.test(t.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{},debug_1}var hasRequiredRe;function requireRe(){return hasRequiredRe||(hasRequiredRe=1,function(t,e){const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:s}=requireConstants(),a=requireDebug();e=t.exports={};const o=e.re=[],l=e.safeRe=[],u=e.src=[],c=e.safeSrc=[],d=e.t={};let p=0;const m="[a-zA-Z0-9-]",y=[["\\s",1],["\\d",s],[m,n]],b=T=>{for(const[S,P]of y)T=T.split(`${S}*`).join(`${S}{0,${P}}`).split(`${S}+`).join(`${S}{1,${P}}`);return T},E=(T,S,P)=>{const A=b(S),I=p++;a(T,I,S),d[T]=I,u[I]=S,c[I]=A,o[I]=new RegExp(S,P?"g":void 0),l[I]=new RegExp(A,P?"g":void 0)};E("NUMERICIDENTIFIER","0|[1-9]\\d*"),E("NUMERICIDENTIFIERLOOSE","\\d+"),E("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${m}*`),E("MAINVERSION",`(${u[d.NUMERICIDENTIFIER]})\\.(${u[d.NUMERICIDENTIFIER]})\\.(${u[d.NUMERICIDENTIFIER]})`),E("MAINVERSIONLOOSE",`(${u[d.NUMERICIDENTIFIERLOOSE]})\\.(${u[d.NUMERICIDENTIFIERLOOSE]})\\.(${u[d.NUMERICIDENTIFIERLOOSE]})`),E("PRERELEASEIDENTIFIER",`(?:${u[d.NONNUMERICIDENTIFIER]}|${u[d.NUMERICIDENTIFIER]})`),E("PRERELEASEIDENTIFIERLOOSE",`(?:${u[d.NONNUMERICIDENTIFIER]}|${u[d.NUMERICIDENTIFIERLOOSE]})`),E("PRERELEASE",`(?:-(${u[d.PRERELEASEIDENTIFIER]}(?:\\.${u[d.PRERELEASEIDENTIFIER]})*))`),E("PRERELEASELOOSE",`(?:-?(${u[d.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[d.PRERELEASEIDENTIFIERLOOSE]})*))`),E("BUILDIDENTIFIER",`${m}+`),E("BUILD",`(?:\\+(${u[d.BUILDIDENTIFIER]}(?:\\.${u[d.BUILDIDENTIFIER]})*))`),E("FULLPLAIN",`v?${u[d.MAINVERSION]}${u[d.PRERELEASE]}?${u[d.BUILD]}?`),E("FULL",`^${u[d.FULLPLAIN]}$`),E("LOOSEPLAIN",`[v=\\s]*${u[d.MAINVERSIONLOOSE]}${u[d.PRERELEASELOOSE]}?${u[d.BUILD]}?`),E("LOOSE",`^${u[d.LOOSEPLAIN]}$`),E("GTLT","((?:<|>)?=?)"),E("XRANGEIDENTIFIERLOOSE",`${u[d.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),E("XRANGEIDENTIFIER",`${u[d.NUMERICIDENTIFIER]}|x|X|\\*`),E("XRANGEPLAIN",`[v=\\s]*(${u[d.XRANGEIDENTIFIER]})(?:\\.(${u[d.XRANGEIDENTIFIER]})(?:\\.(${u[d.XRANGEIDENTIFIER]})(?:${u[d.PRERELEASE]})?${u[d.BUILD]}?)?)?`),E("XRANGEPLAINLOOSE",`[v=\\s]*(${u[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[d.XRANGEIDENTIFIERLOOSE]})(?:${u[d.PRERELEASELOOSE]})?${u[d.BUILD]}?)?)?`),E("XRANGE",`^${u[d.GTLT]}\\s*${u[d.XRANGEPLAIN]}$`),E("XRANGELOOSE",`^${u[d.GTLT]}\\s*${u[d.XRANGEPLAINLOOSE]}$`),E("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),E("COERCE",`${u[d.COERCEPLAIN]}(?:$|[^\\d])`),E("COERCEFULL",u[d.COERCEPLAIN]+`(?:${u[d.PRERELEASE]})?(?:${u[d.BUILD]})?(?:$|[^\\d])`),E("COERCERTL",u[d.COERCE],!0),E("COERCERTLFULL",u[d.COERCEFULL],!0),E("LONETILDE","(?:~>?)"),E("TILDETRIM",`(\\s*)${u[d.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",E("TILDE",`^${u[d.LONETILDE]}${u[d.XRANGEPLAIN]}$`),E("TILDELOOSE",`^${u[d.LONETILDE]}${u[d.XRANGEPLAINLOOSE]}$`),E("LONECARET","(?:\\^)"),E("CARETTRIM",`(\\s*)${u[d.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",E("CARET",`^${u[d.LONECARET]}${u[d.XRANGEPLAIN]}$`),E("CARETLOOSE",`^${u[d.LONECARET]}${u[d.XRANGEPLAINLOOSE]}$`),E("COMPARATORLOOSE",`^${u[d.GTLT]}\\s*(${u[d.LOOSEPLAIN]})$|^$`),E("COMPARATOR",`^${u[d.GTLT]}\\s*(${u[d.FULLPLAIN]})$|^$`),E("COMPARATORTRIM",`(\\s*)${u[d.GTLT]}\\s*(${u[d.LOOSEPLAIN]}|${u[d.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",E("HYPHENRANGE",`^\\s*(${u[d.XRANGEPLAIN]})\\s+-\\s+(${u[d.XRANGEPLAIN]})\\s*$`),E("HYPHENRANGELOOSE",`^\\s*(${u[d.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[d.XRANGEPLAINLOOSE]})\\s*$`),E("STAR","(<|>)?=?\\s*\\*"),E("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),E("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(re,re.exports)),re.exports}var parseOptions_1,hasRequiredParseOptions;function requireParseOptions(){if(hasRequiredParseOptions)return parseOptions_1;hasRequiredParseOptions=1;const t=Object.freeze({loose:!0}),e=Object.freeze({});return parseOptions_1=n=>n?typeof n!="object"?t:n:e,parseOptions_1}var identifiers,hasRequiredIdentifiers;function requireIdentifiers(){if(hasRequiredIdentifiers)return identifiers;hasRequiredIdentifiers=1;const t=/^[0-9]+$/,e=(n,s)=>{const a=t.test(n),o=t.test(s);return a&&o&&(n=+n,s=+s),n===s?0:a&&!o?-1:o&&!a?1:n<s?-1:1};return identifiers={compareIdentifiers:e,rcompareIdentifiers:(n,s)=>e(s,n)},identifiers}var semver$1,hasRequiredSemver$1;function requireSemver$1(){if(hasRequiredSemver$1)return semver$1;hasRequiredSemver$1=1;const t=requireDebug(),{MAX_LENGTH:e,MAX_SAFE_INTEGER:r}=requireConstants(),{safeRe:n,t:s}=requireRe(),a=requireParseOptions(),{compareIdentifiers:o}=requireIdentifiers();class l{constructor(c,d){if(d=a(d),c instanceof l){if(c.loose===!!d.loose&&c.includePrerelease===!!d.includePrerelease)return c;c=c.version}else if(typeof c!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof c}".`);if(c.length>e)throw new TypeError(`version is longer than ${e} characters`);t("SemVer",c,d),this.options=d,this.loose=!!d.loose,this.includePrerelease=!!d.includePrerelease;const p=c.trim().match(d.loose?n[s.LOOSE]:n[s.FULL]);if(!p)throw new TypeError(`Invalid Version: ${c}`);if(this.raw=c,this.major=+p[1],this.minor=+p[2],this.patch=+p[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");p[4]?this.prerelease=p[4].split(".").map(m=>{if(/^[0-9]+$/.test(m)){const y=+m;if(y>=0&&y<r)return y}return m}):this.prerelease=[],this.build=p[5]?p[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(c){if(t("SemVer.compare",this.version,this.options,c),!(c instanceof l)){if(typeof c=="string"&&c===this.version)return 0;c=new l(c,this.options)}return c.version===this.version?0:this.compareMain(c)||this.comparePre(c)}compareMain(c){return c instanceof l||(c=new l(c,this.options)),o(this.major,c.major)||o(this.minor,c.minor)||o(this.patch,c.patch)}comparePre(c){if(c instanceof l||(c=new l(c,this.options)),this.prerelease.length&&!c.prerelease.length)return-1;if(!this.prerelease.length&&c.prerelease.length)return 1;if(!this.prerelease.length&&!c.prerelease.length)return 0;let d=0;do{const p=this.prerelease[d],m=c.prerelease[d];if(t("prerelease compare",d,p,m),p===void 0&&m===void 0)return 0;if(m===void 0)return 1;if(p===void 0)return-1;if(p===m)continue;return o(p,m)}while(++d)}compareBuild(c){c instanceof l||(c=new l(c,this.options));let d=0;do{const p=this.build[d],m=c.build[d];if(t("build compare",d,p,m),p===void 0&&m===void 0)return 0;if(m===void 0)return 1;if(p===void 0)return-1;if(p===m)continue;return o(p,m)}while(++d)}inc(c,d,p){if(c.startsWith("pre")){if(!d&&p===!1)throw new Error("invalid increment argument: identifier is empty");if(d){const m=`-${d}`.match(this.options.loose?n[s.PRERELEASELOOSE]:n[s.PRERELEASE]);if(!m||m[1]!==d)throw new Error(`invalid identifier: ${d}`)}}switch(c){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",d,p);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",d,p);break;case"prepatch":this.prerelease.length=0,this.inc("patch",d,p),this.inc("pre",d,p);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",d,p),this.inc("pre",d,p);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const m=Number(p)?1:0;if(this.prerelease.length===0)this.prerelease=[m];else{let y=this.prerelease.length;for(;--y>=0;)typeof this.prerelease[y]=="number"&&(this.prerelease[y]++,y=-2);if(y===-1){if(d===this.prerelease.join(".")&&p===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(m)}}if(d){let y=[d,m];p===!1&&(y=[d]),o(this.prerelease[0],d)===0?isNaN(this.prerelease[1])&&(this.prerelease=y):this.prerelease=y}break}default:throw new Error(`invalid increment argument: ${c}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return semver$1=l,semver$1}var parse_1,hasRequiredParse;function requireParse(){if(hasRequiredParse)return parse_1;hasRequiredParse=1;const t=requireSemver$1();return parse_1=(r,n,s=!1)=>{if(r instanceof t)return r;try{return new t(r,n)}catch(a){if(!s)return null;throw a}},parse_1}var valid_1,hasRequiredValid$1;function requireValid$1(){if(hasRequiredValid$1)return valid_1;hasRequiredValid$1=1;const t=requireParse();return valid_1=(r,n)=>{const s=t(r,n);return s?s.version:null},valid_1}var clean_1,hasRequiredClean;function requireClean(){if(hasRequiredClean)return clean_1;hasRequiredClean=1;const t=requireParse();return clean_1=(r,n)=>{const s=t(r.trim().replace(/^[=v]+/,""),n);return s?s.version:null},clean_1}var inc_1,hasRequiredInc;function requireInc(){if(hasRequiredInc)return inc_1;hasRequiredInc=1;const t=requireSemver$1();return inc_1=(r,n,s,a,o)=>{typeof s=="string"&&(o=a,a=s,s=void 0);try{return new t(r instanceof t?r.version:r,s).inc(n,a,o).version}catch{return null}},inc_1}var diff_1,hasRequiredDiff;function requireDiff(){if(hasRequiredDiff)return diff_1;hasRequiredDiff=1;const t=requireParse();return diff_1=(r,n)=>{const s=t(r,null,!0),a=t(n,null,!0),o=s.compare(a);if(o===0)return null;const l=o>0,u=l?s:a,c=l?a:s,d=!!u.prerelease.length;if(!!c.prerelease.length&&!d){if(!c.patch&&!c.minor)return"major";if(c.compareMain(u)===0)return c.minor&&!c.patch?"minor":"patch"}const m=d?"pre":"";return s.major!==a.major?m+"major":s.minor!==a.minor?m+"minor":s.patch!==a.patch?m+"patch":"prerelease"},diff_1}var major_1,hasRequiredMajor;function requireMajor(){if(hasRequiredMajor)return major_1;hasRequiredMajor=1;const t=requireSemver$1();return major_1=(r,n)=>new t(r,n).major,major_1}var minor_1,hasRequiredMinor;function requireMinor(){if(hasRequiredMinor)return minor_1;hasRequiredMinor=1;const t=requireSemver$1();return minor_1=(r,n)=>new t(r,n).minor,minor_1}var patch_1,hasRequiredPatch;function requirePatch(){if(hasRequiredPatch)return patch_1;hasRequiredPatch=1;const t=requireSemver$1();return patch_1=(r,n)=>new t(r,n).patch,patch_1}var prerelease_1,hasRequiredPrerelease;function requirePrerelease(){if(hasRequiredPrerelease)return prerelease_1;hasRequiredPrerelease=1;const t=requireParse();return prerelease_1=(r,n)=>{const s=t(r,n);return s&&s.prerelease.length?s.prerelease:null},prerelease_1}var compare_1,hasRequiredCompare;function requireCompare(){if(hasRequiredCompare)return compare_1;hasRequiredCompare=1;const t=requireSemver$1();return compare_1=(r,n,s)=>new t(r,s).compare(new t(n,s)),compare_1}var rcompare_1,hasRequiredRcompare;function requireRcompare(){if(hasRequiredRcompare)return rcompare_1;hasRequiredRcompare=1;const t=requireCompare();return rcompare_1=(r,n,s)=>t(n,r,s),rcompare_1}var compareLoose_1,hasRequiredCompareLoose;function requireCompareLoose(){if(hasRequiredCompareLoose)return compareLoose_1;hasRequiredCompareLoose=1;const t=requireCompare();return compareLoose_1=(r,n)=>t(r,n,!0),compareLoose_1}var compareBuild_1,hasRequiredCompareBuild;function requireCompareBuild(){if(hasRequiredCompareBuild)return compareBuild_1;hasRequiredCompareBuild=1;const t=requireSemver$1();return compareBuild_1=(r,n,s)=>{const a=new t(r,s),o=new t(n,s);return a.compare(o)||a.compareBuild(o)},compareBuild_1}var sort_1,hasRequiredSort;function requireSort(){if(hasRequiredSort)return sort_1;hasRequiredSort=1;const t=requireCompareBuild();return sort_1=(r,n)=>r.sort((s,a)=>t(s,a,n)),sort_1}var rsort_1,hasRequiredRsort;function requireRsort(){if(hasRequiredRsort)return rsort_1;hasRequiredRsort=1;const t=requireCompareBuild();return rsort_1=(r,n)=>r.sort((s,a)=>t(a,s,n)),rsort_1}var gt_1,hasRequiredGt;function requireGt(){if(hasRequiredGt)return gt_1;hasRequiredGt=1;const t=requireCompare();return gt_1=(r,n,s)=>t(r,n,s)>0,gt_1}var lt_1,hasRequiredLt;function requireLt(){if(hasRequiredLt)return lt_1;hasRequiredLt=1;const t=requireCompare();return lt_1=(r,n,s)=>t(r,n,s)<0,lt_1}var eq_1,hasRequiredEq;function requireEq(){if(hasRequiredEq)return eq_1;hasRequiredEq=1;const t=requireCompare();return eq_1=(r,n,s)=>t(r,n,s)===0,eq_1}var neq_1,hasRequiredNeq;function requireNeq(){if(hasRequiredNeq)return neq_1;hasRequiredNeq=1;const t=requireCompare();return neq_1=(r,n,s)=>t(r,n,s)!==0,neq_1}var gte_1,hasRequiredGte;function requireGte(){if(hasRequiredGte)return gte_1;hasRequiredGte=1;const t=requireCompare();return gte_1=(r,n,s)=>t(r,n,s)>=0,gte_1}var lte_1,hasRequiredLte;function requireLte(){if(hasRequiredLte)return lte_1;hasRequiredLte=1;const t=requireCompare();return lte_1=(r,n,s)=>t(r,n,s)<=0,lte_1}var cmp_1,hasRequiredCmp;function requireCmp(){if(hasRequiredCmp)return cmp_1;hasRequiredCmp=1;const t=requireEq(),e=requireNeq(),r=requireGt(),n=requireGte(),s=requireLt(),a=requireLte();return cmp_1=(l,u,c,d)=>{switch(u){case"===":return typeof l=="object"&&(l=l.version),typeof c=="object"&&(c=c.version),l===c;case"!==":return typeof l=="object"&&(l=l.version),typeof c=="object"&&(c=c.version),l!==c;case"":case"=":case"==":return t(l,c,d);case"!=":return e(l,c,d);case">":return r(l,c,d);case">=":return n(l,c,d);case"<":return s(l,c,d);case"<=":return a(l,c,d);default:throw new TypeError(`Invalid operator: ${u}`)}},cmp_1}var coerce_1,hasRequiredCoerce;function requireCoerce(){if(hasRequiredCoerce)return coerce_1;hasRequiredCoerce=1;const t=requireSemver$1(),e=requireParse(),{safeRe:r,t:n}=requireRe();return coerce_1=(a,o)=>{if(a instanceof t)return a;if(typeof a=="number"&&(a=String(a)),typeof a!="string")return null;o=o||{};let l=null;if(!o.rtl)l=a.match(o.includePrerelease?r[n.COERCEFULL]:r[n.COERCE]);else{const y=o.includePrerelease?r[n.COERCERTLFULL]:r[n.COERCERTL];let b;for(;(b=y.exec(a))&&(!l||l.index+l[0].length!==a.length);)(!l||b.index+b[0].length!==l.index+l[0].length)&&(l=b),y.lastIndex=b.index+b[1].length+b[2].length;y.lastIndex=-1}if(l===null)return null;const u=l[2],c=l[3]||"0",d=l[4]||"0",p=o.includePrerelease&&l[5]?`-${l[5]}`:"",m=o.includePrerelease&&l[6]?`+${l[6]}`:"";return e(`${u}.${c}.${d}${p}${m}`,o)},coerce_1}var lrucache,hasRequiredLrucache;function requireLrucache(){if(hasRequiredLrucache)return lrucache;hasRequiredLrucache=1;class t{constructor(){this.max=1e3,this.map=new Map}get(r){const n=this.map.get(r);if(n!==void 0)return this.map.delete(r),this.map.set(r,n),n}delete(r){return this.map.delete(r)}set(r,n){if(!this.delete(r)&&n!==void 0){if(this.map.size>=this.max){const a=this.map.keys().next().value;this.delete(a)}this.map.set(r,n)}return this}}return lrucache=t,lrucache}var range,hasRequiredRange;function requireRange(){if(hasRequiredRange)return range;hasRequiredRange=1;const t=/\s+/g;class e{constructor(me,te){if(te=s(te),me instanceof e)return me.loose===!!te.loose&&me.includePrerelease===!!te.includePrerelease?me:new e(me.raw,te);if(me instanceof a)return this.raw=me.value,this.set=[[me]],this.formatted=void 0,this;if(this.options=te,this.loose=!!te.loose,this.includePrerelease=!!te.includePrerelease,this.raw=me.trim().replace(t," "),this.set=this.raw.split("||").map(le=>this.parseRange(le.trim())).filter(le=>le.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const le=this.set[0];if(this.set=this.set.filter(Z=>!E(Z[0])),this.set.length===0)this.set=[le];else if(this.set.length>1){for(const Z of this.set)if(Z.length===1&&T(Z[0])){this.set=[Z];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let me=0;me<this.set.length;me++){me>0&&(this.formatted+="||");const te=this.set[me];for(let le=0;le<te.length;le++)le>0&&(this.formatted+=" "),this.formatted+=te[le].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(me){const le=((this.options.includePrerelease&&y)|(this.options.loose&&b))+":"+me,Z=n.get(le);if(Z)return Z;const Y=this.options.loose,he=Y?u[c.HYPHENRANGELOOSE]:u[c.HYPHENRANGE];me=me.replace(he,fe(this.options.includePrerelease)),o("hyphen replace",me),me=me.replace(u[c.COMPARATORTRIM],d),o("comparator trim",me),me=me.replace(u[c.TILDETRIM],p),o("tilde trim",me),me=me.replace(u[c.CARETTRIM],m),o("caret trim",me);let oe=me.split(" ").map(je=>P(je,this.options)).join(" ").split(/\s+/).map(je=>de(je,this.options));Y&&(oe=oe.filter(je=>(o("loose invalid filter",je,this.options),!!je.match(u[c.COMPARATORLOOSE])))),o("range list",oe);const ye=new Map,Ee=oe.map(je=>new a(je,this.options));for(const je of Ee){if(E(je))return[je];ye.set(je.value,je)}ye.size>1&&ye.has("")&&ye.delete("");const Ae=[...ye.values()];return n.set(le,Ae),Ae}intersects(me,te){if(!(me instanceof e))throw new TypeError("a Range is required");return this.set.some(le=>S(le,te)&&me.set.some(Z=>S(Z,te)&&le.every(Y=>Z.every(he=>Y.intersects(he,te)))))}test(me){if(!me)return!1;if(typeof me=="string")try{me=new l(me,this.options)}catch{return!1}for(let te=0;te<this.set.length;te++)if(ae(this.set[te],me,this.options))return!0;return!1}}range=e;const r=requireLrucache(),n=new r,s=requireParseOptions(),a=requireComparator(),o=requireDebug(),l=requireSemver$1(),{safeRe:u,t:c,comparatorTrimReplace:d,tildeTrimReplace:p,caretTrimReplace:m}=requireRe(),{FLAG_INCLUDE_PRERELEASE:y,FLAG_LOOSE:b}=requireConstants(),E=ce=>ce.value==="<0.0.0-0",T=ce=>ce.value==="",S=(ce,me)=>{let te=!0;const le=ce.slice();let Z=le.pop();for(;te&&le.length;)te=le.every(Y=>Z.intersects(Y,me)),Z=le.pop();return te},P=(ce,me)=>(o("comp",ce,me),ce=K(ce,me),o("caret",ce),ce=I(ce,me),o("tildes",ce),ce=H(ce,me),o("xrange",ce),ce=ue(ce,me),o("stars",ce),ce),A=ce=>!ce||ce.toLowerCase()==="x"||ce==="*",I=(ce,me)=>ce.trim().split(/\s+/).map(te=>j(te,me)).join(" "),j=(ce,me)=>{const te=me.loose?u[c.TILDELOOSE]:u[c.TILDE];return ce.replace(te,(le,Z,Y,he,oe)=>{o("tilde",ce,le,Z,Y,he,oe);let ye;return A(Z)?ye="":A(Y)?ye=`>=${Z}.0.0 <${+Z+1}.0.0-0`:A(he)?ye=`>=${Z}.${Y}.0 <${Z}.${+Y+1}.0-0`:oe?(o("replaceTilde pr",oe),ye=`>=${Z}.${Y}.${he}-${oe} <${Z}.${+Y+1}.0-0`):ye=`>=${Z}.${Y}.${he} <${Z}.${+Y+1}.0-0`,o("tilde return",ye),ye})},K=(ce,me)=>ce.trim().split(/\s+/).map(te=>W(te,me)).join(" "),W=(ce,me)=>{o("caret",ce,me);const te=me.loose?u[c.CARETLOOSE]:u[c.CARET],le=me.includePrerelease?"-0":"";return ce.replace(te,(Z,Y,he,oe,ye)=>{o("caret",ce,Z,Y,he,oe,ye);let Ee;return A(Y)?Ee="":A(he)?Ee=`>=${Y}.0.0${le} <${+Y+1}.0.0-0`:A(oe)?Y==="0"?Ee=`>=${Y}.${he}.0${le} <${Y}.${+he+1}.0-0`:Ee=`>=${Y}.${he}.0${le} <${+Y+1}.0.0-0`:ye?(o("replaceCaret pr",ye),Y==="0"?he==="0"?Ee=`>=${Y}.${he}.${oe}-${ye} <${Y}.${he}.${+oe+1}-0`:Ee=`>=${Y}.${he}.${oe}-${ye} <${Y}.${+he+1}.0-0`:Ee=`>=${Y}.${he}.${oe}-${ye} <${+Y+1}.0.0-0`):(o("no pr"),Y==="0"?he==="0"?Ee=`>=${Y}.${he}.${oe}${le} <${Y}.${he}.${+oe+1}-0`:Ee=`>=${Y}.${he}.${oe}${le} <${Y}.${+he+1}.0-0`:Ee=`>=${Y}.${he}.${oe} <${+Y+1}.0.0-0`),o("caret return",Ee),Ee})},H=(ce,me)=>(o("replaceXRanges",ce,me),ce.split(/\s+/).map(te=>ee(te,me)).join(" ")),ee=(ce,me)=>{ce=ce.trim();const te=me.loose?u[c.XRANGELOOSE]:u[c.XRANGE];return ce.replace(te,(le,Z,Y,he,oe,ye)=>{o("xRange",ce,le,Z,Y,he,oe,ye);const Ee=A(Y),Ae=Ee||A(he),je=Ae||A(oe),Te=je;return Z==="="&&Te&&(Z=""),ye=me.includePrerelease?"-0":"",Ee?Z===">"||Z==="<"?le="<0.0.0-0":le="*":Z&&Te?(Ae&&(he=0),oe=0,Z===">"?(Z=">=",Ae?(Y=+Y+1,he=0,oe=0):(he=+he+1,oe=0)):Z==="<="&&(Z="<",Ae?Y=+Y+1:he=+he+1),Z==="<"&&(ye="-0"),le=`${Z+Y}.${he}.${oe}${ye}`):Ae?le=`>=${Y}.0.0${ye} <${+Y+1}.0.0-0`:je&&(le=`>=${Y}.${he}.0${ye} <${Y}.${+he+1}.0-0`),o("xRange return",le),le})},ue=(ce,me)=>(o("replaceStars",ce,me),ce.trim().replace(u[c.STAR],"")),de=(ce,me)=>(o("replaceGTE0",ce,me),ce.trim().replace(u[me.includePrerelease?c.GTE0PRE:c.GTE0],"")),fe=ce=>(me,te,le,Z,Y,he,oe,ye,Ee,Ae,je,Te)=>(A(le)?te="":A(Z)?te=`>=${le}.0.0${ce?"-0":""}`:A(Y)?te=`>=${le}.${Z}.0${ce?"-0":""}`:he?te=`>=${te}`:te=`>=${te}${ce?"-0":""}`,A(Ee)?ye="":A(Ae)?ye=`<${+Ee+1}.0.0-0`:A(je)?ye=`<${Ee}.${+Ae+1}.0-0`:Te?ye=`<=${Ee}.${Ae}.${je}-${Te}`:ce?ye=`<${Ee}.${Ae}.${+je+1}-0`:ye=`<=${ye}`,`${te} ${ye}`.trim()),ae=(ce,me,te)=>{for(let le=0;le<ce.length;le++)if(!ce[le].test(me))return!1;if(me.prerelease.length&&!te.includePrerelease){for(let le=0;le<ce.length;le++)if(o(ce[le].semver),ce[le].semver!==a.ANY&&ce[le].semver.prerelease.length>0){const Z=ce[le].semver;if(Z.major===me.major&&Z.minor===me.minor&&Z.patch===me.patch)return!0}return!1}return!0};return range}var comparator,hasRequiredComparator;function requireComparator(){if(hasRequiredComparator)return comparator;hasRequiredComparator=1;const t=Symbol("SemVer ANY");class e{static get ANY(){return t}constructor(d,p){if(p=r(p),d instanceof e){if(d.loose===!!p.loose)return d;d=d.value}d=d.trim().split(/\s+/).join(" "),o("comparator",d,p),this.options=p,this.loose=!!p.loose,this.parse(d),this.semver===t?this.value="":this.value=this.operator+this.semver.version,o("comp",this)}parse(d){const p=this.options.loose?n[s.COMPARATORLOOSE]:n[s.COMPARATOR],m=d.match(p);if(!m)throw new TypeError(`Invalid comparator: ${d}`);this.operator=m[1]!==void 0?m[1]:"",this.operator==="="&&(this.operator=""),m[2]?this.semver=new l(m[2],this.options.loose):this.semver=t}toString(){return this.value}test(d){if(o("Comparator.test",d,this.options.loose),this.semver===t||d===t)return!0;if(typeof d=="string")try{d=new l(d,this.options)}catch{return!1}return a(d,this.operator,this.semver,this.options)}intersects(d,p){if(!(d instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new u(d.value,p).test(this.value):d.operator===""?d.value===""?!0:new u(this.value,p).test(d.semver):(p=r(p),p.includePrerelease&&(this.value==="<0.0.0-0"||d.value==="<0.0.0-0")||!p.includePrerelease&&(this.value.startsWith("<0.0.0")||d.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&d.operator.startsWith(">")||this.operator.startsWith("<")&&d.operator.startsWith("<")||this.semver.version===d.semver.version&&this.operator.includes("=")&&d.operator.includes("=")||a(this.semver,"<",d.semver,p)&&this.operator.startsWith(">")&&d.operator.startsWith("<")||a(this.semver,">",d.semver,p)&&this.operator.startsWith("<")&&d.operator.startsWith(">")))}}comparator=e;const r=requireParseOptions(),{safeRe:n,t:s}=requireRe(),a=requireCmp(),o=requireDebug(),l=requireSemver$1(),u=requireRange();return comparator}var satisfies_1,hasRequiredSatisfies;function requireSatisfies(){if(hasRequiredSatisfies)return satisfies_1;hasRequiredSatisfies=1;const t=requireRange();return satisfies_1=(r,n,s)=>{try{n=new t(n,s)}catch{return!1}return n.test(r)},satisfies_1}var toComparators_1,hasRequiredToComparators;function requireToComparators(){if(hasRequiredToComparators)return toComparators_1;hasRequiredToComparators=1;const t=requireRange();return toComparators_1=(r,n)=>new t(r,n).set.map(s=>s.map(a=>a.value).join(" ").trim().split(" ")),toComparators_1}var maxSatisfying_1,hasRequiredMaxSatisfying;function requireMaxSatisfying(){if(hasRequiredMaxSatisfying)return maxSatisfying_1;hasRequiredMaxSatisfying=1;const t=requireSemver$1(),e=requireRange();return maxSatisfying_1=(n,s,a)=>{let o=null,l=null,u=null;try{u=new e(s,a)}catch{return null}return n.forEach(c=>{u.test(c)&&(!o||l.compare(c)===-1)&&(o=c,l=new t(o,a))}),o},maxSatisfying_1}var minSatisfying_1,hasRequiredMinSatisfying;function requireMinSatisfying(){if(hasRequiredMinSatisfying)return minSatisfying_1;hasRequiredMinSatisfying=1;const t=requireSemver$1(),e=requireRange();return minSatisfying_1=(n,s,a)=>{let o=null,l=null,u=null;try{u=new e(s,a)}catch{return null}return n.forEach(c=>{u.test(c)&&(!o||l.compare(c)===1)&&(o=c,l=new t(o,a))}),o},minSatisfying_1}var minVersion_1,hasRequiredMinVersion;function requireMinVersion(){if(hasRequiredMinVersion)return minVersion_1;hasRequiredMinVersion=1;const t=requireSemver$1(),e=requireRange(),r=requireGt();return minVersion_1=(s,a)=>{s=new e(s,a);let o=new t("0.0.0");if(s.test(o)||(o=new t("0.0.0-0"),s.test(o)))return o;o=null;for(let l=0;l<s.set.length;++l){const u=s.set[l];let c=null;u.forEach(d=>{const p=new t(d.semver.version);switch(d.operator){case">":p.prerelease.length===0?p.patch++:p.prerelease.push(0),p.raw=p.format();case"":case">=":(!c||r(p,c))&&(c=p);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${d.operator}`)}}),c&&(!o||r(o,c))&&(o=c)}return o&&s.test(o)?o:null},minVersion_1}var valid,hasRequiredValid;function requireValid(){if(hasRequiredValid)return valid;hasRequiredValid=1;const t=requireRange();return valid=(r,n)=>{try{return new t(r,n).range||"*"}catch{return null}},valid}var outside_1,hasRequiredOutside;function requireOutside(){if(hasRequiredOutside)return outside_1;hasRequiredOutside=1;const t=requireSemver$1(),e=requireComparator(),{ANY:r}=e,n=requireRange(),s=requireSatisfies(),a=requireGt(),o=requireLt(),l=requireLte(),u=requireGte();return outside_1=(d,p,m,y)=>{d=new t(d,y),p=new n(p,y);let b,E,T,S,P;switch(m){case">":b=a,E=l,T=o,S=">",P=">=";break;case"<":b=o,E=u,T=a,S="<",P="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(d,p,y))return!1;for(let A=0;A<p.set.length;++A){const I=p.set[A];let j=null,K=null;if(I.forEach(W=>{W.semver===r&&(W=new e(">=0.0.0")),j=j||W,K=K||W,b(W.semver,j.semver,y)?j=W:T(W.semver,K.semver,y)&&(K=W)}),j.operator===S||j.operator===P||(!K.operator||K.operator===S)&&E(d,K.semver))return!1;if(K.operator===P&&T(d,K.semver))return!1}return!0},outside_1}var gtr_1,hasRequiredGtr;function requireGtr(){if(hasRequiredGtr)return gtr_1;hasRequiredGtr=1;const t=requireOutside();return gtr_1=(r,n,s)=>t(r,n,">",s),gtr_1}var ltr_1,hasRequiredLtr;function requireLtr(){if(hasRequiredLtr)return ltr_1;hasRequiredLtr=1;const t=requireOutside();return ltr_1=(r,n,s)=>t(r,n,"<",s),ltr_1}var intersects_1,hasRequiredIntersects;function requireIntersects(){if(hasRequiredIntersects)return intersects_1;hasRequiredIntersects=1;const t=requireRange();return intersects_1=(r,n,s)=>(r=new t(r,s),n=new t(n,s),r.intersects(n,s)),intersects_1}var simplify,hasRequiredSimplify;function requireSimplify(){if(hasRequiredSimplify)return simplify;hasRequiredSimplify=1;const t=requireSatisfies(),e=requireCompare();return simplify=(r,n,s)=>{const a=[];let o=null,l=null;const u=r.sort((m,y)=>e(m,y,s));for(const m of u)t(m,n,s)?(l=m,o||(o=m)):(l&&a.push([o,l]),l=null,o=null);o&&a.push([o,null]);const c=[];for(const[m,y]of a)m===y?c.push(m):!y&&m===u[0]?c.push("*"):y?m===u[0]?c.push(`<=${y}`):c.push(`${m} - ${y}`):c.push(`>=${m}`);const d=c.join(" || "),p=typeof n.raw=="string"?n.raw:String(n);return d.length<p.length?d:n},simplify}var subset_1,hasRequiredSubset;function requireSubset(){if(hasRequiredSubset)return subset_1;hasRequiredSubset=1;const t=requireRange(),e=requireComparator(),{ANY:r}=e,n=requireSatisfies(),s=requireCompare(),a=(p,m,y={})=>{if(p===m)return!0;p=new t(p,y),m=new t(m,y);let b=!1;e:for(const E of p.set){for(const T of m.set){const S=u(E,T,y);if(b=b||S!==null,S)continue e}if(b)return!1}return!0},o=[new e(">=0.0.0-0")],l=[new e(">=0.0.0")],u=(p,m,y)=>{if(p===m)return!0;if(p.length===1&&p[0].semver===r){if(m.length===1&&m[0].semver===r)return!0;y.includePrerelease?p=o:p=l}if(m.length===1&&m[0].semver===r){if(y.includePrerelease)return!0;m=l}const b=new Set;let E,T;for(const H of p)H.operator===">"||H.operator===">="?E=c(E,H,y):H.operator==="<"||H.operator==="<="?T=d(T,H,y):b.add(H.semver);if(b.size>1)return null;let S;if(E&&T){if(S=s(E.semver,T.semver,y),S>0)return null;if(S===0&&(E.operator!==">="||T.operator!=="<="))return null}for(const H of b){if(E&&!n(H,String(E),y)||T&&!n(H,String(T),y))return null;for(const ee of m)if(!n(H,String(ee),y))return!1;return!0}let P,A,I,j,K=T&&!y.includePrerelease&&T.semver.prerelease.length?T.semver:!1,W=E&&!y.includePrerelease&&E.semver.prerelease.length?E.semver:!1;K&&K.prerelease.length===1&&T.operator==="<"&&K.prerelease[0]===0&&(K=!1);for(const H of m){if(j=j||H.operator===">"||H.operator===">=",I=I||H.operator==="<"||H.operator==="<=",E){if(W&&H.semver.prerelease&&H.semver.prerelease.length&&H.semver.major===W.major&&H.semver.minor===W.minor&&H.semver.patch===W.patch&&(W=!1),H.operator===">"||H.operator===">="){if(P=c(E,H,y),P===H&&P!==E)return!1}else if(E.operator===">="&&!n(E.semver,String(H),y))return!1}if(T){if(K&&H.semver.prerelease&&H.semver.prerelease.length&&H.semver.major===K.major&&H.semver.minor===K.minor&&H.semver.patch===K.patch&&(K=!1),H.operator==="<"||H.operator==="<="){if(A=d(T,H,y),A===H&&A!==T)return!1}else if(T.operator==="<="&&!n(T.semver,String(H),y))return!1}if(!H.operator&&(T||E)&&S!==0)return!1}return!(E&&I&&!T&&S!==0||T&&j&&!E&&S!==0||W||K)},c=(p,m,y)=>{if(!p)return m;const b=s(p.semver,m.semver,y);return b>0?p:b<0||m.operator===">"&&p.operator===">="?m:p},d=(p,m,y)=>{if(!p)return m;const b=s(p.semver,m.semver,y);return b<0?p:b>0||m.operator==="<"&&p.operator==="<="?m:p};return subset_1=a,subset_1}var semver,hasRequiredSemver;function requireSemver(){if(hasRequiredSemver)return semver;hasRequiredSemver=1;const t=requireRe(),e=requireConstants(),r=requireSemver$1(),n=requireIdentifiers(),s=requireParse(),a=requireValid$1(),o=requireClean(),l=requireInc(),u=requireDiff(),c=requireMajor(),d=requireMinor(),p=requirePatch(),m=requirePrerelease(),y=requireCompare(),b=requireRcompare(),E=requireCompareLoose(),T=requireCompareBuild(),S=requireSort(),P=requireRsort(),A=requireGt(),I=requireLt(),j=requireEq(),K=requireNeq(),W=requireGte(),H=requireLte(),ee=requireCmp(),ue=requireCoerce(),de=requireComparator(),fe=requireRange(),ae=requireSatisfies(),ce=requireToComparators(),me=requireMaxSatisfying(),te=requireMinSatisfying(),le=requireMinVersion(),Z=requireValid(),Y=requireOutside(),he=requireGtr(),oe=requireLtr(),ye=requireIntersects(),Ee=requireSimplify(),Ae=requireSubset();return semver={parse:s,valid:a,clean:o,inc:l,diff:u,major:c,minor:d,patch:p,prerelease:m,compare:y,rcompare:b,compareLoose:E,compareBuild:T,sort:S,rsort:P,gt:A,lt:I,eq:j,neq:K,gte:W,lte:H,cmp:ee,coerce:ue,Comparator:de,Range:fe,satisfies:ae,toComparators:ce,maxSatisfying:me,minSatisfying:te,minVersion:le,validRange:Z,outside:Y,gtr:he,ltr:oe,intersects:ye,simplifyRange:Ee,subset:Ae,SemVer:r,re:t.re,src:t.src,tokens:t.t,SEMVER_SPEC_VERSION:e.SEMVER_SPEC_VERSION,RELEASE_TYPES:e.RELEASE_TYPES,compareIdentifiers:n.compareIdentifiers,rcompareIdentifiers:n.rcompareIdentifiers},semver}requireSemver();function parsePromptIdentifier(t){if(!t||t.split("/").length>2||t.startsWith("/")||t.endsWith("/")||t.split(":").length>2)throw new Error(`Invalid identifier format: ${t}`);const[e,r]=t.split(":"),n=r||"latest";if(e.includes("/")){const[s,a]=e.split("/",2);if(!s||!a)throw new Error(`Invalid identifier format: ${t}`);return[s,a,n]}else{if(!e)throw new Error(`Invalid identifier format: ${t}`);return["-",e,n]}}class LangSmithConflictError extends Error{constructor(e){super(e),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="LangSmithConflictError",this.status=409}}async function raiseForStatus(t,e,r){let n;if(t.ok){r&&(n=await t.text());return}n=await t.text();const s=`Failed to ${e}. Received status [${t.status}]: ${t.statusText}. Server response: ${n}`;if(t.status===409)throw new LangSmithConflictError(s);const a=new Error(s);throw a.status=t.status,a}var LIMIT_REPLACE_NODE="[...]",CIRCULAR_REPLACE_NODE={result:"[Circular]"},arr=[],replacerStack=[];const encoder=new TextEncoder;function defaultOptions$2(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function encodeString(t){return encoder.encode(t)}function serialize(t,e,r,n,s){var a;try{const o=JSON.stringify(t,r,n);return encodeString(o)}catch(o){if(!((a=o.message)!=null&&a.includes("Converting circular structure to JSON")))return console.warn(`[WARNING]: LangSmith received unserializable value.${e?`
Context: ${e}`:""}`),encodeString("[Unserializable]");console.warn(`[WARNING]: LangSmith received circular JSON. This will decrease tracer performance. ${e?`
Context: ${e}`:""}`),typeof s>"u"&&(s=defaultOptions$2()),decirc(t,"",0,[],void 0,0,s);let l;try{replacerStack.length===0?l=JSON.stringify(t,r,n):l=JSON.stringify(t,replaceGetterValues(r),n)}catch{return encodeString("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;arr.length!==0;){const u=arr.pop();u.length===4?Object.defineProperty(u[0],u[1],u[3]):u[0][u[1]]=u[2]}}return encodeString(l)}}function setReplace(t,e,r,n){var s=Object.getOwnPropertyDescriptor(n,r);s.get!==void 0?s.configurable?(Object.defineProperty(n,r,{value:t}),arr.push([n,r,e,s])):replacerStack.push([e,r,t]):(n[r]=t,arr.push([n,r,e]))}function decirc(t,e,r,n,s,a,o){a+=1;var l;if(typeof t=="object"&&t!==null){for(l=0;l<n.length;l++)if(n[l]===t){setReplace(CIRCULAR_REPLACE_NODE,t,e,s);return}if(typeof o.depthLimit<"u"&&a>o.depthLimit){setReplace(LIMIT_REPLACE_NODE,t,e,s);return}if(typeof o.edgesLimit<"u"&&r+1>o.edgesLimit){setReplace(LIMIT_REPLACE_NODE,t,e,s);return}if(n.push(t),Array.isArray(t))for(l=0;l<t.length;l++)decirc(t[l],l,l,n,t,a,o);else{var u=Object.keys(t);for(l=0;l<u.length;l++){var c=u[l];decirc(t[c],c,l,n,t,a,o)}}n.pop()}}function replaceGetterValues(t){return t=typeof t<"u"?t:function(e,r){return r},function(e,r){if(replacerStack.length>0)for(var n=0;n<replacerStack.length;n++){var s=replacerStack[n];if(s[1]===e&&s[0]===r){r=s[2],replacerStack.splice(n,1);break}}return t.call(this,e,r)}}function mergeRuntimeEnvIntoRunCreate(t){const e=getRuntimeEnvironment$1(),r=getLangChainEnvVarsMetadata(),n=t.extra??{},s=n.metadata;return t.extra={...n,runtime:{...e,...n==null?void 0:n.runtime},metadata:{...r,...r.revision_id||t.revision_id?{revision_id:t.revision_id??r.revision_id}:{},...s}},t}const getTracingSamplingRate=t=>{const e=(t==null?void 0:t.toString())??getLangSmithEnvironmentVariable("TRACING_SAMPLING_RATE");if(e===void 0)return;const r=parseFloat(e);if(r<0||r>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${r}`);return r},isLocalhost=t=>{const r=t.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return r==="localhost"||r==="127.0.0.1"||r==="::1"};async function toArray$1(t){const e=[];for await(const r of t)e.push(r);return e}function trimQuotes(t){if(t!==void 0)return t.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const handle429=async t=>{if((t==null?void 0:t.status)===429){const e=parseInt(t.headers.get("retry-after")??"30",10)*1e3;if(e>0)return await new Promise(r=>setTimeout(r,e)),!0}return!1};function _formatFeedbackScore(t){return typeof t=="number"?Number(t.toFixed(4)):t}class AutoBatchQueue{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}peek(){return this.items[0]}push(e){let r;const n=new Promise(a=>{r=a}),s=serialize(e.item,`Serializing run with id: ${e.item.id}`).length;return this.items.push({action:e.action,payload:e.item,itemPromiseResolve:r,itemPromise:n,size:s}),this.sizeBytes+=s,n}pop(e){var s;if(e<1)throw new Error("Number of bytes to pop off may not be less than 1.");const r=[];let n=0;for(;n+(((s=this.peek())==null?void 0:s.size)??0)<e&&this.items.length>0;){const a=this.items.shift();a&&(r.push(a),n+=a.size,this.sizeBytes-=a.size)}if(r.length===0&&this.items.length>0){const a=this.items.shift();r.push(a),n+=a.size,this.sizeBytes-=a.size}return[r.map(a=>({action:a.action,item:a.payload})),()=>r.forEach(a=>a.itemPromiseResolve())]}}const DEFAULT_BATCH_SIZE_LIMIT_BYTES=20971520,SERVER_INFO_REQUEST_TIMEOUT=2500;class Client{constructor(e={}){var n;Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new AutoBatchQueue}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:getEnvironmentVariable$1("LANGSMITH_TRACING_BACKGROUND")==="false"}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"manualFlushMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:getEnvironmentVariable$1("LANGSMITH_DEBUG")==="true"});const r=Client.getDefaultClientConfig();if(this.tracingSampleRate=getTracingSamplingRate(e.tracingSamplingRate),this.apiUrl=trimQuotes(e.apiUrl??r.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=trimQuotes(e.apiKey??r.apiKey),this.webUrl=trimQuotes(e.webUrl??r.webUrl),(n=this.webUrl)!=null&&n.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.timeout_ms=e.timeout_ms??9e4,this.caller=new AsyncCaller$1({...e.callerOptions??{},debug:e.debug??this.debug}),this.traceBatchConcurrency=e.traceBatchConcurrency??this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw new Error("Trace batch concurrency must be positive.");this.debug=e.debug??this.debug,this.batchIngestCaller=new AsyncCaller$1({maxRetries:2,maxConcurrency:this.traceBatchConcurrency,...e.callerOptions??{},onFailedResponseHook:handle429,debug:e.debug??this.debug}),this.hideInputs=e.hideInputs??e.anonymizer??r.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??r.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.fetchOptions=e.fetchOptions||{},this.manualFlushMode=e.manualFlushMode??this.manualFlushMode}static getDefaultClientConfig(){const e=getLangSmithEnvironmentVariable("API_KEY"),r=getLangSmithEnvironmentVariable("ENDPOINT")??"https://api.smith.langchain.com",n=getLangSmithEnvironmentVariable("HIDE_INPUTS")==="true",s=getLangSmithEnvironmentVariable("HIDE_OUTPUTS")==="true";return{apiUrl:r,apiKey:e,webUrl:void 0,hideInputs:n,hideOutputs:s}}getHostUrl(){return this.webUrl?this.webUrl:isLocalhost(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.endsWith("/api/v1")?(this.webUrl=this.apiUrl.replace("/api/v1",""),this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("beta")?(this.webUrl="https://beta.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const e={"User-Agent":`langsmith-js/${__version__}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}async processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}async processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}async prepareRunCreateOrUpdateInputs(e){const r={...e};return r.inputs!==void 0&&(r.inputs=await this.processInputs(r.inputs)),r.outputs!==void 0&&(r.outputs=await this.processOutputs(r.outputs)),r}async _getResponse(e,r){const n=(r==null?void 0:r.toString())??"",s=`${this.apiUrl}${e}?${n}`,a=await this.caller.call(_getFetchImplementation(this.debug),s,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(a,`Failed to fetch ${e}`),a}async _get(e,r){return(await this._getResponse(e,r)).json()}async*_getPaginated(e,r=new URLSearchParams,n){let s=Number(r.get("offset"))||0;const a=Number(r.get("limit"))||100;for(;;){r.set("offset",String(s)),r.set("limit",String(a));const o=`${this.apiUrl}${e}?${r}`,l=await this.caller.call(_getFetchImplementation(this.debug),o,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(l,`Failed to fetch ${e}`);const u=n?n(await l.json()):await l.json();if(u.length===0||(yield u,u.length<a))break;s+=u.length}}async*_getCursorPaginatedList(e,r=null,n="POST",s="runs"){const a=r?{...r}:{};for(;;){const l=await(await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}${e}`,{method:n,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(a)})).json();if(!l||!l[s])break;yield l[s];const u=l.cursors;if(!u||!u.next)break;a.cursor=u.next}}_shouldSample(){return this.tracingSampleRate===void 0?!0:Math.random()<this.tracingSampleRate}_filterForSampling(e,r=!1){if(this.tracingSampleRate===void 0)return e;if(r){const n=[];for(const s of e)this.filteredPostUuids.has(s.id)?this.filteredPostUuids.delete(s.id):n.push(s);return n}else{const n=[];for(const s of e){const a=s.trace_id??s.id;this.filteredPostUuids.has(a)||(s.id===a?this._shouldSample()?n.push(s):this.filteredPostUuids.add(a):n.push(s))}return n}}async _getBatchSizeLimitBytes(){var r;const e=await this._ensureServerInfo();return this.batchSizeBytesLimit??((r=e.batch_ingest_config)==null?void 0:r.size_limit_bytes)??DEFAULT_BATCH_SIZE_LIMIT_BYTES}async _getMultiPartSupport(){var r;return((r=(await this._ensureServerInfo()).instance_flags)==null?void 0:r.dataset_examples_multipart_enabled)??!1}drainAutoBatchQueue(e){const r=[];for(;this.autoBatchQueue.items.length>0;){const[n,s]=this.autoBatchQueue.pop(e);if(!n.length){s();break}const a=this._processBatch(n,s).catch(console.error);r.push(a)}return Promise.all(r)}async _processBatch(e,r){var n;if(!e.length){r();return}try{const s={runCreates:e.filter(o=>o.action==="create").map(o=>o.item),runUpdates:e.filter(o=>o.action==="update").map(o=>o.item)},a=await this._ensureServerInfo();(n=a==null?void 0:a.batch_ingest_config)!=null&&n.use_multipart_endpoint?await this.multipartIngestRuns(s):await this.batchIngestRuns(s)}finally{r()}}async processRunOperation(e){clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,e.action==="create"&&(e.item=mergeRuntimeEnvIntoRunCreate(e.item));const r=this.autoBatchQueue.push(e);if(this.manualFlushMode)return r;const n=await this._getBatchSizeLimitBytes();return this.autoBatchQueue.sizeBytes>n&&this.drainAutoBatchQueue(n),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue(n)},this.autoBatchAggregationDelayMs)),r}async _getServerInfo(){const e=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(SERVER_INFO_REQUEST_TIMEOUT),...this.fetchOptions});await raiseForStatus(e,"get server info");const r=await e.json();return this.debug&&console.log(`
=== LangSmith Server Configuration ===
`+JSON.stringify(r,null,2)+`
`),r}async _ensureServerInfo(){return this._getServerInfoPromise===void 0&&(this._getServerInfoPromise=(async()=>{if(this._serverInfo===void 0)try{this._serverInfo=await this._getServerInfo()}catch(e){console.warn(`[WARNING]: LangSmith failed to fetch info on supported operations with status code ${e.status}. Falling back to batch operations and default limits.`)}return this._serverInfo??{}})()),this._getServerInfoPromise.then(e=>(this._serverInfo===void 0&&(this._getServerInfoPromise=void 0),e))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async flush(){const e=await this._getBatchSizeLimitBytes();await this.drainAutoBatchQueue(e)}async createRun(e){if(!this._filterForSampling([e]).length)return;const r={...this.headers,"Content-Type":"application/json"},n=e.project_name;delete e.project_name;const s=await this.prepareRunCreateOrUpdateInputs({session_name:n,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&s.trace_id!==void 0&&s.dotted_order!==void 0){this.processRunOperation({action:"create",item:s}).catch(console.error);return}const a=mergeRuntimeEnvIntoRunCreate(s),o=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/runs`,{method:"POST",headers:r,body:serialize(a,`Creating run with id: ${a.id}`),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(o,"create run",!0)}async batchIngestRuns({runCreates:e,runUpdates:r}){if(e===void 0&&r===void 0)return;let n=await Promise.all((e==null?void 0:e.map(l=>this.prepareRunCreateOrUpdateInputs(l)))??[]),s=await Promise.all((r==null?void 0:r.map(l=>this.prepareRunCreateOrUpdateInputs(l)))??[]);if(n.length>0&&s.length>0){const l=n.reduce((c,d)=>(d.id&&(c[d.id]=d),c),{}),u=[];for(const c of s)c.id!==void 0&&l[c.id]?l[c.id]={...l[c.id],...c}:u.push(c);n=Object.values(l),s=u}const a={post:n,patch:s};if(!a.post.length&&!a.patch.length)return;const o={post:[],patch:[]};for(const l of["post","patch"]){const u=l,c=a[u].reverse();let d=c.pop();for(;d!==void 0;)o[u].push(d),d=c.pop()}if(o.post.length>0||o.patch.length>0){const l=o.post.map(u=>u.id).concat(o.patch.map(u=>u.id)).join(",");await this._postBatchIngestRuns(serialize(o,`Ingesting runs with ids: ${l}`))}}async _postBatchIngestRuns(e){const r={...this.headers,"Content-Type":"application/json",Accept:"application/json"},n=await this.batchIngestCaller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/runs/batch`,{method:"POST",headers:r,body:e,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(n,"batch create run",!0)}async multipartIngestRuns({runCreates:e,runUpdates:r}){if(e===void 0&&r===void 0)return;const n={};let s=[];for(const d of e??[]){const p=await this.prepareRunCreateOrUpdateInputs(d);p.id!==void 0&&p.attachments!==void 0&&(n[p.id]=p.attachments),delete p.attachments,s.push(p)}let a=[];for(const d of r??[])a.push(await this.prepareRunCreateOrUpdateInputs(d));if(s.find(d=>d.trace_id===void 0||d.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(a.find(d=>d.trace_id===void 0||d.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(s.length>0&&a.length>0){const d=s.reduce((m,y)=>(y.id&&(m[y.id]=y),m),{}),p=[];for(const m of a)m.id!==void 0&&d[m.id]?d[m.id]={...d[m.id],...m}:p.push(m);s=Object.values(d),a=p}if(s.length===0&&a.length===0)return;const u=[],c=[];for(const[d,p]of[["post",s],["patch",a]])for(const m of p){const{inputs:y,outputs:b,events:E,attachments:T,...S}=m,P={inputs:y,outputs:b,events:E},A=serialize(S,`Serializing for multipart ingestion of run with id: ${S.id}`);c.push({name:`${d}.${S.id}`,payload:new Blob([A],{type:`application/json; length=${A.length}`})});for(const[I,j]of Object.entries(P)){if(j===void 0)continue;const K=serialize(j,`Serializing ${I} for multipart ingestion of run with id: ${S.id}`);c.push({name:`${d}.${S.id}.${I}`,payload:new Blob([K],{type:`application/json; length=${K.length}`})})}if(S.id!==void 0){const I=n[S.id];if(I){delete n[S.id];for(const[j,K]of Object.entries(I)){let W,H;if(Array.isArray(K)?[W,H]=K:(W=K.mimeType,H=K.data),j.includes(".")){console.warn(`Skipping attachment '${j}' for run ${S.id}: Invalid attachment name. Attachment names must not contain periods ('.'). Please rename the attachment and try again.`);continue}c.push({name:`attachment.${S.id}.${j}`,payload:new Blob([H],{type:`${W}; length=${H.byteLength}`})})}}}u.push(`trace=${S.trace_id},id=${S.id}`)}await this._sendMultipartRequest(c,u.join("; "))}async _createNodeFetchBody(e,r){const n=[];for(const o of e)n.push(new Blob([`--${r}\r
`])),n.push(new Blob([`Content-Disposition: form-data; name="${o.name}"\r
`,`Content-Type: ${o.payload.type}\r
\r
`])),n.push(o.payload),n.push(new Blob([`\r
`]));return n.push(new Blob([`--${r}--\r
`])),await new Blob(n).arrayBuffer()}async _createMultipartStream(e,r){const n=new TextEncoder;return new ReadableStream({async start(a){const o=async l=>{typeof l=="string"?a.enqueue(n.encode(l)):a.enqueue(l)};for(const l of e){await o(`--${r}\r
`),await o(`Content-Disposition: form-data; name="${l.name}"\r
`),await o(`Content-Type: ${l.payload.type}\r
\r
`);const c=l.payload.stream().getReader();try{let d;for(;!(d=await c.read()).done;)a.enqueue(d.value)}finally{c.releaseLock()}await o(`\r
`)}await o(`--${r}--\r
`),a.close()}})}async _sendMultipartRequest(e,r){try{const n="----LangSmithFormBoundary"+Math.random().toString(36).slice(2),s=await(_globalFetchImplementationIsNodeFetch()?this._createNodeFetchBody(e,n):this._createMultipartStream(e,n)),a=await this.batchIngestCaller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/runs/multipart`,{method:"POST",headers:{...this.headers,"Content-Type":`multipart/form-data; boundary=${n}`},body:s,duplex:"half",signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(a,"ingest multipart runs",!0)}catch(n){console.warn(`${n.message.trim()}

Context: ${r}`)}}async updateRun(e,r){assertUuid(e),r.inputs&&(r.inputs=await this.processInputs(r.inputs)),r.outputs&&(r.outputs=await this.processOutputs(r.outputs));const n={...r,id:e};if(!this._filterForSampling([n],!0).length)return;if(this.autoBatchTracing&&n.trace_id!==void 0&&n.dotted_order!==void 0){if(r.end_time!==void 0&&n.parent_run_id===void 0&&this.blockOnRootRunFinalization&&!this.manualFlushMode){await this.processRunOperation({action:"update",item:n}).catch(console.error);return}else this.processRunOperation({action:"update",item:n}).catch(console.error);return}const s={...this.headers,"Content-Type":"application/json"},a=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:s,body:serialize(r,`Serializing payload to update run with id: ${e}`),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(a,"update run",!0)}async readRun(e,{loadChildRuns:r}={loadChildRuns:!1}){assertUuid(e);let n=await this._get(`/runs/${e}`);return r&&n.child_run_ids&&(n=await this._loadChildRuns(n)),n}async getRunUrl({runId:e,run:r,projectOpts:n}){if(r!==void 0){let s;r.session_id?s=r.session_id:n!=null&&n.projectName?s=(await this.readProject({projectName:n==null?void 0:n.projectName})).id:n!=null&&n.projectId?s=n==null?void 0:n.projectId:s=(await this.readProject({projectName:getLangSmithEnvironmentVariable("PROJECT")||"default"})).id;const a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/projects/p/${s}/r/${r.id}?poll=true`}else if(e!==void 0){const s=await this.readRun(e);if(!s.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${s.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){const r=await toArray$1(this.listRuns({id:e.child_run_ids})),n={},s={};r.sort((a,o)=>((a==null?void 0:a.dotted_order)??"").localeCompare((o==null?void 0:o.dotted_order)??""));for(const a of r){if(a.parent_run_id===null||a.parent_run_id===void 0)throw new Error(`Child run ${a.id} has no parent`);a.parent_run_id in n||(n[a.parent_run_id]=[]),n[a.parent_run_id].push(a),s[a.id]=a}e.child_runs=n[e.id]||[];for(const a in n)a!==e.id&&(s[a].child_runs=n[a]);return e}async*listRuns(e){const{projectId:r,projectName:n,parentRunId:s,traceId:a,referenceExampleId:o,startTime:l,executionOrder:u,isRoot:c,runType:d,error:p,id:m,query:y,filter:b,traceFilter:E,treeFilter:T,limit:S,select:P,order:A}=e;let I=[];if(r&&(I=Array.isArray(r)?r:[r]),n){const H=Array.isArray(n)?n:[n],ee=await Promise.all(H.map(ue=>this.readProject({projectName:ue}).then(de=>de.id)));I.push(...ee)}const j=["app_path","child_run_ids","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],K={session:I.length?I:null,run_type:d,reference_example:o,query:y,filter:b,trace_filter:E,tree_filter:T,execution_order:u,parent_run:s,start_time:l?l.toISOString():null,error:p,id:m,limit:S,trace:a,select:P||j,is_root:c,order:A};let W=0;for await(const H of this._getCursorPaginatedList("/runs/query",K))if(S){if(W>=S)break;if(H.length+W>S){yield*H.slice(0,S-W);break}W+=H.length,yield*H}else yield*H}async*listGroupRuns(e){const{projectId:r,projectName:n,groupBy:s,filter:a,startTime:o,endTime:l,limit:u,offset:c}=e,p={session_id:r||(await this.readProject({projectName:n})).id,group_by:s,filter:a,start_time:o?o.toISOString():null,end_time:l?l.toISOString():null,limit:Number(u)||100};let m=Number(c)||0;const y="/runs/group",b=`${this.apiUrl}${y}`;for(;;){const E={...p,offset:m},T=Object.fromEntries(Object.entries(E).filter(([j,K])=>K!==void 0)),S=await this.caller.call(_getFetchImplementation(),b,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(T),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(S,`Failed to fetch ${y}`);const P=await S.json(),{groups:A,total:I}=P;if(A.length===0)break;for(const j of A)yield j;if(m+=A.length,m>=I)break}}async getRunStats({id:e,trace:r,parentRun:n,runType:s,projectNames:a,projectIds:o,referenceExampleIds:l,startTime:u,endTime:c,error:d,query:p,filter:m,traceFilter:y,treeFilter:b,isRoot:E,dataSourceType:T}){let S=o||[];a&&(S=[...o||[],...await Promise.all(a.map(K=>this.readProject({projectName:K}).then(W=>W.id)))]);const A=Object.fromEntries(Object.entries({id:e,trace:r,parent_run:n,run_type:s,session:S,reference_example:l,start_time:u,end_time:c,error:d,query:p,filter:m,trace_filter:y,tree_filter:b,is_root:E,data_source_type:T}).filter(([K,W])=>W!==void 0));return await(await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/runs/stats`,{method:"POST",headers:this.headers,body:JSON.stringify(A),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async shareRun(e,{shareId:r}={}){const n={run_id:e,share_token:r||v4()};assertUuid(e);const a=await(await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(a===null||!("share_token"in a))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${a.share_token}/r`}async unshareRun(e){assertUuid(e);const r=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(r,"unshare run",!0)}async readRunSharedLink(e){assertUuid(e);const n=await(await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(!(n===null||!("share_token"in n)))return`${this.getHostUrl()}/public/${n.share_token}/r`}async listSharedRuns(e,{runIds:r}={}){const n=new URLSearchParams({share_token:e});if(r!==void 0)for(const o of r)n.append("id",o);return assertUuid(e),await(await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/public/${e}/runs${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async readDatasetSharedSchema(e,r){if(!e&&!r)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:r})).id),assertUuid(e);const s=await(await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return s.url=`${this.getHostUrl()}/public/${s.share_token}/d`,s}async shareDataset(e,r){if(!e&&!r)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:r})).id);const n={dataset_id:e};assertUuid(e);const a=await(await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return a.url=`${this.getHostUrl()}/public/${a.share_token}/d`,a}async unshareDataset(e){assertUuid(e);const r=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(r,"unshare dataset",!0)}async readSharedDataset(e){return assertUuid(e),await(await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async listSharedExamples(e,r){const n={};r!=null&&r.exampleIds&&(n.id=r.exampleIds);const s=new URLSearchParams;Object.entries(n).forEach(([l,u])=>{Array.isArray(u)?u.forEach(c=>s.append(l,c)):s.append(l,u)});const a=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/public/${e}/examples?${s.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),o=await a.json();if(!a.ok)throw"detail"in o?new Error(`Failed to list shared examples.
Status: ${a.status}
Message: ${Array.isArray(o.detail)?o.detail.join(`
`):"Unspecified error"}`):new Error(`Failed to list shared examples: ${a.status} ${a.statusText}`);return o.map(l=>({...l,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:r=null,metadata:n=null,upsert:s=!1,projectExtra:a=null,referenceDatasetId:o=null}){const l=s?"?upsert=true":"",u=`${this.apiUrl}/sessions${l}`,c=a||{};n&&(c.metadata=n);const d={name:e,extra:c,description:r};o!==null&&(d.reference_dataset_id=o);const p=await this.caller.call(_getFetchImplementation(this.debug),u,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(d),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(p,"create project"),await p.json()}async updateProject(e,{name:r=null,description:n=null,metadata:s=null,projectExtra:a=null,endTime:o=null}){const l=`${this.apiUrl}/sessions/${e}`;let u=a;s&&(u={...u||{},metadata:s});const c={name:r,extra:u,description:n,end_time:o?new Date(o).toISOString():null},d=await this.caller.call(_getFetchImplementation(this.debug),l,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(d,"update project"),await d.json()}async hasProject({projectId:e,projectName:r}){let n="/sessions";const s=new URLSearchParams;if(e!==void 0&&r!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)assertUuid(e),n+=`/${e}`;else if(r!==void 0)s.append("name",r);else throw new Error("Must provide projectName or projectId");const a=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}${n}?${s}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});try{const o=await a.json();return a.ok?Array.isArray(o)?o.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:r,includeStats:n}){let s="/sessions";const a=new URLSearchParams;if(e!==void 0&&r!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)assertUuid(e),s+=`/${e}`;else if(r!==void 0)a.append("name",r);else throw new Error("Must provide projectName or projectId");n!==void 0&&a.append("include_stats",n.toString());const o=await this._get(s,a);let l;if(Array.isArray(o)){if(o.length===0)throw new Error(`Project[id=${e}, name=${r}] not found`);l=o[0]}else l=o;return l}async getProjectUrl({projectId:e,projectName:r}){if(e===void 0&&r===void 0)throw new Error("Must provide either projectName or projectId");const n=await this.readProject({projectId:e,projectName:r}),s=await this._getTenantId();return`${this.getHostUrl()}/o/${s}/projects/p/${n.id}`}async getDatasetUrl({datasetId:e,datasetName:r}){if(e===void 0&&r===void 0)throw new Error("Must provide either datasetName or datasetId");const n=await this.readDataset({datasetId:e,datasetName:r}),s=await this._getTenantId();return`${this.getHostUrl()}/o/${s}/datasets/${n.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const r of this._getPaginated("/sessions",e))return this._tenantId=r[0].tenant_id,r[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:r,nameContains:n,referenceDatasetId:s,referenceDatasetName:a,referenceFree:o,metadata:l}={}){const u=new URLSearchParams;if(e!==void 0)for(const c of e)u.append("id",c);if(r!==void 0&&u.append("name",r),n!==void 0&&u.append("name_contains",n),s!==void 0)u.append("reference_dataset",s);else if(a!==void 0){const c=await this.readDataset({datasetName:a});u.append("reference_dataset",c.id)}o!==void 0&&u.append("reference_free",o.toString()),l!==void 0&&u.append("metadata",JSON.stringify(l));for await(const c of this._getPaginated("/sessions",u))yield*c}async deleteProject({projectId:e,projectName:r}){let n;if(e===void 0&&r===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&r!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?n=(await this.readProject({projectName:r})).id:n=e,assertUuid(n);const s=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/sessions/${n}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(s,`delete session ${n} (${r})`,!0)}async uploadCsv({csvFile:e,fileName:r,inputKeys:n,outputKeys:s,description:a,dataType:o,name:l}){const u=`${this.apiUrl}/datasets/upload`,c=new FormData;c.append("file",e,r),n.forEach(m=>{c.append("input_keys",m)}),s.forEach(m=>{c.append("output_keys",m)}),a&&c.append("description",a),o&&c.append("data_type",o),l&&c.append("name",l);const d=await this.caller.call(_getFetchImplementation(this.debug),u,{method:"POST",headers:this.headers,body:c,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(d,"upload CSV"),await d.json()}async createDataset(e,{description:r,dataType:n,inputsSchema:s,outputsSchema:a,metadata:o}={}){const l={name:e,description:r,extra:o?{metadata:o}:void 0};n&&(l.data_type=n),s&&(l.inputs_schema_definition=s),a&&(l.outputs_schema_definition=a);const u=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(u,"create dataset"),await u.json()}async readDataset({datasetId:e,datasetName:r}){let n="/datasets";const s=new URLSearchParams({limit:"1"});if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)assertUuid(e),n+=`/${e}`;else if(r!==void 0)s.append("name",r);else throw new Error("Must provide datasetName or datasetId");const a=await this._get(n,s);let o;if(Array.isArray(a)){if(a.length===0)throw new Error(`Dataset[id=${e}, name=${r}] not found`);o=a[0]}else o=a;return o}async hasDataset({datasetId:e,datasetName:r}){try{return await this.readDataset({datasetId:e,datasetName:r}),!0}catch(n){if(n instanceof Error&&n.message.toLocaleLowerCase().includes("not found"))return!1;throw n}}async diffDatasetVersions({datasetId:e,datasetName:r,fromVersion:n,toVersion:s}){let a=e;if(a===void 0&&r===void 0)throw new Error("Must provide either datasetName or datasetId");if(a!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");a===void 0&&(a=(await this.readDataset({datasetName:r})).id);const o=new URLSearchParams({from_version:typeof n=="string"?n:n.toISOString(),to_version:typeof s=="string"?s:s.toISOString()});return await this._get(`/datasets/${a}/versions/diff`,o)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:r}){const n="/datasets";if(e===void 0)if(r!==void 0)e=(await this.readDataset({datasetName:r})).id;else throw new Error("Must provide either datasetName or datasetId");return(await(await this._getResponse(`${n}/${e}/openai_ft`)).text()).trim().split(`
`).map(l=>JSON.parse(l))}async*listDatasets({limit:e=100,offset:r=0,datasetIds:n,datasetName:s,datasetNameContains:a,metadata:o}={}){const l="/datasets",u=new URLSearchParams({limit:e.toString(),offset:r.toString()});if(n!==void 0)for(const c of n)u.append("id",c);s!==void 0&&u.append("name",s),a!==void 0&&u.append("name_contains",a),o!==void 0&&u.append("metadata",JSON.stringify(o));for await(const c of this._getPaginated(l,u))yield*c}async updateDataset(e){const{datasetId:r,datasetName:n,...s}=e;if(!r&&!n)throw new Error("Must provide either datasetName or datasetId");const a=r??(await this.readDataset({datasetName:n})).id;assertUuid(a);const o=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/datasets/${a}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(o,"update dataset"),await o.json()}async updateDatasetTag(e){const{datasetId:r,datasetName:n,asOf:s,tag:a}=e;if(!r&&!n)throw new Error("Must provide either datasetName or datasetId");const o=r??(await this.readDataset({datasetName:n})).id;assertUuid(o);const l=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/datasets/${o}/tags`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({as_of:typeof s=="string"?s:s.toISOString(),tag:a}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(l,"update dataset tags")}async deleteDataset({datasetId:e,datasetName:r}){let n="/datasets",s=e;if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(r!==void 0&&(s=(await this.readDataset({datasetName:r})).id),s!==void 0)assertUuid(s),n+=`/${s}`;else throw new Error("Must provide datasetName or datasetId");const a=await this.caller.call(_getFetchImplementation(this.debug),this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(a,`delete ${n}`),await a.json()}async indexDataset({datasetId:e,datasetName:r,tag:n}){let s=e;if(!s&&!r)throw new Error("Must provide either datasetName or datasetId");if(s&&r)throw new Error("Must provide either datasetName or datasetId, not both");s||(s=(await this.readDataset({datasetName:r})).id),assertUuid(s);const a={tag:n},o=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/datasets/${s}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(o,"index dataset"),await o.json()}async similarExamples(e,r,n,{filter:s}={}){const a={limit:n,inputs:e};s!==void 0&&(a.filter=s),assertUuid(r);const o=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/datasets/${r}/search`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(o,"fetch similar examples"),(await o.json()).examples}async createExample(e,r,n){var d;if(isExampleCreate(e)&&(r!==void 0||n!==void 0))throw new Error("Cannot provide outputs or options when using ExampleCreate object");let s=r?n==null?void 0:n.datasetId:e.dataset_id;const a=r?n==null?void 0:n.datasetName:e.dataset_name;if(s===void 0&&a===void 0)throw new Error("Must provide either datasetName or datasetId");if(s!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");s===void 0&&(s=(await this.readDataset({datasetName:a})).id);const o=(r?n==null?void 0:n.createdAt:e.created_at)||new Date;let l;isExampleCreate(e)?l=e:l={inputs:e,outputs:r,created_at:o==null?void 0:o.toISOString(),id:n==null?void 0:n.exampleId,metadata:n==null?void 0:n.metadata,split:n==null?void 0:n.split,source_run_id:n==null?void 0:n.sourceRunId,use_source_run_io:n==null?void 0:n.useSourceRunIO,use_source_run_attachments:n==null?void 0:n.useSourceRunAttachments,attachments:n==null?void 0:n.attachments};const u=await this._uploadExamplesMultipart(s,[l]);return await this.readExample(((d=u.example_ids)==null?void 0:d[0])??v4())}async createExamples(e){if(Array.isArray(e)){if(e.length===0)return[];const P=e;let A=P[0].dataset_id;const I=P[0].dataset_name;if(A===void 0&&I===void 0)throw new Error("Must provide either datasetName or datasetId");if(A!==void 0&&I!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");A===void 0&&(A=(await this.readDataset({datasetName:I})).id);const j=await this._uploadExamplesMultipart(A,P);return await Promise.all(j.example_ids.map(W=>this.readExample(W)))}const{inputs:r,outputs:n,metadata:s,splits:a,sourceRunIds:o,useSourceRunIOs:l,useSourceRunAttachments:u,attachments:c,exampleIds:d,datasetId:p,datasetName:m}=e;if(r===void 0)throw new Error("Must provide inputs when using legacy parameters");let y=p;const b=m;if(y===void 0&&b===void 0)throw new Error("Must provide either datasetName or datasetId");if(y!==void 0&&b!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");y===void 0&&(y=(await this.readDataset({datasetName:b})).id);const E=r.map((P,A)=>({dataset_id:y,inputs:P,outputs:n==null?void 0:n[A],metadata:s==null?void 0:s[A],split:a==null?void 0:a[A],id:d==null?void 0:d[A],attachments:c==null?void 0:c[A],source_run_id:o==null?void 0:o[A],use_source_run_io:l==null?void 0:l[A],use_source_run_attachments:u==null?void 0:u[A]})),T=await this._uploadExamplesMultipart(y,E);return await Promise.all(T.example_ids.map(P=>this.readExample(P)))}async createLLMExample(e,r,n){return this.createExample({input:e},{output:r},n)}async createChatExample(e,r,n){const s=e.map(o=>isLangChainMessage(o)?convertLangChainMessageToExample(o):o),a=isLangChainMessage(r)?convertLangChainMessageToExample(r):r;return this.createExample({input:s},{output:a},n)}async readExample(e){assertUuid(e);const r=`/examples/${e}`,n=await this._get(r),{attachment_urls:s,...a}=n,o=a;return s&&(o.attachments=Object.entries(s).reduce((l,[u,c])=>(l[u.slice(11)]={presigned_url:c.presigned_url,mime_type:c.mime_type},l),{})),o}async*listExamples({datasetId:e,datasetName:r,exampleIds:n,asOf:s,splits:a,inlineS3Urls:o,metadata:l,limit:u,offset:c,filter:d,includeAttachments:p}={}){let m;if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)m=e;else if(r!==void 0)m=(await this.readDataset({datasetName:r})).id;else throw new Error("Must provide a datasetName or datasetId");const y=new URLSearchParams({dataset:m}),b=s?typeof s=="string"?s:s==null?void 0:s.toISOString():void 0;b&&y.append("as_of",b);const E=o??!0;if(y.append("inline_s3_urls",E.toString()),n!==void 0)for(const S of n)y.append("id",S);if(a!==void 0)for(const S of a)y.append("splits",S);if(l!==void 0){const S=JSON.stringify(l);y.append("metadata",S)}u!==void 0&&y.append("limit",u.toString()),c!==void 0&&y.append("offset",c.toString()),d!==void 0&&y.append("filter",d),p===!0&&["attachment_urls","outputs","metadata"].forEach(S=>y.append("select",S));let T=0;for await(const S of this._getPaginated("/examples",y)){for(const P of S){const{attachment_urls:A,...I}=P,j=I;A&&(j.attachments=Object.entries(A).reduce((K,[W,H])=>(K[W.slice(11)]={presigned_url:H.presigned_url,mime_type:H.mime_type||void 0},K),{})),yield j,T++}if(u!==void 0&&T>=u)break}}async deleteExample(e){assertUuid(e);const r=`/examples/${e}`,n=await this.caller.call(_getFetchImplementation(this.debug),this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(n,`delete ${r}`),await n.json()}async updateExample(e,r){let n;r?n=e:n=e.id,assertUuid(n);let s;r?s={id:n,...r}:s=e;let a;return s.dataset_id!==void 0?a=s.dataset_id:a=(await this.readExample(n)).dataset_id,this._updateExamplesMultipart(a,[s])}async updateExamples(e){let r;return e[0].dataset_id===void 0?r=(await this.readExample(e[0].id)).dataset_id:r=e[0].dataset_id,this._updateExamplesMultipart(r,e)}async readDatasetVersion({datasetId:e,datasetName:r,asOf:n,tag:s}){let a;if(e?a=e:a=(await this.readDataset({datasetName:r})).id,assertUuid(a),n&&s||!n&&!s)throw new Error("Exactly one of asOf and tag must be specified.");const o=new URLSearchParams;n!==void 0&&o.append("as_of",typeof n=="string"?n:n.toISOString()),s!==void 0&&o.append("tag",s);const l=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/datasets/${a}/version?${o.toString()}`,{method:"GET",headers:{...this.headers},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(l,"read dataset version"),await l.json()}async listDatasetSplits({datasetId:e,datasetName:r,asOf:n}){let s;if(e===void 0&&r===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?s=(await this.readDataset({datasetName:r})).id:s=e,assertUuid(s);const a=new URLSearchParams,o=n?typeof n=="string"?n:n==null?void 0:n.toISOString():void 0;return o&&a.append("as_of",o),await this._get(`/datasets/${s}/splits`,a)}async updateDatasetSplits({datasetId:e,datasetName:r,splitName:n,exampleIds:s,remove:a=!1}){let o;if(e===void 0&&r===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?o=(await this.readDataset({datasetName:r})).id:o=e,assertUuid(o);const l={split_name:n,examples:s.map(c=>(assertUuid(c),c)),remove:a},u=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/datasets/${o}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(u,"update dataset splits",!0)}async evaluateRun(e,r,{sourceInfo:n,loadChildRuns:s,referenceExample:a}={loadChildRuns:!1}){warnOnce("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead.");let o;if(typeof e=="string")o=await this.readRun(e,{loadChildRuns:s});else if(typeof e=="object"&&"id"in e)o=e;else throw new Error(`Invalid run type: ${typeof e}`);o.reference_example_id!==null&&o.reference_example_id!==void 0&&(a=await this.readExample(o.reference_example_id));const l=await r.evaluateRun(o,a),[u,c]=await this._logEvaluationFeedback(l,o,n);return c[0]}async createFeedback(e,r,{score:n,value:s,correction:a,comment:o,sourceInfo:l,feedbackSourceType:u="api",sourceRunId:c,feedbackId:d,feedbackConfig:p,projectId:m,comparativeExperimentId:y}){var P;if(!e&&!m)throw new Error("One of runId or projectId must be provided");if(e&&m)throw new Error("Only one of runId or projectId can be provided");const b={type:u??"api",metadata:l??{}};c!==void 0&&(b==null?void 0:b.metadata)!==void 0&&!b.metadata.__run&&(b.metadata.__run={run_id:c}),(b==null?void 0:b.metadata)!==void 0&&((P=b.metadata.__run)==null?void 0:P.run_id)!==void 0&&assertUuid(b.metadata.__run.run_id);const E={id:d??v4(),run_id:e,key:r,score:_formatFeedbackScore(n),value:s,correction:a,comment:o,feedback_source:b,comparative_experiment_id:y,feedbackConfig:p,session_id:m},T=`${this.apiUrl}/feedback`,S=await this.caller.call(_getFetchImplementation(this.debug),T,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(E),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(S,"create feedback",!0),E}async updateFeedback(e,{score:r,value:n,correction:s,comment:a}){const o={};r!=null&&(o.score=_formatFeedbackScore(r)),n!=null&&(o.value=n),s!=null&&(o.correction=s),a!=null&&(o.comment=a),assertUuid(e);const l=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(l,"update feedback",!0)}async readFeedback(e){assertUuid(e);const r=`/feedback/${e}`;return await this._get(r)}async deleteFeedback(e){assertUuid(e);const r=`/feedback/${e}`,n=await this.caller.call(_getFetchImplementation(this.debug),this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(n,`delete ${r}`),await n.json()}async*listFeedback({runIds:e,feedbackKeys:r,feedbackSourceTypes:n}={}){const s=new URLSearchParams;if(e&&s.append("run",e.join(",")),r)for(const a of r)s.append("key",a);if(n)for(const a of n)s.append("source",a);for await(const a of this._getPaginated("/feedback",s))yield*a}async createPresignedFeedbackToken(e,r,{expiration:n,feedbackConfig:s}={}){const a={run_id:e,feedback_key:r,feedback_config:s};return n?typeof n=="string"?a.expires_at=n:(n!=null&&n.hours||n!=null&&n.minutes||n!=null&&n.days)&&(a.expires_in=n):a.expires_in={hours:3},await(await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async createComparativeExperiment({name:e,experimentIds:r,referenceDatasetId:n,createdAt:s,description:a,metadata:o,id:l}){var d;if(r.length===0)throw new Error("At least one experiment is required");if(n||(n=(await this.readProject({projectId:r[0]})).reference_dataset_id),!n==null)throw new Error("A reference dataset is required");const u={id:l,name:e,experiment_ids:r,reference_dataset_id:n,description:a,created_at:(d=s??new Date)==null?void 0:d.toISOString(),extra:{}};return o&&(u.extra.metadata=o),await(await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async*listPresignedFeedbackTokens(e){assertUuid(e);const r=new URLSearchParams({run_id:e});for await(const n of this._getPaginated("/feedback/tokens",r))yield*n}_selectEvalResults(e){let r;return"results"in e?r=e.results:Array.isArray(e)?r=e:r=[e],r}async _logEvaluationFeedback(e,r,n){const s=this._selectEvalResults(e),a=[];for(const o of s){let l=n||{};o.evaluatorInfo&&(l={...o.evaluatorInfo,...l});let u=null;o.targetRunId?u=o.targetRunId:r&&(u=r.id),a.push(await this.createFeedback(u,o.key,{score:o.score,value:o.value,comment:o.comment,correction:o.correction,sourceInfo:l,sourceRunId:o.sourceRunId,feedbackConfig:o.feedbackConfig,feedbackSourceType:"model"}))}return[s,a]}async logEvaluationFeedback(e,r,n){const[s]=await this._logEvaluationFeedback(e,r,n);return s}async*listAnnotationQueues(e={}){const{queueIds:r,name:n,nameContains:s,limit:a}=e,o=new URLSearchParams;r&&r.forEach((u,c)=>{assertUuid(u,`queueIds[${c}]`),o.append("ids",u)}),n&&o.append("name",n),s&&o.append("name_contains",s),o.append("limit",(a!==void 0?Math.min(a,100):100).toString());let l=0;for await(const u of this._getPaginated("/annotation-queues",o))if(yield*u,l++,a!==void 0&&l>=a)break}async createAnnotationQueue(e){const{name:r,description:n,queueId:s,rubricInstructions:a}=e,o={name:r,description:n,id:s||v4(),rubric_instructions:a},l=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(Object.entries(o).filter(([c,d])=>d!==void 0))),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(l,"create annotation queue"),await l.json()}async readAnnotationQueue(e){const r=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/annotation-queues/${assertUuid(e,"queueId")}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(r,"read annotation queue"),await r.json()}async updateAnnotationQueue(e,r){const{name:n,description:s,rubricInstructions:a}=r,o=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/annotation-queues/${assertUuid(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:n,description:s,rubric_instructions:a}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(o,"update annotation queue")}async deleteAnnotationQueue(e){const r=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/annotation-queues/${assertUuid(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(r,"delete annotation queue")}async addRunsToAnnotationQueue(e,r){const n=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/annotation-queues/${assertUuid(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(r.map((s,a)=>assertUuid(s,`runIds[${a}]`).toString())),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(n,"add runs to annotation queue")}async getRunFromAnnotationQueue(e,r){const n=`/annotation-queues/${assertUuid(e,"queueId")}/run`,s=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}${n}/${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(s,"get run from annotation queue"),await s.json()}async deleteRunFromAnnotationQueue(e,r){const n=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/annotation-queues/${assertUuid(e,"queueId")}/runs/${assertUuid(r,"queueRunId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(n,"delete run from annotation queue")}async getSizeFromAnnotationQueue(e){const r=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/annotation-queues/${assertUuid(e,"queueId")}/size`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(r,"get size from annotation queue"),await r.json()}async _currentTenantIsOwner(e){const r=await this._getSettings();return e=="-"||r.tenant_handle===e}async _ownerConflictError(e,r){const n=await this._getSettings();return new Error(`Cannot ${e} for another tenant.

      Current tenant: ${n.tenant_handle}

      Requested tenant: ${r}`)}async _getLatestCommitHash(e){const r=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),n=await r.json();if(!r.ok){const s=typeof n.detail=="string"?n.detail:JSON.stringify(n.detail),a=new Error(`Error ${r.status}: ${r.statusText}
${s}`);throw a.statusCode=r.status,a}if(n.commits.length!==0)return n.commits[0].commit_hash}async _likeOrUnlikePrompt(e,r){const[n,s,a]=parsePromptIdentifier(e),o=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/likes/${n}/${s}`,{method:"POST",body:JSON.stringify({like:r}),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(o,`${r?"like":"unlike"} prompt`),await o.json()}async _getPromptUrl(e){const[r,n,s]=parsePromptIdentifier(e);if(await this._currentTenantIsOwner(r)){const a=await this._getSettings();return s!=="latest"?`${this.getHostUrl()}/prompts/${n}/${s.substring(0,8)}?organizationId=${a.id}`:`${this.getHostUrl()}/prompts/${n}?organizationId=${a.id}`}else return s!=="latest"?`${this.getHostUrl()}/hub/${r}/${n}/${s.substring(0,8)}`:`${this.getHostUrl()}/hub/${r}/${n}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(const r of this._getPaginated(`/commits/${e}/`,new URLSearchParams,n=>n.commits))yield*r}async*listPrompts(e){const r=new URLSearchParams;r.append("sort_field",(e==null?void 0:e.sortField)??"updated_at"),r.append("sort_direction","desc"),r.append("is_archived",(!!(e!=null&&e.isArchived)).toString()),(e==null?void 0:e.isPublic)!==void 0&&r.append("is_public",e.isPublic.toString()),e!=null&&e.query&&r.append("query",e.query);for await(const n of this._getPaginated("/repos",r,s=>s.repos))yield*n}async getPrompt(e){const[r,n,s]=parsePromptIdentifier(e),a=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/repos/${r}/${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(a.status===404)return null;await raiseForStatus(a,"get prompt");const o=await a.json();return o.repo?o.repo:null}async createPrompt(e,r){const n=await this._getSettings();if(r!=null&&r.isPublic&&!n.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle. 
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);const[s,a,o]=parsePromptIdentifier(e);if(!await this._currentTenantIsOwner(s))throw await this._ownerConflictError("create a prompt",s);const l={repo_handle:a,...(r==null?void 0:r.description)&&{description:r.description},...(r==null?void 0:r.readme)&&{readme:r.readme},...(r==null?void 0:r.tags)&&{tags:r.tags},is_public:!!(r!=null&&r.isPublic)},u=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(u,"create prompt");const{repo:c}=await u.json();return c}async createCommit(e,r,n){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[s,a,o]=parsePromptIdentifier(e),l=(n==null?void 0:n.parentCommitHash)==="latest"||!(n!=null&&n.parentCommitHash)?await this._getLatestCommitHash(`${s}/${a}`):n==null?void 0:n.parentCommitHash,u={manifest:JSON.parse(JSON.stringify(r)),parent_commit:l},c=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/commits/${s}/${a}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(c,"create commit");const d=await c.json();return this._getPromptUrl(`${s}/${a}${d.commit_hash?`:${d.commit_hash}`:""}`)}async updateExamplesMultipart(e,r=[]){return this._updateExamplesMultipart(e,r)}async _updateExamplesMultipart(e,r=[]){var l;if(!await this._getMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");const n=new FormData;for(const u of r){const c=u.id,d={...u.metadata&&{metadata:u.metadata},...u.split&&{split:u.split}},p=serialize(d,`Serializing body for example with id: ${c}`),m=new Blob([p],{type:"application/json"});if(n.append(c,m),u.inputs){const y=serialize(u.inputs,`Serializing inputs for example with id: ${c}`),b=new Blob([y],{type:"application/json"});n.append(`${c}.inputs`,b)}if(u.outputs){const y=serialize(u.outputs,`Serializing outputs whle updating example with id: ${c}`),b=new Blob([y],{type:"application/json"});n.append(`${c}.outputs`,b)}if(u.attachments)for(const[y,b]of Object.entries(u.attachments)){let E,T;Array.isArray(b)?[E,T]=b:(E=b.mimeType,T=b.data);const S=new Blob([T],{type:`${E}; length=${T.byteLength}`});n.append(`${c}.attachment.${y}`,S)}if(u.attachments_operations){const y=serialize(u.attachments_operations,`Serializing attachments while updating example with id: ${c}`),b=new Blob([y],{type:"application/json"});n.append(`${c}.attachments_operations`,b)}}const s=e??((l=r[0])==null?void 0:l.dataset_id);return await(await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/v1/platform/datasets/${s}/examples`,{method:"PATCH",headers:this.headers,body:n})).json()}async uploadExamplesMultipart(e,r=[]){return this._uploadExamplesMultipart(e,r)}async _uploadExamplesMultipart(e,r=[]){if(!await this._getMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");const n=new FormData;for(const o of r){const l=(o.id??v4()).toString(),u={created_at:o.created_at,...o.metadata&&{metadata:o.metadata},...o.split&&{split:o.split},...o.source_run_id&&{source_run_id:o.source_run_id},...o.use_source_run_io&&{use_source_run_io:o.use_source_run_io},...o.use_source_run_attachments&&{use_source_run_attachments:o.use_source_run_attachments}},c=serialize(u,`Serializing body for uploaded example with id: ${l}`),d=new Blob([c],{type:"application/json"});if(n.append(l,d),o.inputs){const p=serialize(o.inputs,`Serializing inputs for uploaded example with id: ${l}`),m=new Blob([p],{type:"application/json"});n.append(`${l}.inputs`,m)}if(o.outputs){const p=serialize(o.outputs,`Serializing outputs for uploaded example with id: ${l}`),m=new Blob([p],{type:"application/json"});n.append(`${l}.outputs`,m)}if(o.attachments)for(const[p,m]of Object.entries(o.attachments)){let y,b;Array.isArray(m)?[y,b]=m:(y=m.mimeType,b=m.data);const E=new Blob([b],{type:`${y}; length=${b.byteLength}`});n.append(`${l}.attachment.${p}`,E)}}const s=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/v1/platform/datasets/${e}/examples`,{method:"POST",headers:this.headers,body:n});return await raiseForStatus(s,"upload examples"),await s.json()}async updatePrompt(e,r){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[n,s]=parsePromptIdentifier(e);if(!await this._currentTenantIsOwner(n))throw await this._ownerConflictError("update a prompt",n);const a={};if((r==null?void 0:r.description)!==void 0&&(a.description=r.description),(r==null?void 0:r.readme)!==void 0&&(a.readme=r.readme),(r==null?void 0:r.tags)!==void 0&&(a.tags=r.tags),(r==null?void 0:r.isPublic)!==void 0&&(a.is_public=r.isPublic),(r==null?void 0:r.isArchived)!==void 0&&(a.is_archived=r.isArchived),Object.keys(a).length===0)throw new Error("No valid update options provided");const o=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/repos/${n}/${s}`,{method:"PATCH",body:JSON.stringify(a),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await raiseForStatus(o,"update prompt"),o.json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[r,n,s]=parsePromptIdentifier(e);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("delete a prompt",r);return await(await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/repos/${r}/${n}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async pullPromptCommit(e,r){const[n,s,a]=parsePromptIdentifier(e),o=await this.caller.call(_getFetchImplementation(this.debug),`${this.apiUrl}/commits/${n}/${s}/${a}${r!=null&&r.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await raiseForStatus(o,"pull prompt commit");const l=await o.json();return{owner:n,repo:s,commit_hash:l.commit_hash,manifest:l.manifest,examples:l.examples}}async _pullPrompt(e,r){const n=await this.pullPromptCommit(e,{includeModel:r==null?void 0:r.includeModel});return JSON.stringify(n.manifest)}async pushPrompt(e,r){return await this.promptExists(e)?r&&Object.keys(r).some(s=>s!=="object")&&await this.updatePrompt(e,{description:r==null?void 0:r.description,readme:r==null?void 0:r.readme,tags:r==null?void 0:r.tags,isPublic:r==null?void 0:r.isPublic}):await this.createPrompt(e,{description:r==null?void 0:r.description,readme:r==null?void 0:r.readme,tags:r==null?void 0:r.tags,isPublic:r==null?void 0:r.isPublic}),r!=null&&r.object?await this.createCommit(e,r==null?void 0:r.object,{parentCommitHash:r==null?void 0:r.parentCommitHash}):await this._getPromptUrl(e)}async clonePublicDataset(e,r={}){const{sourceApiUrl:n=this.apiUrl,datasetName:s}=r,[a,o]=this.parseTokenOrUrl(e,n),l=new Client({apiUrl:a,apiKey:"placeholder"}),u=await l.readSharedDataset(o),c=s||u.name;try{if(await this.hasDataset({datasetId:c})){console.log(`Dataset ${c} already exists in your tenant. Skipping.`);return}}catch{}const d=await l.listSharedExamples(o),p=await this.createDataset(c,{description:u.description,dataType:u.data_type||"kv",inputsSchema:u.inputs_schema_definition??void 0,outputsSchema:u.outputs_schema_definition??void 0});try{await this.createExamples({inputs:d.map(m=>m.inputs),outputs:d.flatMap(m=>m.outputs?[m.outputs]:[]),datasetId:p.id})}catch(m){throw console.error(`An error occurred while creating dataset ${c}. You should delete it manually.`),m}}parseTokenOrUrl(e,r,n=2,s="dataset"){try{return assertUuid(e),[r,e]}catch{}try{const o=new URL(e).pathname.split("/").filter(l=>l!=="");if(o.length>=n){const l=o[o.length-n];return[r,l]}else throw new Error(`Invalid public ${s} URL: ${e}`)}catch{throw new Error(`Invalid public ${s} URL or token: ${e}`)}}awaitPendingTraceBatches(){return this.manualFlushMode?(console.warn("[WARNING]: When tracing in manual flush mode, you must call `await client.flush()` manually to submit trace batches."),Promise.resolve()):Promise.all([...this.autoBatchQueue.items.map(({itemPromise:e})=>e),this.batchIngestCaller.queue.onIdle()])}}function isExampleCreate(t){return"dataset_id"in t||"dataset_name"in t}const __version__="0.3.29";var define_process_env_default$2={};let globalEnv;const isBrowser$1=()=>typeof window<"u"&&typeof window.document<"u",isWebWorker$1=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",isJsDom$1=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),isDeno$1=()=>typeof Deno<"u",isNode$2=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!isDeno$1(),getEnv$2=()=>globalEnv||(isBrowser$1()?globalEnv="browser":isNode$2()?globalEnv="node":isWebWorker$1()?globalEnv="webworker":isJsDom$1()?globalEnv="jsdom":isDeno$1()?globalEnv="deno":globalEnv="other",globalEnv);let runtimeEnvironment$1;function getRuntimeEnvironment$1(){if(runtimeEnvironment$1===void 0){const t=getEnv$2(),e=getShas();runtimeEnvironment$1={library:"langsmith",runtime:t,sdk:"langsmith-js",sdk_version:__version__,...e}}return runtimeEnvironment$1}function getLangChainEnvVarsMetadata(){const t=getEnvironmentVariables()||{},e={},r=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION","LANGSMITH_API_KEY","LANGSMITH_ENDPOINT","LANGSMITH_TRACING_V2","LANGSMITH_PROJECT","LANGSMITH_SESSION"];for(const[n,s]of Object.entries(t))(n.startsWith("LANGCHAIN_")||n.startsWith("LANGSMITH_"))&&typeof s=="string"&&!r.includes(n)&&!n.toLowerCase().includes("key")&&!n.toLowerCase().includes("secret")&&!n.toLowerCase().includes("token")&&(n==="LANGCHAIN_REVISION_ID"?e.revision_id=s:e[n]=s);return e}function getEnvironmentVariables(){try{return typeof process<"u"&&define_process_env_default$2?Object.entries(define_process_env_default$2).reduce((t,[e,r])=>(t[e]=String(r),t),{}):void 0}catch{return}}function getEnvironmentVariable$1(t){try{return typeof process<"u"?define_process_env_default$2==null?void 0:define_process_env_default$2[t]:void 0}catch{return}}function getLangSmithEnvironmentVariable(t){return getEnvironmentVariable$1(`LANGSMITH_${t}`)||getEnvironmentVariable$1(`LANGCHAIN_${t}`)}let cachedCommitSHAs;function getShas(){if(cachedCommitSHAs!==void 0)return cachedCommitSHAs;const t=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const r of t){const n=getEnvironmentVariable$1(r);n!==void 0&&(e[r]=n)}return cachedCommitSHAs=e,e}const isTracingEnabled$1=t=>!!["TRACING_V2","TRACING"].find(r=>getLangSmithEnvironmentVariable(r)==="true"),_LC_CONTEXT_VARIABLES_KEY=Symbol.for("lc:context_variables");function stripNonAlphanumeric$1(t){return t.replace(/[-:.]/g,"")}function convertToDottedOrderFormat$1(t,e,r=1){const n=r.toFixed(0).slice(0,3).padStart(3,"0");return stripNonAlphanumeric$1(`${new Date(t).toISOString().slice(0,-1)}${n}Z`)+e}class Baggage{constructor(e,r,n){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=r,this.project_name=n}static fromHeader(e){const r=e.split(",");let n={},s=[],a;for(const o of r){const[l,u]=o.split("="),c=decodeURIComponent(u);l==="langsmith-metadata"?n=JSON.parse(c):l==="langsmith-tags"?s=c.split(","):l==="langsmith-project"&&(a=c)}return new Baggage(n,s,a)}toHeader(){const e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),this.project_name&&e.push(`langsmith-project=${encodeURIComponent(this.project_name)}`),e.join(",")}}class RunTree{constructor(e){var l;if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"attachments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),isRunTree(e)){Object.assign(this,{...e});return}const r=RunTree.getDefaultConfig(),{metadata:n,...s}=e,a=s.client??RunTree.getSharedClient(),o={...n,...(l=s==null?void 0:s.extra)==null?void 0:l.metadata};if(s.extra={...s.extra,metadata:o},Object.assign(this,{...r,...s,client:a}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.execution_order??(this.execution_order=1),this.child_execution_order??(this.child_execution_order=1),!this.dotted_order){const u=convertToDottedOrderFormat$1(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+u:this.dotted_order=u}}static getDefaultConfig(){return{id:v4(),run_type:"chain",project_name:getLangSmithEnvironmentVariable("PROJECT")??getEnvironmentVariable$1("LANGCHAIN_SESSION")??"default",child_runs:[],api_url:getEnvironmentVariable$1("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:getEnvironmentVariable$1("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}static getSharedClient(){return RunTree.sharedClient||(RunTree.sharedClient=new Client),RunTree.sharedClient}createChild(e){var u,c,d,p,m,y;const r=this.child_execution_order+1,n=new RunTree({...e,parent_run:this,project_name:this.project_name,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:r,child_execution_order:r});_LC_CONTEXT_VARIABLES_KEY in this&&(n[_LC_CONTEXT_VARIABLES_KEY]=this[_LC_CONTEXT_VARIABLES_KEY]);const s=Symbol.for("lc:child_config"),a=((u=e.extra)==null?void 0:u[s])??this.extra[s];if(isRunnableConfigLike(a)){const b={...a},E=isCallbackManagerLike(b.callbacks)?(d=(c=b.callbacks).copy)==null?void 0:d.call(c):void 0;E&&(Object.assign(E,{_parentRunId:n.id}),(y=(m=(p=E.handlers)==null?void 0:p.find(isLangChainTracerLike))==null?void 0:m.updateFromRunTree)==null||y.call(m,n),b.callbacks=E),n.extra[s]=b}const o=new Set;let l=this;for(;l!=null&&!o.has(l.id);)o.add(l.id),l.child_execution_order=Math.max(l.child_execution_order,r),l=l.parent_run;return this.child_runs.push(n),n}async end(e,r,n=Date.now(),s){this.outputs=this.outputs??e,this.error=this.error??r,this.end_time=this.end_time??n,s&&Object.keys(s).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...s}}:{metadata:s})}_convertToCreate(e,r,n=!0){var u;const s=e.extra??{};if(s.runtime||(s.runtime={}),r)for(const[c,d]of Object.entries(r))s.runtime[c]||(s.runtime[c]=d);let a,o;return n?(o=(u=e.parent_run)==null?void 0:u.id,a=[]):(a=e.child_runs.map(c=>this._convertToCreate(c,r,n)),o=void 0),{id:e.id,name:e.name,start_time:e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:s,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:a,parent_run_id:o,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags,attachments:e.attachments}}async postRun(e=!0){try{const r=getRuntimeEnvironment$1(),n=await this._convertToCreate(this,r,!0);if(await this.client.createRun(n),!e){warnOnce("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const s of this.child_runs)await s.postRun(!1)}}catch(r){console.error(`Error in postRun for run ${this.id}:`,r)}}async patchRun(){var e;try{const r={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:(e=this.parent_run)==null?void 0:e.id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags,attachments:this.attachments,session_name:this.project_name};await this.client.updateRun(this.id,r)}catch(r){console.error(`Error in patchRun for run ${this.id}`,r)}}toJSON(){return this._convertToCreate(this,void 0,!1)}addEvent(e){this.events||(this.events=[]),typeof e=="string"?this.events.push({name:"event",time:new Date().toISOString(),message:e}):this.events.push({...e,time:e.time??new Date().toISOString()})}static fromRunnableConfig(e,r){var c,d,p,m;const n=e==null?void 0:e.callbacks;let s,a,o,l=isTracingEnabled$1();if(n){const y=((c=n==null?void 0:n.getParentRunId)==null?void 0:c.call(n))??"",b=(d=n==null?void 0:n.handlers)==null?void 0:d.find(E=>(E==null?void 0:E.name)=="langchain_tracer");s=(p=b==null?void 0:b.getRun)==null?void 0:p.call(b,y),a=b==null?void 0:b.projectName,o=b==null?void 0:b.client,l=l||!!b}return s?new RunTree({name:s.name,id:s.id,trace_id:s.trace_id,dotted_order:s.dotted_order,client:o,tracingEnabled:l,project_name:a,tags:[...new Set(((s==null?void 0:s.tags)??[]).concat((e==null?void 0:e.tags)??[]))],extra:{metadata:{...(m=s==null?void 0:s.extra)==null?void 0:m.metadata,...e==null?void 0:e.metadata}}}).createChild(r):new RunTree({...r,client:o,tracingEnabled:l,project_name:a})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,r){var c;const n="get"in e&&typeof e.get=="function"?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,s=n["langsmith-trace"];if(!s||typeof s!="string")return;const a=s.trim(),o=a.split(".").map(d=>{const[p,m]=d.split("Z");return{strTime:p,time:Date.parse(p+"Z"),uuid:m}}),l=o[0].uuid,u={...r,name:(r==null?void 0:r.name)??"parent",run_type:(r==null?void 0:r.run_type)??"chain",start_time:(r==null?void 0:r.start_time)??Date.now(),id:(c=o.at(-1))==null?void 0:c.uuid,trace_id:l,dotted_order:a};if(n.baggage&&typeof n.baggage=="string"){const d=Baggage.fromHeader(n.baggage);u.metadata=d.metadata,u.tags=d.tags,u.project_name=d.project_name}return new RunTree(u)}toHeaders(e){var n;const r={"langsmith-trace":this.dotted_order,baggage:new Baggage((n=this.extra)==null?void 0:n.metadata,this.tags,this.project_name).toHeader()};if(e)for(const[s,a]of Object.entries(r))e.set(s,a);return r}}Object.defineProperty(RunTree,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});function isRunTree(t){return t!==void 0&&typeof t.createChild=="function"&&typeof t.postRun=="function"}function isLangChainTracerLike(t){return typeof t=="object"&&t!=null&&typeof t.name=="string"&&t.name==="langchain_tracer"}function containsLangChainTracerLike(t){return Array.isArray(t)&&t.some(e=>isLangChainTracerLike(e))}function isCallbackManagerLike(t){return typeof t=="object"&&t!=null&&Array.isArray(t.handlers)}function isRunnableConfigLike(t){var e;return t!==void 0&&typeof t.callbacks=="object"&&(containsLangChainTracerLike((e=t.callbacks)==null?void 0:e.handlers)||containsLangChainTracerLike(t.callbacks))}let MockAsyncLocalStorage$1=class{getStore(){}run(e,r){return r()}};const TRACING_ALS_KEY$1=Symbol.for("ls:tracing_async_local_storage"),mockAsyncLocalStorage$1=new MockAsyncLocalStorage$1;let AsyncLocalStorageProvider$1=class{getInstance(){return globalThis[TRACING_ALS_KEY$1]??mockAsyncLocalStorage$1}initializeGlobalInstance(e){globalThis[TRACING_ALS_KEY$1]===void 0&&(globalThis[TRACING_ALS_KEY$1]=e)}};const AsyncLocalStorageProviderSingleton$1=new AsyncLocalStorageProvider$1;function getCurrentRunTree(t=!1){const e=AsyncLocalStorageProviderSingleton$1.getInstance().getStore();if(!t&&!isRunTree(e))throw new Error(`Could not get the current run tree.

Please make sure you are calling this method within a traceable function and that tracing is enabled.`);return e}function isTraceableFunction(t){return typeof t=="function"&&"langsmith:traceable"in t}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */const _hasOwnProperty=Object.prototype.hasOwnProperty;function hasOwnProperty(t,e){return _hasOwnProperty.call(t,e)}function _objectKeys(t){if(Array.isArray(t)){const r=new Array(t.length);for(let n=0;n<r.length;n++)r[n]=""+n;return r}if(Object.keys)return Object.keys(t);let e=[];for(let r in t)hasOwnProperty(t,r)&&e.push(r);return e}function _deepClone(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function isInteger(t){let e=0;const r=t.length;let n;for(;e<r;){if(n=t.charCodeAt(e),n>=48&&n<=57){e++;continue}return!1}return!0}function escapePathComponent(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function unescapePathComponent(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function hasUndefined(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(hasUndefined(t[r]))return!0}else if(typeof t=="object"){const r=_objectKeys(t),n=r.length;for(var e=0;e<n;e++)if(hasUndefined(t[r[e]]))return!0}}return!1}function patchErrorMessageFormatter(t,e){const r=[t];for(const n in e){const s=typeof e[n]=="object"?JSON.stringify(e[n],null,2):e[n];typeof s<"u"&&r.push(`${n}: ${s}`)}return r.join(`
`)}class PatchError extends Error{constructor(e,r,n,s,a){super(patchErrorMessageFormatter(e,{name:r,index:n,operation:s,tree:a})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.setPrototypeOf(this,new.target.prototype),this.message=patchErrorMessageFormatter(e,{name:r,index:n,operation:s,tree:a})}}const JsonPatchError=PatchError,objOps={add:function(t,e,r){return t[e]=this.value,{newDocument:r}},remove:function(t,e,r){var n=t[e];return delete t[e],{newDocument:r,removed:n}},replace:function(t,e,r){var n=t[e];return t[e]=this.value,{newDocument:r,removed:n}},move:function(t,e,r){let n=getValueByPointer(r,this.path);n&&(n=_deepClone(n));const s=applyOperation(r,{op:"remove",path:this.from}).removed;return applyOperation(r,{op:"add",path:this.path,value:s}),{newDocument:r,removed:n}},copy:function(t,e,r){const n=getValueByPointer(r,this.from);return applyOperation(r,{op:"add",path:this.path,value:_deepClone(n)}),{newDocument:r}},test:function(t,e,r){return{newDocument:r,test:_areEquals(t[e],this.value)}},_get:function(t,e,r){return this.value=t[e],{newDocument:r}}};var arrOps={add:function(t,e,r){return isInteger(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:r,index:e}},remove:function(t,e,r){var n=t.splice(e,1);return{newDocument:r,removed:n[0]}},replace:function(t,e,r){var n=t[e];return t[e]=this.value,{newDocument:r,removed:n}},move:objOps.move,copy:objOps.copy,test:objOps.test,_get:objOps._get};function getValueByPointer(t,e){if(e=="")return t;var r={op:"_get",path:e};return applyOperation(t,r),r.value}function applyOperation(t,e,r=!1,n=!0,s=!0,a=0){if(r&&(typeof r=="function"?r(e,0,t,e.path):validator(e,0)),e.path===""){let o={newDocument:t};if(e.op==="add")return o.newDocument=e.value,o;if(e.op==="replace")return o.newDocument=e.value,o.removed=t,o;if(e.op==="move"||e.op==="copy")return o.newDocument=getValueByPointer(t,e.from),e.op==="move"&&(o.removed=t),o;if(e.op==="test"){if(o.test=_areEquals(t,e.value),o.test===!1)throw new JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return o.newDocument=t,o}else{if(e.op==="remove")return o.removed=t,o.newDocument=null,o;if(e.op==="_get")return e.value=t,o;if(r)throw new JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,e,t);return o}}else{n||(t=_deepClone(t));const l=(e.path||"").split("/");let u=t,c=1,d=l.length,p,m,y;for(typeof r=="function"?y=r:y=validator;;){if(m=l[c],m&&m.indexOf("~")!=-1&&(m=unescapePathComponent(m)),s&&(m=="__proto__"||m=="prototype"&&c>0&&l[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(r&&p===void 0&&(u[m]===void 0?p=l.slice(0,c).join("/"):c==d-1&&(p=e.path),p!==void 0&&y(e,0,t,p)),c++,Array.isArray(u)){if(m==="-")m=u.length;else{if(r&&!isInteger(m))throw new JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,e,t);isInteger(m)&&(m=~~m)}if(c>=d){if(r&&e.op==="add"&&m>u.length)throw new JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,e,t);const b=arrOps[e.op].call(e,u,m,t);if(b.test===!1)throw new JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return b}}else if(c>=d){const b=objOps[e.op].call(e,u,m,t);if(b.test===!1)throw new JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return b}if(u=u[m],r&&c<d&&(!u||typeof u!="object"))throw new JsonPatchError("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,e,t)}}}function applyPatch(t,e,r,n=!0,s=!0){if(r&&!Array.isArray(e))throw new JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(t=_deepClone(t));const a=new Array(e.length);for(let o=0,l=e.length;o<l;o++)a[o]=applyOperation(t,e[o],r,!0,s,o),t=a[o].newDocument;return a.newDocument=t,a}function validator(t,e,r,n){if(typeof t!="object"||t===null||Array.isArray(t))throw new JsonPatchError("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,r);if(objOps[t.op]){if(typeof t.path!="string")throw new JsonPatchError("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,r);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new JsonPatchError('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,r);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new JsonPatchError("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,r);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,r);if((t.op==="add"||t.op==="replace"||t.op==="test")&&hasUndefined(t.value))throw new JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,r);if(r){if(t.op=="add"){var s=t.path.split("/").length,a=n.split("/").length;if(s!==a+1&&s!==a)throw new JsonPatchError("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,r)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==n)throw new JsonPatchError("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,r)}else if(t.op==="move"||t.op==="copy"){var o={op:"_get",path:t.from,value:void 0},l=validate([o],r);if(l&&l.name==="OPERATION_PATH_UNRESOLVABLE")throw new JsonPatchError("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,r)}}}else throw new JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,r)}function validate(t,e,r){try{if(!Array.isArray(t))throw new JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)applyPatch(_deepClone(e),_deepClone(t),r||!0);else{r=r||validator;for(var n=0;n<t.length;n++)r(t[n],n,e,void 0)}}catch(s){if(s instanceof JsonPatchError)return s;throw s}}function _areEquals(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var r=Array.isArray(t),n=Array.isArray(e),s,a,o;if(r&&n){if(a=t.length,a!=e.length)return!1;for(s=a;s--!==0;)if(!_areEquals(t[s],e[s]))return!1;return!0}if(r!=n)return!1;var l=Object.keys(t);if(a=l.length,a!==Object.keys(e).length)return!1;for(s=a;s--!==0;)if(!e.hasOwnProperty(l[s]))return!1;for(s=a;s--!==0;)if(o=l[s],!_areEquals(t[o],e[o]))return!1;return!0}return t!==t&&e!==e}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2013-2021 Joachim Wester
 * MIT license
 */function _generate(t,e,r,n,s){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var a=_objectKeys(e),o=_objectKeys(t),l=!1,u=o.length-1;u>=0;u--){var c=o[u],d=t[c];if(hasOwnProperty(e,c)&&!(e[c]===void 0&&d!==void 0&&Array.isArray(e)===!1)){var p=e[c];typeof d=="object"&&d!=null&&typeof p=="object"&&p!=null&&Array.isArray(d)===Array.isArray(p)?_generate(d,p,r,n+"/"+escapePathComponent(c),s):d!==p&&(s&&r.push({op:"test",path:n+"/"+escapePathComponent(c),value:_deepClone(d)}),r.push({op:"replace",path:n+"/"+escapePathComponent(c),value:_deepClone(p)}))}else Array.isArray(t)===Array.isArray(e)?(s&&r.push({op:"test",path:n+"/"+escapePathComponent(c),value:_deepClone(d)}),r.push({op:"remove",path:n+"/"+escapePathComponent(c)}),l=!0):(s&&r.push({op:"test",path:n,value:t}),r.push({op:"replace",path:n,value:e}))}if(!(!l&&a.length==o.length))for(var u=0;u<a.length;u++){var c=a[u];!hasOwnProperty(t,c)&&e[c]!==void 0&&r.push({op:"add",path:n+"/"+escapePathComponent(c),value:_deepClone(e[c])})}}}function compare(t,e,r=!1){var n=[];return _generate(t,e,n,"",r),n}var define_process_env_default$1={};const isBrowser=()=>typeof window<"u"&&typeof window.document<"u",isWebWorker=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",isJsDom=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),isDeno=()=>typeof Deno<"u",isNode$1=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!isDeno(),getEnv$1=()=>{let t;return isBrowser()?t="browser":isNode$1()?t="node":isWebWorker()?t="webworker":isJsDom()?t="jsdom":isDeno()?t="deno":t="other",t};let runtimeEnvironment;async function getRuntimeEnvironment(){return runtimeEnvironment===void 0&&(runtimeEnvironment={library:"langchain-js",runtime:getEnv$1()}),runtimeEnvironment}function getEnvironmentVariable(t){try{return typeof process<"u"?define_process_env_default$1==null?void 0:define_process_env_default$1[t]:isDeno()?Deno==null?void 0:Deno.env.get(t):void 0}catch{return}}class BaseCallbackHandlerMethodsClass{}function callbackHandlerPrefersStreaming(t){return"lc_prefer_streaming"in t&&t.lc_prefer_streaming}class BaseCallbackHandler extends BaseCallbackHandlerMethodsClass{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,get_lc_unique_name(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:getEnvironmentVariable("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return Serializable.prototype.toJSON.call(this)}toJSONNotImplemented(){return Serializable.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class r extends BaseCallbackHandler{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:v4()}),Object.assign(this,e)}}return new r}}const isBaseCallbackHandler=t=>{const e=t;return e!==void 0&&typeof e.copy=="function"&&typeof e.name=="string"&&typeof e.awaitHandlers=="boolean"};function _coerceToDict$1(t,e){return t&&!Array.isArray(t)&&typeof t=="object"?t:{[e]:t}}function stripNonAlphanumeric(t){return t.replace(/[-:.]/g,"")}function convertToDottedOrderFormat(t,e,r){const n=r.toFixed(0).slice(0,3).padStart(3,"0");return stripNonAlphanumeric(`${new Date(t).toISOString().slice(0,-1)}${n}Z`)+e}function isBaseTracer(t){return typeof t._addRunToRunMap=="function"}class BaseTracer extends BaseCallbackHandler{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}stringifyError(e){return e instanceof Error?e.message+(e!=null&&e.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,r){e.child_runs.push(r)}_addRunToRunMap(e){const r=convertToDottedOrderFormat(e.start_time,e.id,e.execution_order),n={...e};if(n.parent_run_id!==void 0){const s=this.runMap.get(n.parent_run_id);s&&(this._addChildRun(s,n),s.child_execution_order=Math.max(s.child_execution_order,n.child_execution_order),n.trace_id=s.trace_id,s.dotted_order!==void 0&&(n.dotted_order=[s.dotted_order,r].join(".")))}else n.trace_id=n.id,n.dotted_order=r;return this.runMap.set(n.id,n),n}async _endTrace(e){var n;const r=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);r?r.child_execution_order=Math.max(r.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id),await((n=this.onRunUpdate)==null?void 0:n.call(this,e))}_getExecutionOrder(e){const r=e!==void 0&&this.runMap.get(e);return r?r.child_execution_order+1:1}_createRunForLLMStart(e,r,n,s,a,o,l,u){const c=this._getExecutionOrder(s),d=Date.now(),p=l?{...a,metadata:l}:a,m={id:n,name:u??e.id[e.id.length-1],parent_run_id:s,start_time:d,serialized:e,events:[{name:"start",time:new Date(d).toISOString()}],inputs:{prompts:r},execution_order:c,child_runs:[],child_execution_order:c,run_type:"llm",extra:p??{},tags:o||[]};return this._addRunToRunMap(m)}async handleLLMStart(e,r,n,s,a,o,l,u){var d,p;const c=this.runMap.get(n)??this._createRunForLLMStart(e,r,n,s,a,o,l,u);return await((d=this.onRunCreate)==null?void 0:d.call(this,c)),await((p=this.onLLMStart)==null?void 0:p.call(this,c)),c}_createRunForChatModelStart(e,r,n,s,a,o,l,u){const c=this._getExecutionOrder(s),d=Date.now(),p=l?{...a,metadata:l}:a,m={id:n,name:u??e.id[e.id.length-1],parent_run_id:s,start_time:d,serialized:e,events:[{name:"start",time:new Date(d).toISOString()}],inputs:{messages:r},execution_order:c,child_runs:[],child_execution_order:c,run_type:"llm",extra:p??{},tags:o||[]};return this._addRunToRunMap(m)}async handleChatModelStart(e,r,n,s,a,o,l,u){var d,p;const c=this.runMap.get(n)??this._createRunForChatModelStart(e,r,n,s,a,o,l,u);return await((d=this.onRunCreate)==null?void 0:d.call(this,c)),await((p=this.onLLMStart)==null?void 0:p.call(this,c)),c}async handleLLMEnd(e,r,n,s,a){var l;const o=this.runMap.get(r);if(!o||(o==null?void 0:o.run_type)!=="llm")throw new Error("No LLM run to end.");return o.end_time=Date.now(),o.outputs=e,o.events.push({name:"end",time:new Date(o.end_time).toISOString()}),o.extra={...o.extra,...a},await((l=this.onLLMEnd)==null?void 0:l.call(this,o)),await this._endTrace(o),o}async handleLLMError(e,r,n,s,a){var l;const o=this.runMap.get(r);if(!o||(o==null?void 0:o.run_type)!=="llm")throw new Error("No LLM run to end.");return o.end_time=Date.now(),o.error=this.stringifyError(e),o.events.push({name:"error",time:new Date(o.end_time).toISOString()}),o.extra={...o.extra,...a},await((l=this.onLLMError)==null?void 0:l.call(this,o)),await this._endTrace(o),o}_createRunForChainStart(e,r,n,s,a,o,l,u){const c=this._getExecutionOrder(s),d=Date.now(),p={id:n,name:u??e.id[e.id.length-1],parent_run_id:s,start_time:d,serialized:e,events:[{name:"start",time:new Date(d).toISOString()}],inputs:r,execution_order:c,child_execution_order:c,run_type:l??"chain",child_runs:[],extra:o?{metadata:o}:{},tags:a||[]};return this._addRunToRunMap(p)}async handleChainStart(e,r,n,s,a,o,l,u){var d,p;const c=this.runMap.get(n)??this._createRunForChainStart(e,r,n,s,a,o,l,u);return await((d=this.onRunCreate)==null?void 0:d.call(this,c)),await((p=this.onChainStart)==null?void 0:p.call(this,c)),c}async handleChainEnd(e,r,n,s,a){var l;const o=this.runMap.get(r);if(!o)throw new Error("No chain run to end.");return o.end_time=Date.now(),o.outputs=_coerceToDict$1(e,"output"),o.events.push({name:"end",time:new Date(o.end_time).toISOString()}),(a==null?void 0:a.inputs)!==void 0&&(o.inputs=_coerceToDict$1(a.inputs,"input")),await((l=this.onChainEnd)==null?void 0:l.call(this,o)),await this._endTrace(o),o}async handleChainError(e,r,n,s,a){var l;const o=this.runMap.get(r);if(!o)throw new Error("No chain run to end.");return o.end_time=Date.now(),o.error=this.stringifyError(e),o.events.push({name:"error",time:new Date(o.end_time).toISOString()}),(a==null?void 0:a.inputs)!==void 0&&(o.inputs=_coerceToDict$1(a.inputs,"input")),await((l=this.onChainError)==null?void 0:l.call(this,o)),await this._endTrace(o),o}_createRunForToolStart(e,r,n,s,a,o,l){const u=this._getExecutionOrder(s),c=Date.now(),d={id:n,name:l??e.id[e.id.length-1],parent_run_id:s,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{input:r},execution_order:u,child_execution_order:u,run_type:"tool",child_runs:[],extra:o?{metadata:o}:{},tags:a||[]};return this._addRunToRunMap(d)}async handleToolStart(e,r,n,s,a,o,l){var c,d;const u=this.runMap.get(n)??this._createRunForToolStart(e,r,n,s,a,o,l);return await((c=this.onRunCreate)==null?void 0:c.call(this,u)),await((d=this.onToolStart)==null?void 0:d.call(this,u)),u}async handleToolEnd(e,r){var s;const n=this.runMap.get(r);if(!n||(n==null?void 0:n.run_type)!=="tool")throw new Error("No tool run to end");return n.end_time=Date.now(),n.outputs={output:e},n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await((s=this.onToolEnd)==null?void 0:s.call(this,n)),await this._endTrace(n),n}async handleToolError(e,r){var s;const n=this.runMap.get(r);if(!n||(n==null?void 0:n.run_type)!=="tool")throw new Error("No tool run to end");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await((s=this.onToolError)==null?void 0:s.call(this,n)),await this._endTrace(n),n}async handleAgentAction(e,r){var a;const n=this.runMap.get(r);if(!n||(n==null?void 0:n.run_type)!=="chain")return;const s=n;s.actions=s.actions||[],s.actions.push(e),s.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await((a=this.onAgentAction)==null?void 0:a.call(this,n))}async handleAgentEnd(e,r){var s;const n=this.runMap.get(r);!n||(n==null?void 0:n.run_type)!=="chain"||(n.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await((s=this.onAgentEnd)==null?void 0:s.call(this,n)))}_createRunForRetrieverStart(e,r,n,s,a,o,l){const u=this._getExecutionOrder(s),c=Date.now(),d={id:n,name:l??e.id[e.id.length-1],parent_run_id:s,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{query:r},execution_order:u,child_execution_order:u,run_type:"retriever",child_runs:[],extra:o?{metadata:o}:{},tags:a||[]};return this._addRunToRunMap(d)}async handleRetrieverStart(e,r,n,s,a,o,l){var c,d;const u=this.runMap.get(n)??this._createRunForRetrieverStart(e,r,n,s,a,o,l);return await((c=this.onRunCreate)==null?void 0:c.call(this,u)),await((d=this.onRetrieverStart)==null?void 0:d.call(this,u)),u}async handleRetrieverEnd(e,r){var s;const n=this.runMap.get(r);if(!n||(n==null?void 0:n.run_type)!=="retriever")throw new Error("No retriever run to end");return n.end_time=Date.now(),n.outputs={documents:e},n.events.push({name:"end",time:new Date(n.end_time).toISOString()}),await((s=this.onRetrieverEnd)==null?void 0:s.call(this,n)),await this._endTrace(n),n}async handleRetrieverError(e,r){var s;const n=this.runMap.get(r);if(!n||(n==null?void 0:n.run_type)!=="retriever")throw new Error("No retriever run to end");return n.end_time=Date.now(),n.error=this.stringifyError(e),n.events.push({name:"error",time:new Date(n.end_time).toISOString()}),await((s=this.onRetrieverError)==null?void 0:s.call(this,n)),await this._endTrace(n),n}async handleText(e,r){var s;const n=this.runMap.get(r);!n||(n==null?void 0:n.run_type)!=="chain"||(n.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await((s=this.onText)==null?void 0:s.call(this,n)))}async handleLLMNewToken(e,r,n,s,a,o){var u;const l=this.runMap.get(n);if(!l||(l==null?void 0:l.run_type)!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return l.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:r,chunk:o==null?void 0:o.chunk}}),await((u=this.onLLMNewToken)==null?void 0:u.call(this,l,e,{chunk:o==null?void 0:o.chunk})),l}}var ansiStyles={exports:{}};ansiStyles.exports;var hasRequiredAnsiStyles;function requireAnsiStyles(){return hasRequiredAnsiStyles||(hasRequiredAnsiStyles=1,function(t){const r=(a=0)=>o=>`\x1B[${38+a};5;${o}m`,n=(a=0)=>(o,l,u)=>`\x1B[${38+a};2;${o};${l};${u}m`;function s(){const a=new Map,o={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};o.color.gray=o.color.blackBright,o.bgColor.bgGray=o.bgColor.bgBlackBright,o.color.grey=o.color.blackBright,o.bgColor.bgGrey=o.bgColor.bgBlackBright;for(const[l,u]of Object.entries(o)){for(const[c,d]of Object.entries(u))o[c]={open:`\x1B[${d[0]}m`,close:`\x1B[${d[1]}m`},u[c]=o[c],a.set(d[0],d[1]);Object.defineProperty(o,l,{value:u,enumerable:!1})}return Object.defineProperty(o,"codes",{value:a,enumerable:!1}),o.color.close="\x1B[39m",o.bgColor.close="\x1B[49m",o.color.ansi256=r(),o.color.ansi16m=n(),o.bgColor.ansi256=r(10),o.bgColor.ansi16m=n(10),Object.defineProperties(o,{rgbToAnsi256:{value:(l,u,c)=>l===u&&u===c?l<8?16:l>248?231:Math.round((l-8)/247*24)+232:16+36*Math.round(l/255*5)+6*Math.round(u/255*5)+Math.round(c/255*5),enumerable:!1},hexToRgb:{value:l=>{const u=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(l.toString(16));if(!u)return[0,0,0];let{colorString:c}=u.groups;c.length===3&&(c=c.split("").map(p=>p+p).join(""));const d=Number.parseInt(c,16);return[d>>16&255,d>>8&255,d&255]},enumerable:!1},hexToAnsi256:{value:l=>o.rgbToAnsi256(...o.hexToRgb(l)),enumerable:!1}}),o}Object.defineProperty(t,"exports",{enumerable:!0,get:s})}(ansiStyles)),ansiStyles.exports}var ansiStylesExports=requireAnsiStyles();const styles=getDefaultExportFromCjs(ansiStylesExports);function wrap(t,e){return`${t.open}${e}${t.close}`}function tryJsonStringify(t,e){try{return JSON.stringify(t,null,2)}catch{return e}}function formatKVMapItem(t){return typeof t=="string"?t.trim():t==null?t:tryJsonStringify(t,t.toString())}function elapsed(t){if(!t.end_time)return"";const e=t.end_time-t.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color}=styles;class ConsoleCallbackHandler extends BaseTracer{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const r=[];let n=e;for(;n.parent_run_id;){const s=this.runMap.get(n.parent_run_id);if(s)r.push(s),n=s;else break}return r}getBreadcrumbs(e){const n=[...this.getParents(e).reverse(),e].map((s,a,o)=>{const l=`${s.execution_order}:${s.run_type}:${s.name}`;return a===o.length-1?wrap(styles.bold,l):l}).join(" > ");return wrap(color.grey,n)}onChainStart(e){const r=this.getBreadcrumbs(e);console.log(`${wrap(color.green,"[chain/start]")} [${r}] Entering Chain run with input: ${tryJsonStringify(e.inputs,"[inputs]")}`)}onChainEnd(e){const r=this.getBreadcrumbs(e);console.log(`${wrap(color.cyan,"[chain/end]")} [${r}] [${elapsed(e)}] Exiting Chain run with output: ${tryJsonStringify(e.outputs,"[outputs]")}`)}onChainError(e){const r=this.getBreadcrumbs(e);console.log(`${wrap(color.red,"[chain/error]")} [${r}] [${elapsed(e)}] Chain run errored with error: ${tryJsonStringify(e.error,"[error]")}`)}onLLMStart(e){const r=this.getBreadcrumbs(e),n="prompts"in e.inputs?{prompts:e.inputs.prompts.map(s=>s.trim())}:e.inputs;console.log(`${wrap(color.green,"[llm/start]")} [${r}] Entering LLM run with input: ${tryJsonStringify(n,"[inputs]")}`)}onLLMEnd(e){const r=this.getBreadcrumbs(e);console.log(`${wrap(color.cyan,"[llm/end]")} [${r}] [${elapsed(e)}] Exiting LLM run with output: ${tryJsonStringify(e.outputs,"[response]")}`)}onLLMError(e){const r=this.getBreadcrumbs(e);console.log(`${wrap(color.red,"[llm/error]")} [${r}] [${elapsed(e)}] LLM run errored with error: ${tryJsonStringify(e.error,"[error]")}`)}onToolStart(e){const r=this.getBreadcrumbs(e);console.log(`${wrap(color.green,"[tool/start]")} [${r}] Entering Tool run with input: "${formatKVMapItem(e.inputs.input)}"`)}onToolEnd(e){var n;const r=this.getBreadcrumbs(e);console.log(`${wrap(color.cyan,"[tool/end]")} [${r}] [${elapsed(e)}] Exiting Tool run with output: "${formatKVMapItem((n=e.outputs)==null?void 0:n.output)}"`)}onToolError(e){const r=this.getBreadcrumbs(e);console.log(`${wrap(color.red,"[tool/error]")} [${r}] [${elapsed(e)}] Tool run errored with error: ${tryJsonStringify(e.error,"[error]")}`)}onRetrieverStart(e){const r=this.getBreadcrumbs(e);console.log(`${wrap(color.green,"[retriever/start]")} [${r}] Entering Retriever run with input: ${tryJsonStringify(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const r=this.getBreadcrumbs(e);console.log(`${wrap(color.cyan,"[retriever/end]")} [${r}] [${elapsed(e)}] Exiting Retriever run with output: ${tryJsonStringify(e.outputs,"[outputs]")}`)}onRetrieverError(e){const r=this.getBreadcrumbs(e);console.log(`${wrap(color.red,"[retriever/error]")} [${r}] [${elapsed(e)}] Retriever run errored with error: ${tryJsonStringify(e.error,"[error]")}`)}onAgentAction(e){const r=e,n=this.getBreadcrumbs(e);console.log(`${wrap(color.blue,"[agent/action]")} [${n}] Agent selected action: ${tryJsonStringify(r.actions[r.actions.length-1],"[action]")}`)}}let client;const getDefaultLangChainClientSingleton=()=>{if(client===void 0){const t=getEnvironmentVariable("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"?{blockOnRootRunFinalization:!0}:{};client=new Client(t)}return client};class LangChainTracer extends BaseTracer{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:r,projectName:n,client:s}=e;this.projectName=n??getEnvironmentVariable("LANGCHAIN_PROJECT")??getEnvironmentVariable("LANGCHAIN_SESSION"),this.exampleId=r,this.client=s??getDefaultLangChainClientSingleton();const a=LangChainTracer.getTraceableRunTree();a&&this.updateFromRunTree(a)}async _convertToCreate(e,r=void 0){return{...e,extra:{...e.extra,runtime:await getRuntimeEnvironment()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:r}}async persistRun(e){}async onRunCreate(e){const r=await this._convertToCreate(e,this.exampleId);await this.client.createRun(r)}async onRunUpdate(e){const r={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs,trace_id:e.trace_id,dotted_order:e.dotted_order,parent_run_id:e.parent_run_id,extra:e.extra,session_name:this.projectName};await this.client.updateRun(e.id,r)}getRun(e){return this.runMap.get(e)}updateFromRunTree(e){let r=e;const n=new Set;for(;r.parent_run&&!(n.has(r.id)||(n.add(r.id),!r.parent_run));)r=r.parent_run;n.clear();const s=[r];for(;s.length>0;){const a=s.shift();!a||n.has(a.id)||(n.add(a.id),this.runMap.set(a.id,a),a.child_runs&&s.push(...a.child_runs))}this.client=e.client??this.client,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}convertToRunTree(e){const r={},n=[];for(const[s,a]of this.runMap){const o=new RunTree({...a,child_runs:[],parent_run:void 0,client:this.client,project_name:this.projectName,reference_example_id:this.exampleId,tracingEnabled:!0});r[s]=o,n.push([s,a.dotted_order])}n.sort((s,a)=>!s[1]||!a[1]?0:s[1].localeCompare(a[1]));for(const[s]of n){const a=this.runMap.get(s),o=r[s];if(!(!a||!o)&&a.parent_run_id){const l=r[a.parent_run_id];l&&(l.child_runs.push(o),o.parent_run=l)}}return r[e]}static getTraceableRunTree(){try{return getCurrentRunTree(!0)}catch{return}}}const TRACING_ALS_KEY=Symbol.for("ls:tracing_async_local_storage"),_CONTEXT_VARIABLES_KEY=Symbol.for("lc:context_variables"),setGlobalAsyncLocalStorageInstance=t=>{globalThis[TRACING_ALS_KEY]=t},getGlobalAsyncLocalStorageInstance=()=>globalThis[TRACING_ALS_KEY];let queue;function createQueue(){const t="default"in PQueueMod?PQueueMod.default:PQueueMod;return new t({autoStart:!0,concurrency:1})}function getQueue(){return typeof queue>"u"&&(queue=createQueue()),queue}async function consumeCallback(t,e){if(e===!0){const r=getGlobalAsyncLocalStorageInstance();r!==void 0?await r.run(void 0,async()=>t()):await t()}else queue=getQueue(),queue.add(async()=>{const r=getGlobalAsyncLocalStorageInstance();r!==void 0?await r.run(void 0,async()=>t()):await t()})}const isTracingEnabled=t=>!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(r=>getEnvironmentVariable(r)==="true");function getContextVariable(t){var n;const e=getGlobalAsyncLocalStorageInstance();if(e===void 0)return;const r=e.getStore();return(n=r==null?void 0:r[_CONTEXT_VARIABLES_KEY])==null?void 0:n[t]}const LC_CONFIGURE_HOOKS_KEY=Symbol("lc:configure_hooks"),_getConfigureHooks=()=>getContextVariable(LC_CONFIGURE_HOOKS_KEY)||[];class BaseCallbackManager{setHandler(e){return this.setHandlers([e])}}class BaseRunManager{constructor(e,r,n,s,a,o,l,u){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:l}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:u})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(r=>consumeCallback(async()=>{var n;try{await((n=r.handleText)==null?void 0:n.call(r,e,this.runId,this._parentRunId,this.tags))}catch(s){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleText: ${s}`),r.raiseError)throw s}},r.awaitHandlers)))}async handleCustomEvent(e,r,n,s,a){await Promise.all(this.handlers.map(o=>consumeCallback(async()=>{var l;try{await((l=o.handleCustomEvent)==null?void 0:l.call(o,e,r,this.runId,this.tags,this.metadata))}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleCustomEvent: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}}class CallbackManagerForRetrieverRun extends BaseRunManager{getChild(e){const r=new CallbackManager(this.runId);return r.setHandlers(this.inheritableHandlers),r.addTags(this.inheritableTags),r.addMetadata(this.inheritableMetadata),e&&r.addTags([e],!1),r}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(r=>consumeCallback(async()=>{var n;if(!r.ignoreRetriever)try{await((n=r.handleRetrieverEnd)==null?void 0:n.call(r,e,this.runId,this._parentRunId,this.tags))}catch(s){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleRetriever`),r.raiseError)throw s}},r.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(r=>consumeCallback(async()=>{var n;if(!r.ignoreRetriever)try{await((n=r.handleRetrieverError)==null?void 0:n.call(r,e,this.runId,this._parentRunId,this.tags))}catch(s){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleRetrieverError: ${s}`),r.raiseError)throw e}},r.awaitHandlers)))}}class CallbackManagerForLLMRun extends BaseRunManager{async handleLLMNewToken(e,r,n,s,a,o){await Promise.all(this.handlers.map(l=>consumeCallback(async()=>{var u;if(!l.ignoreLLM)try{await((u=l.handleLLMNewToken)==null?void 0:u.call(l,e,r??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,o))}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleLLMNewToken: ${c}`),l.raiseError)throw c}},l.awaitHandlers)))}async handleLLMError(e,r,n,s,a){await Promise.all(this.handlers.map(o=>consumeCallback(async()=>{var l;if(!o.ignoreLLM)try{await((l=o.handleLLMError)==null?void 0:l.call(o,e,this.runId,this._parentRunId,this.tags,a))}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleLLMError: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}async handleLLMEnd(e,r,n,s,a){await Promise.all(this.handlers.map(o=>consumeCallback(async()=>{var l;if(!o.ignoreLLM)try{await((l=o.handleLLMEnd)==null?void 0:l.call(o,e,this.runId,this._parentRunId,this.tags,a))}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleLLMEnd: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}}class CallbackManagerForChainRun extends BaseRunManager{getChild(e){const r=new CallbackManager(this.runId);return r.setHandlers(this.inheritableHandlers),r.addTags(this.inheritableTags),r.addMetadata(this.inheritableMetadata),e&&r.addTags([e],!1),r}async handleChainError(e,r,n,s,a){await Promise.all(this.handlers.map(o=>consumeCallback(async()=>{var l;if(!o.ignoreChain)try{await((l=o.handleChainError)==null?void 0:l.call(o,e,this.runId,this._parentRunId,this.tags,a))}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleChainError: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}async handleChainEnd(e,r,n,s,a){await Promise.all(this.handlers.map(o=>consumeCallback(async()=>{var l;if(!o.ignoreChain)try{await((l=o.handleChainEnd)==null?void 0:l.call(o,e,this.runId,this._parentRunId,this.tags,a))}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleChainEnd: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(r=>consumeCallback(async()=>{var n;if(!r.ignoreAgent)try{await((n=r.handleAgentAction)==null?void 0:n.call(r,e,this.runId,this._parentRunId,this.tags))}catch(s){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleAgentAction: ${s}`),r.raiseError)throw s}},r.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(r=>consumeCallback(async()=>{var n;if(!r.ignoreAgent)try{await((n=r.handleAgentEnd)==null?void 0:n.call(r,e,this.runId,this._parentRunId,this.tags))}catch(s){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleAgentEnd: ${s}`),r.raiseError)throw s}},r.awaitHandlers)))}}class CallbackManagerForToolRun extends BaseRunManager{getChild(e){const r=new CallbackManager(this.runId);return r.setHandlers(this.inheritableHandlers),r.addTags(this.inheritableTags),r.addMetadata(this.inheritableMetadata),e&&r.addTags([e],!1),r}async handleToolError(e){await Promise.all(this.handlers.map(r=>consumeCallback(async()=>{var n;if(!r.ignoreAgent)try{await((n=r.handleToolError)==null?void 0:n.call(r,e,this.runId,this._parentRunId,this.tags))}catch(s){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleToolError: ${s}`),r.raiseError)throw s}},r.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(r=>consumeCallback(async()=>{var n;if(!r.ignoreAgent)try{await((n=r.handleToolEnd)==null?void 0:n.call(r,e,this.runId,this._parentRunId,this.tags))}catch(s){if((r.raiseError?console.error:console.warn)(`Error in handler ${r.constructor.name}, handleToolEnd: ${s}`),r.raiseError)throw s}},r.awaitHandlers)))}}class CallbackManager extends BaseCallbackManager{constructor(e,r){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=(r==null?void 0:r.handlers)??this.handlers,this.inheritableHandlers=(r==null?void 0:r.inheritableHandlers)??this.inheritableHandlers,this.tags=(r==null?void 0:r.tags)??this.tags,this.inheritableTags=(r==null?void 0:r.inheritableTags)??this.inheritableTags,this.metadata=(r==null?void 0:r.metadata)??this.metadata,this.inheritableMetadata=(r==null?void 0:r.inheritableMetadata)??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,r,n=void 0,s=void 0,a=void 0,o=void 0,l=void 0,u=void 0){return Promise.all(r.map(async(c,d)=>{const p=d===0&&n?n:v4();return await Promise.all(this.handlers.map(m=>{if(!m.ignoreLLM)return isBaseTracer(m)&&m._createRunForLLMStart(e,[c],p,this._parentRunId,a,this.tags,this.metadata,u),consumeCallback(async()=>{var y;try{await((y=m.handleLLMStart)==null?void 0:y.call(m,e,[c],p,this._parentRunId,a,this.tags,this.metadata,u))}catch(b){if((m.raiseError?console.error:console.warn)(`Error in handler ${m.constructor.name}, handleLLMStart: ${b}`),m.raiseError)throw b}},m.awaitHandlers)})),new CallbackManagerForLLMRun(p,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,r,n=void 0,s=void 0,a=void 0,o=void 0,l=void 0,u=void 0){return Promise.all(r.map(async(c,d)=>{const p=d===0&&n?n:v4();return await Promise.all(this.handlers.map(m=>{if(!m.ignoreLLM)return isBaseTracer(m)&&m._createRunForChatModelStart(e,[c],p,this._parentRunId,a,this.tags,this.metadata,u),consumeCallback(async()=>{var y,b;try{if(m.handleChatModelStart)await((y=m.handleChatModelStart)==null?void 0:y.call(m,e,[c],p,this._parentRunId,a,this.tags,this.metadata,u));else if(m.handleLLMStart){const E=getBufferString(c);await((b=m.handleLLMStart)==null?void 0:b.call(m,e,[E],p,this._parentRunId,a,this.tags,this.metadata,u))}}catch(E){if((m.raiseError?console.error:console.warn)(`Error in handler ${m.constructor.name}, handleLLMStart: ${E}`),m.raiseError)throw E}},m.awaitHandlers)})),new CallbackManagerForLLMRun(p,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,r,n=v4(),s=void 0,a=void 0,o=void 0,l=void 0){return await Promise.all(this.handlers.map(u=>{if(!u.ignoreChain)return isBaseTracer(u)&&u._createRunForChainStart(e,r,n,this._parentRunId,this.tags,this.metadata,s,l),consumeCallback(async()=>{var c;try{await((c=u.handleChainStart)==null?void 0:c.call(u,e,r,n,this._parentRunId,this.tags,this.metadata,s,l))}catch(d){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleChainStart: ${d}`),u.raiseError)throw d}},u.awaitHandlers)})),new CallbackManagerForChainRun(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,r,n=v4(),s=void 0,a=void 0,o=void 0,l=void 0){return await Promise.all(this.handlers.map(u=>{if(!u.ignoreAgent)return isBaseTracer(u)&&u._createRunForToolStart(e,r,n,this._parentRunId,this.tags,this.metadata,l),consumeCallback(async()=>{var c;try{await((c=u.handleToolStart)==null?void 0:c.call(u,e,r,n,this._parentRunId,this.tags,this.metadata,l))}catch(d){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleToolStart: ${d}`),u.raiseError)throw d}},u.awaitHandlers)})),new CallbackManagerForToolRun(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,r,n=v4(),s=void 0,a=void 0,o=void 0,l=void 0){return await Promise.all(this.handlers.map(u=>{if(!u.ignoreRetriever)return isBaseTracer(u)&&u._createRunForRetrieverStart(e,r,n,this._parentRunId,this.tags,this.metadata,l),consumeCallback(async()=>{var c;try{await((c=u.handleRetrieverStart)==null?void 0:c.call(u,e,r,n,this._parentRunId,this.tags,this.metadata,l))}catch(d){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleRetrieverStart: ${d}`),u.raiseError)throw d}},u.awaitHandlers)})),new CallbackManagerForRetrieverRun(n,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(e,r,n,s,a){await Promise.all(this.handlers.map(o=>consumeCallback(async()=>{var l;if(!o.ignoreCustomEvent)try{await((l=o.handleCustomEvent)==null?void 0:l.call(o,e,r,n,this.tags,this.metadata))}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleCustomEvent: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}addHandler(e,r=!0){this.handlers.push(e),r&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(r=>r!==e),this.inheritableHandlers=this.inheritableHandlers.filter(r=>r!==e)}setHandlers(e,r=!0){this.handlers=[],this.inheritableHandlers=[];for(const n of e)this.addHandler(n,r)}addTags(e,r=!0){this.removeTags(e),this.tags.push(...e),r&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(r=>!e.includes(r)),this.inheritableTags=this.inheritableTags.filter(r=>!e.includes(r))}addMetadata(e,r=!0){this.metadata={...this.metadata,...e},r&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const r of Object.keys(e))delete this.metadata[r],delete this.inheritableMetadata[r]}copy(e=[],r=!0){const n=new CallbackManager(this._parentRunId);for(const s of this.handlers){const a=this.inheritableHandlers.includes(s);n.addHandler(s,a)}for(const s of this.tags){const a=this.inheritableTags.includes(s);n.addTags([s],a)}for(const s of Object.keys(this.metadata)){const a=Object.keys(this.inheritableMetadata).includes(s);n.addMetadata({[s]:this.metadata[s]},a)}for(const s of e)n.handlers.filter(a=>a.name==="console_callback_handler").some(a=>a.name===s.name)||n.addHandler(s,r);return n}static fromHandlers(e){class r extends BaseCallbackHandler{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:v4()}),Object.assign(this,e)}}const n=new this;return n.addHandler(new r),n}static configure(e,r,n,s,a,o,l){return this._configureSync(e,r,n,s,a,o,l)}static _configureSync(e,r,n,s,a,o,l){var m,y;let u;(e||r)&&(Array.isArray(e)||!e?(u=new CallbackManager,u.setHandlers((e==null?void 0:e.map(ensureHandler))??[],!0)):u=e,u=u.copy(Array.isArray(r)?r.map(ensureHandler):r==null?void 0:r.handlers,!1));const c=getEnvironmentVariable("LANGCHAIN_VERBOSE")==="true"||(l==null?void 0:l.verbose),d=((m=LangChainTracer.getTraceableRunTree())==null?void 0:m.tracingEnabled)||isTracingEnabled(),p=d||(getEnvironmentVariable("LANGCHAIN_TRACING")??!1);if(c||p){if(u||(u=new CallbackManager),c&&!u.handlers.some(b=>b.name===ConsoleCallbackHandler.prototype.name)){const b=new ConsoleCallbackHandler;u.addHandler(b,!0)}if(p&&!u.handlers.some(b=>b.name==="langchain_tracer")&&d){const b=new LangChainTracer;u.addHandler(b,!0),u._parentRunId=((y=LangChainTracer.getTraceableRunTree())==null?void 0:y.id)??u._parentRunId}}for(const{contextVar:b,inheritable:E=!0,handlerClass:T,envVar:S}of _getConfigureHooks()){const P=S&&getEnvironmentVariable(S)==="true"&&T;let A;const I=b!==void 0?getContextVariable(b):void 0;I&&isBaseCallbackHandler(I)?A=I:P&&(A=new T({})),A!==void 0&&(u||(u=new CallbackManager),u.handlers.some(j=>j.name===A.name)||u.addHandler(A,E))}return(n||s)&&u&&(u.addTags(n??[]),u.addTags(s??[],!1)),(a||o)&&u&&(u.addMetadata(a??{}),u.addMetadata(o??{},!1)),u}}function ensureHandler(t){return"name"in t?t:BaseCallbackHandler.fromMethods(t)}class MockAsyncLocalStorage{getStore(){}run(e,r){return r()}enterWith(e){}}const mockAsyncLocalStorage=new MockAsyncLocalStorage,LC_CHILD_KEY=Symbol.for("lc:child_config");class AsyncLocalStorageProvider{getInstance(){return getGlobalAsyncLocalStorageInstance()??mockAsyncLocalStorage}getRunnableConfig(){var r,n;return(n=(r=this.getInstance().getStore())==null?void 0:r.extra)==null?void 0:n[LC_CHILD_KEY]}runWithConfig(e,r,n){var d;const s=CallbackManager._configureSync(e==null?void 0:e.callbacks,void 0,e==null?void 0:e.tags,void 0,e==null?void 0:e.metadata),a=this.getInstance(),o=a.getStore(),l=s==null?void 0:s.getParentRunId(),u=(d=s==null?void 0:s.handlers)==null?void 0:d.find(p=>(p==null?void 0:p.name)==="langchain_tracer");let c;return u&&l?c=u.convertToRunTree(l):n||(c=new RunTree({name:"<runnable_lambda>",tracingEnabled:!1})),c&&(c.extra={...c.extra,[LC_CHILD_KEY]:e}),o!==void 0&&o[_CONTEXT_VARIABLES_KEY]!==void 0&&(c===void 0&&(c={}),c[_CONTEXT_VARIABLES_KEY]=o[_CONTEXT_VARIABLES_KEY]),a.run(c,r)}initializeGlobalInstance(e){getGlobalAsyncLocalStorageInstance()===void 0&&setGlobalAsyncLocalStorageInstance(e)}}const AsyncLocalStorageProviderSingleton=new AsyncLocalStorageProvider,DEFAULT_RECURSION_LIMIT=25;async function getCallbackManagerForConfig(t){return CallbackManager._configureSync(t==null?void 0:t.callbacks,void 0,t==null?void 0:t.tags,void 0,t==null?void 0:t.metadata)}function mergeConfigs(...t){const e={};for(const r of t.filter(n=>!!n))for(const n of Object.keys(r))if(n==="metadata")e[n]={...e[n],...r[n]};else if(n==="tags"){const s=e[n]??[];e[n]=[...new Set(s.concat(r[n]??[]))]}else if(n==="configurable")e[n]={...e[n],...r[n]};else if(n==="timeout")e.timeout===void 0?e.timeout=r.timeout:r.timeout!==void 0&&(e.timeout=Math.min(e.timeout,r.timeout));else if(n==="signal")e.signal===void 0?e.signal=r.signal:r.signal!==void 0&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,r.signal]):e.signal=r.signal);else if(n==="callbacks"){const s=e.callbacks,a=r.callbacks;if(Array.isArray(a))if(!s)e.callbacks=a;else if(Array.isArray(s))e.callbacks=s.concat(a);else{const o=s.copy();for(const l of a)o.addHandler(ensureHandler(l),!0);e.callbacks=o}else if(a)if(!s)e.callbacks=a;else if(Array.isArray(s)){const o=a.copy();for(const l of s)o.addHandler(ensureHandler(l),!0);e.callbacks=o}else e.callbacks=new CallbackManager(a._parentRunId,{handlers:s.handlers.concat(a.handlers),inheritableHandlers:s.inheritableHandlers.concat(a.inheritableHandlers),tags:Array.from(new Set(s.tags.concat(a.tags))),inheritableTags:Array.from(new Set(s.inheritableTags.concat(a.inheritableTags))),metadata:{...s.metadata,...a.metadata}})}else{const s=n;e[s]=r[s]??e[s]}return e}const PRIMITIVES=new Set(["string","number","boolean"]);function ensureConfig(t){var n;const e=AsyncLocalStorageProviderSingleton.getRunnableConfig();let r={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(e){const{runId:s,runName:a,...o}=e;r=Object.entries(o).reduce((l,[u,c])=>(c!==void 0&&(l[u]=c),l),r)}if(t&&(r=Object.entries(t).reduce((s,[a,o])=>(o!==void 0&&(s[a]=o),s),r)),r!=null&&r.configurable)for(const s of Object.keys(r.configurable))PRIMITIVES.has(typeof r.configurable[s])&&!((n=r.metadata)!=null&&n[s])&&(r.metadata||(r.metadata={}),r.metadata[s]=r.configurable[s]);if(r.timeout!==void 0){if(r.timeout<=0)throw new Error("Timeout must be a positive number");const s=AbortSignal.timeout(r.timeout);r.signal!==void 0?"any"in AbortSignal&&(r.signal=AbortSignal.any([r.signal,s])):r.signal=s,delete r.timeout}return r}function patchConfig(t={},{callbacks:e,maxConcurrency:r,recursionLimit:n,runName:s,configurable:a,runId:o}={}){const l=ensureConfig(t);return e!==void 0&&(delete l.runName,l.callbacks=e),n!==void 0&&(l.recursionLimit=n),r!==void 0&&(l.maxConcurrency=r),s!==void 0&&(l.runName=s),a!==void 0&&(l.configurable={...l.configurable,...a}),o!==void 0&&delete l.runId,l}function pickRunnableConfigKeys(t){return t?{configurable:t.configurable,recursionLimit:t.recursionLimit,callbacks:t.callbacks,tags:t.tags,metadata:t.metadata,maxConcurrency:t.maxConcurrency,timeout:t.timeout,signal:t.signal}:void 0}async function raceWithSignal(t,e){if(e===void 0)return t;let r;return Promise.race([t.catch(n=>{if(!(e!=null&&e.aborted))throw n}),new Promise((n,s)=>{r=()=>{s(new Error("Aborted"))},e.addEventListener("abort",r),e.aborted&&s(new Error("Aborted"))})]).finally(()=>e.removeEventListener("abort",r))}class IterableReadableStream extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){const r=this.reader.cancel();this.reader.releaseLock(),await r}throw e}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(e){const r=e.getReader();return new IterableReadableStream({start(n){return s();function s(){return r.read().then(({done:a,value:o})=>{if(a){n.close();return}return n.enqueue(o),s()})}},cancel(){r.releaseLock()}})}static fromAsyncGenerator(e){return new IterableReadableStream({async pull(r){const{value:n,done:s}=await e.next();s&&r.close(),r.enqueue(n)},async cancel(r){await e.return(r)}})}}function atee(t,e=2){const r=Array.from({length:e},()=>[]);return r.map(async function*(s){for(;;)if(s.length===0){const a=await t.next();for(const o of r)o.push(a)}else{if(s[0].done)return;yield s.shift().value}})}function concat(t,e){if(Array.isArray(t)&&Array.isArray(e))return t.concat(e);if(typeof t=="string"&&typeof e=="string")return t+e;if(typeof t=="number"&&typeof e=="number")return t+e;if("concat"in t&&typeof t.concat=="function")return t.concat(e);if(typeof t=="object"&&typeof e=="object"){const r={...t};for(const[n,s]of Object.entries(e))n in r&&!Array.isArray(r[n])?r[n]=concat(r[n],s):r[n]=s;return r}else throw new Error(`Cannot concat ${typeof t} and ${typeof e}`)}class AsyncGeneratorWithSetup{constructor(e){var r;Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??((r=this.config)==null?void 0:r.signal),this.setup=new Promise((n,s)=>{AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(e.config),async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(n,s):this.firstResult.then(a=>n(void 0),s)},!0)})}async next(...e){var r;return(r=this.signal)==null||r.throwIfAborted(),this.firstResultUsed?AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(this.config),this.signal?async()=>raceWithSignal(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}}async function pipeGeneratorWithSetup(t,e,r,n,...s){const a=new AsyncGeneratorWithSetup({generator:e,startSetup:r,signal:n}),o=await a.setup;return{output:t(a,o,...s),setup:o}}class RunLogPatch{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){const r=this.ops.concat(e.ops),n=applyPatch({},r);return new RunLog({ops:r,state:n[n.length-1].newDocument})}}class RunLog extends RunLogPatch{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){const r=this.ops.concat(e.ops),n=applyPatch(this.state,e.ops);return new RunLog({ops:r,state:n[n.length-1].newDocument})}static fromRunLogPatch(e){const r=applyPatch({},e.ops);return new RunLog({ops:e.ops,state:r[r.length-1].newDocument})}}const isLogStreamHandler=t=>t.name==="log_stream_tracer";async function _getStandardizedInputs(t,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:r}=t;if(["retriever","llm","prompt"].includes(t.run_type))return r;if(!(Object.keys(r).length===1&&(r==null?void 0:r.input)===""))return r.input}async function _getStandardizedOutputs(t,e){const{outputs:r}=t;return e==="original"||["retriever","llm","prompt"].includes(t.run_type)?r:r!==void 0&&Object.keys(r).length===1&&(r==null?void 0:r.output)!==void 0?r.output:r}function isChatGenerationChunk(t){return t!==void 0&&t.message!==void 0}class LogStreamCallbackHandler extends BaseTracer{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this._schemaFormat=(e==null?void 0:e._schemaFormat)??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=IterableReadableStream.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const r=e.tags??[];let n=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(n=n||r.find(s=>{var a;return(a=this.includeTags)==null?void 0:a.includes(s)})!==void 0),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(n=n&&r.every(s=>{var a;return!((a=this.excludeTags)!=null&&a.includes(s))})),n}async*tapOutputIterable(e,r){for await(const n of r){if(e!==this.rootId){const s=this.keyMapByRunId[e];s&&await this.writer.write(new RunLogPatch({ops:[{op:"add",path:`/logs/${s}/streamed_output/-`,value:n}]}))}yield n}}async onRunCreate(e){var s;if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new RunLogPatch({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const r=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=r===1?e.name:`${e.name}:${r}`;const n={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:((s=e.extra)==null?void 0:s.metadata)??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(n.inputs=await _getStandardizedInputs(e,this._schemaFormat)),await this.writer.write(new RunLogPatch({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:n}]}))}async onRunUpdate(e){try{const r=this.keyMapByRunId[e.id];if(r===void 0)return;const n=[];this._schemaFormat==="streaming_events"&&n.push({op:"replace",path:`/logs/${r}/inputs`,value:await _getStandardizedInputs(e,this._schemaFormat)}),n.push({op:"add",path:`/logs/${r}/final_output`,value:await _getStandardizedOutputs(e,this._schemaFormat)}),e.end_time!==void 0&&n.push({op:"add",path:`/logs/${r}/end_time`,value:new Date(e.end_time).toISOString()});const s=new RunLogPatch({ops:n});await this.writer.write(s)}finally{if(e.id===this.rootId){const r=new RunLogPatch({ops:[{op:"replace",path:"/final_output",value:await _getStandardizedOutputs(e,this._schemaFormat)}]});await this.writer.write(r),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,r,n){const s=this.keyMapByRunId[e.id];if(s===void 0)return;const a=e.inputs.messages!==void 0;let o;a?isChatGenerationChunk(n==null?void 0:n.chunk)?o=n==null?void 0:n.chunk:o=new AIMessageChunk({id:`run-${e.id}`,content:r}):o=r;const l=new RunLogPatch({ops:[{op:"add",path:`/logs/${s}/streamed_output_str/-`,value:r},{op:"add",path:`/logs/${s}/streamed_output/-`,value:o}]});await this.writer.write(l)}}const RUN_KEY="__run";class GenerationChunk{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new GenerationChunk({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class ChatGenerationChunk extends GenerationChunk{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new ChatGenerationChunk({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}function assignName({name:t,serialized:e}){return t!==void 0?t:(e==null?void 0:e.name)!==void 0?e.name:(e==null?void 0:e.id)!==void 0&&Array.isArray(e==null?void 0:e.id)?e.id[e.id.length-1]:"Unnamed"}const isStreamEventsHandler=t=>t.name==="event_stream_tracer";class EventStreamCallbackHandler extends BaseTracer{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=IterableReadableStream.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const r=e.tags??[];let n=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(n=n||r.find(s=>{var a;return(a=this.includeTags)==null?void 0:a.includes(s)})!==void 0),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(n=n&&r.every(s=>{var a;return!((a=this.excludeTags)!=null&&a.includes(s))})),n}async*tapOutputIterable(e,r){const n=await r.next();if(n.done)return;const s=this.runInfoMap.get(e);if(s===void 0){yield n.value;return}function a(l,u){return l==="llm"&&typeof u=="string"?new GenerationChunk({text:u}):u}let o=this.tappedPromises.get(e);if(o===void 0){let l;o=new Promise(u=>{l=u}),this.tappedPromises.set(e,o);try{const u={event:`on_${s.runType}_stream`,run_id:e,name:s.name,tags:s.tags,metadata:s.metadata,data:{}};await this.send({...u,data:{chunk:a(s.runType,n.value)}},s),yield n.value;for await(const c of r)s.runType!=="tool"&&s.runType!=="retriever"&&await this.send({...u,data:{chunk:a(s.runType,c)}},s),yield c}finally{l()}}else{yield n.value;for await(const l of r)yield l}}async send(e,r){this._includeRun(r)&&await this.writer.write(e)}async sendEndEvent(e,r){const n=this.tappedPromises.get(e.run_id);n!==void 0?n.then(()=>{this.send(e,r)}):await this.send(e,r)}async onLLMStart(e){var o,l;const r=assignName(e),n=e.inputs.messages!==void 0?"chat_model":"llm",s={tags:e.tags??[],metadata:((o=e.extra)==null?void 0:o.metadata)??{},name:r,runType:n,inputs:e.inputs};this.runInfoMap.set(e.id,s);const a=`on_${n}_start`;await this.send({event:a,data:{input:e.inputs},name:r,tags:e.tags??[],run_id:e.id,metadata:((l=e.extra)==null?void 0:l.metadata)??{}},s)}async onLLMNewToken(e,r,n){const s=this.runInfoMap.get(e.id);let a,o;if(s===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(this.runInfoMap.size!==1){if(s.runType==="chat_model")o="on_chat_model_stream",(n==null?void 0:n.chunk)===void 0?a=new AIMessageChunk({content:r,id:`run-${e.id}`}):a=n.chunk.message;else if(s.runType==="llm")o="on_llm_stream",(n==null?void 0:n.chunk)===void 0?a=new GenerationChunk({text:r}):a=n.chunk;else throw new Error(`Unexpected run type ${s.runType}`);await this.send({event:o,data:{chunk:a},run_id:e.id,name:s.name,tags:s.tags,metadata:s.metadata},s)}}async onLLMEnd(e){var o,l,u;const r=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let n;if(r===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const s=(o=e.outputs)==null?void 0:o.generations;let a;if(r.runType==="chat_model"){for(const c of s??[]){if(a!==void 0)break;a=(l=c[0])==null?void 0:l.message}n="on_chat_model_end"}else if(r.runType==="llm")a={generations:s==null?void 0:s.map(c=>c.map(d=>({text:d.text,generationInfo:d.generationInfo}))),llmOutput:((u=e.outputs)==null?void 0:u.llmOutput)??{}},n="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${r.runType}`);await this.sendEndEvent({event:n,data:{output:a,input:r.inputs},run_id:e.id,name:r.name,tags:r.tags,metadata:r.metadata},r)}async onChainStart(e){var o,l;const r=assignName(e),n=e.run_type??"chain",s={tags:e.tags??[],metadata:((o=e.extra)==null?void 0:o.metadata)??{},name:r,runType:e.run_type};let a={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(a={},s.inputs={}):e.inputs.input!==void 0?(a.input=e.inputs.input,s.inputs=e.inputs.input):(a.input=e.inputs,s.inputs=e.inputs),this.runInfoMap.set(e.id,s),await this.send({event:`on_${n}_start`,data:a,name:r,tags:e.tags??[],run_id:e.id,metadata:((l=e.extra)==null?void 0:l.metadata)??{}},s)}async onChainEnd(e){var l;const r=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),r===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const n=`on_${e.run_type}_end`,s=e.inputs??r.inputs??{},o={output:((l=e.outputs)==null?void 0:l.output)??e.outputs,input:s};s.input&&Object.keys(s).length===1&&(o.input=s.input,r.inputs=s.input),await this.sendEndEvent({event:n,data:o,run_id:e.id,name:r.name,tags:r.tags,metadata:r.metadata??{}},r)}async onToolStart(e){var s,a;const r=assignName(e),n={tags:e.tags??[],metadata:((s=e.extra)==null?void 0:s.metadata)??{},name:r,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,n),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:r,run_id:e.id,tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{}},n)}async onToolEnd(e){var s;const r=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),r===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(r.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const n=((s=e.outputs)==null?void 0:s.output)===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:n,input:r.inputs},run_id:e.id,name:r.name,tags:r.tags,metadata:r.metadata},r)}async onRetrieverStart(e){var a,o;const r=assignName(e),s={tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{},name:r,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,s),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:r,tags:e.tags??[],run_id:e.id,metadata:((o=e.extra)==null?void 0:o.metadata)??{}},s)}async onRetrieverEnd(e){var n;const r=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),r===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:((n=e.outputs)==null?void 0:n.documents)??e.outputs,input:r.inputs},run_id:e.id,name:r.name,tags:r.tags,metadata:r.metadata},r)}async handleCustomEvent(e,r,n){const s=this.runInfoMap.get(n);if(s===void 0)throw new Error(`handleCustomEvent: Run ID ${n} not found in run map.`);await this.send({event:"on_custom_event",run_id:n,name:e,tags:s.tags,metadata:s.metadata,data:r},s)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}}const STATUS_NO_RETRY=[400,401,402,403,404,405,406,407,409],defaultFailedAttemptHandler=t=>{var r,n;if(t.message.startsWith("Cancel")||t.message.startsWith("AbortError")||t.name==="AbortError"||(t==null?void 0:t.code)==="ECONNABORTED")throw t;const e=((r=t==null?void 0:t.response)==null?void 0:r.status)??(t==null?void 0:t.status);if(e&&STATUS_NO_RETRY.includes(+e))throw t;if(((n=t==null?void 0:t.error)==null?void 0:n.code)==="insufficient_quota"){const s=new Error(t==null?void 0:t.message);throw s.name="InsufficientQuotaError",s}};class AsyncCaller{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??defaultFailedAttemptHandler;const r="default"in PQueueMod?PQueueMod.default:PQueueMod;this.queue=new r({concurrency:this.maxConcurrency})}call(e,...r){return this.queue.add(()=>pRetry(()=>e(...r).catch(n=>{throw n instanceof Error?n:new Error(n)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,r,...n){return e.signal?Promise.race([this.call(r,...n),new Promise((s,a)=>{var o;(o=e.signal)==null||o.addEventListener("abort",()=>{a(new Error("AbortError"))})})]):this.call(r,...n)}fetch(...e){return this.call(()=>fetch(...e).then(r=>r.ok?r:Promise.reject(r)))}}class RootListenersTracer extends BaseTracer{constructor({config:e,onStart:r,onEnd:n,onError:s}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=r,this.argOnEnd=n,this.argOnError=s}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}}function isRunnableInterface(t){return t?t.lc_runnable:!1}class _RootEventFilter{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,r){let n=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const s=e.tags??[];return this.includeNames!==void 0&&(n=n||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(n=n||this.includeTypes.includes(r)),this.includeTags!==void 0&&(n=n||s.some(a=>{var o;return(o=this.includeTags)==null?void 0:o.includes(a)})),this.excludeNames!==void 0&&(n=n&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(n=n&&!this.excludeTypes.includes(r)),this.excludeTags!==void 0&&(n=n&&s.every(a=>{var o;return!((o=this.excludeTags)!=null&&o.includes(a))})),n}}const ignoreOverride$1=Symbol("Let zodToJsonSchema decide on which parser to use"),defaultOptions$1={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},getDefaultOptions$1=t=>({...defaultOptions$1,...t}),getRefs$1=t=>{const e=getDefaultOptions$1(t),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([n,s])=>[s._def,{def:s._def,path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function addErrorMessage$1(t,e,r,n){n!=null&&n.errorMessages&&r&&(t.errorMessage={...t.errorMessage,[e]:r})}function setResponseValueAndErrors$1(t,e,r,n,s){t[e]=r,addErrorMessage$1(t,e,n,s)}function parseAnyDef$1(){return{}}function parseArrayDef$1(t,e){var n,s,a;const r={type:"array"};return(n=t.type)!=null&&n._def&&((a=(s=t.type)==null?void 0:s._def)==null?void 0:a.typeName)!==ZodFirstPartyTypeKind.ZodAny&&(r.items=parseDef$1(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&setResponseValueAndErrors$1(r,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&setResponseValueAndErrors$1(r,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(setResponseValueAndErrors$1(r,"minItems",t.exactLength.value,t.exactLength.message,e),setResponseValueAndErrors$1(r,"maxItems",t.exactLength.value,t.exactLength.message,e)),r}function parseBigintDef$1(t,e){const r={type:"integer",format:"int64"};if(!t.checks)return r;for(const n of t.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?setResponseValueAndErrors$1(r,"minimum",n.value,n.message,e):setResponseValueAndErrors$1(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),setResponseValueAndErrors$1(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?setResponseValueAndErrors$1(r,"maximum",n.value,n.message,e):setResponseValueAndErrors$1(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),setResponseValueAndErrors$1(r,"maximum",n.value,n.message,e));break;case"multipleOf":setResponseValueAndErrors$1(r,"multipleOf",n.value,n.message,e);break}return r}function parseBooleanDef$1(){return{type:"boolean"}}function parseBrandedDef$1(t,e){return parseDef$1(t.type._def,e)}const parseCatchDef$1=(t,e)=>parseDef$1(t.innerType._def,e);function parseDateDef$1(t,e,r){const n=r??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((s,a)=>parseDateDef$1(t,e,s))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return integerDateParser$1(t,e)}}const integerDateParser$1=(t,e)=>{const r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(const n of t.checks)switch(n.kind){case"min":setResponseValueAndErrors$1(r,"minimum",n.value,n.message,e);break;case"max":setResponseValueAndErrors$1(r,"maximum",n.value,n.message,e);break}return r};function parseDefaultDef$1(t,e){return{...parseDef$1(t.innerType._def,e),default:t.defaultValue()}}function parseEffectsDef$1(t,e){return e.effectStrategy==="input"?parseDef$1(t.schema._def,e):{}}function parseEnumDef$1(t){return{type:"string",enum:Array.from(t.values)}}const isJsonSchema7AllOfType$1=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function parseIntersectionDef$1(t,e){const r=[parseDef$1(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),parseDef$1(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return r.forEach(a=>{if(isJsonSchema7AllOfType$1(a))s.push(...a.allOf),a.unevaluatedProperties===void 0&&(n=void 0);else{let o=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:l,...u}=a;o=u}else n=void 0;s.push(o)}}),s.length?{allOf:s,...n}:void 0}function parseLiteralDef$1(t,e){const r=typeof t.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[t.value]}:{type:r==="bigint"?"integer":r,const:t.value}}let emojiRegex$1;const zodPatterns$1={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(emojiRegex$1===void 0&&(emojiRegex$1=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),emojiRegex$1),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function parseStringDef$1(t,e){const r={type:"string"};if(t.checks)for(const n of t.checks)switch(n.kind){case"min":setResponseValueAndErrors$1(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,e);break;case"max":setResponseValueAndErrors$1(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,e);break;case"email":switch(e.emailStrategy){case"format:email":addFormat$1(r,"email",n.message,e);break;case"format:idn-email":addFormat$1(r,"idn-email",n.message,e);break;case"pattern:zod":addPattern$1(r,zodPatterns$1.email,n.message,e);break}break;case"url":addFormat$1(r,"uri",n.message,e);break;case"uuid":addFormat$1(r,"uuid",n.message,e);break;case"regex":addPattern$1(r,n.regex,n.message,e);break;case"cuid":addPattern$1(r,zodPatterns$1.cuid,n.message,e);break;case"cuid2":addPattern$1(r,zodPatterns$1.cuid2,n.message,e);break;case"startsWith":addPattern$1(r,RegExp(`^${escapeLiteralCheckValue(n.value,e)}`),n.message,e);break;case"endsWith":addPattern$1(r,RegExp(`${escapeLiteralCheckValue(n.value,e)}$`),n.message,e);break;case"datetime":addFormat$1(r,"date-time",n.message,e);break;case"date":addFormat$1(r,"date",n.message,e);break;case"time":addFormat$1(r,"time",n.message,e);break;case"duration":addFormat$1(r,"duration",n.message,e);break;case"length":setResponseValueAndErrors$1(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,n.value):n.value,n.message,e),setResponseValueAndErrors$1(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,n.value):n.value,n.message,e);break;case"includes":{addPattern$1(r,RegExp(escapeLiteralCheckValue(n.value,e)),n.message,e);break}case"ip":{n.version!=="v6"&&addFormat$1(r,"ipv4",n.message,e),n.version!=="v4"&&addFormat$1(r,"ipv6",n.message,e);break}case"base64url":addPattern$1(r,zodPatterns$1.base64url,n.message,e);break;case"jwt":addPattern$1(r,zodPatterns$1.jwt,n.message,e);break;case"cidr":{n.version!=="v6"&&addPattern$1(r,zodPatterns$1.ipv4Cidr,n.message,e),n.version!=="v4"&&addPattern$1(r,zodPatterns$1.ipv6Cidr,n.message,e);break}case"emoji":addPattern$1(r,zodPatterns$1.emoji(),n.message,e);break;case"ulid":{addPattern$1(r,zodPatterns$1.ulid,n.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{addFormat$1(r,"binary",n.message,e);break}case"contentEncoding:base64":{setResponseValueAndErrors$1(r,"contentEncoding","base64",n.message,e);break}case"pattern:zod":{addPattern$1(r,zodPatterns$1.base64,n.message,e);break}}break}case"nanoid":addPattern$1(r,zodPatterns$1.nanoid,n.message,e)}return r}function escapeLiteralCheckValue(t,e){return e.patternStrategy==="escape"?escapeNonAlphaNumeric$1(t):t}const ALPHA_NUMERIC=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function escapeNonAlphaNumeric$1(t){let e="";for(let r=0;r<t.length;r++)ALPHA_NUMERIC.has(t[r])||(e+="\\"),e+=t[r];return e}function addFormat$1(t,e,r,n){var s;t.format||(s=t.anyOf)!=null&&s.some(a=>a.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&n.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...r&&n.errorMessages&&{errorMessage:{format:r}}})):setResponseValueAndErrors$1(t,"format",e,r,n)}function addPattern$1(t,e,r,n){var s;t.pattern||(s=t.allOf)!=null&&s.some(a=>a.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&n.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:stringifyRegExpWithFlags(e,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):setResponseValueAndErrors$1(t,"pattern",stringifyRegExpWithFlags(e,n),r,n)}function stringifyRegExpWithFlags(t,e){var u;if(!e.applyRegexFlags||!t.flags)return t.source;const r={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},n=r.i?t.source.toLowerCase():t.source;let s="",a=!1,o=!1,l=!1;for(let c=0;c<n.length;c++){if(a){s+=n[c],a=!1;continue}if(r.i){if(o){if(n[c].match(/[a-z]/)){l?(s+=n[c],s+=`${n[c-2]}-${n[c]}`.toUpperCase(),l=!1):n[c+1]==="-"&&((u=n[c+2])!=null&&u.match(/[a-z]/))?(s+=n[c],l=!0):s+=`${n[c]}${n[c].toUpperCase()}`;continue}}else if(n[c].match(/[a-z]/)){s+=`[${n[c]}${n[c].toUpperCase()}]`;continue}}if(r.m){if(n[c]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(n[c]==="$"){s+=`($|(?=[\r
]))`;continue}}if(r.s&&n[c]==="."){s+=o?`${n[c]}\r
`:`[${n[c]}\r
]`;continue}s+=n[c],n[c]==="\\"?a=!0:o&&n[c]==="]"?o=!1:!o&&n[c]==="["&&(o=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return s}function parseRecordDef$1(t,e){var n,s,a,o,l,u;if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&((n=t.keyType)==null?void 0:n._def.typeName)===ZodFirstPartyTypeKind.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((c,d)=>({...c,[d]:parseDef$1(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",d]})??{}}),{}),additionalProperties:e.rejectedAdditionalProperties};const r={type:"object",additionalProperties:parseDef$1(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return r;if(((s=t.keyType)==null?void 0:s._def.typeName)===ZodFirstPartyTypeKind.ZodString&&((a=t.keyType._def.checks)!=null&&a.length)){const{type:c,...d}=parseStringDef$1(t.keyType._def,e);return{...r,propertyNames:d}}else{if(((o=t.keyType)==null?void 0:o._def.typeName)===ZodFirstPartyTypeKind.ZodEnum)return{...r,propertyNames:{enum:t.keyType._def.values}};if(((l=t.keyType)==null?void 0:l._def.typeName)===ZodFirstPartyTypeKind.ZodBranded&&t.keyType._def.type._def.typeName===ZodFirstPartyTypeKind.ZodString&&((u=t.keyType._def.type._def.checks)!=null&&u.length)){const{type:c,...d}=parseBrandedDef$1(t.keyType._def,e);return{...r,propertyNames:d}}}return r}function parseMapDef$1(t,e){if(e.mapStrategy==="record")return parseRecordDef$1(t,e);const r=parseDef$1(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},n=parseDef$1(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[r,n],minItems:2,maxItems:2}}}function parseNativeEnumDef$1(t){const e=t.values,n=Object.keys(t.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),s=Array.from(new Set(n.map(a=>typeof a)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:n}}function parseNeverDef$1(){return{not:{}}}function parseNullDef$1(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const primitiveMappings$1={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function parseUnionDef$1(t,e){if(e.target==="openApi3")return asAnyOf$1(t,e);const r=t.options instanceof Map?Array.from(t.options.values()):t.options;if(r.every(n=>n._def.typeName in primitiveMappings$1&&(!n._def.checks||!n._def.checks.length))){const n=r.reduce((s,a)=>{const o=primitiveMappings$1[a._def.typeName];return o&&!s.includes(o)?[...s,o]:s},[]);return{type:n.length>1?n:n[0]}}else if(r.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){const n=r.reduce((s,a)=>{const o=typeof a._def.value;switch(o){case"string":case"number":case"boolean":return[...s,o];case"bigint":return[...s,"integer"];case"object":if(a._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(n.length===r.length){const s=n.filter((a,o,l)=>l.indexOf(a)===o);return{type:s.length>1?s:s[0],enum:r.reduce((a,o)=>a.includes(o._def.value)?a:[...a,o._def.value],[])}}}else if(r.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((n,s)=>[...n,...s._def.values.filter(a=>!n.includes(a))],[])};return asAnyOf$1(t,e)}const asAnyOf$1=(t,e)=>{const r=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((n,s)=>parseDef$1(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${s}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return r.length?{anyOf:r}:void 0};function parseNullableDef$1(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:primitiveMappings$1[t.innerType._def.typeName],nullable:!0}:{type:[primitiveMappings$1[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const n=parseDef$1(t.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}const r=parseDef$1(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function parseNumberDef$1(t,e){const r={type:"number"};if(!t.checks)return r;for(const n of t.checks)switch(n.kind){case"int":r.type="integer",addErrorMessage$1(r,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?setResponseValueAndErrors$1(r,"minimum",n.value,n.message,e):setResponseValueAndErrors$1(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),setResponseValueAndErrors$1(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?setResponseValueAndErrors$1(r,"maximum",n.value,n.message,e):setResponseValueAndErrors$1(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),setResponseValueAndErrors$1(r,"maximum",n.value,n.message,e));break;case"multipleOf":setResponseValueAndErrors$1(r,"multipleOf",n.value,n.message,e);break}return r}function parseObjectDef$1(t,e){const r=e.target==="openAi",n={type:"object",properties:{}},s=[],a=t.shape();for(const l in a){let u=a[l];if(u===void 0||u._def===void 0)continue;let c=safeIsOptional(u);c&&r&&(u instanceof ZodOptional&&(u=u._def.innerType),u.isNullable()||(u=u.nullable()),c=!1);const d=parseDef$1(u._def,{...e,currentPath:[...e.currentPath,"properties",l],propertyPath:[...e.currentPath,"properties",l]});d!==void 0&&(n.properties[l]=d,c||s.push(l))}s.length&&(n.required=s);const o=decideAdditionalProperties$1(t,e);return o!==void 0&&(n.additionalProperties=o),n}function decideAdditionalProperties$1(t,e){if(t.catchall._def.typeName!=="ZodNever")return parseDef$1(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(t.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function safeIsOptional(t){try{return t.isOptional()}catch{return!0}}const parseOptionalDef$1=(t,e)=>{var n;if(e.currentPath.toString()===((n=e.propertyPath)==null?void 0:n.toString()))return parseDef$1(t.innerType._def,e);const r=parseDef$1(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:{}},r]}:{}},parsePipelineDef$1=(t,e)=>{if(e.pipeStrategy==="input")return parseDef$1(t.in._def,e);if(e.pipeStrategy==="output")return parseDef$1(t.out._def,e);const r=parseDef$1(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=parseDef$1(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(s=>s!==void 0)}};function parsePromiseDef$1(t,e){return parseDef$1(t.type._def,e)}function parseSetDef$1(t,e){const n={type:"array",uniqueItems:!0,items:parseDef$1(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&setResponseValueAndErrors$1(n,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&setResponseValueAndErrors$1(n,"maxItems",t.maxSize.value,t.maxSize.message,e),n}function parseTupleDef$1(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((r,n)=>parseDef$1(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[]),additionalItems:parseDef$1(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((r,n)=>parseDef$1(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[])}}function parseUndefinedDef$1(){return{not:{}}}function parseUnknownDef$1(){return{}}const parseReadonlyDef$1=(t,e)=>parseDef$1(t.innerType._def,e),selectParser$1=(t,e,r)=>{switch(e){case ZodFirstPartyTypeKind.ZodString:return parseStringDef$1(t,r);case ZodFirstPartyTypeKind.ZodNumber:return parseNumberDef$1(t,r);case ZodFirstPartyTypeKind.ZodObject:return parseObjectDef$1(t,r);case ZodFirstPartyTypeKind.ZodBigInt:return parseBigintDef$1(t,r);case ZodFirstPartyTypeKind.ZodBoolean:return parseBooleanDef$1();case ZodFirstPartyTypeKind.ZodDate:return parseDateDef$1(t,r);case ZodFirstPartyTypeKind.ZodUndefined:return parseUndefinedDef$1();case ZodFirstPartyTypeKind.ZodNull:return parseNullDef$1(r);case ZodFirstPartyTypeKind.ZodArray:return parseArrayDef$1(t,r);case ZodFirstPartyTypeKind.ZodUnion:case ZodFirstPartyTypeKind.ZodDiscriminatedUnion:return parseUnionDef$1(t,r);case ZodFirstPartyTypeKind.ZodIntersection:return parseIntersectionDef$1(t,r);case ZodFirstPartyTypeKind.ZodTuple:return parseTupleDef$1(t,r);case ZodFirstPartyTypeKind.ZodRecord:return parseRecordDef$1(t,r);case ZodFirstPartyTypeKind.ZodLiteral:return parseLiteralDef$1(t,r);case ZodFirstPartyTypeKind.ZodEnum:return parseEnumDef$1(t);case ZodFirstPartyTypeKind.ZodNativeEnum:return parseNativeEnumDef$1(t);case ZodFirstPartyTypeKind.ZodNullable:return parseNullableDef$1(t,r);case ZodFirstPartyTypeKind.ZodOptional:return parseOptionalDef$1(t,r);case ZodFirstPartyTypeKind.ZodMap:return parseMapDef$1(t,r);case ZodFirstPartyTypeKind.ZodSet:return parseSetDef$1(t,r);case ZodFirstPartyTypeKind.ZodLazy:return()=>t.getter()._def;case ZodFirstPartyTypeKind.ZodPromise:return parsePromiseDef$1(t,r);case ZodFirstPartyTypeKind.ZodNaN:case ZodFirstPartyTypeKind.ZodNever:return parseNeverDef$1();case ZodFirstPartyTypeKind.ZodEffects:return parseEffectsDef$1(t,r);case ZodFirstPartyTypeKind.ZodAny:return parseAnyDef$1();case ZodFirstPartyTypeKind.ZodUnknown:return parseUnknownDef$1();case ZodFirstPartyTypeKind.ZodDefault:return parseDefaultDef$1(t,r);case ZodFirstPartyTypeKind.ZodBranded:return parseBrandedDef$1(t,r);case ZodFirstPartyTypeKind.ZodReadonly:return parseReadonlyDef$1(t,r);case ZodFirstPartyTypeKind.ZodCatch:return parseCatchDef$1(t,r);case ZodFirstPartyTypeKind.ZodPipeline:return parsePipelineDef$1(t,r);case ZodFirstPartyTypeKind.ZodFunction:case ZodFirstPartyTypeKind.ZodVoid:case ZodFirstPartyTypeKind.ZodSymbol:return;default:return(n=>{})()}};function parseDef$1(t,e,r=!1){var l;const n=e.seen.get(t);if(e.override){const u=(l=e.override)==null?void 0:l.call(e,t,e,n,r);if(u!==ignoreOverride$1)return u}if(n&&!r){const u=get$ref$1(n,e);if(u!==void 0)return u}const s={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,s);const a=selectParser$1(t,t.typeName,e),o=typeof a=="function"?parseDef$1(a(),e):a;if(o&&addMeta$1(t,e,o),e.postProcess){const u=e.postProcess(o,t,e);return s.jsonSchema=o,u}return s.jsonSchema=o,o}const get$ref$1=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:getRelativePath$1(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((r,n)=>e.currentPath[n]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},getRelativePath$1=(t,e)=>{let r=0;for(;r<t.length&&r<e.length&&t[r]===e[r];r++);return[(t.length-r).toString(),...e.slice(r)].join("/")},addMeta$1=(t,e,r)=>(t.description&&(r.description=t.description,e.markdownDescription&&(r.markdownDescription=t.description)),r),zodToJsonSchema$2=(t,e)=>{const r=getRefs$1(e),n=void 0,s=e==null?void 0:e.name,a=parseDef$1(t._def,r,!1)??{},o=s===void 0?n?{...a,[r.definitionPath]:n}:a:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,s].join("/"),[r.definitionPath]:{...n,[s]:a}};return r.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(r.target==="jsonSchema2019-09"||r.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),r.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};function _escapeNodeLabel(t){return t.replace(/[^a-zA-Z-_0-9]/g,"_")}const MARKDOWN_SPECIAL_CHARS=["*","_","`"];function _generateMermaidGraphStyles(t){let e="";for(const[r,n]of Object.entries(t))e+=`	classDef ${r} ${n};
`;return e}function drawMermaid(t,e,r){const{firstNode:n,lastNode:s,nodeColors:a,withStyles:o=!0,curveStyle:l="linear",wrapLabelNWords:u=9}=r??{};let c=o?`%%{init: {'flowchart': {'curve': '${l}'}}}%%
graph TD;
`:`graph TD;
`;if(o){const y="default",b={[y]:"{0}({1})"};n!==void 0&&(b[n]="{0}([{1}]):::first"),s!==void 0&&(b[s]="{0}([{1}]):::last");for(const[E,T]of Object.entries(t)){const S=T.name.split(":").pop()??"";let A=MARKDOWN_SPECIAL_CHARS.some(j=>S.startsWith(j)&&S.endsWith(j))?`<p>${S}</p>`:S;Object.keys(T.metadata??{}).length&&(A+=`<hr/><small><em>${Object.entries(T.metadata??{}).map(([j,K])=>`${j} = ${K}`).join(`
`)}</em></small>`);const I=(b[E]??b[y]).replace("{0}",_escapeNodeLabel(E)).replace("{1}",A);c+=`	${I}
`}}const d={};for(const y of e){const b=y.source.split(":"),E=y.target.split(":"),T=b.filter((S,P)=>S===E[P]).join(":");d[T]||(d[T]=[]),d[T].push(y)}const p=new Set;function m(y,b){const E=y.length===1&&y[0].source===y[0].target;if(b&&!E){const T=b.split(":").pop();if(p.has(T))throw new Error(`Found duplicate subgraph '${T}' -- this likely means that you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.`);p.add(T),c+=`	subgraph ${T}
`}for(const T of y){const{source:S,target:P,data:A,conditional:I}=T;let j="";if(A!==void 0){let K=A;const W=K.split(" ");W.length>u&&(K=Array.from({length:Math.ceil(W.length/u)},(H,ee)=>W.slice(ee*u,(ee+1)*u).join(" ")).join("&nbsp;<br>&nbsp;")),j=I?` -. &nbsp;${K}&nbsp; .-> `:` -- &nbsp;${K}&nbsp; --> `}else j=I?" -.-> ":" --> ";c+=`	${_escapeNodeLabel(S)}${j}${_escapeNodeLabel(P)};
`}for(const T in d)T.startsWith(`${b}:`)&&T!==b&&m(d[T],T);b&&!E&&(c+=`	end
`)}m(d[""]??[],"");for(const y in d)!y.includes(":")&&y!==""&&m(d[y],y);return o&&(c+=_generateMermaidGraphStyles(a??{})),c}async function drawMermaidPng(t,e){let{backgroundColor:r="white"}=e??{};const n=btoa(t);r!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(r)||(r=`!${r}`));const s=`https://mermaid.ink/img/${n}?bgColor=${r}`,a=await fetch(s);if(!a.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${a.status}`,`Status text: ${a.statusText}`].join(`
`));return await a.blob()}function nodeDataStr(t,e){if(t!==void 0&&!validate$1(t))return t;if(isRunnableInterface(e))try{let r=e.getName();return r=r.startsWith("Runnable")?r.slice(8):r,r}catch{return e.getName()}else return e.name??"UnknownSchema"}function nodeDataJson(t){return isRunnableInterface(t.data)?{type:"runnable",data:{id:t.data.lc_id,name:t.data.getName()}}:{type:"schema",data:{...zodToJsonSchema$2(t.data.schema),title:t.data.name}}}class Graph{constructor(e){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.nodes=(e==null?void 0:e.nodes)??this.nodes,this.edges=(e==null?void 0:e.edges)??this.edges}toJSON(){const e={};return Object.values(this.nodes).forEach((r,n)=>{e[r.id]=validate$1(r.id)?n:r.id}),{nodes:Object.values(this.nodes).map(r=>({id:e[r.id],...nodeDataJson(r)})),edges:this.edges.map(r=>{const n={source:e[r.source],target:e[r.target]};return typeof r.data<"u"&&(n.data=r.data),typeof r.conditional<"u"&&(n.conditional=r.conditional),n})}}addNode(e,r,n){if(r!==void 0&&this.nodes[r]!==void 0)throw new Error(`Node with id ${r} already exists`);const s=r??v4(),a={id:s,data:e,name:nodeDataStr(r,e),metadata:n};return this.nodes[s]=a,a}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(r=>r.source!==e.id&&r.target!==e.id)}addEdge(e,r,n,s){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[r.id]===void 0)throw new Error(`Target node ${r.id} not in graph`);const a={source:e.id,target:r.id,data:n,conditional:s};return this.edges.push(a),a}firstNode(){return _firstNode(this)}lastNode(){return _lastNode(this)}extend(e,r=""){let n=r;Object.values(e.nodes).map(c=>c.id).every(validate$1)&&(n="");const a=c=>n?`${n}:${c}`:c;Object.entries(e.nodes).forEach(([c,d])=>{this.nodes[a(c)]={...d,id:a(c)}});const o=e.edges.map(c=>({...c,source:a(c.source),target:a(c.target)}));this.edges=[...this.edges,...o];const l=e.firstNode(),u=e.lastNode();return[l?{id:a(l.id),data:l.data}:void 0,u?{id:a(u.id),data:u.data}:void 0]}trimFirstNode(){const e=this.firstNode();e&&_firstNode(this,[e.id])&&this.removeNode(e)}trimLastNode(){const e=this.lastNode();e&&_lastNode(this,[e.id])&&this.removeNode(e)}reid(){const e=Object.fromEntries(Object.values(this.nodes).map(s=>[s.id,s.name])),r=new Map;Object.values(e).forEach(s=>{r.set(s,(r.get(s)||0)+1)});const n=s=>{const a=e[s];return validate$1(s)&&r.get(a)===1?a:s};return new Graph({nodes:Object.fromEntries(Object.entries(this.nodes).map(([s,a])=>[n(s),{...a,id:n(s)}])),edges:this.edges.map(s=>({...s,source:n(s.source),target:n(s.target)}))})}drawMermaid(e){const{withStyles:r,curveStyle:n,nodeColors:s={default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"},wrapLabelNWords:a}=e??{},o=this.reid(),l=o.firstNode(),u=o.lastNode();return drawMermaid(o.nodes,o.edges,{firstNode:l==null?void 0:l.id,lastNode:u==null?void 0:u.id,withStyles:r,curveStyle:n,nodeColors:s,wrapLabelNWords:a})}async drawMermaidPng(e){const r=this.drawMermaid(e);return drawMermaidPng(r,{backgroundColor:e==null?void 0:e.backgroundColor})}}function _firstNode(t,e=[]){const r=new Set(t.edges.filter(s=>!e.includes(s.source)).map(s=>s.target)),n=[];for(const s of Object.values(t.nodes))!e.includes(s.id)&&!r.has(s.id)&&n.push(s);return n.length===1?n[0]:void 0}function _lastNode(t,e=[]){const r=new Set(t.edges.filter(s=>!e.includes(s.target)).map(s=>s.source)),n=[];for(const s of Object.values(t.nodes))!e.includes(s.id)&&!r.has(s.id)&&n.push(s);return n.length===1?n[0]:void 0}function convertToHttpEventStream(t){const e=new TextEncoder,r=new ReadableStream({async start(n){for await(const s of t)n.enqueue(e.encode(`event: data
data: ${JSON.stringify(s)}

`));n.enqueue(e.encode(`event: end

`)),n.close()}});return IterableReadableStream.fromReadableStream(r)}function isIterableIterator(t){return typeof t=="object"&&t!==null&&typeof t[Symbol.iterator]=="function"&&typeof t.next=="function"}const isIterator=t=>t!=null&&typeof t=="object"&&"next"in t&&typeof t.next=="function";function isAsyncIterable(t){return typeof t=="object"&&t!==null&&typeof t[Symbol.asyncIterator]=="function"}function*consumeIteratorInContext(t,e){for(;;){const{value:r,done:n}=AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(t),e.next.bind(e),!0);if(n)break;yield r}}async function*consumeAsyncIterableInContext(t,e){const r=e[Symbol.asyncIterator]();for(;;){const{value:n,done:s}=await AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(t),r.next.bind(e),!0);if(s)break;yield n}}function _coerceToDict(t,e){return t&&!Array.isArray(t)&&!(t instanceof Date)&&typeof t=="object"?t:{[e]:t}}class Runnable extends Serializable{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){const r=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${r}${e}`:r}bind(e){return new RunnableBinding({bound:this,kwargs:e,config:{}})}map(){return new RunnableEach({bound:this})}withRetry(e){return new RunnableRetry({bound:this,kwargs:{},config:{},maxAttemptNumber:e==null?void 0:e.stopAfterAttempt,...e})}withConfig(e){return new RunnableBinding({bound:this,config:e,kwargs:{}})}withFallbacks(e){const r=Array.isArray(e)?e:e.fallbacks;return new RunnableWithFallbacks({runnable:this,fallbacks:r})}_getOptionsList(e,r=0){if(Array.isArray(e)&&e.length!==r)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${r} inputs`);if(Array.isArray(e))return e.map(ensureConfig);if(r>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const n=Object.fromEntries(Object.entries(e).filter(([s])=>s!=="runId"));return Array.from({length:r},(s,a)=>ensureConfig(a===0?e:n))}return Array.from({length:r},()=>ensureConfig(e))}async batch(e,r,n){var u;const s=this._getOptionsList(r??{},e.length),a=((u=s[0])==null?void 0:u.maxConcurrency)??(n==null?void 0:n.maxConcurrency),o=new AsyncCaller({maxConcurrency:a,onFailedAttempt:c=>{throw c}}),l=e.map((c,d)=>o.call(async()=>{try{return await this.invoke(c,s[d])}catch(p){if(n!=null&&n.returnExceptions)return p;throw p}}));return Promise.all(l)}async*_streamIterator(e,r){yield this.invoke(e,r)}async stream(e,r){const n=ensureConfig(r),s=new AsyncGeneratorWithSetup({generator:this._streamIterator(e,n),config:n});return await s.setup,IterableReadableStream.fromAsyncGenerator(s)}_separateRunnableConfigFromCallOptions(e){let r;e===void 0?r=ensureConfig(e):r=ensureConfig({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});const n={...e};return delete n.callbacks,delete n.tags,delete n.metadata,delete n.runName,delete n.configurable,delete n.recursionLimit,delete n.maxConcurrency,delete n.runId,delete n.timeout,delete n.signal,[r,n]}async _callWithConfig(e,r,n){const s=ensureConfig(n),a=await getCallbackManagerForConfig(s),o=await(a==null?void 0:a.handleChainStart(this.toJSON(),_coerceToDict(r,"input"),s.runId,s==null?void 0:s.runType,void 0,void 0,(s==null?void 0:s.runName)??this.getName()));delete s.runId;let l;try{const u=e.call(this,r,s,o);l=await raceWithSignal(u,n==null?void 0:n.signal)}catch(u){throw await(o==null?void 0:o.handleChainError(u)),u}return await(o==null?void 0:o.handleChainEnd(_coerceToDict(l,"output"))),l}async _batchWithConfig(e,r,n,s){var c;const a=this._getOptionsList(n??{},r.length),o=await Promise.all(a.map(getCallbackManagerForConfig)),l=await Promise.all(o.map(async(d,p)=>{const m=await(d==null?void 0:d.handleChainStart(this.toJSON(),_coerceToDict(r[p],"input"),a[p].runId,a[p].runType,void 0,void 0,a[p].runName??this.getName()));return delete a[p].runId,m}));let u;try{const d=e.call(this,r,a,l,s);u=await raceWithSignal(d,(c=a==null?void 0:a[0])==null?void 0:c.signal)}catch(d){throw await Promise.all(l.map(p=>p==null?void 0:p.handleChainError(d))),d}return await Promise.all(l.map(d=>d==null?void 0:d.handleChainEnd(_coerceToDict(u,"output")))),u}async*_transformStreamWithConfig(e,r,n){let s,a=!0,o,l=!0;const u=ensureConfig(n),c=await getCallbackManagerForConfig(u);async function*d(){for await(const m of e){if(a)if(s===void 0)s=m;else try{s=concat(s,m)}catch{s=void 0,a=!1}yield m}}let p;try{const m=await pipeGeneratorWithSetup(r.bind(this),d(),async()=>c==null?void 0:c.handleChainStart(this.toJSON(),{input:""},u.runId,u.runType,void 0,void 0,u.runName??this.getName()),n==null?void 0:n.signal,u);delete u.runId,p=m.setup;const y=p==null?void 0:p.handlers.find(isStreamEventsHandler);let b=m.output;y!==void 0&&p!==void 0&&(b=y.tapOutputIterable(p.runId,b));const E=p==null?void 0:p.handlers.find(isLogStreamHandler);E!==void 0&&p!==void 0&&(b=E.tapOutputIterable(p.runId,b));for await(const T of b)if(yield T,l)if(o===void 0)o=T;else try{o=concat(o,T)}catch{o=void 0,l=!1}}catch(m){throw await(p==null?void 0:p.handleChainError(m,void 0,void 0,void 0,{inputs:_coerceToDict(s,"input")})),m}await(p==null?void 0:p.handleChainEnd(o??{},void 0,void 0,void 0,{inputs:_coerceToDict(s,"input")}))}getGraph(e){const r=new Graph,n=r.addNode({name:`${this.getName()}Input`,schema:anyType()}),s=r.addNode(this),a=r.addNode({name:`${this.getName()}Output`,schema:anyType()});return r.addEdge(n,s),r.addEdge(s,a),r}pipe(e){return new RunnableSequence({first:this,last:_coerceToRunnable(e)})}pick(e){return this.pipe(new RunnablePick(e))}assign(e){return this.pipe(new RunnableAssign(new RunnableMap({steps:e})))}async*transform(e,r){let n;for await(const s of e)n===void 0?n=s:n=concat(n,s);yield*this._streamIterator(n,ensureConfig(r))}async*streamLog(e,r,n){const s=new LogStreamCallbackHandler({...n,autoClose:!1,_schemaFormat:"original"}),a=ensureConfig(r);yield*this._streamLog(e,s,a)}async*_streamLog(e,r,n){const{callbacks:s}=n;if(s===void 0)n.callbacks=[r];else if(Array.isArray(s))n.callbacks=s.concat([r]);else{const u=s.copy();u.addHandler(r,!0),n.callbacks=u}const a=this.stream(e,n);async function o(){try{const u=await a;for await(const c of u){const d=new RunLogPatch({ops:[{op:"add",path:"/streamed_output/-",value:c}]});await r.writer.write(d)}}finally{await r.writer.close()}}const l=o();try{for await(const u of r)yield u}finally{await l}}streamEvents(e,r,n){let s;if(r.version==="v1")s=this._streamEventsV1(e,r,n);else if(r.version==="v2")s=this._streamEventsV2(e,r,n);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return r.encoding==="text/event-stream"?convertToHttpEventStream(s):IterableReadableStream.fromAsyncGenerator(s)}async*_streamEventsV2(e,r,n){var b;const s=new EventStreamCallbackHandler({...n,autoClose:!1}),a=ensureConfig(r),o=a.runId??v4();a.runId=o;const l=a.callbacks;if(l===void 0)a.callbacks=[s];else if(Array.isArray(l))a.callbacks=l.concat(s);else{const E=l.copy();E.addHandler(s,!0),a.callbacks=E}const u=new AbortController,c=this;async function d(){try{let E;r!=null&&r.signal?"any"in AbortSignal?E=AbortSignal.any([u.signal,r.signal]):(E=r.signal,r.signal.addEventListener("abort",()=>{u.abort()},{once:!0})):E=u.signal;const T=await c.stream(e,{...a,signal:E}),S=s.tapOutputIterable(o,T);for await(const P of S)if(u.signal.aborted)break}finally{await s.finish()}}const p=d();let m=!1,y;try{for await(const E of s){if(!m){E.data.input=e,m=!0,y=E.run_id,yield E;continue}E.run_id===y&&E.event.endsWith("_end")&&(b=E.data)!=null&&b.input&&delete E.data.input,yield E}}finally{u.abort(),await p}}async*_streamEventsV1(e,r,n){let s,a=!1;const o=ensureConfig(r),l=o.tags??[],u=o.metadata??{},c=o.runName??this.getName(),d=new LogStreamCallbackHandler({...n,autoClose:!1,_schemaFormat:"streaming_events"}),p=new _RootEventFilter({...n}),m=this._streamLog(e,d,o);for await(const b of m){if(s?s=s.concat(b):s=RunLog.fromRunLogPatch(b),s.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!a){a=!0;const P={...s.state},A={run_id:P.id,event:`on_${P.type}_start`,name:c,tags:l,metadata:u,data:{input:e}};p.includeEvent(A,P.type)&&(yield A)}const E=b.ops.filter(P=>P.path.startsWith("/logs/")).map(P=>P.path.split("/")[2]),T=[...new Set(E)];for(const P of T){let A,I={};const j=s.state.logs[P];if(j.end_time===void 0?j.streamed_output.length>0?A="stream":A="start":A="end",A==="start")j.inputs!==void 0&&(I.input=j.inputs);else if(A==="end")j.inputs!==void 0&&(I.input=j.inputs),I.output=j.final_output;else if(A==="stream"){const K=j.streamed_output.length;if(K!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${K} instead. Encountered in: "${j.name}"`);I={chunk:j.streamed_output[0]},j.streamed_output=[]}yield{event:`on_${j.type}_${A}`,name:j.name,run_id:j.id,tags:j.tags,metadata:j.metadata,data:I}}const{state:S}=s;if(S.streamed_output.length>0){const P=S.streamed_output.length;if(P!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${P} instead. Encountered in: "${S.name}"`);const A={chunk:S.streamed_output[0]};S.streamed_output=[];const I={event:`on_${S.type}_stream`,run_id:S.id,tags:l,metadata:u,name:c,data:A};p.includeEvent(I,S.type)&&(yield I)}}const y=s==null?void 0:s.state;if(y!==void 0){const b={event:`on_${y.type}_end`,name:c,run_id:y.id,tags:l,metadata:u,data:{output:y.final_output}};p.includeEvent(b,y.type)&&(yield b)}}static isRunnable(e){return isRunnableInterface(e)}withListeners({onStart:e,onEnd:r,onError:n}){return new RunnableBinding({bound:this,config:{},configFactories:[s=>({callbacks:[new RootListenersTracer({config:s,onStart:e,onEnd:r,onError:n})]})]})}asTool(e){return convertRunnableToTool(this,e)}}class RunnableBinding extends Runnable{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){const r=mergeConfigs(this.config,...e);return mergeConfigs(r,...this.configFactories?await Promise.all(this.configFactories.map(async n=>await n(r))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new RunnableRetry({bound:this.bound,kwargs:this.kwargs,config:this.config,maxAttemptNumber:e==null?void 0:e.stopAfterAttempt,...e})}async invoke(e,r){return this.bound.invoke(e,await this._mergeConfig(ensureConfig(r),this.kwargs))}async batch(e,r,n){const s=Array.isArray(r)?await Promise.all(r.map(async a=>this._mergeConfig(ensureConfig(a),this.kwargs))):await this._mergeConfig(ensureConfig(r),this.kwargs);return this.bound.batch(e,s,n)}async*_streamIterator(e,r){yield*this.bound._streamIterator(e,await this._mergeConfig(ensureConfig(r),this.kwargs))}async stream(e,r){return this.bound.stream(e,await this._mergeConfig(ensureConfig(r),this.kwargs))}async*transform(e,r){yield*this.bound.transform(e,await this._mergeConfig(ensureConfig(r),this.kwargs))}streamEvents(e,r,n){const s=this,a=async function*(){yield*s.bound.streamEvents(e,{...await s._mergeConfig(ensureConfig(r),s.kwargs),version:r.version},n)};return IterableReadableStream.fromAsyncGenerator(a())}static isRunnableBinding(e){return e.bound&&Runnable.isRunnable(e.bound)}withListeners({onStart:e,onEnd:r,onError:n}){return new RunnableBinding({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[s=>({callbacks:[new RootListenersTracer({config:s,onStart:e,onEnd:r,onError:n})]})]})}}class RunnableEach extends Runnable{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new RunnableEach({bound:this.bound.bind(e)})}async invoke(e,r){return this._callWithConfig(this._invoke.bind(this),e,r)}async _invoke(e,r,n){return this.bound.batch(e,patchConfig(r,{callbacks:n==null?void 0:n.getChild()}))}withListeners({onStart:e,onEnd:r,onError:n}){return new RunnableEach({bound:this.bound.withListeners({onStart:e,onEnd:r,onError:n})})}}class RunnableRetry extends RunnableBinding{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,r,n){const s=e>1?`retry:attempt:${e}`:void 0;return patchConfig(r,{callbacks:n==null?void 0:n.getChild(s)})}async _invoke(e,r,n){return pRetry(s=>super.invoke(e,this._patchConfigForRetry(s,r,n)),{onFailedAttempt:s=>this.onFailedAttempt(s,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,r){return this._callWithConfig(this._invoke.bind(this),e,r)}async _batch(e,r,n,s){const a={};try{await pRetry(async o=>{const l=e.map((m,y)=>y).filter(m=>a[m.toString()]===void 0||a[m.toString()]instanceof Error),u=l.map(m=>e[m]),c=l.map(m=>this._patchConfigForRetry(o,r==null?void 0:r[m],n==null?void 0:n[m])),d=await super.batch(u,c,{...s,returnExceptions:!0});let p;for(let m=0;m<d.length;m+=1){const y=d[m],b=l[m];y instanceof Error&&p===void 0&&(p=y,p.input=u[m]),a[b.toString()]=y}if(p)throw p;return d},{onFailedAttempt:o=>this.onFailedAttempt(o,o.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(o){if((s==null?void 0:s.returnExceptions)!==!0)throw o}return Object.keys(a).sort((o,l)=>parseInt(o,10)-parseInt(l,10)).map(o=>a[parseInt(o,10)])}async batch(e,r,n){return this._batchWithConfig(this._batch.bind(this),e,r,n)}}class RunnableSequence extends Runnable{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"omitSequenceTags",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name,this.omitSequenceTags=e.omitSequenceTags??this.omitSequenceTags}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,r){var u;const n=ensureConfig(r),s=await getCallbackManagerForConfig(n),a=await(s==null?void 0:s.handleChainStart(this.toJSON(),_coerceToDict(e,"input"),n.runId,void 0,void 0,void 0,n==null?void 0:n.runName));delete n.runId;let o=e,l;try{const c=[this.first,...this.middle];for(let d=0;d<c.length;d+=1){const m=c[d].invoke(o,patchConfig(n,{callbacks:a==null?void 0:a.getChild(this.omitSequenceTags?void 0:`seq:step:${d+1}`)}));o=await raceWithSignal(m,r==null?void 0:r.signal)}if((u=r==null?void 0:r.signal)!=null&&u.aborted)throw new Error("Aborted");l=await this.last.invoke(o,patchConfig(n,{callbacks:a==null?void 0:a.getChild(this.omitSequenceTags?void 0:`seq:step:${this.steps.length}`)}))}catch(c){throw await(a==null?void 0:a.handleChainError(c)),c}return await(a==null?void 0:a.handleChainEnd(_coerceToDict(l,"output"))),l}async batch(e,r,n){var u;const s=this._getOptionsList(r??{},e.length),a=await Promise.all(s.map(getCallbackManagerForConfig)),o=await Promise.all(a.map(async(c,d)=>{const p=await(c==null?void 0:c.handleChainStart(this.toJSON(),_coerceToDict(e[d],"input"),s[d].runId,void 0,void 0,void 0,s[d].runName));return delete s[d].runId,p}));let l=e;try{for(let c=0;c<this.steps.length;c+=1){const p=this.steps[c].batch(l,o.map((m,y)=>{const b=m==null?void 0:m.getChild(this.omitSequenceTags?void 0:`seq:step:${c+1}`);return patchConfig(s[y],{callbacks:b})}),n);l=await raceWithSignal(p,(u=s[0])==null?void 0:u.signal)}}catch(c){throw await Promise.all(o.map(d=>d==null?void 0:d.handleChainError(c))),c}return await Promise.all(o.map(c=>c==null?void 0:c.handleChainEnd(_coerceToDict(l,"output")))),l}async*_streamIterator(e,r){var p;const n=await getCallbackManagerForConfig(r),{runId:s,...a}=r??{},o=await(n==null?void 0:n.handleChainStart(this.toJSON(),_coerceToDict(e,"input"),s,void 0,void 0,void 0,a==null?void 0:a.runName)),l=[this.first,...this.middle,this.last];let u=!0,c;async function*d(){yield e}try{let m=l[0].transform(d(),patchConfig(a,{callbacks:o==null?void 0:o.getChild(this.omitSequenceTags?void 0:"seq:step:1")}));for(let y=1;y<l.length;y+=1)m=await l[y].transform(m,patchConfig(a,{callbacks:o==null?void 0:o.getChild(this.omitSequenceTags?void 0:`seq:step:${y+1}`)}));for await(const y of m)if((p=r==null?void 0:r.signal)==null||p.throwIfAborted(),yield y,u)if(c===void 0)c=y;else try{c=concat(c,y)}catch{c=void 0,u=!1}}catch(m){throw await(o==null?void 0:o.handleChainError(m)),m}await(o==null?void 0:o.handleChainEnd(_coerceToDict(c,"output")))}getGraph(e){const r=new Graph;let n=null;return this.steps.forEach((s,a)=>{const o=s.getGraph(e);a!==0&&o.trimFirstNode(),a!==this.steps.length-1&&o.trimLastNode(),r.extend(o);const l=o.firstNode();if(!l)throw new Error(`Runnable ${s} has no first node`);n&&r.addEdge(n,l),n=o.lastNode()}),r}pipe(e){return RunnableSequence.isRunnableSequence(e)?new RunnableSequence({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}):new RunnableSequence({first:this.first,middle:[...this.middle,this.last],last:_coerceToRunnable(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&Runnable.isRunnable(e)}static from([e,...r],n){let s={};return typeof n=="string"?s.name=n:n!==void 0&&(s=n),new RunnableSequence({...s,first:_coerceToRunnable(e),middle:r.slice(0,-1).map(_coerceToRunnable),last:_coerceToRunnable(r[r.length-1])})}}class RunnableMap extends Runnable{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[r,n]of Object.entries(e.steps))this.steps[r]=_coerceToRunnable(n)}static from(e){return new RunnableMap({steps:e})}async invoke(e,r){const n=ensureConfig(r),s=await getCallbackManagerForConfig(n),a=await(s==null?void 0:s.handleChainStart(this.toJSON(),{input:e},n.runId,void 0,void 0,void 0,n==null?void 0:n.runName));delete n.runId;const o={};try{const l=Object.entries(this.steps).map(async([u,c])=>{o[u]=await c.invoke(e,patchConfig(n,{callbacks:a==null?void 0:a.getChild(`map:key:${u}`)}))});await raceWithSignal(Promise.all(l),r==null?void 0:r.signal)}catch(l){throw await(a==null?void 0:a.handleChainError(l)),l}return await(a==null?void 0:a.handleChainEnd(o)),o}async*_transform(e,r,n){const s={...this.steps},a=atee(e,Object.keys(s).length),o=new Map(Object.entries(s).map(([l,u],c)=>{const d=u.transform(a[c],patchConfig(n,{callbacks:r==null?void 0:r.getChild(`map:key:${l}`)}));return[l,d.next().then(p=>({key:l,gen:d,result:p}))]}));for(;o.size;){const l=Promise.race(o.values()),{key:u,result:c,gen:d}=await raceWithSignal(l,n==null?void 0:n.signal);o.delete(u),c.done||(yield{[u]:c.value},o.set(u,d.next().then(p=>({key:u,gen:d,result:p}))))}}transform(e,r){return this._transformStreamWithConfig(e,this._transform.bind(this),r)}async stream(e,r){async function*n(){yield e}const s=ensureConfig(r),a=new AsyncGeneratorWithSetup({generator:this.transform(n(),s),config:s});return await a.setup,IterableReadableStream.fromAsyncGenerator(a)}}class RunnableTraceable extends Runnable{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!isTraceableFunction(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,r){const[n]=this._getOptionsList(r??{},1),s=await getCallbackManagerForConfig(n),a=this.func(patchConfig(n,{callbacks:s}),e);return raceWithSignal(a,n==null?void 0:n.signal)}async*_streamIterator(e,r){var a,o;const[n]=this._getOptionsList(r??{},1),s=await this.invoke(e,r);if(isAsyncIterable(s)){for await(const l of s)(a=n==null?void 0:n.signal)==null||a.throwIfAborted(),yield l;return}if(isIterator(s)){for(;;){(o=n==null?void 0:n.signal)==null||o.throwIfAborted();const l=s.next();if(l.done)break;yield l.value}return}yield s}static from(e){return new RunnableTraceable({func:e})}}function assertNonTraceableFunction(t){if(isTraceableFunction(t))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}class RunnableLambda extends Runnable{static lc_name(){return"RunnableLambda"}constructor(e){if(isTraceableFunction(e.func))return RunnableTraceable.from(e.func);super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),assertNonTraceableFunction(e.func),this.func=e.func}static from(e){return new RunnableLambda({func:e})}async _invoke(e,r,n){return new Promise((s,a)=>{const o=patchConfig(r,{callbacks:n==null?void 0:n.getChild(),recursionLimit:((r==null?void 0:r.recursionLimit)??DEFAULT_RECURSION_LIMIT)-1});AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(o),async()=>{var l,u;try{let c=await this.func(e,{...o});if(c&&Runnable.isRunnable(c)){if((r==null?void 0:r.recursionLimit)===0)throw new Error("Recursion limit reached.");c=await c.invoke(e,{...o,recursionLimit:(o.recursionLimit??DEFAULT_RECURSION_LIMIT)-1})}else if(isAsyncIterable(c)){let d;for await(const p of consumeAsyncIterableInContext(o,c))if((l=r==null?void 0:r.signal)==null||l.throwIfAborted(),d===void 0)d=p;else try{d=concat(d,p)}catch{d=p}c=d}else if(isIterableIterator(c)){let d;for(const p of consumeIteratorInContext(o,c))if((u=r==null?void 0:r.signal)==null||u.throwIfAborted(),d===void 0)d=p;else try{d=concat(d,p)}catch{d=p}c=d}s(c)}catch(c){a(c)}})})}async invoke(e,r){return this._callWithConfig(this._invoke.bind(this),e,r)}async*_transform(e,r,n){var l,u;let s;for await(const c of e)if(s===void 0)s=c;else try{s=concat(s,c)}catch{s=c}const a=patchConfig(n,{callbacks:r==null?void 0:r.getChild(),recursionLimit:((n==null?void 0:n.recursionLimit)??DEFAULT_RECURSION_LIMIT)-1}),o=await new Promise((c,d)=>{AsyncLocalStorageProviderSingleton.runWithConfig(pickRunnableConfigKeys(a),async()=>{try{const p=await this.func(s,{...a,config:a});c(p)}catch(p){d(p)}})});if(o&&Runnable.isRunnable(o)){if((n==null?void 0:n.recursionLimit)===0)throw new Error("Recursion limit reached.");const c=await o.stream(s,a);for await(const d of c)yield d}else if(isAsyncIterable(o))for await(const c of consumeAsyncIterableInContext(a,o))(l=n==null?void 0:n.signal)==null||l.throwIfAborted(),yield c;else if(isIterableIterator(o))for(const c of consumeIteratorInContext(a,o))(u=n==null?void 0:n.signal)==null||u.throwIfAborted(),yield c;else yield o}transform(e,r){return this._transformStreamWithConfig(e,this._transform.bind(this),r)}async stream(e,r){async function*n(){yield e}const s=ensureConfig(r),a=new AsyncGeneratorWithSetup({generator:this.transform(n(),s),config:s});return await a.setup,IterableReadableStream.fromAsyncGenerator(a)}}class RunnableWithFallbacks extends Runnable{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,r){const n=ensureConfig(r),s=await getCallbackManagerForConfig(n),{runId:a,...o}=n,l=await(s==null?void 0:s.handleChainStart(this.toJSON(),_coerceToDict(e,"input"),a,void 0,void 0,void 0,o==null?void 0:o.runName)),u=patchConfig(o,{callbacks:l==null?void 0:l.getChild()});return await AsyncLocalStorageProviderSingleton.runWithConfig(u,async()=>{var p;let d;for(const m of this.runnables()){(p=n==null?void 0:n.signal)==null||p.throwIfAborted();try{const y=await m.invoke(e,u);return await(l==null?void 0:l.handleChainEnd(_coerceToDict(y,"output"))),y}catch(y){d===void 0&&(d=y)}}throw d===void 0?new Error("No error stored at end of fallback."):(await(l==null?void 0:l.handleChainError(d)),d)})}async*_streamIterator(e,r){var p;const n=ensureConfig(r),s=await getCallbackManagerForConfig(n),{runId:a,...o}=n,l=await(s==null?void 0:s.handleChainStart(this.toJSON(),_coerceToDict(e,"input"),a,void 0,void 0,void 0,o==null?void 0:o.runName));let u,c;for(const m of this.runnables()){(p=n==null?void 0:n.signal)==null||p.throwIfAborted();const y=patchConfig(o,{callbacks:l==null?void 0:l.getChild()});try{const b=await m.stream(e,y);c=consumeAsyncIterableInContext(y,b);break}catch(b){u===void 0&&(u=b)}}if(c===void 0){const m=u??new Error("No error stored at end of fallback.");throw await(l==null?void 0:l.handleChainError(m)),m}let d;try{for await(const m of c){yield m;try{d=d===void 0?d:concat(d,m)}catch{d=void 0}}}catch(m){throw await(l==null?void 0:l.handleChainError(m)),m}await(l==null?void 0:l.handleChainEnd(_coerceToDict(d,"output")))}async batch(e,r,n){var u;if(n!=null&&n.returnExceptions)throw new Error("Not implemented.");const s=this._getOptionsList(r??{},e.length),a=await Promise.all(s.map(c=>getCallbackManagerForConfig(c))),o=await Promise.all(a.map(async(c,d)=>{const p=await(c==null?void 0:c.handleChainStart(this.toJSON(),_coerceToDict(e[d],"input"),s[d].runId,void 0,void 0,void 0,s[d].runName));return delete s[d].runId,p}));let l;for(const c of this.runnables()){(u=s[0].signal)==null||u.throwIfAborted();try{const d=await c.batch(e,o.map((p,m)=>patchConfig(s[m],{callbacks:p==null?void 0:p.getChild()})),n);return await Promise.all(o.map((p,m)=>p==null?void 0:p.handleChainEnd(_coerceToDict(d[m],"output")))),d}catch(d){l===void 0&&(l=d)}}throw l?(await Promise.all(o.map(c=>c==null?void 0:c.handleChainError(l))),l):new Error("No error stored at end of fallbacks.")}}function _coerceToRunnable(t){if(typeof t=="function")return new RunnableLambda({func:t});if(Runnable.isRunnable(t))return t;if(!Array.isArray(t)&&typeof t=="object"){const e={};for(const[r,n]of Object.entries(t))e[r]=_coerceToRunnable(n);return new RunnableMap({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}class RunnableAssign extends Runnable{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof RunnableMap&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,r){const n=await this.mapper.invoke(e,r);return{...e,...n}}async*_transform(e,r,n){const s=this.mapper.getStepsKeys(),[a,o]=atee(e),l=this.mapper.transform(o,patchConfig(n,{callbacks:r==null?void 0:r.getChild()})),u=l.next();for await(const c of a){if(typeof c!="object"||Array.isArray(c))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof c}`);const d=Object.fromEntries(Object.entries(c).filter(([p])=>!s.includes(p)));Object.keys(d).length>0&&(yield d)}yield(await u).value;for await(const c of l)yield c}transform(e,r){return this._transformStreamWithConfig(e,this._transform.bind(this),r)}async stream(e,r){async function*n(){yield e}const s=ensureConfig(r),a=new AsyncGeneratorWithSetup({generator:this.transform(n(),s),config:s});return await a.setup,IterableReadableStream.fromAsyncGenerator(a)}}class RunnablePick extends Runnable{static lc_name(){return"RunnablePick"}constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const r=this.keys.map(n=>[n,e[n]]).filter(n=>n[1]!==void 0);return r.length===0?void 0:Object.fromEntries(r)}}async invoke(e,r){return this._callWithConfig(this._pick.bind(this),e,r)}async*_transform(e){for await(const r of e){const n=await this._pick(r);n!==void 0&&(yield n)}}transform(e,r){return this._transformStreamWithConfig(e,this._transform.bind(this),r)}async stream(e,r){async function*n(){yield e}const s=ensureConfig(r),a=new AsyncGeneratorWithSetup({generator:this.transform(n(),s),config:s});return await a.setup,IterableReadableStream.fromAsyncGenerator(a)}}class RunnableToolLike extends RunnableBinding{constructor(e){const r=RunnableSequence.from([RunnableLambda.from(async n=>{let s;if(_isToolCall(n))try{s=await this.schema.parseAsync(n.args)}catch{throw new ToolInputParsingException("Received tool input did not match expected schema",JSON.stringify(n.args))}else s=n;return s}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:r,config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}}function convertRunnableToTool(t,e){var s;const r=e.name??t.getName(),n=e.description??((s=e.schema)==null?void 0:s.description);return e.schema.constructor===ZodString?new RunnableToolLike({name:r,description:n,schema:objectType({input:stringType()}).transform(a=>a.input),bound:t}):new RunnableToolLike({name:r,description:n,schema:e.schema,bound:t})}class BaseMemory{}/*
 * [js-sha1]{@link https://github.com/emn178/js-sha1}
 *
 * @version 0.6.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */var root$1=typeof window=="object"?window:{},HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],blocks=[];function Sha1(t){t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Sha1.prototype.update=function(t){if(!this.finalized){var e=typeof t!="string";e&&t.constructor===root$1.ArrayBuffer&&(t=new Uint8Array(t));for(var r,n=0,s,a=t.length||0,o=this.blocks;n<a;){if(this.hashed&&(this.hashed=!1,o[0]=this.block,o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0),e)for(s=this.start;n<a&&s<64;++n)o[s>>2]|=t[n]<<SHIFT[s++&3];else for(s=this.start;n<a&&s<64;++n)r=t.charCodeAt(n),r<128?o[s>>2]|=r<<SHIFT[s++&3]:r<2048?(o[s>>2]|=(192|r>>6)<<SHIFT[s++&3],o[s>>2]|=(128|r&63)<<SHIFT[s++&3]):r<55296||r>=57344?(o[s>>2]|=(224|r>>12)<<SHIFT[s++&3],o[s>>2]|=(128|r>>6&63)<<SHIFT[s++&3],o[s>>2]|=(128|r&63)<<SHIFT[s++&3]):(r=65536+((r&1023)<<10|t.charCodeAt(++n)&1023),o[s>>2]|=(240|r>>18)<<SHIFT[s++&3],o[s>>2]|=(128|r>>12&63)<<SHIFT[s++&3],o[s>>2]|=(128|r>>6&63)<<SHIFT[s++&3],o[s>>2]|=(128|r&63)<<SHIFT[s++&3]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.block=o[16],this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};Sha1.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[16]=this.block,t[e>>2]|=EXTRA[e&3],this.block=t[16],e>=56&&(this.hashed||this.hash(),t[0]=this.block,t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.hBytes<<3|this.bytes>>>29,t[15]=this.bytes<<3,this.hash()}};Sha1.prototype.hash=function(){var t=this.h0,e=this.h1,r=this.h2,n=this.h3,s=this.h4,a,o,l,u=this.blocks;for(o=16;o<80;++o)l=u[o-3]^u[o-8]^u[o-14]^u[o-16],u[o]=l<<1|l>>>31;for(o=0;o<20;o+=5)a=e&r|~e&n,l=t<<5|t>>>27,s=l+a+s+1518500249+u[o]<<0,e=e<<30|e>>>2,a=t&e|~t&r,l=s<<5|s>>>27,n=l+a+n+1518500249+u[o+1]<<0,t=t<<30|t>>>2,a=s&t|~s&e,l=n<<5|n>>>27,r=l+a+r+1518500249+u[o+2]<<0,s=s<<30|s>>>2,a=n&s|~n&t,l=r<<5|r>>>27,e=l+a+e+1518500249+u[o+3]<<0,n=n<<30|n>>>2,a=r&n|~r&s,l=e<<5|e>>>27,t=l+a+t+1518500249+u[o+4]<<0,r=r<<30|r>>>2;for(;o<40;o+=5)a=e^r^n,l=t<<5|t>>>27,s=l+a+s+1859775393+u[o]<<0,e=e<<30|e>>>2,a=t^e^r,l=s<<5|s>>>27,n=l+a+n+1859775393+u[o+1]<<0,t=t<<30|t>>>2,a=s^t^e,l=n<<5|n>>>27,r=l+a+r+1859775393+u[o+2]<<0,s=s<<30|s>>>2,a=n^s^t,l=r<<5|r>>>27,e=l+a+e+1859775393+u[o+3]<<0,n=n<<30|n>>>2,a=r^n^s,l=e<<5|e>>>27,t=l+a+t+1859775393+u[o+4]<<0,r=r<<30|r>>>2;for(;o<60;o+=5)a=e&r|e&n|r&n,l=t<<5|t>>>27,s=l+a+s-1894007588+u[o]<<0,e=e<<30|e>>>2,a=t&e|t&r|e&r,l=s<<5|s>>>27,n=l+a+n-1894007588+u[o+1]<<0,t=t<<30|t>>>2,a=s&t|s&e|t&e,l=n<<5|n>>>27,r=l+a+r-1894007588+u[o+2]<<0,s=s<<30|s>>>2,a=n&s|n&t|s&t,l=r<<5|r>>>27,e=l+a+e-1894007588+u[o+3]<<0,n=n<<30|n>>>2,a=r&n|r&s|n&s,l=e<<5|e>>>27,t=l+a+t-1894007588+u[o+4]<<0,r=r<<30|r>>>2;for(;o<80;o+=5)a=e^r^n,l=t<<5|t>>>27,s=l+a+s-899497514+u[o]<<0,e=e<<30|e>>>2,a=t^e^r,l=s<<5|s>>>27,n=l+a+n-899497514+u[o+1]<<0,t=t<<30|t>>>2,a=s^t^e,l=n<<5|n>>>27,r=l+a+r-899497514+u[o+2]<<0,s=s<<30|s>>>2,a=n^s^t,l=r<<5|r>>>27,e=l+a+e-899497514+u[o+3]<<0,n=n<<30|n>>>2,a=r^n^s,l=e<<5|e>>>27,t=l+a+t-899497514+u[o+4]<<0,r=r<<30|r>>>2;this.h0=this.h0+t<<0,this.h1=this.h1+e<<0,this.h2=this.h2+r<<0,this.h3=this.h3+n<<0,this.h4=this.h4+s<<0};Sha1.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,r=this.h2,n=this.h3,s=this.h4;return HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[t&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[e&15]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[r&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[n&15]+HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[s&15]};Sha1.prototype.toString=Sha1.prototype.hex;Sha1.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,r=this.h2,n=this.h3,s=this.h4;return[t>>24&255,t>>16&255,t>>8&255,t&255,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24&255,r>>16&255,r>>8&255,r&255,n>>24&255,n>>16&255,n>>8&255,n&255,s>>24&255,s>>16&255,s>>8&255,s&255]};Sha1.prototype.array=Sha1.prototype.digest;Sha1.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(20),e=new DataView(t);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),t};const insecureHash=t=>new Sha1(!0).update(t).hex(),getCacheKey=(...t)=>insecureHash(t.join("_"));class BaseCache{}const GLOBAL_MAP=new Map;class InMemoryCache extends BaseCache{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,r){return Promise.resolve(this.cache.get(getCacheKey(e,r))??null)}async update(e,r,n){this.cache.set(getCacheKey(e,r),n)}static global(){return new InMemoryCache(GLOBAL_MAP)}}class BasePromptValue extends Serializable{}class StringPromptValue extends BasePromptValue{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new HumanMessage(this.value)]}}class ChatPromptValue extends BasePromptValue{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return getBufferString(this.messages)}toChatMessages(){return this.messages}}class ImagePromptValue extends BasePromptValue{static lc_name(){return"ImagePromptValue"}constructor(e){"imageUrl"in e||(e={imageUrl:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"imageUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.imageUrl=e.imageUrl}toString(){return this.imageUrl.url}toChatMessages(){return[new HumanMessage({content:[{type:"image_url",image_url:{detail:this.imageUrl.detail,url:this.imageUrl.url}}]})]}}var base64Js={},hasRequiredBase64Js;function requireBase64Js(){if(hasRequiredBase64Js)return base64Js;hasRequiredBase64Js=1,base64Js.byteLength=l,base64Js.toByteArray=c,base64Js.fromByteArray=m;for(var t=[],e=[],r=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=n.length;s<a;++s)t[s]=n[s],e[n.charCodeAt(s)]=s;e[45]=62,e[95]=63;function o(y){var b=y.length;if(b%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var E=y.indexOf("=");E===-1&&(E=b);var T=E===b?0:4-E%4;return[E,T]}function l(y){var b=o(y),E=b[0],T=b[1];return(E+T)*3/4-T}function u(y,b,E){return(b+E)*3/4-E}function c(y){var b,E=o(y),T=E[0],S=E[1],P=new r(u(y,T,S)),A=0,I=S>0?T-4:T,j;for(j=0;j<I;j+=4)b=e[y.charCodeAt(j)]<<18|e[y.charCodeAt(j+1)]<<12|e[y.charCodeAt(j+2)]<<6|e[y.charCodeAt(j+3)],P[A++]=b>>16&255,P[A++]=b>>8&255,P[A++]=b&255;return S===2&&(b=e[y.charCodeAt(j)]<<2|e[y.charCodeAt(j+1)]>>4,P[A++]=b&255),S===1&&(b=e[y.charCodeAt(j)]<<10|e[y.charCodeAt(j+1)]<<4|e[y.charCodeAt(j+2)]>>2,P[A++]=b>>8&255,P[A++]=b&255),P}function d(y){return t[y>>18&63]+t[y>>12&63]+t[y>>6&63]+t[y&63]}function p(y,b,E){for(var T,S=[],P=b;P<E;P+=3)T=(y[P]<<16&16711680)+(y[P+1]<<8&65280)+(y[P+2]&255),S.push(d(T));return S.join("")}function m(y){for(var b,E=y.length,T=E%3,S=[],P=16383,A=0,I=E-T;A<I;A+=P)S.push(p(y,A,A+P>I?I:A+P));return T===1?(b=y[E-1],S.push(t[b>>2]+t[b<<4&63]+"==")):T===2&&(b=(y[E-2]<<8)+y[E-1],S.push(t[b>>10]+t[b>>4&63]+t[b<<2&63]+"=")),S.join("")}return base64Js}var base64JsExports=requireBase64Js();const base64=getDefaultExportFromCjs(base64JsExports);var __defProp=Object.defineProperty,__defNormalProp=(t,e,r)=>e in t?__defProp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,__publicField=(t,e,r)=>(__defNormalProp(t,e+"",r),r);function bytePairMerge(t,e){let r=Array.from({length:t.length},(n,s)=>({start:s,end:s+1}));for(;r.length>1;){let n=null;for(let s=0;s<r.length-1;s++){const a=t.slice(r[s].start,r[s+1].end),o=e.get(a.join(","));o!=null&&(n==null||o<n[0])&&(n=[o,s])}if(n!=null){const s=n[1];r[s]={start:r[s].start,end:r[s+1].end},r.splice(s+1,1)}else break}return r}function bytePairEncode(t,e){return t.length===1?[e.get(t.join(","))]:bytePairMerge(t,e).map(r=>e.get(t.slice(r.start,r.end).join(","))).filter(r=>r!=null)}function escapeRegex(t){return t.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var _Tiktoken=class{constructor(t,e){En(this,"specialTokens");En(this,"inverseSpecialTokens");En(this,"patStr");En(this,"textEncoder",new TextEncoder);En(this,"textDecoder",new TextDecoder("utf-8"));En(this,"rankMap",new Map);En(this,"textMap",new Map);this.patStr=t.pat_str;const r=t.bpe_ranks.split(`
`).filter(Boolean).reduce((n,s)=>{const[a,o,...l]=s.split(" "),u=Number.parseInt(o,10);return l.forEach((c,d)=>n[c]=u+d),n},{});for(const[n,s]of Object.entries(r)){const a=base64.toByteArray(n);this.rankMap.set(a.join(","),s),this.textMap.set(s,a)}this.specialTokens={...t.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((n,[s,a])=>(n[a]=this.textEncoder.encode(s),n),{})}encode(t,e=[],r="all"){const n=new RegExp(this.patStr,"ug"),s=_Tiktoken.specialTokenRegex(Object.keys(this.specialTokens)),a=[],o=new Set(e==="all"?Object.keys(this.specialTokens):e),l=new Set(r==="all"?Object.keys(this.specialTokens).filter(c=>!o.has(c)):r);if(l.size>0){const c=_Tiktoken.specialTokenRegex([...l]),d=t.match(c);if(d!=null)throw new Error(`The text contains a special token that is not allowed: ${d[0]}`)}let u=0;for(;;){let c=null,d=u;for(;s.lastIndex=d,c=s.exec(t),!(c==null||o.has(c[0]));)d=c.index+1;const p=(c==null?void 0:c.index)??t.length;for(const y of t.substring(u,p).matchAll(n)){const b=this.textEncoder.encode(y[0]),E=this.rankMap.get(b.join(","));if(E!=null){a.push(E);continue}a.push(...bytePairEncode(b,this.rankMap))}if(c==null)break;let m=this.specialTokens[c[0]];a.push(m),u=c.index+c[0].length}return a}decode(t){const e=[];let r=0;for(let a=0;a<t.length;++a){const o=t[a],l=this.textMap.get(o)??this.inverseSpecialTokens[o];l!=null&&(e.push(l),r+=l.length)}const n=new Uint8Array(r);let s=0;for(const a of e)n.set(a,s),s+=a.length;return this.textDecoder.decode(n)}},Tiktoken=_Tiktoken;__publicField(Tiktoken,"specialTokenRegex",t=>new RegExp(t.map(e=>escapeRegex(e)).join("|"),"g"));function getEncodingNameForModel(t){switch(t){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-2024-11-20":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"gpt-4o-search-preview":case"gpt-4o-search-preview-2025-03-11":case"gpt-4o-mini-search-preview":case"gpt-4o-mini-search-preview-2025-03-11":case"gpt-4o-audio-preview":case"gpt-4o-audio-preview-2024-12-17":case"gpt-4o-audio-preview-2024-10-01":case"gpt-4o-mini-audio-preview":case"gpt-4o-mini-audio-preview-2024-12-17":case"o1":case"o1-2024-12-17":case"o1-mini":case"o1-mini-2024-09-12":case"o1-preview":case"o1-preview-2024-09-12":case"o1-pro":case"o1-pro-2025-03-19":case"o3":case"o3-2025-04-16":case"o3-mini":case"o3-mini-2025-01-31":case"o4-mini":case"o4-mini-2025-04-16":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":case"gpt-4o-realtime-preview-2024-12-17":case"gpt-4o-mini-realtime-preview":case"gpt-4o-mini-realtime-preview-2024-12-17":case"gpt-4.1":case"gpt-4.1-2025-04-14":case"gpt-4.1-mini":case"gpt-4.1-mini-2025-04-14":case"gpt-4.1-nano":case"gpt-4.1-nano-2025-04-14":case"gpt-4.5-preview":case"gpt-4.5-preview-2025-02-27":return"o200k_base";default:throw new Error("Unknown model")}}const cache={},caller=new AsyncCaller({});async function getEncoding(t){return t in cache||(cache[t]=caller.fetch(`https://tiktoken.pages.dev/js/${t}.json`).then(e=>e.json()).then(e=>new Tiktoken(e)).catch(e=>{throw delete cache[t],e})),await cache[t]}async function encodingForModel(t){return getEncoding(getEncodingNameForModel(t))}const getModelNameForTiktoken=t=>t.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":t.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":t.startsWith("gpt-4-32k")?"gpt-4-32k":t.startsWith("gpt-4-")?"gpt-4":t.startsWith("gpt-4o")?"gpt-4o":t;function isOpenAITool(t){return typeof t!="object"||!t?!1:!!("type"in t&&t.type==="function"&&"function"in t&&typeof t.function=="object"&&t.function&&"name"in t.function&&"parameters"in t.function)}const getVerbosity=()=>!1;class BaseLangChain extends Runnable{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??getVerbosity(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class BaseLanguageModel extends BaseLangChain{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:r,...n}){const{cache:s,...a}=n;super({callbacks:e??r,...a}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof s=="object"?this.cache=s:s?this.cache=InMemoryCache.global():this.cache=void 0,this.caller=new AsyncCaller(n??{})}async getNumTokens(e){if(typeof e!="string")return 0;let r=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await encodingForModel("modelName"in this?getModelNameForTiktoken(this.modelName):"gpt2")}catch(n){console.warn("Failed to calculate number of tokens, falling back to approximate count",n)}if(this._encoding)try{r=this._encoding.encode(e).length}catch(n){console.warn("Failed to calculate number of tokens, falling back to approximate count",n)}return r}static _convertInputToPromptValue(e){return typeof e=="string"?new StringPromptValue(e):Array.isArray(e)?new ChatPromptValue(e.map(coerceMessageLikeToMessage)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...r}){const n={...this._identifyingParams(),...r,_type:this._llmType(),_model:this._modelType()};return Object.entries(n).filter(([o,l])=>l!==void 0).map(([o,l])=>`${o}:${JSON.stringify(l)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}}const scriptRel="modulepreload",assetsURL=function(t){return"/"+t},seen={},__vitePreload=function t(e,r,n){let s=Promise.resolve();if(r&&r.length>0){let o=function(c){return Promise.all(c.map(d=>Promise.resolve(d).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=o(r.map(c=>{if(c=assetsURL(c),c in seen)return;seen[c]=!0;const d=c.endsWith(".css"),p=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${p}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":scriptRel,d||(m.as="script"),m.crossOrigin="",m.href=c,u&&m.setAttribute("nonce",u),document.head.appendChild(m),d)return new Promise((y,b)=>{m.addEventListener("load",y),m.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};class BasePromptTemplate extends Runnable{get lc_attributes(){return{partialVariables:void 0}}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:r}=e;if(r.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,e)}async mergePartialAndUserVariables(e){const r=this.partialVariables??{},n={};for(const[a,o]of Object.entries(r))typeof o=="string"?n[a]=o:n[a]=await o();return{...n,...e}}async invoke(e,r){const n={...this.metadata,...r==null?void 0:r.metadata},s=[...this.tags??[],...(r==null?void 0:r.tags)??[]];return this._callWithConfig(a=>this.formatPromptValue(a),e,{...r,tags:s,metadata:n,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(e){switch(e._type){case"prompt":{const{PromptTemplate:r}=await __vitePreload(async()=>{const{PromptTemplate:n}=await Promise.resolve().then(()=>prompt);return{PromptTemplate:n}},[]);return r.deserialize(e)}case void 0:{const{PromptTemplate:r}=await __vitePreload(async()=>{const{PromptTemplate:n}=await Promise.resolve().then(()=>prompt);return{PromptTemplate:n}},void 0);return r.deserialize({...e,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:r}=await __vitePreload(async()=>{const{FewShotPromptTemplate:n}=await import("./few_shot-Deu43dST.js");return{FewShotPromptTemplate:n}},[]);return r.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class BaseStringPromptTemplate extends BasePromptTemplate{async formatPromptValue(e){const r=await this.format(e);return new StringPromptValue(r)}}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var objectToString=Object.prototype.toString,isArray=Array.isArray||function t(e){return objectToString.call(e)==="[object Array]"};function isFunction$1(t){return typeof t=="function"}function typeStr(t){return isArray(t)?"array":typeof t}function escapeRegExp(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function hasProperty(t,e){return t!=null&&typeof t=="object"&&e in t}function primitiveHasOwnProperty(t,e){return t!=null&&typeof t!="object"&&t.hasOwnProperty&&t.hasOwnProperty(e)}var regExpTest=RegExp.prototype.test;function testRegExp(t,e){return regExpTest.call(t,e)}var nonSpaceRe=/\S/;function isWhitespace(t){return!testRegExp(nonSpaceRe,t)}var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function escapeHtml(t){return String(t).replace(/[&<>"'`=\/]/g,function(r){return entityMap[r]})}var whiteRe=/\s*/,spaceRe=/\s+/,equalsRe=/\s*=/,curlyRe=/\s*\}/,tagRe=/#|\^|\/|>|\{|&|=|!/;function parseTemplate$1(t,e){if(!t)return[];var r=!1,n=[],s=[],a=[],o=!1,l=!1,u="",c=0;function d(){if(o&&!l)for(;a.length;)delete s[a.pop()];else a=[];o=!1,l=!1}var p,m,y;function b(H){if(typeof H=="string"&&(H=H.split(spaceRe,2)),!isArray(H)||H.length!==2)throw new Error("Invalid tags: "+H);p=new RegExp(escapeRegExp(H[0])+"\\s*"),m=new RegExp("\\s*"+escapeRegExp(H[1])),y=new RegExp("\\s*"+escapeRegExp("}"+H[1]))}b(e||mustache.tags);for(var E=new Scanner(t),T,S,P,A,I,j;!E.eos();){if(T=E.pos,P=E.scanUntil(p),P)for(var K=0,W=P.length;K<W;++K)A=P.charAt(K),isWhitespace(A)?(a.push(s.length),u+=A):(l=!0,r=!0,u+=" "),s.push(["text",A,T,T+1]),T+=1,A===`
`&&(d(),u="",c=0,r=!1);if(!E.scan(p))break;if(o=!0,S=E.scan(tagRe)||"name",E.scan(whiteRe),S==="="?(P=E.scanUntil(equalsRe),E.scan(equalsRe),E.scanUntil(m)):S==="{"?(P=E.scanUntil(y),E.scan(curlyRe),E.scanUntil(m),S="&"):P=E.scanUntil(m),!E.scan(m))throw new Error("Unclosed tag at "+E.pos);if(S==">"?I=[S,P,T,E.pos,u,c,r]:I=[S,P,T,E.pos],c++,s.push(I),S==="#"||S==="^")n.push(I);else if(S==="/"){if(j=n.pop(),!j)throw new Error('Unopened section "'+P+'" at '+T);if(j[1]!==P)throw new Error('Unclosed section "'+j[1]+'" at '+T)}else S==="name"||S==="{"||S==="&"?l=!0:S==="="&&b(P)}if(d(),j=n.pop(),j)throw new Error('Unclosed section "'+j[1]+'" at '+E.pos);return nestTokens(squashTokens(s))}function squashTokens(t){for(var e=[],r,n,s=0,a=t.length;s<a;++s)r=t[s],r&&(r[0]==="text"&&n&&n[0]==="text"?(n[1]+=r[1],n[3]=r[3]):(e.push(r),n=r));return e}function nestTokens(t){for(var e=[],r=e,n=[],s,a,o=0,l=t.length;o<l;++o)switch(s=t[o],s[0]){case"#":case"^":r.push(s),n.push(s),r=s[4]=[];break;case"/":a=n.pop(),a[5]=s[2],r=n.length>0?n[n.length-1][4]:e;break;default:r.push(s)}return e}function Scanner(t){this.string=t,this.tail=t,this.pos=0}Scanner.prototype.eos=function t(){return this.tail===""};Scanner.prototype.scan=function t(e){var r=this.tail.match(e);if(!r||r.index!==0)return"";var n=r[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n};Scanner.prototype.scanUntil=function t(e){var r=this.tail.search(e),n;switch(r){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=n.length,n};function Context(t,e){this.view=t,this.cache={".":this.view},this.parent=e}Context.prototype.push=function t(e){return new Context(e,this)};Context.prototype.lookup=function t(e){var r=this.cache,n;if(r.hasOwnProperty(e))n=r[e];else{for(var s=this,a,o,l,u=!1;s;){if(e.indexOf(".")>0)for(a=s.view,o=e.split("."),l=0;a!=null&&l<o.length;)l===o.length-1&&(u=hasProperty(a,o[l])||primitiveHasOwnProperty(a,o[l])),a=a[o[l++]];else a=s.view[e],u=hasProperty(s.view,e);if(u){n=a;break}s=s.parent}r[e]=n}return isFunction$1(n)&&(n=n.call(this.view)),n};function Writer(){this.templateCache={_cache:{},set:function(e,r){this._cache[e]=r},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}Writer.prototype.clearCache=function t(){typeof this.templateCache<"u"&&this.templateCache.clear()};Writer.prototype.parse=function t(e,r){var n=this.templateCache,s=e+":"+(r||mustache.tags).join(":"),a=typeof n<"u",o=a?n.get(s):void 0;return o==null&&(o=parseTemplate$1(e,r),a&&n.set(s,o)),o};Writer.prototype.render=function t(e,r,n,s){var a=this.getConfigTags(s),o=this.parse(e,a),l=r instanceof Context?r:new Context(r,void 0);return this.renderTokens(o,l,n,e,s)};Writer.prototype.renderTokens=function t(e,r,n,s,a){for(var o="",l,u,c,d=0,p=e.length;d<p;++d)c=void 0,l=e[d],u=l[0],u==="#"?c=this.renderSection(l,r,n,s,a):u==="^"?c=this.renderInverted(l,r,n,s,a):u===">"?c=this.renderPartial(l,r,n,a):u==="&"?c=this.unescapedValue(l,r):u==="name"?c=this.escapedValue(l,r,a):u==="text"&&(c=this.rawValue(l)),c!==void 0&&(o+=c);return o};Writer.prototype.renderSection=function t(e,r,n,s,a){var o=this,l="",u=r.lookup(e[1]);function c(m){return o.render(m,r,n,a)}if(u){if(isArray(u))for(var d=0,p=u.length;d<p;++d)l+=this.renderTokens(e[4],r.push(u[d]),n,s,a);else if(typeof u=="object"||typeof u=="string"||typeof u=="number")l+=this.renderTokens(e[4],r.push(u),n,s,a);else if(isFunction$1(u)){if(typeof s!="string")throw new Error("Cannot use higher-order sections without the original template");u=u.call(r.view,s.slice(e[3],e[5]),c),u!=null&&(l+=u)}else l+=this.renderTokens(e[4],r,n,s,a);return l}};Writer.prototype.renderInverted=function t(e,r,n,s,a){var o=r.lookup(e[1]);if(!o||isArray(o)&&o.length===0)return this.renderTokens(e[4],r,n,s,a)};Writer.prototype.indentPartial=function t(e,r,n){for(var s=r.replace(/[^ \t]/g,""),a=e.split(`
`),o=0;o<a.length;o++)a[o].length&&(o>0||!n)&&(a[o]=s+a[o]);return a.join(`
`)};Writer.prototype.renderPartial=function t(e,r,n,s){if(n){var a=this.getConfigTags(s),o=isFunction$1(n)?n(e[1]):n[e[1]];if(o!=null){var l=e[6],u=e[5],c=e[4],d=o;u==0&&c&&(d=this.indentPartial(o,c,l));var p=this.parse(d,a);return this.renderTokens(p,r,n,d,s)}}};Writer.prototype.unescapedValue=function t(e,r){var n=r.lookup(e[1]);if(n!=null)return n};Writer.prototype.escapedValue=function t(e,r,n){var s=this.getConfigEscape(n)||mustache.escape,a=r.lookup(e[1]);if(a!=null)return typeof a=="number"&&s===mustache.escape?String(a):s(a)};Writer.prototype.rawValue=function t(e){return e[1]};Writer.prototype.getConfigTags=function t(e){return isArray(e)?e:e&&typeof e=="object"?e.tags:void 0};Writer.prototype.getConfigEscape=function t(e){if(e&&typeof e=="object"&&!isArray(e))return e.escape};var mustache={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(t){defaultWriter.templateCache=t},get templateCache(){return defaultWriter.templateCache}},defaultWriter=new Writer;mustache.clearCache=function t(){return defaultWriter.clearCache()};mustache.parse=function t(e,r){return defaultWriter.parse(e,r)};mustache.render=function t(e,r,n,s){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+typeStr(e)+'" was given as the first argument for mustache#render(template, view, partials)');return defaultWriter.render(e,r,n,s)};mustache.escape=escapeHtml;mustache.Scanner=Scanner;mustache.Context=Context;mustache.Writer=Writer;function configureMustache(){mustache.escape=t=>t}const parseFString=t=>{const e=t.split(""),r=[],n=(a,o)=>{for(let l=o;l<e.length;l+=1)if(a.includes(e[l]))return l;return-1};let s=0;for(;s<e.length;)if(e[s]==="{"&&s+1<e.length&&e[s+1]==="{")r.push({type:"literal",text:"{"}),s+=2;else if(e[s]==="}"&&s+1<e.length&&e[s+1]==="}")r.push({type:"literal",text:"}"}),s+=2;else if(e[s]==="{"){const a=n("}",s);if(a<0)throw new Error("Unclosed '{' in template.");r.push({type:"variable",name:e.slice(s+1,a).join("")}),s=a+1}else{if(e[s]==="}")throw new Error("Single '}' in template.");{const a=n("{}",s),o=(a<0?e.slice(s):e.slice(s,a)).join("");r.push({type:"literal",text:o}),s=a<0?e.length:a}}return r},mustacheTemplateToNodes=t=>t.map(e=>e[0]==="name"?{type:"variable",name:e[1].includes(".")?e[1].split(".")[0]:e[1]}:["#","&","^",">"].includes(e[0])?{type:"variable",name:e[1]}:{type:"literal",text:e[1]}),parseMustache=t=>{configureMustache();const e=mustache.parse(t);return mustacheTemplateToNodes(e)},interpolateFString=(t,e)=>parseFString(t).reduce((r,n)=>{if(n.type==="variable"){if(n.name in e){const s=typeof e[n.name]=="string"?e[n.name]:JSON.stringify(e[n.name]);return r+s}throw new Error(`(f-string) Missing value for input ${n.name}`)}return r+n.text},""),interpolateMustache=(t,e)=>(configureMustache(),mustache.render(t,e)),DEFAULT_FORMATTER_MAPPING={"f-string":interpolateFString,mustache:interpolateMustache},DEFAULT_PARSER_MAPPING={"f-string":parseFString,mustache:parseMustache},renderTemplate=(t,e,r)=>{try{return DEFAULT_FORMATTER_MAPPING[e](t,r)}catch(n){throw addLangChainErrorFields$1(n,"INVALID_PROMPT_INPUT")}},parseTemplate=(t,e)=>DEFAULT_PARSER_MAPPING[e](t),checkValidTemplate=(t,e,r)=>{if(!(e in DEFAULT_FORMATTER_MAPPING)){const n=Object.keys(DEFAULT_FORMATTER_MAPPING);throw new Error(`Invalid template format. Got \`${e}\`;
                         should be one of ${n}`)}try{const n=r.reduce((s,a)=>(s[a]="foo",s),{});Array.isArray(t)?t.forEach(s=>{if(s.type==="text")renderTemplate(s.text,e,n);else if(s.type==="image_url")if(typeof s.image_url=="string")renderTemplate(s.image_url,e,n);else{const a=s.image_url.url;renderTemplate(a,e,n)}else throw new Error(`Invalid message template received. ${JSON.stringify(s,null,2)}`)}):renderTemplate(t,e,n)}catch(n){throw new Error(`Invalid prompt schema: ${n.message}`)}};class PromptTemplate extends BaseStringPromptTemplate{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){if(this.templateFormat==="mustache")throw new Error("Mustache templates cannot be validated.");let r=this.inputVariables;this.partialVariables&&(r=r.concat(Object.keys(this.partialVariables))),checkValidTemplate(this.template,this.templateFormat,r)}}_getPromptType(){return"prompt"}async format(e){const r=await this.mergePartialAndUserVariables(e);return renderTemplate(this.template,this.templateFormat,r)}static fromExamples(e,r,n,s=`

`,a=""){const o=[a,...e,r].join(s);return new PromptTemplate({inputVariables:n,template:o})}static fromTemplate(e,r){const{templateFormat:n="f-string",...s}=r??{},a=new Set;return parseTemplate(e,n).forEach(o=>{o.type==="variable"&&a.add(o.name)}),new PromptTemplate({inputVariables:[...a],templateFormat:n,template:e,...s})}async partial(e){const r=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},s={...this,inputVariables:r,partialVariables:n};return new PromptTemplate(s)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new PromptTemplate({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}}const prompt=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate},Symbol.toStringTag,{value:"Module"}));class ImagePromptTemplate extends BasePromptTemplate{static lc_name(){return"ImagePromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","image"]}),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.template=e.template,this.templateFormat=e.templateFormat??this.templateFormat,this.validateTemplate=e.validateTemplate??this.validateTemplate,this.additionalContentFields=e.additionalContentFields,this.validateTemplate){let r=this.inputVariables;this.partialVariables&&(r=r.concat(Object.keys(this.partialVariables))),checkValidTemplate([{type:"image_url",image_url:this.template}],this.templateFormat,r)}}_getPromptType(){return"prompt"}async partial(e){const r=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},s={...this,inputVariables:r,partialVariables:n};return new ImagePromptTemplate(s)}async format(e){const r={};for(const[o,l]of Object.entries(this.template))typeof l=="string"?r[o]=renderTemplate(l,this.templateFormat,e):r[o]=l;const n=e.url||r.url,s=e.detail||r.detail;if(!n)throw new Error("Must provide either an image URL.");if(typeof n!="string")throw new Error("url must be a string.");const a={url:n};return s&&(a.detail=s),a}async formatPromptValue(e){const r=await this.format(e);return new ImagePromptValue(r)}}class DictPromptTemplate extends Runnable{static lc_name(){return"DictPromptTemplate"}constructor(e){const r=e.templateFormat??"f-string",n=_getInputVariables(e.template,r);super({inputVariables:n,...e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","dict"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.template=e.template,this.templateFormat=r,this.inputVariables=n}async format(e){return _insertInputVariables(this.template,e,this.templateFormat)}async invoke(e){return await this._callWithConfig(this.format.bind(this),e,{runType:"prompt"})}}function _getInputVariables(t,e){const r=[];for(const n of Object.values(t))if(typeof n=="string")parseTemplate(n,e).forEach(s=>{s.type==="variable"&&r.push(s.name)});else if(Array.isArray(n))for(const s of n)typeof s=="string"?parseTemplate(s,e).forEach(a=>{a.type==="variable"&&r.push(a.name)}):typeof s=="object"&&r.push(..._getInputVariables(s,e));else typeof n=="object"&&n!==null&&r.push(..._getInputVariables(n,e));return Array.from(new Set(r))}function _insertInputVariables(t,e,r){const n={};for(const[s,a]of Object.entries(t))if(typeof a=="string")n[s]=renderTemplate(a,r,e);else if(Array.isArray(a)){const o=[];for(const l of a)typeof l=="string"?o.push(renderTemplate(l,r,e)):typeof l=="object"&&o.push(_insertInputVariables(l,e,r));n[s]=o}else typeof a=="object"&&a!==null?n[s]=_insertInputVariables(a,e,r):n[s]=a;return n}class BaseMessagePromptTemplate extends Runnable{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}async invoke(e,r){return this._callWithConfig(n=>this.formatMessages(n),e,{...r,runType:"prompt"})}}class MessagesPlaceholder extends BaseMessagePromptTemplate{static lc_name(){return"MessagesPlaceholder"}constructor(e){typeof e=="string"&&(e={variableName:e}),super(e),Object.defineProperty(this,"variableName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"optional",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.variableName=e.variableName,this.optional=e.optional??!1}get inputVariables(){return[this.variableName]}async formatMessages(e){const r=e[this.variableName];if(this.optional&&!r)return[];if(!r){const s=new Error(`Field "${this.variableName}" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages as an input value. Received: undefined`);throw s.name="InputFormatError",s}let n;try{Array.isArray(r)?n=r.map(coerceMessageLikeToMessage):n=[coerceMessageLikeToMessage(r)]}catch(s){const a=typeof r=="string"?r:JSON.stringify(r,null,2),o=new Error([`Field "${this.variableName}" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages or coerceable values as input.`,`Received value: ${a}`,`Additional message: ${s.message}`].join(`

`));throw o.name="InputFormatError",o.lc_error_code=s.lc_error_code,o}return n}}class BaseMessageStringPromptTemplate extends BaseMessagePromptTemplate{constructor(e){"prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt}get inputVariables(){return this.prompt.inputVariables}async formatMessages(e){return[await this.format(e)]}}class BaseChatPromptTemplate extends BasePromptTemplate{constructor(e){super(e)}async format(e){return(await this.formatPromptValue(e)).toString()}async formatPromptValue(e){const r=await this.formatMessages(e);return new ChatPromptValue(r)}}class ChatMessagePromptTemplate extends BaseMessageStringPromptTemplate{static lc_name(){return"ChatMessagePromptTemplate"}constructor(e,r){"prompt"in e||(e={prompt:e,role:r}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}async format(e){return new ChatMessage(await this.prompt.format(e),this.role)}static fromTemplate(e,r,n){return new this(PromptTemplate.fromTemplate(e,{templateFormat:n==null?void 0:n.templateFormat}),r)}}function isTextTemplateParam(t){return t===null||typeof t!="object"||Array.isArray(t)?!1:Object.keys(t).length===1&&"text"in t&&typeof t.text=="string"}function isImageTemplateParam(t){return t===null||typeof t!="object"||Array.isArray(t)?!1:"image_url"in t&&(typeof t.image_url=="string"||typeof t.image_url=="object"&&t.image_url!==null&&"url"in t.image_url&&typeof t.image_url.url=="string")}class _StringImageMessagePromptTemplate extends BaseMessagePromptTemplate{static _messageClass(){throw new Error("Can not invoke _messageClass from inside _StringImageMessagePromptTemplate")}constructor(e,r){if("prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"additionalOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"messageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chatMessageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt,Array.isArray(this.prompt)){let n=[];this.prompt.forEach(s=>{"inputVariables"in s&&(n=n.concat(s.inputVariables))}),this.inputVariables=n}else this.inputVariables=this.prompt.inputVariables;this.additionalOptions=r??this.additionalOptions}createMessage(e){const r=this.constructor;if(r._messageClass()){const n=r._messageClass();return new n({content:e})}else if(r.chatMessageClass){const n=r.chatMessageClass();return new n({content:e,role:this.getRoleFromMessageClass(n.lc_name())})}else throw new Error("No message class defined")}getRoleFromMessageClass(e){switch(e){case"HumanMessage":return"human";case"AIMessage":return"ai";case"SystemMessage":return"system";case"ChatMessage":return"chat";default:throw new Error("Invalid message class name")}}static fromTemplate(e,r){if(typeof e=="string")return new this(PromptTemplate.fromTemplate(e,r));const n=[];for(const s of e)if(typeof s=="string")n.push(PromptTemplate.fromTemplate(s,r));else if(s!==null)if(isTextTemplateParam(s)){let a="";typeof s.text=="string"&&(a=s.text??"");const o={...r,additionalContentFields:s};n.push(PromptTemplate.fromTemplate(a,o))}else if(isImageTemplateParam(s)){let a=s.image_url??"",o,l=[];if(typeof a=="string"){let u;(r==null?void 0:r.templateFormat)==="mustache"?u=parseMustache(a):u=parseFString(a);const c=u.flatMap(d=>d.type==="variable"?[d.name]:[]);if(((c==null?void 0:c.length)??0)>0){if(c.length>1)throw new Error(`Only one format variable allowed per image template.
Got: ${c}
From: ${a}`);l=[c[0]]}else l=[];a={url:a},o=new ImagePromptTemplate({template:a,inputVariables:l,templateFormat:r==null?void 0:r.templateFormat,additionalContentFields:s})}else if(typeof a=="object"){if("url"in a){let u;(r==null?void 0:r.templateFormat)==="mustache"?u=parseMustache(a.url):u=parseFString(a.url),l=u.flatMap(c=>c.type==="variable"?[c.name]:[])}else l=[];o=new ImagePromptTemplate({template:a,inputVariables:l,templateFormat:r==null?void 0:r.templateFormat,additionalContentFields:s})}else throw new Error("Invalid image template");n.push(o)}else typeof s=="object"&&n.push(new DictPromptTemplate({template:s,templateFormat:r==null?void 0:r.templateFormat}));return new this({prompt:n,additionalOptions:r})}async format(e){if(this.prompt instanceof BaseStringPromptTemplate){const r=await this.prompt.format(e);return this.createMessage(r)}else{const r=[];for(const n of this.prompt){let s={};if(!("inputVariables"in n))throw new Error(`Prompt ${n} does not have inputVariables defined.`);for(const a of n.inputVariables)s||(s={[a]:e[a]}),s={...s,[a]:e[a]};if(n instanceof BaseStringPromptTemplate){const a=await n.format(s);let o;"additionalContentFields"in n&&(o=n.additionalContentFields),r.push({...o,type:"text",text:a})}else if(n instanceof ImagePromptTemplate){const a=await n.format(s);let o;"additionalContentFields"in n&&(o=n.additionalContentFields),r.push({...o,type:"image_url",image_url:a})}else if(n instanceof DictPromptTemplate){const a=await n.format(s);let o;"additionalContentFields"in n&&(o=n.additionalContentFields),r.push({...o,...a})}}return this.createMessage(r)}}async formatMessages(e){return[await this.format(e)]}}class HumanMessagePromptTemplate extends _StringImageMessagePromptTemplate{static _messageClass(){return HumanMessage}static lc_name(){return"HumanMessagePromptTemplate"}}class AIMessagePromptTemplate extends _StringImageMessagePromptTemplate{static _messageClass(){return AIMessage}static lc_name(){return"AIMessagePromptTemplate"}}class SystemMessagePromptTemplate extends _StringImageMessagePromptTemplate{static _messageClass(){return SystemMessage}static lc_name(){return"SystemMessagePromptTemplate"}}function _isBaseMessagePromptTemplate(t){return typeof t.formatMessages=="function"}function _coerceMessagePromptTemplateLike(t,e){if(_isBaseMessagePromptTemplate(t)||isBaseMessage(t))return t;if(Array.isArray(t)&&t[0]==="placeholder"){const s=t[1];if((e==null?void 0:e.templateFormat)==="mustache"&&typeof s=="string"&&s.slice(0,2)==="{{"&&s.slice(-2)==="}}"){const a=s.slice(2,-2);return new MessagesPlaceholder({variableName:a,optional:!0})}else if(typeof s=="string"&&s[0]==="{"&&s[s.length-1]==="}"){const a=s.slice(1,-1);return new MessagesPlaceholder({variableName:a,optional:!0})}throw new Error(`Invalid placeholder template for format ${(e==null?void 0:e.templateFormat)??'"f-string"'}: "${t[1]}". Expected a variable name surrounded by ${(e==null?void 0:e.templateFormat)==="mustache"?"double":"single"} curly braces.`)}const r=coerceMessageLikeToMessage(t);let n;if(typeof r.content=="string"?n=r.content:n=r.content.map(s=>"text"in s?{...s,text:s.text}:"image_url"in s?{...s,image_url:s.image_url}:s),r._getType()==="human")return HumanMessagePromptTemplate.fromTemplate(n,e);if(r._getType()==="ai")return AIMessagePromptTemplate.fromTemplate(n,e);if(r._getType()==="system")return SystemMessagePromptTemplate.fromTemplate(n,e);if(ChatMessage.isInstance(r))return ChatMessagePromptTemplate.fromTemplate(r.content,r.role,e);throw new Error(`Could not coerce message prompt template from input. Received message type: "${r._getType()}".`)}function isMessagesPlaceholder(t){return t.constructor.lc_name()==="MessagesPlaceholder"}class ChatPromptTemplate extends BaseChatPromptTemplate{static lc_name(){return"ChatPromptTemplate"}get lc_aliases(){return{promptMessages:"messages"}}constructor(e){if(super(e),Object.defineProperty(this,"promptMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),e.templateFormat==="mustache"&&e.validateTemplate===void 0&&(this.validateTemplate=!1),Object.assign(this,e),this.validateTemplate){const r=new Set;for(const l of this.promptMessages)if(!(l instanceof BaseMessage))for(const u of l.inputVariables)r.add(u);const n=this.inputVariables,s=new Set(this.partialVariables?n.concat(Object.keys(this.partialVariables)):n),a=new Set([...s].filter(l=>!r.has(l)));if(a.size>0)throw new Error(`Input variables \`${[...a]}\` are not used in any of the prompt messages.`);const o=new Set([...r].filter(l=>!s.has(l)));if(o.size>0)throw new Error(`Input variables \`${[...o]}\` are used in prompt messages but not in the prompt template.`)}}_getPromptType(){return"chat"}async _parseImagePrompts(e,r){if(typeof e.content=="string")return e;const n=await Promise.all(e.content.map(async s=>{if(s.type!=="image_url")return s;let a="";typeof s.image_url=="string"?a=s.image_url:a=s.image_url.url;const l=await PromptTemplate.fromTemplate(a,{templateFormat:this.templateFormat}).format(r);return typeof s.image_url!="string"&&"url"in s.image_url?s.image_url.url=l:s.image_url=l,s}));return e.content=n,e}async formatMessages(e){const r=await this.mergePartialAndUserVariables(e);let n=[];for(const s of this.promptMessages)if(s instanceof BaseMessage)n.push(await this._parseImagePrompts(s,r));else{const a=s.inputVariables.reduce((l,u)=>{if(!(u in r)&&!(isMessagesPlaceholder(s)&&s.optional))throw addLangChainErrorFields$1(new Error(`Missing value for input variable \`${u.toString()}\``),"INVALID_PROMPT_INPUT");return l[u]=r[u],l},{}),o=await s.formatMessages(a);n=n.concat(o)}return n}async partial(e){const r=this.inputVariables.filter(a=>!(a in e)),n={...this.partialVariables??{},...e},s={...this,inputVariables:r,partialVariables:n};return new ChatPromptTemplate(s)}static fromTemplate(e,r){const n=PromptTemplate.fromTemplate(e,r),s=new HumanMessagePromptTemplate({prompt:n});return this.fromMessages([s])}static fromMessages(e,r){const n=e.reduce((o,l)=>o.concat(l instanceof ChatPromptTemplate?l.promptMessages:[_coerceMessagePromptTemplateLike(l,r)]),[]),s=e.reduce((o,l)=>l instanceof ChatPromptTemplate?Object.assign(o,l.partialVariables):o,Object.create(null)),a=new Set;for(const o of n)if(!(o instanceof BaseMessage))for(const l of o.inputVariables)l in s||a.add(l);return new this({...r,inputVariables:[...a],promptMessages:n,partialVariables:s,templateFormat:r==null?void 0:r.templateFormat})}static fromPromptMessages(e){return this.fromMessages(e)}}class RunnablePassthrough extends Runnable{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}async invoke(e,r){const n=ensureConfig(r);return this.func&&await this.func(e,n),this._callWithConfig(s=>Promise.resolve(s),e,n)}async*transform(e,r){const n=ensureConfig(r);let s,a=!0;for await(const o of this._transformStreamWithConfig(e,l=>l,n))if(yield o,a)if(s===void 0)s=o;else try{s=concat(s,o)}catch{s=void 0,a=!1}this.func&&s!==void 0&&await this.func(s,n)}static assign(e){return new RunnableAssign(new RunnableMap({steps:e}))}}class BaseLLMOutputParser extends Runnable{parseResultWithPrompt(e,r,n){return this.parseResult(e,n)}_baseMessageToString(e){return typeof e.content=="string"?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,r){return typeof e=="string"?this._callWithConfig(async(n,s)=>this.parseResult([{text:n}],s==null?void 0:s.callbacks),e,{...r,runType:"parser"}):this._callWithConfig(async(n,s)=>this.parseResult([{message:n,text:this._baseMessageToString(n)}],s==null?void 0:s.callbacks),e,{...r,runType:"parser"})}}class BaseOutputParser extends BaseLLMOutputParser{parseResult(e,r){return this.parse(e[0].text,r)}async parseWithPrompt(e,r,n){return this.parse(e,n)}_type(){throw new Error("_type not implemented")}}class OutputParserException extends Error{constructor(e,r,n,s=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=r,this.observation=n,this.sendToLLM=s,s&&(n===void 0||r===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");addLangChainErrorFields$1(this,"OUTPUT_PARSING_FAILURE")}}function deepCompareStrict(t,e){const r=typeof t;if(r!==typeof e)return!1;if(Array.isArray(t)){if(!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let s=0;s<n;s++)if(!deepCompareStrict(t[s],e[s]))return!1;return!0}if(r==="object"){if(!t||!e)return t===e;const n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(const o of n)if(!deepCompareStrict(t[o],e[o]))return!1;return!0}return t===e}class BaseTransformOutputParser extends BaseOutputParser{async*_transform(e){for await(const r of e)typeof r=="string"?yield this.parseResult([{text:r}]):yield this.parseResult([{message:r,text:this._baseMessageToString(r)}])}async*transform(e,r){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...r,runType:"parser"})}}class BaseCumulativeTransformOutputParser extends BaseTransformOutputParser{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=(e==null?void 0:e.diff)??this.diff}async*_transform(e){let r,n;for await(const s of e){if(typeof s!="string"&&typeof s.content!="string")throw new Error("Cannot handle non-string output.");let a;if(isBaseMessageChunk(s)){if(typeof s.content!="string")throw new Error("Cannot handle non-string message output.");a=new ChatGenerationChunk({message:s,text:s.content})}else if(isBaseMessage(s)){if(typeof s.content!="string")throw new Error("Cannot handle non-string message output.");a=new ChatGenerationChunk({message:convertToChunk(s),text:s.content})}else a=new GenerationChunk({text:s});n===void 0?n=a:n=n.concat(a);const o=await this.parsePartialResult([n]);o!=null&&!deepCompareStrict(o,r)&&(this.diff?yield this._diff(r,o):yield o,r=o)}}getFormatInstructions(){return""}}class StructuredOutputParser extends BaseOutputParser{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){const r=objectType(Object.fromEntries(Object.entries(e).map(([n,s])=>[n,stringType().describe(s)])));return new this(r)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(zodToJsonSchema$2(this.schema))}
\`\`\`
`}async parse(e){try{const n=(e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(s,a)=>`"${a.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(n))}catch(r){throw new OutputParserException(`Failed to parse. Text: "${e}". Error: ${r}`,e)}}}class JsonOutputParser extends BaseCumulativeTransformOutputParser{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(e,r){if(r)return e?compare(e,r):[{op:"replace",path:"",value:r}]}async parsePartialResult(e){return parseJsonMarkdown(e[0].text)}async parse(e){return parseJsonMarkdown(e,JSON.parse)}getFormatInstructions(){return""}}class CustomSummaryMemory extends BaseMemory{constructor(){super();En(this,"messages",[]);En(this,"maxMessages",10)}get memoryKeys(){return["history"]}async loadMemoryVariables(r){return{history:this.messages||[]}}async saveContext(r,n){const s=r.input??"",a=n.output??"";this.messages.push(new HumanMessage(s),new AIMessage(a)),this.messages.length>this.maxMessages*2&&(this.messages=this.messages.slice(-this.maxMessages*2))}clear(){this.messages=[]}}const default_format="RFC3986",formatters={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:t=>String(t)},RFC1738="RFC1738",is_array$1=Array.isArray,hex_table=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),limit=1024,encode=(t,e,r,n,s)=>{if(t.length===0)return t;let a=t;if(typeof t=="symbol"?a=Symbol.prototype.toString.call(t):typeof t!="string"&&(a=String(t)),r==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});let o="";for(let l=0;l<a.length;l+=limit){const u=a.length>=limit?a.slice(l,l+limit):a,c=[];for(let d=0;d<u.length;++d){let p=u.charCodeAt(d);if(p===45||p===46||p===95||p===126||p>=48&&p<=57||p>=65&&p<=90||p>=97&&p<=122||s===RFC1738&&(p===40||p===41)){c[c.length]=u.charAt(d);continue}if(p<128){c[c.length]=hex_table[p];continue}if(p<2048){c[c.length]=hex_table[192|p>>6]+hex_table[128|p&63];continue}if(p<55296||p>=57344){c[c.length]=hex_table[224|p>>12]+hex_table[128|p>>6&63]+hex_table[128|p&63];continue}d+=1,p=65536+((p&1023)<<10|u.charCodeAt(d)&1023),c[c.length]=hex_table[240|p>>18]+hex_table[128|p>>12&63]+hex_table[128|p>>6&63]+hex_table[128|p&63]}o+=c.join("")}return o};function is_buffer(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function maybe_map(t,e){if(is_array$1(t)){const r=[];for(let n=0;n<t.length;n+=1)r.push(e(t[n]));return r}return e(t)}const has=Object.prototype.hasOwnProperty,array_prefix_generators={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},is_array=Array.isArray,push=Array.prototype.push,push_to_array=function(t,e){push.apply(t,is_array(e)?e:[e])},to_ISO=Date.prototype.toISOString,defaults$1={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:encode,encodeValuesOnly:!1,format:default_format,formatter:formatters[default_format],indices:!1,serializeDate(t){return to_ISO.call(t)},skipNulls:!1,strictNullHandling:!1};function is_non_nullish_primitive(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const sentinel={};function inner_stringify(t,e,r,n,s,a,o,l,u,c,d,p,m,y,b,E,T,S){let P=t,A=S,I=0,j=!1;for(;(A=A.get(sentinel))!==void 0&&!j;){const ue=A.get(t);if(I+=1,typeof ue<"u"){if(ue===I)throw new RangeError("Cyclic object value");j=!0}typeof A.get(sentinel)>"u"&&(I=0)}if(typeof c=="function"?P=c(e,P):P instanceof Date?P=m==null?void 0:m(P):r==="comma"&&is_array(P)&&(P=maybe_map(P,function(ue){return ue instanceof Date?m==null?void 0:m(ue):ue})),P===null){if(a)return u&&!E?u(e,defaults$1.encoder,T,"key",y):e;P=""}if(is_non_nullish_primitive(P)||is_buffer(P)){if(u){const ue=E?e:u(e,defaults$1.encoder,T,"key",y);return[(b==null?void 0:b(ue))+"="+(b==null?void 0:b(u(P,defaults$1.encoder,T,"value",y)))]}return[(b==null?void 0:b(e))+"="+(b==null?void 0:b(String(P)))]}const K=[];if(typeof P>"u")return K;let W;if(r==="comma"&&is_array(P))E&&u&&(P=maybe_map(P,u)),W=[{value:P.length>0?P.join(",")||null:void 0}];else if(is_array(c))W=c;else{const ue=Object.keys(P);W=d?ue.sort(d):ue}const H=l?String(e).replace(/\./g,"%2E"):String(e),ee=n&&is_array(P)&&P.length===1?H+"[]":H;if(s&&is_array(P)&&P.length===0)return ee+"[]";for(let ue=0;ue<W.length;++ue){const de=W[ue],fe=typeof de=="object"&&typeof de.value<"u"?de.value:P[de];if(o&&fe===null)continue;const ae=p&&l?de.replace(/\./g,"%2E"):de,ce=is_array(P)?typeof r=="function"?r(ee,ae):ee:ee+(p?"."+ae:"["+ae+"]");S.set(t,I);const me=new WeakMap;me.set(sentinel,S),push_to_array(K,inner_stringify(fe,ce,r,n,s,a,o,l,r==="comma"&&E&&is_array(P)?null:u,c,d,p,m,y,b,E,T,me))}return K}function normalize_stringify_options(t=defaults$1){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||defaults$1.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let r=default_format;if(typeof t.format<"u"){if(!has.call(formatters,t.format))throw new TypeError("Unknown format option provided.");r=t.format}const n=formatters[r];let s=defaults$1.filter;(typeof t.filter=="function"||is_array(t.filter))&&(s=t.filter);let a;if(t.arrayFormat&&t.arrayFormat in array_prefix_generators?a=t.arrayFormat:"indices"in t?a=t.indices?"indices":"repeat":a=defaults$1.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:defaults$1.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:defaults$1.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:defaults$1.allowEmptyArrays,arrayFormat:a,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:defaults$1.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?defaults$1.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:defaults$1.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:defaults$1.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:defaults$1.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:defaults$1.encodeValuesOnly,filter:s,format:r,formatter:n,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:defaults$1.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:defaults$1.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:defaults$1.strictNullHandling}}function stringify(t,e={}){let r=t;const n=normalize_stringify_options(e);let s,a;typeof n.filter=="function"?(a=n.filter,r=a("",r)):is_array(n.filter)&&(a=n.filter,s=a);const o=[];if(typeof r!="object"||r===null)return"";const l=array_prefix_generators[n.arrayFormat],u=l==="comma"&&n.commaRoundTrip;s||(s=Object.keys(r)),n.sort&&s.sort(n.sort);const c=new WeakMap;for(let m=0;m<s.length;++m){const y=s[m];n.skipNulls&&r[y]===null||push_to_array(o,inner_stringify(r[y],y,l,u,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,c))}const d=o.join(n.delimiter);let p=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),d.length>0?p+d:""}const VERSION="4.103.0";let auto=!1,kind,fetch$1,FormData$1,File$1,ReadableStream$1,getMultipartRequestOptions,getDefaultAgent,fileFromPath,isFsReadStream;function setShims(t,e={auto:!1}){if(auto)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(kind)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${kind}'\``);auto=e.auto,kind=t.kind,fetch$1=t.fetch,FormData$1=t.FormData,File$1=t.File,ReadableStream$1=t.ReadableStream,getMultipartRequestOptions=t.getMultipartRequestOptions,getDefaultAgent=t.getDefaultAgent,fileFromPath=t.fileFromPath,isFsReadStream=t.isFsReadStream}class MultipartBody{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function getRuntime({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let r,n,s,a;try{r=fetch,n=Request,s=Response,a=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:r,Request:n,Response:s,Headers:a,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,l)=>({...l,body:new MultipartBody(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}const init=()=>{kind||setShims(getRuntime(),{auto:!0})};init();class OpenAIError extends Error{}class APIError extends OpenAIError{constructor(e,r,n,s){super(`${APIError.makeMessage(e,r,n)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"],this.error=r;const a=r;this.code=a==null?void 0:a.code,this.param=a==null?void 0:a.param,this.type=a==null?void 0:a.type}static makeMessage(e,r,n){const s=r!=null&&r.message?typeof r.message=="string"?r.message:JSON.stringify(r.message):r?JSON.stringify(r):n;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,r,n,s){if(!e||!s)return new APIConnectionError({message:n,cause:castToError(r)});const a=r==null?void 0:r.error;return e===400?new BadRequestError(e,a,n,s):e===401?new AuthenticationError(e,a,n,s):e===403?new PermissionDeniedError(e,a,n,s):e===404?new NotFoundError(e,a,n,s):e===409?new ConflictError(e,a,n,s):e===422?new UnprocessableEntityError(e,a,n,s):e===429?new RateLimitError(e,a,n,s):e>=500?new InternalServerError(e,a,n,s):new APIError(e,a,n,s)}}class APIUserAbortError extends APIError{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class APIConnectionError extends APIError{constructor({message:e,cause:r}){super(void 0,void 0,e||"Connection error.",void 0),r&&(this.cause=r)}}class APIConnectionTimeoutError extends APIConnectionError{constructor({message:e}={}){super({message:e??"Request timed out."})}}class BadRequestError extends APIError{}class AuthenticationError extends APIError{}class PermissionDeniedError extends APIError{}class NotFoundError extends APIError{}class ConflictError extends APIError{}class UnprocessableEntityError extends APIError{}class RateLimitError extends APIError{}class InternalServerError extends APIError{}class LengthFinishReasonError extends OpenAIError{constructor(){super("Could not parse response content as the length limit was reached")}}class ContentFilterFinishReasonError extends OpenAIError{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var __classPrivateFieldSet$5=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},__classPrivateFieldGet$6=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},_LineDecoder_carriageReturnIndex;class LineDecoder{constructor(){_LineDecoder_carriageReturnIndex.set(this,void 0),this.buffer=new Uint8Array,__classPrivateFieldSet$5(this,_LineDecoder_carriageReturnIndex,null,"f")}decode(e){if(e==null)return[];const r=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let n=new Uint8Array(this.buffer.length+r.length);n.set(this.buffer),n.set(r,this.buffer.length),this.buffer=n;const s=[];let a;for(;(a=findNewlineIndex(this.buffer,__classPrivateFieldGet$6(this,_LineDecoder_carriageReturnIndex,"f")))!=null;){if(a.carriage&&__classPrivateFieldGet$6(this,_LineDecoder_carriageReturnIndex,"f")==null){__classPrivateFieldSet$5(this,_LineDecoder_carriageReturnIndex,a.index,"f");continue}if(__classPrivateFieldGet$6(this,_LineDecoder_carriageReturnIndex,"f")!=null&&(a.index!==__classPrivateFieldGet$6(this,_LineDecoder_carriageReturnIndex,"f")+1||a.carriage)){s.push(this.decodeText(this.buffer.slice(0,__classPrivateFieldGet$6(this,_LineDecoder_carriageReturnIndex,"f")-1))),this.buffer=this.buffer.slice(__classPrivateFieldGet$6(this,_LineDecoder_carriageReturnIndex,"f")),__classPrivateFieldSet$5(this,_LineDecoder_carriageReturnIndex,null,"f");continue}const o=__classPrivateFieldGet$6(this,_LineDecoder_carriageReturnIndex,"f")!==null?a.preceding-1:a.preceding,l=this.decodeText(this.buffer.slice(0,o));s.push(l),this.buffer=this.buffer.slice(a.index),__classPrivateFieldSet$5(this,_LineDecoder_carriageReturnIndex,null,"f")}return s}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new OpenAIError(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new OpenAIError(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new OpenAIError("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}_LineDecoder_carriageReturnIndex=new WeakMap;LineDecoder.NEWLINE_CHARS=new Set([`
`,"\r"]);LineDecoder.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function findNewlineIndex(t,e){for(let s=e??0;s<t.length;s++){if(t[s]===10)return{preceding:s,index:s+1,carriage:!1};if(t[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function findDoubleNewlineIndex(t){for(let n=0;n<t.length-1;n++){if(t[n]===10&&t[n+1]===10||t[n]===13&&t[n+1]===13)return n+2;if(t[n]===13&&t[n+1]===10&&n+3<t.length&&t[n+2]===13&&t[n+3]===10)return n+4}return-1}function ReadableStreamToAsyncIterable(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const r=await e.read();return r!=null&&r.done&&e.releaseLock(),r}catch(r){throw e.releaseLock(),r}},async return(){const r=e.cancel();return e.releaseLock(),await r,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class Stream{constructor(e,r){this.iterator=e,this.controller=r}static fromSSEResponse(e,r){let n=!1;async function*s(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{for await(const o of _iterSSEMessages(e,r))if(!a){if(o.data.startsWith("[DONE]")){a=!0;continue}if(o.event===null||o.event.startsWith("response.")||o.event.startsWith("transcript.")){let l;try{l=JSON.parse(o.data)}catch(u){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),u}if(l&&l.error)throw new APIError(void 0,l.error,void 0,createResponseHeaders(e.headers));yield l}else{let l;try{l=JSON.parse(o.data)}catch(u){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),u}if(o.event=="error")throw new APIError(void 0,l.error,l.message,void 0);yield{event:o.event,data:l}}}a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||r.abort()}}return new Stream(s,r)}static fromReadableStream(e,r){let n=!1;async function*s(){const o=new LineDecoder,l=ReadableStreamToAsyncIterable(e);for await(const u of l)for(const c of o.decode(u))yield c;for(const u of o.flush())yield u}async function*a(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let o=!1;try{for await(const l of s())o||l&&(yield JSON.parse(l));o=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{o||r.abort()}}return new Stream(a,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],r=[],n=this.iterator(),s=a=>({next:()=>{if(a.length===0){const o=n.next();e.push(o),r.push(o)}return a.shift()}});return[new Stream(()=>s(e),this.controller),new Stream(()=>s(r),this.controller)]}toReadableStream(){const e=this;let r;const n=new TextEncoder;return new ReadableStream$1({async start(){r=e[Symbol.asyncIterator]()},async pull(s){try{const{value:a,done:o}=await r.next();if(o)return s.close();const l=n.encode(JSON.stringify(a)+`
`);s.enqueue(l)}catch(a){s.error(a)}},async cancel(){var s;await((s=r.return)==null?void 0:s.call(r))}})}}async function*_iterSSEMessages(t,e){if(!t.body)throw e.abort(),new OpenAIError("Attempted to iterate over a response with no body");const r=new SSEDecoder,n=new LineDecoder,s=ReadableStreamToAsyncIterable(t.body);for await(const a of iterSSEChunks(s))for(const o of n.decode(a)){const l=r.decode(o);l&&(yield l)}for(const a of n.flush()){const o=r.decode(a);o&&(yield o)}}async function*iterSSEChunks(t){let e=new Uint8Array;for await(const r of t){if(r==null)continue;const n=r instanceof ArrayBuffer?new Uint8Array(r):typeof r=="string"?new TextEncoder().encode(r):r;let s=new Uint8Array(e.length+n.length);s.set(e),s.set(n,e.length),e=s;let a;for(;(a=findDoubleNewlineIndex(e))!==-1;)yield e.slice(0,a),e=e.slice(a)}e.length>0&&(yield e)}class SSEDecoder{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[r,n,s]=partition(e,":");return s.startsWith(" ")&&(s=s.substring(1)),r==="event"?this.event=s:r==="data"&&this.data.push(s),null}}function partition(t,e){const r=t.indexOf(e);return r!==-1?[t.substring(0,r),e,t.substring(r+e.length)]:[t,"",""]}const isResponseLike=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",isFileLike=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&isBlobLike(t),isBlobLike=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",isUploadable=t=>isFileLike(t)||isResponseLike(t)||isFsReadStream(t);async function toFile(t,e,r){var s;if(t=await t,isFileLike(t))return t;if(isResponseLike(t)){const a=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=isBlobLike(a)?[await a.arrayBuffer()]:[a];return new File$1(o,e,r)}const n=await getBytes(t);if(e||(e=getName(t)??"unknown_file"),!(r!=null&&r.type)){const a=(s=n[0])==null?void 0:s.type;typeof a=="string"&&(r={...r,type:a})}return new File$1(n,e,r)}async function getBytes(t){var r;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(isBlobLike(t))e.push(await t.arrayBuffer());else if(isAsyncIterableIterator(t))for await(const n of t)e.push(n);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(r=t==null?void 0:t.constructor)==null?void 0:r.name}; props: ${propsForError(t)}`);return e}function propsForError(t){return`[${Object.getOwnPropertyNames(t).map(r=>`"${r}"`).join(", ")}]`}function getName(t){var e;return getStringFromMaybeBuffer(t.name)||getStringFromMaybeBuffer(t.filename)||((e=getStringFromMaybeBuffer(t.path))==null?void 0:e.split(/[\\/]/).pop())}const getStringFromMaybeBuffer=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},isAsyncIterableIterator=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",isMultipartBody=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",multipartFormRequestOptions=async t=>{const e=await createForm(t.body);return getMultipartRequestOptions(e,t)},createForm=async t=>{const e=new FormData$1;return await Promise.all(Object.entries(t||{}).map(([r,n])=>addFormValue(e,r,n))),e},addFormValue=async(t,e,r)=>{if(r!==void 0){if(r==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")t.append(e,String(r));else if(isUploadable(r)){const n=await toFile(r);t.append(e,n)}else if(Array.isArray(r))await Promise.all(r.map(n=>addFormValue(t,e+"[]",n)));else if(typeof r=="object")await Promise.all(Object.entries(r).map(([n,s])=>addFormValue(t,`${e}[${n}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`)}};var define_process_env_default={},__classPrivateFieldSet$4=function(t,e,r,n,s){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,r),r},__classPrivateFieldGet$5=function(t,e,r,n){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},_AbstractPage_client;init();async function defaultParseResponse(t){var o;const{response:e}=t;if(t.options.stream)return debug("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):Stream.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const r=e.headers.get("content-type"),n=(o=r==null?void 0:r.split(";")[0])==null?void 0:o.trim();if((n==null?void 0:n.includes("application/json"))||(n==null?void 0:n.endsWith("+json"))){const l=await e.json();return debug("response",e.status,e.url,e.headers,l),_addRequestID(l,e)}const a=await e.text();return debug("response",e.status,e.url,e.headers,a),a}function _addRequestID(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class APIPromise extends Promise{constructor(e,r=defaultParseResponse){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=r}_thenUnwrap(e){return new APIPromise(this.responsePromise,async r=>_addRequestID(e(await this.parseResponse(r),r),r.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,r]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:r,request_id:r.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,r){return this.parse().then(e,r)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class APIClient{constructor({baseURL:e,maxRetries:r=2,timeout:n=6e5,httpAgent:s,fetch:a}){this.baseURL=e,this.maxRetries=validatePositiveInteger("maxRetries",r),this.timeout=validatePositiveInteger("timeout",n),this.httpAgent=s,this.fetch=a??fetch$1}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...getPlatformHeaders(),...this.authHeaders(e)}}validateHeaders(e,r){}defaultIdempotencyKey(){return`stainless-node-retry-${uuid4()}`}get(e,r){return this.methodRequest("get",e,r)}post(e,r){return this.methodRequest("post",e,r)}patch(e,r){return this.methodRequest("patch",e,r)}put(e,r){return this.methodRequest("put",e,r)}delete(e,r){return this.methodRequest("delete",e,r)}methodRequest(e,r,n){return this.request(Promise.resolve(n).then(async s=>{const a=s&&isBlobLike(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:r,...s,body:a}}))}getAPIList(e,r,n){return this.requestAPIList(r,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:r=0}={}){var E;const n={...e},{method:s,path:a,query:o,headers:l={}}=n,u=ArrayBuffer.isView(n.body)||n.__binaryRequest&&typeof n.body=="string"?n.body:isMultipartBody(n.body)?n.body.body:n.body?JSON.stringify(n.body,null,2):null,c=this.calculateContentLength(u),d=this.buildURL(a,o);"timeout"in n&&validatePositiveInteger("timeout",n.timeout),n.timeout=n.timeout??this.timeout;const p=n.httpAgent??this.httpAgent??getDefaultAgent(d),m=n.timeout+1e3;typeof((E=p==null?void 0:p.options)==null?void 0:E.timeout)=="number"&&m>(p.options.timeout??0)&&(p.options.timeout=m),this.idempotencyHeader&&s!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const y=this.buildHeaders({options:n,headers:l,contentLength:c,retryCount:r});return{req:{method:s,...u&&{body:u},headers:y,...p&&{agent:p},signal:n.signal??null},url:d,timeout:n.timeout}}buildHeaders({options:e,headers:r,contentLength:n,retryCount:s}){const a={};n&&(a["content-length"]=n);const o=this.defaultHeaders(e);return applyHeadersMut(a,o),applyHeadersMut(a,r),isMultipartBody(e.body)&&kind!=="node"&&delete a["content-type"],getHeader(o,"x-stainless-retry-count")===void 0&&getHeader(r,"x-stainless-retry-count")===void 0&&(a["x-stainless-retry-count"]=String(s)),getHeader(o,"x-stainless-timeout")===void 0&&getHeader(r,"x-stainless-timeout")===void 0&&e.timeout&&(a["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(a,r),a}async prepareOptions(e){}async prepareRequest(e,{url:r,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(r=>[...r])):{...e}:{}}makeStatusError(e,r,n,s){return APIError.generate(e,r,n,s)}request(e,r=null){return new APIPromise(this.makeRequest(e,r))}async makeRequest(e,r){var p,m;const n=await e,s=n.maxRetries??this.maxRetries;r==null&&(r=s),await this.prepareOptions(n);const{req:a,url:o,timeout:l}=this.buildRequest(n,{retryCount:s-r});if(await this.prepareRequest(a,{url:o,options:n}),debug("request",o,n,a.headers),(p=n.signal)!=null&&p.aborted)throw new APIUserAbortError;const u=new AbortController,c=await this.fetchWithTimeout(o,a,l,u).catch(castToError);if(c instanceof Error){if((m=n.signal)!=null&&m.aborted)throw new APIUserAbortError;if(r)return this.retryRequest(n,r);throw c.name==="AbortError"?new APIConnectionTimeoutError:new APIConnectionError({cause:c})}const d=createResponseHeaders(c.headers);if(!c.ok){if(r&&this.shouldRetry(c)){const P=`retrying, ${r} attempts remaining`;return debug(`response (error; ${P})`,c.status,o,d),this.retryRequest(n,r,d)}const y=await c.text().catch(P=>castToError(P).message),b=safeJSON(y),E=b?void 0:y;throw debug(`response (error; ${r?"(error; no more retries left)":"(error; not retryable)"})`,c.status,o,d,E),this.makeStatusError(c.status,b,E,d)}return{response:c,options:n,controller:u}}requestAPIList(e,r){const n=this.makeRequest(r,null);return new PagePromise(this,n,e)}buildURL(e,r){const n=isAbsoluteURL(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return isEmptyObj$1(s)||(r={...s,...r}),typeof r=="object"&&r&&!Array.isArray(r)&&(n.search=this.stringifyQuery(r)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([r,n])=>typeof n<"u").map(([r,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(r)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(r)}=`;throw new OpenAIError(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,r,n,s){const{signal:a,...o}=r||{};a&&a.addEventListener("abort",()=>s.abort());const l=setTimeout(()=>s.abort(),n),u={signal:s.signal,...o};return u.method&&(u.method=u.method.toUpperCase()),this.fetch.call(void 0,e,u).finally(()=>{clearTimeout(l)})}shouldRetry(e){const r=e.headers.get("x-should-retry");return r==="true"?!0:r==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,r,n){let s;const a=n==null?void 0:n["retry-after-ms"];if(a){const l=parseFloat(a);Number.isNaN(l)||(s=l)}const o=n==null?void 0:n["retry-after"];if(o&&!s){const l=parseFloat(o);Number.isNaN(l)?s=Date.parse(o)-Date.now():s=l*1e3}if(!(s&&0<=s&&s<60*1e3)){const l=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(r,l)}return await sleep(s),this.makeRequest(e,r-1)}calculateDefaultRetryTimeoutMillis(e,r){const a=r-e,o=Math.min(.5*Math.pow(2,a),8),l=1-Math.random()*.25;return o*l*1e3}getUserAgent(){return`${this.constructor.name}/JS ${VERSION}`}}class AbstractPage{constructor(e,r,n,s){_AbstractPage_client.set(this,void 0),__classPrivateFieldSet$4(this,_AbstractPage_client,e),this.options=s,this.response=r,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new OpenAIError("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const r={...this.options};if("params"in e&&typeof r.query=="object")r.query={...r.query,...e.params};else if("url"in e){const n=[...Object.entries(r.query||{}),...e.url.searchParams.entries()];for(const[s,a]of n)e.url.searchParams.set(s,a);r.query=void 0,r.path=e.url.toString()}return await __classPrivateFieldGet$5(this,_AbstractPage_client,"f").requestAPIList(this.constructor,r)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(_AbstractPage_client=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const r of e.getPaginatedItems())yield r}}class PagePromise extends APIPromise{constructor(e,r,n){super(r,async s=>new n(e,s.response,await defaultParseResponse(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const r of e)yield r}}const createResponseHeaders=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,r){const n=r.toString();return e[n.toLowerCase()]||e[n]}}),requestOptionsKeys={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},isRequestOptions=t=>typeof t=="object"&&t!==null&&!isEmptyObj$1(t)&&Object.keys(t).every(e=>hasOwn(requestOptionsKeys,e)),getPlatformProperties=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":VERSION,"X-Stainless-OS":normalizePlatform(Deno.build.os),"X-Stainless-Arch":normalizeArch(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":VERSION,"X-Stainless-OS":normalizePlatform(process.platform),"X-Stainless-Arch":normalizeArch(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=getBrowserInfo();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":VERSION,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function getBrowserInfo(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:r}of t){const n=r.exec(navigator.userAgent);if(n){const s=n[1]||0,a=n[2]||0,o=n[3]||0;return{browser:e,version:`${s}.${a}.${o}`}}}return null}const normalizeArch=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",normalizePlatform=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let _platformHeaders;const getPlatformHeaders=()=>_platformHeaders??(_platformHeaders=getPlatformProperties()),safeJSON=t=>{try{return JSON.parse(t)}catch{return}},startsWithSchemeRegexp=/^[a-z][a-z0-9+.-]*:/i,isAbsoluteURL=t=>startsWithSchemeRegexp.test(t),sleep=t=>new Promise(e=>setTimeout(e,t)),validatePositiveInteger=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new OpenAIError(`${t} must be an integer`);if(e<0)throw new OpenAIError(`${t} must be a positive integer`);return e},castToError=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null)try{return new Error(JSON.stringify(t))}catch{}return new Error(t)},readEnv=t=>{var e,r,n,s;if(typeof process<"u")return((e=define_process_env_default==null?void 0:define_process_env_default[t])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(s=(n=(r=Deno.env)==null?void 0:r.get)==null?void 0:n.call(r,t))==null?void 0:s.trim()};function isEmptyObj$1(t){if(!t)return!0;for(const e in t)return!1;return!0}function hasOwn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function applyHeadersMut(t,e){for(const r in e){if(!hasOwn(e,r))continue;const n=r.toLowerCase();if(!n)continue;const s=e[r];s===null?delete t[n]:s!==void 0&&(t[n]=s)}}const SENSITIVE_HEADERS=new Set(["authorization","api-key"]);function debug(t,...e){if(typeof process<"u"&&(define_process_env_default==null?void 0:define_process_env_default.DEBUG)==="true"){const r=e.map(n=>{if(!n)return n;if(n.headers){const a={...n,headers:{...n.headers}};for(const o in n.headers)SENSITIVE_HEADERS.has(o.toLowerCase())&&(a.headers[o]="REDACTED");return a}let s=null;for(const a in n)SENSITIVE_HEADERS.has(a.toLowerCase())&&(s??(s={...n}),s[a]="REDACTED");return s??n});console.log(`OpenAI:DEBUG:${t}`,...r)}}const uuid4=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),isRunningInBrowser=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",isHeadersProtocol=t=>typeof(t==null?void 0:t.get)=="function",getHeader=(t,e)=>{var n;const r=e.toLowerCase();if(isHeadersProtocol(t)){const s=((n=e[0])==null?void 0:n.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(a,o,l)=>o+l.toUpperCase());for(const a of[e,r,e.toUpperCase(),s]){const o=t.get(a);if(o)return o}}for(const[s,a]of Object.entries(t))if(s.toLowerCase()===r)return Array.isArray(a)?(a.length<=1||console.warn(`Received ${a.length} entries for the ${e} header, using the first entry.`),a[0]):a},toFloat32Array=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),r=e.length,n=new Uint8Array(r);for(let s=0;s<r;s++)n[s]=e.charCodeAt(s);return Array.from(new Float32Array(n.buffer))}};function isObj(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}class Page extends AbstractPage{constructor(e,r,n,s){super(e,r,n,s),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class CursorPage extends AbstractPage{constructor(e,r,n,s){super(e,r,n,s),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const r=Object.fromEntries(e.url.searchParams);return Object.keys(r).length?r:null}nextPageInfo(){var n;const e=this.getPaginatedItems();if(!e.length)return null;const r=(n=e[e.length-1])==null?void 0:n.id;return r?{params:{after:r}}:null}}class APIResource{constructor(e){this._client=e}}let Messages$1=class extends APIResource{list(e,r={},n){return isRequestOptions(r)?this.list(e,{},r):this._client.getAPIList(`/chat/completions/${e}/messages`,ChatCompletionStoreMessagesPage,{query:r,...n})}},Completions$2=class extends APIResource{constructor(){super(...arguments),this.messages=new Messages$1(this._client)}create(e,r){return this._client.post("/chat/completions",{body:e,...r,stream:e.stream??!1})}retrieve(e,r){return this._client.get(`/chat/completions/${e}`,r)}update(e,r,n){return this._client.post(`/chat/completions/${e}`,{body:r,...n})}list(e={},r){return isRequestOptions(e)?this.list({},e):this._client.getAPIList("/chat/completions",ChatCompletionsPage,{query:e,...r})}del(e,r){return this._client.delete(`/chat/completions/${e}`,r)}};class ChatCompletionsPage extends CursorPage{}class ChatCompletionStoreMessagesPage extends CursorPage{}Completions$2.ChatCompletionsPage=ChatCompletionsPage;Completions$2.Messages=Messages$1;let Chat$1=class extends APIResource{constructor(){super(...arguments),this.completions=new Completions$2(this._client)}};Chat$1.Completions=Completions$2;Chat$1.ChatCompletionsPage=ChatCompletionsPage;class Speech extends APIResource{create(e,r){return this._client.post("/audio/speech",{body:e,...r,headers:{Accept:"application/octet-stream",...r==null?void 0:r.headers},__binaryResponse:!0})}}class Transcriptions extends APIResource{create(e,r){return this._client.post("/audio/transcriptions",multipartFormRequestOptions({body:e,...r,stream:e.stream??!1,__metadata:{model:e.model}}))}}class Translations extends APIResource{create(e,r){return this._client.post("/audio/translations",multipartFormRequestOptions({body:e,...r,__metadata:{model:e.model}}))}}class Audio extends APIResource{constructor(){super(...arguments),this.transcriptions=new Transcriptions(this._client),this.translations=new Translations(this._client),this.speech=new Speech(this._client)}}Audio.Transcriptions=Transcriptions;Audio.Translations=Translations;Audio.Speech=Speech;class Batches extends APIResource{create(e,r){return this._client.post("/batches",{body:e,...r})}retrieve(e,r){return this._client.get(`/batches/${e}`,r)}list(e={},r){return isRequestOptions(e)?this.list({},e):this._client.getAPIList("/batches",BatchesPage,{query:e,...r})}cancel(e,r){return this._client.post(`/batches/${e}/cancel`,r)}}class BatchesPage extends CursorPage{}Batches.BatchesPage=BatchesPage;var __classPrivateFieldSet$3=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},__classPrivateFieldGet$4=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},_EventStream_instances,_EventStream_connectedPromise,_EventStream_resolveConnectedPromise,_EventStream_rejectConnectedPromise,_EventStream_endPromise,_EventStream_resolveEndPromise,_EventStream_rejectEndPromise,_EventStream_listeners,_EventStream_ended,_EventStream_errored,_EventStream_aborted,_EventStream_catchingPromiseCreated,_EventStream_handleError;class EventStream{constructor(){_EventStream_instances.add(this),this.controller=new AbortController,_EventStream_connectedPromise.set(this,void 0),_EventStream_resolveConnectedPromise.set(this,()=>{}),_EventStream_rejectConnectedPromise.set(this,()=>{}),_EventStream_endPromise.set(this,void 0),_EventStream_resolveEndPromise.set(this,()=>{}),_EventStream_rejectEndPromise.set(this,()=>{}),_EventStream_listeners.set(this,{}),_EventStream_ended.set(this,!1),_EventStream_errored.set(this,!1),_EventStream_aborted.set(this,!1),_EventStream_catchingPromiseCreated.set(this,!1),__classPrivateFieldSet$3(this,_EventStream_connectedPromise,new Promise((e,r)=>{__classPrivateFieldSet$3(this,_EventStream_resolveConnectedPromise,e,"f"),__classPrivateFieldSet$3(this,_EventStream_rejectConnectedPromise,r,"f")}),"f"),__classPrivateFieldSet$3(this,_EventStream_endPromise,new Promise((e,r)=>{__classPrivateFieldSet$3(this,_EventStream_resolveEndPromise,e,"f"),__classPrivateFieldSet$3(this,_EventStream_rejectEndPromise,r,"f")}),"f"),__classPrivateFieldGet$4(this,_EventStream_connectedPromise,"f").catch(()=>{}),__classPrivateFieldGet$4(this,_EventStream_endPromise,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},__classPrivateFieldGet$4(this,_EventStream_instances,"m",_EventStream_handleError).bind(this))},0)}_connected(){this.ended||(__classPrivateFieldGet$4(this,_EventStream_resolveConnectedPromise,"f").call(this),this._emit("connect"))}get ended(){return __classPrivateFieldGet$4(this,_EventStream_ended,"f")}get errored(){return __classPrivateFieldGet$4(this,_EventStream_errored,"f")}get aborted(){return __classPrivateFieldGet$4(this,_EventStream_aborted,"f")}abort(){this.controller.abort()}on(e,r){return(__classPrivateFieldGet$4(this,_EventStream_listeners,"f")[e]||(__classPrivateFieldGet$4(this,_EventStream_listeners,"f")[e]=[])).push({listener:r}),this}off(e,r){const n=__classPrivateFieldGet$4(this,_EventStream_listeners,"f")[e];if(!n)return this;const s=n.findIndex(a=>a.listener===r);return s>=0&&n.splice(s,1),this}once(e,r){return(__classPrivateFieldGet$4(this,_EventStream_listeners,"f")[e]||(__classPrivateFieldGet$4(this,_EventStream_listeners,"f")[e]=[])).push({listener:r,once:!0}),this}emitted(e){return new Promise((r,n)=>{__classPrivateFieldSet$3(this,_EventStream_catchingPromiseCreated,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,r)})}async done(){__classPrivateFieldSet$3(this,_EventStream_catchingPromiseCreated,!0,"f"),await __classPrivateFieldGet$4(this,_EventStream_endPromise,"f")}_emit(e,...r){if(__classPrivateFieldGet$4(this,_EventStream_ended,"f"))return;e==="end"&&(__classPrivateFieldSet$3(this,_EventStream_ended,!0,"f"),__classPrivateFieldGet$4(this,_EventStream_resolveEndPromise,"f").call(this));const n=__classPrivateFieldGet$4(this,_EventStream_listeners,"f")[e];if(n&&(__classPrivateFieldGet$4(this,_EventStream_listeners,"f")[e]=n.filter(s=>!s.once),n.forEach(({listener:s})=>s(...r))),e==="abort"){const s=r[0];!__classPrivateFieldGet$4(this,_EventStream_catchingPromiseCreated,"f")&&!(n!=null&&n.length)&&Promise.reject(s),__classPrivateFieldGet$4(this,_EventStream_rejectConnectedPromise,"f").call(this,s),__classPrivateFieldGet$4(this,_EventStream_rejectEndPromise,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=r[0];!__classPrivateFieldGet$4(this,_EventStream_catchingPromiseCreated,"f")&&!(n!=null&&n.length)&&Promise.reject(s),__classPrivateFieldGet$4(this,_EventStream_rejectConnectedPromise,"f").call(this,s),__classPrivateFieldGet$4(this,_EventStream_rejectEndPromise,"f").call(this,s),this._emit("end")}}_emitFinal(){}}_EventStream_connectedPromise=new WeakMap,_EventStream_resolveConnectedPromise=new WeakMap,_EventStream_rejectConnectedPromise=new WeakMap,_EventStream_endPromise=new WeakMap,_EventStream_resolveEndPromise=new WeakMap,_EventStream_rejectEndPromise=new WeakMap,_EventStream_listeners=new WeakMap,_EventStream_ended=new WeakMap,_EventStream_errored=new WeakMap,_EventStream_aborted=new WeakMap,_EventStream_catchingPromiseCreated=new WeakMap,_EventStream_instances=new WeakSet,_EventStream_handleError=function t(e){if(__classPrivateFieldSet$3(this,_EventStream_errored,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new APIUserAbortError),e instanceof APIUserAbortError)return __classPrivateFieldSet$3(this,_EventStream_aborted,!0,"f"),this._emit("abort",e);if(e instanceof OpenAIError)return this._emit("error",e);if(e instanceof Error){const r=new OpenAIError(e.message);return r.cause=e,this._emit("error",r)}return this._emit("error",new OpenAIError(String(e)))};var __classPrivateFieldGet$3=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},__classPrivateFieldSet$2=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},_AssistantStream_instances,_AssistantStream_events,_AssistantStream_runStepSnapshots,_AssistantStream_messageSnapshots,_AssistantStream_messageSnapshot,_AssistantStream_finalRun,_AssistantStream_currentContentIndex,_AssistantStream_currentContent,_AssistantStream_currentToolCallIndex,_AssistantStream_currentToolCall,_AssistantStream_currentEvent,_AssistantStream_currentRunSnapshot,_AssistantStream_currentRunStepSnapshot,_AssistantStream_addEvent,_AssistantStream_endRequest,_AssistantStream_handleMessage,_AssistantStream_handleRunStep,_AssistantStream_handleEvent,_AssistantStream_accumulateRunStep,_AssistantStream_accumulateMessage,_AssistantStream_accumulateContent,_AssistantStream_handleRun;class AssistantStream extends EventStream{constructor(){super(...arguments),_AssistantStream_instances.add(this),_AssistantStream_events.set(this,[]),_AssistantStream_runStepSnapshots.set(this,{}),_AssistantStream_messageSnapshots.set(this,{}),_AssistantStream_messageSnapshot.set(this,void 0),_AssistantStream_finalRun.set(this,void 0),_AssistantStream_currentContentIndex.set(this,void 0),_AssistantStream_currentContent.set(this,void 0),_AssistantStream_currentToolCallIndex.set(this,void 0),_AssistantStream_currentToolCall.set(this,void 0),_AssistantStream_currentEvent.set(this,void 0),_AssistantStream_currentRunSnapshot.set(this,void 0),_AssistantStream_currentRunStepSnapshot.set(this,void 0)}[(_AssistantStream_events=new WeakMap,_AssistantStream_runStepSnapshots=new WeakMap,_AssistantStream_messageSnapshots=new WeakMap,_AssistantStream_messageSnapshot=new WeakMap,_AssistantStream_finalRun=new WeakMap,_AssistantStream_currentContentIndex=new WeakMap,_AssistantStream_currentContent=new WeakMap,_AssistantStream_currentToolCallIndex=new WeakMap,_AssistantStream_currentToolCall=new WeakMap,_AssistantStream_currentEvent=new WeakMap,_AssistantStream_currentRunSnapshot=new WeakMap,_AssistantStream_currentRunStepSnapshot=new WeakMap,_AssistantStream_instances=new WeakSet,Symbol.asyncIterator)](){const e=[],r=[];let n=!1;return this.on("event",s=>{const a=r.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{n=!0;for(const s of r)s.resolve(void 0);r.length=0}),this.on("abort",s=>{n=!0;for(const a of r)a.reject(s);r.length=0}),this.on("error",s=>{n=!0;for(const a of r)a.reject(s);r.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,o)=>r.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const r=new AssistantStream;return r._run(()=>r._fromReadableStream(e)),r}async _fromReadableStream(e,r){var a;const n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=Stream.fromReadableStream(e,this.controller);for await(const o of s)__classPrivateFieldGet$3(this,_AssistantStream_instances,"m",_AssistantStream_addEvent).call(this,o);if((a=s.controller.signal)!=null&&a.aborted)throw new APIUserAbortError;return this._addRun(__classPrivateFieldGet$3(this,_AssistantStream_instances,"m",_AssistantStream_endRequest).call(this))}toReadableStream(){return new Stream(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,r,n,s,a){const o=new AssistantStream;return o._run(()=>o._runToolAssistantStream(e,r,n,s,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(e,r,n,s,a){var c;const o=a==null?void 0:a.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const l={...s,stream:!0},u=await e.submitToolOutputs(r,n,l,{...a,signal:this.controller.signal});this._connected();for await(const d of u)__classPrivateFieldGet$3(this,_AssistantStream_instances,"m",_AssistantStream_addEvent).call(this,d);if((c=u.controller.signal)!=null&&c.aborted)throw new APIUserAbortError;return this._addRun(__classPrivateFieldGet$3(this,_AssistantStream_instances,"m",_AssistantStream_endRequest).call(this))}static createThreadAssistantStream(e,r,n){const s=new AssistantStream;return s._run(()=>s._threadAssistantStream(e,r,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,r,n,s){const a=new AssistantStream;return a._run(()=>a._runAssistantStream(e,r,n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),a}currentEvent(){return __classPrivateFieldGet$3(this,_AssistantStream_currentEvent,"f")}currentRun(){return __classPrivateFieldGet$3(this,_AssistantStream_currentRunSnapshot,"f")}currentMessageSnapshot(){return __classPrivateFieldGet$3(this,_AssistantStream_messageSnapshot,"f")}currentRunStepSnapshot(){return __classPrivateFieldGet$3(this,_AssistantStream_currentRunStepSnapshot,"f")}async finalRunSteps(){return await this.done(),Object.values(__classPrivateFieldGet$3(this,_AssistantStream_runStepSnapshots,"f"))}async finalMessages(){return await this.done(),Object.values(__classPrivateFieldGet$3(this,_AssistantStream_messageSnapshots,"f"))}async finalRun(){if(await this.done(),!__classPrivateFieldGet$3(this,_AssistantStream_finalRun,"f"))throw Error("Final run was not received.");return __classPrivateFieldGet$3(this,_AssistantStream_finalRun,"f")}async _createThreadAssistantStream(e,r,n){var l;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const a={...r,stream:!0},o=await e.createAndRun(a,{...n,signal:this.controller.signal});this._connected();for await(const u of o)__classPrivateFieldGet$3(this,_AssistantStream_instances,"m",_AssistantStream_addEvent).call(this,u);if((l=o.controller.signal)!=null&&l.aborted)throw new APIUserAbortError;return this._addRun(__classPrivateFieldGet$3(this,_AssistantStream_instances,"m",_AssistantStream_endRequest).call(this))}async _createAssistantStream(e,r,n,s){var u;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...n,stream:!0},l=await e.create(r,o,{...s,signal:this.controller.signal});this._connected();for await(const c of l)__classPrivateFieldGet$3(this,_AssistantStream_instances,"m",_AssistantStream_addEvent).call(this,c);if((u=l.controller.signal)!=null&&u.aborted)throw new APIUserAbortError;return this._addRun(__classPrivateFieldGet$3(this,_AssistantStream_instances,"m",_AssistantStream_endRequest).call(this))}static accumulateDelta(e,r){for(const[n,s]of Object.entries(r)){if(!e.hasOwnProperty(n)){e[n]=s;continue}let a=e[n];if(a==null){e[n]=s;continue}if(n==="index"||n==="type"){e[n]=s;continue}if(typeof a=="string"&&typeof s=="string")a+=s;else if(typeof a=="number"&&typeof s=="number")a+=s;else if(isObj(a)&&isObj(s))a=this.accumulateDelta(a,s);else if(Array.isArray(a)&&Array.isArray(s)){if(a.every(o=>typeof o=="string"||typeof o=="number")){a.push(...s);continue}for(const o of s){if(!isObj(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const l=o.index;if(l==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof l!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${l}`);const u=a[l];u==null?a.push(o):a[l]=this.accumulateDelta(u,o)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${s}, accValue: ${a}`);e[n]=a}return e}_addRun(e){return e}async _threadAssistantStream(e,r,n){return await this._createThreadAssistantStream(r,e,n)}async _runAssistantStream(e,r,n,s){return await this._createAssistantStream(r,e,n,s)}async _runToolAssistantStream(e,r,n,s,a){return await this._createToolAssistantStream(n,e,r,s,a)}}_AssistantStream_addEvent=function t(e){if(!this.ended)switch(__classPrivateFieldSet$2(this,_AssistantStream_currentEvent,e,"f"),__classPrivateFieldGet$3(this,_AssistantStream_instances,"m",_AssistantStream_handleEvent).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":__classPrivateFieldGet$3(this,_AssistantStream_instances,"m",_AssistantStream_handleRun).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":__classPrivateFieldGet$3(this,_AssistantStream_instances,"m",_AssistantStream_handleRunStep).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":__classPrivateFieldGet$3(this,_AssistantStream_instances,"m",_AssistantStream_handleMessage).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},_AssistantStream_endRequest=function t(){if(this.ended)throw new OpenAIError("stream has ended, this shouldn't happen");if(!__classPrivateFieldGet$3(this,_AssistantStream_finalRun,"f"))throw Error("Final run has not been received");return __classPrivateFieldGet$3(this,_AssistantStream_finalRun,"f")},_AssistantStream_handleMessage=function t(e){const[r,n]=__classPrivateFieldGet$3(this,_AssistantStream_instances,"m",_AssistantStream_accumulateMessage).call(this,e,__classPrivateFieldGet$3(this,_AssistantStream_messageSnapshot,"f"));__classPrivateFieldSet$2(this,_AssistantStream_messageSnapshot,r,"f"),__classPrivateFieldGet$3(this,_AssistantStream_messageSnapshots,"f")[r.id]=r;for(const s of n){const a=r.content[s.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,r),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let a=s.text,o=r.content[s.index];if(o&&o.type=="text")this._emit("textDelta",a,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=__classPrivateFieldGet$3(this,_AssistantStream_currentContentIndex,"f")){if(__classPrivateFieldGet$3(this,_AssistantStream_currentContent,"f"))switch(__classPrivateFieldGet$3(this,_AssistantStream_currentContent,"f").type){case"text":this._emit("textDone",__classPrivateFieldGet$3(this,_AssistantStream_currentContent,"f").text,__classPrivateFieldGet$3(this,_AssistantStream_messageSnapshot,"f"));break;case"image_file":this._emit("imageFileDone",__classPrivateFieldGet$3(this,_AssistantStream_currentContent,"f").image_file,__classPrivateFieldGet$3(this,_AssistantStream_messageSnapshot,"f"));break}__classPrivateFieldSet$2(this,_AssistantStream_currentContentIndex,s.index,"f")}__classPrivateFieldSet$2(this,_AssistantStream_currentContent,r.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(__classPrivateFieldGet$3(this,_AssistantStream_currentContentIndex,"f")!==void 0){const s=e.data.content[__classPrivateFieldGet$3(this,_AssistantStream_currentContentIndex,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,__classPrivateFieldGet$3(this,_AssistantStream_messageSnapshot,"f"));break;case"text":this._emit("textDone",s.text,__classPrivateFieldGet$3(this,_AssistantStream_messageSnapshot,"f"));break}}__classPrivateFieldGet$3(this,_AssistantStream_messageSnapshot,"f")&&this._emit("messageDone",e.data),__classPrivateFieldSet$2(this,_AssistantStream_messageSnapshot,void 0,"f")}},_AssistantStream_handleRunStep=function t(e){const r=__classPrivateFieldGet$3(this,_AssistantStream_instances,"m",_AssistantStream_accumulateRunStep).call(this,e);switch(__classPrivateFieldSet$2(this,_AssistantStream_currentRunStepSnapshot,r,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&r.step_details.type=="tool_calls")for(const a of n.step_details.tool_calls)a.index==__classPrivateFieldGet$3(this,_AssistantStream_currentToolCallIndex,"f")?this._emit("toolCallDelta",a,r.step_details.tool_calls[a.index]):(__classPrivateFieldGet$3(this,_AssistantStream_currentToolCall,"f")&&this._emit("toolCallDone",__classPrivateFieldGet$3(this,_AssistantStream_currentToolCall,"f")),__classPrivateFieldSet$2(this,_AssistantStream_currentToolCallIndex,a.index,"f"),__classPrivateFieldSet$2(this,_AssistantStream_currentToolCall,r.step_details.tool_calls[a.index],"f"),__classPrivateFieldGet$3(this,_AssistantStream_currentToolCall,"f")&&this._emit("toolCallCreated",__classPrivateFieldGet$3(this,_AssistantStream_currentToolCall,"f")));this._emit("runStepDelta",e.data.delta,r);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":__classPrivateFieldSet$2(this,_AssistantStream_currentRunStepSnapshot,void 0,"f"),e.data.step_details.type=="tool_calls"&&__classPrivateFieldGet$3(this,_AssistantStream_currentToolCall,"f")&&(this._emit("toolCallDone",__classPrivateFieldGet$3(this,_AssistantStream_currentToolCall,"f")),__classPrivateFieldSet$2(this,_AssistantStream_currentToolCall,void 0,"f")),this._emit("runStepDone",e.data,r);break}},_AssistantStream_handleEvent=function t(e){__classPrivateFieldGet$3(this,_AssistantStream_events,"f").push(e),this._emit("event",e)},_AssistantStream_accumulateRunStep=function t(e){switch(e.event){case"thread.run.step.created":return __classPrivateFieldGet$3(this,_AssistantStream_runStepSnapshots,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let r=__classPrivateFieldGet$3(this,_AssistantStream_runStepSnapshots,"f")[e.data.id];if(!r)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const s=AssistantStream.accumulateDelta(r,n.delta);__classPrivateFieldGet$3(this,_AssistantStream_runStepSnapshots,"f")[e.data.id]=s}return __classPrivateFieldGet$3(this,_AssistantStream_runStepSnapshots,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":__classPrivateFieldGet$3(this,_AssistantStream_runStepSnapshots,"f")[e.data.id]=e.data;break}if(__classPrivateFieldGet$3(this,_AssistantStream_runStepSnapshots,"f")[e.data.id])return __classPrivateFieldGet$3(this,_AssistantStream_runStepSnapshots,"f")[e.data.id];throw new Error("No snapshot available")},_AssistantStream_accumulateMessage=function t(e,r){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!r)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const a of s.delta.content)if(a.index in r.content){let o=r.content[a.index];r.content[a.index]=__classPrivateFieldGet$3(this,_AssistantStream_instances,"m",_AssistantStream_accumulateContent).call(this,a,o)}else r.content[a.index]=a,n.push(a);return[r,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(r)return[r,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},_AssistantStream_accumulateContent=function t(e,r){return AssistantStream.accumulateDelta(r,e)},_AssistantStream_handleRun=function t(e){switch(__classPrivateFieldSet$2(this,_AssistantStream_currentRunSnapshot,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":__classPrivateFieldSet$2(this,_AssistantStream_finalRun,e.data,"f"),__classPrivateFieldGet$3(this,_AssistantStream_currentToolCall,"f")&&(this._emit("toolCallDone",__classPrivateFieldGet$3(this,_AssistantStream_currentToolCall,"f")),__classPrivateFieldSet$2(this,_AssistantStream_currentToolCall,void 0,"f"));break}};class Assistants extends APIResource{create(e,r){return this._client.post("/assistants",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,r){return this._client.get(`/assistants/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,r,n){return this._client.post(`/assistants/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},r){return isRequestOptions(e)?this.list({},e):this._client.getAPIList("/assistants",AssistantsPage,{query:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,r){return this._client.delete(`/assistants/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class AssistantsPage extends CursorPage{}Assistants.AssistantsPage=AssistantsPage;function isRunnableFunctionWithParse(t){return typeof t.parse=="function"}const isAssistantMessage=t=>(t==null?void 0:t.role)==="assistant",isFunctionMessage=t=>(t==null?void 0:t.role)==="function",isToolMessage=t=>(t==null?void 0:t.role)==="tool";function makeParseableResponseFormat(t,e){const r={...t};return Object.defineProperties(r,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),r}function isAutoParsableResponseFormat(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function isAutoParsableTool$1(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function maybeParseChatCompletion(t,e){return!e||!hasAutoParseableInput$1(e)?{...t,choices:t.choices.map(r=>({...r,message:{...r.message,parsed:null,...r.message.tool_calls?{tool_calls:r.message.tool_calls}:void 0}}))}:parseChatCompletion(t,e)}function parseChatCompletion(t,e){const r=t.choices.map(n=>{var s;if(n.finish_reason==="length")throw new LengthFinishReasonError;if(n.finish_reason==="content_filter")throw new ContentFilterFinishReasonError;return{...n,message:{...n.message,...n.message.tool_calls?{tool_calls:((s=n.message.tool_calls)==null?void 0:s.map(a=>parseToolCall$2(e,a)))??void 0}:void 0,parsed:n.message.content&&!n.message.refusal?parseResponseFormat(e,n.message.content):null}}});return{...t,choices:r}}function parseResponseFormat(t,e){var r,n;return((r=t.response_format)==null?void 0:r.type)!=="json_schema"?null:((n=t.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function parseToolCall$2(t,e){var n;const r=(n=t.tools)==null?void 0:n.find(s=>{var a;return((a=s.function)==null?void 0:a.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:isAutoParsableTool$1(r)?r.$parseRaw(e.function.arguments):r!=null&&r.function.strict?JSON.parse(e.function.arguments):null}}}function shouldParseToolCall(t,e){var n;if(!t)return!1;const r=(n=t.tools)==null?void 0:n.find(s=>{var a;return((a=s.function)==null?void 0:a.name)===e.function.name});return isAutoParsableTool$1(r)||(r==null?void 0:r.function.strict)||!1}function hasAutoParseableInput$1(t){var e;return isAutoParsableResponseFormat(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(r=>isAutoParsableTool$1(r)||r.type==="function"&&r.function.strict===!0))??!1}function validateInputTools(t){for(const e of t??[]){if(e.type!=="function")throw new OpenAIError(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new OpenAIError(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var __classPrivateFieldGet$2=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},_AbstractChatCompletionRunner_instances,_AbstractChatCompletionRunner_getFinalContent,_AbstractChatCompletionRunner_getFinalMessage,_AbstractChatCompletionRunner_getFinalFunctionCall,_AbstractChatCompletionRunner_getFinalFunctionCallResult,_AbstractChatCompletionRunner_calculateTotalUsage,_AbstractChatCompletionRunner_validateParams,_AbstractChatCompletionRunner_stringifyFunctionCallResult;const DEFAULT_MAX_CHAT_COMPLETIONS=10;class AbstractChatCompletionRunner extends EventStream{constructor(){super(...arguments),_AbstractChatCompletionRunner_instances.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var n;this._chatCompletions.push(e),this._emit("chatCompletion",e);const r=(n=e.choices[0])==null?void 0:n.message;return r&&this._addMessage(r),e}_addMessage(e,r=!0){if("content"in e||(e.content=null),this.messages.push(e),r){if(this._emit("message",e),(isFunctionMessage(e)||isToolMessage(e))&&e.content)this._emit("functionCallResult",e.content);else if(isAssistantMessage(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(isAssistantMessage(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new OpenAIError("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),__classPrivateFieldGet$2(this,_AbstractChatCompletionRunner_instances,"m",_AbstractChatCompletionRunner_getFinalContent).call(this)}async finalMessage(){return await this.done(),__classPrivateFieldGet$2(this,_AbstractChatCompletionRunner_instances,"m",_AbstractChatCompletionRunner_getFinalMessage).call(this)}async finalFunctionCall(){return await this.done(),__classPrivateFieldGet$2(this,_AbstractChatCompletionRunner_instances,"m",_AbstractChatCompletionRunner_getFinalFunctionCall).call(this)}async finalFunctionCallResult(){return await this.done(),__classPrivateFieldGet$2(this,_AbstractChatCompletionRunner_instances,"m",_AbstractChatCompletionRunner_getFinalFunctionCallResult).call(this)}async totalUsage(){return await this.done(),__classPrivateFieldGet$2(this,_AbstractChatCompletionRunner_instances,"m",_AbstractChatCompletionRunner_calculateTotalUsage).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const r=__classPrivateFieldGet$2(this,_AbstractChatCompletionRunner_instances,"m",_AbstractChatCompletionRunner_getFinalMessage).call(this);r&&this._emit("finalMessage",r);const n=__classPrivateFieldGet$2(this,_AbstractChatCompletionRunner_instances,"m",_AbstractChatCompletionRunner_getFinalContent).call(this);n&&this._emit("finalContent",n);const s=__classPrivateFieldGet$2(this,_AbstractChatCompletionRunner_instances,"m",_AbstractChatCompletionRunner_getFinalFunctionCall).call(this);s&&this._emit("finalFunctionCall",s);const a=__classPrivateFieldGet$2(this,_AbstractChatCompletionRunner_instances,"m",_AbstractChatCompletionRunner_getFinalFunctionCallResult).call(this);a!=null&&this._emit("finalFunctionCallResult",a),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",__classPrivateFieldGet$2(this,_AbstractChatCompletionRunner_instances,"m",_AbstractChatCompletionRunner_calculateTotalUsage).call(this))}async _createChatCompletion(e,r,n){const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),__classPrivateFieldGet$2(this,_AbstractChatCompletionRunner_instances,"m",_AbstractChatCompletionRunner_validateParams).call(this,r);const a=await e.chat.completions.create({...r,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(parseChatCompletion(a,r))}async _runChatCompletion(e,r,n){for(const s of r.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,r,n)}async _runFunctions(e,r,n){var m;const s="function",{function_call:a="auto",stream:o,...l}=r,u=typeof a!="string"&&(a==null?void 0:a.name),{maxChatCompletions:c=DEFAULT_MAX_CHAT_COMPLETIONS}=n||{},d={};for(const y of r.functions)d[y.name||y.function.name]=y;const p=r.functions.map(y=>({name:y.name||y.function.name,parameters:y.parameters,description:y.description}));for(const y of r.messages)this._addMessage(y,!1);for(let y=0;y<c;++y){const E=(m=(await this._createChatCompletion(e,{...l,function_call:a,functions:p,messages:[...this.messages]},n)).choices[0])==null?void 0:m.message;if(!E)throw new OpenAIError("missing message in ChatCompletion response");if(!E.function_call)return;const{name:T,arguments:S}=E.function_call,P=d[T];if(P){if(u&&u!==T){const K=`Invalid function_call: ${JSON.stringify(T)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:s,name:T,content:K});continue}}else{const K=`Invalid function_call: ${JSON.stringify(T)}. Available options are: ${p.map(W=>JSON.stringify(W.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:T,content:K});continue}let A;try{A=isRunnableFunctionWithParse(P)?await P.parse(S):S}catch(K){this._addMessage({role:s,name:T,content:K instanceof Error?K.message:String(K)});continue}const I=await P.function(A,this),j=__classPrivateFieldGet$2(this,_AbstractChatCompletionRunner_instances,"m",_AbstractChatCompletionRunner_stringifyFunctionCallResult).call(this,I);if(this._addMessage({role:s,name:T,content:j}),u)return}}async _runTools(e,r,n){var y,b,E;const s="tool",{tool_choice:a="auto",stream:o,...l}=r,u=typeof a!="string"&&((y=a==null?void 0:a.function)==null?void 0:y.name),{maxChatCompletions:c=DEFAULT_MAX_CHAT_COMPLETIONS}=n||{},d=r.tools.map(T=>{if(isAutoParsableTool$1(T)){if(!T.$callback)throw new OpenAIError("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:T.$callback,name:T.function.name,description:T.function.description||"",parameters:T.function.parameters,parse:T.$parseRaw,strict:!0}}}return T}),p={};for(const T of d)T.type==="function"&&(p[T.function.name||T.function.function.name]=T.function);const m="tools"in r?d.map(T=>T.type==="function"?{type:"function",function:{name:T.function.name||T.function.function.name,parameters:T.function.parameters,description:T.function.description,strict:T.function.strict}}:T):void 0;for(const T of r.messages)this._addMessage(T,!1);for(let T=0;T<c;++T){const P=(b=(await this._createChatCompletion(e,{...l,tool_choice:a,tools:m,messages:[...this.messages]},n)).choices[0])==null?void 0:b.message;if(!P)throw new OpenAIError("missing message in ChatCompletion response");if(!((E=P.tool_calls)!=null&&E.length))return;for(const A of P.tool_calls){if(A.type!=="function")continue;const I=A.id,{name:j,arguments:K}=A.function,W=p[j];if(W){if(u&&u!==j){const de=`Invalid tool_call: ${JSON.stringify(j)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:s,tool_call_id:I,content:de});continue}}else{const de=`Invalid tool_call: ${JSON.stringify(j)}. Available options are: ${Object.keys(p).map(fe=>JSON.stringify(fe)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:I,content:de});continue}let H;try{H=isRunnableFunctionWithParse(W)?await W.parse(K):K}catch(de){const fe=de instanceof Error?de.message:String(de);this._addMessage({role:s,tool_call_id:I,content:fe});continue}const ee=await W.function(H,this),ue=__classPrivateFieldGet$2(this,_AbstractChatCompletionRunner_instances,"m",_AbstractChatCompletionRunner_stringifyFunctionCallResult).call(this,ee);if(this._addMessage({role:s,tool_call_id:I,content:ue}),u)return}}}}_AbstractChatCompletionRunner_instances=new WeakSet,_AbstractChatCompletionRunner_getFinalContent=function t(){return __classPrivateFieldGet$2(this,_AbstractChatCompletionRunner_instances,"m",_AbstractChatCompletionRunner_getFinalMessage).call(this).content??null},_AbstractChatCompletionRunner_getFinalMessage=function t(){let e=this.messages.length;for(;e-- >0;){const r=this.messages[e];if(isAssistantMessage(r)){const{function_call:n,...s}=r,a={...s,content:r.content??null,refusal:r.refusal??null};return n&&(a.function_call=n),a}}throw new OpenAIError("stream ended without producing a ChatCompletionMessage with role=assistant")},_AbstractChatCompletionRunner_getFinalFunctionCall=function t(){var e,r;for(let n=this.messages.length-1;n>=0;n--){const s=this.messages[n];if(isAssistantMessage(s)&&(s!=null&&s.function_call))return s.function_call;if(isAssistantMessage(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(r=s.tool_calls.at(-1))==null?void 0:r.function}},_AbstractChatCompletionRunner_getFinalFunctionCallResult=function t(){for(let e=this.messages.length-1;e>=0;e--){const r=this.messages[e];if(isFunctionMessage(r)&&r.content!=null||isToolMessage(r)&&r.content!=null&&typeof r.content=="string"&&this.messages.some(n=>{var s;return n.role==="assistant"&&((s=n.tool_calls)==null?void 0:s.some(a=>a.type==="function"&&a.id===r.tool_call_id))}))return r.content}},_AbstractChatCompletionRunner_calculateTotalUsage=function t(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:r}of this._chatCompletions)r&&(e.completion_tokens+=r.completion_tokens,e.prompt_tokens+=r.prompt_tokens,e.total_tokens+=r.total_tokens);return e},_AbstractChatCompletionRunner_validateParams=function t(e){if(e.n!=null&&e.n>1)throw new OpenAIError("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},_AbstractChatCompletionRunner_stringifyFunctionCallResult=function t(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class ChatCompletionRunner extends AbstractChatCompletionRunner{static runFunctions(e,r,n){const s=new ChatCompletionRunner,a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,r,a)),s}static runTools(e,r,n){const s=new ChatCompletionRunner,a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,r,a)),s}_addMessage(e,r=!0){super._addMessage(e,r),isAssistantMessage(e)&&e.content&&this._emit("content",e.content)}}const STR=1,NUM=2,ARR=4,OBJ=8,NULL=16,BOOL=32,NAN=64,INFINITY=128,MINUS_INFINITY=256,INF=INFINITY|MINUS_INFINITY,SPECIAL=NULL|BOOL|INF|NAN,ATOM=STR|NUM|SPECIAL,COLLECTION=ARR|OBJ,ALL=ATOM|COLLECTION,Allow={STR,NUM,ARR,OBJ,NULL,BOOL,NAN,INFINITY,MINUS_INFINITY,INF,SPECIAL,ATOM,COLLECTION,ALL};class PartialJSON extends Error{}class MalformedJSON extends Error{}function parseJSON(t,e=Allow.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return _parseJSON(t.trim(),e)}const _parseJSON=(t,e)=>{const r=t.length;let n=0;const s=m=>{throw new PartialJSON(`${m} at position ${n}`)},a=m=>{throw new MalformedJSON(`${m} at position ${n}`)},o=()=>(p(),n>=r&&s("Unexpected end of input"),t[n]==='"'?l():t[n]==="{"?u():t[n]==="["?c():t.substring(n,n+4)==="null"||Allow.NULL&e&&r-n<4&&"null".startsWith(t.substring(n))?(n+=4,null):t.substring(n,n+4)==="true"||Allow.BOOL&e&&r-n<4&&"true".startsWith(t.substring(n))?(n+=4,!0):t.substring(n,n+5)==="false"||Allow.BOOL&e&&r-n<5&&"false".startsWith(t.substring(n))?(n+=5,!1):t.substring(n,n+8)==="Infinity"||Allow.INFINITY&e&&r-n<8&&"Infinity".startsWith(t.substring(n))?(n+=8,1/0):t.substring(n,n+9)==="-Infinity"||Allow.MINUS_INFINITY&e&&1<r-n&&r-n<9&&"-Infinity".startsWith(t.substring(n))?(n+=9,-1/0):t.substring(n,n+3)==="NaN"||Allow.NAN&e&&r-n<3&&"NaN".startsWith(t.substring(n))?(n+=3,NaN):d()),l=()=>{const m=n;let y=!1;for(n++;n<r&&(t[n]!=='"'||y&&t[n-1]==="\\");)y=t[n]==="\\"?!y:!1,n++;if(t.charAt(n)=='"')try{return JSON.parse(t.substring(m,++n-Number(y)))}catch(b){a(String(b))}else if(Allow.STR&e)try{return JSON.parse(t.substring(m,n-Number(y))+'"')}catch{return JSON.parse(t.substring(m,t.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},u=()=>{n++,p();const m={};try{for(;t[n]!=="}";){if(p(),n>=r&&Allow.OBJ&e)return m;const y=l();p(),n++;try{const b=o();Object.defineProperty(m,y,{value:b,writable:!0,enumerable:!0,configurable:!0})}catch(b){if(Allow.OBJ&e)return m;throw b}p(),t[n]===","&&n++}}catch{if(Allow.OBJ&e)return m;s("Expected '}' at end of object")}return n++,m},c=()=>{n++;const m=[];try{for(;t[n]!=="]";)m.push(o()),p(),t[n]===","&&n++}catch{if(Allow.ARR&e)return m;s("Expected ']' at end of array")}return n++,m},d=()=>{if(n===0){t==="-"&&Allow.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t)}catch(y){if(Allow.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}a(String(y))}}const m=n;for(t[n]==="-"&&n++;t[n]&&!",]}".includes(t[n]);)n++;n==r&&!(Allow.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(t.substring(m,n))}catch{t.substring(m,n)==="-"&&Allow.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t.substring(m,t.lastIndexOf("e")))}catch(b){a(String(b))}}},p=()=>{for(;n<r&&` 
\r	`.includes(t[n]);)n++};return o()},partialParse=t=>parseJSON(t,Allow.ALL^Allow.NUM);var __classPrivateFieldSet$1=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},__classPrivateFieldGet$1=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},_ChatCompletionStream_instances,_ChatCompletionStream_params,_ChatCompletionStream_choiceEventStates,_ChatCompletionStream_currentChatCompletionSnapshot,_ChatCompletionStream_beginRequest,_ChatCompletionStream_getChoiceEventState,_ChatCompletionStream_addChunk,_ChatCompletionStream_emitToolCallDoneEvent,_ChatCompletionStream_emitContentDoneEvents,_ChatCompletionStream_endRequest,_ChatCompletionStream_getAutoParseableResponseFormat,_ChatCompletionStream_accumulateChatCompletion;class ChatCompletionStream extends AbstractChatCompletionRunner{constructor(e){super(),_ChatCompletionStream_instances.add(this),_ChatCompletionStream_params.set(this,void 0),_ChatCompletionStream_choiceEventStates.set(this,void 0),_ChatCompletionStream_currentChatCompletionSnapshot.set(this,void 0),__classPrivateFieldSet$1(this,_ChatCompletionStream_params,e,"f"),__classPrivateFieldSet$1(this,_ChatCompletionStream_choiceEventStates,[],"f")}get currentChatCompletionSnapshot(){return __classPrivateFieldGet$1(this,_ChatCompletionStream_currentChatCompletionSnapshot,"f")}static fromReadableStream(e){const r=new ChatCompletionStream(null);return r._run(()=>r._fromReadableStream(e)),r}static createChatCompletion(e,r,n){const s=new ChatCompletionStream(r);return s._run(()=>s._runChatCompletion(e,{...r,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,r,n){var o;super._createChatCompletion;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),__classPrivateFieldGet$1(this,_ChatCompletionStream_instances,"m",_ChatCompletionStream_beginRequest).call(this);const a=await e.chat.completions.create({...r,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const l of a)__classPrivateFieldGet$1(this,_ChatCompletionStream_instances,"m",_ChatCompletionStream_addChunk).call(this,l);if((o=a.controller.signal)!=null&&o.aborted)throw new APIUserAbortError;return this._addChatCompletion(__classPrivateFieldGet$1(this,_ChatCompletionStream_instances,"m",_ChatCompletionStream_endRequest).call(this))}async _fromReadableStream(e,r){var o;const n=r==null?void 0:r.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),__classPrivateFieldGet$1(this,_ChatCompletionStream_instances,"m",_ChatCompletionStream_beginRequest).call(this),this._connected();const s=Stream.fromReadableStream(e,this.controller);let a;for await(const l of s)a&&a!==l.id&&this._addChatCompletion(__classPrivateFieldGet$1(this,_ChatCompletionStream_instances,"m",_ChatCompletionStream_endRequest).call(this)),__classPrivateFieldGet$1(this,_ChatCompletionStream_instances,"m",_ChatCompletionStream_addChunk).call(this,l),a=l.id;if((o=s.controller.signal)!=null&&o.aborted)throw new APIUserAbortError;return this._addChatCompletion(__classPrivateFieldGet$1(this,_ChatCompletionStream_instances,"m",_ChatCompletionStream_endRequest).call(this))}[(_ChatCompletionStream_params=new WeakMap,_ChatCompletionStream_choiceEventStates=new WeakMap,_ChatCompletionStream_currentChatCompletionSnapshot=new WeakMap,_ChatCompletionStream_instances=new WeakSet,_ChatCompletionStream_beginRequest=function(){this.ended||__classPrivateFieldSet$1(this,_ChatCompletionStream_currentChatCompletionSnapshot,void 0,"f")},_ChatCompletionStream_getChoiceEventState=function(r){let n=__classPrivateFieldGet$1(this,_ChatCompletionStream_choiceEventStates,"f")[r.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},__classPrivateFieldGet$1(this,_ChatCompletionStream_choiceEventStates,"f")[r.index]=n,n)},_ChatCompletionStream_addChunk=function(r){var s,a,o,l,u,c,d,p,m,y,b,E,T,S,P;if(this.ended)return;const n=__classPrivateFieldGet$1(this,_ChatCompletionStream_instances,"m",_ChatCompletionStream_accumulateChatCompletion).call(this,r);this._emit("chunk",r,n);for(const A of r.choices){const I=n.choices[A.index];A.delta.content!=null&&((s=I.message)==null?void 0:s.role)==="assistant"&&((a=I.message)!=null&&a.content)&&(this._emit("content",A.delta.content,I.message.content),this._emit("content.delta",{delta:A.delta.content,snapshot:I.message.content,parsed:I.message.parsed})),A.delta.refusal!=null&&((o=I.message)==null?void 0:o.role)==="assistant"&&((l=I.message)!=null&&l.refusal)&&this._emit("refusal.delta",{delta:A.delta.refusal,snapshot:I.message.refusal}),((u=A.logprobs)==null?void 0:u.content)!=null&&((c=I.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(d=A.logprobs)==null?void 0:d.content,snapshot:((p=I.logprobs)==null?void 0:p.content)??[]}),((m=A.logprobs)==null?void 0:m.refusal)!=null&&((y=I.message)==null?void 0:y.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(b=A.logprobs)==null?void 0:b.refusal,snapshot:((E=I.logprobs)==null?void 0:E.refusal)??[]});const j=__classPrivateFieldGet$1(this,_ChatCompletionStream_instances,"m",_ChatCompletionStream_getChoiceEventState).call(this,I);I.finish_reason&&(__classPrivateFieldGet$1(this,_ChatCompletionStream_instances,"m",_ChatCompletionStream_emitContentDoneEvents).call(this,I),j.current_tool_call_index!=null&&__classPrivateFieldGet$1(this,_ChatCompletionStream_instances,"m",_ChatCompletionStream_emitToolCallDoneEvent).call(this,I,j.current_tool_call_index));for(const K of A.delta.tool_calls??[])j.current_tool_call_index!==K.index&&(__classPrivateFieldGet$1(this,_ChatCompletionStream_instances,"m",_ChatCompletionStream_emitContentDoneEvents).call(this,I),j.current_tool_call_index!=null&&__classPrivateFieldGet$1(this,_ChatCompletionStream_instances,"m",_ChatCompletionStream_emitToolCallDoneEvent).call(this,I,j.current_tool_call_index)),j.current_tool_call_index=K.index;for(const K of A.delta.tool_calls??[]){const W=(T=I.message.tool_calls)==null?void 0:T[K.index];W!=null&&W.type&&((W==null?void 0:W.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(S=W.function)==null?void 0:S.name,index:K.index,arguments:W.function.arguments,parsed_arguments:W.function.parsed_arguments,arguments_delta:((P=K.function)==null?void 0:P.arguments)??""}):(W==null||W.type,void 0))}}},_ChatCompletionStream_emitToolCallDoneEvent=function(r,n){var o,l,u;if(__classPrivateFieldGet$1(this,_ChatCompletionStream_instances,"m",_ChatCompletionStream_getChoiceEventState).call(this,r).done_tool_calls.has(n))return;const a=(o=r.message.tool_calls)==null?void 0:o[n];if(!a)throw new Error("no tool call snapshot");if(!a.type)throw new Error("tool call snapshot missing `type`");if(a.type==="function"){const c=(u=(l=__classPrivateFieldGet$1(this,_ChatCompletionStream_params,"f"))==null?void 0:l.tools)==null?void 0:u.find(d=>d.type==="function"&&d.function.name===a.function.name);this._emit("tool_calls.function.arguments.done",{name:a.function.name,index:n,arguments:a.function.arguments,parsed_arguments:isAutoParsableTool$1(c)?c.$parseRaw(a.function.arguments):c!=null&&c.function.strict?JSON.parse(a.function.arguments):null})}else a.type},_ChatCompletionStream_emitContentDoneEvents=function(r){var s,a;const n=__classPrivateFieldGet$1(this,_ChatCompletionStream_instances,"m",_ChatCompletionStream_getChoiceEventState).call(this,r);if(r.message.content&&!n.content_done){n.content_done=!0;const o=__classPrivateFieldGet$1(this,_ChatCompletionStream_instances,"m",_ChatCompletionStream_getAutoParseableResponseFormat).call(this);this._emit("content.done",{content:r.message.content,parsed:o?o.$parseRaw(r.message.content):null})}r.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:r.message.refusal})),(s=r.logprobs)!=null&&s.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:r.logprobs.content})),(a=r.logprobs)!=null&&a.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:r.logprobs.refusal}))},_ChatCompletionStream_endRequest=function(){if(this.ended)throw new OpenAIError("stream has ended, this shouldn't happen");const r=__classPrivateFieldGet$1(this,_ChatCompletionStream_currentChatCompletionSnapshot,"f");if(!r)throw new OpenAIError("request ended without sending any chunks");return __classPrivateFieldSet$1(this,_ChatCompletionStream_currentChatCompletionSnapshot,void 0,"f"),__classPrivateFieldSet$1(this,_ChatCompletionStream_choiceEventStates,[],"f"),finalizeChatCompletion(r,__classPrivateFieldGet$1(this,_ChatCompletionStream_params,"f"))},_ChatCompletionStream_getAutoParseableResponseFormat=function(){var n;const r=(n=__classPrivateFieldGet$1(this,_ChatCompletionStream_params,"f"))==null?void 0:n.response_format;return isAutoParsableResponseFormat(r)?r:null},_ChatCompletionStream_accumulateChatCompletion=function(r){var n,s,a,o;let l=__classPrivateFieldGet$1(this,_ChatCompletionStream_currentChatCompletionSnapshot,"f");const{choices:u,...c}=r;l?Object.assign(l,c):l=__classPrivateFieldSet$1(this,_ChatCompletionStream_currentChatCompletionSnapshot,{...c,choices:[]},"f");for(const{delta:d,finish_reason:p,index:m,logprobs:y=null,...b}of r.choices){let E=l.choices[m];if(E||(E=l.choices[m]={finish_reason:p,index:m,message:{},logprobs:y,...b}),y)if(!E.logprobs)E.logprobs=Object.assign({},y);else{const{content:K,refusal:W,...H}=y;Object.assign(E.logprobs,H),K&&((n=E.logprobs).content??(n.content=[]),E.logprobs.content.push(...K)),W&&((s=E.logprobs).refusal??(s.refusal=[]),E.logprobs.refusal.push(...W))}if(p&&(E.finish_reason=p,__classPrivateFieldGet$1(this,_ChatCompletionStream_params,"f")&&hasAutoParseableInput$1(__classPrivateFieldGet$1(this,_ChatCompletionStream_params,"f")))){if(p==="length")throw new LengthFinishReasonError;if(p==="content_filter")throw new ContentFilterFinishReasonError}if(Object.assign(E,b),!d)continue;const{content:T,refusal:S,function_call:P,role:A,tool_calls:I,...j}=d;if(Object.assign(E.message,j),S&&(E.message.refusal=(E.message.refusal||"")+S),A&&(E.message.role=A),P&&(E.message.function_call?(P.name&&(E.message.function_call.name=P.name),P.arguments&&((a=E.message.function_call).arguments??(a.arguments=""),E.message.function_call.arguments+=P.arguments)):E.message.function_call=P),T&&(E.message.content=(E.message.content||"")+T,!E.message.refusal&&__classPrivateFieldGet$1(this,_ChatCompletionStream_instances,"m",_ChatCompletionStream_getAutoParseableResponseFormat).call(this)&&(E.message.parsed=partialParse(E.message.content))),I){E.message.tool_calls||(E.message.tool_calls=[]);for(const{index:K,id:W,type:H,function:ee,...ue}of I){const de=(o=E.message.tool_calls)[K]??(o[K]={});Object.assign(de,ue),W&&(de.id=W),H&&(de.type=H),ee&&(de.function??(de.function={name:ee.name??"",arguments:""})),ee!=null&&ee.name&&(de.function.name=ee.name),ee!=null&&ee.arguments&&(de.function.arguments+=ee.arguments,shouldParseToolCall(__classPrivateFieldGet$1(this,_ChatCompletionStream_params,"f"),de)&&(de.function.parsed_arguments=partialParse(de.function.arguments)))}}}return l},Symbol.asyncIterator)](){const e=[],r=[];let n=!1;return this.on("chunk",s=>{const a=r.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{n=!0;for(const s of r)s.resolve(void 0);r.length=0}),this.on("abort",s=>{n=!0;for(const a of r)a.reject(s);r.length=0}),this.on("error",s=>{n=!0;for(const a of r)a.reject(s);r.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,o)=>r.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Stream(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function finalizeChatCompletion(t,e){const{id:r,choices:n,created:s,model:a,system_fingerprint:o,...l}=t,u={...l,id:r,choices:n.map(({message:c,finish_reason:d,index:p,logprobs:m,...y})=>{if(!d)throw new OpenAIError(`missing finish_reason for choice ${p}`);const{content:b=null,function_call:E,tool_calls:T,...S}=c,P=c.role;if(!P)throw new OpenAIError(`missing role for choice ${p}`);if(E){const{arguments:A,name:I}=E;if(A==null)throw new OpenAIError(`missing function_call.arguments for choice ${p}`);if(!I)throw new OpenAIError(`missing function_call.name for choice ${p}`);return{...y,message:{content:b,function_call:{arguments:A,name:I},role:P,refusal:c.refusal??null},finish_reason:d,index:p,logprobs:m}}return T?{...y,index:p,finish_reason:d,logprobs:m,message:{...S,role:P,content:b,refusal:c.refusal??null,tool_calls:T.map((A,I)=>{const{function:j,type:K,id:W,...H}=A,{arguments:ee,name:ue,...de}=j||{};if(W==null)throw new OpenAIError(`missing choices[${p}].tool_calls[${I}].id
${str(t)}`);if(K==null)throw new OpenAIError(`missing choices[${p}].tool_calls[${I}].type
${str(t)}`);if(ue==null)throw new OpenAIError(`missing choices[${p}].tool_calls[${I}].function.name
${str(t)}`);if(ee==null)throw new OpenAIError(`missing choices[${p}].tool_calls[${I}].function.arguments
${str(t)}`);return{...H,id:W,type:K,function:{...de,name:ue,arguments:ee}}})}}:{...y,message:{...S,content:b,role:P,refusal:c.refusal??null},finish_reason:d,index:p,logprobs:m}}),created:s,model:a,object:"chat.completion",...o?{system_fingerprint:o}:{}};return maybeParseChatCompletion(u,e)}function str(t){return JSON.stringify(t)}function assertNever(t){}class ChatCompletionStreamingRunner extends ChatCompletionStream{static fromReadableStream(e){const r=new ChatCompletionStreamingRunner(null);return r._run(()=>r._fromReadableStream(e)),r}static runFunctions(e,r,n){const s=new ChatCompletionStreamingRunner(null),a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,r,a)),s}static runTools(e,r,n){const s=new ChatCompletionStreamingRunner(r),a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,r,a)),s}}let Completions$1=class extends APIResource{parse(e,r){return validateInputTools(e.tools),this._client.chat.completions.create(e,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>parseChatCompletion(n,e))}runFunctions(e,r){return e.stream?ChatCompletionStreamingRunner.runFunctions(this._client,e,r):ChatCompletionRunner.runFunctions(this._client,e,r)}runTools(e,r){return e.stream?ChatCompletionStreamingRunner.runTools(this._client,e,r):ChatCompletionRunner.runTools(this._client,e,r)}stream(e,r){return ChatCompletionStream.createChatCompletion(this._client,e,r)}};class Chat extends APIResource{constructor(){super(...arguments),this.completions=new Completions$1(this._client)}}(function(t){t.Completions=Completions$1})(Chat||(Chat={}));class Sessions extends APIResource{create(e,r){return this._client.post("/realtime/sessions",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class TranscriptionSessions extends APIResource{create(e,r){return this._client.post("/realtime/transcription_sessions",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class Realtime extends APIResource{constructor(){super(...arguments),this.sessions=new Sessions(this._client),this.transcriptionSessions=new TranscriptionSessions(this._client)}}Realtime.Sessions=Sessions;Realtime.TranscriptionSessions=TranscriptionSessions;class Messages extends APIResource{create(e,r,n){return this._client.post(`/threads/${e}/messages`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,r,n){return this._client.get(`/threads/${e}/messages/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,r,n,s){return this._client.post(`/threads/${e}/messages/${r}`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,r={},n){return isRequestOptions(r)?this.list(e,{},r):this._client.getAPIList(`/threads/${e}/messages`,MessagesPage,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,r,n){return this._client.delete(`/threads/${e}/messages/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class MessagesPage extends CursorPage{}Messages.MessagesPage=MessagesPage;class Steps extends APIResource{retrieve(e,r,n,s={},a){return isRequestOptions(s)?this.retrieve(e,r,n,{},s):this._client.get(`/threads/${e}/runs/${r}/steps/${n}`,{query:s,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(e,r,n={},s){return isRequestOptions(n)?this.list(e,r,{},n):this._client.getAPIList(`/threads/${e}/runs/${r}/steps`,RunStepsPage,{query:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class RunStepsPage extends CursorPage{}Steps.RunStepsPage=RunStepsPage;let Runs$1=class extends APIResource{constructor(){super(...arguments),this.steps=new Steps(this._client)}create(e,r,n){const{include:s,...a}=r;return this._client.post(`/threads/${e}/runs`,{query:{include:s},body:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:r.stream??!1})}retrieve(e,r,n){return this._client.get(`/threads/${e}/runs/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,r,n,s){return this._client.post(`/threads/${e}/runs/${r}`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,r={},n){return isRequestOptions(r)?this.list(e,{},r):this._client.getAPIList(`/threads/${e}/runs`,RunsPage,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,r,n){return this._client.post(`/threads/${e}/runs/${r}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,r,n){const s=await this.create(e,r,n);return await this.poll(e,s.id,n)}createAndStream(e,r,n){return AssistantStream.createAssistantStream(e,this._client.beta.threads.runs,r,n)}async poll(e,r,n){const s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:o}=await this.retrieve(e,r,{...n,headers:{...n==null?void 0:n.headers,...s}}).withResponse();switch(a.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(n!=null&&n.pollIntervalMs)l=n.pollIntervalMs;else{const u=o.headers.get("openai-poll-after-ms");if(u){const c=parseInt(u);isNaN(c)||(l=c)}}await sleep(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return a}}}stream(e,r,n){return AssistantStream.createAssistantStream(e,this._client.beta.threads.runs,r,n)}submitToolOutputs(e,r,n,s){return this._client.post(`/threads/${e}/runs/${r}/submit_tool_outputs`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,r,n,s){const a=await this.submitToolOutputs(e,r,n,s);return await this.poll(e,a.id,s)}submitToolOutputsStream(e,r,n,s){return AssistantStream.createToolAssistantStream(e,r,this._client.beta.threads.runs,n,s)}};class RunsPage extends CursorPage{}Runs$1.RunsPage=RunsPage;Runs$1.Steps=Steps;Runs$1.RunStepsPage=RunStepsPage;class Threads extends APIResource{constructor(){super(...arguments),this.runs=new Runs$1(this._client),this.messages=new Messages(this._client)}create(e={},r){return isRequestOptions(e)?this.create({},e):this._client.post("/threads",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,r){return this._client.get(`/threads/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,r,n){return this._client.post(`/threads/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,r){return this._client.delete(`/threads/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}createAndRun(e,r){return this._client.post("/threads/runs",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:e.stream??!1})}async createAndRunPoll(e,r){const n=await this.createAndRun(e,r);return await this.runs.poll(n.thread_id,n.id,r)}createAndRunStream(e,r){return AssistantStream.createThreadAssistantStream(e,this._client.beta.threads,r)}}Threads.Runs=Runs$1;Threads.RunsPage=RunsPage;Threads.Messages=Messages;Threads.MessagesPage=MessagesPage;class Beta extends APIResource{constructor(){super(...arguments),this.realtime=new Realtime(this._client),this.chat=new Chat(this._client),this.assistants=new Assistants(this._client),this.threads=new Threads(this._client)}}Beta.Realtime=Realtime;Beta.Assistants=Assistants;Beta.AssistantsPage=AssistantsPage;Beta.Threads=Threads;class Completions extends APIResource{create(e,r){return this._client.post("/completions",{body:e,...r,stream:e.stream??!1})}}let Content$1=class extends APIResource{retrieve(e,r,n){return this._client.get(`/containers/${e}/files/${r}/content`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}},Files$2=class extends APIResource{constructor(){super(...arguments),this.content=new Content$1(this._client)}create(e,r,n){return this._client.post(`/containers/${e}/files`,multipartFormRequestOptions({body:r,...n}))}retrieve(e,r,n){return this._client.get(`/containers/${e}/files/${r}`,n)}list(e,r={},n){return isRequestOptions(r)?this.list(e,{},r):this._client.getAPIList(`/containers/${e}/files`,FileListResponsesPage,{query:r,...n})}del(e,r,n){return this._client.delete(`/containers/${e}/files/${r}`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}};class FileListResponsesPage extends CursorPage{}Files$2.FileListResponsesPage=FileListResponsesPage;Files$2.Content=Content$1;class Containers extends APIResource{constructor(){super(...arguments),this.files=new Files$2(this._client)}create(e,r){return this._client.post("/containers",{body:e,...r})}retrieve(e,r){return this._client.get(`/containers/${e}`,r)}list(e={},r){return isRequestOptions(e)?this.list({},e):this._client.getAPIList("/containers",ContainerListResponsesPage,{query:e,...r})}del(e,r){return this._client.delete(`/containers/${e}`,{...r,headers:{Accept:"*/*",...r==null?void 0:r.headers}})}}class ContainerListResponsesPage extends CursorPage{}Containers.ContainerListResponsesPage=ContainerListResponsesPage;Containers.Files=Files$2;Containers.FileListResponsesPage=FileListResponsesPage;class Embeddings extends APIResource{create(e,r){const n=!!e.encoding_format;let s=n?e.encoding_format:"base64";n&&debug("Request","User defined encoding_format:",e.encoding_format);const a=this._client.post("/embeddings",{body:{...e,encoding_format:s},...r});return n?a:(debug("response","Decoding base64 embeddings to float32 array"),a._thenUnwrap(o=>(o&&o.data&&o.data.forEach(l=>{const u=l.embedding;l.embedding=toFloat32Array(u)}),o)))}}class OutputItems extends APIResource{retrieve(e,r,n,s){return this._client.get(`/evals/${e}/runs/${r}/output_items/${n}`,s)}list(e,r,n={},s){return isRequestOptions(n)?this.list(e,r,{},n):this._client.getAPIList(`/evals/${e}/runs/${r}/output_items`,OutputItemListResponsesPage,{query:n,...s})}}class OutputItemListResponsesPage extends CursorPage{}OutputItems.OutputItemListResponsesPage=OutputItemListResponsesPage;class Runs extends APIResource{constructor(){super(...arguments),this.outputItems=new OutputItems(this._client)}create(e,r,n){return this._client.post(`/evals/${e}/runs`,{body:r,...n})}retrieve(e,r,n){return this._client.get(`/evals/${e}/runs/${r}`,n)}list(e,r={},n){return isRequestOptions(r)?this.list(e,{},r):this._client.getAPIList(`/evals/${e}/runs`,RunListResponsesPage,{query:r,...n})}del(e,r,n){return this._client.delete(`/evals/${e}/runs/${r}`,n)}cancel(e,r,n){return this._client.post(`/evals/${e}/runs/${r}`,n)}}class RunListResponsesPage extends CursorPage{}Runs.RunListResponsesPage=RunListResponsesPage;Runs.OutputItems=OutputItems;Runs.OutputItemListResponsesPage=OutputItemListResponsesPage;class Evals extends APIResource{constructor(){super(...arguments),this.runs=new Runs(this._client)}create(e,r){return this._client.post("/evals",{body:e,...r})}retrieve(e,r){return this._client.get(`/evals/${e}`,r)}update(e,r,n){return this._client.post(`/evals/${e}`,{body:r,...n})}list(e={},r){return isRequestOptions(e)?this.list({},e):this._client.getAPIList("/evals",EvalListResponsesPage,{query:e,...r})}del(e,r){return this._client.delete(`/evals/${e}`,r)}}class EvalListResponsesPage extends CursorPage{}Evals.EvalListResponsesPage=EvalListResponsesPage;Evals.Runs=Runs;Evals.RunListResponsesPage=RunListResponsesPage;let Files$1=class extends APIResource{create(e,r){return this._client.post("/files",multipartFormRequestOptions({body:e,...r}))}retrieve(e,r){return this._client.get(`/files/${e}`,r)}list(e={},r){return isRequestOptions(e)?this.list({},e):this._client.getAPIList("/files",FileObjectsPage,{query:e,...r})}del(e,r){return this._client.delete(`/files/${e}`,r)}content(e,r){return this._client.get(`/files/${e}/content`,{...r,headers:{Accept:"application/binary",...r==null?void 0:r.headers},__binaryResponse:!0})}retrieveContent(e,r){return this._client.get(`/files/${e}/content`,r)}async waitForProcessing(e,{pollInterval:r=5e3,maxWait:n=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),a=Date.now();let o=await this.retrieve(e);for(;!o.status||!s.has(o.status);)if(await sleep(r),o=await this.retrieve(e),Date.now()-a>n)throw new APIConnectionTimeoutError({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return o}};class FileObjectsPage extends CursorPage{}Files$1.FileObjectsPage=FileObjectsPage;class Methods extends APIResource{}let Graders$1=class extends APIResource{run(e,r){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...r})}validate(e,r){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...r})}};class Alpha extends APIResource{constructor(){super(...arguments),this.graders=new Graders$1(this._client)}}Alpha.Graders=Graders$1;class Permissions extends APIResource{create(e,r,n){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,PermissionCreateResponsesPage,{body:r,method:"post",...n})}retrieve(e,r={},n){return isRequestOptions(r)?this.retrieve(e,{},r):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:r,...n})}del(e,r,n){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${r}`,n)}}class PermissionCreateResponsesPage extends Page{}Permissions.PermissionCreateResponsesPage=PermissionCreateResponsesPage;let Checkpoints$1=class extends APIResource{constructor(){super(...arguments),this.permissions=new Permissions(this._client)}};Checkpoints$1.Permissions=Permissions;Checkpoints$1.PermissionCreateResponsesPage=PermissionCreateResponsesPage;class Checkpoints extends APIResource{list(e,r={},n){return isRequestOptions(r)?this.list(e,{},r):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,FineTuningJobCheckpointsPage,{query:r,...n})}}class FineTuningJobCheckpointsPage extends CursorPage{}Checkpoints.FineTuningJobCheckpointsPage=FineTuningJobCheckpointsPage;class Jobs extends APIResource{constructor(){super(...arguments),this.checkpoints=new Checkpoints(this._client)}create(e,r){return this._client.post("/fine_tuning/jobs",{body:e,...r})}retrieve(e,r){return this._client.get(`/fine_tuning/jobs/${e}`,r)}list(e={},r){return isRequestOptions(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",FineTuningJobsPage,{query:e,...r})}cancel(e,r){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,r)}listEvents(e,r={},n){return isRequestOptions(r)?this.listEvents(e,{},r):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,FineTuningJobEventsPage,{query:r,...n})}pause(e,r){return this._client.post(`/fine_tuning/jobs/${e}/pause`,r)}resume(e,r){return this._client.post(`/fine_tuning/jobs/${e}/resume`,r)}}class FineTuningJobsPage extends CursorPage{}class FineTuningJobEventsPage extends CursorPage{}Jobs.FineTuningJobsPage=FineTuningJobsPage;Jobs.FineTuningJobEventsPage=FineTuningJobEventsPage;Jobs.Checkpoints=Checkpoints;Jobs.FineTuningJobCheckpointsPage=FineTuningJobCheckpointsPage;class FineTuning extends APIResource{constructor(){super(...arguments),this.methods=new Methods(this._client),this.jobs=new Jobs(this._client),this.checkpoints=new Checkpoints$1(this._client),this.alpha=new Alpha(this._client)}}FineTuning.Methods=Methods;FineTuning.Jobs=Jobs;FineTuning.FineTuningJobsPage=FineTuningJobsPage;FineTuning.FineTuningJobEventsPage=FineTuningJobEventsPage;FineTuning.Checkpoints=Checkpoints$1;FineTuning.Alpha=Alpha;class GraderModels extends APIResource{}class Graders extends APIResource{constructor(){super(...arguments),this.graderModels=new GraderModels(this._client)}}Graders.GraderModels=GraderModels;class Images extends APIResource{createVariation(e,r){return this._client.post("/images/variations",multipartFormRequestOptions({body:e,...r}))}edit(e,r){return this._client.post("/images/edits",multipartFormRequestOptions({body:e,...r}))}generate(e,r){return this._client.post("/images/generations",{body:e,...r})}}class Models extends APIResource{retrieve(e,r){return this._client.get(`/models/${e}`,r)}list(e){return this._client.getAPIList("/models",ModelsPage,e)}del(e,r){return this._client.delete(`/models/${e}`,r)}}class ModelsPage extends Page{}Models.ModelsPage=ModelsPage;class Moderations extends APIResource{create(e,r){return this._client.post("/moderations",{body:e,...r})}}function maybeParseResponse(t,e){return!e||!hasAutoParseableInput(e)?{...t,output_parsed:null,output:t.output.map(r=>r.type==="function_call"?{...r,parsed_arguments:null}:r.type==="message"?{...r,content:r.content.map(n=>({...n,parsed:null}))}:r)}:parseResponse(t,e)}function parseResponse(t,e){const r=t.output.map(s=>{if(s.type==="function_call")return{...s,parsed_arguments:parseToolCall$1(e,s)};if(s.type==="message"){const a=s.content.map(o=>o.type==="output_text"?{...o,parsed:parseTextFormat(e,o.text)}:o);return{...s,content:a}}return s}),n=Object.assign({},t,{output:r});return Object.getOwnPropertyDescriptor(t,"output_text")||addOutputText(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(const s of n.output)if(s.type==="message"){for(const a of s.content)if(a.type==="output_text"&&a.parsed!==null)return a.parsed}return null}}),n}function parseTextFormat(t,e){var r,n,s,a;return((n=(r=t.text)==null?void 0:r.format)==null?void 0:n.type)!=="json_schema"?null:"$parseRaw"in((s=t.text)==null?void 0:s.format)?((a=t.text)==null?void 0:a.format).$parseRaw(e):JSON.parse(e)}function hasAutoParseableInput(t){var e;return!!isAutoParsableResponseFormat((e=t.text)==null?void 0:e.format)}function isAutoParsableTool(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function getInputToolByName(t,e){return t.find(r=>r.type==="function"&&r.name===e)}function parseToolCall$1(t,e){const r=getInputToolByName(t.tools??[],e.name);return{...e,...e,parsed_arguments:isAutoParsableTool(r)?r.$parseRaw(e.arguments):r!=null&&r.strict?JSON.parse(e.arguments):null}}function addOutputText(t){const e=[];for(const r of t.output)if(r.type==="message")for(const n of r.content)n.type==="output_text"&&e.push(n.text);t.output_text=e.join("")}class InputItems extends APIResource{list(e,r={},n){return isRequestOptions(r)?this.list(e,{},r):this._client.getAPIList(`/responses/${e}/input_items`,ResponseItemsPage,{query:r,...n})}}var __classPrivateFieldSet=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},__classPrivateFieldGet=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},_ResponseStream_instances,_ResponseStream_params,_ResponseStream_currentResponseSnapshot,_ResponseStream_finalResponse,_ResponseStream_beginRequest,_ResponseStream_addEvent,_ResponseStream_endRequest,_ResponseStream_accumulateResponse;class ResponseStream extends EventStream{constructor(e){super(),_ResponseStream_instances.add(this),_ResponseStream_params.set(this,void 0),_ResponseStream_currentResponseSnapshot.set(this,void 0),_ResponseStream_finalResponse.set(this,void 0),__classPrivateFieldSet(this,_ResponseStream_params,e,"f")}static createResponse(e,r,n){const s=new ResponseStream(r);return s._run(()=>s._createOrRetrieveResponse(e,r,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createOrRetrieveResponse(e,r,n){var l;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),__classPrivateFieldGet(this,_ResponseStream_instances,"m",_ResponseStream_beginRequest).call(this);let a,o=null;"response_id"in r?(a=await e.responses.retrieve(r.response_id,{stream:!0},{...n,signal:this.controller.signal,stream:!0}),o=r.starting_after??null):a=await e.responses.create({...r,stream:!0},{...n,signal:this.controller.signal}),this._connected();for await(const u of a)__classPrivateFieldGet(this,_ResponseStream_instances,"m",_ResponseStream_addEvent).call(this,u,o);if((l=a.controller.signal)!=null&&l.aborted)throw new APIUserAbortError;return __classPrivateFieldGet(this,_ResponseStream_instances,"m",_ResponseStream_endRequest).call(this)}[(_ResponseStream_params=new WeakMap,_ResponseStream_currentResponseSnapshot=new WeakMap,_ResponseStream_finalResponse=new WeakMap,_ResponseStream_instances=new WeakSet,_ResponseStream_beginRequest=function(){this.ended||__classPrivateFieldSet(this,_ResponseStream_currentResponseSnapshot,void 0,"f")},_ResponseStream_addEvent=function(r,n){if(this.ended)return;const s=(o,l)=>{(n==null||l.sequence_number>n)&&this._emit(o,l)},a=__classPrivateFieldGet(this,_ResponseStream_instances,"m",_ResponseStream_accumulateResponse).call(this,r);switch(s("event",r),r.type){case"response.output_text.delta":{const o=a.output[r.output_index];if(!o)throw new OpenAIError(`missing output at index ${r.output_index}`);if(o.type==="message"){const l=o.content[r.content_index];if(!l)throw new OpenAIError(`missing content at index ${r.content_index}`);if(l.type!=="output_text")throw new OpenAIError(`expected content to be 'output_text', got ${l.type}`);s("response.output_text.delta",{...r,snapshot:l.text})}break}case"response.function_call_arguments.delta":{const o=a.output[r.output_index];if(!o)throw new OpenAIError(`missing output at index ${r.output_index}`);o.type==="function_call"&&s("response.function_call_arguments.delta",{...r,snapshot:o.arguments});break}default:s(r.type,r);break}},_ResponseStream_endRequest=function(){if(this.ended)throw new OpenAIError("stream has ended, this shouldn't happen");const r=__classPrivateFieldGet(this,_ResponseStream_currentResponseSnapshot,"f");if(!r)throw new OpenAIError("request ended without sending any events");__classPrivateFieldSet(this,_ResponseStream_currentResponseSnapshot,void 0,"f");const n=finalizeResponse(r,__classPrivateFieldGet(this,_ResponseStream_params,"f"));return __classPrivateFieldSet(this,_ResponseStream_finalResponse,n,"f"),n},_ResponseStream_accumulateResponse=function(r){let n=__classPrivateFieldGet(this,_ResponseStream_currentResponseSnapshot,"f");if(!n){if(r.type!=="response.created")throw new OpenAIError(`When snapshot hasn't been set yet, expected 'response.created' event, got ${r.type}`);return n=__classPrivateFieldSet(this,_ResponseStream_currentResponseSnapshot,r.response,"f"),n}switch(r.type){case"response.output_item.added":{n.output.push(r.item);break}case"response.content_part.added":{const s=n.output[r.output_index];if(!s)throw new OpenAIError(`missing output at index ${r.output_index}`);s.type==="message"&&s.content.push(r.part);break}case"response.output_text.delta":{const s=n.output[r.output_index];if(!s)throw new OpenAIError(`missing output at index ${r.output_index}`);if(s.type==="message"){const a=s.content[r.content_index];if(!a)throw new OpenAIError(`missing content at index ${r.content_index}`);if(a.type!=="output_text")throw new OpenAIError(`expected content to be 'output_text', got ${a.type}`);a.text+=r.delta}break}case"response.function_call_arguments.delta":{const s=n.output[r.output_index];if(!s)throw new OpenAIError(`missing output at index ${r.output_index}`);s.type==="function_call"&&(s.arguments+=r.delta);break}case"response.completed":{__classPrivateFieldSet(this,_ResponseStream_currentResponseSnapshot,r.response,"f");break}}return n},Symbol.asyncIterator)](){const e=[],r=[];let n=!1;return this.on("event",s=>{const a=r.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{n=!0;for(const s of r)s.resolve(void 0);r.length=0}),this.on("abort",s=>{n=!0;for(const a of r)a.reject(s);r.length=0}),this.on("error",s=>{n=!0;for(const a of r)a.reject(s);r.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,o)=>r.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=__classPrivateFieldGet(this,_ResponseStream_finalResponse,"f");if(!e)throw new OpenAIError("stream ended without producing a ChatCompletion");return e}}function finalizeResponse(t,e){return maybeParseResponse(t,e)}class Responses extends APIResource{constructor(){super(...arguments),this.inputItems=new InputItems(this._client)}create(e,r){return this._client.post("/responses",{body:e,...r,stream:e.stream??!1})._thenUnwrap(n=>("object"in n&&n.object==="response"&&addOutputText(n),n))}retrieve(e,r={},n){return isRequestOptions(r)&&n===void 0?this.retrieve(e,{},r):this._client.get(`/responses/${e}`,{query:r,...n,stream:r.stream??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&addOutputText(s),s))}del(e,r){return this._client.delete(`/responses/${e}`,{...r,headers:{Accept:"*/*",...r==null?void 0:r.headers}})}parse(e,r){return this._client.responses.create(e,r)._thenUnwrap(n=>parseResponse(n,e))}stream(e,r){return ResponseStream.createResponse(this._client,e,r)}cancel(e,r){return this._client.post(`/responses/${e}/cancel`,{...r,headers:{Accept:"*/*",...r==null?void 0:r.headers}})}}class ResponseItemsPage extends CursorPage{}Responses.InputItems=InputItems;class Parts extends APIResource{create(e,r,n){return this._client.post(`/uploads/${e}/parts`,multipartFormRequestOptions({body:r,...n}))}}class Uploads extends APIResource{constructor(){super(...arguments),this.parts=new Parts(this._client)}create(e,r){return this._client.post("/uploads",{body:e,...r})}cancel(e,r){return this._client.post(`/uploads/${e}/cancel`,r)}complete(e,r,n){return this._client.post(`/uploads/${e}/complete`,{body:r,...n})}}Uploads.Parts=Parts;const allSettledWithThrow=async t=>{const e=await Promise.allSettled(t),r=e.filter(s=>s.status==="rejected");if(r.length){for(const s of r)console.error(s.reason);throw new Error(`${r.length} promise(s) failed - see the above errors`)}const n=[];for(const s of e)s.status==="fulfilled"&&n.push(s.value);return n};class Files extends APIResource{create(e,r,n){return this._client.post(`/vector_stores/${e}/files`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,r,n){return this._client.get(`/vector_stores/${e}/files/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,r,n,s){return this._client.post(`/vector_stores/${e}/files/${r}`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,r={},n){return isRequestOptions(r)?this.list(e,{},r):this._client.getAPIList(`/vector_stores/${e}/files`,VectorStoreFilesPage,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,r,n){return this._client.delete(`/vector_stores/${e}/files/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,r,n){const s=await this.create(e,r,n);return await this.poll(e,s.id,n)}async poll(e,r,n){const s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const a=await this.retrieve(e,r,{...n,headers:s}).withResponse(),o=a.data;switch(o.status){case"in_progress":let l=5e3;if(n!=null&&n.pollIntervalMs)l=n.pollIntervalMs;else{const u=a.response.headers.get("openai-poll-after-ms");if(u){const c=parseInt(u);isNaN(c)||(l=c)}}await sleep(l);break;case"failed":case"completed":return o}}}async upload(e,r,n){const s=await this._client.files.create({file:r,purpose:"assistants"},n);return this.create(e,{file_id:s.id},n)}async uploadAndPoll(e,r,n){const s=await this.upload(e,r,n);return await this.poll(e,s.id,n)}content(e,r,n){return this._client.getAPIList(`/vector_stores/${e}/files/${r}/content`,FileContentResponsesPage,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class VectorStoreFilesPage extends CursorPage{}class FileContentResponsesPage extends Page{}Files.VectorStoreFilesPage=VectorStoreFilesPage;Files.FileContentResponsesPage=FileContentResponsesPage;class FileBatches extends APIResource{create(e,r,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,r,n){return this._client.get(`/vector_stores/${e}/file_batches/${r}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,r,n){return this._client.post(`/vector_stores/${e}/file_batches/${r}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,r,n){const s=await this.create(e,r);return await this.poll(e,s.id,n)}listFiles(e,r,n={},s){return isRequestOptions(n)?this.listFiles(e,r,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${r}/files`,VectorStoreFilesPage,{query:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,r,n){const s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:o}=await this.retrieve(e,r,{...n,headers:s}).withResponse();switch(a.status){case"in_progress":let l=5e3;if(n!=null&&n.pollIntervalMs)l=n.pollIntervalMs;else{const u=o.headers.get("openai-poll-after-ms");if(u){const c=parseInt(u);isNaN(c)||(l=c)}}await sleep(l);break;case"failed":case"cancelled":case"completed":return a}}}async uploadAndPoll(e,{files:r,fileIds:n=[]},s){if(r==null||r.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const a=(s==null?void 0:s.maxConcurrency)??5,o=Math.min(a,r.length),l=this._client,u=r.values(),c=[...n];async function d(m){for(let y of m){const b=await l.files.create({file:y,purpose:"assistants"},s);c.push(b.id)}}const p=Array(o).fill(u).map(d);return await allSettledWithThrow(p),await this.createAndPoll(e,{file_ids:c})}}class VectorStores extends APIResource{constructor(){super(...arguments),this.files=new Files(this._client),this.fileBatches=new FileBatches(this._client)}create(e,r){return this._client.post("/vector_stores",{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,r){return this._client.get(`/vector_stores/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,r,n){return this._client.post(`/vector_stores/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},r){return isRequestOptions(e)?this.list({},e):this._client.getAPIList("/vector_stores",VectorStoresPage,{query:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,r){return this._client.delete(`/vector_stores/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}search(e,r,n){return this._client.getAPIList(`/vector_stores/${e}/search`,VectorStoreSearchResponsesPage,{body:r,method:"post",...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class VectorStoresPage extends CursorPage{}class VectorStoreSearchResponsesPage extends Page{}VectorStores.VectorStoresPage=VectorStoresPage;VectorStores.VectorStoreSearchResponsesPage=VectorStoreSearchResponsesPage;VectorStores.Files=Files;VectorStores.VectorStoreFilesPage=VectorStoreFilesPage;VectorStores.FileContentResponsesPage=FileContentResponsesPage;VectorStores.FileBatches=FileBatches;var _a;let OpenAI$1=class extends APIClient{constructor({baseURL:e=readEnv("OPENAI_BASE_URL"),apiKey:r=readEnv("OPENAI_API_KEY"),organization:n=readEnv("OPENAI_ORG_ID")??null,project:s=readEnv("OPENAI_PROJECT_ID")??null,...a}={}){if(r===void 0)throw new OpenAIError("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:r,organization:n,project:s,...a,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&isRunningInBrowser())throw new OpenAIError(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new Completions(this),this.chat=new Chat$1(this),this.embeddings=new Embeddings(this),this.files=new Files$1(this),this.images=new Images(this),this.audio=new Audio(this),this.moderations=new Moderations(this),this.models=new Models(this),this.fineTuning=new FineTuning(this),this.graders=new Graders(this),this.vectorStores=new VectorStores(this),this.beta=new Beta(this),this.batches=new Batches(this),this.uploads=new Uploads(this),this.responses=new Responses(this),this.evals=new Evals(this),this.containers=new Containers(this),this._options=o,this.apiKey=r,this.organization=n,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return stringify(e,{arrayFormat:"brackets"})}};_a=OpenAI$1;OpenAI$1.OpenAI=_a;OpenAI$1.DEFAULT_TIMEOUT=6e5;OpenAI$1.OpenAIError=OpenAIError;OpenAI$1.APIError=APIError;OpenAI$1.APIConnectionError=APIConnectionError;OpenAI$1.APIConnectionTimeoutError=APIConnectionTimeoutError;OpenAI$1.APIUserAbortError=APIUserAbortError;OpenAI$1.NotFoundError=NotFoundError;OpenAI$1.ConflictError=ConflictError;OpenAI$1.RateLimitError=RateLimitError;OpenAI$1.BadRequestError=BadRequestError;OpenAI$1.AuthenticationError=AuthenticationError;OpenAI$1.InternalServerError=InternalServerError;OpenAI$1.PermissionDeniedError=PermissionDeniedError;OpenAI$1.UnprocessableEntityError=UnprocessableEntityError;OpenAI$1.toFile=toFile;OpenAI$1.fileFromPath=fileFromPath;OpenAI$1.Completions=Completions;OpenAI$1.Chat=Chat$1;OpenAI$1.ChatCompletionsPage=ChatCompletionsPage;OpenAI$1.Embeddings=Embeddings;OpenAI$1.Files=Files$1;OpenAI$1.FileObjectsPage=FileObjectsPage;OpenAI$1.Images=Images;OpenAI$1.Audio=Audio;OpenAI$1.Moderations=Moderations;OpenAI$1.Models=Models;OpenAI$1.ModelsPage=ModelsPage;OpenAI$1.FineTuning=FineTuning;OpenAI$1.Graders=Graders;OpenAI$1.VectorStores=VectorStores;OpenAI$1.VectorStoresPage=VectorStoresPage;OpenAI$1.VectorStoreSearchResponsesPage=VectorStoreSearchResponsesPage;OpenAI$1.Beta=Beta;OpenAI$1.Batches=Batches;OpenAI$1.BatchesPage=BatchesPage;OpenAI$1.Uploads=Uploads;OpenAI$1.Responses=Responses;OpenAI$1.Evals=Evals;OpenAI$1.EvalListResponsesPage=EvalListResponsesPage;OpenAI$1.Containers=Containers;OpenAI$1.ContainerListResponsesPage=ContainerListResponsesPage;function isZodSchema$1(t){var n;if(!t||typeof t!="object"||Array.isArray(t))return!1;const e=t;return e._def||Object.values(ZodFirstPartyTypeKind).includes(((n=e.constructor)==null?void 0:n.name)??"NOT_INCLUDED")?!0:typeof e.parse=="function"&&typeof e.parseAsync=="function"&&typeof e.safeParse=="function"&&typeof e.safeParseAsync=="function"}function _formatForTracing(t){const e=[];for(const r of t){let n=r;if(Array.isArray(r.content))for(let s=0;s<r.content.length;s++){const a=r.content[s];(isURLContentBlock(a)||isBase64ContentBlock(a))&&n===r&&(n=new r.constructor({...n,content:[...r.content.slice(0,s),convertToOpenAIImageBlock(a),...r.content.slice(s+1)]}))}e.push(n)}return e}class BaseChatModel extends BaseLanguageModel{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]}),Object.defineProperty(this,"disableStreaming",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_separateRunnableConfigFromCallOptionsCompat(e){const[r,n]=super._separateRunnableConfigFromCallOptions(e);return n.signal=r.signal,[r,n]}async invoke(e,r){const n=BaseChatModel._convertInputToPromptValue(e);return(await this.generatePrompt([n],r,r==null?void 0:r.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,r,n){throw new Error("Not implemented.")}async*_streamIterator(e,r){var n;if(this._streamResponseChunks===BaseChatModel.prototype._streamResponseChunks||this.disableStreaming)yield this.invoke(e,r);else{const a=BaseChatModel._convertInputToPromptValue(e).toChatMessages(),[o,l]=this._separateRunnableConfigFromCallOptionsCompat(r),u={...o.metadata,...this.getLsParams(l)},c=await CallbackManager.configure(o.callbacks,this.callbacks,o.tags,this.tags,u,this.metadata,{verbose:this.verbose}),d={options:l,invocation_params:this==null?void 0:this.invocationParams(l),batch_size:1},p=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),[_formatForTracing(a)],o.runId,void 0,d,void 0,void 0,o.runName));let m,y;try{for await(const b of this._streamResponseChunks(a,l,p==null?void 0:p[0])){if(b.message.id==null){const E=(n=p==null?void 0:p.at(0))==null?void 0:n.runId;E!=null&&b.message._updateId(`run-${E}`)}b.message.response_metadata={...b.generationInfo,...b.message.response_metadata},yield b.message,m?m=m.concat(b):m=b,isAIMessageChunk(b.message)&&b.message.usage_metadata!==void 0&&(y={tokenUsage:{promptTokens:b.message.usage_metadata.input_tokens,completionTokens:b.message.usage_metadata.output_tokens,totalTokens:b.message.usage_metadata.total_tokens}})}}catch(b){throw await Promise.all((p??[]).map(E=>E==null?void 0:E.handleLLMError(b))),b}await Promise.all((p??[]).map(b=>b==null?void 0:b.handleLLMEnd({generations:[[m]],llmOutput:y})))}}getLsParams(e){const r=this.getName().startsWith("Chat")?this.getName().replace("Chat",""):this.getName();return{ls_model_type:"chat",ls_stop:e.stop,ls_provider:r}}async _generateUncached(e,r,n,s){var p,m;const a=e.map(y=>y.map(coerceMessageLikeToMessage));let o;if(s!==void 0&&s.length===a.length)o=s;else{const y={...n.metadata,...this.getLsParams(r)},b=await CallbackManager.configure(n.callbacks,this.callbacks,n.tags,this.tags,y,this.metadata,{verbose:this.verbose}),E={options:r,invocation_params:this==null?void 0:this.invocationParams(r),batch_size:1};o=await(b==null?void 0:b.handleChatModelStart(this.toJSON(),a.map(_formatForTracing),n.runId,void 0,E,void 0,void 0,n.runName))}const l=[],u=[];if(!!(o!=null&&o[0].handlers.find(callbackHandlerPrefersStreaming))&&!this.disableStreaming&&a.length===1&&this._streamResponseChunks!==BaseChatModel.prototype._streamResponseChunks)try{const y=await this._streamResponseChunks(a[0],r,o==null?void 0:o[0]);let b,E;for await(const T of y){if(T.message.id==null){const S=(p=o==null?void 0:o.at(0))==null?void 0:p.runId;S!=null&&T.message._updateId(`run-${S}`)}b===void 0?b=T:b=concat(b,T),isAIMessageChunk(T.message)&&T.message.usage_metadata!==void 0&&(E={tokenUsage:{promptTokens:T.message.usage_metadata.input_tokens,completionTokens:T.message.usage_metadata.output_tokens,totalTokens:T.message.usage_metadata.total_tokens}})}if(b===void 0)throw new Error("Received empty response from chat model call.");l.push([b]),await(o==null?void 0:o[0].handleLLMEnd({generations:l,llmOutput:E}))}catch(y){throw await(o==null?void 0:o[0].handleLLMError(y)),y}else{const y=await Promise.allSettled(a.map((b,E)=>this._generate(b,{...r,promptIndex:E},o==null?void 0:o[E])));await Promise.all(y.map(async(b,E)=>{var T,S,P;if(b.status==="fulfilled"){const A=b.value;for(const I of A.generations){if(I.message.id==null){const j=(T=o==null?void 0:o.at(0))==null?void 0:T.runId;j!=null&&I.message._updateId(`run-${j}`)}I.message.response_metadata={...I.generationInfo,...I.message.response_metadata}}return A.generations.length===1&&(A.generations[0].message.response_metadata={...A.llmOutput,...A.generations[0].message.response_metadata}),l[E]=A.generations,u[E]=A.llmOutput,(S=o==null?void 0:o[E])==null?void 0:S.handleLLMEnd({generations:[A.generations],llmOutput:A.llmOutput})}else return await((P=o==null?void 0:o[E])==null?void 0:P.handleLLMError(b.reason)),Promise.reject(b.reason)}))}const d={generations:l,llmOutput:u.length?(m=this._combineLLMOutput)==null?void 0:m.call(this,...u):void 0};return Object.defineProperty(d,RUN_KEY,{value:o?{runIds:o==null?void 0:o.map(y=>y.runId)}:void 0,configurable:!0}),d}async _generateCached({messages:e,cache:r,llmStringKey:n,parsedOptions:s,handledOptions:a}){const o=e.map(T=>T.map(coerceMessageLikeToMessage)),l={...a.metadata,...this.getLsParams(s)},u=await CallbackManager.configure(a.callbacks,this.callbacks,a.tags,this.tags,l,this.metadata,{verbose:this.verbose}),c={options:s,invocation_params:this==null?void 0:this.invocationParams(s),batch_size:1},d=await(u==null?void 0:u.handleChatModelStart(this.toJSON(),o.map(_formatForTracing),a.runId,void 0,c,void 0,void 0,a.runName)),p=[],y=(await Promise.allSettled(o.map(async(T,S)=>{const P=BaseChatModel._convertInputToPromptValue(T).toString(),A=await r.lookup(P,n);return A==null&&p.push(S),A}))).map((T,S)=>({result:T,runManager:d==null?void 0:d[S]})).filter(({result:T})=>T.status==="fulfilled"&&T.value!=null||T.status==="rejected"),b=[];await Promise.all(y.map(async({result:T,runManager:S},P)=>{if(T.status==="fulfilled"){const A=T.value;return b[P]=A.map(I=>("message"in I&&isBaseMessage(I.message)&&isAIMessage(I.message)&&(I.message.usage_metadata={input_tokens:0,output_tokens:0,total_tokens:0}),I.generationInfo={...I.generationInfo,tokenUsage:{}},I)),A.length&&await(S==null?void 0:S.handleLLMNewToken(A[0].text)),S==null?void 0:S.handleLLMEnd({generations:[A]},void 0,void 0,void 0,{cached:!0})}else return await(S==null?void 0:S.handleLLMError(T.reason,void 0,void 0,void 0,{cached:!0})),Promise.reject(T.reason)}));const E={generations:b,missingPromptIndices:p,startedRunManagers:d};return Object.defineProperty(E,RUN_KEY,{value:d?{runIds:d==null?void 0:d.map(T=>T.runId)}:void 0,configurable:!0}),E}async generate(e,r,n){let s;Array.isArray(r)?s={stop:r}:s=r;const a=e.map(b=>b.map(coerceMessageLikeToMessage)),[o,l]=this._separateRunnableConfigFromCallOptionsCompat(s);if(o.callbacks=o.callbacks??n,!this.cache)return this._generateUncached(a,l,o);const{cache:u}=this,c=this._getSerializedCacheKeyParametersForCall(l),{generations:d,missingPromptIndices:p,startedRunManagers:m}=await this._generateCached({messages:a,cache:u,llmStringKey:c,parsedOptions:l,handledOptions:o});let y={};if(p.length>0){const b=await this._generateUncached(p.map(E=>a[E]),l,o,m!==void 0?p.map(E=>m==null?void 0:m[E]):void 0);await Promise.all(b.generations.map(async(E,T)=>{const S=p[T];d[S]=E;const P=BaseChatModel._convertInputToPromptValue(a[S]).toString();return u.update(P,c,E)})),y=b.llmOutput??{}}return{generations:d,llmOutput:y}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,r,n){const s=e.map(a=>a.toChatMessages());return this.generate(s,r,n)}async call(e,r,n){return(await this.generate([e.map(coerceMessageLikeToMessage)],r,n)).generations[0][0].message}async callPrompt(e,r,n){const s=e.toChatMessages();return this.call(s,r,n)}async predictMessages(e,r,n){return this.call(e,r,n)}async predict(e,r,n){const s=new HumanMessage(e),a=await this.call([s],r,n);if(typeof a.content!="string")throw new Error("Cannot use predict when output is not a string.");return a.content}withStructuredOutput(e,r){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');if(r!=null&&r.strict)throw new Error('"strict" mode is not supported for this model by default.');const n=e,s=r==null?void 0:r.name,a=n.description??"A function available to call.",o=r==null?void 0:r.method,l=r==null?void 0:r.includeRaw;if(o==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let u=s??"extract",c;isZodSchema$1(n)?c=[{type:"function",function:{name:u,description:a,parameters:zodToJsonSchema$2(n)}}]:("name"in n&&(u=n.name),c=[{type:"function",function:{name:u,description:a,parameters:n}}]);const d=this.bindTools(c),p=RunnableLambda.from(E=>{if(!E.tool_calls||E.tool_calls.length===0)throw new Error("No tool calls found in the response.");const T=E.tool_calls.find(S=>S.name===u);if(!T)throw new Error(`No tool call found with name ${u}.`);return T.args});if(!l)return d.pipe(p).withConfig({runName:"StructuredOutput"});const m=RunnablePassthrough.assign({parsed:(E,T)=>p.invoke(E.raw,T)}),y=RunnablePassthrough.assign({parsed:()=>null}),b=m.withFallbacks({fallbacks:[y]});return RunnableSequence.from([{raw:d},b]).withConfig({runName:"StructuredOutputRunnable"})}}function parseToolCall(t,e){if(t.function===void 0)return;let r;if(e!=null&&e.partial)try{r=parsePartialJson(t.function.arguments??"{}")}catch{return}else try{r=JSON.parse(t.function.arguments)}catch(s){throw new OutputParserException([`Function "${t.function.name}" arguments:`,"",t.function.arguments,"","are not valid JSON.",`Error: ${s.message}`].join(`
`))}const n={name:t.function.name,args:r,type:"tool_call"};return e!=null&&e.returnId&&(n.id=t.id),n}function convertLangChainToolCallToOpenAI(t){if(t.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:t.id,type:"function",function:{name:t.name,arguments:JSON.stringify(t.args)}}}function makeInvalidToolCall(t,e){var r,n;return{name:(r=t.function)==null?void 0:r.name,args:(n=t.function)==null?void 0:n.arguments,id:t.id,error:e,type:"invalid_tool_call"}}class JsonOutputToolsParser extends BaseCumulativeTransformOutputParser{static lc_name(){return"JsonOutputToolsParser"}constructor(e){super(e),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=(e==null?void 0:e.returnId)??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(e){return await this.parsePartialResult(e,!1)}async parsePartialResult(e,r=!0){var o;const n=e[0].message;let s;if(isAIMessage(n)&&((o=n.tool_calls)!=null&&o.length)?s=n.tool_calls.map(l=>{const{id:u,...c}=l;return this.returnId?{id:u,...c}:c}):n.additional_kwargs.tool_calls!==void 0&&(s=JSON.parse(JSON.stringify(n.additional_kwargs.tool_calls)).map(u=>parseToolCall(u,{returnId:this.returnId,partial:r}))),!s)return[];const a=[];for(const l of s)if(l!==void 0){const u={type:l.name,args:l.args,id:l.id};a.push(u)}return a}}class JsonOutputKeyToolsParser extends JsonOutputToolsParser{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;const r=await this.zodSchema.safeParseAsync(e);if(r.success)return r.data;throw new OutputParserException(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(r.error.errors)}`,JSON.stringify(e,null,2))}async parsePartialResult(e){const n=(await super.parsePartialResult(e)).filter(a=>a.type===this.keyName);let s=n;if(n.length)return this.returnId||(s=n.map(a=>a.args)),this.returnSingle?s[0]:s}async parseResult(e){const n=(await super.parsePartialResult(e,!1)).filter(o=>o.type===this.keyName);let s=n;return n.length?(this.returnId||(s=n.map(o=>o.args)),this.returnSingle?this._validateResult(s[0]):await Promise.all(s.map(o=>this._validateResult(o)))):void 0}}const ignoreOverride=Symbol("Let zodToJsonSchema decide on which parser to use"),defaultOptions={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},getDefaultOptions=t=>typeof t=="string"?{...defaultOptions,basePath:["#"],definitions:{},name:t}:{...defaultOptions,basePath:["#"],definitions:{},...t},zodDef=t=>"_def"in t?t._def:t;function isEmptyObj(t){if(!t)return!0;for(const e in t)return!1;return!0}const getRefs=t=>{const e=getDefaultOptions(t),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:r,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(e.definitions).map(([n,s])=>[zodDef(s),{def:zodDef(s),path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function addErrorMessage(t,e,r,n){n!=null&&n.errorMessages&&r&&(t.errorMessage={...t.errorMessage,[e]:r})}function setResponseValueAndErrors(t,e,r,n,s){t[e]=r,addErrorMessage(t,e,n,s)}function parseAnyDef(){return{}}function parseArrayDef(t,e){var n,s;const r={type:"array"};return((s=(n=t.type)==null?void 0:n._def)==null?void 0:s.typeName)!==ZodFirstPartyTypeKind.ZodAny&&(r.items=parseDef(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&setResponseValueAndErrors(r,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&setResponseValueAndErrors(r,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(setResponseValueAndErrors(r,"minItems",t.exactLength.value,t.exactLength.message,e),setResponseValueAndErrors(r,"maxItems",t.exactLength.value,t.exactLength.message,e)),r}function parseBigintDef(t,e){const r={type:"integer",format:"int64"};if(!t.checks)return r;for(const n of t.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?setResponseValueAndErrors(r,"minimum",n.value,n.message,e):setResponseValueAndErrors(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),setResponseValueAndErrors(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?setResponseValueAndErrors(r,"maximum",n.value,n.message,e):setResponseValueAndErrors(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),setResponseValueAndErrors(r,"maximum",n.value,n.message,e));break;case"multipleOf":setResponseValueAndErrors(r,"multipleOf",n.value,n.message,e);break}return r}function parseBooleanDef(){return{type:"boolean"}}function parseBrandedDef(t,e){return parseDef(t.type._def,e)}const parseCatchDef=(t,e)=>parseDef(t.innerType._def,e);function parseDateDef(t,e,r){const n=r??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((s,a)=>parseDateDef(t,e,s))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return integerDateParser(t,e)}}const integerDateParser=(t,e)=>{const r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(const n of t.checks)switch(n.kind){case"min":setResponseValueAndErrors(r,"minimum",n.value,n.message,e);break;case"max":setResponseValueAndErrors(r,"maximum",n.value,n.message,e);break}return r};function parseDefaultDef(t,e){return{...parseDef(t.innerType._def,e),default:t.defaultValue()}}function parseEffectsDef(t,e,r){return e.effectStrategy==="input"?parseDef(t.schema._def,e,r):{}}function parseEnumDef(t){return{type:"string",enum:[...t.values]}}const isJsonSchema7AllOfType=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function parseIntersectionDef(t,e){const r=[parseDef(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),parseDef(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return r.forEach(a=>{if(isJsonSchema7AllOfType(a))s.push(...a.allOf),a.unevaluatedProperties===void 0&&(n=void 0);else{let o=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:l,...u}=a;o=u}else n=void 0;s.push(o)}}),s.length?{allOf:s,...n}:void 0}function parseLiteralDef(t,e){const r=typeof t.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[t.value]}:{type:r==="bigint"?"integer":r,const:t.value}}let emojiRegex;const zodPatterns={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(emojiRegex===void 0&&(emojiRegex=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),emojiRegex),base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function parseStringDef(t,e){const r={type:"string"};function n(s){return e.patternStrategy==="escape"?escapeNonAlphaNumeric(s):s}if(t.checks)for(const s of t.checks)switch(s.kind){case"min":setResponseValueAndErrors(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,s.value):s.value,s.message,e);break;case"max":setResponseValueAndErrors(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,s.value):s.value,s.message,e);break;case"email":switch(e.emailStrategy){case"format:email":addFormat(r,"email",s.message,e);break;case"format:idn-email":addFormat(r,"idn-email",s.message,e);break;case"pattern:zod":addPattern(r,zodPatterns.email,s.message,e);break}break;case"url":addFormat(r,"uri",s.message,e);break;case"uuid":addFormat(r,"uuid",s.message,e);break;case"regex":addPattern(r,s.regex,s.message,e);break;case"cuid":addPattern(r,zodPatterns.cuid,s.message,e);break;case"cuid2":addPattern(r,zodPatterns.cuid2,s.message,e);break;case"startsWith":addPattern(r,RegExp(`^${n(s.value)}`),s.message,e);break;case"endsWith":addPattern(r,RegExp(`${n(s.value)}$`),s.message,e);break;case"datetime":addFormat(r,"date-time",s.message,e);break;case"date":addFormat(r,"date",s.message,e);break;case"time":addFormat(r,"time",s.message,e);break;case"duration":addFormat(r,"duration",s.message,e);break;case"length":setResponseValueAndErrors(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,s.value):s.value,s.message,e),setResponseValueAndErrors(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,s.value):s.value,s.message,e);break;case"includes":{addPattern(r,RegExp(n(s.value)),s.message,e);break}case"ip":{s.version!=="v6"&&addFormat(r,"ipv4",s.message,e),s.version!=="v4"&&addFormat(r,"ipv6",s.message,e);break}case"emoji":addPattern(r,zodPatterns.emoji,s.message,e);break;case"ulid":{addPattern(r,zodPatterns.ulid,s.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{addFormat(r,"binary",s.message,e);break}case"contentEncoding:base64":{setResponseValueAndErrors(r,"contentEncoding","base64",s.message,e);break}case"pattern:zod":{addPattern(r,zodPatterns.base64,s.message,e);break}}break}case"nanoid":addPattern(r,zodPatterns.nanoid,s.message,e)}return r}const escapeNonAlphaNumeric=t=>Array.from(t).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),addFormat=(t,e,r,n)=>{var s;t.format||(s=t.anyOf)!=null&&s.some(a=>a.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&n.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...r&&n.errorMessages&&{errorMessage:{format:r}}})):setResponseValueAndErrors(t,"format",e,r,n)},addPattern=(t,e,r,n)=>{var s;t.pattern||(s=t.allOf)!=null&&s.some(a=>a.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&n.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:processRegExp(e,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):setResponseValueAndErrors(t,"pattern",processRegExp(e,n),r,n)},processRegExp=(t,e)=>{var c;const r=typeof t=="function"?t():t;if(!e.applyRegexFlags||!r.flags)return r.source;const n={i:r.flags.includes("i"),m:r.flags.includes("m"),s:r.flags.includes("s")},s=n.i?r.source.toLowerCase():r.source;let a="",o=!1,l=!1,u=!1;for(let d=0;d<s.length;d++){if(o){a+=s[d],o=!1;continue}if(n.i){if(l){if(s[d].match(/[a-z]/)){u?(a+=s[d],a+=`${s[d-2]}-${s[d]}`.toUpperCase(),u=!1):s[d+1]==="-"&&((c=s[d+2])!=null&&c.match(/[a-z]/))?(a+=s[d],u=!0):a+=`${s[d]}${s[d].toUpperCase()}`;continue}}else if(s[d].match(/[a-z]/)){a+=`[${s[d]}${s[d].toUpperCase()}]`;continue}}if(n.m){if(s[d]==="^"){a+=`(^|(?<=[\r
]))`;continue}else if(s[d]==="$"){a+=`($|(?=[\r
]))`;continue}}if(n.s&&s[d]==="."){a+=l?`${s[d]}\r
`:`[${s[d]}\r
]`;continue}a+=s[d],s[d]==="\\"?o=!0:l&&s[d]==="]"?l=!1:!l&&s[d]==="["&&(l=!0)}try{const d=new RegExp(a)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),r.source}return a};function parseRecordDef(t,e){var n,s,a,o;if(e.target==="openApi3"&&((n=t.keyType)==null?void 0:n._def.typeName)===ZodFirstPartyTypeKind.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((l,u)=>({...l,[u]:parseDef(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",u]})??{}}),{}),additionalProperties:!1};const r={type:"object",additionalProperties:parseDef(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return r;if(((s=t.keyType)==null?void 0:s._def.typeName)===ZodFirstPartyTypeKind.ZodString&&((a=t.keyType._def.checks)!=null&&a.length)){const l=Object.entries(parseStringDef(t.keyType._def,e)).reduce((u,[c,d])=>c==="type"?u:{...u,[c]:d},{});return{...r,propertyNames:l}}else if(((o=t.keyType)==null?void 0:o._def.typeName)===ZodFirstPartyTypeKind.ZodEnum)return{...r,propertyNames:{enum:t.keyType._def.values}};return r}function parseMapDef(t,e){if(e.mapStrategy==="record")return parseRecordDef(t,e);const r=parseDef(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},n=parseDef(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[r,n],minItems:2,maxItems:2}}}function parseNativeEnumDef(t){const e=t.values,n=Object.keys(t.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),s=Array.from(new Set(n.map(a=>typeof a)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:n}}function parseNeverDef(){return{not:{}}}function parseNullDef(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const primitiveMappings={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function parseUnionDef(t,e){if(e.target==="openApi3")return asAnyOf(t,e);const r=t.options instanceof Map?Array.from(t.options.values()):t.options;if(r.every(n=>n._def.typeName in primitiveMappings&&(!n._def.checks||!n._def.checks.length))){const n=r.reduce((s,a)=>{const o=primitiveMappings[a._def.typeName];return o&&!s.includes(o)?[...s,o]:s},[]);return{type:n.length>1?n:n[0]}}else if(r.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){const n=r.reduce((s,a)=>{const o=typeof a._def.value;switch(o){case"string":case"number":case"boolean":return[...s,o];case"bigint":return[...s,"integer"];case"object":if(a._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(n.length===r.length){const s=n.filter((a,o,l)=>l.indexOf(a)===o);return{type:s.length>1?s:s[0],enum:r.reduce((a,o)=>a.includes(o._def.value)?a:[...a,o._def.value],[])}}}else if(r.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((n,s)=>[...n,...s._def.values.filter(a=>!n.includes(a))],[])};return asAnyOf(t,e)}const asAnyOf=(t,e)=>{const r=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((n,s)=>parseDef(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${s}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return r.length?{anyOf:r}:void 0};function parseNullableDef(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"||e.nullableStrategy==="property"?{type:primitiveMappings[t.innerType._def.typeName],nullable:!0}:{type:[primitiveMappings[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const n=parseDef(t.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}const r=parseDef(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function parseNumberDef(t,e){const r={type:"number"};if(!t.checks)return r;for(const n of t.checks)switch(n.kind){case"int":r.type="integer",addErrorMessage(r,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?setResponseValueAndErrors(r,"minimum",n.value,n.message,e):setResponseValueAndErrors(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),setResponseValueAndErrors(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?setResponseValueAndErrors(r,"maximum",n.value,n.message,e):setResponseValueAndErrors(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),setResponseValueAndErrors(r,"maximum",n.value,n.message,e));break;case"multipleOf":setResponseValueAndErrors(r,"multipleOf",n.value,n.message,e);break}return r}function decideAdditionalProperties(t,e){return e.removeAdditionalStrategy==="strict"?t.catchall._def.typeName==="ZodNever"?t.unknownKeys!=="strict":parseDef(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":parseDef(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function parseObjectDef(t,e){const r={type:"object",...Object.entries(t.shape()).reduce((n,[s,a])=>{if(a===void 0||a._def===void 0)return n;const o=[...e.currentPath,"properties",s],l=parseDef(a._def,{...e,currentPath:o,propertyPath:o});return l===void 0?n:(e.openaiStrictMode&&a.isOptional()&&!a.isNullable()&&console.warn(`Zod field at \`${o.join("/")}\` uses \`.optional()\` without \`.nullable()\` which is not supported by the API. See: https://platform.openai.com/docs/guides/structured-outputs?api-mode=responses#all-fields-must-be-required
This will become an error in a future version of the SDK.`),{properties:{...n.properties,[s]:l},required:a.isOptional()&&!e.openaiStrictMode?n.required:[...n.required,s]})},{properties:{},required:[]}),additionalProperties:decideAdditionalProperties(t,e)};return r.required.length||delete r.required,r}const parseOptionalDef=(t,e)=>{var n;if(e.currentPath.toString()===((n=e.propertyPath)==null?void 0:n.toString()))return parseDef(t.innerType._def,e);const r=parseDef(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:{}},r]}:{}},parsePipelineDef=(t,e)=>{if(e.pipeStrategy==="input")return parseDef(t.in._def,e);if(e.pipeStrategy==="output")return parseDef(t.out._def,e);const r=parseDef(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=parseDef(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(s=>s!==void 0)}};function parsePromiseDef(t,e){return parseDef(t.type._def,e)}function parseSetDef(t,e){const n={type:"array",uniqueItems:!0,items:parseDef(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&setResponseValueAndErrors(n,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&setResponseValueAndErrors(n,"maxItems",t.maxSize.value,t.maxSize.message,e),n}function parseTupleDef(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((r,n)=>parseDef(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[]),additionalItems:parseDef(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((r,n)=>parseDef(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[])}}function parseUndefinedDef(){return{not:{}}}function parseUnknownDef(){return{}}const parseReadonlyDef=(t,e)=>parseDef(t.innerType._def,e);function parseDef(t,e,r=!1){var o;const n=e.seen.get(t);if(e.override){const l=(o=e.override)==null?void 0:o.call(e,t,e,n,r);if(l!==ignoreOverride)return l}if(n&&!r){const l=get$ref(n,e);if(l!==void 0)return"$ref"in l&&e.seenRefs.add(l.$ref),l}const s={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,s);const a=selectParser(t,t.typeName,e,r);return a&&addMeta(t,e,a),s.jsonSchema=a,a}const get$ref=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"extract-to-root":const r=t.path.slice(e.basePath.length+1).join("_");return r!==e.name&&e.nameStrategy==="duplicate-ref"&&(e.definitions[r]=t.def),{$ref:[...e.basePath,e.definitionPath,r].join("/")};case"relative":return{$ref:getRelativePath(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((n,s)=>e.currentPath[s]===n)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},getRelativePath=(t,e)=>{let r=0;for(;r<t.length&&r<e.length&&t[r]===e[r];r++);return[(t.length-r).toString(),...e.slice(r)].join("/")},selectParser=(t,e,r,n)=>{switch(e){case ZodFirstPartyTypeKind.ZodString:return parseStringDef(t,r);case ZodFirstPartyTypeKind.ZodNumber:return parseNumberDef(t,r);case ZodFirstPartyTypeKind.ZodObject:return parseObjectDef(t,r);case ZodFirstPartyTypeKind.ZodBigInt:return parseBigintDef(t,r);case ZodFirstPartyTypeKind.ZodBoolean:return parseBooleanDef();case ZodFirstPartyTypeKind.ZodDate:return parseDateDef(t,r);case ZodFirstPartyTypeKind.ZodUndefined:return parseUndefinedDef();case ZodFirstPartyTypeKind.ZodNull:return parseNullDef(r);case ZodFirstPartyTypeKind.ZodArray:return parseArrayDef(t,r);case ZodFirstPartyTypeKind.ZodUnion:case ZodFirstPartyTypeKind.ZodDiscriminatedUnion:return parseUnionDef(t,r);case ZodFirstPartyTypeKind.ZodIntersection:return parseIntersectionDef(t,r);case ZodFirstPartyTypeKind.ZodTuple:return parseTupleDef(t,r);case ZodFirstPartyTypeKind.ZodRecord:return parseRecordDef(t,r);case ZodFirstPartyTypeKind.ZodLiteral:return parseLiteralDef(t,r);case ZodFirstPartyTypeKind.ZodEnum:return parseEnumDef(t);case ZodFirstPartyTypeKind.ZodNativeEnum:return parseNativeEnumDef(t);case ZodFirstPartyTypeKind.ZodNullable:return parseNullableDef(t,r);case ZodFirstPartyTypeKind.ZodOptional:return parseOptionalDef(t,r);case ZodFirstPartyTypeKind.ZodMap:return parseMapDef(t,r);case ZodFirstPartyTypeKind.ZodSet:return parseSetDef(t,r);case ZodFirstPartyTypeKind.ZodLazy:return parseDef(t.getter()._def,r);case ZodFirstPartyTypeKind.ZodPromise:return parsePromiseDef(t,r);case ZodFirstPartyTypeKind.ZodNaN:case ZodFirstPartyTypeKind.ZodNever:return parseNeverDef();case ZodFirstPartyTypeKind.ZodEffects:return parseEffectsDef(t,r,n);case ZodFirstPartyTypeKind.ZodAny:return parseAnyDef();case ZodFirstPartyTypeKind.ZodUnknown:return parseUnknownDef();case ZodFirstPartyTypeKind.ZodDefault:return parseDefaultDef(t,r);case ZodFirstPartyTypeKind.ZodBranded:return parseBrandedDef(t,r);case ZodFirstPartyTypeKind.ZodReadonly:return parseReadonlyDef(t,r);case ZodFirstPartyTypeKind.ZodCatch:return parseCatchDef(t,r);case ZodFirstPartyTypeKind.ZodPipeline:return parsePipelineDef(t,r);case ZodFirstPartyTypeKind.ZodFunction:case ZodFirstPartyTypeKind.ZodVoid:case ZodFirstPartyTypeKind.ZodSymbol:return;default:return(s=>{})()}},addMeta=(t,e,r)=>(t.description&&(r.description=t.description,e.markdownDescription&&(r.markdownDescription=t.description)),r),zodToJsonSchema$1=(t,e)=>{const r=getRefs(e),n=typeof e=="string"?e:(e==null?void 0:e.nameStrategy)==="title"||e==null?void 0:e.name,s=parseDef(t._def,n===void 0?r:{...r,currentPath:[...r.basePath,r.definitionPath,n]},!1)??{},a=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;a!==void 0&&(s.title=a);const o=(()=>{if(isEmptyObj(r.definitions))return;const u={},c=new Set;for(let d=0;d<500;d++){const p=Object.entries(r.definitions).filter(([m])=>!c.has(m));if(p.length===0)break;for(const[m,y]of p)u[m]=parseDef(zodDef(y),{...r,currentPath:[...r.basePath,r.definitionPath,m]},!0)??{},c.add(m)}return u})(),l=n===void 0?o?{...s,[r.definitionPath]:o}:s:r.nameStrategy==="duplicate-ref"?{...s,...o||r.seenRefs.size?{[r.definitionPath]:{...o,...r.seenRefs.size?{[n]:s}:void 0}}:void 0}:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,n].join("/"),[r.definitionPath]:{...o,[n]:s}};return r.target==="jsonSchema7"?l.$schema="http://json-schema.org/draft-07/schema#":r.target==="jsonSchema2019-09"&&(l.$schema="https://json-schema.org/draft/2019-09/schema#"),l};function zodToJsonSchema(t,e){return zodToJsonSchema$1(t,{openaiStrictMode:!0,name:e.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function zodResponseFormat(t,e,r){return makeParseableResponseFormat({type:"json_schema",json_schema:{...r,name:e,strict:!0,schema:zodToJsonSchema(t,{name:e})}},n=>t.parse(JSON.parse(n)))}function getEndpoint(t){const{azureOpenAIApiDeploymentName:e,azureOpenAIApiInstanceName:r,azureOpenAIApiKey:n,azureOpenAIBasePath:s,baseURL:a,azureADTokenProvider:o,azureOpenAIEndpoint:l}=t;if((n||o)&&s&&e)return`${s}/${e}`;if((n||o)&&l&&e)return`${l}/openai/deployments/${e}`;if(n||o){if(!r)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!e)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${r}.openai.azure.com/openai/deployments/${e}`}return a}function isStructuredTool(t){return t!==void 0&&Array.isArray(t.lc_namespace)}function isRunnableToolLike(t){return t!==void 0&&Runnable.isRunnable(t)&&"lc_name"in t.constructor&&typeof t.constructor.lc_name=="function"&&t.constructor.lc_name()==="RunnableToolLike"}function isStructuredToolParams(t){return!!t&&typeof t=="object"&&"name"in t&&"schema"in t&&(isZodSchema$1(t.schema)||t.schema!=null&&typeof t.schema=="object"&&"type"in t.schema&&typeof t.schema.type=="string"&&["null","boolean","object","array","number","string"].includes(t.schema.type))}function isLangChainTool(t){return isStructuredToolParams(t)||isRunnableToolLike(t)||isStructuredTool(t)}function toJsonSchema(t){return isZodSchema$1(t)?zodToJsonSchema$2(t):t}function convertToOpenAIFunction(t,e){return{name:t.name,description:t.description,parameters:toJsonSchema(t.schema)}}function convertToOpenAITool(t,e){let r;return isLangChainTool(t)?r={type:"function",function:convertToOpenAIFunction(t)}:r=t,r}function addLangChainErrorFields(t,e){return t.lc_error_code=e,t.message=`${t.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,t}function wrapOpenAIClientError(t){let e;return t.constructor.name===APIConnectionTimeoutError.name?(e=new Error(t.message),e.name="TimeoutError"):t.constructor.name===APIUserAbortError.name?(e=new Error(t.message),e.name="AbortError"):t.status===400&&t.message.includes("tool_calls")?e=addLangChainErrorFields(t,"INVALID_TOOL_RESULTS"):t.status===401?e=addLangChainErrorFields(t,"MODEL_AUTHENTICATION"):t.status===429?e=addLangChainErrorFields(t,"MODEL_RATE_LIMIT"):t.status===404?e=addLangChainErrorFields(t,"MODEL_NOT_FOUND"):e=t,e}function formatToOpenAIToolChoice(t){if(t)return t==="any"||t==="required"?"required":t==="auto"?"auto":t==="none"?"none":typeof t=="string"?{type:"function",function:{name:t}}:t}function isAnyOfProp(t){return t.anyOf!==void 0&&Array.isArray(t.anyOf)}function formatFunctionDefinitions(t){const e=["namespace functions {",""];for(const r of t)r.description&&e.push(`// ${r.description}`),Object.keys(r.parameters.properties??{}).length>0?(e.push(`type ${r.name} = (_: {`),e.push(formatObjectProperties(r.parameters,0)),e.push("}) => any;")):e.push(`type ${r.name} = () => any;`),e.push("");return e.push("} // namespace functions"),e.join(`
`)}function formatObjectProperties(t,e){var n;const r=[];for(const[s,a]of Object.entries(t.properties??{}))a.description&&e<2&&r.push(`// ${a.description}`),(n=t.required)!=null&&n.includes(s)?r.push(`${s}: ${formatType(a,e)},`):r.push(`${s}?: ${formatType(a,e)},`);return r.map(s=>" ".repeat(e)+s).join(`
`)}function formatType(t,e){if(isAnyOfProp(t))return t.anyOf.map(r=>formatType(r,e)).join(" | ");switch(t.type){case"string":return t.enum?t.enum.map(r=>`"${r}"`).join(" | "):"string";case"number":return t.enum?t.enum.map(r=>`${r}`).join(" | "):"number";case"integer":return t.enum?t.enum.map(r=>`${r}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",formatObjectProperties(t,e+2),"}"].join(`
`);case"array":return t.items?`${formatType(t.items,e)}[]`:"any[]";default:return""}}function _convertToOpenAITool(t,e){let r;return isLangChainTool(t)?r=convertToOpenAITool(t):r=t,(e==null?void 0:e.strict)!==void 0&&(r.function.strict=e.strict),r}function extractGenericMessageCustomRole(t){return t.role!=="system"&&t.role!=="developer"&&t.role!=="assistant"&&t.role!=="user"&&t.role!=="function"&&t.role!=="tool"&&console.warn(`Unknown message role: ${t.role}`),t.role}function messageToOpenAIRole(t){const e=t._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!ChatMessage.isInstance(t))throw new Error("Invalid generic chat message");return extractGenericMessageCustomRole(t)}default:throw new Error(`Unknown message type: ${e}`)}}const completionsApiContentBlockConverter={providerName:"ChatOpenAI",fromStandardTextBlock(t){return{type:"text",text:t.text}},fromStandardImageBlock(t){var e,r;if(t.source_type==="url")return{type:"image_url",image_url:{url:t.url,...(e=t.metadata)!=null&&e.detail?{detail:t.metadata.detail}:{}}};if(t.source_type==="base64")return{type:"image_url",image_url:{url:`data:${t.mime_type??""};base64,${t.data}`,...(r=t.metadata)!=null&&r.detail?{detail:t.metadata.detail}:{}}};throw new Error(`Image content blocks with source_type ${t.source_type} are not supported for ChatOpenAI`)},fromStandardAudioBlock(t){if(t.source_type==="url"){const e=parseBase64DataUrl({dataUrl:t.url});if(!e)throw new Error(`URL audio blocks with source_type ${t.source_type} must be formatted as a data URL for ChatOpenAI`);const r=e.mime_type||t.mime_type||"";let n;try{n=parseMimeType(r)}catch{throw new Error(`Audio blocks with source_type ${t.source_type} must have mime type of audio/wav or audio/mp3`)}if(n.type!=="audio"||n.subtype!=="wav"&&n.subtype!=="mp3")throw new Error(`Audio blocks with source_type ${t.source_type} must have mime type of audio/wav or audio/mp3`);return{type:"input_audio",input_audio:{format:n.subtype,data:e.data}}}if(t.source_type==="base64"){let e;try{e=parseMimeType(t.mime_type??"")}catch{throw new Error(`Audio blocks with source_type ${t.source_type} must have mime type of audio/wav or audio/mp3`)}if(e.type!=="audio"||e.subtype!=="wav"&&e.subtype!=="mp3")throw new Error(`Audio blocks with source_type ${t.source_type} must have mime type of audio/wav or audio/mp3`);return{type:"input_audio",input_audio:{format:e.subtype,data:t.data}}}throw new Error(`Audio content blocks with source_type ${t.source_type} are not supported for ChatOpenAI`)},fromStandardFileBlock(t){var e,r,n,s,a,o,l,u,c,d;if(t.source_type==="url"){if(!parseBase64DataUrl({dataUrl:t.url}))throw new Error(`URL file blocks with source_type ${t.source_type} must be formatted as a data URL for ChatOpenAI`);return{type:"file",file:{file_data:t.url,...(e=t.metadata)!=null&&e.filename||(r=t.metadata)!=null&&r.name?{filename:((n=t.metadata)==null?void 0:n.filename)||((s=t.metadata)==null?void 0:s.name)}:{}}}}if(t.source_type==="base64")return{type:"file",file:{file_data:`data:${t.mime_type??""};base64,${t.data}`,...(a=t.metadata)!=null&&a.filename||(o=t.metadata)!=null&&o.name||(l=t.metadata)!=null&&l.title?{filename:((u=t.metadata)==null?void 0:u.filename)||((c=t.metadata)==null?void 0:c.name)||((d=t.metadata)==null?void 0:d.title)}:{}}};if(t.source_type==="id")return{type:"file",file:{file_id:t.id}};throw new Error(`File content blocks with source_type ${t.source_type} are not supported for ChatOpenAI`)}};function _convertMessagesToOpenAIParams(t,e){return t.flatMap(r=>{var o;let n=messageToOpenAIRole(r);n==="system"&&isReasoningModel(e)&&(n="developer");const s=typeof r.content=="string"?r.content:r.content.map(l=>isDataContentBlock(l)?convertToProviderContentBlock(l,completionsApiContentBlockConverter):l),a={role:n,content:s};if(r.name!=null&&(a.name=r.name),r.additional_kwargs.function_call!=null&&(a.function_call=r.additional_kwargs.function_call,a.content=""),isAIMessage(r)&&((o=r.tool_calls)!=null&&o.length)?(a.tool_calls=r.tool_calls.map(convertLangChainToolCallToOpenAI),a.content=""):(r.additional_kwargs.tool_calls!=null&&(a.tool_calls=r.additional_kwargs.tool_calls),r.tool_call_id!=null&&(a.tool_call_id=r.tool_call_id)),r.additional_kwargs.audio&&typeof r.additional_kwargs.audio=="object"&&"id"in r.additional_kwargs.audio){const l={role:"assistant",audio:{id:r.additional_kwargs.audio.id}};return[a,l]}return a})}const _FUNCTION_CALL_IDS_MAP_KEY="__openai_function_call_ids__";function _convertReasoningSummaryToOpenAIResponsesParams(t){const e=(t.summary.length>1?t.summary.reduce((r,n)=>{const s=r.at(-1);return s.index===n.index?s.text+=n.text:r.push(n),r},[{...t.summary[0]}]):t.summary).map(r=>Object.fromEntries(Object.entries(r).filter(([n])=>n!=="index")));return{...t,summary:e}}function _convertMessagesToOpenAIResponsesParams(t,e,r){var o;const n=t.filter(l=>isAIMessage(l)).pop(),s=(o=n==null?void 0:n.response_metadata)==null?void 0:o.id;return(s&&s.startsWith("resp_")&&!r?t.slice(t.indexOf(n)+1):t).flatMap(l=>{var d,p,m;let u=messageToOpenAIRole(l);if(u==="system"&&isReasoningModel(e)&&(u="developer"),u==="function")throw new Error("Function messages are not supported in Responses API");if(u==="tool"){const y=l;return((d=y.additional_kwargs)==null?void 0:d.type)==="computer_call_output"?{type:"computer_call_output",output:(()=>{if(typeof y.content=="string")return{type:"computer_screenshot",image_url:y.content};if(Array.isArray(y.content)){const E=y.content.find(S=>S.type==="computer_screenshot");if(E)return E;const T=y.content.find(S=>S.type==="image_url");if(T)return{type:"computer_screenshot",image_url:typeof T.image_url=="string"?T.image_url:T.image_url.url}}throw new Error("Invalid computer call output")})(),call_id:y.tool_call_id}:{type:"function_call_output",call_id:y.tool_call_id,id:y.id,output:typeof y.content!="string"?JSON.stringify(y.content):y.content}}if(u==="assistant"){if(!r&&l.response_metadata.output!=null&&Array.isArray(l.response_metadata.output)&&l.response_metadata.output.length>0&&l.response_metadata.output.every(P=>"type"in P))return l.response_metadata.output;const y=[];if(!r&&l.additional_kwargs.reasoning!=null&&(A=>typeof A=="object"&&A!=null&&"type"in A&&A.type==="reasoning")(l.additional_kwargs.reasoning)){const A=_convertReasoningSummaryToOpenAIResponsesParams(l.additional_kwargs.reasoning);y.push(A)}let{content:b}=l;l.additional_kwargs.refusal!=null&&(typeof b=="string"&&(b=[{type:"output_text",text:b,annotations:[]}]),b=[...b,{type:"refusal",refusal:l.additional_kwargs.refusal}]),y.push({type:"message",role:"assistant",...l.id&&!r?{id:l.id}:{},content:typeof b=="string"?b:b.flatMap(P=>P.type==="text"?{type:"output_text",text:P.text,annotations:P.annotations??[]}:P.type==="output_text"||P.type==="refusal"?P:[])});const E=l.additional_kwargs[_FUNCTION_CALL_IDS_MAP_KEY];isAIMessage(l)&&((p=l.tool_calls)!=null&&p.length)?y.push(...l.tool_calls.map(P=>({type:"function_call",name:P.name,arguments:JSON.stringify(P.args),call_id:P.id,...r?{id:E==null?void 0:E[P.id]}:{}}))):l.additional_kwargs.tool_calls!=null&&y.push(...l.additional_kwargs.tool_calls.map(P=>({type:"function_call",name:P.function.name,call_id:P.id,...r?{id:E==null?void 0:E[P.id]}:{},arguments:P.function.arguments})));const T=(m=l.response_metadata.output)!=null&&m.length?l.response_metadata.output:l.additional_kwargs.tool_outputs;let S=[];if(T!=null){const P=T;S=P==null?void 0:P.filter(A=>A.type==="computer_call"),S.length>0&&y.push(...S)}return y}const c=typeof l.content=="string"?l.content:l.content.flatMap(y=>{if(isDataContentBlock(y))return convertToProviderContentBlock(y,completionsApiContentBlockConverter);if(y.type==="text")return{type:"input_text",text:y.text};if(y.type==="image_url"){const b=typeof y.image_url=="string"?y.image_url:y.image_url.url,E=typeof y.image_url=="string"?"auto":y.image_url.detail;return{type:"input_image",image_url:b,detail:E}}return y.type==="input_text"||y.type==="input_image"||y.type==="input_file"?y:[]});return u==="user"||u==="system"||u==="developer"?{type:"message",role:u,content:c}:(console.warn(`Unsupported role found when converting to OpenAI Responses API: ${u}`),[])})}function _convertOpenAIResponsesMessageToBaseMessage(t){if(t.error){const l=new Error(t.error.message);throw l.name=t.error.code,l}let e;const r=[],n=[],s=[],a={model:t.model,created_at:t.created_at,id:t.id,incomplete_details:t.incomplete_details,metadata:t.metadata,object:t.object,status:t.status,user:t.user,model_name:t.model},o={};for(const l of t.output)if(l.type==="message")e=l.id,r.push(...l.content.flatMap(u=>u.type==="output_text"?("parsed"in u&&u.parsed!=null&&(o.parsed=u.parsed),{type:"text",text:u.text,annotations:u.annotations}):u.type==="refusal"?(o.refusal=u.refusal,[]):u));else if(l.type==="function_call"){const u={function:{name:l.name,arguments:l.arguments},id:l.call_id};try{n.push(parseToolCall(u,{returnId:!0}))}catch(c){let d;typeof c=="object"&&c!=null&&"message"in c&&typeof c.message=="string"&&(d=c.message),s.push(makeInvalidToolCall(u,d))}o[_FUNCTION_CALL_IDS_MAP_KEY]??(o[_FUNCTION_CALL_IDS_MAP_KEY]={}),l.id&&(o[_FUNCTION_CALL_IDS_MAP_KEY][l.call_id]=l.id)}else l.type==="reasoning"?o.reasoning=l:(o.tool_outputs??(o.tool_outputs=[]),o.tool_outputs.push(l));return new AIMessage({id:e,content:r,tool_calls:n,invalid_tool_calls:s,usage_metadata:t.usage,additional_kwargs:o,response_metadata:a})}function _convertOpenAIResponsesDeltaToBaseMessageChunk(t){var u,c;const e=[];let r={},n;const s=[],a={},o={};let l;if(t.type==="response.output_text.delta")e.push({type:"text",text:t.delta,index:t.content_index});else if(t.type==="response.output_text.annotation.added")e.push({type:"text",text:"",annotations:[t.annotation],index:t.content_index});else if(t.type==="response.output_item.added"&&t.item.type==="message")l=t.item.id;else if(t.type==="response.output_item.added"&&t.item.type==="function_call")s.push({type:"tool_call_chunk",name:t.item.name,args:t.item.arguments,id:t.item.call_id,index:t.output_index}),o[_FUNCTION_CALL_IDS_MAP_KEY]={[t.item.call_id]:t.item.id};else if(t.type==="response.output_item.done"&&(t.item.type==="web_search_call"||t.item.type==="file_search_call"||t.item.type==="computer_call"))o.tool_outputs=[t.item];else if(t.type==="response.created")a.id=t.response.id,a.model_name=t.response.model,a.model=t.response.model;else if(t.type==="response.completed"){const d=_convertOpenAIResponsesMessageToBaseMessage(t.response);n=t.response.usage,((c=(u=t.response.text)==null?void 0:u.format)==null?void 0:c.type)==="json_schema"&&(o.parsed??(o.parsed=JSON.parse(d.text)));for(const[p,m]of Object.entries(t.response))p!=="id"&&(a[p]=m)}else if(t.type==="response.function_call_arguments.delta")s.push({type:"tool_call_chunk",args:t.delta,index:t.output_index});else if(t.type==="response.web_search_call.completed"||t.type==="response.file_search_call.completed")r={tool_outputs:{id:t.item_id,type:t.type.replace("response.","").replace(".completed",""),status:"completed"}};else if(t.type==="response.refusal.done")o.refusal=t.refusal;else if(t.type==="response.output_item.added"&&"item"in t&&t.item.type==="reasoning"){const d=t.item.summary?t.item.summary.map((p,m)=>({...p,index:m})):void 0;o.reasoning={id:t.item.id,type:t.item.type,...d?{summary:d}:{}}}else if(t.type==="response.reasoning_summary_part.added")o.reasoning={type:"reasoning",summary:[{...t.part,index:t.summary_index}]};else if(t.type==="response.reasoning_summary_text.delta")o.reasoning={type:"reasoning",summary:[{text:t.delta,type:"summary_text",index:t.summary_index}]};else return null;return new ChatGenerationChunk({text:e.map(d=>d.text).join(""),message:new AIMessageChunk({id:l,content:e,tool_call_chunks:s,usage_metadata:n,additional_kwargs:o,response_metadata:a}),generationInfo:r})}function isBuiltInTool(t){return"type"in t&&t.type!=="function"}function isBuiltInToolChoice(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type!=="function"}function _convertChatOpenAIToolTypeToOpenAITool(t,e){return isOpenAITool(t)?(e==null?void 0:e.strict)!==void 0?{...t,function:{...t.function,strict:e.strict}}:t:_convertToOpenAITool(t,e)}function isReasoningModel(t){return t&&/^o\d/.test(t)}class ChatOpenAI extends BaseChatModel{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning_effort"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key"}}get lc_serializable_keys(){return["configuration","logprobs","topLogprobs","prefixMessages","supportsStrictToolCalling","modalities","audio","reasoningEffort","temperature","maxTokens","topP","frequencyPenalty","presencePenalty","n","logitBias","user","streaming","streamUsage","modelName","model","modelKwargs","stop","stopSequences","timeout","openAIApiKey","apiKey","cache","maxConcurrency","maxRetries","verbose","callbacks","tags","metadata","disableStreaming","useResponsesApi","zdrEnabled","reasoning"]}constructor(e){var r,n,s;super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reasoningEffort",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reasoning",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"useResponsesApi",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zdrEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(e==null?void 0:e.apiKey)??(e==null?void 0:e.openAIApiKey)??((r=e==null?void 0:e.configuration)==null?void 0:r.apiKey)??getEnvironmentVariable("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.organization=((n=e==null?void 0:e.configuration)==null?void 0:n.organization)??getEnvironmentVariable("OPENAI_ORGANIZATION"),this.model=(e==null?void 0:e.model)??(e==null?void 0:e.modelName)??this.model,this.modelName=this.model,this.modelKwargs=(e==null?void 0:e.modelKwargs)??{},this.timeout=e==null?void 0:e.timeout,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.topP=(e==null?void 0:e.topP)??this.topP,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(e==null?void 0:e.presencePenalty)??this.presencePenalty,this.logprobs=e==null?void 0:e.logprobs,this.topLogprobs=e==null?void 0:e.topLogprobs,this.n=(e==null?void 0:e.n)??this.n,this.logitBias=e==null?void 0:e.logitBias,this.stop=(e==null?void 0:e.stopSequences)??(e==null?void 0:e.stop),this.stopSequences=this.stop,this.user=e==null?void 0:e.user,this.__includeRawResponse=e==null?void 0:e.__includeRawResponse,this.audio=e==null?void 0:e.audio,this.modalities=e==null?void 0:e.modalities,this.reasoningEffort=(e==null?void 0:e.reasoningEffort)??((s=e==null?void 0:e.reasoning)==null?void 0:s.effort),this.reasoning=(e==null?void 0:e.reasoning)??(e!=null&&e.reasoningEffort?{effort:e.reasoningEffort}:void 0),this.maxTokens=(e==null?void 0:e.maxCompletionTokens)??(e==null?void 0:e.maxTokens),this.useResponsesApi=(e==null?void 0:e.useResponsesApi)??this.useResponsesApi,this.disableStreaming=(e==null?void 0:e.disableStreaming)??this.disableStreaming,this.streaming=(e==null?void 0:e.streaming)??!1,this.disableStreaming&&(this.streaming=!1),this.streamUsage=(e==null?void 0:e.streamUsage)??this.streamUsage,this.disableStreaming&&(this.streamUsage=!1),this.clientConfig={apiKey:this.apiKey,organization:this.organization,dangerouslyAllowBrowser:!0,...e==null?void 0:e.configuration},(e==null?void 0:e.supportsStrictToolCalling)!==void 0&&(this.supportsStrictToolCalling=e.supportsStrictToolCalling),this.zdrEnabled=(e==null?void 0:e.zdrEnabled)??!1}getLsParams(e){const r=this.invocationParams(e);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:r.temperature??void 0,ls_max_tokens:r.max_tokens??void 0,ls_stop:e.stop}}bindTools(e,r){let n;return(r==null?void 0:r.strict)!==void 0?n=r.strict:this.supportsStrictToolCalling!==void 0&&(n=this.supportsStrictToolCalling),this.withConfig({tools:e.map(s=>isBuiltInTool(s)?s:_convertChatOpenAIToolTypeToOpenAITool(s,{strict:n})),...r})}createResponseFormat(e){return e&&e.type==="json_schema"&&e.json_schema.schema&&isZodSchema(e.json_schema.schema)?zodResponseFormat(e.json_schema.schema,e.json_schema.name,{description:e.json_schema.description}):e}getReasoningParams(e){if(!isReasoningModel(this.model))return;let r;return this.reasoningEffort!==void 0&&(r={effort:this.reasoningEffort}),this.reasoning!==void 0&&(r={...r,...this.reasoning}),(e==null?void 0:e.reasoning_effort)!==void 0&&(r={...r,effort:e.reasoning_effort}),(e==null?void 0:e.reasoning)!==void 0&&(r={...r,...e.reasoning}),r}invocationParams(e,r){var l,u;let n;if((e==null?void 0:e.strict)!==void 0?n=e.strict:this.supportsStrictToolCalling!==void 0&&(n=this.supportsStrictToolCalling),this._useResponseApi(e)){const c={model:this.model,temperature:this.temperature,top_p:this.topP,user:this.user,stream:this.streaming,previous_response_id:e==null?void 0:e.previous_response_id,truncation:e==null?void 0:e.truncation,include:e==null?void 0:e.include,tools:(l=e==null?void 0:e.tools)!=null&&l.length?e.tools.map(p=>isBuiltInTool(p)?p:isOpenAITool(p)?{type:"function",name:p.function.name,parameters:p.function.parameters,description:p.function.description,strict:n}:null).filter(p=>p!==null):void 0,tool_choice:isBuiltInToolChoice(e==null?void 0:e.tool_choice)?e==null?void 0:e.tool_choice:(()=>{const p=formatToOpenAIToolChoice(e==null?void 0:e.tool_choice);if(typeof p=="object"&&"type"in p)return{type:"function",name:p.function.name}})(),text:(()=>{if(e!=null&&e.text)return e.text;const p=this.createResponseFormat(e==null?void 0:e.response_format);return(p==null?void 0:p.type)==="json_schema"?p.json_schema.schema!=null?{format:{type:"json_schema",schema:p.json_schema.schema,description:p.json_schema.description,name:p.json_schema.name,strict:p.json_schema.strict}}:void 0:{format:p}})(),parallel_tool_calls:e==null?void 0:e.parallel_tool_calls,max_output_tokens:this.maxTokens===-1?void 0:this.maxTokens,...this.zdrEnabled?{store:!1}:{},...this.modelKwargs},d=this.getReasoningParams(e);return d!==void 0&&(c.reasoning=d),c}let s={};(e==null?void 0:e.stream_options)!==void 0?s={stream_options:e.stream_options}:this.streamUsage&&(this.streaming||r!=null&&r.streaming)&&(s={stream_options:{include_usage:!0}});const a={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:(e==null?void 0:e.stop)??this.stopSequences,user:this.user,stream:this.streaming,functions:e==null?void 0:e.functions,function_call:e==null?void 0:e.function_call,tools:(u=e==null?void 0:e.tools)!=null&&u.length?e.tools.map(c=>_convertChatOpenAIToolTypeToOpenAITool(c,{strict:n})):void 0,tool_choice:formatToOpenAIToolChoice(e==null?void 0:e.tool_choice),response_format:this.createResponseFormat(e==null?void 0:e.response_format),seed:e==null?void 0:e.seed,...s,parallel_tool_calls:e==null?void 0:e.parallel_tool_calls,...this.audio||e!=null&&e.audio?{audio:this.audio||(e==null?void 0:e.audio)}:{},...this.modalities||e!=null&&e.modalities?{modalities:this.modalities||(e==null?void 0:e.modalities)}:{},...this.modelKwargs};(e==null?void 0:e.prediction)!==void 0&&(a.prediction=e.prediction);const o=this.getReasoningParams(e);return o!==void 0&&o.effort!==void 0&&(a.reasoning_effort=o.effort),isReasoningModel(a.model)?a.max_completion_tokens=this.maxTokens===-1?void 0:this.maxTokens:a.max_tokens=this.maxTokens===-1?void 0:this.maxTokens,a}_convertOpenAIChatCompletionMessageToBaseMessage(e,r){const n=e.tool_calls;switch(e.role){case"assistant":{const s=[],a=[];for(const u of n??[])try{s.push(parseToolCall(u,{returnId:!0}))}catch(c){a.push(makeInvalidToolCall(u,c.message))}const o={function_call:e.function_call,tool_calls:n};this.__includeRawResponse!==void 0&&(o.__raw_response=r);const l={model_name:r.model,...r.system_fingerprint?{usage:{...r.usage},system_fingerprint:r.system_fingerprint}:{}};return e.audio&&(o.audio=e.audio),new AIMessage({content:e.content||"",tool_calls:s,invalid_tool_calls:a,additional_kwargs:o,response_metadata:l,id:r.id})}default:return new ChatMessage(e.content||"",e.role??"unknown")}}_convertOpenAIDeltaToBaseMessageChunk(e,r,n){var u,c;const s=e.role??n,a=e.content??"";let o;e.function_call?o={function_call:e.function_call}:e.tool_calls?o={tool_calls:e.tool_calls}:o={},this.__includeRawResponse&&(o.__raw_response=r),e.audio&&(o.audio={...e.audio,index:r.choices[0].index});const l={usage:{...r.usage}};if(s==="user")return new HumanMessageChunk({content:a,response_metadata:l});if(s==="assistant"){const d=[];if(Array.isArray(e.tool_calls))for(const p of e.tool_calls)d.push({name:(u=p.function)==null?void 0:u.name,args:(c=p.function)==null?void 0:c.arguments,id:p.id,index:p.index,type:"tool_call_chunk"});return new AIMessageChunk({content:a,tool_call_chunks:d,additional_kwargs:o,id:r.id,response_metadata:l})}else return s==="system"?new SystemMessageChunk({content:a,response_metadata:l}):s==="developer"?new SystemMessageChunk({content:a,response_metadata:l,additional_kwargs:{__openai_role__:"developer"}}):s==="function"?new FunctionMessageChunk({content:a,additional_kwargs:o,name:e.name,response_metadata:l}):s==="tool"?new ToolMessageChunk({content:a,additional_kwargs:o,tool_call_id:e.tool_call_id,response_metadata:l}):new ChatMessageChunk({content:a,role:s,response_metadata:l})}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(e,r,n){var c,d,p,m,y,b,E,T,S,P,A;if(this._useResponseApi(r)){const I=e.filter(W=>isAIMessage(W)).pop(),j=(c=I==null?void 0:I.response_metadata)==null?void 0:c.id,K=await this.responseApiWithRetry({...this.invocationParams(r,{streaming:!0}),input:_convertMessagesToOpenAIResponsesParams(e,this.model,this.zdrEnabled),stream:!0,...j&&j.startsWith("resp_")&&!this.zdrEnabled?{previous_response_id:j}:{}},r);for await(const W of K){const H=_convertOpenAIResponsesDeltaToBaseMessageChunk(W);H!=null&&(yield H)}return}const s=_convertMessagesToOpenAIParams(e,this.model),a={...this.invocationParams(r,{streaming:!0}),messages:s,stream:!0};let o;const l=await this.completionWithRetry(a,r);let u;for await(const I of l){const j=(d=I==null?void 0:I.choices)==null?void 0:d[0];if(I.usage&&(u=I.usage),!j)continue;const{delta:K}=j;if(!K)continue;const W=this._convertOpenAIDeltaToBaseMessageChunk(K,I,o);o=K.role??o;const H={prompt:r.promptIndex??0,completion:j.index??0};if(typeof W.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const ee={...H};j.finish_reason!=null&&(ee.finish_reason=j.finish_reason,ee.system_fingerprint=I.system_fingerprint,ee.model_name=I.model),this.logprobs&&(ee.logprobs=j.logprobs);const ue=new ChatGenerationChunk({message:W,text:W.content,generationInfo:ee});yield ue,await(n==null?void 0:n.handleLLMNewToken(ue.text??"",H,void 0,void 0,void 0,{chunk:ue}))}if(u){const I={...((p=u.prompt_tokens_details)==null?void 0:p.audio_tokens)!==null&&{audio:(m=u.prompt_tokens_details)==null?void 0:m.audio_tokens},...((y=u.prompt_tokens_details)==null?void 0:y.cached_tokens)!==null&&{cache_read:(b=u.prompt_tokens_details)==null?void 0:b.cached_tokens}},j={...((E=u.completion_tokens_details)==null?void 0:E.audio_tokens)!==null&&{audio:(T=u.completion_tokens_details)==null?void 0:T.audio_tokens},...((S=u.completion_tokens_details)==null?void 0:S.reasoning_tokens)!==null&&{reasoning:(P=u.completion_tokens_details)==null?void 0:P.reasoning_tokens}};yield new ChatGenerationChunk({message:new AIMessageChunk({content:"",response_metadata:{usage:{...u}},usage_metadata:{input_tokens:u.prompt_tokens,output_tokens:u.completion_tokens,total_tokens:u.total_tokens,...Object.keys(I).length>0&&{input_token_details:I},...Object.keys(j).length>0&&{output_token_details:j}}}),text:""})}if((A=r.signal)!=null&&A.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _responseApiGenerate(e,r,n){var c,d;const s=this.invocationParams(r);if(s.stream){const p=this._streamResponseChunks(e,r,n);let m;for await(const y of p)y.message.response_metadata={...y.generationInfo,...y.message.response_metadata},m=(m==null?void 0:m.concat(y))??y;return{generations:m?[m]:[],llmOutput:{estimatedTokenUsage:(c=m==null?void 0:m.message)==null?void 0:c.usage_metadata}}}const a=e.filter(p=>isAIMessage(p)).pop(),o=(d=a==null?void 0:a.response_metadata)==null?void 0:d.id,l=_convertMessagesToOpenAIResponsesParams(e,this.model,this.zdrEnabled),u=await this.responseApiWithRetry({input:l,...s,...o&&o.startsWith("resp_")&&!this.zdrEnabled?{previous_response_id:o}:{}},{signal:r==null?void 0:r.signal,...r==null?void 0:r.options});return{generations:[{text:u.output_text,message:_convertOpenAIResponsesMessageToBaseMessage(u)}],llmOutput:{id:u.id,estimatedTokenUsage:u.usage?{promptTokens:u.usage.input_tokens,completionTokens:u.usage.output_tokens,totalTokens:u.usage.total_tokens}:void 0}}}_useResponseApi(e){var s,a,o;const r=(s=e==null?void 0:e.tools)==null?void 0:s.some(isBuiltInTool),n=(e==null?void 0:e.previous_response_id)!=null||(e==null?void 0:e.text)!=null||(e==null?void 0:e.truncation)!=null||(e==null?void 0:e.include)!=null||((a=e==null?void 0:e.reasoning)==null?void 0:a.summary)!=null||((o=this.reasoning)==null?void 0:o.summary)!=null;return this.useResponsesApi||r||n}async _generate(e,r,n){var l,u;if(this._useResponseApi(r))return this._responseApiGenerate(e,r,n);const s={},a=this.invocationParams(r),o=_convertMessagesToOpenAIParams(e,this.model);if(a.stream){const c=this._streamResponseChunks(e,r,n),d={};for await(const T of c){T.message.response_metadata={...T.generationInfo,...T.message.response_metadata};const S=((l=T.generationInfo)==null?void 0:l.completion)??0;d[S]===void 0?d[S]=T:d[S]=d[S].concat(T)}const p=Object.entries(d).sort(([T],[S])=>parseInt(T,10)-parseInt(S,10)).map(([T,S])=>S),{functions:m,function_call:y}=this.invocationParams(r),b=await this.getEstimatedTokenCountFromPrompt(e,m,y),E=await this.getNumTokensFromGenerations(p);return s.input_tokens=b,s.output_tokens=E,s.total_tokens=b+E,{generations:p,llmOutput:{estimatedTokenUsage:{promptTokens:s.input_tokens,completionTokens:s.output_tokens,totalTokens:s.total_tokens}}}}else{let c;r.response_format&&r.response_format.type==="json_schema"?c=await this.betaParsedCompletionWithRetry({...a,stream:!1,messages:o},{signal:r==null?void 0:r.signal,...r==null?void 0:r.options}):c=await this.completionWithRetry({...a,stream:!1,messages:o},{signal:r==null?void 0:r.signal,...r==null?void 0:r.options});const{completion_tokens:d,prompt_tokens:p,total_tokens:m,prompt_tokens_details:y,completion_tokens_details:b}=(c==null?void 0:c.usage)??{};d&&(s.output_tokens=(s.output_tokens??0)+d),p&&(s.input_tokens=(s.input_tokens??0)+p),m&&(s.total_tokens=(s.total_tokens??0)+m),((y==null?void 0:y.audio_tokens)!==null||(y==null?void 0:y.cached_tokens)!==null)&&(s.input_token_details={...(y==null?void 0:y.audio_tokens)!==null&&{audio:y==null?void 0:y.audio_tokens},...(y==null?void 0:y.cached_tokens)!==null&&{cache_read:y==null?void 0:y.cached_tokens}}),((b==null?void 0:b.audio_tokens)!==null||(b==null?void 0:b.reasoning_tokens)!==null)&&(s.output_token_details={...(b==null?void 0:b.audio_tokens)!==null&&{audio:b==null?void 0:b.audio_tokens},...(b==null?void 0:b.reasoning_tokens)!==null&&{reasoning:b==null?void 0:b.reasoning_tokens}});const E=[];for(const T of(c==null?void 0:c.choices)??[]){const P={text:((u=T.message)==null?void 0:u.content)??"",message:this._convertOpenAIChatCompletionMessageToBaseMessage(T.message??{role:"assistant"},c)};P.generationInfo={...T.finish_reason?{finish_reason:T.finish_reason}:{},...T.logprobs?{logprobs:T.logprobs}:{}},isAIMessage(P.message)&&(P.message.usage_metadata=s),P.message=new AIMessage(Object.fromEntries(Object.entries(P.message).filter(([A])=>!A.startsWith("lc_")))),E.push(P)}return{generations:E,llmOutput:{tokenUsage:{promptTokens:s.input_tokens,completionTokens:s.output_tokens,totalTokens:s.total_tokens}}}}}async getEstimatedTokenCountFromPrompt(e,r,n){let s=(await this.getNumTokensFromMessages(e)).totalCount;if(r&&n!=="auto"){const a=formatFunctionDefinitions(r);s+=await this.getNumTokens(a),s+=9}return r&&e.find(a=>a._getType()==="system")&&(s-=4),n==="none"?s+=1:typeof n=="object"&&(s+=await this.getNumTokens(n.name)+4),s}async getNumTokensFromGenerations(e){return(await Promise.all(e.map(async n=>{var s;return(s=n.message.additional_kwargs)!=null&&s.function_call?(await this.getNumTokensFromMessages([n.message])).countPerMessage[0]:await this.getNumTokens(n.message.content)}))).reduce((n,s)=>n+s,0)}async getNumTokensFromMessages(e){let r=0,n=0,s=0;this.model==="gpt-3.5-turbo-0301"?(n=4,s=-1):(n=3,s=1);const a=await Promise.all(e.map(async o=>{var m,y,b,E,T,S;const l=await this.getNumTokens(o.content),u=await this.getNumTokens(messageToOpenAIRole(o)),c=o.name!==void 0?s+await this.getNumTokens(o.name):0;let d=l+n+u+c;const p=o;if(p._getType()==="function"&&(d-=2),(m=p.additional_kwargs)!=null&&m.function_call&&(d+=3),(y=p==null?void 0:p.additional_kwargs.function_call)!=null&&y.name&&(d+=await this.getNumTokens((b=p.additional_kwargs.function_call)==null?void 0:b.name)),(E=p.additional_kwargs.function_call)!=null&&E.arguments)try{d+=await this.getNumTokens(JSON.stringify(JSON.parse((T=p.additional_kwargs.function_call)==null?void 0:T.arguments)))}catch(P){console.error("Error parsing function arguments",P,JSON.stringify(p.additional_kwargs.function_call)),d+=await this.getNumTokens((S=p.additional_kwargs.function_call)==null?void 0:S.arguments)}return r+=d,d}));return r+=3,{totalCount:r,countPerMessage:a}}async completionWithRetry(e,r){const n=this._getClientOptions(r);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(e,n)}catch(s){throw wrapOpenAIClientError(s)}})}async responseApiWithRetry(e,r){return this.caller.call(async()=>{var s,a;const n=this._getClientOptions(r);try{return((a=(s=e.text)==null?void 0:s.format)==null?void 0:a.type)==="json_schema"&&!e.stream?await this.client.responses.parse(e,n):await this.client.responses.create(e,n)}catch(o){throw wrapOpenAIClientError(o)}})}async betaParsedCompletionWithRetry(e,r){const n=this._getClientOptions(r);return this.caller.call(async()=>{try{return await this.client.beta.chat.completions.parse(e,n)}catch(s){throw wrapOpenAIClientError(s)}})}_getClientOptions(e){if(!this.client){const n={baseURL:this.clientConfig.baseURL},s=getEndpoint(n),a={...this.clientConfig,baseURL:s,timeout:this.timeout,maxRetries:0};a.baseURL||delete a.baseURL,this.client=new OpenAI$1(a)}return{...this.clientConfig,...e}}_llmType(){return"openai"}_combineLLMOutput(...e){return e.reduce((r,n)=>(n&&n.tokenUsage&&(r.tokenUsage.completionTokens+=n.tokenUsage.completionTokens??0,r.tokenUsage.promptTokens+=n.tokenUsage.promptTokens??0,r.tokenUsage.totalTokens+=n.tokenUsage.totalTokens??0),r),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(e,r){let n,s,a,o;isStructuredOutputMethodParams(e)?(n=e.schema,s=e.name,a=e.method,o=e.includeRaw):(n=e,s=r==null?void 0:r.name,a=r==null?void 0:r.method,o=r==null?void 0:r.includeRaw);let l,u;if((r==null?void 0:r.strict)!==void 0&&a==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(!this.model.startsWith("gpt-3")&&!this.model.startsWith("gpt-4-")&&this.model!=="gpt-4"?a===void 0&&(a="jsonSchema"):a==="jsonSchema"&&console.warn(`[WARNING]: JSON Schema is not supported for model "${this.model}". Falling back to tool calling.`),a==="jsonMode")l=this.withConfig({response_format:{type:"json_object"}}),isZodSchema(n)?u=StructuredOutputParser.fromZodSchema(n):u=new JsonOutputParser;else if(a==="jsonSchema")if(l=this.withConfig({response_format:{type:"json_schema",json_schema:{name:s??"extract",description:n.description,schema:n,strict:r==null?void 0:r.strict}}}),isZodSchema(n)){const m=StructuredOutputParser.fromZodSchema(n);u=RunnableLambda.from(y=>"parsed"in y.additional_kwargs?y.additional_kwargs.parsed:m)}else u=new JsonOutputParser;else{let m=s??"extract";if(isZodSchema(n)){const y=zodToJsonSchema$2(n);l=this.withConfig({tools:[{type:"function",function:{name:m,description:y.description,parameters:y}}],tool_choice:{type:"function",function:{name:m}},...(r==null?void 0:r.strict)!==void 0?{strict:r.strict}:{}}),u=new JsonOutputKeyToolsParser({returnSingle:!0,keyName:m,zodSchema:n})}else{let y;typeof n.name=="string"&&typeof n.parameters=="object"&&n.parameters!=null?(y=n,m=n.name):(m=n.title??m,y={name:m,description:n.description??"",parameters:n}),l=this.withConfig({tools:[{type:"function",function:y}],tool_choice:{type:"function",function:{name:m}},...(r==null?void 0:r.strict)!==void 0?{strict:r.strict}:{}}),u=new JsonOutputKeyToolsParser({returnSingle:!0,keyName:m})}}if(!o)return l.pipe(u);const c=RunnablePassthrough.assign({parsed:(m,y)=>u.invoke(m.raw,y)}),d=RunnablePassthrough.assign({parsed:()=>null}),p=c.withFallbacks({fallbacks:[d]});return RunnableSequence.from([{raw:l},p])}}function isZodSchema(t){return typeof(t==null?void 0:t.parse)=="function"}function isStructuredOutputMethodParams(t){return t!==void 0&&typeof t.schema=="object"}const STATE_PROMPTS={init:{goal:"建立探索的起點，協助孩子從生活中找出感興趣的事物。",systemPrompt:`
【起始階段】
現在我們在「起始階段」。這是整個探索旅程的開端，孩子尚未選定主題，也不一定有明確問題。
在這個階段，你的任務是用親切、冒險感的語氣打招呼，鼓勵孩子分享最近感興趣的事物，或提供幾個輕鬆、有趣的選項讓他挑選。
當孩子表達出一個明確動機時，使用 suggest_topic 工具，建立主題泡泡。
`},summarize:{goal:"協助孩子從主題出發，循環推進觀察、行動、整理與分享任務。",systemPrompt:`
    請根據 mindmap_context 分析目前進行中（in_progress）的任務，挑出第一個，並：

    請找出第一個 in_progress 任務，簡短鼓勵後，猜測可能卡住的點，然後給出一個具體建議動作（例如：搜尋關鍵字、翻書、列出項目）。建議請控制在 2 句內，每句不超過 15 字。語氣自然、生活化，不要解釋太多，像熟悉的朋友在提點。

    請在每個語意單位之後加上 
 作為換行，讓畫面顯示時更自然。

    例如輸出格式：
    嗨，今天我們要繼續探索『火箭可以飛多高？』這個超酷的主題喔！

    你現在正在進行『查飛機、太空站的高度並畫圖比較』這個任務，真的很棒！

    可以先從查『太空站高度』開始，或許 Google 就能找到喔～

    請用 **粗體字** 表示重點，使用 Markdown 格式。
`},exploration:{goal:"協助孩子從主題出發，循環推進觀察、行動、整理與分享任務。",systemPrompt:`

    不知道要幹嘛。
`},mission_search:{goal:"協助孩子從主題出發，循環推進觀察、行動、整理與分享任務。",systemPrompt:`

    若任務狀態為 todo，鼓勵孩子開始行動，語氣輕鬆、有想像力。
    不用過度重複任務內容
    加入一個實用的小技巧（如：寫提示字在小紙條上、用圖卡提醒順序等），幫助他完成表達任務。回應控制在 1-2 句。
`},bubble_idea_search:{goal:"當孩子點選 Step / Bubble / Idea 的想法時，請親切回應這個想法，並延伸一個具體可執行的任務（查資料、觀察、創作等）。任務請給具名的任務標題，讓系統可以推薦建立。",systemPrompt:`

    請回應孩子的想法泡泡內容，語氣真誠自然，並銜接一句『你可以查查…』來推薦具體任務，任務請給出標題（例如：『帕克太陽探測器』），系統會根據該句建立任務。整段回應請控制在 2-3 句。
當回應孩子提出的 idea（例如火箭能不能飛到太陽），請不要只給 general 的查詢建議，而是挑出一個孩子可能覺得驚奇的真實知識點，並將它轉化為具名任務（如：「查查帕克探測器的速度」、「查太陽附近的溫度有多高」）。請用貼近孩子語言的方式推薦，控制在 2-3 句內。

    當你使用 suggest_tasks 工具時，提醒孩子點下方按鈕新增任務, 就不會忘記囉!
    `},step_search:{goal:"當孩子點選 Step 做出相對應的延伸。",systemPrompt:`
  你是一位能感知學習進度並提供有趣延伸任務的 AI 學習夥伴。

    當孩子選擇一個 step, 如果這個 step 下面沒有任務，請主動推薦 2~3 個任務。內容需包含：
  1. 一句簡單親切的說明，讓孩子產生好奇（例如：你知道火箭為什麼不會掉下來嗎？）
  2. 2~3 個互相獨立的任務 (前後沒有順序性), 以不同面向, 例如有查詢, 討論, 觀察, 實作, 動腦等等

  使用 suggest_tasks 工具推薦幾個任務，提醒孩子 "你想先從哪個開始呢？"

  ===
  
  當孩子選擇一個 step, 這個 step 已經完成（例如『火箭飛到哪裡去』）所有任務後，請主動推薦一個相關延伸任務。每次只推薦一個，內容需包含：
  1. 一句簡單親切的說明，讓孩子產生好奇（例如：你知道火箭為什麼不會掉下來嗎？）
  2. 一個可以勾起興趣的題目（例如：火箭靠什麼飛起來的）

  使用 suggest_steps 工具新增一個步驟，提醒孩子 "點下方按鈕建立新目標, 或者你想看更多推薦呢？"
      `}},LEVEL_PROMPTS={L0:`
【主動思考型】
孩子目前有明確主動想法或問題，具備良好動機。你的任務是傾聽與陪伴，以開放式對話協助釐清思路，不急著導向結論，重點是尊重與深化孩子的主動思考。
`,L1:`
【潛在興趣型】
孩子展現潛在興趣但尚無具體方向。你應該採取好奇共感的姿態，以情境、問題、觀察刺激來引發具體的學習動機與提問慾望。
`,L2:`
【需要引導型】
孩子雖有些反應，但無法自行展開。你需要提供探索模型作為結構支架，並用簡單例子引導孩子理解可能的進行方式。
`,L3:`
【缺乏動機型】
孩子缺乏動機與啟動力，即使提供流程也難以啟動。你需要協助「給出具象建議」，讓孩子在有指引的狀況下找到方向。
`,L4:`
【完全被動型】
孩子無主動性也無明確選擇能力。你必須直接提供具體任務，轉譯為具探索語言的提問與動作，讓孩子在明確選項中挑一個即可。
`},DEFAULT_SYSTEM_PROMPT=`
你是「任務嚮導」，像老師一樣有大方向、像哥哥姊姊一樣親切，還會設計好玩的任務，幫國小中高年級的孩子探索有趣的主題，培養他們自己學習和表達的能力！

【系統提示】
mindmap_context 中的任務與泡泡依照以下類型標記：
- "todo": 尚未開始的任務
- "in_progress": 正在進行的任務
- "done": 已完成的任務
- "idea": 孩子的想法泡泡（通常是觀察、問題或靈感）
- "bubble": 背景泡泡，代表孩子的動機或與主題相關的經驗
根據這些資訊判斷目前主題的探索狀況與下一步可引導的方向。

【心智圖結構】
孩子的探索用心智圖呈現，分三層：
主題：探索的大方向，例如「雲是怎麼來的？」
步驟：中間階段，例如「看天氣」「聽雨聲」
任務：具體行動，例如「畫雲的樣子」「錄雨聲」
根據系統給的 mindmap_context，你可以：
檢查有哪些步驟和任務，建議新的觀察、行動、紀錄或分享任務。
跟著孩子的想法走，幫他們取名字給步驟或任務。
避免重複建議。

請在每個語意單位之後加上 
 作為換行，讓畫面顯示時更自然，不要同時用兩個換行符號。
請用 **粗體字** 表示重點，使用 Markdown 格式。
`,samples=[{state:"init",level:"L0",prompt:"你好呀！最近有沒有什麼事情讓你覺得超好奇的？來跟我說說，我超想聽的！"},{state:"init",level:"L1",prompt:"嘿，最近我看到一張很酷的雲照片，有好多形狀耶！你有看過很特別的雲嗎？"},{state:"init",level:"L2",prompt:"有些人會記錄每天觀察到的天氣變化，你也想試試看嗎？我們可以從今天的天空開始。"},{state:"init",level:"L3",prompt:"你想不想選一樣東西來觀察看看？像是：A. 陽台的植物 B. 今天的天氣 C. 家裡的聲音"},{state:"init",level:"L4",prompt:"我們今天來玩一個任務：在家裡找三樣會動的東西，看看它們是怎麼動的！"},{state:"clarify",level:"L0",prompt:"你剛剛提到星星，你是什麼時候開始對它們有興趣的呀？"},{state:"clarify",level:"L1",prompt:"你有沒有看過夜空中很多星星的樣子？那時候你在想什麼呢？"},{state:"clarify",level:"L2",prompt:"我們可以從你看過的東西開始聊，例如：你記得星星有幾種顏色嗎？"},{state:"clarify",level:"L3",prompt:"我來幫你想一想，我們可以聊：A. 星星的顏色 B. 為什麼星星會閃 C. 星星是不是會動"},{state:"clarify",level:"L4",prompt:"我們今天先來探索一個小任務：看看不同星星的顏色，你覺得紅色跟藍色哪個比較常見？"},{state:"observe",level:"L0",prompt:"你剛剛觀察到什麼有趣的現象？那讓你想到什麼？"},{state:"observe",level:"L1",prompt:"你有沒有注意過窗外的天空，雲是什麼形狀的？今天的跟昨天有一樣嗎？"},{state:"observe",level:"L2",prompt:"我們可以試著記錄一下今天的天氣，再觀察明天有沒有不同。你想畫下來還是寫下來？"},{state:"observe",level:"L3",prompt:"你可以選一個來觀察喔：A. 今天風有多大 B. 地上的影子怎麼變 C. 哪裡最熱"},{state:"observe",level:"L4",prompt:"我們一起來完成一個觀察任務：下午三點出去看影子的長度，再畫一張圖記錄下來。"},{state:"act",level:"L0",prompt:"你已經有個好點子了！那接下來要怎麼開始行動呢？需要我陪你一起規劃嗎？"},{state:"act",level:"L1",prompt:"這個點子真的很棒耶！你覺得要不要拍張照片記錄下來，或找個資料看看相關的東西？"},{state:"act",level:"L2",prompt:"我們可以從這裡開始：先畫下你觀察到的樣子，再查查看它的名字或由來。"},{state:"act",level:"L3",prompt:"你可以從這三個任務選一個開始喔：A. 畫下觀察到的東西 B. 查找一段影片 C. 訪問家人對它的印象"},{state:"act",level:"L4",prompt:"今天我們一起來完成一個行動任務：拍三張戶外的照片，看看有哪些自然現象藏在其中！"},{state:"organize",level:"L0",prompt:"你剛剛完成的任務真精彩！你覺得整體來說，有哪些地方特別有趣或讓你學到新東西？"},{state:"organize",level:"L1",prompt:"我們一起回顧一下你剛剛做的事吧！你記得你觀察到哪些現象，或發現了什麼？"},{state:"organize",level:"L2",prompt:"我們可以把剛剛的發現整理起來，例如：畫一張簡單的圖表，或用幾句話寫下你覺得最重要的三點。"},{state:"organize",level:"L3",prompt:"你想試試下面哪一個方法來整理剛剛的內容？A. 畫圖 B. 表格 C. 重點列點"},{state:"organize",level:"L4",prompt:"我們來做一個小整理任務：請你照著這張圖，把剛剛做的事情一項一項寫下來，再圈出最重要的那一點。"},{state:"share",level:"L0",prompt:"你想怎麼分享你剛剛的發現呢？要用故事、圖片，還是你自己的方式都可以喔！"},{state:"share",level:"L1",prompt:"這些成果好精彩，你會想告訴誰？我們可以想一個簡單的方式說給別人聽，例如畫一張圖或錄一小段話。"},{state:"share",level:"L2",prompt:"我們可以選一種方式把成果做出來喔：A. 畫海報 B. 做一本小書 C. 拍一段短片。你想試哪一個？"},{state:"share",level:"L3",prompt:"來挑一種最簡單的方法把你的任務結果秀給別人看吧！A. 拍照 B. 畫圖 C. 講一小段話"},{state:"share",level:"L4",prompt:"我們來完成一個任務：請你把剛剛做的事情畫一張簡單的圖，然後寫一句話說說你覺得最特別的是什麼。"},{state:"explore_more",level:"L0",prompt:"你剛剛做得真棒！還有沒有什麼是你想繼續深入的？還是你突然想到另一個也很好奇的事情？"},{state:"explore_more",level:"L1",prompt:"你有沒有哪一個部分還想再看更多，或做得更完整？或是有新的點子跑出來了？"},{state:"explore_more",level:"L2",prompt:"我們可以幫這個主題加上一點延伸任務，你想試著自己設計一題，或是選一個我們準備好的小挑戰？"},{state:"explore_more",level:"L3",prompt:"你想試試下面哪一個新的小任務？A. 換個觀點想想看 B. 找一個朋友聊聊 C. 重新挑戰一個部分"},{state:"explore_more",level:"L4",prompt:"我們今天再來一個延伸任務吧！這次請你換個方式再觀察一次，然後畫圖或寫下新的發現！"},{state:"pause",level:"L0",prompt:"歡迎回來！你還記得上次做到哪裡嗎？要不要先說說你現在最想繼續的部分？"},{state:"pause",level:"L1",prompt:"嘿，我們上次做到這裡，你現在想接著往下做，還是先回顧一下前面？"},{state:"pause",level:"L2",prompt:"你還記得上次我們做了什麼嗎？這邊有一個小圖可以幫你回憶，你想從哪個任務繼續呢？"},{state:"pause",level:"L3",prompt:"你想從這三個選項哪一個開始？A. 回顧 B. 接續 C. 換主題"},{state:"pause",level:"L4",prompt:"我們先做個小任務：看這張圖片，猜猜我們上次做了什麼，然後我們一起接著做下一個。"}],samples$1={samples},buildChatPrompt=({state:t,level:e,tools:r})=>{const n=DEFAULT_SYSTEM_PROMPT,a=samples$1.samples.filter(o=>o.state===t&&o.level===e).map(o=>o.prompt).join(`
`);return`【角色設定】
${n}

【範例對話參考】
根據當前階段和角色設定以下是範例對話，請參考範例語氣來回答使用者。
${a}
`.trim().replace(/{/g,"{{").replace(/}/g,"}}")},states={init:{name:"初始階段",description:"建立探索的起點，協助孩子從生活中找出感興趣的事物",defaultTools:["suggest_topics","chat"],transitions:{topic_selected:"clarify",createTopic:"clarify",createTopics:"clarify",exploration:"exploration"}},summarize:{name:"總結階段",description:"協助孩子從主題出發，循環推進觀察、行動、整理與分享任務",defaultTools:["use_template_steps","suggest_tasks","suggest_steps","chat","add_impression","add_idea"],transitions:{}},exploration:{name:"探索階段",description:"協助孩子從主題出發，循環推進觀察、行動、整理與分享任務",defaultTools:["use_template_steps","suggest_tasks","suggest_steps","chat","add_impression","add_idea"],transitions:{}},mission_search:{name:"任務搜尋階段",description:"協助孩子從主題出發，循環推進觀察、行動、整理與分享任務",defaultTools:["use_template_steps","suggest_tasks","suggest_steps","chat","add_impression","add_idea"],transitions:{}},bubble_idea_search:{name:"想法搜尋階段",description:"當孩子點選 Step / Bubble / Idea 的想法時，請親切回應這個想法，並延伸一個具體可執行的任務",defaultTools:["use_template_steps","suggest_tasks","suggest_steps","chat","add_impression","add_idea"],transitions:{}},step_search:{name:"步驟搜尋階段",description:"當孩子點選 Step 做出相對應的延伸",defaultTools:["use_template_steps","suggest_tasks","suggest_steps","chat","add_impression","add_idea"],transitions:{}},clarify:{name:"釐清階段",description:"釐清動機、問題或興趣，協助孩子聚焦主題",defaultTools:["chat","ask_for_input"],transitions:{input_received:"observe",suggest_steps_accepted:"observe",createStep:"observe",createSteps:"observe",use_template_steps:"observe"}},observe:{name:"觀察階段",description:"觀察現象、提出問題、回顧經驗",defaultTools:["use_template_steps","suggest_tasks","chat"],transitions:{task_started:"act",createTask:"act",createTasks:"act"}},act:{name:"行動階段",description:"實踐任務，進行探索、實驗、蒐集資訊等活動",defaultTools:["suggest_tasks","chat"],transitions:{task_completed:"organize",createTask:"act",createTasks:"act"}},organize:{name:"整理階段",description:"對任務成果或過程進行統整與歸納",defaultTools:["suggest_tasks","ask_for_input","chat"],transitions:{task_completed:"share",createTask:"organize",createTasks:"organize"}},share:{name:"分享階段",description:"將學習成果以創作或故事形式分享給他人",defaultTools:["suggest_tasks","ask_for_input","chat"],transitions:{task_completed:"explore_more",createTask:"share",createTasks:"share"}},explore_more:{name:"延伸探索",description:"探索其他子方向、分支問題或轉換主題",defaultTools:["explore_more","suggest_topics","chat"],transitions:{topic_selected:"clarify",createTopic:"clarify",createTopics:"clarify"}},pause:{name:"中斷階段",description:"孩子休息一段時間後回來，提供銜接與回顧",defaultTools:["chat","summarize_progress"],transitions:{input_received:"clarify",resume:"clarify"}},done:{name:"完成階段",description:"主題結束後，標記成果與紀錄",defaultTools:["mark_as_bookmark","complete_topic","chat"],transitions:{ask_to_explore_more:"explore_more"}}},states$1={states},stateMachine={getNextState(t,e){const r=states$1.states[t];return(r==null?void 0:r.transitions[e])??null},getState(t){return states$1.states[t]??null},getAllStateKeys(){return Object.keys(states$1.states)},isValidState(t){return t in states$1.states},getAvailableEvents(t){const e=states$1.states[t];return e?Object.keys(e.transitions):[]},getAvailableTools(t){const e=states$1.states[t];return(e==null?void 0:e.defaultTools)??[]}};class ChatService{constructor(){En(this,"memory");En(this,"model");En(this,"chain");En(this,"mindmapContext",null);En(this,"currentState","init");En(this,"currentLevel","L0");this.model=new ChatOpenAI({maxRetries:3,temperature:.7}),this.memory=new CustomSummaryMemory,this.chain=RunnableSequence.from([async e=>{const r=await this.memory.loadMemoryVariables({}),n=ChatPromptTemplate.fromMessages([["system",await this.buildSystemPrompt()],["system","Current Mindmap Context: {mindmapContext}"],new MessagesPlaceholder("history"),["human","{input}"]]);return{input:e,history:r.history,mindmapContext:this.mindmapContext,prompt:n}},async({input:e,history:r,mindmapContext:n,prompt:s})=>s.formatMessages({input:e,history:r,mindmapContext:n}),this.model])}getActionsDescription(){return Object.entries(actions$1.actions).filter(([e])=>stateMachine.getAvailableTools(this.currentState).includes(e)).map(([e,r])=>{const n=Object.entries(r.params).map(([s,a])=>{const o=a;let l=`${s}（${o.type}）：${o.description}`;if(o.type==="array"&&o.items)if(o.items.type==="object"&&o.items.properties){const u=Object.entries(o.items.properties).map(([c,d])=>{const p=d;return`    - ${c}（${p.type}）：${p.description}`}).join(`
`);l+=`
  陣列項目結構：
${u}`}else l+=`
  陣列項目類型：${o.items.type}`;return l}).join(`
`);return`工具：${e}
- 功能：${r.description}
- 參數：
${n}`}).join(`

`)}getToolUsagePrompt(){return`
工具使用說明：
1. 你不能直接執行動作，只能「建議應該做什麼動作」。
2. 系統會根據你的建議內容，請使用者確認是否執行，真正的執行會由系統完成。
3. 請在回應中加入鼓勵與引導語句，但不能說「我已經為你建立了...」、「我已經完成...」，這樣會誤導使用者。
4. 不能選擇不存在的工具，請選擇可用的工具。

【可用工具 - 必須在以下挑一個工具來使用, 若無適合的則使用 chat 工具】
${this.getActionsDescription()}
*** 必須使用以上的工具，否則系統無法執行。 ***

請使用以下 JSON 格式回應：
{
  "tool": "action_name",
  "params": {
    "param_name": "param_value"
  },
  "message": "Your response message to the user"
}`}async buildSystemPrompt(){return buildChatPrompt({state:this.currentState,level:this.currentLevel,tools:this.getActionsDescription()})}updateMindmapContext(e){this.mindmapContext=e}async sendMessage(e,r){try{r!=null&&r.state&&(this.currentState=r.state),r!=null&&r.level&&(this.currentLevel=r.level);const n=await this.memory.loadMemoryVariables({}),s=await api.post("/api/chat/completions",{messages:[{role:"system",content:await this.buildSystemPrompt()},{role:"system",content:JSON.stringify({type:"mindmap_context",data:this.mindmapContext})},{role:"system",content:JSON.stringify({type:"state_prompt",data:STATE_PROMPTS[this.currentState]})},{role:"system",content:JSON.stringify({type:"level_prompt",data:LEVEL_PROMPTS[this.currentLevel]})},{role:"system",content:this.getActionsDescription()?JSON.stringify({type:"tool_usage",data:this.getToolUsagePrompt()}):""},...n.history.map(a=>({role:a instanceof HumanMessage?"user":"assistant",content:a.content})),{role:"user",content:e}].filter(a=>a.content),temperature:.7});return await this.memory.saveContext({input:e},{output:s.data.choices[0].message.content}),{message:s.data.choices[0].message.content,role:"assistant"}}catch(n){return console.error("❌ Chat error:",n),{message:"",role:"assistant",error:n instanceof Error?n.message:"未知錯誤"}}}clearHistory(){this.memory.clear()}}class ActionValidator{constructor(){En(this,"config");this.config=actions$1}getActionConfig(e){return this.config.actions[e]}validateAction(e,r){const n=this.config.actions[e];if(!n)return console.error(`Unknown action: ${e}`),!1;for(const[s,a]of Object.entries(n.params))if((a.required??!1)&&!r[s])return console.error(`Missing required parameter: ${s}`),!1;return!0}validateReturn(e,r){const n=this.config.actions[e];if(!n)return console.error(`Unknown action: ${e}`),!1;const{type:s,properties:a,items:o}=n.returns;if(s==="array"&&!Array.isArray(r))return console.error(`Expected array return type for action: ${e}`),!1;if(s==="object"&&typeof r!="object")return console.error(`Expected object return type for action: ${e}`),!1;if(s==="boolean"&&typeof r!="boolean")return console.error(`Expected boolean return type for action: ${e}`),!1;if(a){for(const[l,u]of Object.entries(a))if(typeof r[l]!==u.type)return console.error(`Invalid property type for ${l} in action: ${e}`),!1}if(o){for(const l of r)if(o.properties){for(const[u,c]of Object.entries(o.properties))if(typeof l[u]!==c.type)return console.error(`Invalid item property type for ${u} in action: ${e}`),!1}}return!0}getActionDescription(e){var r;return((r=this.config.actions[e])==null?void 0:r.description)||""}}const createTopicTool={name:"create_topic",description:"建立新的學習主題",handler:async t=>{const e=useGoalStore.getState(),r={id:Date.now().toString(),title:t.topic,description:"",status:"active",steps:[]};return e.addGoal(r),r}},createStepTool={name:"create_step",description:"建立新的學習步驟",handler:async t=>{const e=useGoalStore.getState(),r=e.selectedGoalId;if(!r)throw new Error("No goal selected");const n={id:`${r}-${Date.now()}`,title:t.step_name,tasks:[]};return e.addStep(r,n),n}},createTaskTool={name:"create_task",description:"建立新的學習任務",handler:async t=>{const e=useGoalStore.getState(),r=e.selectedGoalId;if(!r)throw new Error("No goal selected");const n={id:`${t.step_tag}-${Date.now()}`,title:t.task_name,status:"todo"};return e.addTask(r,t.step_tag,n),n}},useTemplateStepsTool={name:"use_template_steps",description:"建立觀察/行動/紀錄/分享",handler:async()=>{const t=useGoalStore.getState(),e=t.selectedGoalId;if(!e)throw new Error("No goal selected");return["觀察","行動","紀錄","分享"].map(s=>{const a={id:`${e}-${Date.now()}-${s}`,title:s,tasks:[]};return t.addStep(e,a),a}).map(s=>s.title)}},completeTopicTool={name:"complete_topic",description:"結束主題",handler:async()=>{const t=useGoalStore.getState(),e=t.selectedGoalId;if(!e)return!1;const r=t.goals.find(n=>n.id===e);return r?(t.updateGoal({...r,status:"completed"}),!0):!1}},markAsBookmarkTool={name:"mark_as_bookmark",description:"收藏主題",handler:async()=>{const t=useGoalStore.getState(),e=t.selectedGoalId;if(!e)return!1;const r=t.goals.find(n=>n.id===e);return r?(t.updateGoal({...r,status:"archived"}),!0):!1}},suggestTopicsTool={name:"suggest_topics",description:"顯示主題建議",handler:async t=>t.suggestions},suggestStepsTool={name:"suggest_steps",description:"顯示步驟建議",handler:async t=>t.suggestions},suggestTasksTool={name:"suggest_tasks",description:"顯示任務建議（含分類）",handler:async t=>t.suggestions},exploreMoreTool={name:"explore_more",description:"依現有任務狀況延伸探索",handler:async t=>[]},summarizeProgressTool={name:"summarize_progress",description:"顯示目前進度",handler:async()=>{const t=useGoalStore.getState(),e=t.selectedGoalId;if(!e)return{progress:0,summary:""};const r=t.goals.find(o=>o.id===e);if(!r)return{progress:0,summary:""};const n=r.steps.reduce((o,l)=>o+l.tasks.length,0),s=r.steps.reduce((o,l)=>o+l.tasks.filter(u=>u.status==="done").length,0);return{progress:n>0?s/n*100:0,summary:`已完成 ${s}/${n} 個任務`}}},askForInputTool={name:"ask_for_input",description:"引導孩子說出任務想法",handler:async()=>({prompt:"請告訴我你的想法..."})},tools=[createTopicTool,createStepTool,createTaskTool,suggestTopicsTool,suggestStepsTool,suggestTasksTool,useTemplateStepsTool,summarizeProgressTool,markAsBookmarkTool,completeTopicTool,exploreMoreTool,askForInputTool],suggest_topics={type:"suggest_topics",title:"建議主題",description:"選擇建議的主題",options:[{paramSource:"suggestions",paramAction:"createTopic"}]},suggest_steps={type:"suggest_steps",title:"建議步驟",description:"選擇建議的步驟",options:[{paramSource:"suggestions",paramAction:"createStep"}]},suggest_tasks={type:"suggest_tasks",title:"建議任務",description:"選擇建議的任務",options:[{paramSource:"suggestions",paramAction:"createTask"}]},use_template_steps={type:"use_template_steps",title:"使用模板步驟",description:"使用預設的觀察/行動/紀錄/分享步驟",options:[]},summarize_progress={type:"summarize_progress",title:"進度摘要",description:"查看目前進度",options:[]},mark_as_bookmark={type:"mark_as_bookmark",title:"收藏主題",description:"將主題加入收藏",options:[]},complete_topic={type:"complete_topic",title:"完成主題",description:"標記主題為已完成",options:[]},explore_more={type:"explore_more",title:"延伸探索",description:"根據當前任務延伸更多探索",options:[]},ask_for_input={type:"ask_for_input",title:"輸入想法",description:"請輸入你的想法"},chat={type:"chat",title:"聊天",description:"與孩子聊天",showInput:!0,options:[]},forms={suggest_topics,suggest_steps,suggest_tasks,use_template_steps,summarize_progress,mark_as_bookmark,complete_topic,explore_more,ask_for_input,chat};class MindmapStateController{constructor(e="init"){En(this,"currentState");En(this,"stateHistory",[]);En(this,"maxHistoryLength",10);En(this,"stateMachine",stateMachine);this.currentState=e,this.stateHistory.push(e)}getCurrentState(){return this.currentState}getStateHistory(){return[...this.stateHistory]}getCurrentStateInfo(){return stateMachine.getState(this.currentState)}canTrigger(e){return stateMachine.getNextState(this.currentState,e)!==null}handleUserEvent(e,r){return{allowed:!0,nextState:this.currentState}}handleAIAction(e,r){const n=this.getCurrentStateInfo();if(!n)return{allowed:!1,reason:"invalid_state",nextState:this.currentState};const s=n.transitions[e];return s?{allowed:!0,nextState:s}:{allowed:!0,nextState:this.currentState}}transition(e){const r=this.handleAIAction(e);return r.allowed?r.nextState?(r.nextState!==this.currentState&&(console.log(`🔄 狀態轉換: ${this.currentState} -> ${r.nextState} (事件: ${e})`),this.currentState=r.nextState,this.stateHistory.push(r.nextState),this.stateHistory.length>this.maxHistoryLength&&this.stateHistory.shift()),!0):(console.warn("❌ 無效的下一個狀態"),!1):r.nextState===this.currentState?!0:(console.warn(`❌ 無法從 ${this.currentState} 轉換到 ${e} 事件: ${r.reason}`),!1)}getAvailableTools(){return stateMachine.getAvailableTools(this.currentState)}isToolAllowed(e){return this.getAvailableTools().includes(e)}getAvailableEvents(){return stateMachine.getAvailableEvents(this.currentState)}reset(e="idle"){this.currentState=e,this.stateHistory=[e]}canRollback(){return this.stateHistory.length>1}rollback(){return this.canRollback()?(this.stateHistory.pop(),this.currentState=this.stateHistory[this.stateHistory.length-1],console.log(`↩️ 回退到上一個狀態: ${this.currentState}`),!0):!1}getTransitionSuggestions(){return this.getAvailableEvents().map(r=>({event:r,description:`可以執行 ${r} 事件`}))}setState(e){if(!this.stateMachine.isValidState(e))throw new Error(`Invalid state: ${e}`);this.currentState=e}}class LLMRetryError extends Error{constructor(e){super(e),this.name="LLMRetryError"}}En(LLMRetryError,"maxRetries",5);class MindMapService{constructor(e=null){En(this,"stateController");En(this,"chatService");En(this,"validator",new ActionValidator);En(this,"maxRetries",3);En(this,"formConfigs");En(this,"currentTopicId");En(this,"contextCache",null);En(this,"unsubscribe",null);En(this,"errorContext",null);En(this,"currentMode",null);this.stateController=new MindmapStateController,this.chatService=new ChatService,this.formConfigs=forms,this.currentTopicId=e,this.setupContextSubscription(),this.stateController.transition("exploration"),this.chatService.clearHistory()}setCurrentTopic(e){this.currentTopicId!==e&&(this.currentTopicId=e,this.contextCache=null,this.setupContextSubscription())}setupContextSubscription(){if(this.unsubscribe&&this.unsubscribe(),!this.currentTopicId){this.contextCache=null;return}const e=n=>{var a;const s=n.goals.find(o=>o.id===this.currentTopicId);return s?{topic:{id:s.id,title:s.title,description:s.description,bubbles:(a=s.bubbles)==null?void 0:a.map(o=>({id:o.id,title:o.title,content:o.content,bubbleType:o.bubbleType}))},steps:s.steps.filter(o=>o.status!=="archived").map(o=>{var l;return{id:o.id,title:o.title,tasks:(l=o.tasks)==null?void 0:l.filter(u=>u.status!=="archived").map(u=>({id:u.id,title:u.title,status:u.status}))}})}:null};this.unsubscribe=useGoalStore.subscribe(n=>{const s=e(n);this.contextCache=s||null});const r=e(useGoalStore.getState());this.contextCache=r||null}async getMindmapContext(){return this.contextCache||null}convertJsonSchemaToParamType(e){var r,n;return e.type==="array"?e.items.type==="object"&&(r=e.items.properties)!=null&&r.task_name&&(n=e.items.properties)!=null&&n.step_tag?{type:"task[]"}:{type:"string[]"}:{type:"string"}}async processLLMResponse(e){var r,n;try{if(console.log("🔍 Raw LLM Response:",e),console.log("🔍 Response type:",typeof e),console.log("🔍 Response length:",e.length),e=e.trim(),!e.startsWith("{")||!e.endsWith("}"))throw console.error("❌ Invalid JSON format:",e),new Error("Invalid JSON format");const s=e.match(/"message":\s*"([^"]*)"/);if(s){const l=s[1],u=l.replace(/\n/g,"\\n");e=e.replace(l,u)}console.log("🔍 Cleaned Response:",e);const a=JSON.parse(e);console.log("🔍 Parsed Response:",a);const o=actions$1.actions[a.tool];if(!o)throw new Error(`Unknown action type: ${a.tool}`);for(const[l,u]of Object.entries(o.params)){const c=a.params[l],d=u;if(d.required&&!c)throw new Error(`Missing required parameter: ${l}`);if(c&&d.type==="array"){if(!Array.isArray(c))throw new Error(`Parameter ${l} should be an array`);if(((r=d.items)==null?void 0:r.type)==="object")for(const p of c){if(typeof p!="object")throw new Error(`Array items in ${l} should be objects`);for(const[m,y]of Object.entries(d.items.properties||{}))if(!(m in p))throw new Error(`Missing required property ${m} in array item of ${l}`)}else if(((n=d.items)==null?void 0:n.type)==="string"){for(const p of c)if(typeof p!="string")throw new Error(`Array items in ${l} should be strings`)}}}return a}catch(s){throw console.error("❌ Failed to process LLM response:",s),s}}async handleUserInput(e){var a,o,l,u;let r=0,n=null,s=this.maxRetries;for(;r<s;)try{const c=this.stateController.handleUserEvent("input_received",e);if(!c.allowed)throw new Error(`Invalid user event: ${c.reason}`);const d=this.errorContext?`${this.errorContext}`:e;this.errorContext=null;const p=await this.getMindmapContext();this.chatService.updateMindmapContext(p);let m="";const y=this.stateController.getCurrentState();y==="analysis"&&(m="請以分析師的角度，深入分析以下內容：");const b=await this.chatService.sendMessage(m?`${m}
${d}`:d,{level:"L3",state:y});if("status"in b){const I=b.status;if(I>=500)throw new Error("哎呀！伺服器好像累了，讓我休息一下... 🦥");if(I>=400)throw new Error("請求似乎有點問題，讓我檢查一下... 🤔")}if(!(b!=null&&b.message))throw new Error("無效的回應格式");const E=await this.processLLMResponse(b.message);console.log("🔍 Parsed LLM Response:",E);const T=this.formConfigs[E.tool];console.log("📋 Form Config:",T);const S=actions$1.actions[E.tool];if(console.log("⚡ Action Config:",S),!this.stateController.isToolAllowed(E.tool))throw new Error(`當前狀態不允許使用工具: ${E.tool}`);if(!T)return console.log("⚠️ 動作合法但沒有對應的 form，轉為聊天處理",{tool:E.tool,params:E.params}),{tool:"chat",params:{},message:b.message,form:{type:"chat",title:"聊天",description:"與 AI 對話",options:[]}};if(!S)throw new Error(`Unknown action type: ${E.tool}`);const P=((a=T.options)==null?void 0:a.map(I=>{if(I.paramSource){const j=E.params[I.paramSource];return console.log("🔍 Param Value:",j),Array.isArray(j)?j.slice(0,4).map(H=>({label:typeof H=="string"?H:H.task_name,action:{type:I.paramAction,params:H}})):{label:typeof j=="string"?j:j.task_name,action:{type:I.paramAction,params:j}}}return I}).flat())||[];console.log("📋 Final Updated Options:",P);const A=((o=T.additionalOptions)==null?void 0:o.map(I=>({label:I.text,action:{type:I.action,params:I.text}})))||[];return{tool:E.tool,params:E.params,message:E.message||"",form:{...T,options:[...P,...A]}}}catch(c){const d=c;n=d,console.error("❌ Error details:",{message:d.message,stack:d.stack,response:(l=d.response)==null?void 0:l.data,status:(u=d.response)==null?void 0:u.status}),r++,d instanceof LLMRetryError&&(s=LLMRetryError.maxRetries,this.errorContext=`[系統錯誤] ${d.message}`),r<s&&(console.log(`Retrying... (${r}/${s})`),await new Promise(p=>setTimeout(p,1e3)))}throw new Error(`重試 ${s} 次後仍然失敗：${n==null?void 0:n.message}`)}async executeAction(e,r){const n=tools.find(a=>a.name===e);if(!n)throw new Error(`Unknown tool: ${e}`);if(console.log("⚡ Executing action:",e,"with payload:",r),!this.validator.validateAction(e,r))throw console.error("❌ Invalid action parameters"),new Error("Invalid action parameters");const s=await n.handler(r);return console.log("✅ Action result:",s),s}getTopic(){return useGoalStore.getState().goals.find(e=>e.id===this.currentTopicId)}clearFocusElement(){const e=this.getTopic();e&&useGoalStore.getState().setFocusElement(e.id,void 0)}addStep(e){if(console.log("🎯 MindMapService.addStep 開始",{step:e}),!this.currentTopicId)return console.log("❌ 新增失敗：沒有當前主題"),null;const r=useGoalStore.getState().addStep(this.currentTopicId,e);return console.log("✅ 步驟已新增到 store",{newStep:r}),r}updateGoal(e){if(console.log("🎯 MindMapService.updateGoal 開始",{goal:e}),!this.currentTopicId)return console.log("❌ 更新失敗：沒有當前主題"),null;const r=useGoalStore.getState().updateGoal(e);return console.log("✅ 目標更新結果",{result:r}),r}updateStep(e,r){return this.currentTopicId?useGoalStore.getState().updateStep(this.currentTopicId,r):null}addTask(e,r){return this.currentTopicId?useGoalStore.getState().addTask(this.currentTopicId,e,r):null}addGoal(e){console.log("🎯 MindMapService.addGoal 開始",{goal:e});const r=useGoalStore.getState().addGoal(e);return console.log("✅ 目標已新增",{addedGoal:r}),r}updateTask(e,r,n){if(console.log("🔍 MindMapService.updateTask 開始",{stepId:e,taskId:r,updates:n}),!this.currentTopicId)return console.log("❌ 更新失敗：沒有當前主題"),null;const s=useGoalStore.getState().updateTask(this.currentTopicId,e,n);return console.log("🔄 更新結果",{result:s}),s}deleteStep(e){return this.currentTopicId?useGoalStore.getState().deleteStep(this.currentTopicId,e):null}deleteTask(e,r){return this.currentTopicId?useGoalStore.getState().deleteTask(this.currentTopicId,e,r):null}addBubble(e){return this.currentTopicId?useGoalStore.getState().addBubble(this.currentTopicId,e):null}updateBubble(e,r){return this.currentTopicId?useGoalStore.getState().updateBubble(this.currentTopicId,e,r):null}deleteBubble(e){return this.currentTopicId?useGoalStore.getState().deleteBubble(this.currentTopicId,e):null}async handleAction(e,r){const n=this.stateController.handleAIAction(e,r);if(!n.allowed)throw new Error(`Invalid action: ${n.reason}`);n.nextState&&this.stateController.transition(e),console.log("👆 使用者觸發行為",{actionType:e,params:r,currentTopicId:this.currentTopicId,currentState:this.stateController.getCurrentState()});const s=this.getTopic();if(!s){console.log("❌ 處理失敗：找不到當前主題");return}try{switch(e){case"createTopic":console.log("📝 準備新增主題",{title:r});const a={title:r,tasks:[]},o=this.addStep(a);console.log("✅ 主題新增結果",{createdStep:o}),o&&(console.log("🎯 設定焦點到新主題",{type:"step",id:o.id}),useGoalStore.getState().setFocusElement(s.id,{type:"step",id:o.id}));break;case"createStep":console.log("📝 準備新增步驟",{title:r});const l={title:r,tasks:[]},u=this.addStep(l);console.log("✅ 步驟新增結果",{addedStep:u}),u&&(console.log("🎯 設定焦點到新步驟",{type:"step",id:u.id}),useGoalStore.getState().setFocusElement(s.id,{type:"step",id:u.id}));break;case"createTask":this.stateController.transition("task_started");try{if(console.log("📝 準備新增任務",{params:r}),!r.step_id)throw console.log("❌ 新增失敗：缺少步驟 ID"),new LLMRetryError("哎呀！我需要知道要把任務加到哪個步驟。讓我想想看...");const b={title:r.task_name,status:"todo"},E=this.getTopic();if(!E)throw console.log("❌ 新增失敗：找不到當前主題"),new LLMRetryError("找不到目前的主題，讓我檢查一下...");if(E.steps.length===0)throw console.log("❌ 新增失敗：沒有任何步驟"),new LLMRetryError("需要先建立步驟。建議使用 use_template_steps 建立預設步驟結構。");if(!E.steps.find(P=>P.id===r.step_id))throw console.log("❌ 新增失敗：找不到目標步驟",{stepId:r.step_id}),new LLMRetryError("咦？這個步驟好像不見了。讓我檢查一下...");const S=this.addTask(r.step_id,b);console.log("✅ 任務新增結果",{addedTask:S}),S&&(console.log("🎯 設定焦點到新任務",{type:"task",id:S.id}),useGoalStore.getState().setFocusElement(s.id,{type:"task",id:S.id}))}catch(b){throw console.error("❌ 建立任務時發生錯誤:",b),b}break;case"createTopics":console.log("📝 準備批量新增主題",{topics:r});let c=null;r.forEach(b=>{const E={title:b,tasks:[]},T=this.addStep(E);console.log("✅ 主題新增結果",{title:b,createdStep:T}),T&&(c=T.id)}),c&&(console.log("🎯 設定焦點到最後新增的主題",{type:"step",id:c}),useGoalStore.getState().setFocusElement(s.id,{type:"step",id:c}));break;case"createSteps":console.log("📝 準備批量新增步驟",{steps:r});let d=null;r.forEach(b=>{const E={title:b,tasks:[]},T=this.addStep(E);console.log("✅ 步驟新增結果",{title:b,addedStep:T}),T&&(d=T.id)}),d&&(console.log("🎯 設定焦點到最後新增的步驟",{type:"step",id:d}),useGoalStore.getState().setFocusElement(s.id,{type:"step",id:d}));break;case"createTasks":console.log("📝 準備批量新增任務",{tasks:r});let p=null;r.forEach(b=>{const E={title:b.task_name,status:"todo"},T=this.addTask(b.step_tag,E);console.log("✅ 任務新增結果",{title:b.task_name,stepId:b.step_tag,addedTask:T}),T&&(p=T.id)}),p&&(console.log("🎯 設定焦點到最後新增的任務",{type:"task",id:p}),useGoalStore.getState().setFocusElement(s.id,{type:"task",id:p}));break;case"use_template_steps":console.log("📝 準備使用模板步驟");let m=null;[{title:"觀察",tasks:[],order:1},{title:"行動",tasks:[],order:2},{title:"紀錄",tasks:[],order:3},{title:"分享",tasks:[],order:4}].forEach(b=>{const E=this.addStep(b);console.log("✅ 模板步驟新增結果",{title:b.title,order:b.order,addedStep:E}),E&&(m=E.id)}),m&&(console.log("🎯 設定焦點到最後新增的模板步驟",{type:"step",id:m}),useGoalStore.getState().setFocusElement(s.id,{type:"step",id:m}));break}}catch(a){throw console.error("❌ 處理使用者行為時發生錯誤:",a),a}}calculateProgress(e){const r=e.steps.reduce((s,a)=>s+a.tasks.length,0);if(r===0)return 0;const n=e.steps.reduce((s,a)=>s+a.tasks.filter(o=>o.status==="done").length,0);return Math.round(n/r*100)}getCurrentState(){return this.stateController.getCurrentState()}getStateInfo(){return this.stateController.getCurrentStateInfo()}getAvailableTools(){return this.stateController.getAvailableTools()}getAvailableEvents(){return this.stateController.getAvailableEvents()}canTrigger(e){return this.stateController.canTrigger(e)}setMode(e){switch(console.log("🎯 設置模式:",e),e){case"summarize":this.stateController.setState("summarize");break;case"exploration":this.stateController.setState("exploration");break;case"mission_search":this.stateController.setState("mission_search");break;case"bubble_idea_search":this.stateController.setState("bubble_idea_search");break;case"step_search":this.stateController.setState("step_search");break;default:this.stateController.setState("exploration")}this.currentMode=e,this.chatService.clearHistory()}getMode(){return this.currentMode}}const FloatingAssistant=({enabled:t=!0,dragConstraints:e,initialPosition:r={x:0,y:0},onDragEnd:n,className:s="",onActionSubmit:a,goalId:o=null,onFocus:l})=>{const[u,c]=reactExports.useState("idle"),[d,p]=reactExports.useState(!1),[m,y]=reactExports.useState(!1),[b,E]=reactExports.useState([]);React.useMemo(()=>new ChatService,[]);const T=React.useMemo(()=>new MindMapService(o),[o]),S=useDragControls(),[P,A]=reactExports.useState({showChoices:!1,showInput:!1,message:"",choices:[],inputText:"",inputPlaceholder:"和我分享你的想法吧"}),I=(fe,ae)=>{A(ce=>{var le;const me=fe(ce),te={...ce,...me};return"showInput"in me||(te.showInput=!(((le=te.choices)==null?void 0:le.length)>0)),console.log(`🔍 [${ae}] New state:`,te),te})},j=(fe,ae)=>{console.log("🔍 Form config:",fe),I(ce=>{var me,te,le;return{message:ae||ce.message,showChoices:(((me=fe.options)==null?void 0:me.length)??0)>0,showInput:fe.showInput??!(((te=fe.options)==null?void 0:te.length)??0),inputPlaceholder:fe.description||"和我分享你的想法吧",choices:((le=fe.options)==null?void 0:le.map(Z=>({text:Z.label,icon:de(Z.action.type),description:"",action:async()=>{try{c("thinking"),await T.handleAction(Z.action.type,Z.action.params),c("idle")}catch(Y){throw console.error("Failed to handle option click:",Y),Y instanceof Error&&Y.message,I(he=>({message:"哎呀！好像遇到了一點問題... 讓我看看"}),"handleOptionClick-error"),c("idle"),Y}}})))||[]}},"updateUIFromForm")};reactExports.useEffect(()=>{t&&I(fe=>({message:"嗨！今天想要做什麼呢？",showChoices:!0,showInput:!1,inputText:"",inputPlaceholder:"和我分享你的想法吧",choices:[{text:"幫我想分類",icon:jsxRuntimeExports.jsx(ListChecks,{className:"h-12 w-12 text-indigo-600"}),description:"幫你規劃學習目標的分類",action:()=>K("根據現在的主題和結構, 幫我建議 1~3 個學習步驟")},{text:"幫我想任務",icon:jsxRuntimeExports.jsx(Target,{className:"h-12 w-12 text-emerald-600"}),description:"幫你規劃具體的學習任務",action:()=>K("根據現在的主題和結構, 幫我建議 1~3 個新的學習任務")},{text:"跟我聊聊這個主題",icon:jsxRuntimeExports.jsx(MessageSquare,{className:"h-12 w-12 text-orange-600"}),description:"討論這個主題的相關內容",action:()=>K("跟我聊聊這個主題, 有沒有推薦的方向呢？")},{text:"隨便聊聊天",icon:jsxRuntimeExports.jsx(Brain,{className:"h-12 w-12 text-purple-600"}),description:"來聊聊天吧！",action:()=>W()}]}),"initialSetup")},[t]);const K=fe=>{c("thinking"),H(fe)},W=()=>{c("idle"),I(fe=>({message:"好啊！想聊什麼呢？",showChoices:!1,showInput:!0,inputText:"",inputPlaceholder:"想聊什麼都可以喔！"}),"handleChatMode")},H=reactExports.useCallback(async fe=>{const ae=fe||P.inputText;if(!(!ae.trim()||m)){y(!0),c("thinking"),I(ce=>({...ce,inputText:""}),"handleSendMessage-clear");try{const ce=await T.handleUserInput(ae);E(me=>[...me,{message:ae,role:"user"}]),ce.form?j(ce.form,ce.message):I(me=>({message:ce.message||"你想跟我說什麼呢"}),"handleSendMessage"),c("idle")}catch(ce){console.error("Failed to send message:",ce),I(me=>({message:"抱歉，發生了一些錯誤，請稍後再試。"}),"handleSendMessage-error"),c("idle")}finally{y(!1)}}},[P.inputText,m,T]),ee=reactExports.useCallback(fe=>{fe.key==="Enter"&&!fe.shiftKey&&(fe.preventDefault(),H())},[H]),ue=()=>{d||(u==="idle"&&!P.message&&!P.showChoices&&!P.showInput?(c("idle"),I(fe=>({message:"嗨！今天想要做什麼呢？",showChoices:!0,showInput:!1,inputText:"",inputPlaceholder:"和我分享你的想法吧",choices:[{text:"幫我想分類",icon:jsxRuntimeExports.jsx(ListChecks,{className:"h-12 w-12 text-indigo-600"}),description:"幫你規劃學習目標的分類",action:()=>K("根據現在的主題和結構, 幫我建議 1~3 個學習步驟")},{text:"幫我想任務",icon:jsxRuntimeExports.jsx(Target,{className:"h-12 w-12 text-emerald-600"}),description:"幫你規劃具體的學習任務",action:()=>K("根據現在的主題和結構, 幫我建議 1~3 個新的學習任務")},{text:"跟我聊聊這個主題",icon:jsxRuntimeExports.jsx(MessageSquare,{className:"h-12 w-12 text-orange-600"}),description:"討論這個主題的相關內容",action:()=>K("跟我聊聊這個主題, 有沒有推薦的方向呢？")},{text:"隨便聊聊天",icon:jsxRuntimeExports.jsx(Brain,{className:"h-12 w-12 text-purple-600"}),description:"來聊聊天吧！",action:()=>W()}]}),"handleAssistantClick-show")):(c("idle"),I(fe=>({message:"",showChoices:!1,showInput:!1,inputText:"",choices:[]}),"handleAssistantClick-hide")))};reactExports.useEffect(()=>{},[u,P]);const de=fe=>{const ae=[jsxRuntimeExports.jsx(Lightbulb,{className:"h-12 w-12 text-yellow-500"}),jsxRuntimeExports.jsx(ListChecks,{className:"h-12 w-12 text-blue-500"}),jsxRuntimeExports.jsx(Target,{className:"h-12 w-12 text-red-500"}),jsxRuntimeExports.jsx(Bookmark,{className:"h-12 w-12 text-purple-500"}),jsxRuntimeExports.jsx(CircleCheckBig,{className:"h-12 w-12 text-green-500"}),jsxRuntimeExports.jsx(Compass,{className:"h-12 w-12 text-indigo-500"}),jsxRuntimeExports.jsx(MessageSquare,{className:"h-12 w-12 text-teal-500"}),jsxRuntimeExports.jsx(Brain,{className:"h-12 w-12 text-emerald-600"})],ce=Math.floor(Math.random()*ae.length);return ae[ce]};return jsxRuntimeExports.jsx(AnimatePresence,{children:t&&jsxRuntimeExports.jsx(motion.div,{drag:!0,dragControls:S,dragConstraints:e,dragMomentum:!1,dragElastic:0,initial:r,dragListener:!1,onDragStart:()=>{p(!0)},onDragEnd:(fe,ae)=>{p(!1),n&&n({x:ae.point.x,y:ae.point.y})},style:{position:"absolute",zIndex:d?50:40},className:`${s}`,onClick:fe=>fe.stopPropagation(),onPointerDown:fe=>fe.stopPropagation(),children:jsxRuntimeExports.jsxs(motion.div,{style:{position:"absolute",zIndex:d?50:40},className:"relative w-36 h-36",onClick:fe=>fe.stopPropagation(),onPointerDown:fe=>fe.stopPropagation(),children:[jsxRuntimeExports.jsx("button",{onPointerDown:fe=>{fe.stopPropagation(),S.start(fe)},onClick:fe=>{fe.stopPropagation(),ue()},className:"w-20 h-20 rounded-full bg-white dark:bg-gray-800 shadow-lg overflow-hidden hover:shadow-xl transition-shadow relative cursor-move translate-x-12",children:jsxRuntimeExports.jsx(Lottie,{animationData:slothAnimation,loop:!0,className:"w-[120%] h-[120%] -translate-x-[7%] -translate-y-[5%] pointer-events-none"})}),jsxRuntimeExports.jsx(motion.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>c(u==="menu"?"idle":"menu"),className:"absolute -top-2 -right-2 bg-white dark:bg-gray-800 rounded-full p-1 shadow-md",children:jsxRuntimeExports.jsx(Settings,{className:"h-4 w-4 text-indigo-500"})}),jsxRuntimeExports.jsxs(AnimatePresence,{mode:"wait",children:[u!=="menu"?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[P.message&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"absolute bottom-[calc(100%+1rem)] right-0 bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-4 max-w-[400px] min-w-[300px] pointer-events-auto select-text cursor-text min-h-[6rem] max-h-[6rem] overflow-y-auto flex items-start",style:{pointerEvents:d?"none":"auto",transformOrigin:"bottom right"},children:[jsxRuntimeExports.jsx("div",{className:`relative w-full ${u==="thinking"?"blur-[1px]":""}`,children:jsxRuntimeExports.jsx("p",{className:"text-base font-bold text-gray-800 dark:text-gray-200 font-sans leading-relaxed whitespace-pre-wrap pl-2",children:P.message})}),u==="thinking"&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex justify-center items-center bg-white/30 dark:bg-gray-800/30 backdrop-blur-[1px] rounded-2xl",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-center items-center space-x-4",children:[jsxRuntimeExports.jsx(motion.div,{animate:{scale:[1,1.2,1],opacity:[1,.5,1]},transition:{duration:1,repeat:1/0,delay:0},className:"w-4 h-4 bg-indigo-500 dark:bg-indigo-400 rounded-full"}),jsxRuntimeExports.jsx(motion.div,{animate:{scale:[1,1.2,1],opacity:[1,.5,1]},transition:{duration:1,repeat:1/0,delay:.3},className:"w-4 h-4 bg-indigo-500 dark:bg-indigo-400 rounded-full"}),jsxRuntimeExports.jsx(motion.div,{animate:{scale:[1,1.2,1],opacity:[1,.5,1]},transition:{duration:1,repeat:1/0,delay:.6},className:"w-4 h-4 bg-indigo-500 dark:bg-indigo-400 rounded-full"})]})}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-0 right-0 transform translate-x-full",children:jsxRuntimeExports.jsx("div",{className:"w-4 h-4 bg-white dark:bg-gray-800 transform rotate-45"})})]}),P.showInput&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"absolute bottom-[calc(100%+8rem)] right-0 bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-3 max-w-[400px] min-w-[300px] pointer-events-auto cursor-default",style:{pointerEvents:d?"none":"auto",transformOrigin:"bottom right"},children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col",children:[jsxRuntimeExports.jsx("div",{className:"mb-3 text-sm text-gray-500 dark:text-gray-400",children:P.inputPlaceholder}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsx("textarea",{value:P.inputText,onChange:fe=>A(ae=>({...ae,inputText:fe.target.value})),onKeyPress:ee,placeholder:"輸入訊息...",className:"flex-1 resize-none rounded-lg border border-gray-300 dark:border-gray-600 p-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 text-sm",rows:2}),jsxRuntimeExports.jsx(motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>H(),disabled:m||!P.inputText.trim(),className:"p-3 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?jsxRuntimeExports.jsx(LoaderCircle,{className:"h-5 w-5 animate-spin"}):jsxRuntimeExports.jsx(Send,{className:"h-5 w-5"})})]})]}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-0 right-6 transform translate-y-full",children:jsxRuntimeExports.jsx("div",{className:"w-4 h-4 bg-white dark:bg-gray-800 transform rotate-45"})})]}),P.showChoices&&P.choices.length>0&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:`absolute right-0 bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-3 max-w-[350px] min-w-[250px] pointer-events-auto cursor-default ${P.showInput?"bottom-[calc(100%+16rem)]":"bottom-[calc(100%+8rem)]"}`,style:{pointerEvents:d?"none":"auto",transformOrigin:"bottom right"},children:[jsxRuntimeExports.jsx("div",{className:"space-y-4",children:P.choices.map((fe,ae)=>jsxRuntimeExports.jsxs(motion.button,{whileHover:{scale:1.02},whileTap:{scale:.95},onClick:()=>fe.action(),className:"w-full p-3 bg-white dark:bg-gray-700 rounded-xl shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-indigo-50 dark:bg-indigo-900/30 rounded-full flex items-center justify-center",children:fe.icon}),jsxRuntimeExports.jsxs("div",{className:"flex-1 text-left min-w-[200px]",children:[jsxRuntimeExports.jsx("h3",{className:"text-base font-bold text-gray-900 dark:text-gray-100",children:fe.text}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-xs",children:fe.description})]})]},ae))}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-0 right-6 transform translate-y-full",children:jsxRuntimeExports.jsx("div",{className:"w-4 h-4 bg-white dark:bg-gray-800 transform rotate-45"})})]})]}):null,u==="menu"?jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"absolute top-0 right-0 mt-8 bg-white dark:bg-gray-800 rounded-lg shadow-lg p-2 w-48",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>{},className:"w-full flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:[jsxRuntimeExports.jsx(History,{className:"h-4 w-4 mr-2"}),"查看對話紀錄"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{},className:"w-full flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:[jsxRuntimeExports.jsx(Settings,{className:"h-4 w-4 mr-2"}),"設定"]})]}):null]})]})})})},useAssistant=t=>{const[e,r]=reactExports.useState((t==null?void 0:t.isVisible)??!0),[n,s]=reactExports.useState((t==null?void 0:t.position)??{x:0,y:0});return{isVisible:e,position:n,setPosition:s,toggleAssistant:()=>r(!e),reset:()=>{r((t==null?void 0:t.isVisible)??!0),s((t==null?void 0:t.position)??{x:0,y:0})}}},StudentPlanning=()=>{const{goals:t,updateGoal:e,updateTask:r}=useGoalStore(),[n,s]=reactExports.useState(null),[a,o]=reactExports.useState(!1),[l,u]=reactExports.useState(!1),[c,d]=reactExports.useState(!1),[p,m]=reactExports.useState(!1),[y,b]=reactExports.useState(null),[E,T]=reactExports.useState(!1),[S,P]=reactExports.useState(""),[A,I]=reactExports.useState(!1),[j,K]=reactExports.useState(new Set),[W,H]=reactExports.useState(!1),[ee,ue]=reactExports.useState(!1),[de,fe]=reactExports.useState([]),{isVisible:ae,position:ce,setPosition:me,toggleAssistant:te}=useAssistant({position:{x:-120,y:0}});reactExports.useRef(null);const le=reactExports.useRef(null),Z=useNavigate();reactExports.useEffect(()=>{K(new Set(t.map(Te=>Te.id)))},[t]),reactExports.useEffect(()=>{const Te=Ve=>{const Pe=Ve.target;Pe.closest(".dropdown-option")||!Pe.closest(".subject-select")&&!Pe.closest(".type-select")&&(H(!1),ue(!1))};return document.addEventListener("mousedown",Te),()=>document.removeEventListener("mousedown",Te)},[]);const Y=()=>{ue(!ee),H(!1)},he=()=>{H(!W),ue(!1)},oe=Te=>{fe(Ve=>Ve.includes(Te)?Ve.filter(Pe=>Pe!==Te):[...Ve,Te])},ye=Te=>{if(!(Te!=null&&Te.steps))return 0;const Ve=Te.steps.reduce((Ce,De)=>{var ze;return Ce+(((ze=De.tasks)==null?void 0:ze.length)||0)},0),Pe=Te.steps.reduce((Ce,De)=>{var ze;return Ce+(((ze=De.tasks)==null?void 0:ze.filter(Et=>Et.status==="done").length)||0)},0);return Ve===0?0:Math.round(Pe/Ve*100)},Ee=(Te,Ve,Pe)=>{r(Te,Ve,Pe)},Ae=(Te,Ve,Pe)=>{r(Te,Ve,Pe)},je=Te=>{const Ve=t.find(Pe=>Pe.id===Te);if(Ve){const Pe={...Ve,status:GOAL_STATUSES.ARCHIVED};console.log("Deleting goal:",{goalId:Te,updatedGoal:Pe}),e(Pe)}};return jsxRuntimeExports.jsxs(PageLayout,{title:"學習計畫",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 relative",children:[jsxRuntimeExports.jsx("div",{ref:le,className:"fixed bottom-20 right-6 w-[400px] h-[400px]",style:{pointerEvents:"none"},children:jsxRuntimeExports.jsx(FloatingAssistant,{enabled:ae,onToggle:te,hideCloseButton:!0,dragConstraints:le,initialPosition:ce,onPositionChange:me,className:"pointer-events-auto"})}),jsxRuntimeExports.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"我的目標"}),jsxRuntimeExports.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center px-3 py-1.5 text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700",children:[jsxRuntimeExports.jsx(Plus,{className:"h-4 w-4 mr-1"}),"新增目標"]})]}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:t.filter(Te=>Te.status!==GOAL_STATUSES.ARCHIVED).map(Te=>jsxRuntimeExports.jsxs("button",{onClick:()=>{p&&y&&(j.has(y.id)||je(y.id),m(!1),I(!1)),s(Te),b(Te)},className:`w-full text-left p-3 rounded-lg transition ${(n==null?void 0:n.id)===Te.id?"bg-indigo-50 dark:bg-indigo-900/30 border-2 border-indigo-500":"border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50"}`,children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-start",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 min-w-0 flex items-start gap-2",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:`shrink-0 ${Te.templateType==="學習目標"?"text-purple-500":Te.templateType==="個人成長"?"text-blue-500":Te.templateType==="專案計畫"?"text-green-500":"text-orange-500"}`,children:Te.templateType==="學習目標"?jsxRuntimeExports.jsx(Brain,{className:"h-4 w-4"}):Te.templateType==="個人成長"?jsxRuntimeExports.jsx(Target,{className:"h-4 w-4"}):Te.templateType==="專案計畫"?jsxRuntimeExports.jsx(Sparkles,{className:"h-4 w-4"}):jsxRuntimeExports.jsx(PartyPopper,{className:"h-4 w-4"})}),jsxRuntimeExports.jsx("h3",{className:"font-medium text-gray-900 dark:text-white truncate",children:Te.title})]})}),jsxRuntimeExports.jsx("span",{className:`shrink-0 inline-flex items-center px-2.5 py-0.5 rounded text-xs font-medium ${subjects.getSubjectStyle(Te.subject||"").bg} ${subjects.getSubjectStyle(Te.subject||"").text}`,children:Te.subject||"未分類"})]}),jsxRuntimeExports.jsxs("div",{className:"mt-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"進度"}),jsxRuntimeExports.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[ye(Te),"%"]})]}),jsxRuntimeExports.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:jsxRuntimeExports.jsx("div",{className:"bg-indigo-600 h-2 rounded-full",style:{width:`${ye(Te)}%`}})})]}),Te.dueDate&&jsxRuntimeExports.jsxs("div",{className:"mt-2 flex items-center text-sm text-gray-500 dark:text-gray-400",children:[jsxRuntimeExports.jsx(Calendar$1,{className:"h-4 w-4 mr-1"}),new Intl.DateTimeFormat("zh-TW",{month:"long",day:"numeric"}).format(new Date(Te.dueDate))]})]},Te.id))})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"目標設定小技巧"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start",children:[jsxRuntimeExports.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg mr-3",children:jsxRuntimeExports.jsx(Target,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"具體且可衡量"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"設定明確的目標和可量化的指標"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-start",children:[jsxRuntimeExports.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-lg mr-3",children:jsxRuntimeExports.jsx(BookOpen,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"分解大目標"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"將大目標拆解成小步驟，逐步達成"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-start",children:[jsxRuntimeExports.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/30 rounded-lg mr-3",children:jsxRuntimeExports.jsx(Lightbulb,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"定期回顧"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"每週檢視進度，適時調整計畫"})]})]})]})]})]}),jsxRuntimeExports.jsx("div",{className:"lg:col-span-2",children:n?jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-start mb-6",children:[jsxRuntimeExports.jsx("div",{className:"flex-1",children:p?jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsx("input",{type:"text",value:y==null?void 0:y.title,onChange:Te=>{y&&b({...y,title:Te.target.value})},placeholder:"輸入目標標題（例如：完成科學探索專案）",className:`w-full text-2xl font-bold bg-gray-50 dark:bg-gray-700 border ${A&&(y==null?void 0:y.title)===""?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-md px-3 py-2 placeholder-gray-400 dark:placeholder-gray-500`}),jsxRuntimeExports.jsx("textarea",{value:y==null?void 0:y.description,onChange:Te=>{y&&b({...y,description:Te.target.value})},placeholder:"描述你的目標內容和期望達成的結果（例如：透過觀察、實驗和記錄，探索自然現象並培養科學思維）",className:`w-full text-gray-600 dark:text-gray-300 bg-gray-50 dark:bg-gray-700 border ${A&&(y==null?void 0:y.description)===""?"border-red-500":"border-gray-300 dark:border-gray-600"} rounded-md px-3 py-2 placeholder-gray-400 dark:placeholder-gray-500`,rows:3}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"relative inline-block",children:[jsxRuntimeExports.jsxs("button",{onClick:Y,className:`inline-flex items-center gap-2 px-2.5 py-0.5 rounded-md text-sm font-medium type-select ${(y==null?void 0:y.templateType)==="學習目標"?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300":(y==null?void 0:y.templateType)==="個人成長"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":(y==null?void 0:y.templateType)==="專案計畫"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300"}`,children:[(y==null?void 0:y.templateType)==="學習目標"?jsxRuntimeExports.jsx(Brain,{className:"h-4 w-4"}):(y==null?void 0:y.templateType)==="個人成長"?jsxRuntimeExports.jsx(Target,{className:"h-4 w-4"}):(y==null?void 0:y.templateType)==="專案計畫"?jsxRuntimeExports.jsx(Sparkles,{className:"h-4 w-4"}):jsxRuntimeExports.jsx(PartyPopper,{className:"h-4 w-4"}),y==null?void 0:y.templateType,jsxRuntimeExports.jsx(ChevronDown,{className:"h-4 w-4"})]}),ee&&jsxRuntimeExports.jsx("div",{className:"absolute z-10 mt-1 w-40 bg-white dark:bg-gray-800 shadow-lg rounded-md border border-gray-200 dark:border-gray-700",children:goalTemplates.map(Te=>jsxRuntimeExports.jsxs("button",{onClick:Ve=>{Ve.stopPropagation(),y&&(b({...y,templateType:Te.title}),ue(!1))},className:`flex items-center gap-2 w-full text-left px-4 py-2 text-sm hover:bg-gray-50 dark:hover:bg-gray-700 dropdown-option ${Te.title==="學習目標"?"text-purple-600 dark:text-purple-400":Te.title==="個人成長"?"text-blue-600 dark:text-blue-400":Te.title==="專案計畫"?"text-green-600 dark:text-green-400":"text-orange-600 dark:text-orange-400"}`,children:[Te.icon,Te.title]},Te.title))})]}),jsxRuntimeExports.jsxs("div",{className:"relative inline-block",children:[jsxRuntimeExports.jsxs("button",{onClick:he,className:`inline-flex items-center gap-2 px-2.5 py-0.5 rounded-md text-sm font-medium subject-select ${subjects.getSubjectStyle((y==null?void 0:y.subject)||"").bg} ${subjects.getSubjectStyle((y==null?void 0:y.subject)||"").text}`,children:[(y==null?void 0:y.subject)||"未分類",jsxRuntimeExports.jsx(ChevronDown,{className:"h-4 w-4"})]}),W&&jsxRuntimeExports.jsx("div",{className:"absolute z-10 mt-1 w-40 bg-white dark:bg-gray-800 shadow-lg rounded-md border border-gray-200 dark:border-gray-700",children:Object.values(SUBJECTS).map(Te=>jsxRuntimeExports.jsx("button",{onClick:Ve=>{Ve.stopPropagation(),y&&(b({...y,subject:Te}),H(!1))},className:`w-full text-left px-4 py-2 text-sm hover:bg-gray-50 dark:hover:bg-gray-700 dropdown-option ${subjects.getSubjectStyle(Te).text}`,children:Te},Te))})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>{var Te;I(!0),y&&n&&y.title.trim()!==""&&((Te=y.description)==null?void 0:Te.trim())!==""&&(m(!1),e(y),s(y),I(!1),K(Ve=>new Set(Ve).add(y.id)))},disabled:!(y!=null&&y.title)||!(y!=null&&y.description),className:"px-3 py-1.5 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:"保存"}),jsxRuntimeExports.jsx("button",{onClick:()=>{m(!1),b(n)},className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"取消"})]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:n.title}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-gray-600 dark:text-gray-300",children:n.description}),jsxRuntimeExports.jsxs("div",{className:"mt-2 flex gap-2",children:[jsxRuntimeExports.jsxs("span",{className:`inline-flex items-center gap-2 px-2.5 py-0.5 rounded-md text-sm font-medium ${n.templateType==="學習目標"?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300":n.templateType==="個人成長"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":n.templateType==="專案計畫"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300"}`,children:[n.templateType==="學習目標"?jsxRuntimeExports.jsx(Brain,{className:"h-4 w-4"}):n.templateType==="個人成長"?jsxRuntimeExports.jsx(Target,{className:"h-4 w-4"}):n.templateType==="專案計畫"?jsxRuntimeExports.jsx(Sparkles,{className:"h-4 w-4"}):jsxRuntimeExports.jsx(PartyPopper,{className:"h-4 w-4"}),n.templateType]}),jsxRuntimeExports.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-md text-sm font-medium ${subjects.getSubjectStyle(n.subject||"").bg} ${subjects.getSubjectStyle(n.subject||"").text}`,children:n.subject||"未分類"})]})]})}),!p&&jsxRuntimeExports.jsxs("div",{className:"flex space-x-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>{m(!0),b(n)},className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:jsxRuntimeExports.jsx(Pencil,{className:"h-5 w-5"})}),jsxRuntimeExports.jsx("button",{onClick:()=>Z(`/student/planning/goal/${n.id}`),className:"text-gray-400 hover:text-indigo-600 dark:hover:text-indigo-400",children:jsxRuntimeExports.jsx(Brain,{className:"h-5 w-5"})}),jsxRuntimeExports.jsx("button",{onClick:()=>T(!0),className:"text-gray-400 hover:text-red-600 dark:hover:text-red-400",children:jsxRuntimeExports.jsx(Trash2,{className:"h-5 w-5"})}),jsxRuntimeExports.jsx("button",{onClick:te,className:`text-gray-400 ${ae?"text-indigo-600 dark:text-indigo-400":"hover:text-indigo-600 dark:hover:text-indigo-400"}`,children:jsxRuntimeExports.jsx(Sparkles,{className:"h-5 w-5"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"p-4 bg-indigo-50 dark:bg-indigo-900/30 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"總進度"}),jsxRuntimeExports.jsxs("p",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-400",children:[ye(n),"%"]})]}),jsxRuntimeExports.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/30 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"已完成項目"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:n.steps.reduce((Te,Ve)=>Te+Ve.tasks.filter(Pe=>Pe.status==="done").length,0)})]}),jsxRuntimeExports.jsxs("div",{className:"p-4 bg-orange-50 dark:bg-orange-900/30 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"待辦項目"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:n.steps.reduce((Te,Ve)=>Te+Ve.tasks.filter(Pe=>Pe.status==="todo").length,0)})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"學習步驟"}),jsxRuntimeExports.jsxs("button",{onClick:()=>{},className:"inline-flex items-center px-3 py-1.5 text-sm font-medium rounded-md text-indigo-600 bg-indigo-50 hover:bg-indigo-100 dark:text-indigo-400 dark:bg-indigo-900/30 dark:hover:bg-indigo-900/50",children:[jsxRuntimeExports.jsx(Plus,{className:"h-4 w-4 mr-1"}),"新增步驟"]})]}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:n.steps.map(Te=>jsxRuntimeExports.jsx(StepItem,{step:Te,isExpanded:de.includes(Te.id),onToggle:()=>oe(Te.id),onTaskStatusChange:Ve=>Ee(n.id,Te.id,Ve),onTaskEdit:Ve=>Ae(n.id,Te.id,Ve),onAddTask:()=>{}},Te.id))})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 dark:from-indigo-900 dark:to-purple-900 rounded-lg shadow p-6 text-white",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold",children:"AI 學習助理"}),jsxRuntimeExports.jsx(Sparkles,{className:"h-5 w-5"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm opacity-90 mb-4",children:"需要協助拆解目標或規劃學習路徑嗎？我可以幫你："}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[jsxRuntimeExports.jsxs("button",{className:"p-3 bg-white/10 hover:bg-white/20 rounded-lg text-sm text-left transition",children:[jsxRuntimeExports.jsx(ArrowRight,{className:"h-4 w-4 mb-2"}),"將目標拆解成可執行的小步驟"]}),jsxRuntimeExports.jsxs("button",{className:"p-3 bg-white/10 hover:bg-white/20 rounded-lg text-sm text-left transition",children:[jsxRuntimeExports.jsx(ArrowRight,{className:"h-4 w-4 mb-2"}),"建議適合的學習資源和方法"]})]})]})]}):jsxRuntimeExports.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 text-center",children:jsxRuntimeExports.jsxs("div",{className:"max-w-sm mx-auto",children:[jsxRuntimeExports.jsx(Target,{className:"h-12 w-12 text-gray-400 dark:text-gray-500 mx-auto mb-4"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"選擇一個目標開始"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"從左側選擇一個目標，或點擊「新增目標」來開始規劃你的學習之旅。"})]})})})]}),l&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:jsxRuntimeExports.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full",children:jsxRuntimeExports.jsxs("div",{className:"p-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"選擇目標類型"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:goalTemplates.map((Te,Ve)=>jsxRuntimeExports.jsxs("button",{onClick:()=>{const Pe={id:crypto.randomUUID(),title:"",description:"",templateType:Te.title,subject:SUBJECTS.CUSTOM,dueDate:new Date().toISOString(),progress:0,steps:[],status:"active"};u(!1),e(Pe),s(Pe),b(Pe),m(!0)},className:"p-4 border-2 border-gray-200 dark:border-gray-700 rounded-lg hover:border-indigo-500 dark:hover:border-indigo-500 transition text-left",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center mb-3",children:Te.icon}),jsxRuntimeExports.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-1",children:Te.title}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:Te.description})]},Ve))}),jsxRuntimeExports.jsx("div",{className:"flex justify-end",children:jsxRuntimeExports.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 dark:text-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 rounded-md",children:"取消"})})]})})}),E&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"確認刪除目標"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"確定要刪除此目標嗎？此操作無法復原。"}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>{T(!1),P("")},className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"取消"}),jsxRuntimeExports.jsx("button",{onClick:()=>{n&&(je(n.id),s(null),T(!1),P(""))},className:"px-3 py-1.5 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:"刪除"})]})]})})]})},v="5.5.7",fr=60,ip=0,op=180,w=400,h=400,nm="Mind Map Loading",ddd=0,assets=[],layers=[{ddd:0,ind:1,ty:4,nm:"Circle",sr:1,ks:{o:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:0,s:[0]},{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:30,s:[100]},{t:60,s:[100]}]},r:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:0,s:[0]},{t:180,s:[360]}]},p:{a:0,k:[200,200]},a:{a:0,k:[0,0,0]},s:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:0,s:[80,80,100]},{t:30,s:[100,100,100]}]}},ao:0,shapes:[{ty:"gr",it:[{ty:"el",p:{a:0,k:[0,0]},s:{a:0,k:[160,160]}},{ty:"st",c:{a:0,k:[.6,.4,1,1]},o:{a:0,k:100},w:{a:0,k:20},lc:2,lj:2}],nm:"Circle_Stroke_Group"}]},{ddd:0,ind:2,ty:4,nm:"Bars",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[200,200]},a:{a:0,k:[0,0,0]},s:{a:0,k:[100,100,100]}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",p:{a:0,k:[-60,0]},s:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:0,s:[20,0]},{t:45,s:[20,80]}]},r:{a:0,k:0}},{ty:"fl",c:{a:0,k:[.6,.4,1,1]}}],nm:"Bar_1_Fill_Group"},{ty:"gr",it:[{ty:"rc",p:{a:0,k:[-20,0]},s:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:15,s:[20,0]},{t:60,s:[20,120]}]},r:{a:0,k:0}},{ty:"fl",c:{a:0,k:[.8,.6,1,1]}}],nm:"Bar_2_Fill_Group"},{ty:"gr",it:[{ty:"rc",p:{a:0,k:[20,0]},s:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:30,s:[20,0]},{t:75,s:[20,60]}]},r:{a:0,k:0}},{ty:"fl",c:{a:0,k:[1,.8,1,1]}}],nm:"Bar_3_Fill_Group"},{ty:"gr",it:[{ty:"rc",p:{a:0,k:[60,0]},s:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:45,s:[20,0]},{t:90,s:[20,100]}]},r:{a:0,k:0}},{ty:"fl",c:{a:0,k:[.902,.702,1,1]}}],nm:"Bar_4_Fill_Group"}]}],loadingAnimation={v,fr,ip,op,w,h,nm,ddd,assets,layers},mindMapBg="/assets/mindmap-bg-BG4YRJc2.jpg";function composeEventHandlers(t,e,{checkForDefaultPrevented:r=!0}={}){return function(s){if(t==null||t(s),r===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function setRef(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function composeRefs(...t){return e=>{let r=!1;const n=t.map(s=>{const a=setRef(s,e);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let s=0;s<n.length;s++){const a=n[s];typeof a=="function"?a():setRef(t[s],null)}}}}function useComposedRefs(...t){return reactExports.useCallback(composeRefs(...t),t)}function createContextScope(t,e=[]){let r=[];function n(a,o){const l=reactExports.createContext(o),u=r.length;r=[...r,o];const c=p=>{var S;const{scope:m,children:y,...b}=p,E=((S=m==null?void 0:m[t])==null?void 0:S[u])||l,T=reactExports.useMemo(()=>b,Object.values(b));return jsxRuntimeExports.jsx(E.Provider,{value:T,children:y})};c.displayName=a+"Provider";function d(p,m){var E;const y=((E=m==null?void 0:m[t])==null?void 0:E[u])||l,b=reactExports.useContext(y);if(b)return b;if(o!==void 0)return o;throw new Error(`\`${p}\` must be used within \`${a}\``)}return[c,d]}const s=()=>{const a=r.map(o=>reactExports.createContext(o));return function(l){const u=(l==null?void 0:l[t])||a;return reactExports.useMemo(()=>({[`__scope${t}`]:{...l,[t]:u}}),[l,u])}};return s.scopeName=t,[n,composeContextScopes(s,...e)]}function composeContextScopes(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(a){const o=n.reduce((l,{useScope:u,scopeName:c})=>{const p=u(a)[`__scope${c}`];return{...l,...p}},{});return reactExports.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return r.scopeName=e.scopeName,r}var useLayoutEffect2=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{},useInsertionEffect=React$1[" useInsertionEffect ".trim().toString()]||useLayoutEffect2;function useControllableState({prop:t,defaultProp:e,onChange:r=()=>{},caller:n}){const[s,a,o]=useUncontrolledState({defaultProp:e,onChange:r}),l=t!==void 0,u=l?t:s;{const d=reactExports.useRef(t!==void 0);reactExports.useEffect(()=>{const p=d.current;p!==l&&console.warn(`${n} is changing from ${p?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=l},[l,n])}const c=reactExports.useCallback(d=>{var p;if(l){const m=isFunction(d)?d(t):d;m!==t&&((p=o.current)==null||p.call(o,m))}else a(d)},[l,t,a,o]);return[u,c]}function useUncontrolledState({defaultProp:t,onChange:e}){const[r,n]=reactExports.useState(t),s=reactExports.useRef(r),a=reactExports.useRef(e);return useInsertionEffect(()=>{a.current=e},[e]),reactExports.useEffect(()=>{var o;s.current!==r&&((o=a.current)==null||o.call(a,r),s.current=r)},[r,s]),[r,n,a]}function isFunction(t){return typeof t=="function"}function createSlot(t){const e=createSlotClone(t),r=reactExports.forwardRef((n,s)=>{const{children:a,...o}=n,l=reactExports.Children.toArray(a),u=l.find(isSlottable);if(u){const c=u.props.children,d=l.map(p=>p===u?reactExports.Children.count(c)>1?reactExports.Children.only(null):reactExports.isValidElement(c)?c.props.children:null:p);return jsxRuntimeExports.jsx(e,{...o,ref:s,children:reactExports.isValidElement(c)?reactExports.cloneElement(c,void 0,d):null})}return jsxRuntimeExports.jsx(e,{...o,ref:s,children:a})});return r.displayName=`${t}.Slot`,r}function createSlotClone(t){const e=reactExports.forwardRef((r,n)=>{const{children:s,...a}=r;if(reactExports.isValidElement(s)){const o=getElementRef$1(s),l=mergeProps(a,s.props);return s.type!==reactExports.Fragment&&(l.ref=n?composeRefs(n,o):o),reactExports.cloneElement(s,l)}return reactExports.Children.count(s)>1?reactExports.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var SLOTTABLE_IDENTIFIER=Symbol("radix.slottable");function createSlottable(t){const e=({children:r})=>jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:r});return e.displayName=`${t}.Slottable`,e.__radixId=SLOTTABLE_IDENTIFIER,e}function isSlottable(t){return reactExports.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===SLOTTABLE_IDENTIFIER}function mergeProps(t,e){const r={...e};for(const n in e){const s=t[n],a=e[n];/^on[A-Z]/.test(n)?s&&a?r[n]=(...l)=>{const u=a(...l);return s(...l),u}:s&&(r[n]=s):n==="style"?r[n]={...s,...a}:n==="className"&&(r[n]=[s,a].filter(Boolean).join(" "))}return{...t,...r}}function getElementRef$1(t){var n,s;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var NODES=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Primitive=NODES.reduce((t,e)=>{const r=createSlot(`Primitive.${e}`),n=reactExports.forwardRef((s,a)=>{const{asChild:o,...l}=s,u=o?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),jsxRuntimeExports.jsx(u,{...l,ref:a})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function dispatchDiscreteCustomEvent(t,e){t&&reactDomExports.flushSync(()=>t.dispatchEvent(e))}function createCollection(t){const e=t+"CollectionProvider",[r,n]=createContextScope(e),[s,a]=r(e,{collectionRef:{current:null},itemMap:new Map}),o=E=>{const{scope:T,children:S}=E,P=React.useRef(null),A=React.useRef(new Map).current;return jsxRuntimeExports.jsx(s,{scope:T,itemMap:A,collectionRef:P,children:S})};o.displayName=e;const l=t+"CollectionSlot",u=createSlot(l),c=React.forwardRef((E,T)=>{const{scope:S,children:P}=E,A=a(l,S),I=useComposedRefs(T,A.collectionRef);return jsxRuntimeExports.jsx(u,{ref:I,children:P})});c.displayName=l;const d=t+"CollectionItemSlot",p="data-radix-collection-item",m=createSlot(d),y=React.forwardRef((E,T)=>{const{scope:S,children:P,...A}=E,I=React.useRef(null),j=useComposedRefs(T,I),K=a(d,S);return React.useEffect(()=>(K.itemMap.set(I,{ref:I,...A}),()=>void K.itemMap.delete(I))),jsxRuntimeExports.jsx(m,{[p]:"",ref:j,children:P})});y.displayName=d;function b(E){const T=a(t+"CollectionConsumer",E);return React.useCallback(()=>{const P=T.collectionRef.current;if(!P)return[];const A=Array.from(P.querySelectorAll(`[${p}]`));return Array.from(T.itemMap.values()).sort((K,W)=>A.indexOf(K.ref.current)-A.indexOf(W.ref.current))},[T.collectionRef,T.itemMap])}return[{Provider:o,Slot:c,ItemSlot:y},b,n]}var DirectionContext=reactExports.createContext(void 0);function useDirection(t){const e=reactExports.useContext(DirectionContext);return t||e||"ltr"}function useCallbackRef$1(t){const e=reactExports.useRef(t);return reactExports.useEffect(()=>{e.current=t}),reactExports.useMemo(()=>(...r)=>{var n;return(n=e.current)==null?void 0:n.call(e,...r)},[])}function useEscapeKeydown(t,e=globalThis==null?void 0:globalThis.document){const r=useCallbackRef$1(t);reactExports.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[r,e])}var DISMISSABLE_LAYER_NAME="DismissableLayer",CONTEXT_UPDATE="dismissableLayer.update",POINTER_DOWN_OUTSIDE="dismissableLayer.pointerDownOutside",FOCUS_OUTSIDE="dismissableLayer.focusOutside",originalBodyPointerEvents,DismissableLayerContext=reactExports.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),DismissableLayer=reactExports.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:o,onDismiss:l,...u}=t,c=reactExports.useContext(DismissableLayerContext),[d,p]=reactExports.useState(null),m=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,y]=reactExports.useState({}),b=useComposedRefs(e,W=>p(W)),E=Array.from(c.layers),[T]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),S=E.indexOf(T),P=d?E.indexOf(d):-1,A=c.layersWithOutsidePointerEventsDisabled.size>0,I=P>=S,j=usePointerDownOutside(W=>{const H=W.target,ee=[...c.branches].some(ue=>ue.contains(H));!I||ee||(s==null||s(W),o==null||o(W),W.defaultPrevented||l==null||l())},m),K=useFocusOutside(W=>{const H=W.target;[...c.branches].some(ue=>ue.contains(H))||(a==null||a(W),o==null||o(W),W.defaultPrevented||l==null||l())},m);return useEscapeKeydown(W=>{P===c.layers.size-1&&(n==null||n(W),!W.defaultPrevented&&l&&(W.preventDefault(),l()))},m),reactExports.useEffect(()=>{if(d)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(originalBodyPointerEvents=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),dispatchUpdate(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=originalBodyPointerEvents)}},[d,m,r,c]),reactExports.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),dispatchUpdate())},[d,c]),reactExports.useEffect(()=>{const W=()=>y({});return document.addEventListener(CONTEXT_UPDATE,W),()=>document.removeEventListener(CONTEXT_UPDATE,W)},[]),jsxRuntimeExports.jsx(Primitive.div,{...u,ref:b,style:{pointerEvents:A?I?"auto":"none":void 0,...t.style},onFocusCapture:composeEventHandlers(t.onFocusCapture,K.onFocusCapture),onBlurCapture:composeEventHandlers(t.onBlurCapture,K.onBlurCapture),onPointerDownCapture:composeEventHandlers(t.onPointerDownCapture,j.onPointerDownCapture)})});DismissableLayer.displayName=DISMISSABLE_LAYER_NAME;var BRANCH_NAME="DismissableLayerBranch",DismissableLayerBranch=reactExports.forwardRef((t,e)=>{const r=reactExports.useContext(DismissableLayerContext),n=reactExports.useRef(null),s=useComposedRefs(e,n);return reactExports.useEffect(()=>{const a=n.current;if(a)return r.branches.add(a),()=>{r.branches.delete(a)}},[r.branches]),jsxRuntimeExports.jsx(Primitive.div,{...t,ref:s})});DismissableLayerBranch.displayName=BRANCH_NAME;function usePointerDownOutside(t,e=globalThis==null?void 0:globalThis.document){const r=useCallbackRef$1(t),n=reactExports.useRef(!1),s=reactExports.useRef(()=>{});return reactExports.useEffect(()=>{const a=l=>{if(l.target&&!n.current){let u=function(){handleAndDispatchCustomEvent(POINTER_DOWN_OUTSIDE,r,c,{discrete:!0})};const c={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=u,e.addEventListener("click",s.current,{once:!0})):u()}else e.removeEventListener("click",s.current);n.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",a),e.removeEventListener("click",s.current)}},[e,r]),{onPointerDownCapture:()=>n.current=!0}}function useFocusOutside(t,e=globalThis==null?void 0:globalThis.document){const r=useCallbackRef$1(t),n=reactExports.useRef(!1);return reactExports.useEffect(()=>{const s=a=>{a.target&&!n.current&&handleAndDispatchCustomEvent(FOCUS_OUTSIDE,r,{originalEvent:a},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function dispatchUpdate(){const t=new CustomEvent(CONTEXT_UPDATE);document.dispatchEvent(t)}function handleAndDispatchCustomEvent(t,e,r,{discrete:n}){const s=r.originalEvent.target,a=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&s.addEventListener(t,e,{once:!0}),n?dispatchDiscreteCustomEvent(s,a):s.dispatchEvent(a)}var count$3=0;function useFocusGuards(){reactExports.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??createFocusGuard()),document.body.insertAdjacentElement("beforeend",t[1]??createFocusGuard()),count$3++,()=>{count$3===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),count$3--}},[])}function createFocusGuard(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var AUTOFOCUS_ON_MOUNT="focusScope.autoFocusOnMount",AUTOFOCUS_ON_UNMOUNT="focusScope.autoFocusOnUnmount",EVENT_OPTIONS$1={bubbles:!1,cancelable:!0},FOCUS_SCOPE_NAME="FocusScope",FocusScope=reactExports.forwardRef((t,e)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:a,...o}=t,[l,u]=reactExports.useState(null),c=useCallbackRef$1(s),d=useCallbackRef$1(a),p=reactExports.useRef(null),m=useComposedRefs(e,E=>u(E)),y=reactExports.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;reactExports.useEffect(()=>{if(n){let E=function(A){if(y.paused||!l)return;const I=A.target;l.contains(I)?p.current=I:focus$1(p.current,{select:!0})},T=function(A){if(y.paused||!l)return;const I=A.relatedTarget;I!==null&&(l.contains(I)||focus$1(p.current,{select:!0}))},S=function(A){if(document.activeElement===document.body)for(const j of A)j.removedNodes.length>0&&focus$1(l)};document.addEventListener("focusin",E),document.addEventListener("focusout",T);const P=new MutationObserver(S);return l&&P.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",E),document.removeEventListener("focusout",T),P.disconnect()}}},[n,l,y.paused]),reactExports.useEffect(()=>{if(l){focusScopesStack.add(y);const E=document.activeElement;if(!l.contains(E)){const S=new CustomEvent(AUTOFOCUS_ON_MOUNT,EVENT_OPTIONS$1);l.addEventListener(AUTOFOCUS_ON_MOUNT,c),l.dispatchEvent(S),S.defaultPrevented||(focusFirst$2(removeLinks(getTabbableCandidates(l)),{select:!0}),document.activeElement===E&&focus$1(l))}return()=>{l.removeEventListener(AUTOFOCUS_ON_MOUNT,c),setTimeout(()=>{const S=new CustomEvent(AUTOFOCUS_ON_UNMOUNT,EVENT_OPTIONS$1);l.addEventListener(AUTOFOCUS_ON_UNMOUNT,d),l.dispatchEvent(S),S.defaultPrevented||focus$1(E??document.body,{select:!0}),l.removeEventListener(AUTOFOCUS_ON_UNMOUNT,d),focusScopesStack.remove(y)},0)}}},[l,c,d,y]);const b=reactExports.useCallback(E=>{if(!r&&!n||y.paused)return;const T=E.key==="Tab"&&!E.altKey&&!E.ctrlKey&&!E.metaKey,S=document.activeElement;if(T&&S){const P=E.currentTarget,[A,I]=getTabbableEdges(P);A&&I?!E.shiftKey&&S===I?(E.preventDefault(),r&&focus$1(A,{select:!0})):E.shiftKey&&S===A&&(E.preventDefault(),r&&focus$1(I,{select:!0})):S===P&&E.preventDefault()}},[r,n,y.paused]);return jsxRuntimeExports.jsx(Primitive.div,{tabIndex:-1,...o,ref:m,onKeyDown:b})});FocusScope.displayName=FOCUS_SCOPE_NAME;function focusFirst$2(t,{select:e=!1}={}){const r=document.activeElement;for(const n of t)if(focus$1(n,{select:e}),document.activeElement!==r)return}function getTabbableEdges(t){const e=getTabbableCandidates(t),r=findVisible(e,t),n=findVisible(e.reverse(),t);return[r,n]}function getTabbableCandidates(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function findVisible(t,e){for(const r of t)if(!isHidden(r,{upTo:e}))return r}function isHidden(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function isSelectableInput(t){return t instanceof HTMLInputElement&&"select"in t}function focus$1(t,{select:e=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&isSelectableInput(t)&&e&&t.select()}}var focusScopesStack=createFocusScopesStack();function createFocusScopesStack(){let t=[];return{add(e){const r=t[0];e!==r&&(r==null||r.pause()),t=arrayRemove(t,e),t.unshift(e)},remove(e){var r;t=arrayRemove(t,e),(r=t[0])==null||r.resume()}}}function arrayRemove(t,e){const r=[...t],n=r.indexOf(e);return n!==-1&&r.splice(n,1),r}function removeLinks(t){return t.filter(e=>e.tagName!=="A")}var useReactId=React$1[" useId ".trim().toString()]||(()=>{}),count$2=0;function useId(t){const[e,r]=reactExports.useState(useReactId());return useLayoutEffect2(()=>{r(n=>n??String(count$2++))},[t]),e?`radix-${e}`:""}const sides=["top","right","bottom","left"],min=Math.min,max=Math.max,round=Math.round,floor=Math.floor,createCoords=t=>({x:t,y:t}),oppositeSideMap={left:"right",right:"left",bottom:"top",top:"bottom"},oppositeAlignmentMap={start:"end",end:"start"};function clamp(t,e,r){return max(t,min(e,r))}function evaluate(t,e){return typeof t=="function"?t(e):t}function getSide(t){return t.split("-")[0]}function getAlignment(t){return t.split("-")[1]}function getOppositeAxis(t){return t==="x"?"y":"x"}function getAxisLength(t){return t==="y"?"height":"width"}function getSideAxis(t){return["top","bottom"].includes(getSide(t))?"y":"x"}function getAlignmentAxis(t){return getOppositeAxis(getSideAxis(t))}function getAlignmentSides(t,e,r){r===void 0&&(r=!1);const n=getAlignment(t),s=getAlignmentAxis(t),a=getAxisLength(s);let o=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[a]>e.floating[a]&&(o=getOppositePlacement(o)),[o,getOppositePlacement(o)]}function getExpandedPlacements(t){const e=getOppositePlacement(t);return[getOppositeAlignmentPlacement(t),e,getOppositeAlignmentPlacement(e)]}function getOppositeAlignmentPlacement(t){return t.replace(/start|end/g,e=>oppositeAlignmentMap[e])}function getSideList(t,e,r){const n=["left","right"],s=["right","left"],a=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return r?e?s:n:e?n:s;case"left":case"right":return e?a:o;default:return[]}}function getOppositeAxisPlacements(t,e,r,n){const s=getAlignment(t);let a=getSideList(getSide(t),r==="start",n);return s&&(a=a.map(o=>o+"-"+s),e&&(a=a.concat(a.map(getOppositeAlignmentPlacement)))),a}function getOppositePlacement(t){return t.replace(/left|right|bottom|top/g,e=>oppositeSideMap[e])}function expandPaddingObject(t){return{top:0,right:0,bottom:0,left:0,...t}}function getPaddingObject(t){return typeof t!="number"?expandPaddingObject(t):{top:t,right:t,bottom:t,left:t}}function rectToClientRect(t){const{x:e,y:r,width:n,height:s}=t;return{width:n,height:s,top:r,left:e,right:e+n,bottom:r+s,x:e,y:r}}function computeCoordsFromPlacement(t,e,r){let{reference:n,floating:s}=t;const a=getSideAxis(e),o=getAlignmentAxis(e),l=getAxisLength(o),u=getSide(e),c=a==="y",d=n.x+n.width/2-s.width/2,p=n.y+n.height/2-s.height/2,m=n[l]/2-s[l]/2;let y;switch(u){case"top":y={x:d,y:n.y-s.height};break;case"bottom":y={x:d,y:n.y+n.height};break;case"right":y={x:n.x+n.width,y:p};break;case"left":y={x:n.x-s.width,y:p};break;default:y={x:n.x,y:n.y}}switch(getAlignment(e)){case"start":y[o]-=m*(r&&c?-1:1);break;case"end":y[o]+=m*(r&&c?-1:1);break}return y}const computePosition$1=async(t,e,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:a=[],platform:o}=r,l=a.filter(Boolean),u=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:d,y:p}=computeCoordsFromPlacement(c,n,u),m=n,y={},b=0;for(let E=0;E<l.length;E++){const{name:T,fn:S}=l[E],{x:P,y:A,data:I,reset:j}=await S({x:d,y:p,initialPlacement:n,placement:m,strategy:s,middlewareData:y,rects:c,platform:o,elements:{reference:t,floating:e}});d=P??d,p=A??p,y={...y,[T]:{...y[T],...I}},j&&b<=50&&(b++,typeof j=="object"&&(j.placement&&(m=j.placement),j.rects&&(c=j.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):j.rects),{x:d,y:p}=computeCoordsFromPlacement(c,m,u)),E=-1)}return{x:d,y:p,placement:m,strategy:s,middlewareData:y}};async function detectOverflow(t,e){var r;e===void 0&&(e={});const{x:n,y:s,platform:a,rects:o,elements:l,strategy:u}=t,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:p="floating",altBoundary:m=!1,padding:y=0}=evaluate(e,t),b=getPaddingObject(y),T=l[m?p==="floating"?"reference":"floating":p],S=rectToClientRect(await a.getClippingRect({element:(r=await(a.isElement==null?void 0:a.isElement(T)))==null||r?T:T.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(l.floating)),boundary:c,rootBoundary:d,strategy:u})),P=p==="floating"?{x:n,y:s,width:o.floating.width,height:o.floating.height}:o.reference,A=await(a.getOffsetParent==null?void 0:a.getOffsetParent(l.floating)),I=await(a.isElement==null?void 0:a.isElement(A))?await(a.getScale==null?void 0:a.getScale(A))||{x:1,y:1}:{x:1,y:1},j=rectToClientRect(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:P,offsetParent:A,strategy:u}):P);return{top:(S.top-j.top+b.top)/I.y,bottom:(j.bottom-S.bottom+b.bottom)/I.y,left:(S.left-j.left+b.left)/I.x,right:(j.right-S.right+b.right)/I.x}}const arrow$3=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:n,placement:s,rects:a,platform:o,elements:l,middlewareData:u}=e,{element:c,padding:d=0}=evaluate(t,e)||{};if(c==null)return{};const p=getPaddingObject(d),m={x:r,y:n},y=getAlignmentAxis(s),b=getAxisLength(y),E=await o.getDimensions(c),T=y==="y",S=T?"top":"left",P=T?"bottom":"right",A=T?"clientHeight":"clientWidth",I=a.reference[b]+a.reference[y]-m[y]-a.floating[b],j=m[y]-a.reference[y],K=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let W=K?K[A]:0;(!W||!await(o.isElement==null?void 0:o.isElement(K)))&&(W=l.floating[A]||a.floating[b]);const H=I/2-j/2,ee=W/2-E[b]/2-1,ue=min(p[S],ee),de=min(p[P],ee),fe=ue,ae=W-E[b]-de,ce=W/2-E[b]/2+H,me=clamp(fe,ce,ae),te=!u.arrow&&getAlignment(s)!=null&&ce!==me&&a.reference[b]/2-(ce<fe?ue:de)-E[b]/2<0,le=te?ce<fe?ce-fe:ce-ae:0;return{[y]:m[y]+le,data:{[y]:me,centerOffset:ce-me-le,...te&&{alignmentOffset:le}},reset:te}}}),flip$2=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,n;const{placement:s,middlewareData:a,rects:o,initialPlacement:l,platform:u,elements:c}=e,{mainAxis:d=!0,crossAxis:p=!0,fallbackPlacements:m,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:E=!0,...T}=evaluate(t,e);if((r=a.arrow)!=null&&r.alignmentOffset)return{};const S=getSide(s),P=getSideAxis(l),A=getSide(l)===l,I=await(u.isRTL==null?void 0:u.isRTL(c.floating)),j=m||(A||!E?[getOppositePlacement(l)]:getExpandedPlacements(l)),K=b!=="none";!m&&K&&j.push(...getOppositeAxisPlacements(l,E,b,I));const W=[l,...j],H=await detectOverflow(e,T),ee=[];let ue=((n=a.flip)==null?void 0:n.overflows)||[];if(d&&ee.push(H[S]),p){const me=getAlignmentSides(s,o,I);ee.push(H[me[0]],H[me[1]])}if(ue=[...ue,{placement:s,overflows:ee}],!ee.every(me=>me<=0)){var de,fe;const me=(((de=a.flip)==null?void 0:de.index)||0)+1,te=W[me];if(te){var ae;const Z=p==="alignment"?P!==getSideAxis(te):!1,Y=((ae=ue[0])==null?void 0:ae.overflows[0])>0;if(!Z||Y)return{data:{index:me,overflows:ue},reset:{placement:te}}}let le=(fe=ue.filter(Z=>Z.overflows[0]<=0).sort((Z,Y)=>Z.overflows[1]-Y.overflows[1])[0])==null?void 0:fe.placement;if(!le)switch(y){case"bestFit":{var ce;const Z=(ce=ue.filter(Y=>{if(K){const he=getSideAxis(Y.placement);return he===P||he==="y"}return!0}).map(Y=>[Y.placement,Y.overflows.filter(he=>he>0).reduce((he,oe)=>he+oe,0)]).sort((Y,he)=>Y[1]-he[1])[0])==null?void 0:ce[0];Z&&(le=Z);break}case"initialPlacement":le=l;break}if(s!==le)return{reset:{placement:le}}}return{}}}};function getSideOffsets(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function isAnySideFullyClipped(t){return sides.some(e=>t[e]>=0)}const hide$2=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:r}=e,{strategy:n="referenceHidden",...s}=evaluate(t,e);switch(n){case"referenceHidden":{const a=await detectOverflow(e,{...s,elementContext:"reference"}),o=getSideOffsets(a,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:isAnySideFullyClipped(o)}}}case"escaped":{const a=await detectOverflow(e,{...s,altBoundary:!0}),o=getSideOffsets(a,r.floating);return{data:{escapedOffsets:o,escaped:isAnySideFullyClipped(o)}}}default:return{}}}}};async function convertValueToCoords(t,e){const{placement:r,platform:n,elements:s}=t,a=await(n.isRTL==null?void 0:n.isRTL(s.floating)),o=getSide(r),l=getAlignment(r),u=getSideAxis(r)==="y",c=["left","top"].includes(o)?-1:1,d=a&&u?-1:1,p=evaluate(e,t);let{mainAxis:m,crossAxis:y,alignmentAxis:b}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return l&&typeof b=="number"&&(y=l==="end"?b*-1:b),u?{x:y*d,y:m*c}:{x:m*c,y:y*d}}const offset$3=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,n;const{x:s,y:a,placement:o,middlewareData:l}=e,u=await convertValueToCoords(e,t);return o===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:s+u.x,y:a+u.y,data:{...u,placement:o}}}}},shift$3=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:n,placement:s}=e,{mainAxis:a=!0,crossAxis:o=!1,limiter:l={fn:T=>{let{x:S,y:P}=T;return{x:S,y:P}}},...u}=evaluate(t,e),c={x:r,y:n},d=await detectOverflow(e,u),p=getSideAxis(getSide(s)),m=getOppositeAxis(p);let y=c[m],b=c[p];if(a){const T=m==="y"?"top":"left",S=m==="y"?"bottom":"right",P=y+d[T],A=y-d[S];y=clamp(P,y,A)}if(o){const T=p==="y"?"top":"left",S=p==="y"?"bottom":"right",P=b+d[T],A=b-d[S];b=clamp(P,b,A)}const E=l.fn({...e,[m]:y,[p]:b});return{...E,data:{x:E.x-r,y:E.y-n,enabled:{[m]:a,[p]:o}}}}}},limitShift$2=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:r,y:n,placement:s,rects:a,middlewareData:o}=e,{offset:l=0,mainAxis:u=!0,crossAxis:c=!0}=evaluate(t,e),d={x:r,y:n},p=getSideAxis(s),m=getOppositeAxis(p);let y=d[m],b=d[p];const E=evaluate(l,e),T=typeof E=="number"?{mainAxis:E,crossAxis:0}:{mainAxis:0,crossAxis:0,...E};if(u){const A=m==="y"?"height":"width",I=a.reference[m]-a.floating[A]+T.mainAxis,j=a.reference[m]+a.reference[A]-T.mainAxis;y<I?y=I:y>j&&(y=j)}if(c){var S,P;const A=m==="y"?"width":"height",I=["top","left"].includes(getSide(s)),j=a.reference[p]-a.floating[A]+(I&&((S=o.offset)==null?void 0:S[p])||0)+(I?0:T.crossAxis),K=a.reference[p]+a.reference[A]+(I?0:((P=o.offset)==null?void 0:P[p])||0)-(I?T.crossAxis:0);b<j?b=j:b>K&&(b=K)}return{[m]:y,[p]:b}}}},size$2=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,n;const{placement:s,rects:a,platform:o,elements:l}=e,{apply:u=()=>{},...c}=evaluate(t,e),d=await detectOverflow(e,c),p=getSide(s),m=getAlignment(s),y=getSideAxis(s)==="y",{width:b,height:E}=a.floating;let T,S;p==="top"||p==="bottom"?(T=p,S=m===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(S=p,T=m==="end"?"top":"bottom");const P=E-d.top-d.bottom,A=b-d.left-d.right,I=min(E-d[T],P),j=min(b-d[S],A),K=!e.middlewareData.shift;let W=I,H=j;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(H=A),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(W=P),K&&!m){const ue=max(d.left,0),de=max(d.right,0),fe=max(d.top,0),ae=max(d.bottom,0);y?H=b-2*(ue!==0||de!==0?ue+de:max(d.left,d.right)):W=E-2*(fe!==0||ae!==0?fe+ae:max(d.top,d.bottom))}await u({...e,availableWidth:H,availableHeight:W});const ee=await o.getDimensions(l.floating);return b!==ee.width||E!==ee.height?{reset:{rects:!0}}:{}}}};function hasWindow(){return typeof window<"u"}function getNodeName(t){return isNode(t)?(t.nodeName||"").toLowerCase():"#document"}function getWindow(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function getDocumentElement$1(t){var e;return(e=(isNode(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function isNode(t){return hasWindow()?t instanceof Node||t instanceof getWindow(t).Node:!1}function isElement$1(t){return hasWindow()?t instanceof Element||t instanceof getWindow(t).Element:!1}function isHTMLElement(t){return hasWindow()?t instanceof HTMLElement||t instanceof getWindow(t).HTMLElement:!1}function isShadowRoot(t){return!hasWindow()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof getWindow(t).ShadowRoot}function isOverflowElement(t){const{overflow:e,overflowX:r,overflowY:n,display:s}=getComputedStyle$1(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!["inline","contents"].includes(s)}function isTableElement(t){return["table","td","th"].includes(getNodeName(t))}function isTopLayer(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function isContainingBlock(t){const e=isWebKit(),r=isElement$1(t)?getComputedStyle$1(t):t;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function getContainingBlock(t){let e=getParentNode(t);for(;isHTMLElement(e)&&!isLastTraversableNode(e);){if(isContainingBlock(e))return e;if(isTopLayer(e))return null;e=getParentNode(e)}return null}function isWebKit(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function isLastTraversableNode(t){return["html","body","#document"].includes(getNodeName(t))}function getComputedStyle$1(t){return getWindow(t).getComputedStyle(t)}function getNodeScroll(t){return isElement$1(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function getParentNode(t){if(getNodeName(t)==="html")return t;const e=t.assignedSlot||t.parentNode||isShadowRoot(t)&&t.host||getDocumentElement$1(t);return isShadowRoot(e)?e.host:e}function getNearestOverflowAncestor(t){const e=getParentNode(t);return isLastTraversableNode(e)?t.ownerDocument?t.ownerDocument.body:t.body:isHTMLElement(e)&&isOverflowElement(e)?e:getNearestOverflowAncestor(e)}function getOverflowAncestors(t,e,r){var n;e===void 0&&(e=[]),r===void 0&&(r=!0);const s=getNearestOverflowAncestor(t),a=s===((n=t.ownerDocument)==null?void 0:n.body),o=getWindow(s);if(a){const l=getFrameElement(o);return e.concat(o,o.visualViewport||[],isOverflowElement(s)?s:[],l&&r?getOverflowAncestors(l):[])}return e.concat(s,getOverflowAncestors(s,[],r))}function getFrameElement(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function getCssDimensions(t){const e=getComputedStyle$1(t);let r=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const s=isHTMLElement(t),a=s?t.offsetWidth:r,o=s?t.offsetHeight:n,l=round(r)!==a||round(n)!==o;return l&&(r=a,n=o),{width:r,height:n,$:l}}function unwrapElement(t){return isElement$1(t)?t:t.contextElement}function getScale(t){const e=unwrapElement(t);if(!isHTMLElement(e))return createCoords(1);const r=e.getBoundingClientRect(),{width:n,height:s,$:a}=getCssDimensions(e);let o=(a?round(r.width):r.width)/n,l=(a?round(r.height):r.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const noOffsets=createCoords(0);function getVisualOffsets(t){const e=getWindow(t);return!isWebKit()||!e.visualViewport?noOffsets:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function shouldAddVisualOffsets(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==getWindow(t)?!1:e}function getBoundingClientRect(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);const s=t.getBoundingClientRect(),a=unwrapElement(t);let o=createCoords(1);e&&(n?isElement$1(n)&&(o=getScale(n)):o=getScale(t));const l=shouldAddVisualOffsets(a,r,n)?getVisualOffsets(a):createCoords(0);let u=(s.left+l.x)/o.x,c=(s.top+l.y)/o.y,d=s.width/o.x,p=s.height/o.y;if(a){const m=getWindow(a),y=n&&isElement$1(n)?getWindow(n):n;let b=m,E=getFrameElement(b);for(;E&&n&&y!==b;){const T=getScale(E),S=E.getBoundingClientRect(),P=getComputedStyle$1(E),A=S.left+(E.clientLeft+parseFloat(P.paddingLeft))*T.x,I=S.top+(E.clientTop+parseFloat(P.paddingTop))*T.y;u*=T.x,c*=T.y,d*=T.x,p*=T.y,u+=A,c+=I,b=getWindow(E),E=getFrameElement(b)}}return rectToClientRect({width:d,height:p,x:u,y:c})}function getWindowScrollBarX(t,e){const r=getNodeScroll(t).scrollLeft;return e?e.left+r:getBoundingClientRect(getDocumentElement$1(t)).left+r}function getHTMLOffset(t,e,r){r===void 0&&(r=!1);const n=t.getBoundingClientRect(),s=n.left+e.scrollLeft-(r?0:getWindowScrollBarX(t,n)),a=n.top+e.scrollTop;return{x:s,y:a}}function convertOffsetParentRelativeRectToViewportRelativeRect(t){let{elements:e,rect:r,offsetParent:n,strategy:s}=t;const a=s==="fixed",o=getDocumentElement$1(n),l=e?isTopLayer(e.floating):!1;if(n===o||l&&a)return r;let u={scrollLeft:0,scrollTop:0},c=createCoords(1);const d=createCoords(0),p=isHTMLElement(n);if((p||!p&&!a)&&((getNodeName(n)!=="body"||isOverflowElement(o))&&(u=getNodeScroll(n)),isHTMLElement(n))){const y=getBoundingClientRect(n);c=getScale(n),d.x=y.x+n.clientLeft,d.y=y.y+n.clientTop}const m=o&&!p&&!a?getHTMLOffset(o,u,!0):createCoords(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-u.scrollLeft*c.x+d.x+m.x,y:r.y*c.y-u.scrollTop*c.y+d.y+m.y}}function getClientRects(t){return Array.from(t.getClientRects())}function getDocumentRect(t){const e=getDocumentElement$1(t),r=getNodeScroll(t),n=t.ownerDocument.body,s=max(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),a=max(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+getWindowScrollBarX(t);const l=-r.scrollTop;return getComputedStyle$1(n).direction==="rtl"&&(o+=max(e.clientWidth,n.clientWidth)-s),{width:s,height:a,x:o,y:l}}function getViewportRect(t,e){const r=getWindow(t),n=getDocumentElement$1(t),s=r.visualViewport;let a=n.clientWidth,o=n.clientHeight,l=0,u=0;if(s){a=s.width,o=s.height;const c=isWebKit();(!c||c&&e==="fixed")&&(l=s.offsetLeft,u=s.offsetTop)}return{width:a,height:o,x:l,y:u}}function getInnerBoundingClientRect(t,e){const r=getBoundingClientRect(t,!0,e==="fixed"),n=r.top+t.clientTop,s=r.left+t.clientLeft,a=isHTMLElement(t)?getScale(t):createCoords(1),o=t.clientWidth*a.x,l=t.clientHeight*a.y,u=s*a.x,c=n*a.y;return{width:o,height:l,x:u,y:c}}function getClientRectFromClippingAncestor(t,e,r){let n;if(e==="viewport")n=getViewportRect(t,r);else if(e==="document")n=getDocumentRect(getDocumentElement$1(t));else if(isElement$1(e))n=getInnerBoundingClientRect(e,r);else{const s=getVisualOffsets(t);n={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return rectToClientRect(n)}function hasFixedPositionAncestor(t,e){const r=getParentNode(t);return r===e||!isElement$1(r)||isLastTraversableNode(r)?!1:getComputedStyle$1(r).position==="fixed"||hasFixedPositionAncestor(r,e)}function getClippingElementAncestors(t,e){const r=e.get(t);if(r)return r;let n=getOverflowAncestors(t,[],!1).filter(l=>isElement$1(l)&&getNodeName(l)!=="body"),s=null;const a=getComputedStyle$1(t).position==="fixed";let o=a?getParentNode(t):t;for(;isElement$1(o)&&!isLastTraversableNode(o);){const l=getComputedStyle$1(o),u=isContainingBlock(o);!u&&l.position==="fixed"&&(s=null),(a?!u&&!s:!u&&l.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||isOverflowElement(o)&&!u&&hasFixedPositionAncestor(t,o))?n=n.filter(d=>d!==o):s=l,o=getParentNode(o)}return e.set(t,n),n}function getClippingRect(t){let{element:e,boundary:r,rootBoundary:n,strategy:s}=t;const o=[...r==="clippingAncestors"?isTopLayer(e)?[]:getClippingElementAncestors(e,this._c):[].concat(r),n],l=o[0],u=o.reduce((c,d)=>{const p=getClientRectFromClippingAncestor(e,d,s);return c.top=max(p.top,c.top),c.right=min(p.right,c.right),c.bottom=min(p.bottom,c.bottom),c.left=max(p.left,c.left),c},getClientRectFromClippingAncestor(e,l,s));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function getDimensions(t){const{width:e,height:r}=getCssDimensions(t);return{width:e,height:r}}function getRectRelativeToOffsetParent(t,e,r){const n=isHTMLElement(e),s=getDocumentElement$1(e),a=r==="fixed",o=getBoundingClientRect(t,!0,a,e);let l={scrollLeft:0,scrollTop:0};const u=createCoords(0);function c(){u.x=getWindowScrollBarX(s)}if(n||!n&&!a)if((getNodeName(e)!=="body"||isOverflowElement(s))&&(l=getNodeScroll(e)),n){const y=getBoundingClientRect(e,!0,a,e);u.x=y.x+e.clientLeft,u.y=y.y+e.clientTop}else s&&c();a&&!n&&s&&c();const d=s&&!n&&!a?getHTMLOffset(s,l):createCoords(0),p=o.left+l.scrollLeft-u.x-d.x,m=o.top+l.scrollTop-u.y-d.y;return{x:p,y:m,width:o.width,height:o.height}}function isStaticPositioned(t){return getComputedStyle$1(t).position==="static"}function getTrueOffsetParent(t,e){if(!isHTMLElement(t)||getComputedStyle$1(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return getDocumentElement$1(t)===r&&(r=r.ownerDocument.body),r}function getOffsetParent(t,e){const r=getWindow(t);if(isTopLayer(t))return r;if(!isHTMLElement(t)){let s=getParentNode(t);for(;s&&!isLastTraversableNode(s);){if(isElement$1(s)&&!isStaticPositioned(s))return s;s=getParentNode(s)}return r}let n=getTrueOffsetParent(t,e);for(;n&&isTableElement(n)&&isStaticPositioned(n);)n=getTrueOffsetParent(n,e);return n&&isLastTraversableNode(n)&&isStaticPositioned(n)&&!isContainingBlock(n)?r:n||getContainingBlock(t)||r}const getElementRects=async function(t){const e=this.getOffsetParent||getOffsetParent,r=this.getDimensions,n=await r(t.floating);return{reference:getRectRelativeToOffsetParent(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function isRTL(t){return getComputedStyle$1(t).direction==="rtl"}const platform={convertOffsetParentRelativeRectToViewportRelativeRect,getDocumentElement:getDocumentElement$1,getClippingRect,getOffsetParent,getElementRects,getClientRects,getDimensions,getScale,isElement:isElement$1,isRTL};function rectsAreEqual(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function observeMove(t,e){let r=null,n;const s=getDocumentElement$1(t);function a(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function o(l,u){l===void 0&&(l=!1),u===void 0&&(u=1),a();const c=t.getBoundingClientRect(),{left:d,top:p,width:m,height:y}=c;if(l||e(),!m||!y)return;const b=floor(p),E=floor(s.clientWidth-(d+m)),T=floor(s.clientHeight-(p+y)),S=floor(d),A={rootMargin:-b+"px "+-E+"px "+-T+"px "+-S+"px",threshold:max(0,min(1,u))||1};let I=!0;function j(K){const W=K[0].intersectionRatio;if(W!==u){if(!I)return o();W?o(!1,W):n=setTimeout(()=>{o(!1,1e-7)},1e3)}W===1&&!rectsAreEqual(c,t.getBoundingClientRect())&&o(),I=!1}try{r=new IntersectionObserver(j,{...A,root:s.ownerDocument})}catch{r=new IntersectionObserver(j,A)}r.observe(t)}return o(!0),a}function autoUpdate(t,e,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:u=!1}=n,c=unwrapElement(t),d=s||a?[...c?getOverflowAncestors(c):[],...getOverflowAncestors(e)]:[];d.forEach(S=>{s&&S.addEventListener("scroll",r,{passive:!0}),a&&S.addEventListener("resize",r)});const p=c&&l?observeMove(c,r):null;let m=-1,y=null;o&&(y=new ResizeObserver(S=>{let[P]=S;P&&P.target===c&&y&&(y.unobserve(e),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var A;(A=y)==null||A.observe(e)})),r()}),c&&!u&&y.observe(c),y.observe(e));let b,E=u?getBoundingClientRect(t):null;u&&T();function T(){const S=getBoundingClientRect(t);E&&!rectsAreEqual(E,S)&&r(),E=S,b=requestAnimationFrame(T)}return r(),()=>{var S;d.forEach(P=>{s&&P.removeEventListener("scroll",r),a&&P.removeEventListener("resize",r)}),p==null||p(),(S=y)==null||S.disconnect(),y=null,u&&cancelAnimationFrame(b)}}const offset$2=offset$3,shift$2=shift$3,flip$1=flip$2,size$1=size$2,hide$1=hide$2,arrow$2=arrow$3,limitShift$1=limitShift$2,computePosition=(t,e,r)=>{const n=new Map,s={platform,...r},a={...s.platform,_c:n};return computePosition$1(t,e,{...s,platform:a})};var index=typeof document<"u"?reactExports.useLayoutEffect:reactExports.useEffect;function deepEqual(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,n,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(n=r;n--!==0;)if(!deepEqual(t[n],e[n]))return!1;return!0}if(s=Object.keys(t),r=s.length,r!==Object.keys(e).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(e,s[n]))return!1;for(n=r;n--!==0;){const a=s[n];if(!(a==="_owner"&&t.$$typeof)&&!deepEqual(t[a],e[a]))return!1}return!0}return t!==t&&e!==e}function getDPR(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function roundByDPR(t,e){const r=getDPR(t);return Math.round(e*r)/r}function useLatestRef(t){const e=reactExports.useRef(t);return index(()=>{e.current=t}),e}function useFloating(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:a,floating:o}={},transform:l=!0,whileElementsMounted:u,open:c}=t,[d,p]=reactExports.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[m,y]=reactExports.useState(n);deepEqual(m,n)||y(n);const[b,E]=reactExports.useState(null),[T,S]=reactExports.useState(null),P=reactExports.useCallback(Z=>{Z!==K.current&&(K.current=Z,E(Z))},[]),A=reactExports.useCallback(Z=>{Z!==W.current&&(W.current=Z,S(Z))},[]),I=a||b,j=o||T,K=reactExports.useRef(null),W=reactExports.useRef(null),H=reactExports.useRef(d),ee=u!=null,ue=useLatestRef(u),de=useLatestRef(s),fe=useLatestRef(c),ae=reactExports.useCallback(()=>{if(!K.current||!W.current)return;const Z={placement:e,strategy:r,middleware:m};de.current&&(Z.platform=de.current),computePosition(K.current,W.current,Z).then(Y=>{const he={...Y,isPositioned:fe.current!==!1};ce.current&&!deepEqual(H.current,he)&&(H.current=he,reactDomExports.flushSync(()=>{p(he)}))})},[m,e,r,de,fe]);index(()=>{c===!1&&H.current.isPositioned&&(H.current.isPositioned=!1,p(Z=>({...Z,isPositioned:!1})))},[c]);const ce=reactExports.useRef(!1);index(()=>(ce.current=!0,()=>{ce.current=!1}),[]),index(()=>{if(I&&(K.current=I),j&&(W.current=j),I&&j){if(ue.current)return ue.current(I,j,ae);ae()}},[I,j,ae,ue,ee]);const me=reactExports.useMemo(()=>({reference:K,floating:W,setReference:P,setFloating:A}),[P,A]),te=reactExports.useMemo(()=>({reference:I,floating:j}),[I,j]),le=reactExports.useMemo(()=>{const Z={position:r,left:0,top:0};if(!te.floating)return Z;const Y=roundByDPR(te.floating,d.x),he=roundByDPR(te.floating,d.y);return l?{...Z,transform:"translate("+Y+"px, "+he+"px)",...getDPR(te.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:Y,top:he}},[r,l,te.floating,d.x,d.y]);return reactExports.useMemo(()=>({...d,update:ae,refs:me,elements:te,floatingStyles:le}),[d,ae,me,te,le])}const arrow$1=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:n,padding:s}=typeof t=="function"?t(r):t;return n&&e(n)?n.current!=null?arrow$2({element:n.current,padding:s}).fn(r):{}:n?arrow$2({element:n,padding:s}).fn(r):{}}}},offset$1=(t,e)=>({...offset$2(t),options:[t,e]}),shift$1=(t,e)=>({...shift$2(t),options:[t,e]}),limitShift=(t,e)=>({...limitShift$1(t),options:[t,e]}),flip=(t,e)=>({...flip$1(t),options:[t,e]}),size=(t,e)=>({...size$1(t),options:[t,e]}),hide=(t,e)=>({...hide$1(t),options:[t,e]}),arrow=(t,e)=>({...arrow$1(t),options:[t,e]});var NAME$1="Arrow",Arrow$1=reactExports.forwardRef((t,e)=>{const{children:r,width:n=10,height:s=5,...a}=t;return jsxRuntimeExports.jsx(Primitive.svg,{...a,ref:e,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:jsxRuntimeExports.jsx("polygon",{points:"0,0 30,0 15,10"})})});Arrow$1.displayName=NAME$1;var Root$2=Arrow$1;function useSize(t){const[e,r]=reactExports.useState(void 0);return useLayoutEffect2(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const a=s[0];let o,l;if("borderBoxSize"in a){const u=a.borderBoxSize,c=Array.isArray(u)?u[0]:u;o=c.inlineSize,l=c.blockSize}else o=t.offsetWidth,l=t.offsetHeight;r({width:o,height:l})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else r(void 0)},[t]),e}var POPPER_NAME="Popper",[createPopperContext,createPopperScope]=createContextScope(POPPER_NAME),[PopperProvider,usePopperContext]=createPopperContext(POPPER_NAME),Popper=t=>{const{__scopePopper:e,children:r}=t,[n,s]=reactExports.useState(null);return jsxRuntimeExports.jsx(PopperProvider,{scope:e,anchor:n,onAnchorChange:s,children:r})};Popper.displayName=POPPER_NAME;var ANCHOR_NAME$1="PopperAnchor",PopperAnchor=reactExports.forwardRef((t,e)=>{const{__scopePopper:r,virtualRef:n,...s}=t,a=usePopperContext(ANCHOR_NAME$1,r),o=reactExports.useRef(null),l=useComposedRefs(e,o);return reactExports.useEffect(()=>{a.onAnchorChange((n==null?void 0:n.current)||o.current)}),n?null:jsxRuntimeExports.jsx(Primitive.div,{...s,ref:l})});PopperAnchor.displayName=ANCHOR_NAME$1;var CONTENT_NAME$3="PopperContent",[PopperContentProvider,useContentContext]=createPopperContext(CONTENT_NAME$3),PopperContent=reactExports.forwardRef((t,e)=>{var Ve,Pe,Ce,De,ze,Et;const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:a="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:u=!0,collisionBoundary:c=[],collisionPadding:d=0,sticky:p="partial",hideWhenDetached:m=!1,updatePositionStrategy:y="optimized",onPlaced:b,...E}=t,T=usePopperContext(CONTENT_NAME$3,r),[S,P]=reactExports.useState(null),A=useComposedRefs(e,Ze=>P(Ze)),[I,j]=reactExports.useState(null),K=useSize(I),W=(K==null?void 0:K.width)??0,H=(K==null?void 0:K.height)??0,ee=n+(a!=="center"?"-"+a:""),ue=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},de=Array.isArray(c)?c:[c],fe=de.length>0,ae={padding:ue,boundary:de.filter(isNotNull),altBoundary:fe},{refs:ce,floatingStyles:me,placement:te,isPositioned:le,middlewareData:Z}=useFloating({strategy:"fixed",placement:ee,whileElementsMounted:(...Ze)=>autoUpdate(...Ze,{animationFrame:y==="always"}),elements:{reference:T.anchor},middleware:[offset$1({mainAxis:s+H,alignmentAxis:o}),u&&shift$1({mainAxis:!0,crossAxis:!1,limiter:p==="partial"?limitShift():void 0,...ae}),u&&flip({...ae}),size({...ae,apply:({elements:Ze,rects:Ue,availableWidth:qt,availableHeight:or})=>{const{width:Lt,height:rt}=Ue.reference,lr=Ze.floating.style;lr.setProperty("--radix-popper-available-width",`${qt}px`),lr.setProperty("--radix-popper-available-height",`${or}px`),lr.setProperty("--radix-popper-anchor-width",`${Lt}px`),lr.setProperty("--radix-popper-anchor-height",`${rt}px`)}}),I&&arrow({element:I,padding:l}),transformOrigin({arrowWidth:W,arrowHeight:H}),m&&hide({strategy:"referenceHidden",...ae})]}),[Y,he]=getSideAndAlignFromPlacement(te),oe=useCallbackRef$1(b);useLayoutEffect2(()=>{le&&(oe==null||oe())},[le,oe]);const ye=(Ve=Z.arrow)==null?void 0:Ve.x,Ee=(Pe=Z.arrow)==null?void 0:Pe.y,Ae=((Ce=Z.arrow)==null?void 0:Ce.centerOffset)!==0,[je,Te]=reactExports.useState();return useLayoutEffect2(()=>{S&&Te(window.getComputedStyle(S).zIndex)},[S]),jsxRuntimeExports.jsx("div",{ref:ce.setFloating,"data-radix-popper-content-wrapper":"",style:{...me,transform:le?me.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:je,"--radix-popper-transform-origin":[(De=Z.transformOrigin)==null?void 0:De.x,(ze=Z.transformOrigin)==null?void 0:ze.y].join(" "),...((Et=Z.hide)==null?void 0:Et.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:jsxRuntimeExports.jsx(PopperContentProvider,{scope:r,placedSide:Y,onArrowChange:j,arrowX:ye,arrowY:Ee,shouldHideArrow:Ae,children:jsxRuntimeExports.jsx(Primitive.div,{"data-side":Y,"data-align":he,...E,ref:A,style:{...E.style,animation:le?void 0:"none"}})})})});PopperContent.displayName=CONTENT_NAME$3;var ARROW_NAME$3="PopperArrow",OPPOSITE_SIDE={top:"bottom",right:"left",bottom:"top",left:"right"},PopperArrow=reactExports.forwardRef(function t(e,r){const{__scopePopper:n,...s}=e,a=useContentContext(ARROW_NAME$3,n),o=OPPOSITE_SIDE[a.placedSide];return jsxRuntimeExports.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:jsxRuntimeExports.jsx(Root$2,{...s,ref:r,style:{...s.style,display:"block"}})})});PopperArrow.displayName=ARROW_NAME$3;function isNotNull(t){return t!==null}var transformOrigin=t=>({name:"transformOrigin",options:t,fn(e){var T,S,P;const{placement:r,rects:n,middlewareData:s}=e,o=((T=s.arrow)==null?void 0:T.centerOffset)!==0,l=o?0:t.arrowWidth,u=o?0:t.arrowHeight,[c,d]=getSideAndAlignFromPlacement(r),p={start:"0%",center:"50%",end:"100%"}[d],m=(((S=s.arrow)==null?void 0:S.x)??0)+l/2,y=(((P=s.arrow)==null?void 0:P.y)??0)+u/2;let b="",E="";return c==="bottom"?(b=o?p:`${m}px`,E=`${-u}px`):c==="top"?(b=o?p:`${m}px`,E=`${n.floating.height+u}px`):c==="right"?(b=`${-u}px`,E=o?p:`${y}px`):c==="left"&&(b=`${n.floating.width+u}px`,E=o?p:`${y}px`),{data:{x:b,y:E}}}});function getSideAndAlignFromPlacement(t){const[e,r="center"]=t.split("-");return[e,r]}var Root2$1=Popper,Anchor=PopperAnchor,Content=PopperContent,Arrow=PopperArrow,PORTAL_NAME$3="Portal",Portal$2=reactExports.forwardRef((t,e)=>{var l;const{container:r,...n}=t,[s,a]=reactExports.useState(!1);useLayoutEffect2(()=>a(!0),[]);const o=r||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?ReactDOM.createPortal(jsxRuntimeExports.jsx(Primitive.div,{...n,ref:e}),o):null});Portal$2.displayName=PORTAL_NAME$3;function useStateMachine(t,e){return reactExports.useReducer((r,n)=>e[r][n]??r,t)}var Presence=t=>{const{present:e,children:r}=t,n=usePresence(e),s=typeof r=="function"?r({present:n.isPresent}):reactExports.Children.only(r),a=useComposedRefs(n.ref,getElementRef(s));return typeof r=="function"||n.isPresent?reactExports.cloneElement(s,{ref:a}):null};Presence.displayName="Presence";function usePresence(t){const[e,r]=reactExports.useState(),n=reactExports.useRef(null),s=reactExports.useRef(t),a=reactExports.useRef("none"),o=t?"mounted":"unmounted",[l,u]=useStateMachine(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return reactExports.useEffect(()=>{const c=getAnimationName(n.current);a.current=l==="mounted"?c:"none"},[l]),useLayoutEffect2(()=>{const c=n.current,d=s.current;if(d!==t){const m=a.current,y=getAnimationName(c);t?u("MOUNT"):y==="none"||(c==null?void 0:c.display)==="none"?u("UNMOUNT"):u(d&&m!==y?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,u]),useLayoutEffect2(()=>{if(e){let c;const d=e.ownerDocument.defaultView??window,p=y=>{const E=getAnimationName(n.current).includes(y.animationName);if(y.target===e&&E&&(u("ANIMATION_END"),!s.current)){const T=e.style.animationFillMode;e.style.animationFillMode="forwards",c=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=T)})}},m=y=>{y.target===e&&(a.current=getAnimationName(n.current))};return e.addEventListener("animationstart",m),e.addEventListener("animationcancel",p),e.addEventListener("animationend",p),()=>{d.clearTimeout(c),e.removeEventListener("animationstart",m),e.removeEventListener("animationcancel",p),e.removeEventListener("animationend",p)}}else u("ANIMATION_END")},[e,u]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:reactExports.useCallback(c=>{n.current=c?getComputedStyle(c):null,r(c)},[])}}function getAnimationName(t){return(t==null?void 0:t.animationName)||"none"}function getElementRef(t){var n,s;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var ENTRY_FOCUS="rovingFocusGroup.onEntryFocus",EVENT_OPTIONS={bubbles:!1,cancelable:!0},GROUP_NAME$2="RovingFocusGroup",[Collection$1,useCollection$1,createCollectionScope$1]=createCollection(GROUP_NAME$2),[createRovingFocusGroupContext,createRovingFocusGroupScope]=createContextScope(GROUP_NAME$2,[createCollectionScope$1]),[RovingFocusProvider,useRovingFocusContext]=createRovingFocusGroupContext(GROUP_NAME$2),RovingFocusGroup=reactExports.forwardRef((t,e)=>jsxRuntimeExports.jsx(Collection$1.Provider,{scope:t.__scopeRovingFocusGroup,children:jsxRuntimeExports.jsx(Collection$1.Slot,{scope:t.__scopeRovingFocusGroup,children:jsxRuntimeExports.jsx(RovingFocusGroupImpl,{...t,ref:e})})}));RovingFocusGroup.displayName=GROUP_NAME$2;var RovingFocusGroupImpl=reactExports.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:s=!1,dir:a,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:u,onEntryFocus:c,preventScrollOnEntryFocus:d=!1,...p}=t,m=reactExports.useRef(null),y=useComposedRefs(e,m),b=useDirection(a),[E,T]=useControllableState({prop:o,defaultProp:l??null,onChange:u,caller:GROUP_NAME$2}),[S,P]=reactExports.useState(!1),A=useCallbackRef$1(c),I=useCollection$1(r),j=reactExports.useRef(!1),[K,W]=reactExports.useState(0);return reactExports.useEffect(()=>{const H=m.current;if(H)return H.addEventListener(ENTRY_FOCUS,A),()=>H.removeEventListener(ENTRY_FOCUS,A)},[A]),jsxRuntimeExports.jsx(RovingFocusProvider,{scope:r,orientation:n,dir:b,loop:s,currentTabStopId:E,onItemFocus:reactExports.useCallback(H=>T(H),[T]),onItemShiftTab:reactExports.useCallback(()=>P(!0),[]),onFocusableItemAdd:reactExports.useCallback(()=>W(H=>H+1),[]),onFocusableItemRemove:reactExports.useCallback(()=>W(H=>H-1),[]),children:jsxRuntimeExports.jsx(Primitive.div,{tabIndex:S||K===0?-1:0,"data-orientation":n,...p,ref:y,style:{outline:"none",...t.style},onMouseDown:composeEventHandlers(t.onMouseDown,()=>{j.current=!0}),onFocus:composeEventHandlers(t.onFocus,H=>{const ee=!j.current;if(H.target===H.currentTarget&&ee&&!S){const ue=new CustomEvent(ENTRY_FOCUS,EVENT_OPTIONS);if(H.currentTarget.dispatchEvent(ue),!ue.defaultPrevented){const de=I().filter(te=>te.focusable),fe=de.find(te=>te.active),ae=de.find(te=>te.id===E),me=[fe,ae,...de].filter(Boolean).map(te=>te.ref.current);focusFirst$1(me,d)}}j.current=!1}),onBlur:composeEventHandlers(t.onBlur,()=>P(!1))})})}),ITEM_NAME$2="RovingFocusGroupItem",RovingFocusGroupItem=reactExports.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:s=!1,tabStopId:a,children:o,...l}=t,u=useId(),c=a||u,d=useRovingFocusContext(ITEM_NAME$2,r),p=d.currentTabStopId===c,m=useCollection$1(r),{onFocusableItemAdd:y,onFocusableItemRemove:b,currentTabStopId:E}=d;return reactExports.useEffect(()=>{if(n)return y(),()=>b()},[n,y,b]),jsxRuntimeExports.jsx(Collection$1.ItemSlot,{scope:r,id:c,focusable:n,active:s,children:jsxRuntimeExports.jsx(Primitive.span,{tabIndex:p?0:-1,"data-orientation":d.orientation,...l,ref:e,onMouseDown:composeEventHandlers(t.onMouseDown,T=>{n?d.onItemFocus(c):T.preventDefault()}),onFocus:composeEventHandlers(t.onFocus,()=>d.onItemFocus(c)),onKeyDown:composeEventHandlers(t.onKeyDown,T=>{if(T.key==="Tab"&&T.shiftKey){d.onItemShiftTab();return}if(T.target!==T.currentTarget)return;const S=getFocusIntent(T,d.orientation,d.dir);if(S!==void 0){if(T.metaKey||T.ctrlKey||T.altKey||T.shiftKey)return;T.preventDefault();let A=m().filter(I=>I.focusable).map(I=>I.ref.current);if(S==="last")A.reverse();else if(S==="prev"||S==="next"){S==="prev"&&A.reverse();const I=A.indexOf(T.currentTarget);A=d.loop?wrapArray$1(A,I+1):A.slice(I+1)}setTimeout(()=>focusFirst$1(A))}}),children:typeof o=="function"?o({isCurrentTabStop:p,hasTabStop:E!=null}):o})})});RovingFocusGroupItem.displayName=ITEM_NAME$2;var MAP_KEY_TO_FOCUS_INTENT={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function getDirectionAwareKey(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function getFocusIntent(t,e,r){const n=getDirectionAwareKey(t.key,r);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return MAP_KEY_TO_FOCUS_INTENT[n]}function focusFirst$1(t,e=!1){const r=document.activeElement;for(const n of t)if(n===r||(n.focus({preventScroll:e}),document.activeElement!==r))return}function wrapArray$1(t,e){return t.map((r,n)=>t[(e+n)%t.length])}var Root$1=RovingFocusGroup,Item=RovingFocusGroupItem,getDefaultParent=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={},lockCount=0,unwrapHost=function(t){return t&&(t.host||unwrapHost(t.parentNode))},correctTargets=function(t,e){return e.map(function(r){if(t.contains(r))return r;var n=unwrapHost(r);return n&&t.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},applyAttributeToOthers=function(t,e,r,n){var s=correctTargets(e,Array.isArray(t)?t:[t]);markerMap[r]||(markerMap[r]=new WeakMap);var a=markerMap[r],o=[],l=new Set,u=new Set(s),c=function(p){!p||l.has(p)||(l.add(p),c(p.parentNode))};s.forEach(c);var d=function(p){!p||u.has(p)||Array.prototype.forEach.call(p.children,function(m){if(l.has(m))d(m);else try{var y=m.getAttribute(n),b=y!==null&&y!=="false",E=(counterMap.get(m)||0)+1,T=(a.get(m)||0)+1;counterMap.set(m,E),a.set(m,T),o.push(m),E===1&&b&&uncontrolledNodes.set(m,!0),T===1&&m.setAttribute(r,"true"),b||m.setAttribute(n,"true")}catch(S){console.error("aria-hidden: cannot operate on ",m,S)}})};return d(e),l.clear(),lockCount++,function(){o.forEach(function(p){var m=counterMap.get(p)-1,y=a.get(p)-1;counterMap.set(p,m),a.set(p,y),m||(uncontrolledNodes.has(p)||p.removeAttribute(n),uncontrolledNodes.delete(p)),y||p.removeAttribute(r)}),lockCount--,lockCount||(counterMap=new WeakMap,counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={})}},hideOthers=function(t,e,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(t)?t:[t]),s=getDefaultParent(t);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live], script"))),applyAttributeToOthers(n,s,r,"aria-hidden")):function(){return null}},__assign=function(){return __assign=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},__assign.apply(this,arguments)};function __rest(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function __spreadArray(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,a;n<s;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))}typeof SuppressedError=="function"&&SuppressedError;var zeroRightClassName="right-scroll-bar-position",fullWidthClassName="width-before-scroll-bar",noScrollbarsClassName="with-scroll-bars-hidden",removedBarSizeVariable="--removed-body-scroll-bar-size";function assignRef(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function useCallbackRef(t,e){var r=reactExports.useState(function(){return{value:t,callback:e,facade:{get current(){return r.value},set current(n){var s=r.value;s!==n&&(r.value=n,r.callback(n,s))}}}})[0];return r.callback=e,r.facade}var useIsomorphicLayoutEffect$2=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,currentValues=new WeakMap;function useMergeRefs(t,e){var r=useCallbackRef(null,function(n){return t.forEach(function(s){return assignRef(s,n)})});return useIsomorphicLayoutEffect$2(function(){var n=currentValues.get(r);if(n){var s=new Set(n),a=new Set(t),o=r.current;s.forEach(function(l){a.has(l)||assignRef(l,null)}),a.forEach(function(l){s.has(l)||assignRef(l,o)})}currentValues.set(r,t)},[t]),r}function ItoI(t){return t}function innerCreateMedium(t,e){e===void 0&&(e=ItoI);var r=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(a){var o=e(a,n);return r.push(o),function(){r=r.filter(function(l){return l!==o})}},assignSyncMedium:function(a){for(n=!0;r.length;){var o=r;r=[],o.forEach(a)}r={push:function(l){return a(l)},filter:function(){return r}}},assignMedium:function(a){n=!0;var o=[];if(r.length){var l=r;r=[],l.forEach(a),o=r}var u=function(){var d=o;o=[],d.forEach(a)},c=function(){return Promise.resolve().then(u)};c(),r={push:function(d){o.push(d),c()},filter:function(d){return o=o.filter(d),r}}}};return s}function createSidecarMedium(t){t===void 0&&(t={});var e=innerCreateMedium(null);return e.options=__assign({async:!0,ssr:!1},t),e}var SideCar$1=function(t){var e=t.sideCar,r=__rest(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return reactExports.createElement(n,__assign({},r))};SideCar$1.isSideCarExport=!0;function exportSidecar(t,e){return t.useMedium(e),SideCar$1}var effectCar=createSidecarMedium(),nothing=function(){},RemoveScroll=reactExports.forwardRef(function(t,e){var r=reactExports.useRef(null),n=reactExports.useState({onScrollCapture:nothing,onWheelCapture:nothing,onTouchMoveCapture:nothing}),s=n[0],a=n[1],o=t.forwardProps,l=t.children,u=t.className,c=t.removeScrollBar,d=t.enabled,p=t.shards,m=t.sideCar,y=t.noRelative,b=t.noIsolation,E=t.inert,T=t.allowPinchZoom,S=t.as,P=S===void 0?"div":S,A=t.gapMode,I=__rest(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),j=m,K=useMergeRefs([r,e]),W=__assign(__assign({},I),s);return reactExports.createElement(reactExports.Fragment,null,d&&reactExports.createElement(j,{sideCar:effectCar,removeScrollBar:c,shards:p,noRelative:y,noIsolation:b,inert:E,setCallbacks:a,allowPinchZoom:!!T,lockRef:r,gapMode:A}),o?reactExports.cloneElement(reactExports.Children.only(l),__assign(__assign({},W),{ref:K})):reactExports.createElement(P,__assign({},W,{className:u,ref:K}),l))});RemoveScroll.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};RemoveScroll.classNames={fullWidth:fullWidthClassName,zeroRight:zeroRightClassName};var getNonce=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function makeStyleTag(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=getNonce();return e&&t.setAttribute("nonce",e),t}function injectStyles(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function insertStyleTag(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var stylesheetSingleton=function(){var t=0,e=null;return{add:function(r){t==0&&(e=makeStyleTag())&&(injectStyles(e,r),insertStyleTag(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},styleHookSingleton=function(){var t=stylesheetSingleton();return function(e,r){reactExports.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&r])}},styleSingleton=function(){var t=styleHookSingleton(),e=function(r){var n=r.styles,s=r.dynamic;return t(n,s),null};return e},zeroGap={left:0,top:0,right:0,gap:0},parse$1=function(t){return parseInt(t||"",10)||0},getOffset=function(t){var e=window.getComputedStyle(document.body),r=e[t==="padding"?"paddingLeft":"marginLeft"],n=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[parse$1(r),parse$1(n),parse$1(s)]},getGapWidth=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return zeroGap;var e=getOffset(t),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-r+e[2]-e[0])}},Style=styleSingleton(),lockAttribute="data-scroll-locked",getStyles$2=function(t,e,r,n){var s=t.left,a=t.top,o=t.right,l=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(noScrollbarsClassName,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(lockAttribute,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(a,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(zeroRightClassName,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(fullWidthClassName,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(zeroRightClassName," .").concat(zeroRightClassName,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(fullWidthClassName," .").concat(fullWidthClassName,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(lockAttribute,`] {
    `).concat(removedBarSizeVariable,": ").concat(l,`px;
  }
`)},getCurrentUseCounter=function(){var t=parseInt(document.body.getAttribute(lockAttribute)||"0",10);return isFinite(t)?t:0},useLockAttribute=function(){reactExports.useEffect(function(){return document.body.setAttribute(lockAttribute,(getCurrentUseCounter()+1).toString()),function(){var t=getCurrentUseCounter()-1;t<=0?document.body.removeAttribute(lockAttribute):document.body.setAttribute(lockAttribute,t.toString())}},[])},RemoveScrollBar=function(t){var e=t.noRelative,r=t.noImportant,n=t.gapMode,s=n===void 0?"margin":n;useLockAttribute();var a=reactExports.useMemo(function(){return getGapWidth(s)},[s]);return reactExports.createElement(Style,{styles:getStyles$2(a,!e,s,r?"":"!important")})},passiveSupported=!1;if(typeof window<"u")try{var options=Object.defineProperty({},"passive",{get:function(){return passiveSupported=!0,!0}});window.addEventListener("test",options,options),window.removeEventListener("test",options,options)}catch{passiveSupported=!1}var nonPassive=passiveSupported?{passive:!1}:!1,alwaysContainsScroll=function(t){return t.tagName==="TEXTAREA"},elementCanBeScrolled=function(t,e){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[e]!=="hidden"&&!(r.overflowY===r.overflowX&&!alwaysContainsScroll(t)&&r[e]==="visible")},elementCouldBeVScrolled=function(t){return elementCanBeScrolled(t,"overflowY")},elementCouldBeHScrolled=function(t){return elementCanBeScrolled(t,"overflowX")},locationCouldBeScrolled=function(t,e){var r=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=elementCouldBeScrolled(t,n);if(s){var a=getScrollVariables(t,n),o=a[1],l=a[2];if(o>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},getVScrollVariables=function(t){var e=t.scrollTop,r=t.scrollHeight,n=t.clientHeight;return[e,r,n]},getHScrollVariables=function(t){var e=t.scrollLeft,r=t.scrollWidth,n=t.clientWidth;return[e,r,n]},elementCouldBeScrolled=function(t,e){return t==="v"?elementCouldBeVScrolled(e):elementCouldBeHScrolled(e)},getScrollVariables=function(t,e){return t==="v"?getVScrollVariables(e):getHScrollVariables(e)},getDirectionFactor=function(t,e){return t==="h"&&e==="rtl"?-1:1},handleScroll=function(t,e,r,n,s){var a=getDirectionFactor(t,window.getComputedStyle(e).direction),o=a*n,l=r.target,u=e.contains(l),c=!1,d=o>0,p=0,m=0;do{var y=getScrollVariables(t,l),b=y[0],E=y[1],T=y[2],S=E-T-a*b;(b||S)&&elementCouldBeScrolled(t,l)&&(p+=S,m+=b),l=l.parentNode.host||l.parentNode}while(!u&&l!==document.body||u&&(e.contains(l)||e===l));return(d&&Math.abs(p)<1||!d&&Math.abs(m)<1)&&(c=!0),c},getTouchXY=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},getDeltaXY=function(t){return[t.deltaX,t.deltaY]},extractRef=function(t){return t&&"current"in t?t.current:t},deltaCompare=function(t,e){return t[0]===e[0]&&t[1]===e[1]},generateStyle=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},idCounter=0,lockStack=[];function RemoveScrollSideCar(t){var e=reactExports.useRef([]),r=reactExports.useRef([0,0]),n=reactExports.useRef(),s=reactExports.useState(idCounter++)[0],a=reactExports.useState(styleSingleton)[0],o=reactExports.useRef(t);reactExports.useEffect(function(){o.current=t},[t]),reactExports.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var E=__spreadArray([t.lockRef.current],(t.shards||[]).map(extractRef),!0).filter(Boolean);return E.forEach(function(T){return T.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),E.forEach(function(T){return T.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=reactExports.useCallback(function(E,T){if("touches"in E&&E.touches.length===2||E.type==="wheel"&&E.ctrlKey)return!o.current.allowPinchZoom;var S=getTouchXY(E),P=r.current,A="deltaX"in E?E.deltaX:P[0]-S[0],I="deltaY"in E?E.deltaY:P[1]-S[1],j,K=E.target,W=Math.abs(A)>Math.abs(I)?"h":"v";if("touches"in E&&W==="h"&&K.type==="range")return!1;var H=locationCouldBeScrolled(W,K);if(!H)return!0;if(H?j=W:(j=W==="v"?"h":"v",H=locationCouldBeScrolled(W,K)),!H)return!1;if(!n.current&&"changedTouches"in E&&(A||I)&&(n.current=j),!j)return!0;var ee=n.current||j;return handleScroll(ee,T,E,ee==="h"?A:I)},[]),u=reactExports.useCallback(function(E){var T=E;if(!(!lockStack.length||lockStack[lockStack.length-1]!==a)){var S="deltaY"in T?getDeltaXY(T):getTouchXY(T),P=e.current.filter(function(j){return j.name===T.type&&(j.target===T.target||T.target===j.shadowParent)&&deltaCompare(j.delta,S)})[0];if(P&&P.should){T.cancelable&&T.preventDefault();return}if(!P){var A=(o.current.shards||[]).map(extractRef).filter(Boolean).filter(function(j){return j.contains(T.target)}),I=A.length>0?l(T,A[0]):!o.current.noIsolation;I&&T.cancelable&&T.preventDefault()}}},[]),c=reactExports.useCallback(function(E,T,S,P){var A={name:E,delta:T,target:S,should:P,shadowParent:getOutermostShadowParent(S)};e.current.push(A),setTimeout(function(){e.current=e.current.filter(function(I){return I!==A})},1)},[]),d=reactExports.useCallback(function(E){r.current=getTouchXY(E),n.current=void 0},[]),p=reactExports.useCallback(function(E){c(E.type,getDeltaXY(E),E.target,l(E,t.lockRef.current))},[]),m=reactExports.useCallback(function(E){c(E.type,getTouchXY(E),E.target,l(E,t.lockRef.current))},[]);reactExports.useEffect(function(){return lockStack.push(a),t.setCallbacks({onScrollCapture:p,onWheelCapture:p,onTouchMoveCapture:m}),document.addEventListener("wheel",u,nonPassive),document.addEventListener("touchmove",u,nonPassive),document.addEventListener("touchstart",d,nonPassive),function(){lockStack=lockStack.filter(function(E){return E!==a}),document.removeEventListener("wheel",u,nonPassive),document.removeEventListener("touchmove",u,nonPassive),document.removeEventListener("touchstart",d,nonPassive)}},[]);var y=t.removeScrollBar,b=t.inert;return reactExports.createElement(reactExports.Fragment,null,b?reactExports.createElement(a,{styles:generateStyle(s)}):null,y?reactExports.createElement(RemoveScrollBar,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function getOutermostShadowParent(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const SideCar=exportSidecar(effectCar,RemoveScrollSideCar);var ReactRemoveScroll=reactExports.forwardRef(function(t,e){return reactExports.createElement(RemoveScroll,__assign({},t,{ref:e,sideCar:SideCar}))});ReactRemoveScroll.classNames=RemoveScroll.classNames;var SELECTION_KEYS=["Enter"," "],FIRST_KEYS=["ArrowDown","PageUp","Home"],LAST_KEYS=["ArrowUp","PageDown","End"],FIRST_LAST_KEYS=[...FIRST_KEYS,...LAST_KEYS],SUB_OPEN_KEYS={ltr:[...SELECTION_KEYS,"ArrowRight"],rtl:[...SELECTION_KEYS,"ArrowLeft"]},SUB_CLOSE_KEYS={ltr:["ArrowLeft"],rtl:["ArrowRight"]},MENU_NAME="Menu",[Collection,useCollection,createCollectionScope]=createCollection(MENU_NAME),[createMenuContext,createMenuScope]=createContextScope(MENU_NAME,[createCollectionScope,createPopperScope,createRovingFocusGroupScope]),usePopperScope$1=createPopperScope(),useRovingFocusGroupScope=createRovingFocusGroupScope(),[MenuProvider,useMenuContext]=createMenuContext(MENU_NAME),[MenuRootProvider,useMenuRootContext]=createMenuContext(MENU_NAME),Menu=t=>{const{__scopeMenu:e,open:r=!1,children:n,dir:s,onOpenChange:a,modal:o=!0}=t,l=usePopperScope$1(e),[u,c]=reactExports.useState(null),d=reactExports.useRef(!1),p=useCallbackRef$1(a),m=useDirection(s);return reactExports.useEffect(()=>{const y=()=>{d.current=!0,document.addEventListener("pointerdown",b,{capture:!0,once:!0}),document.addEventListener("pointermove",b,{capture:!0,once:!0})},b=()=>d.current=!1;return document.addEventListener("keydown",y,{capture:!0}),()=>{document.removeEventListener("keydown",y,{capture:!0}),document.removeEventListener("pointerdown",b,{capture:!0}),document.removeEventListener("pointermove",b,{capture:!0})}},[]),jsxRuntimeExports.jsx(Root2$1,{...l,children:jsxRuntimeExports.jsx(MenuProvider,{scope:e,open:r,onOpenChange:p,content:u,onContentChange:c,children:jsxRuntimeExports.jsx(MenuRootProvider,{scope:e,onClose:reactExports.useCallback(()=>p(!1),[p]),isUsingKeyboardRef:d,dir:m,modal:o,children:n})})})};Menu.displayName=MENU_NAME;var ANCHOR_NAME="MenuAnchor",MenuAnchor=reactExports.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t,s=usePopperScope$1(r);return jsxRuntimeExports.jsx(Anchor,{...s,...n,ref:e})});MenuAnchor.displayName=ANCHOR_NAME;var PORTAL_NAME$2="MenuPortal",[PortalProvider$1,usePortalContext$1]=createMenuContext(PORTAL_NAME$2,{forceMount:void 0}),MenuPortal=t=>{const{__scopeMenu:e,forceMount:r,children:n,container:s}=t,a=useMenuContext(PORTAL_NAME$2,e);return jsxRuntimeExports.jsx(PortalProvider$1,{scope:e,forceMount:r,children:jsxRuntimeExports.jsx(Presence,{present:r||a.open,children:jsxRuntimeExports.jsx(Portal$2,{asChild:!0,container:s,children:n})})})};MenuPortal.displayName=PORTAL_NAME$2;var CONTENT_NAME$2="MenuContent",[MenuContentProvider,useMenuContentContext]=createMenuContext(CONTENT_NAME$2),MenuContent=reactExports.forwardRef((t,e)=>{const r=usePortalContext$1(CONTENT_NAME$2,t.__scopeMenu),{forceMount:n=r.forceMount,...s}=t,a=useMenuContext(CONTENT_NAME$2,t.__scopeMenu),o=useMenuRootContext(CONTENT_NAME$2,t.__scopeMenu);return jsxRuntimeExports.jsx(Collection.Provider,{scope:t.__scopeMenu,children:jsxRuntimeExports.jsx(Presence,{present:n||a.open,children:jsxRuntimeExports.jsx(Collection.Slot,{scope:t.__scopeMenu,children:o.modal?jsxRuntimeExports.jsx(MenuRootContentModal,{...s,ref:e}):jsxRuntimeExports.jsx(MenuRootContentNonModal,{...s,ref:e})})})})}),MenuRootContentModal=reactExports.forwardRef((t,e)=>{const r=useMenuContext(CONTENT_NAME$2,t.__scopeMenu),n=reactExports.useRef(null),s=useComposedRefs(e,n);return reactExports.useEffect(()=>{const a=n.current;if(a)return hideOthers(a)},[]),jsxRuntimeExports.jsx(MenuContentImpl,{...t,ref:s,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:composeEventHandlers(t.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),MenuRootContentNonModal=reactExports.forwardRef((t,e)=>{const r=useMenuContext(CONTENT_NAME$2,t.__scopeMenu);return jsxRuntimeExports.jsx(MenuContentImpl,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),Slot=createSlot("MenuContent.ScrollLock"),MenuContentImpl=reactExports.forwardRef((t,e)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:u,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:p,onInteractOutside:m,onDismiss:y,disableOutsideScroll:b,...E}=t,T=useMenuContext(CONTENT_NAME$2,r),S=useMenuRootContext(CONTENT_NAME$2,r),P=usePopperScope$1(r),A=useRovingFocusGroupScope(r),I=useCollection(r),[j,K]=reactExports.useState(null),W=reactExports.useRef(null),H=useComposedRefs(e,W,T.onContentChange),ee=reactExports.useRef(0),ue=reactExports.useRef(""),de=reactExports.useRef(0),fe=reactExports.useRef(null),ae=reactExports.useRef("right"),ce=reactExports.useRef(0),me=b?ReactRemoveScroll:reactExports.Fragment,te=b?{as:Slot,allowPinchZoom:!0}:void 0,le=Y=>{var Ve,Pe;const he=ue.current+Y,oe=I().filter(Ce=>!Ce.disabled),ye=document.activeElement,Ee=(Ve=oe.find(Ce=>Ce.ref.current===ye))==null?void 0:Ve.textValue,Ae=oe.map(Ce=>Ce.textValue),je=getNextMatch(Ae,he,Ee),Te=(Pe=oe.find(Ce=>Ce.textValue===je))==null?void 0:Pe.ref.current;(function Ce(De){ue.current=De,window.clearTimeout(ee.current),De!==""&&(ee.current=window.setTimeout(()=>Ce(""),1e3))})(he),Te&&setTimeout(()=>Te.focus())};reactExports.useEffect(()=>()=>window.clearTimeout(ee.current),[]),useFocusGuards();const Z=reactExports.useCallback(Y=>{var oe,ye;return ae.current===((oe=fe.current)==null?void 0:oe.side)&&isPointerInGraceArea(Y,(ye=fe.current)==null?void 0:ye.area)},[]);return jsxRuntimeExports.jsx(MenuContentProvider,{scope:r,searchRef:ue,onItemEnter:reactExports.useCallback(Y=>{Z(Y)&&Y.preventDefault()},[Z]),onItemLeave:reactExports.useCallback(Y=>{var he;Z(Y)||((he=W.current)==null||he.focus(),K(null))},[Z]),onTriggerLeave:reactExports.useCallback(Y=>{Z(Y)&&Y.preventDefault()},[Z]),pointerGraceTimerRef:de,onPointerGraceIntentChange:reactExports.useCallback(Y=>{fe.current=Y},[]),children:jsxRuntimeExports.jsx(me,{...te,children:jsxRuntimeExports.jsx(FocusScope,{asChild:!0,trapped:s,onMountAutoFocus:composeEventHandlers(a,Y=>{var he;Y.preventDefault(),(he=W.current)==null||he.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:jsxRuntimeExports.jsx(DismissableLayer,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:p,onInteractOutside:m,onDismiss:y,children:jsxRuntimeExports.jsx(Root$1,{asChild:!0,...A,dir:S.dir,orientation:"vertical",loop:n,currentTabStopId:j,onCurrentTabStopIdChange:K,onEntryFocus:composeEventHandlers(u,Y=>{S.isUsingKeyboardRef.current||Y.preventDefault()}),preventScrollOnEntryFocus:!0,children:jsxRuntimeExports.jsx(Content,{role:"menu","aria-orientation":"vertical","data-state":getOpenState(T.open),"data-radix-menu-content":"",dir:S.dir,...P,...E,ref:H,style:{outline:"none",...E.style},onKeyDown:composeEventHandlers(E.onKeyDown,Y=>{const oe=Y.target.closest("[data-radix-menu-content]")===Y.currentTarget,ye=Y.ctrlKey||Y.altKey||Y.metaKey,Ee=Y.key.length===1;oe&&(Y.key==="Tab"&&Y.preventDefault(),!ye&&Ee&&le(Y.key));const Ae=W.current;if(Y.target!==Ae||!FIRST_LAST_KEYS.includes(Y.key))return;Y.preventDefault();const Te=I().filter(Ve=>!Ve.disabled).map(Ve=>Ve.ref.current);LAST_KEYS.includes(Y.key)&&Te.reverse(),focusFirst(Te)}),onBlur:composeEventHandlers(t.onBlur,Y=>{Y.currentTarget.contains(Y.target)||(window.clearTimeout(ee.current),ue.current="")}),onPointerMove:composeEventHandlers(t.onPointerMove,whenMouse(Y=>{const he=Y.target,oe=ce.current!==Y.clientX;if(Y.currentTarget.contains(he)&&oe){const ye=Y.clientX>ce.current?"right":"left";ae.current=ye,ce.current=Y.clientX}}))})})})})})})});MenuContent.displayName=CONTENT_NAME$2;var GROUP_NAME$1="MenuGroup",MenuGroup=reactExports.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t;return jsxRuntimeExports.jsx(Primitive.div,{role:"group",...n,ref:e})});MenuGroup.displayName=GROUP_NAME$1;var LABEL_NAME$1="MenuLabel",MenuLabel=reactExports.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t;return jsxRuntimeExports.jsx(Primitive.div,{...n,ref:e})});MenuLabel.displayName=LABEL_NAME$1;var ITEM_NAME$1="MenuItem",ITEM_SELECT="menu.itemSelect",MenuItem=reactExports.forwardRef((t,e)=>{const{disabled:r=!1,onSelect:n,...s}=t,a=reactExports.useRef(null),o=useMenuRootContext(ITEM_NAME$1,t.__scopeMenu),l=useMenuContentContext(ITEM_NAME$1,t.__scopeMenu),u=useComposedRefs(e,a),c=reactExports.useRef(!1),d=()=>{const p=a.current;if(!r&&p){const m=new CustomEvent(ITEM_SELECT,{bubbles:!0,cancelable:!0});p.addEventListener(ITEM_SELECT,y=>n==null?void 0:n(y),{once:!0}),dispatchDiscreteCustomEvent(p,m),m.defaultPrevented?c.current=!1:o.onClose()}};return jsxRuntimeExports.jsx(MenuItemImpl,{...s,ref:u,disabled:r,onClick:composeEventHandlers(t.onClick,d),onPointerDown:p=>{var m;(m=t.onPointerDown)==null||m.call(t,p),c.current=!0},onPointerUp:composeEventHandlers(t.onPointerUp,p=>{var m;c.current||(m=p.currentTarget)==null||m.click()}),onKeyDown:composeEventHandlers(t.onKeyDown,p=>{const m=l.searchRef.current!=="";r||m&&p.key===" "||SELECTION_KEYS.includes(p.key)&&(p.currentTarget.click(),p.preventDefault())})})});MenuItem.displayName=ITEM_NAME$1;var MenuItemImpl=reactExports.forwardRef((t,e)=>{const{__scopeMenu:r,disabled:n=!1,textValue:s,...a}=t,o=useMenuContentContext(ITEM_NAME$1,r),l=useRovingFocusGroupScope(r),u=reactExports.useRef(null),c=useComposedRefs(e,u),[d,p]=reactExports.useState(!1),[m,y]=reactExports.useState("");return reactExports.useEffect(()=>{const b=u.current;b&&y((b.textContent??"").trim())},[a.children]),jsxRuntimeExports.jsx(Collection.ItemSlot,{scope:r,disabled:n,textValue:s??m,children:jsxRuntimeExports.jsx(Item,{asChild:!0,...l,focusable:!n,children:jsxRuntimeExports.jsx(Primitive.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...a,ref:c,onPointerMove:composeEventHandlers(t.onPointerMove,whenMouse(b=>{n?o.onItemLeave(b):(o.onItemEnter(b),b.defaultPrevented||b.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:composeEventHandlers(t.onPointerLeave,whenMouse(b=>o.onItemLeave(b))),onFocus:composeEventHandlers(t.onFocus,()=>p(!0)),onBlur:composeEventHandlers(t.onBlur,()=>p(!1))})})})}),CHECKBOX_ITEM_NAME$1="MenuCheckboxItem",MenuCheckboxItem=reactExports.forwardRef((t,e)=>{const{checked:r=!1,onCheckedChange:n,...s}=t;return jsxRuntimeExports.jsx(ItemIndicatorProvider,{scope:t.__scopeMenu,checked:r,children:jsxRuntimeExports.jsx(MenuItem,{role:"menuitemcheckbox","aria-checked":isIndeterminate(r)?"mixed":r,...s,ref:e,"data-state":getCheckedState(r),onSelect:composeEventHandlers(s.onSelect,()=>n==null?void 0:n(isIndeterminate(r)?!0:!r),{checkForDefaultPrevented:!1})})})});MenuCheckboxItem.displayName=CHECKBOX_ITEM_NAME$1;var RADIO_GROUP_NAME$1="MenuRadioGroup",[RadioGroupProvider,useRadioGroupContext]=createMenuContext(RADIO_GROUP_NAME$1,{value:void 0,onValueChange:()=>{}}),MenuRadioGroup=reactExports.forwardRef((t,e)=>{const{value:r,onValueChange:n,...s}=t,a=useCallbackRef$1(n);return jsxRuntimeExports.jsx(RadioGroupProvider,{scope:t.__scopeMenu,value:r,onValueChange:a,children:jsxRuntimeExports.jsx(MenuGroup,{...s,ref:e})})});MenuRadioGroup.displayName=RADIO_GROUP_NAME$1;var RADIO_ITEM_NAME$1="MenuRadioItem",MenuRadioItem=reactExports.forwardRef((t,e)=>{const{value:r,...n}=t,s=useRadioGroupContext(RADIO_ITEM_NAME$1,t.__scopeMenu),a=r===s.value;return jsxRuntimeExports.jsx(ItemIndicatorProvider,{scope:t.__scopeMenu,checked:a,children:jsxRuntimeExports.jsx(MenuItem,{role:"menuitemradio","aria-checked":a,...n,ref:e,"data-state":getCheckedState(a),onSelect:composeEventHandlers(n.onSelect,()=>{var o;return(o=s.onValueChange)==null?void 0:o.call(s,r)},{checkForDefaultPrevented:!1})})})});MenuRadioItem.displayName=RADIO_ITEM_NAME$1;var ITEM_INDICATOR_NAME="MenuItemIndicator",[ItemIndicatorProvider,useItemIndicatorContext]=createMenuContext(ITEM_INDICATOR_NAME,{checked:!1}),MenuItemIndicator=reactExports.forwardRef((t,e)=>{const{__scopeMenu:r,forceMount:n,...s}=t,a=useItemIndicatorContext(ITEM_INDICATOR_NAME,r);return jsxRuntimeExports.jsx(Presence,{present:n||isIndeterminate(a.checked)||a.checked===!0,children:jsxRuntimeExports.jsx(Primitive.span,{...s,ref:e,"data-state":getCheckedState(a.checked)})})});MenuItemIndicator.displayName=ITEM_INDICATOR_NAME;var SEPARATOR_NAME$1="MenuSeparator",MenuSeparator=reactExports.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t;return jsxRuntimeExports.jsx(Primitive.div,{role:"separator","aria-orientation":"horizontal",...n,ref:e})});MenuSeparator.displayName=SEPARATOR_NAME$1;var ARROW_NAME$2="MenuArrow",MenuArrow=reactExports.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t,s=usePopperScope$1(r);return jsxRuntimeExports.jsx(Arrow,{...s,...n,ref:e})});MenuArrow.displayName=ARROW_NAME$2;var SUB_NAME="MenuSub",[MenuSubProvider,useMenuSubContext]=createMenuContext(SUB_NAME),SUB_TRIGGER_NAME$1="MenuSubTrigger",MenuSubTrigger=reactExports.forwardRef((t,e)=>{const r=useMenuContext(SUB_TRIGGER_NAME$1,t.__scopeMenu),n=useMenuRootContext(SUB_TRIGGER_NAME$1,t.__scopeMenu),s=useMenuSubContext(SUB_TRIGGER_NAME$1,t.__scopeMenu),a=useMenuContentContext(SUB_TRIGGER_NAME$1,t.__scopeMenu),o=reactExports.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:u}=a,c={__scopeMenu:t.__scopeMenu},d=reactExports.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return reactExports.useEffect(()=>d,[d]),reactExports.useEffect(()=>{const p=l.current;return()=>{window.clearTimeout(p),u(null)}},[l,u]),jsxRuntimeExports.jsx(MenuAnchor,{asChild:!0,...c,children:jsxRuntimeExports.jsx(MenuItemImpl,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":s.contentId,"data-state":getOpenState(r.open),...t,ref:composeRefs(e,s.onTriggerChange),onClick:p=>{var m;(m=t.onClick)==null||m.call(t,p),!(t.disabled||p.defaultPrevented)&&(p.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:composeEventHandlers(t.onPointerMove,whenMouse(p=>{a.onItemEnter(p),!p.defaultPrevented&&!t.disabled&&!r.open&&!o.current&&(a.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{r.onOpenChange(!0),d()},100))})),onPointerLeave:composeEventHandlers(t.onPointerLeave,whenMouse(p=>{var y,b;d();const m=(y=r.content)==null?void 0:y.getBoundingClientRect();if(m){const E=(b=r.content)==null?void 0:b.dataset.side,T=E==="right",S=T?-5:5,P=m[T?"left":"right"],A=m[T?"right":"left"];a.onPointerGraceIntentChange({area:[{x:p.clientX+S,y:p.clientY},{x:P,y:m.top},{x:A,y:m.top},{x:A,y:m.bottom},{x:P,y:m.bottom}],side:E}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.onPointerGraceIntentChange(null),300)}else{if(a.onTriggerLeave(p),p.defaultPrevented)return;a.onPointerGraceIntentChange(null)}})),onKeyDown:composeEventHandlers(t.onKeyDown,p=>{var y;const m=a.searchRef.current!=="";t.disabled||m&&p.key===" "||SUB_OPEN_KEYS[n.dir].includes(p.key)&&(r.onOpenChange(!0),(y=r.content)==null||y.focus(),p.preventDefault())})})})});MenuSubTrigger.displayName=SUB_TRIGGER_NAME$1;var SUB_CONTENT_NAME$1="MenuSubContent",MenuSubContent=reactExports.forwardRef((t,e)=>{const r=usePortalContext$1(CONTENT_NAME$2,t.__scopeMenu),{forceMount:n=r.forceMount,...s}=t,a=useMenuContext(CONTENT_NAME$2,t.__scopeMenu),o=useMenuRootContext(CONTENT_NAME$2,t.__scopeMenu),l=useMenuSubContext(SUB_CONTENT_NAME$1,t.__scopeMenu),u=reactExports.useRef(null),c=useComposedRefs(e,u);return jsxRuntimeExports.jsx(Collection.Provider,{scope:t.__scopeMenu,children:jsxRuntimeExports.jsx(Presence,{present:n||a.open,children:jsxRuntimeExports.jsx(Collection.Slot,{scope:t.__scopeMenu,children:jsxRuntimeExports.jsx(MenuContentImpl,{id:l.contentId,"aria-labelledby":l.triggerId,...s,ref:c,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var p;o.isUsingKeyboardRef.current&&((p=u.current)==null||p.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:composeEventHandlers(t.onFocusOutside,d=>{d.target!==l.trigger&&a.onOpenChange(!1)}),onEscapeKeyDown:composeEventHandlers(t.onEscapeKeyDown,d=>{o.onClose(),d.preventDefault()}),onKeyDown:composeEventHandlers(t.onKeyDown,d=>{var y;const p=d.currentTarget.contains(d.target),m=SUB_CLOSE_KEYS[o.dir].includes(d.key);p&&m&&(a.onOpenChange(!1),(y=l.trigger)==null||y.focus(),d.preventDefault())})})})})})});MenuSubContent.displayName=SUB_CONTENT_NAME$1;function getOpenState(t){return t?"open":"closed"}function isIndeterminate(t){return t==="indeterminate"}function getCheckedState(t){return isIndeterminate(t)?"indeterminate":t?"checked":"unchecked"}function focusFirst(t){const e=document.activeElement;for(const r of t)if(r===e||(r.focus(),document.activeElement!==e))return}function wrapArray(t,e){return t.map((r,n)=>t[(e+n)%t.length])}function getNextMatch(t,e,r){const s=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,a=r?t.indexOf(r):-1;let o=wrapArray(t,Math.max(a,0));s.length===1&&(o=o.filter(c=>c!==r));const u=o.find(c=>c.toLowerCase().startsWith(s.toLowerCase()));return u!==r?u:void 0}function isPointInPolygon$1(t,e){const{x:r,y:n}=t;let s=!1;for(let a=0,o=e.length-1;a<e.length;o=a++){const l=e[a],u=e[o],c=l.x,d=l.y,p=u.x,m=u.y;d>n!=m>n&&r<(p-c)*(n-d)/(m-d)+c&&(s=!s)}return s}function isPointerInGraceArea(t,e){if(!e)return!1;const r={x:t.clientX,y:t.clientY};return isPointInPolygon$1(r,e)}function whenMouse(t){return e=>e.pointerType==="mouse"?t(e):void 0}var Root3$1=Menu,Anchor2=MenuAnchor,Portal$1=MenuPortal,Content2$2=MenuContent,Group=MenuGroup,Label=MenuLabel,Item2$1=MenuItem,CheckboxItem=MenuCheckboxItem,RadioGroup=MenuRadioGroup,RadioItem=MenuRadioItem,ItemIndicator=MenuItemIndicator,Separator=MenuSeparator,Arrow2$1=MenuArrow,SubTrigger=MenuSubTrigger,SubContent=MenuSubContent,DROPDOWN_MENU_NAME="DropdownMenu",[createDropdownMenuContext,createDropdownMenuScope]=createContextScope(DROPDOWN_MENU_NAME,[createMenuScope]),useMenuScope=createMenuScope(),[DropdownMenuProvider,useDropdownMenuContext]=createDropdownMenuContext(DROPDOWN_MENU_NAME),DropdownMenu=t=>{const{__scopeDropdownMenu:e,children:r,dir:n,open:s,defaultOpen:a,onOpenChange:o,modal:l=!0}=t,u=useMenuScope(e),c=reactExports.useRef(null),[d,p]=useControllableState({prop:s,defaultProp:a??!1,onChange:o,caller:DROPDOWN_MENU_NAME});return jsxRuntimeExports.jsx(DropdownMenuProvider,{scope:e,triggerId:useId(),triggerRef:c,contentId:useId(),open:d,onOpenChange:p,onOpenToggle:reactExports.useCallback(()=>p(m=>!m),[p]),modal:l,children:jsxRuntimeExports.jsx(Root3$1,{...u,open:d,onOpenChange:p,dir:n,modal:l,children:r})})};DropdownMenu.displayName=DROPDOWN_MENU_NAME;var TRIGGER_NAME$1="DropdownMenuTrigger",DropdownMenuTrigger=reactExports.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...s}=t,a=useDropdownMenuContext(TRIGGER_NAME$1,r),o=useMenuScope(r);return jsxRuntimeExports.jsx(Anchor2,{asChild:!0,...o,children:jsxRuntimeExports.jsx(Primitive.button,{type:"button",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":a.open?a.contentId:void 0,"data-state":a.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:composeRefs(e,a.triggerRef),onPointerDown:composeEventHandlers(t.onPointerDown,l=>{!n&&l.button===0&&l.ctrlKey===!1&&(a.onOpenToggle(),a.open||l.preventDefault())}),onKeyDown:composeEventHandlers(t.onKeyDown,l=>{n||(["Enter"," "].includes(l.key)&&a.onOpenToggle(),l.key==="ArrowDown"&&a.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});DropdownMenuTrigger.displayName=TRIGGER_NAME$1;var PORTAL_NAME$1="DropdownMenuPortal",DropdownMenuPortal=t=>{const{__scopeDropdownMenu:e,...r}=t,n=useMenuScope(e);return jsxRuntimeExports.jsx(Portal$1,{...n,...r})};DropdownMenuPortal.displayName=PORTAL_NAME$1;var CONTENT_NAME$1="DropdownMenuContent",DropdownMenuContent=reactExports.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=useDropdownMenuContext(CONTENT_NAME$1,r),a=useMenuScope(r),o=reactExports.useRef(!1);return jsxRuntimeExports.jsx(Content2$2,{id:s.contentId,"aria-labelledby":s.triggerId,...a,...n,ref:e,onCloseAutoFocus:composeEventHandlers(t.onCloseAutoFocus,l=>{var u;o.current||(u=s.triggerRef.current)==null||u.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:composeEventHandlers(t.onInteractOutside,l=>{const u=l.detail.originalEvent,c=u.button===0&&u.ctrlKey===!0,d=u.button===2||c;(!s.modal||d)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});DropdownMenuContent.displayName=CONTENT_NAME$1;var GROUP_NAME="DropdownMenuGroup",DropdownMenuGroup=reactExports.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=useMenuScope(r);return jsxRuntimeExports.jsx(Group,{...s,...n,ref:e})});DropdownMenuGroup.displayName=GROUP_NAME;var LABEL_NAME="DropdownMenuLabel",DropdownMenuLabel=reactExports.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=useMenuScope(r);return jsxRuntimeExports.jsx(Label,{...s,...n,ref:e})});DropdownMenuLabel.displayName=LABEL_NAME;var ITEM_NAME="DropdownMenuItem",DropdownMenuItem=reactExports.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=useMenuScope(r);return jsxRuntimeExports.jsx(Item2$1,{...s,...n,ref:e})});DropdownMenuItem.displayName=ITEM_NAME;var CHECKBOX_ITEM_NAME="DropdownMenuCheckboxItem",DropdownMenuCheckboxItem=reactExports.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=useMenuScope(r);return jsxRuntimeExports.jsx(CheckboxItem,{...s,...n,ref:e})});DropdownMenuCheckboxItem.displayName=CHECKBOX_ITEM_NAME;var RADIO_GROUP_NAME="DropdownMenuRadioGroup",DropdownMenuRadioGroup=reactExports.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=useMenuScope(r);return jsxRuntimeExports.jsx(RadioGroup,{...s,...n,ref:e})});DropdownMenuRadioGroup.displayName=RADIO_GROUP_NAME;var RADIO_ITEM_NAME="DropdownMenuRadioItem",DropdownMenuRadioItem=reactExports.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=useMenuScope(r);return jsxRuntimeExports.jsx(RadioItem,{...s,...n,ref:e})});DropdownMenuRadioItem.displayName=RADIO_ITEM_NAME;var INDICATOR_NAME="DropdownMenuItemIndicator",DropdownMenuItemIndicator=reactExports.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=useMenuScope(r);return jsxRuntimeExports.jsx(ItemIndicator,{...s,...n,ref:e})});DropdownMenuItemIndicator.displayName=INDICATOR_NAME;var SEPARATOR_NAME="DropdownMenuSeparator",DropdownMenuSeparator=reactExports.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=useMenuScope(r);return jsxRuntimeExports.jsx(Separator,{...s,...n,ref:e})});DropdownMenuSeparator.displayName=SEPARATOR_NAME;var ARROW_NAME$1="DropdownMenuArrow",DropdownMenuArrow=reactExports.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=useMenuScope(r);return jsxRuntimeExports.jsx(Arrow2$1,{...s,...n,ref:e})});DropdownMenuArrow.displayName=ARROW_NAME$1;var SUB_TRIGGER_NAME="DropdownMenuSubTrigger",DropdownMenuSubTrigger=reactExports.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=useMenuScope(r);return jsxRuntimeExports.jsx(SubTrigger,{...s,...n,ref:e})});DropdownMenuSubTrigger.displayName=SUB_TRIGGER_NAME;var SUB_CONTENT_NAME="DropdownMenuSubContent",DropdownMenuSubContent=reactExports.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=useMenuScope(r);return jsxRuntimeExports.jsx(SubContent,{...s,...n,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});DropdownMenuSubContent.displayName=SUB_CONTENT_NAME;var Root2=DropdownMenu,Trigger$1=DropdownMenuTrigger,Portal2=DropdownMenuPortal,Content2$1=DropdownMenuContent,Item2=DropdownMenuItem;const PanelAssistant=({enabled:t=!0,dragConstraints:e,initialPosition:r={x:0,y:0},onDragEnd:n,className:s="",onActionSubmit:a,goalId:o=null,onFocus:l,onExternalInput:u})=>{const[c,d]=reactExports.useState("idle"),[p,m]=reactExports.useState(!1),[y,b]=reactExports.useState(!1);React.useMemo(()=>new ChatService,[]);const E=React.useMemo(()=>new MindMapService(o),[o]),T=reactExports.useRef(null),[S,P]=reactExports.useState({showChoices:!1,showInput:!1,message:"",choices:[],inputText:"",inputPlaceholder:"和我分享你的想法吧",chatHistory:[]}),A=(ae,ce)=>{P(me=>{var Z;const te=ae(me),le={...me,...te};return"showInput"in te||(le.showInput=!(((Z=le.choices)==null?void 0:Z.length)>0)),console.log(`🔍 [${ce}] New state:`,le),le})},I=(ae,ce)=>{console.log("🔍 Form config:",ae),A(me=>{var te,le,Z;return{message:ce||me.message,showChoices:(((te=ae.options)==null?void 0:te.length)??0)>0,showInput:ae.showInput??!(((le=ae.options)==null?void 0:le.length)??0),inputPlaceholder:ae.description||"和我分享你的想法吧",choices:((Z=ae.options)==null?void 0:Z.map(Y=>({text:Y.label,icon:de(Y.action.type),description:"",action:async()=>{try{d("thinking"),await E.handleAction(Y.action.type,Y.action.params),d("idle")}catch(he){throw console.error("Failed to handle option click:",he),he instanceof Error&&he.message,A(oe=>({message:"哎呀！好像遇到了一點問題... 讓我看看"}),"handleOptionClick-error"),d("idle"),he}}})))||[]}},"updateUIFromForm")},j=reactExports.useCallback(()=>{T.current&&(T.current.scrollTop=T.current.scrollHeight)},[]);reactExports.useEffect(()=>{j()},[S.chatHistory,j]),reactExports.useEffect(()=>{c==="thinking"&&j()},[c,j]),reactExports.useEffect(()=>{P(ae=>({...ae,chatHistory:[],message:"嗨！今天想要做什麼呢？",showChoices:!0,showInput:!1,inputText:"",inputPlaceholder:"和我分享你的想法吧",choices:[{text:"看看導師有什麼建議",icon:jsxRuntimeExports.jsx(Target,{className:"h-12 w-12 text-emerald-600"}),description:"讓導師幫你規劃學習任務",action:()=>K("根據現在的主題和結構, 幫我建議 1~3 個新的學習任務")},{text:"看看今天的任務",icon:jsxRuntimeExports.jsx(MessageSquare,{className:"h-12 w-12 text-orange-600"}),description:"總結目前的主題內容",action:()=>K("總結整個主題的內容")},{text:"來聊聊天吧！",icon:jsxRuntimeExports.jsx(Brain,{className:"h-12 w-12 text-purple-600"}),description:"隨便聊聊吧",action:()=>W()}]}))},[o]);const K=ae=>{d("thinking"),H(ae)},W=()=>{d("idle"),A(ae=>({message:"好啊！想聊什麼呢？",showChoices:!1,showInput:!0,inputText:"",inputPlaceholder:"想聊什麼都可以喔！"}),"handleChatMode")},H=reactExports.useCallback(async ae=>{const ce=ae||S.inputText;if(!(!ce.trim()||y)){b(!0),d("thinking"),A(me=>({...me,inputText:"",chatHistory:[...me.chatHistory,{message:ce,role:"user"}]}),"handleSendMessage-clear");try{const me=await E.handleUserInput(ce);me.form?(I(me.form,me.message),A(te=>({chatHistory:[...te.chatHistory,{message:me.message.replace(/\\n/g,`
`),role:"assistant"}]}),"handleSendMessage-response")):A(te=>({message:me.message||"你想跟我說什麼呢",chatHistory:[...te.chatHistory,{message:me.message.replace(/\\n/g,`
`),role:"assistant"}]}),"handleSendMessage"),d("idle")}catch(me){console.error("Failed to send message:",me),A(te=>({message:"抱歉，發生了一些錯誤，請稍後再試。",chatHistory:[...te.chatHistory,{message:"抱歉，發生了一些錯誤，請稍後再試。",role:"assistant"}]}),"handleSendMessage-error"),d("idle")}finally{b(!1)}}},[S.inputText,y,E]),ee=reactExports.useCallback(ae=>{ae.key==="Enter"&&!ae.shiftKey&&(ae.preventDefault(),H())},[H]),ue=()=>{p||(c==="idle"&&!S.message&&!S.showChoices&&!S.showInput?(d("idle"),A(ae=>({message:"嗨！今天想要做什麼呢？",showChoices:!0,showInput:!1,inputText:"",inputPlaceholder:"和我分享你的想法吧",choices:[{text:"幫我想分類",icon:jsxRuntimeExports.jsx(ListChecks,{className:"h-12 w-12 text-indigo-600"}),description:"幫你規劃學習目標的分類",action:()=>K("根據現在的主題和結構, 幫我建議 1~3 個學習步驟")},{text:"幫我想任務",icon:jsxRuntimeExports.jsx(Target,{className:"h-12 w-12 text-emerald-600"}),description:"幫你規劃具體的學習任務",action:()=>K("根據現在的主題和結構, 幫我建議 1~3 個新的學習任務")},{text:"跟我聊聊這個主題",icon:jsxRuntimeExports.jsx(MessageSquare,{className:"h-12 w-12 text-orange-600"}),description:"討論這個主題的相關內容",action:()=>K("跟我聊聊這個主題, 有沒有推薦的方向呢？")},{text:"隨便聊聊天",icon:jsxRuntimeExports.jsx(Brain,{className:"h-12 w-12 text-purple-600"}),description:"來聊聊天吧！",action:()=>W()}]}),"handleAssistantClick-show")):(d("idle"),A(ae=>({message:"",showChoices:!1,showInput:!1,inputText:"",choices:[]}),"handleAssistantClick-hide")))},de=ae=>{const ce=[jsxRuntimeExports.jsx(Lightbulb,{className:"h-12 w-12 text-yellow-500"}),jsxRuntimeExports.jsx(ListChecks,{className:"h-12 w-12 text-blue-500"}),jsxRuntimeExports.jsx(Target,{className:"h-12 w-12 text-red-500"}),jsxRuntimeExports.jsx(Bookmark,{className:"h-12 w-12 text-purple-500"}),jsxRuntimeExports.jsx(CircleCheckBig,{className:"h-12 w-12 text-green-500"}),jsxRuntimeExports.jsx(Compass,{className:"h-12 w-12 text-indigo-500"}),jsxRuntimeExports.jsx(MessageSquare,{className:"h-12 w-12 text-teal-500"}),jsxRuntimeExports.jsx(Brain,{className:"h-12 w-12 text-emerald-600"})],me=Math.floor(Math.random()*ce.length);return ce[me]},fe=reactExports.useCallback((ae,ce)=>{console.log("🔍 External input:",ae,ce),ae!=null&&ae.trim()&&(d("thinking"),ce&&E.setMode(ce.mode),H(ae))},[H,E]);return reactExports.useEffect(()=>{console.log("🔍 Setting up external input handler"),u&&u((ce,me)=>{console.log("🔍 External input received:",ce,me),ce&&fe(ce,me)})},[u,fe]),jsxRuntimeExports.jsx(AnimatePresence,{children:t&&jsxRuntimeExports.jsx(motion.div,{className:`fixed bottom-6 right-6 z-50 ${s}`,initial:!1,animate:{width:c==="idle"&&!S.message&&!S.showChoices&&!S.showInput?"80px":"400px",height:c==="idle"&&!S.message&&!S.showChoices&&!S.showInput?"80px":"calc(100vh - 48px)"},transition:{duration:.3},children:c==="idle"&&!S.message&&!S.showChoices&&!S.showInput?jsxRuntimeExports.jsx(motion.button,{onClick:ue,className:"w-20 h-20 rounded-full bg-white dark:bg-gray-800 shadow-lg overflow-hidden hover:shadow-xl transition-shadow relative cursor-pointer",children:jsxRuntimeExports.jsx(Lottie,{animationData:slothAnimation,loop:!0,className:"w-[120%] h-[120%] -translate-x-[7%] -translate-y-[5%] pointer-events-none"})}):jsxRuntimeExports.jsxs(motion.div,{className:"w-full h-full bg-gradient-to-br from-purple-100/90 to-pink-100/90 dark:from-purple-900/40 dark:to-pink-900/40 backdrop-blur-sm rounded-2xl shadow-xl flex flex-col overflow-hidden relative",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(rgba(255,255,255,0.08)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.08)_1px,transparent_1px)] bg-[size:20px_20px] [mask-image:radial-gradient(ellipse_at_center,transparent_20%,black_70%)] dark:bg-[linear-gradient(rgba(255,255,255,0.03)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.03)_1px,transparent_1px)]"}),jsxRuntimeExports.jsx("div",{className:"absolute top-4 right-4 w-24 h-24 z-10",children:jsxRuntimeExports.jsx(Lottie,{animationData:slothAnimation,loop:!0,className:"w-full h-full"})}),jsxRuntimeExports.jsx("div",{className:"flex items-center p-4 relative",children:jsxRuntimeExports.jsx("div",{className:"flex items-center space-x-3",children:jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-purple-800/90 dark:text-purple-200/90 select-text",children:"樹懶小幫手"})})}),jsxRuntimeExports.jsxs("div",{ref:T,className:"flex-1 overflow-y-auto p-4 space-y-4 relative",children:[S.chatHistory.map((ae,ce)=>jsxRuntimeExports.jsx("div",{className:`flex ${ae.role==="user"?"justify-end":"justify-start"}`,children:jsxRuntimeExports.jsx("div",{className:`max-w-[80%] rounded-2xl p-3 backdrop-blur-sm select-text ${ae.role==="user"?"bg-purple-500/90 text-white shadow-md":"bg-white/80 dark:bg-purple-900/30 text-gray-900 dark:text-gray-100 shadow-sm"}`,children:ae.message.split(`
`).map((me,te)=>jsxRuntimeExports.jsxs(React.Fragment,{children:[me.split(/(\*\*.*?\*\*)/).map((le,Z)=>le.startsWith("**")&&le.endsWith("**")?jsxRuntimeExports.jsx("strong",{children:le.slice(2,-2)},Z):le),te<ae.message.split(`
`).length-1&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("br",{})]})]},te))})},ce)),c==="thinking"&&jsxRuntimeExports.jsx("div",{className:"flex justify-start",children:jsxRuntimeExports.jsx("div",{className:"bg-white/80 dark:bg-purple-900/30 rounded-2xl p-3 shadow-sm backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"flex space-x-2",children:[jsxRuntimeExports.jsx(motion.div,{animate:{scale:[1,1.2,1],opacity:[1,.5,1]},transition:{duration:1,repeat:1/0,delay:0},className:"w-2 h-2 bg-purple-500/80 rounded-full"}),jsxRuntimeExports.jsx(motion.div,{animate:{scale:[1,1.2,1],opacity:[1,.5,1]},transition:{duration:1,repeat:1/0,delay:.3},className:"w-2 h-2 bg-purple-500/80 rounded-full"}),jsxRuntimeExports.jsx(motion.div,{animate:{scale:[1,1.2,1],opacity:[1,.5,1]},transition:{duration:1,repeat:1/0,delay:.6},className:"w-2 h-2 bg-purple-500/80 rounded-full"})]})})})]}),S.showChoices&&S.choices.length>0&&jsxRuntimeExports.jsx("div",{className:"p-4 relative",children:jsxRuntimeExports.jsx("div",{className:"space-y-2",children:S.choices.map((ae,ce)=>jsxRuntimeExports.jsxs(motion.button,{whileHover:{scale:1.02},whileTap:{scale:.95},onClick:()=>ae.action(),className:"w-full p-3 bg-white/80 dark:bg-purple-900/30 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 flex items-center space-x-3 backdrop-blur-sm",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-purple-50/80 dark:bg-purple-900/50 rounded-full flex items-center justify-center",children:ae.icon}),jsxRuntimeExports.jsxs("div",{className:"flex-1 text-left",children:[jsxRuntimeExports.jsx("h3",{className:"text-base font-bold text-gray-900 dark:text-gray-100",children:ae.text}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-xs",children:ae.description})]})]},ce))})}),jsxRuntimeExports.jsx("div",{className:"p-4 bg-white/80 dark:bg-purple-900/30 backdrop-blur-sm relative",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsx("textarea",{value:S.inputText,onChange:ae=>P(ce=>({...ce,inputText:ae.target.value})),onKeyPress:ee,placeholder:S.inputPlaceholder||"和我分享你的想法吧...",className:"flex-1 resize-none rounded-lg border border-purple-200/50 dark:border-purple-700/50 p-3 focus:outline-none focus:ring-2 focus:ring-purple-500/50 bg-white/80 dark:bg-purple-900/30 text-gray-900 dark:text-gray-100 text-sm backdrop-blur-sm",rows:2}),jsxRuntimeExports.jsx(motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>H(),disabled:y||!S.inputText.trim(),className:"p-3 bg-purple-500/90 text-white rounded-lg hover:bg-purple-600/90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-sm",children:y?jsxRuntimeExports.jsx(LoaderCircle,{className:"h-5 w-5 animate-spin"}):jsxRuntimeExports.jsx(Send,{className:"h-5 w-5"})})]})})]})})})};var VISUALLY_HIDDEN_STYLES=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),NAME="VisuallyHidden",VisuallyHidden=reactExports.forwardRef((t,e)=>jsxRuntimeExports.jsx(Primitive.span,{...t,ref:e,style:{...VISUALLY_HIDDEN_STYLES,...t.style}}));VisuallyHidden.displayName=NAME;var Root=VisuallyHidden,[createTooltipContext,createTooltipScope]=createContextScope("Tooltip",[createPopperScope]),usePopperScope=createPopperScope(),PROVIDER_NAME="TooltipProvider",DEFAULT_DELAY_DURATION=700,TOOLTIP_OPEN="tooltip.open",[TooltipProviderContextProvider,useTooltipProviderContext]=createTooltipContext(PROVIDER_NAME),TooltipProvider=t=>{const{__scopeTooltip:e,delayDuration:r=DEFAULT_DELAY_DURATION,skipDelayDuration:n=300,disableHoverableContent:s=!1,children:a}=t,o=reactExports.useRef(!0),l=reactExports.useRef(!1),u=reactExports.useRef(0);return reactExports.useEffect(()=>{const c=u.current;return()=>window.clearTimeout(c)},[]),jsxRuntimeExports.jsx(TooltipProviderContextProvider,{scope:e,isOpenDelayedRef:o,delayDuration:r,onOpen:reactExports.useCallback(()=>{window.clearTimeout(u.current),o.current=!1},[]),onClose:reactExports.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>o.current=!0,n)},[n]),isPointerInTransitRef:l,onPointerInTransitChange:reactExports.useCallback(c=>{l.current=c},[]),disableHoverableContent:s,children:a})};TooltipProvider.displayName=PROVIDER_NAME;var TOOLTIP_NAME="Tooltip",[TooltipContextProvider,useTooltipContext]=createTooltipContext(TOOLTIP_NAME),Tooltip=t=>{const{__scopeTooltip:e,children:r,open:n,defaultOpen:s,onOpenChange:a,disableHoverableContent:o,delayDuration:l}=t,u=useTooltipProviderContext(TOOLTIP_NAME,t.__scopeTooltip),c=usePopperScope(e),[d,p]=reactExports.useState(null),m=useId(),y=reactExports.useRef(0),b=o??u.disableHoverableContent,E=l??u.delayDuration,T=reactExports.useRef(!1),[S,P]=useControllableState({prop:n,defaultProp:s??!1,onChange:W=>{W?(u.onOpen(),document.dispatchEvent(new CustomEvent(TOOLTIP_OPEN))):u.onClose(),a==null||a(W)},caller:TOOLTIP_NAME}),A=reactExports.useMemo(()=>S?T.current?"delayed-open":"instant-open":"closed",[S]),I=reactExports.useCallback(()=>{window.clearTimeout(y.current),y.current=0,T.current=!1,P(!0)},[P]),j=reactExports.useCallback(()=>{window.clearTimeout(y.current),y.current=0,P(!1)},[P]),K=reactExports.useCallback(()=>{window.clearTimeout(y.current),y.current=window.setTimeout(()=>{T.current=!0,P(!0),y.current=0},E)},[E,P]);return reactExports.useEffect(()=>()=>{y.current&&(window.clearTimeout(y.current),y.current=0)},[]),jsxRuntimeExports.jsx(Root2$1,{...c,children:jsxRuntimeExports.jsx(TooltipContextProvider,{scope:e,contentId:m,open:S,stateAttribute:A,trigger:d,onTriggerChange:p,onTriggerEnter:reactExports.useCallback(()=>{u.isOpenDelayedRef.current?K():I()},[u.isOpenDelayedRef,K,I]),onTriggerLeave:reactExports.useCallback(()=>{b?j():(window.clearTimeout(y.current),y.current=0)},[j,b]),onOpen:I,onClose:j,disableHoverableContent:b,children:r})})};Tooltip.displayName=TOOLTIP_NAME;var TRIGGER_NAME="TooltipTrigger",TooltipTrigger=reactExports.forwardRef((t,e)=>{const{__scopeTooltip:r,...n}=t,s=useTooltipContext(TRIGGER_NAME,r),a=useTooltipProviderContext(TRIGGER_NAME,r),o=usePopperScope(r),l=reactExports.useRef(null),u=useComposedRefs(e,l,s.onTriggerChange),c=reactExports.useRef(!1),d=reactExports.useRef(!1),p=reactExports.useCallback(()=>c.current=!1,[]);return reactExports.useEffect(()=>()=>document.removeEventListener("pointerup",p),[p]),jsxRuntimeExports.jsx(Anchor,{asChild:!0,...o,children:jsxRuntimeExports.jsx(Primitive.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...n,ref:u,onPointerMove:composeEventHandlers(t.onPointerMove,m=>{m.pointerType!=="touch"&&!d.current&&!a.isPointerInTransitRef.current&&(s.onTriggerEnter(),d.current=!0)}),onPointerLeave:composeEventHandlers(t.onPointerLeave,()=>{s.onTriggerLeave(),d.current=!1}),onPointerDown:composeEventHandlers(t.onPointerDown,()=>{s.open&&s.onClose(),c.current=!0,document.addEventListener("pointerup",p,{once:!0})}),onFocus:composeEventHandlers(t.onFocus,()=>{c.current||s.onOpen()}),onBlur:composeEventHandlers(t.onBlur,s.onClose),onClick:composeEventHandlers(t.onClick,s.onClose)})})});TooltipTrigger.displayName=TRIGGER_NAME;var PORTAL_NAME="TooltipPortal",[PortalProvider,usePortalContext]=createTooltipContext(PORTAL_NAME,{forceMount:void 0}),TooltipPortal=t=>{const{__scopeTooltip:e,forceMount:r,children:n,container:s}=t,a=useTooltipContext(PORTAL_NAME,e);return jsxRuntimeExports.jsx(PortalProvider,{scope:e,forceMount:r,children:jsxRuntimeExports.jsx(Presence,{present:r||a.open,children:jsxRuntimeExports.jsx(Portal$2,{asChild:!0,container:s,children:n})})})};TooltipPortal.displayName=PORTAL_NAME;var CONTENT_NAME="TooltipContent",TooltipContent=reactExports.forwardRef((t,e)=>{const r=usePortalContext(CONTENT_NAME,t.__scopeTooltip),{forceMount:n=r.forceMount,side:s="top",...a}=t,o=useTooltipContext(CONTENT_NAME,t.__scopeTooltip);return jsxRuntimeExports.jsx(Presence,{present:n||o.open,children:o.disableHoverableContent?jsxRuntimeExports.jsx(TooltipContentImpl,{side:s,...a,ref:e}):jsxRuntimeExports.jsx(TooltipContentHoverable,{side:s,...a,ref:e})})}),TooltipContentHoverable=reactExports.forwardRef((t,e)=>{const r=useTooltipContext(CONTENT_NAME,t.__scopeTooltip),n=useTooltipProviderContext(CONTENT_NAME,t.__scopeTooltip),s=reactExports.useRef(null),a=useComposedRefs(e,s),[o,l]=reactExports.useState(null),{trigger:u,onClose:c}=r,d=s.current,{onPointerInTransitChange:p}=n,m=reactExports.useCallback(()=>{l(null),p(!1)},[p]),y=reactExports.useCallback((b,E)=>{const T=b.currentTarget,S={x:b.clientX,y:b.clientY},P=getExitSideFromRect(S,T.getBoundingClientRect()),A=getPaddedExitPoints(S,P),I=getPointsFromRect(E.getBoundingClientRect()),j=getHull([...A,...I]);l(j),p(!0)},[p]);return reactExports.useEffect(()=>()=>m(),[m]),reactExports.useEffect(()=>{if(u&&d){const b=T=>y(T,d),E=T=>y(T,u);return u.addEventListener("pointerleave",b),d.addEventListener("pointerleave",E),()=>{u.removeEventListener("pointerleave",b),d.removeEventListener("pointerleave",E)}}},[u,d,y,m]),reactExports.useEffect(()=>{if(o){const b=E=>{const T=E.target,S={x:E.clientX,y:E.clientY},P=(u==null?void 0:u.contains(T))||(d==null?void 0:d.contains(T)),A=!isPointInPolygon(S,o);P?m():A&&(m(),c())};return document.addEventListener("pointermove",b),()=>document.removeEventListener("pointermove",b)}},[u,d,o,c,m]),jsxRuntimeExports.jsx(TooltipContentImpl,{...t,ref:a})}),[VisuallyHiddenContentContextProvider,useVisuallyHiddenContentContext]=createTooltipContext(TOOLTIP_NAME,{isInside:!1}),Slottable=createSlottable("TooltipContent"),TooltipContentImpl=reactExports.forwardRef((t,e)=>{const{__scopeTooltip:r,children:n,"aria-label":s,onEscapeKeyDown:a,onPointerDownOutside:o,...l}=t,u=useTooltipContext(CONTENT_NAME,r),c=usePopperScope(r),{onClose:d}=u;return reactExports.useEffect(()=>(document.addEventListener(TOOLTIP_OPEN,d),()=>document.removeEventListener(TOOLTIP_OPEN,d)),[d]),reactExports.useEffect(()=>{if(u.trigger){const p=m=>{const y=m.target;y!=null&&y.contains(u.trigger)&&d()};return window.addEventListener("scroll",p,{capture:!0}),()=>window.removeEventListener("scroll",p,{capture:!0})}},[u.trigger,d]),jsxRuntimeExports.jsx(DismissableLayer,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:a,onPointerDownOutside:o,onFocusOutside:p=>p.preventDefault(),onDismiss:d,children:jsxRuntimeExports.jsxs(Content,{"data-state":u.stateAttribute,...c,...l,ref:e,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[jsxRuntimeExports.jsx(Slottable,{children:n}),jsxRuntimeExports.jsx(VisuallyHiddenContentContextProvider,{scope:r,isInside:!0,children:jsxRuntimeExports.jsx(Root,{id:u.contentId,role:"tooltip",children:s||n})})]})})});TooltipContent.displayName=CONTENT_NAME;var ARROW_NAME="TooltipArrow",TooltipArrow=reactExports.forwardRef((t,e)=>{const{__scopeTooltip:r,...n}=t,s=usePopperScope(r);return useVisuallyHiddenContentContext(ARROW_NAME,r).isInside?null:jsxRuntimeExports.jsx(Arrow,{...s,...n,ref:e})});TooltipArrow.displayName=ARROW_NAME;function getExitSideFromRect(t,e){const r=Math.abs(e.top-t.y),n=Math.abs(e.bottom-t.y),s=Math.abs(e.right-t.x),a=Math.abs(e.left-t.x);switch(Math.min(r,n,s,a)){case a:return"left";case s:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function getPaddedExitPoints(t,e,r=5){const n=[];switch(e){case"top":n.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":n.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":n.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":n.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return n}function getPointsFromRect(t){const{top:e,right:r,bottom:n,left:s}=t;return[{x:s,y:e},{x:r,y:e},{x:r,y:n},{x:s,y:n}]}function isPointInPolygon(t,e){const{x:r,y:n}=t;let s=!1;for(let a=0,o=e.length-1;a<e.length;o=a++){const l=e[a],u=e[o],c=l.x,d=l.y,p=u.x,m=u.y;d>n!=m>n&&r<(p-c)*(n-d)/(m-d)+c&&(s=!s)}return s}function getHull(t){const e=t.slice();return e.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),getHullPresorted(e)}function getHullPresorted(t){if(t.length<=1)return t.slice();const e=[];for(let n=0;n<t.length;n++){const s=t[n];for(;e.length>=2;){const a=e[e.length-1],o=e[e.length-2];if((a.x-o.x)*(s.y-o.y)>=(a.y-o.y)*(s.x-o.x))e.pop();else break}e.push(s)}e.pop();const r=[];for(let n=t.length-1;n>=0;n--){const s=t[n];for(;r.length>=2;){const a=r[r.length-1],o=r[r.length-2];if((a.x-o.x)*(s.y-o.y)>=(a.y-o.y)*(s.x-o.x))r.pop();else break}r.push(s)}return r.pop(),e.length===1&&r.length===1&&e[0].x===r[0].x&&e[0].y===r[0].y?e:e.concat(r)}var Provider$1=TooltipProvider,Root3=Tooltip,Trigger=TooltipTrigger,Portal=TooltipPortal,Content2=TooltipContent,Arrow2=TooltipArrow;const getStepColors=(t,e)=>{const r=[{bg:"from-purple-50 to-purple-100",border:"border-purple-100",icon:"text-purple-400",text:"text-purple-600"},{bg:"from-purple-50 to-purple-100",border:"border-purple-200",icon:"text-purple-500",text:"text-purple-700"},{bg:"from-purple-50 to-purple-200",border:"border-purple-300",icon:"text-purple-600",text:"text-purple-800"},{bg:"from-purple-50 to-purple-200",border:"border-purple-400",icon:"text-purple-700",text:"text-purple-900"},{bg:"from-purple-50 to-purple-300",border:"border-purple-500",icon:"text-purple-800",text:"text-purple-900"},{bg:"from-purple-50 to-purple-300",border:"border-purple-600",icon:"text-purple-900",text:"text-purple-900"},{bg:"from-purple-50 to-purple-400",border:"border-purple-700",icon:"text-purple-900",text:"text-purple-900"}],n=Math.min(t,6),s=r[n];return{gradient:s.bg,border:s.border,icon:s.icon,text:s.text}},useElementStack=(t=1)=>{const[e,r]=reactExports.useState({}),n=reactExports.useCallback(a=>{const o=Object.values(e).reduce((l,u)=>Math.max(l,u),t);r(l=>({...l,[a]:o+1}))},[e,t]),s=reactExports.useCallback(a=>e[a]||t,[e,t]);return{bringToFront:n,getIndex:s}},GoalMindMap=({goalId:t,onBack:e})=>{const{goals:r,addGoal:n}=useGoalStore(),s=r.find(Se=>Se.id===t)||null,a=React.useMemo(()=>new MindMapService(t),[t]),[o,l]=reactExports.useState([]),[u,c]=reactExports.useState(new Map);reactExports.useEffect(()=>{if(!s){l([]),c(new Map);return}const Se=useGoalStore.getState().getActiveSteps(t),We=new Map;Se.forEach(et=>{We.set(et.id,useGoalStore.getState().getActiveTasks(t,et.id))}),l(Se),c(We)},[s,t]),reactExports.useEffect(()=>{const Se=useGoalStore.subscribe(We=>{if(!We.goals.find(qe=>qe.id===t))return;const Ye=We.getActiveSteps(t),Xe=new Map;Ye.forEach(qe=>{Xe.set(qe.id,We.getActiveTasks(t,qe.id))}),l(Ye),c(Xe)});return()=>Se()},[t]);const[d,p]=reactExports.useState(null),[m,y]=reactExports.useState(!1),[b,E]=reactExports.useState(null),[T,S]=reactExports.useState(""),[P,A]=reactExports.useState(.8),[I,j]=reactExports.useState({x:0,y:0}),[K,W]=reactExports.useState(!1),H=reactExports.useRef(null),ee=reactExports.useRef(null),[ue,de]=reactExports.useState(!0),[fe,ae]=reactExports.useState(!0),[ce,me]=reactExports.useState({}),[te,le]=reactExports.useState({}),[Z,Y]=reactExports.useState({}),[he,oe]=reactExports.useState(null),[ye,Ee]=reactExports.useState({x:200,y:0}),[Ae,je]=reactExports.useState({x:0,y:0}),[Te,Ve]=reactExports.useState({}),[Pe,Ce]=reactExports.useState("floating"),[De,ze]=reactExports.useState([]),[Et,Ze]=reactExports.useState({}),[Ue,qt]=reactExports.useState(null),[or,Lt]=reactExports.useState(""),[rt,lr]=reactExports.useState(null);reactExports.useEffect(()=>{console.log("🔍 Assistant input handler updated:",!!rt)},[rt]);const ir=reactExports.useCallback(Se=>{console.log("🔍 Setting assistant input handler"),lr(()=>Se)},[]),er=reactExports.useCallback(Se=>{if(de(!0),ae(!0),A(.8),j({x:0,y:0}),l([]),c(new Map),p(null),y(!1),E(null),S(""),Qr(null),Lr(""),qt(null),Lt(""),me({}),le({}),Ze({}),ze([]),je({x:0,y:0}),Ee({x:200,y:0}),Se){const We=useGoalStore.getState().getActiveSteps(t),et=new Map;We.forEach(Xe=>{et.set(Xe.id,useGoalStore.getState().getActiveTasks(t,Xe.id))}),l(We),c(et);const Ye=Se.bubbles||[];ze(Ye)}},[t]);reactExports.useEffect(()=>{er(s)},[t,er]);const xr=useMotionValue(0),br=useMotionValue(0);reactExports.useRef(new Map),useMotionValueEvent(xr,"change",Se=>{je(We=>({...We,x:Se}))}),useMotionValueEvent(br,"change",Se=>{je(We=>({...We,y:Se}))});const Pr=reactExports.useCallback(()=>{if(!H.current||!s)return;const Se=H.current,We=Se.clientWidth,et=Se.clientHeight,Xe=s.steps.filter(Fs=>Fs.status!=="archived").reduce((Fs,Wi)=>{const La=Math.max(120,160*Math.max(1,Wi.tasks.length));return Fs+La},0)||10,qe=0,kt=s.steps.filter(Fs=>Fs.status!=="archived").length>0,Wt=s.steps.filter(Fs=>Fs.status!=="archived").some(Fs=>Fs.tasks.length>0),Kr=(kt?Wt?1256:800:500)-qe,un=We*.8/Kr,An=et*.8/Xe,Sn=Math.min(Math.max(.8,Math.min(un,An)),1.2),Fa=((kt?We*.1:We*.35)-qe*Sn)/Sn,ho=(et-Xe*Sn)/2/Sn;return{zoom:Sn,position:{x:Fa,y:ho}}},[s]);reactExports.useEffect(()=>{if(ue){const Se=setTimeout(()=>{const We=Pr();We&&(A(We.zoom),j(We.position)),de(!1),setTimeout(()=>{ae(!1)},500)},500);return()=>clearTimeout(Se)}},[ue,Pr]),reactExports.useEffect(()=>{if(s&&ue){const Se={},We={};s.steps.filter(et=>et.status!=="archived").forEach((et,Ye)=>{Se[et.id]={x:0,y:0},et.tasks.forEach(Xe=>{We[Xe.id]={x:0,y:0}})}),me(Se),le(We)}},[s]);const zr=reactExports.useCallback(Se=>{var cr;const We=(cr=H.current)==null?void 0:cr.getBoundingClientRect();if(!We)return;const et=We.width/2,Ye=We.height/2,Xe=Math.min(Math.max(.4,P+Se),2),qe=et/P-I.x,kt=Ye/P-I.y,Wt={x:et/Xe-qe,y:Ye/Xe-kt};A(Xe),j(Wt)},[P,I]);reactExports.useCallback(Se=>{var We;if(Se.ctrlKey||Se.metaKey){Se.stopPropagation(),Se.preventDefault();const et=(We=H.current)==null?void 0:We.getBoundingClientRect();if(!et)return;const Ye=Se.clientX-et.left,Xe=Se.clientY-et.top,qe=Se.deltaY>0?-.05:.05,kt=Math.min(Math.max(.4,P+qe),2),Wt=Ye/P-I.x,cr=Xe/P-I.y,nr={x:Ye/kt-Wt,y:Xe/kt-cr};j(nr),A(kt)}},[P,I]);const pr=reactExports.useCallback(Se=>{Se.touches.length===2&&Se.preventDefault()},[]);React.useEffect(()=>{const Se=H.current;if(Se){Se.addEventListener("touchstart",pr,{passive:!1}),Se.addEventListener("touchmove",pr,{passive:!1});const We=et=>{if(et.ctrlKey||et.metaKey){et.preventDefault();const Ye=Se.getBoundingClientRect();if(!Ye)return;const Xe=et.clientX-Ye.left,qe=et.clientY-Ye.top,kt=et.deltaY>0?-.05:.05,Wt=Math.min(Math.max(.4,P+kt),2),cr=Xe/P-I.x,nr=qe/P-I.y,Kr={x:Xe/Wt-cr,y:qe/Wt-nr};j(Kr),A(Wt)}};return Se.addEventListener("wheel",We,{passive:!1}),()=>{Se.removeEventListener("touchstart",pr),Se.removeEventListener("touchmove",pr),Se.removeEventListener("wheel",We)}}},[pr,P,I]);const dr=reactExports.useCallback(Se=>{if(console.log("Canvas mouse down event triggered"),!Se.target.closest(".floating-assistant, .goal-node, .step-node, .task-card, .bubble-node")&&Se.button===0){document.body.style.userSelect="none",document.body.style.webkitUserSelect="none",W(!0);const We=Se.clientX-I.x,et=Se.clientY-I.y,Ye=qe=>{j({x:qe.clientX-We,y:qe.clientY-et})},Xe=()=>{W(!1),document.body.style.userSelect="",document.body.style.webkitUserSelect="",document.removeEventListener("mousemove",Ye),document.removeEventListener("mouseup",Xe)};document.addEventListener("mousemove",Ye),document.addEventListener("mouseup",Xe)}},[I]),Ar=()=>({x:-150,y:-150}),{isVisible:_r,setPosition:It,toggleAssistant:Bt}=useAssistant({position:Ar()}),ur=()=>{Bt(),_r||It(Ar())},Vn=Se=>{console.log("Assistant dropped at screen position:",Se)},gn=Se=>{console.log("🎯 飛到元素:",Se),setTimeout(()=>{const We=document.getElementById(Se);if(!We){console.log("❌ 找不到元素:",Se);return}const et=H.current;if(!et){console.log("❌ 找不到容器");return}const Ye=We.getBoundingClientRect(),Xe=et.clientWidth,qe=et.clientHeight,kt=Ye.left+Ye.width/2,Wt=Ye.top+Ye.height/2,cr=Xe/2,nr=qe/2,Kr=cr-kt,un=nr-Wt,An={x:I.x+Kr/P,y:I.y+un/P};console.log("🎯 計算後的位置",{current:{x:I.x,y:I.y},element:{centerX:kt,centerY:Wt},container:{centerX:cr,centerY:nr},delta:{dx:Kr,dy:un},new:An,zoom:P}),requestAnimationFrame(()=>{j(An)}),setTimeout(()=>{a.clearFocusElement()},500)},100)};reactExports.useEffect(()=>{const Se=useGoalStore.subscribe(We=>{const et=We.goals.find(Ye=>Ye.id===t);if(et!=null&&et.focusElement){const Ye=`${et.focusElement.type}-${et.focusElement.id}`;requestAnimationFrame(()=>{requestAnimationFrame(()=>{gn(Ye)})})}});return()=>Se()},[t,a,I,P]);const[yn,Dr]=reactExports.useState(!1),[Nr,wn]=reactExports.useState(""),jn=Se=>{if(!s||!Se.trim())return;const We={...s,title:Se.trim()};a.updateGoal(We),Dr(!1)},$r=reactExports.useMemo(()=>(Se,We)=>{var kt;let Ye=0;const Xe=useGoalStore.getState().getActiveSteps(t);for(let Wt=0;Wt<Se;Wt++)Xe[Wt]&&(Ye+=160*Math.max(1,Xe[Wt].tasks.length));const qe=160*Math.max(1,((kt=Xe[Se])==null?void 0:kt.tasks.length)||1);return Ye+=qe/2,{x:700,y:Ye}},[t]),Cr=reactExports.useMemo(()=>s?{x:200,y:(s.steps.filter(We=>We.status!=="archived").length>0?$r(s.steps.length,s.steps).y:0)/2}:{x:200,y:0},[s,$r]),Ir=reactExports.useCallback((Se,We)=>{if(!((s==null?void 0:s.id)===Se?s:s==null?void 0:s.steps.find(Sn=>Sn.id===Se)))return;const Xe=De.filter(Sn=>Sn.parentId===Se).length,qe=Cr.x-200,kt=128,Wt=40,cr=kt*3+Wt*2,nr=Cr.y-cr/2+kt/2,Kr=(kt+Wt)*Xe,un={x:qe,y:nr+Kr},An={id:`bubble-${Date.now()}`,title:We==="impression"?"新印象":"新背景",parentId:Se,bubbleType:We,content:"",position:un};a.addBubble(An)},[s,Cr,De,a]),kr=reactExports.useCallback(Se=>{s&&window.confirm("確定要刪除這個氣泡嗎？")&&a.deleteBubble(Se)},[s,a]),Er=reactExports.useCallback((Se,We)=>{s&&a.updateBubble(Se,We)},[s,a]);reactExports.useEffect(()=>{if(!s){ze([]);return}const We=(s.bubbles||[]).map((et,Ye)=>{const Xe=Cr.x-200,qe=128,kt=40,Wt=qe*3+kt*2,cr=Cr.y-Wt/2+qe/2,nr=(qe+kt)*Ye;return{...et,position:{x:Xe,y:cr+nr}}});ze(We)},[s,Cr]),reactExports.useEffect(()=>{const Se=useGoalStore.subscribe(We=>{const et=We.goals.find(Ye=>Ye.id===t);et&&ze(et.bubbles||[])});return()=>Se()},[t]);const Nn=reactExports.useCallback(Se=>{if(s&&window.confirm("確定要刪除這個步驟嗎？這會同時刪除所有相關的任務。")){a.deleteStep(Se);const We=Pr();We&&(A(We.zoom),j(We.position))}},[s,a,Pr]),Hr=reactExports.useCallback((Se,We)=>{if(s&&window.confirm("確定要刪除這個任務嗎？")){a.deleteTask(Se,We);const et=useGoalStore.getState().getActiveSteps(t),Ye={};et.forEach((qe,kt)=>{const Wt=$r(kt,s.steps),cr=ce[qe.id]||{x:0,y:0},nr=Wt.y,Kr=Wt.y+cr.y,un=nr-Kr;Ye[qe.id]={x:cr.x,y:un}}),me(Ye);const Xe=Pr();Xe&&(A(Xe.zoom),j(Xe.position))}},[s,a,Pr,t,ce,$r]);if(t==="new")return jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full",children:jsxRuntimeExports.jsx(Lottie,{animationData:loadingAnimation,loop:!0,className:"w-48 h-48"})});if(!s)return jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full",children:jsxRuntimeExports.jsx("p",{className:"text-gray-500",children:"找不到目標"})});const qr=reactExports.useMemo(()=>(Se,We,et)=>{const Ye=$r(Se,s.steps),Xe=200,qe=120,kt=40;if(!useGoalStore.getState().getActiveSteps(t)[Se])return{x:0,y:0};const nr=qe*We+kt*We,Kr=qe*et+kt*(et-1),un=Ye.y-Kr/2+nr;return{x:Ye.x+Xe,y:un}},[s,$r,t]),Fr=(Se,We)=>{const et=We.x-Se.x,Ye=We.y-Se.y,qe=Math.sqrt(et*et+Ye*Ye)*.5;return{start:Se,end:We,control1:{x:Se.x+qe,y:Se.y},control2:{x:We.x-qe,y:We.y}}};reactExports.useCallback(Se=>{const We=(s==null?void 0:s.steps.findIndex(cr=>cr.id===Se))??-1;if(We===-1)return;const et=$r(We,s.steps),Ye=H.current;if(!Ye)return;const Xe=Ye.clientWidth,qe=Ye.clientHeight,kt=Xe/2/P-et.x,Wt=qe/2/P-et.y;j({x:kt,y:Wt})},[P,$r]);const Dn=reactExports.useCallback(()=>{if(!s)return;const Se={title:"新步驟",tasks:[]};console.log("📝 準備新增步驟",{newStep:Se});const We=a.addStep(Se);if(console.log("✅ 步驟已新增到 store",{addedStep:We}),!We)return;const et=useGoalStore.getState().goals.find(un=>un.id===t);if(!et||!et.steps.find(un=>un.id===We.id))return;const Xe=et.steps.length-1,qe=$r(Xe,et.steps),kt=H.current;if(!kt)return;const Wt=kt.clientWidth,cr=kt.clientHeight,nr=Wt/2/P-qe.x,Kr=cr/2/P-qe.y;j({x:nr,y:Kr})},[s,a,P,t,$r]),yr=reactExports.useCallback((Se,We)=>{if(!We.trim())return;const et=useGoalStore.getState().goals.find(Xe=>Xe.id===t);if(!et)return;const Ye=et.steps.find(Xe=>Xe.id===Se);Ye&&(a.updateStep(Se,{...Ye,title:We.trim()}),E(null),S(""),useGoalStore.getState().dump(t))},[t,a]),{bringToFront:Wr,getIndex:vr}=useElementStack(1),[jr,Qr]=reactExports.useState(null),[xn,Lr]=reactExports.useState(""),_s=reactExports.useCallback(Se=>{if(!s)return;console.log("🎯 新增任務開始",{stepId:Se});const We=s.steps.findIndex(Sn=>Sn.id===Se);if(We===-1)return;const et={title:"新任務",status:"todo"},Ye=a.addTask(Se,et);if(console.log("✅ Store 新增結果",{addedTask:Ye}),!Ye)return;const Xe=useGoalStore.getState().goals.find(Sn=>Sn.id===t);if(!Xe)return;const qe=Xe.steps.find(Sn=>Sn.id===Se);if(!qe)return;const kt=qe.tasks.find(Sn=>Sn.id===Ye.id);if(console.log("📝 準備設置編輯狀態",{newTaskId:kt==null?void 0:kt.id,currentEditingTaskId:jr,currentEditingTaskTitle:xn}),!kt)return;const Wt=qr(We,qe.tasks.length-1,qe.tasks.length),cr=H.current;if(!cr)return;const nr=cr.clientWidth,Kr=cr.clientHeight,un=nr/2/P-Wt.x,An=Kr/2/P-Wt.y;j({x:un,y:An}),Qr(kt.id),Lr(kt.title),console.log("✏️ 編輯狀態已設置",{taskId:kt.id,title:kt.title}),useGoalStore.getState().dump(t)},[s,a]),Hs=reactExports.useCallback((Se,We)=>{if(console.log("💾 開始更新任務標題",{taskId:Se,newTitle:We}),!We.trim()){console.log("❌ 更新失敗：標題為空");return}const et=useGoalStore.getState().goals.find(kt=>kt.id===t);if(!et){console.log("❌ 更新失敗：找不到目標",{goalId:t});return}const Ye=et.steps.find(kt=>kt.tasks.some(Wt=>Wt.id===Se));if(console.log("🔍 找到的 step",{stepId:Ye==null?void 0:Ye.id}),!Ye){console.log("❌ 更新失敗：找不到步驟");return}const Xe=Ye.tasks.find(kt=>kt.id===Se);if(console.log("🔍 找到的 task",{task:Xe}),!Xe){console.log("❌ 更新失敗：找不到任務");return}const qe=a.updateTask(Ye.id,Se,{...Xe,title:We.trim()});qe?(Lr(qe.title),Qr(null),console.log("✅ 任務更新完成",{updatedTask:qe})):console.log("❌ 任務更新失敗"),useGoalStore.getState().dump(t)},[t,a]),Bn=reactExports.useCallback(()=>{if(!s)return;let Se=`# ${s.title}

`;s.steps.filter(Xe=>Xe.status!=="archived").forEach((Xe,qe)=>{Se+=`## ${qe+1}. ${Xe.title}

`,Xe.tasks.forEach((kt,Wt)=>{const cr=kt.status==="done"?"✅":kt.status==="in_progress"?"🔄":"⭕";Se+=`${cr} ${kt.title}
`,kt.completedAt&&(Se+=`   - 完成於: ${new Date(kt.completedAt).toLocaleDateString()}
`)}),Se+=`
`});const We=new Blob([Se],{type:"text/markdown"}),et=URL.createObjectURL(We),Ye=document.createElement("a");Ye.href=et,Ye.download=`${s.title}-規劃.md`,document.body.appendChild(Ye),Ye.click(),document.body.removeChild(Ye),URL.revokeObjectURL(et)},[s]),Hn=reactExports.useCallback(()=>{if(!s)return;const Se=JSON.stringify(s,null,2),We=new Blob([Se],{type:"application/json"}),et=URL.createObjectURL(We),Ye=document.createElement("a");Ye.href=et,Ye.download=`${s.title}-規劃.json`,document.body.appendChild(Ye),Ye.click(),document.body.removeChild(Ye),URL.revokeObjectURL(et)},[s]),Tn=useNavigate(),Mn=reactExports.useCallback((Se,We)=>{We.trim()&&(a.updateBubble(Se,{title:We.trim()}),qt(null),Lt(""))},[a]),os=reactExports.useCallback(Se=>{!s||!rt||(console.log("🔍 Analyzing goal:",Se),rt(`總結主題：${Se}`,{mode:"summarize"}))},[s,rt]),es=reactExports.useCallback(Se=>{!s||!rt||(console.log("🔍 Analyzing step:",Se),rt(`總結目標：${Se}`,{mode:"step_search"}))},[s,rt]),ci=reactExports.useCallback(Se=>{!s||!rt||(console.log("🔍 Analyzing task:",Se),rt(`分析任務：${Se}`,{mode:"mission_search"}))},[s,rt]),ti=reactExports.useCallback(Se=>{!s||!rt||(console.log("🔍 Analyzing bubble:",Se),rt(`分析想法：${Se}`,{mode:"bubble_idea_search"}))},[s,rt]);return jsxRuntimeExports.jsxs("div",{ref:H,className:"w-full h-full relative overflow-hidden",onMouseDown:dr,style:{cursor:K?"grabbing":"grab",backgroundImage:`url(${mindMapBg})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundColor:"rgba(255, 255, 255, 0.8)",backgroundBlendMode:"overlay"},children:[jsxRuntimeExports.jsx(AnimatePresence,{children:fe&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"absolute inset-0 z-50 bg-white flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsx("div",{className:"w-48 h-48 relative",children:jsxRuntimeExports.jsx(Lottie,{animationData:loadingAnimation,loop:!0,className:"w-full h-full"})}),jsxRuntimeExports.jsx("div",{className:"mt-4 text-lg text-purple-600 font-medium",children:"正在載入心智圖..."})]})}),jsxRuntimeExports.jsxs("div",{className:"absolute top-4 left-4 z-10 flex items-center space-x-4",children:[jsxRuntimeExports.jsxs(motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:e,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[jsxRuntimeExports.jsx(ArrowLeft,{className:"h-4 w-4 mr-2"}),"返回"]}),isDefaultGoal(t)&&jsxRuntimeExports.jsxs(motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{window.confirm("確定要回到預設值嗎？這會清除所有已儲存的修改。")&&(localStorage.removeItem("self_learning_goals"),window.location.reload())},className:"inline-flex items-center px-4 py-2 border border-orange-300 rounded-md shadow-sm text-sm font-medium text-orange-700 bg-white hover:bg-orange-50",children:[jsxRuntimeExports.jsx(RotateCcw,{className:"h-4 w-4 mr-2"}),"回到預設值"]}),jsxRuntimeExports.jsx(Provider$1,{children:jsxRuntimeExports.jsxs(Root3,{children:[jsxRuntimeExports.jsx(Trigger,{asChild:!0,children:jsxRuntimeExports.jsxs(motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{const Se={id:"",title:"做點什麼呢?",status:"active",steps:[]},We=new MindMapService;console.log("📝 準備新增目標",{newGoal:Se});const et=We.addGoal(Se);console.log("✅ 目標已新增",{addedGoal:et}),Tn(`/student/planning/goal/${et.id}`)},className:"inline-flex items-center px-4 py-2 border border-indigo-300 rounded-md shadow-sm text-sm font-medium text-indigo-700 bg-white hover:bg-indigo-50",children:[jsxRuntimeExports.jsx(FilePlus,{className:"h-4 w-4 mr-2"}),"建立新頁面"]})}),jsxRuntimeExports.jsx(Portal,{children:jsxRuntimeExports.jsxs(Content2,{className:"bg-gray-800 text-white px-3 py-2 rounded-md text-sm shadow-lg",sideOffset:5,children:["建立一個空白的學習目標",jsxRuntimeExports.jsx(Arrow2,{className:"fill-gray-800"})]})})]})}),jsxRuntimeExports.jsx("h1",{className:"text-xl font-bold text-gray-900",children:s.title}),jsxRuntimeExports.jsxs(Root2,{children:[jsxRuntimeExports.jsx(Trigger$1,{asChild:!0,children:jsxRuntimeExports.jsxs(motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[jsxRuntimeExports.jsx(Share2,{className:"h-4 w-4 mr-1"}),"匯出"]})}),jsxRuntimeExports.jsx(Portal2,{children:jsxRuntimeExports.jsxs(Content2$1,{className:"min-w-[180px] bg-white rounded-lg p-1 shadow-lg border border-gray-200",sideOffset:5,children:[jsxRuntimeExports.jsx(Item2,{className:"flex items-center px-2 py-2 text-sm text-gray-700 hover:bg-purple-50 hover:text-purple-700 rounded-md cursor-pointer outline-none",onSelect:Bn,children:"匯出成 Markdown"}),jsxRuntimeExports.jsx(Item2,{className:"flex items-center px-2 py-2 text-sm text-gray-700 hover:bg-purple-50 hover:text-purple-700 rounded-md cursor-pointer outline-none",onSelect:Hn,children:"匯出成 JSON"})]})})]})]}),jsxRuntimeExports.jsxs("div",{ref:ee,className:"absolute top-0 left-0",style:{transform:`scale(${P}) translate(${I.x}px, ${I.y}px)`,transformOrigin:"0 0"},children:[jsxRuntimeExports.jsxs("svg",{width:"20000",height:"20000",className:"absolute top-0 left-0 pointer-events-none",style:{width:"200%",height:"200%",transform:"translate(-5000px, -5000px)",minWidth:"20000px",minHeight:"20000px"},children:[s.steps.filter(Se=>Se.status!=="archived").map((Se,We)=>{const et=$r(We,s.steps),Ye=ce[Se.id]||{x:0,y:0},Xe=Fr({x:Cr.x+96+Ae.x+5e3,y:Cr.y+Ae.y+5e3},{x:et.x-64+Ye.x+5e3,y:et.y+Ye.y+5e3});return jsxRuntimeExports.jsx("path",{d:`M ${Xe.start.x} ${Xe.start.y} 
                    C ${Xe.control1.x} ${Xe.control1.y},
                      ${Xe.control2.x} ${Xe.control2.y},
                      ${Xe.end.x} ${Xe.end.y}`,stroke:"#818cf8",strokeWidth:"3",fill:"none"},`step-line-${Se.id}`)}),De.map(Se=>{var qe,kt;const We=Et[Se.id]||{x:0,y:0};if(!(Se.parentId===s.id?s:s==null?void 0:s.steps.find(Wt=>Wt.id===Se.parentId)))return null;const Ye=Se.parentId===s.id?{x:Cr.x+96+Ae.x+5e3,y:Cr.y+Ae.y+5e3}:{x:$r(s.steps.findIndex(Wt=>Wt.id===Se.parentId),s.steps).x-64+5e3,y:$r(s.steps.findIndex(Wt=>Wt.id===Se.parentId),s.steps).y+5e3},Xe={x:(((qe=Se.position)==null?void 0:qe.x)??0)+We.x+5e3,y:(((kt=Se.position)==null?void 0:kt.y)??0)+We.y+5e3};return jsxRuntimeExports.jsx("path",{d:`M ${Ye.x} ${Ye.y}                     C ${(Ye.x+Xe.x)/2} ${Ye.y},                      ${(Ye.x+Xe.x)/2} ${Xe.y},                      ${Xe.x} ${Xe.y}`,stroke:"#818cf8",strokeWidth:"2",strokeDasharray:"4 4",fill:"none"},`bubble-line-${Se.id}`)}),o.map((Se,We)=>{var Xe;const et=$r(We,s.steps),Ye=ce[Se.id]||{x:0,y:0};return(Xe=u.get(Se.id))==null?void 0:Xe.map((qe,kt)=>{const Wt=qr(We,kt,Se.tasks.length),cr=te[qe.id]||{x:0,y:0},nr=Fr({x:et.x+64+Ye.x+5e3,y:et.y+Ye.y+5e3},{x:Wt.x+cr.x+5e3,y:Wt.y+60+cr.y+5e3});return Se.title.includes("觀察")&&qe.title.includes("想法"),jsxRuntimeExports.jsx("path",{d:`M ${nr.start.x} ${nr.start.y} 
                      C ${nr.control1.x} ${nr.control1.y},
                        ${nr.control2.x} ${nr.control2.y},
                        ${nr.end.x} ${nr.end.y}`,stroke:qe.status==="done"?"#34d399":qe.status==="in_progress"?"#f97316":"#0ea5e9",strokeWidth:"2.5",fill:"none"},`task-line-${Se.id}-${qe.id||kt}`)})})]}),jsxRuntimeExports.jsx(motion.div,{id:`goal-${s.id}`,className:"absolute goal-node",style:{left:Cr.x-96,top:Cr.y-96,transform:"none",x:xr,y:br,zIndex:vr("goal")},initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,damping:20},drag:!0,dragMomentum:!1,dragElastic:0,onDragStart:Se=>{Se.stopPropagation(),console.log("Goal drag start event triggered"),Wr("goal")},onDrag:Se=>{Se.stopPropagation()},onDragEnd:Se=>{Se.stopPropagation(),console.log("Final position:",{x:xr.get(),y:br.get()})},whileDrag:{scale:1.05,zIndex:50},whileHover:{scale:1.02},onClick:()=>{y(!m)},onDoubleClick:Se=>{Se.stopPropagation(),Dr(!0),wn(s.title)},children:jsxRuntimeExports.jsxs("div",{className:"group relative w-48 h-48 rounded-full bg-gradient-to-br from-purple-100 to-pink-100 border-4 border-purple-200 flex items-center justify-center p-6 shadow-lg cursor-pointer transition-all duration-200 hover:scale-105 hover:border-purple-400 hover:shadow-[0_0_0_4px_rgba(99,102,241,0.2)]",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx(Target,{className:"w-12 h-12 text-purple-500 mx-auto mb-2"}),yn?jsxRuntimeExports.jsx("input",{type:"text",value:Nr,onChange:Se=>wn(Se.target.value),onBlur:()=>jn(Nr),onKeyDown:Se=>{Se.key==="Enter"?jn(Nr):Se.key==="Escape"&&(Dr(!1),wn(s.title))},className:"w-full text-center bg-transparent border-b border-purple-300 focus:outline-none focus:border-purple-500 px-1 text-lg font-bold text-purple-700",autoFocus:!0,onClick:Se=>Se.stopPropagation()}):jsxRuntimeExports.jsx("h2",{className:"text-lg font-bold text-purple-700",children:s.title||"新目標"})]}),jsxRuntimeExports.jsx("div",{className:"absolute opacity-0 group-hover:opacity-100 transition-opacity duration-200",style:{right:"-10px",bottom:"10px",transform:"translate(50%, 50%)",zIndex:vr("goal")+1},children:jsxRuntimeExports.jsxs("div",{className:"flex space-x-2",children:[jsxRuntimeExports.jsx(motion.button,{whileHover:{scale:1.1},whileTap:{scale:.95},onClick:Se=>{Se.stopPropagation(),Dn()},className:"w-8 h-8 bg-indigo-100 hover:bg-indigo-200 rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-200",children:jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4 text-indigo-500"})}),jsxRuntimeExports.jsx(motion.button,{whileHover:{scale:1.1},whileTap:{scale:.95},onClick:Se=>{Se.stopPropagation(),Ir(s.id,"impression")},className:"w-8 h-8 bg-purple-100 hover:bg-purple-200 rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-200",children:jsxRuntimeExports.jsx(MessageSquare,{className:"w-4 h-4 text-purple-500"})})]})}),jsxRuntimeExports.jsx("div",{className:"absolute opacity-0 group-hover:opacity-100 transition-opacity duration-200",style:{right:"-5px",top:"-15px",transform:"translate(50%, 50%)",zIndex:vr("goal")+1},children:jsxRuntimeExports.jsx("div",{className:"flex space-x-2",children:jsxRuntimeExports.jsx(motion.div,{whileHover:{scale:1.1},whileTap:{scale:.95},onClick:Se=>{Se.stopPropagation(),os(s.title)},className:"w-8 h-8 bg-gradient-to-br from-violet-500 to-fuchsia-500 hover:from-violet-600 hover:to-fuchsia-600 rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-200 cursor-pointer",children:jsxRuntimeExports.jsx(Sparkles,{className:"w-4 h-4 text-white"})})})})]})}),jsxRuntimeExports.jsx(AnimatePresence,{children:o.map((Se,We)=>{var Xe;const et=$r(We,s.steps),Ye=d===Se.id;return jsxRuntimeExports.jsxs(React.Fragment,{children:[jsxRuntimeExports.jsx(motion.div,{className:"absolute",style:{left:et.x-64,top:et.y-64,transform:"none"},initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},children:jsxRuntimeExports.jsxs(motion.div,{id:`step-${Se.id}`,drag:b!==Se.id,dragMomentum:!1,dragElastic:0,onDragStart:(qe,kt)=>{b!==Se.id&&(qe.stopPropagation(),oe(Se.id),Wr(Se.id))},onDrag:(qe,kt)=>{if(b===Se.id)return;const Wt=kt.delta.x,cr=kt.delta.y;me(nr=>{const Kr=nr[Se.id]||{x:0,y:0};return{...nr,[Se.id]:{x:Kr.x+Wt,y:Kr.y+cr}}})},onDragEnd:()=>{b!==Se.id&&oe(null)},style:{position:"relative",zIndex:vr(Se.id)},onClick:()=>{p(Ye?null:Se.id)},onDoubleClick:qe=>{qe.stopPropagation(),E(Se.id),S(Se.title)},className:`step-node group w-32 h-32 rounded-full border-4 bg-gradient-to-br ${getStepColors(We,s.steps.length).gradient} border-${getStepColors(We,s.steps.length).border} flex items-center justify-center p-4 shadow-lg transition-colors duration-200 hover:scale-105 hover:border-indigo-400 shadow-[0_0_0_4px_rgba(99,102,241,0.2)] transition-all duration-200 ${b===Se.id?"cursor-text":"cursor-move"}`,whileHover:{scale:b===Se.id?1:1.1},whileDrag:{scale:1.05,zIndex:50},children:[jsxRuntimeExports.jsx("div",{className:"text-center",children:b===Se.id?jsxRuntimeExports.jsx("input",{type:"text",value:T,onChange:qe=>S(qe.target.value),onBlur:()=>yr(Se.id,T),onKeyDown:qe=>{qe.key==="Enter"?yr(Se.id,T):qe.key==="Escape"&&(E(null),S(""))},className:"w-full text-center bg-transparent border-b border-purple-300 focus:outline-none focus:border-purple-500 px-1",autoFocus:!0,onClick:qe=>qe.stopPropagation()}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ListTodo,{className:`w-8 h-8 mx-auto mb-1 ${getStepColors(We,s.steps.length).icon}`}),jsxRuntimeExports.jsx("h3",{className:`text-sm font-bold ${getStepColors(We,s.steps.length).text}`,children:Se.title})]})}),jsxRuntimeExports.jsx("div",{className:"absolute opacity-0 group-hover:opacity-100 transition-opacity duration-200",style:{right:"-15px",bottom:"0px",transform:"translate(50%, 50%)",zIndex:vr(Se.id)+1},children:jsxRuntimeExports.jsxs("div",{className:"flex space-x-2",children:[jsxRuntimeExports.jsx(motion.button,{whileHover:{scale:1.1},whileTap:{scale:.95},onClick:qe=>{qe.stopPropagation(),_s(Se.id)},className:"w-8 h-8 bg-indigo-100 hover:bg-indigo-200 rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-200 cursor-pointer",children:jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4 text-indigo-500"})}),jsxRuntimeExports.jsx(motion.div,{whileHover:{scale:1.1},whileTap:{scale:.95},onClick:qe=>{qe.stopPropagation(),Nn(Se.id)},className:"w-8 h-8 bg-red-100 hover:bg-red-200 rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-200 cursor-pointer",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4 text-red-500"})})]})}),jsxRuntimeExports.jsx("div",{className:"absolute opacity-0 group-hover:opacity-100 transition-opacity duration-200",style:{right:"-15px",top:"-15px",transform:"translate(50%, 50%)",zIndex:vr(Se.id)+1},children:jsxRuntimeExports.jsx("div",{className:"flex space-x-2",children:jsxRuntimeExports.jsx(motion.div,{whileHover:{scale:1.1},whileTap:{scale:.95},onClick:qe=>{qe.stopPropagation(),es(Se.title)},className:"w-8 h-8 bg-gradient-to-br from-violet-500 to-fuchsia-500 hover:from-violet-600 hover:to-fuchsia-600 rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-200 cursor-pointer",children:jsxRuntimeExports.jsx(Sparkles,{className:"w-4 h-4 text-white"})})})})]})}),jsxRuntimeExports.jsx(AnimatePresence,{children:(Xe=u.get(Se.id))==null?void 0:Xe.map((qe,kt)=>{const Wt=qr(We,kt,Se.tasks.length);return Se.title.includes("觀察")&&qe.title.includes("想法"),jsxRuntimeExports.jsx(motion.div,{className:"absolute",style:{left:Wt.x,top:Wt.y,transform:"none"},initial:{scale:0},animate:{scale:1},exit:{scale:0},transition:{type:"spring",stiffness:260,damping:20},children:jsxRuntimeExports.jsxs(motion.div,{id:`task-${qe.id}`,drag:jr!==qe.id,dragMomentum:!1,whileDrag:{scale:1.05},whileHover:{scale:jr===qe.id?1:1.1},onDragStart:nr=>{jr!==qe.id&&(nr.stopPropagation(),Wr(qe.id))},onDrag:(nr,Kr)=>{if(jr===qe.id)return;nr.stopPropagation();const un=Kr.delta.x,An=Kr.delta.y;le(Sn=>{const ls=Sn[qe.id]||{x:0,y:0};return{...Sn,[qe.id]:{x:ls.x+un,y:ls.y+An}}})},onDragEnd:()=>{qe.id},style:{position:"relative",zIndex:vr(qe.id)},onClick:nr=>{nr.stopPropagation()},onDoubleClick:nr=>{nr.stopPropagation(),Qr(qe.id),Lr(qe.title)},className:`task-card group w-64 h-24 p-4 rounded-2xl shadow-lg border-2 cursor-move flex flex-col justify-center gap-2 relative ${qe.status==="idea"?"bg-gradient-to-br from-purple-50 to-pink-50 border-purple-200 rounded-3xl hover:border-purple-400 hover:shadow-[0_0_0_4px_rgba(99,102,241,0.2)]":qe.status==="done"?"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200 hover:border-green-400 hover:shadow-[0_0_0_4px_rgba(34,197,94,0.2)]":qe.status==="in_progress"?"bg-gradient-to-br from-orange-50 to-amber-50 border-orange-200 hover:border-orange-400 hover:shadow-[0_0_0_4px_rgba(249,115,22,0.2)]":"bg-gradient-to-br from-pink-50 to-rose-50 border-pink-200 hover:border-pink-400 hover:shadow-[0_0_0_4px_rgba(236,72,153,0.2)]"} `,children:[jsxRuntimeExports.jsxs("div",{className:"absolute top-2 right-2 flex space-x-2",children:[qe.status==="done"&&jsxRuntimeExports.jsx("span",{className:"text-xl",children:"✅"}),qe.status==="in_progress"&&jsxRuntimeExports.jsx("span",{className:"text-xl",children:"🚀"}),qe.status==="idea"&&jsxRuntimeExports.jsx("span",{className:"text-xl",children:"💭"})]}),jr===qe.id?jsxRuntimeExports.jsx("input",{type:"text",value:xn,onChange:nr=>Lr(nr.target.value),onBlur:()=>Hs(qe.id,xn),onKeyDown:nr=>{nr.key==="Enter"?Hs(qe.id,xn):nr.key==="Escape"&&(Qr(null),Lr(""))},className:`w-full bg-transparent border-b border-gray-300 focus:outline-none focus:border-indigo-500 px-1 ${qe.status==="idea"?"text-2xl font-bold text-center font-[Iansui] !text-[#d97706] tracking-wide":"text-lg font-semibold text-left"} text-gray-900 pr-8`,autoFocus:!0,onClick:nr=>nr.stopPropagation()}):jsxRuntimeExports.jsx("h3",{className:`${qe.status==="idea"?"text-2xl font-bold text-center font-[Iansui] !text-[#d97706] tracking-wide":"text-lg font-semibold text-left"} text-gray-900 pr-8`,children:qe.title}),qe.completedAt&&jsxRuntimeExports.jsxs("p",{className:`text-xs text-gray-500 ${qe.status==="idea"?"text-center":"text-left"}`,children:["完成於 ",new Date(qe.completedAt).toLocaleDateString()]}),jsxRuntimeExports.jsx("div",{className:"absolute opacity-0 group-hover:opacity-100 transition-opacity duration-200",style:{right:"-20px",bottom:"-5px",transform:"translate(50%, 50%)",zIndex:vr(qe.id)+1},children:jsxRuntimeExports.jsx("div",{className:"flex space-x-2",children:jsxRuntimeExports.jsx(motion.div,{whileHover:{scale:1.1},whileTap:{scale:.95},onClick:nr=>{nr.stopPropagation();const Kr=s.steps.find(un=>un.tasks.some(An=>An.id===qe.id));Kr&&Hr(Kr.id,qe.id)},className:"w-8 h-8 bg-red-100 hover:bg-red-200 rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-200 cursor-pointer",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4 text-red-500"})})})}),jsxRuntimeExports.jsx("div",{className:"absolute opacity-0 group-hover:opacity-100 transition-opacity duration-200",style:{right:"-20px",top:"-35px",transform:"translate(50%, 50%)",zIndex:vr(qe.id)+1},children:jsxRuntimeExports.jsx("div",{className:"flex space-x-2",children:jsxRuntimeExports.jsx(motion.div,{whileHover:{scale:1.1},whileTap:{scale:.95},onClick:nr=>{nr.stopPropagation(),ci(qe.title)},className:"w-8 h-8 bg-gradient-to-br from-violet-500 to-fuchsia-500 hover:from-violet-600 hover:to-fuchsia-600 rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-200 cursor-pointer",children:jsxRuntimeExports.jsx(Sparkles,{className:"w-4 h-4 text-white"})})})})]})},`task-${Se.id}-${qe.id}`)})})]},`step-group-${Se.id}`)})}),jsxRuntimeExports.jsx(AnimatePresence,{children:De.map(Se=>{var We,et;return Et[Se.id],jsxRuntimeExports.jsx(motion.div,{className:"absolute",style:{left:(((We=Se.position)==null?void 0:We.x)??0)-64,top:(((et=Se.position)==null?void 0:et.y)??0)-64,transform:"none"},initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},children:jsxRuntimeExports.jsxs(motion.div,{drag:!0,dragMomentum:!1,dragElastic:0,onDragStart:Ye=>{Ye.stopPropagation(),console.log("Bubble drag start event triggered"),Wr(Se.id)},onDrag:(Ye,Xe)=>{Ye.stopPropagation();const qe=Xe.delta.x,kt=Xe.delta.y;Ze(Wt=>{const cr=Wt[Se.id]||{x:0,y:0};return{...Wt,[Se.id]:{x:cr.x+qe,y:cr.y+kt}}})},onDragEnd:Ye=>{var qe,kt;Ye.stopPropagation();const Xe=Et[Se.id]||{x:0,y:0};Er(Se.id,{position:{x:(((qe=Se.position)==null?void 0:qe.x)??0)+Xe.x,y:(((kt=Se.position)==null?void 0:kt.y)??0)+Xe.y}}),Ze(Wt=>({...Wt,[Se.id]:{x:0,y:0}}))},style:{position:"relative",zIndex:vr(Se.id)},whileDrag:{scale:1.05,zIndex:50},whileHover:{scale:1.02},className:"bubble-node w-32 h-32 rounded-full bg-gradient-to-br from-purple-50 to-pink-50 border-2 border-purple-200 shadow-lg cursor-move flex items-center justify-center group",onDoubleClick:Ye=>{Ye.stopPropagation(),qt(Se.id),Lt(Se.title)},children:[Ue===Se.id?jsxRuntimeExports.jsx("input",{type:"text",value:or,onChange:Ye=>Lt(Ye.target.value),onBlur:()=>Mn(Se.id,or),onKeyDown:Ye=>{Ye.key==="Enter"?Mn(Se.id,or):Ye.key==="Escape"&&(qt(null),Lt(""))},className:"w-full text-center bg-transparent border-b border-purple-300 focus:outline-none focus:border-purple-500 px-1 font-[Iansui] text-2xl text-purple-700",autoFocus:!0,onClick:Ye=>Ye.stopPropagation()}):jsxRuntimeExports.jsx("div",{className:"text-center font-[Iansui] text-2xl text-purple-700",children:Se.title}),jsxRuntimeExports.jsx("div",{className:"absolute opacity-0 group-hover:opacity-100 transition-opacity duration-200",style:{right:"-10px",bottom:" 10px",transform:"translate(50%, 50%)",zIndex:vr(Se.id)+1},children:jsxRuntimeExports.jsx(motion.div,{whileHover:{scale:1.1},whileTap:{scale:.95},onClick:Ye=>{Ye.stopPropagation(),kr(Se.id)},className:"w-8 h-8 bg-red-100 hover:bg-red-200 rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-200 cursor-pointer",children:jsxRuntimeExports.jsx(Trash2,{className:"w-4 h-4 text-red-500"})})}),jsxRuntimeExports.jsx("div",{className:"absolute opacity-0 group-hover:opacity-100 transition-opacity duration-200",style:{right:"-15px",top:"-15px",transform:"translate(50%, 50%)",zIndex:vr(Se.id)+1},children:jsxRuntimeExports.jsx("div",{className:"flex space-x-2",children:jsxRuntimeExports.jsx(motion.div,{whileHover:{scale:1.1},whileTap:{scale:.95},onClick:Ye=>{Ye.stopPropagation(),ti(Se.title)},className:"w-8 h-8 bg-gradient-to-br from-violet-500 to-fuchsia-500 hover:from-violet-600 hover:to-fuchsia-600 rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-200 cursor-pointer",children:jsxRuntimeExports.jsx(Sparkles,{className:"w-4 h-4 text-white"})})})})]})},Se.id)})})]}),jsxRuntimeExports.jsxs("div",{className:"fixed bottom-6 left-1/2 z-40 -translate-x-1/2 flex items-center gap-2 px-4 py-2 rounded-2xl shadow-xl bg-white/80 backdrop-blur border border-gray-200",style:{minWidth:"fit-content"},children:[jsxRuntimeExports.jsx("button",{onClick:()=>{const Se=Pr();Se&&(A(Se.zoom),j(Se.position))},className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors",title:"置中",children:jsxRuntimeExports.jsx(Target,{className:"w-5 h-5 text-gray-600"})}),jsxRuntimeExports.jsx("button",{onClick:()=>zr(.1),className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors",title:"放大",children:jsxRuntimeExports.jsx(ZoomIn,{className:"w-5 h-5 text-gray-600"})}),jsxRuntimeExports.jsxs("div",{className:"w-16 text-center font-mono text-sm text-gray-600",children:[Math.round(P*100),"%"]}),jsxRuntimeExports.jsx("button",{onClick:()=>zr(-.1),className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 transition-colors",title:"縮小",children:jsxRuntimeExports.jsx(ZoomOut,{className:"w-5 h-5 text-gray-600"})}),jsxRuntimeExports.jsx("div",{className:"w-px h-6 bg-gray-200"}),jsxRuntimeExports.jsx("div",{className:"relative",children:jsxRuntimeExports.jsx("button",{onClick:ur,className:`w-10 h-10 flex items-center justify-center rounded-full transition-colors ${_r?"bg-indigo-100 text-indigo-600 hover:bg-indigo-200":"hover:bg-gray-100 text-gray-600"}`,title:_r?"隱藏助理":"顯示助理",children:jsxRuntimeExports.jsx(Sparkles,{className:"w-5 h-5"})})})]}),jsxRuntimeExports.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:jsxRuntimeExports.jsx(PanelAssistant,{enabled:_r,onToggle:ur,dragConstraints:H,initialPosition:Ar(),onPositionChange:It,onDragEnd:Vn,hideCloseButton:!0,className:"panel-assistant pointer-events-auto",goalId:t,onFocus:Se=>{document.getElementById(Se)&&gn(Se)},onExternalInput:ir})})]})},GoalMindMapPage=()=>{const{goalId:t}=useParams(),e=useNavigate();return t?jsxRuntimeExports.jsx("div",{className:"w-full h-[calc(100vh-4rem)]",children:jsxRuntimeExports.jsx(GoalMindMap,{goalId:t,onBack:()=>e("/student/planning")})}):jsxRuntimeExports.jsx("div",{children:"找不到目標 ID"})};function LottiePreview(){return jsxRuntimeExports.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50",children:[jsxRuntimeExports.jsx("div",{className:"w-[400px] h-[400px] bg-white rounded-lg shadow-lg p-8",children:jsxRuntimeExports.jsx(Lottie,{animationData:loadingAnimation,loop:!0,className:"w-full h-full"})}),jsxRuntimeExports.jsx("div",{className:"mt-4 text-lg text-purple-600",children:"預覽 Lottie 動畫"})]})}const MapIcon=({goal:t,src:e,left:r,top:n,onGoalClick:s,flip:a})=>{const[o,l]=reactExports.useState(!1);return jsxRuntimeExports.jsxs(motion.div,{className:"absolute cursor-pointer z-10",style:{transform:"translate(-50%, -50%)",transformOrigin:"center center"},animate:{left:`${r}%`,top:`${n}%`,scale:o?1.15:1},transition:{left:{duration:1,ease:"linear"},top:{duration:1,ease:"linear"},scale:{duration:.2}},onClick:()=>s(t.id),initial:!1,onHoverStart:()=>l(!0),onHoverEnd:()=>l(!1),children:[jsxRuntimeExports.jsx("img",{src:e,alt:t.title,className:"w-32 h-32 drop-shadow-lg",style:{transform:a?"scaleX(-1)":"none",transformOrigin:"center"}}),jsxRuntimeExports.jsx(motion.div,{className:"absolute left-1/2 -translate-x-1/2 bottom-full mb-2 px-3 py-1.5 bg-gradient-to-r from-indigo-500 to-purple-500 text-white text-xs rounded-full shadow-lg whitespace-nowrap",initial:{opacity:0,y:8},animate:{opacity:o?1:0,y:o?0:8},transition:{duration:.2},children:t.title})]})},mapImage="/assets/map-sep-Cse8aBRu.png",heyaImg="/assets/heya-Z3NswJuL.png",jinImg="/assets/jin-GU7vVogI.png",fireImg="/assets/fire-CJaR2oac.png",mailboxImg="/assets/mailbox-BiihJWOn.png",InteractiveMap=({goals:t,onGoalClick:e,onCampfireClick:r,onMailboxClick:n})=>{const[s,a]=reactExports.useState({left:26,top:34}),o=reactExports.useRef(null),[l,u]=reactExports.useState({width:0,height:0}),[c,d]=reactExports.useState(1),[p,m]=reactExports.useState({x:0,y:0}),[y,b]=reactExports.useState(!1),E=()=>{if(!o.current)return;const P=o.current,A=P.querySelector("img");if(!A)return;const I=P.clientWidth,j=P.clientHeight,K=A.naturalWidth/A.naturalHeight,W=I/j;let H,ee;K>W?(H=I,ee=I/K):(ee=j,H=j*K);const ue=(I-H)/2,de=(j-ee)/2;u({width:H,height:ee}),m({x:ue,y:de}),d(H/A.naturalWidth*1.5)};reactExports.useEffect(()=>{const P=new ResizeObserver(E);return o.current&&P.observe(o.current),()=>P.disconnect()},[]);const T=P=>{E()},S=P=>{if(!o.current||y)return;const A=o.current.getBoundingClientRect(),I=(P.clientX-A.left-p.x)/l.width*100,j=(P.clientY-A.top-p.y)/l.height*100;b(!0),a({left:Math.max(0,Math.min(100,I)),top:Math.max(0,Math.min(100,j))}),setTimeout(()=>b(!1),2e3)};return jsxRuntimeExports.jsx("div",{className:"w-full h-full relative overflow-hidden select-none",ref:o,onDoubleClick:S,children:jsxRuntimeExports.jsx("div",{className:"absolute inset-0 w-full h-full",children:jsxRuntimeExports.jsxs("div",{className:"relative w-full h-full",children:[jsxRuntimeExports.jsx("img",{src:mapImage,alt:"地圖",className:"w-full h-full object-contain select-none",onLoad:T}),jsxRuntimeExports.jsxs("div",{className:"absolute",style:{left:p.x,top:p.y,width:l.width,height:l.height,transform:`scale(${c})`,transformOrigin:"top left"},children:[t[0]&&l.width>0&&jsxRuntimeExports.jsx("div",{className:"absolute transition-all duration-[1500ms] linear",style:{left:`${s.left/100*l.width/c}px`,top:`${s.top/100*l.height/c}px`,transform:"translate(-50%, -50%)",width:"128px",height:"128px"},children:jsxRuntimeExports.jsx(MapIcon,{goal:t[0],src:jinImg,left:0,top:0,onGoalClick:e})}),t[1]&&l.width>0&&jsxRuntimeExports.jsx("div",{className:"absolute",style:{left:`${8/100*l.width/c}px`,top:`${26/100*l.height/c}px`,transform:"translate(-50%, -50%)",width:"128px",height:"128px"},children:jsxRuntimeExports.jsx(MapIcon,{goal:t[1],src:heyaImg,left:0,top:0,onGoalClick:e,flip:!0})}),t[2]&&l.width>0&&jsxRuntimeExports.jsx("div",{className:"absolute",style:{left:`${34/100*l.width/c}px`,top:`${74/100*l.height/c}px`,transform:"translate(-50%, -50%)",width:"128px",height:"128px",cursor:r?"pointer":void 0},onClick:r,children:jsxRuntimeExports.jsx(MapIcon,{goal:t[2],src:fireImg,left:0,top:0,onGoalClick:e})}),t[3]&&l.width>0&&jsxRuntimeExports.jsx("div",{className:"absolute",style:{left:`${69/100*l.width/c}px`,top:`${31/100*l.height/c}px`,transform:"translate(-50%, -50%)",width:"128px",height:"128px",cursor:n?"pointer":void 0},onClick:n,children:jsxRuntimeExports.jsx(MapIcon,{goal:t[3],src:mailboxImg,left:0,top:0,onGoalClick:e})})]})]})})})},moodLabels={very_good:"超開心",good:"快樂",neutral:"普通",bad:"不開心",very_bad:"很難過"},energyLabels={very_high:"充滿力量",high:"精神很好",medium:"還不錯",low:"有點累",very_low:"很疲憊"},challengeLabels={very_high:"非常有挑戰",high:"很有挑戰",medium:"一般般",low:"還算輕鬆",very_low:"非常輕鬆"},TaskDetailDialog=({task:t,stepId:e,goalId:r,onClose:n,onBack:s,onHelpRequest:a})=>{const{updateTask:o}=useGoalStore(),[l,u]=reactExports.useState(""),[c,d]=reactExports.useState(null),[p,m]=reactExports.useState(null),[y,b]=reactExports.useState(null),[E,T]=reactExports.useState(!1),S=reactExports.useRef(null);reactExports.useEffect(()=>{const A=I=>{S.current&&!S.current.contains(I.target)&&T(!1)};return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[]);const P=A=>{o(r,e,{...t,status:A,completedAt:A==="done"?new Date().toISOString():void 0}),T(!1),n()};return jsxRuntimeExports.jsxs("div",{className:"bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 p-6 w-[400px] max-w-[90vw] flex flex-col h-full",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4 select-none","data-draggable-header":!0,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{className:"p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700",onClick:s,"aria-label":"返回",children:jsxRuntimeExports.jsx(ChevronLeft,{className:"w-5 h-5"})}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-indigo-700 dark:text-indigo-300",children:"任務詳情"})]}),jsxRuntimeExports.jsx("button",{className:"p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700",onClick:n,"aria-label":"關閉",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5"})})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-auto",children:[jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-2",children:t.title}),jsxRuntimeExports.jsx("p",{className:"text-gray-700",children:t.description})]}),jsxRuntimeExports.jsx("div",{className:"border-t border-gray-200/50 mb-4"}),jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-4",children:"我的紀錄"}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 bg-gray-50/40 backdrop-blur-sm rounded-lg p-3 mb-3 overflow-y-auto min-h-[80px]",children:jsxRuntimeExports.jsx("p",{className:"text-gray-500 text-center text-sm",children:"尚無紀錄"})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>{},className:"p-2 text-gray-600 hover:bg-gray-100/50 rounded-lg transition-colors",children:jsxRuntimeExports.jsx(Paperclip,{size:20})}),jsxRuntimeExports.jsx("input",{type:"text",value:l,onChange:A=>u(A.target.value),placeholder:"紀錄一下...",className:"flex-1 px-3 py-1.5 text-sm border border-gray-300/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white/70 backdrop-blur-sm"}),jsxRuntimeExports.jsx("button",{onClick:()=>{u("")},className:"p-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:jsxRuntimeExports.jsx(MessageSquare,{size:20})})]})]})]}),jsxRuntimeExports.jsx("div",{className:"border-t border-gray-200/50 mb-4"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3 bg-gray-50/20 backdrop-blur-sm rounded-lg p-3 mb-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"今天的心情如何？"}),jsxRuntimeExports.jsx("div",{className:"flex justify-between",children:["very_bad","bad","neutral","good","very_good"].map(A=>jsxRuntimeExports.jsxs("button",{onClick:()=>d(A),className:`w-16 p-2 rounded-full flex flex-col items-center gap-1 transition-colors ${c===A?A==="very_bad"||A==="bad"?"bg-red-100/80 text-red-700":A==="neutral"?"bg-yellow-100/80 text-yellow-700":"bg-green-100/80 text-green-700":"text-gray-400 hover:bg-gray-100/50"}`,children:[A==="very_bad"&&jsxRuntimeExports.jsx(Frown,{size:20}),A==="bad"&&jsxRuntimeExports.jsx(Frown,{size:20}),A==="neutral"&&jsxRuntimeExports.jsx(Meh,{size:20}),A==="good"&&jsxRuntimeExports.jsx(Smile,{size:20}),A==="very_good"&&jsxRuntimeExports.jsx(Smile,{size:20}),jsxRuntimeExports.jsx("span",{className:"text-xs whitespace-nowrap",children:moodLabels[A]})]},A))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"現在的能量如何？"}),jsxRuntimeExports.jsx("div",{className:"flex justify-between",children:["very_low","low","medium","high","very_high"].map(A=>jsxRuntimeExports.jsxs("button",{onClick:()=>m(A),className:`w-16 p-2 rounded-full flex flex-col items-center gap-1 transition-colors ${p===A?A==="very_low"||A==="low"?"bg-red-100/80 text-red-700":A==="medium"?"bg-yellow-100/80 text-yellow-700":"bg-green-100/80 text-green-700":"text-gray-400 hover:bg-gray-100/50"}`,children:[A==="very_low"&&jsxRuntimeExports.jsx(BatteryLow,{size:20}),A==="low"&&jsxRuntimeExports.jsx(BatteryLow,{size:20}),A==="medium"&&jsxRuntimeExports.jsx(BatteryMedium,{size:20}),A==="high"&&jsxRuntimeExports.jsx(Battery,{size:20}),A==="very_high"&&jsxRuntimeExports.jsx(Battery,{size:20}),jsxRuntimeExports.jsx("span",{className:"text-xs whitespace-nowrap",children:energyLabels[A]})]},A))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"任務有挑戰嗎？"}),jsxRuntimeExports.jsx("div",{className:"flex justify-between",children:["very_low","low","medium","high","very_high"].map(A=>jsxRuntimeExports.jsxs("button",{onClick:()=>b(A),className:`w-16 p-2 rounded-full flex flex-col items-center gap-1 transition-colors ${y===A?A==="very_low"?"bg-blue-50/80 text-blue-700":A==="low"?"bg-blue-100/80 text-blue-700":A==="medium"?"bg-indigo-100/80 text-indigo-700":A==="high"?"bg-purple-100/80 text-purple-700":"bg-purple-200/80 text-purple-700":"text-gray-400 hover:bg-gray-100/50"}`,children:[jsxRuntimeExports.jsx(Target,{size:20}),jsxRuntimeExports.jsx("span",{className:"text-xs whitespace-nowrap",children:challengeLabels[A]})]},A))})]})]}),jsxRuntimeExports.jsx("div",{className:"flex justify-end",children:jsxRuntimeExports.jsxs("div",{className:"relative",ref:S,children:[jsxRuntimeExports.jsxs("button",{onClick:()=>T(!E),className:"px-6 py-2 rounded-full text-white transition-colors flex items-center gap-2 bg-gradient-to-r from-indigo-500 to-purple-500 hover:from-indigo-600 hover:to-purple-600",children:[jsxRuntimeExports.jsx(CirclePlay,{size:20}),"進行中"]}),E&&jsxRuntimeExports.jsxs("div",{className:"absolute bottom-full right-0 mb-2 space-y-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>P("todo"),className:"w-full px-6 py-2 bg-gradient-to-r from-slate-400 to-gray-500 text-white rounded-full hover:from-slate-500 hover:to-gray-600 transition-colors whitespace-nowrap flex items-center gap-2",children:[jsxRuntimeExports.jsx(CirclePause,{size:20}),"暫停"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>P("in_progress"),className:"w-full px-6 py-2 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-full hover:from-indigo-600 hover:to-purple-600 transition-colors whitespace-nowrap flex items-center gap-2",children:[jsxRuntimeExports.jsx(CirclePlay,{size:20}),"進行中"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>P("done"),className:"w-full px-6 py-2 bg-gradient-to-r from-emerald-400 via-green-500 to-teal-500 text-white rounded-full hover:from-emerald-500 hover:via-green-600 hover:to-teal-600 transition-colors whitespace-nowrap flex items-center gap-2",children:[jsxRuntimeExports.jsx(CircleCheckBig,{size:20}),"完成"]})]})]})})]})]})},mockData=[{date:"2024/06/10",weekday:"一",tasks:[{id:"t1",name:"完成數學作業",subject:"數學"},{id:"t2",name:"閱讀科學故事",subject:"自然"}],mood:"happy",moodLabel:"很開心",phrases:"我很有成就感，今天進步了，學到新東西！",isHoliday:!1},{date:"2024/06/11",weekday:"二",tasks:[{id:"t3",name:"寫一篇作文",subject:"國語"}],mood:"neutral",moodLabel:"普通",phrases:"有點累，但還可以。",isHoliday:!1},{date:"2024/06/12",weekday:"三",tasks:[],mood:"happy",phrases:"",isHoliday:!0},{date:"2024/06/13",weekday:"四",tasks:[{id:"t4",name:"完成英語單字卡",subject:"英語"},{id:"t5",name:"畫一張圖",subject:"藝術"}],mood:"sad",moodLabel:"有點低落",phrases:"下雨天心情不太好...",isHoliday:!1},{date:"2024/06/14",weekday:"五",tasks:[],mood:"neutral",moodLabel:"普通",phrases:"",isHoliday:!1}],moodIcon={happy:jsxRuntimeExports.jsx(Smile,{className:"h-7 w-7 text-yellow-500"}),neutral:jsxRuntimeExports.jsx(Meh,{className:"h-7 w-7 text-gray-400"}),sad:jsxRuntimeExports.jsx(Frown,{className:"h-7 w-7 text-blue-400"})},funFacts=["你知道嗎？貓頭鷹晚上看得比白天還清楚！","今天有什麼新發現嗎？記得和家人分享喔！","阿嬤說：休息一下，腦袋會更靈光！","小提醒：多喝水，保持好精神！","你有沒有最喜歡的課？下次可以寫下來！"];function getRandomFact(){return funFacts[Math.floor(Math.random()*funFacts.length)]}const DailyReviewCarousel=({className:t="fixed top-8 left-1/2 -translate-x-1/2 z-50 w-[440px] max-w-full",onClose:e})=>{const[r,n]=reactExports.useState(0),s=mockData[r];return jsxRuntimeExports.jsx("div",{className:`${t} w-[440px] max-w-full`,children:jsxRuntimeExports.jsxs("div",{className:"relative bg-white/80 dark:bg-gray-800/80 backdrop-blur rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 p-8",children:[e&&jsxRuntimeExports.jsx("button",{className:"absolute top-3 right-3 z-10 p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700",onClick:e,"aria-label":"關閉",children:jsxRuntimeExports.jsx(X,{className:"w-5 h-5 text-gray-500"})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4",children:[jsxRuntimeExports.jsx("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-40",onClick:()=>n(a=>Math.max(0,a-1)),disabled:r===0,"aria-label":"前一天",children:jsxRuntimeExports.jsx(ChevronLeft,{size:28})}),jsxRuntimeExports.jsxs("span",{className:"text-xl font-bold text-indigo-700 dark:text-indigo-300 select-none",children:[s.date,"（週",s.weekday,"）"]}),jsxRuntimeExports.jsx("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-40",onClick:()=>n(a=>Math.min(mockData.length-1,a+1)),disabled:r===mockData.length-1,"aria-label":"後一天",children:jsxRuntimeExports.jsx(ChevronRight,{size:28})})]}),s.tasks.length===0&&jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-28 my-2",children:jsxRuntimeExports.jsx("span",{className:"text-lg font-bold text-green-700 dark:text-green-200 text-center",children:s.isHoliday?"休息日! 有去哪裡玩嗎?":"進行一半的任務也可以記錄下來喔！"})}),s.tasks.length>0&&jsxRuntimeExports.jsx("ul",{className:"space-y-2 mt-1 mb-2 h-28 flex flex-col justify-center",children:s.tasks.map(a=>{const o=subjects.getSubjectStyle(a.subject);return jsxRuntimeExports.jsxs("li",{className:"flex items-center gap-2 px-3 py-2 rounded-lg leading-relaxed shadow-sm",style:{background:`${o.gradient}10`},children:[jsxRuntimeExports.jsx("span",{className:"w-2 h-2 rounded-full",style:{background:o.accent}}),jsxRuntimeExports.jsx("span",{className:"text-base font-medium text-gray-900 dark:text-white flex-1",children:a.name}),jsxRuntimeExports.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-semibold ${o.bg} ${o.text}`,children:a.subject})]},a.id)})}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-3 mt-3 bg-blue-50 dark:bg-blue-600/30 rounded-xl px-4 py-3",children:s.phrases?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center min-w-[56px]",children:[moodIcon[s.mood],jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-200 mt-1",children:s.moodLabel})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 text-base text-gray-700 dark:text-gray-100 whitespace-pre-line break-words bg-transparent rounded-lg px-2 py-1 leading-relaxed",children:s.phrases})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center min-w-[56px]",children:[jsxRuntimeExports.jsx("span",{className:"text-3xl",children:"🦉"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-400 mt-1",children:"小知識"})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 text-base text-gray-700 dark:text-gray-100 whitespace-pre-line break-words bg-transparent rounded-lg px-2 py-1 leading-relaxed",children:getRandomFact()})]})})]})})},GoalDashboardCard=({title:t,subject:e,progress:r,onClick:n})=>{const s=subjects.getSubjectStyle(e);return jsxRuntimeExports.jsxs("button",{onClick:n,className:"w-full text-left bg-white/80 dark:bg-gray-800/80 rounded-2xl shadow-md border border-gray-200 dark:border-gray-700 border-l-4 p-4 flex items-center gap-3 hover:shadow-lg transition h-[80px]",style:{borderLeftColor:s.accent,background:`linear-gradient(to right, ${s.accent}10, ${s.accent}10)`},children:[jsxRuntimeExports.jsx("div",{className:"flex-1 min-w-0",children:jsxRuntimeExports.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white line-clamp-2",style:{textWrap:"balance"},children:t})}),jsxRuntimeExports.jsxs("div",{className:"relative w-8 h-8 flex-shrink-0",children:[jsxRuntimeExports.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 36 36",children:[jsxRuntimeExports.jsx("path",{d:`M18 2.0845
              a 15.9155 15.9155 0 0 1 0 31.831
              a 15.9155 15.9155 0 0 1 0 -31.831`,fill:"none",stroke:"rgba(0,0,0,0.08)",strokeWidth:"3"}),jsxRuntimeExports.jsx("path",{d:`M18 2.0845
              a 15.9155 15.9155 0 0 1 0 31.831
              a 15.9155 15.9155 0 0 1 0 -31.831`,fill:"none",stroke:s.accent,strokeWidth:"3",strokeDasharray:`${r}, 100`})]}),jsxRuntimeExports.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-medium text-gray-900 dark:text-white",children:[r,"%"]})]})]})},GoalDashboardDialog=({goals:t,onClose:e,onGoalClick:r,onAddGoal:n,getCompletionRate:s})=>jsxRuntimeExports.jsxs("div",{className:"bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 p-6 w-[400px] max-w-[90vw] flex flex-col h-full",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4 select-none","data-draggable-header":!0,children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-indigo-700 dark:text-indigo-300",children:"學習目標概覽"}),jsxRuntimeExports.jsx("button",{className:"p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700",onClick:e,"aria-label":"關閉",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-auto",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[t.map(a=>jsxRuntimeExports.jsx(GoalDashboardCard,{title:a.title,subject:a.subject||"未分類",progress:s(a.id),onClick:()=>{e(),r(a.id)}},a.id)),jsxRuntimeExports.jsxs("button",{onClick:()=>{e(),n()},className:"w-full h-[80px] bg-white/60 dark:bg-gray-800/60 rounded-2xl border-2 border-dashed border-gray-300 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition flex flex-col items-center justify-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"text-2xl text-blue-400 dark:text-blue-500",children:"+"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:"新增目標"})]})]})})]});function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},_setPrototypeOf(t,e)}function _inheritsLoose(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,_setPrototypeOf(t,e)}function _extends(){return _extends=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_extends.apply(null,arguments)}function _typeof(t){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(t)}function toPrimitive(t,e){if(_typeof(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(_typeof(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function toPropertyKey(t){var e=toPrimitive(t,"string");return _typeof(e)=="symbol"?e:e+""}function _defineProperty(t,e,r){return(e=toPropertyKey(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function _objectSpread2(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(n){_defineProperty(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function formatProdErrorMessage(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var $$observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),randomString=function t(){return Math.random().toString(36).substring(7).split("").join(".")},ActionTypes={INIT:"@@redux/INIT"+randomString(),REPLACE:"@@redux/REPLACE"+randomString()};function isPlainObject(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function createStore$1(t,e,r){var n;if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(formatProdErrorMessage(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(formatProdErrorMessage(1));return r(createStore$1)(t,e)}if(typeof t!="function")throw new Error(formatProdErrorMessage(2));var s=t,a=e,o=[],l=o,u=!1;function c(){l===o&&(l=o.slice())}function d(){if(u)throw new Error(formatProdErrorMessage(3));return a}function p(E){if(typeof E!="function")throw new Error(formatProdErrorMessage(4));if(u)throw new Error(formatProdErrorMessage(5));var T=!0;return c(),l.push(E),function(){if(T){if(u)throw new Error(formatProdErrorMessage(6));T=!1,c();var P=l.indexOf(E);l.splice(P,1),o=null}}}function m(E){if(!isPlainObject(E))throw new Error(formatProdErrorMessage(7));if(typeof E.type>"u")throw new Error(formatProdErrorMessage(8));if(u)throw new Error(formatProdErrorMessage(9));try{u=!0,a=s(a,E)}finally{u=!1}for(var T=o=l,S=0;S<T.length;S++){var P=T[S];P()}return E}function y(E){if(typeof E!="function")throw new Error(formatProdErrorMessage(10));s=E,m({type:ActionTypes.REPLACE})}function b(){var E,T=p;return E={subscribe:function(P){if(typeof P!="object"||P===null)throw new Error(formatProdErrorMessage(11));function A(){P.next&&P.next(d())}A();var I=T(A);return{unsubscribe:I}}},E[$$observable]=function(){return this},E}return m({type:ActionTypes.INIT}),n={dispatch:m,subscribe:p,getState:d,replaceReducer:y},n[$$observable]=b,n}function bindActionCreator(t,e){return function(){return e(t.apply(this,arguments))}}function bindActionCreators$1(t,e){if(typeof t=="function")return bindActionCreator(t,e);if(typeof t!="object"||t===null)throw new Error(formatProdErrorMessage(16));var r={};for(var n in t){var s=t[n];typeof s=="function"&&(r[n]=bindActionCreator(s,e))}return r}function compose(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.length===0?function(n){return n}:e.length===1?e[0]:e.reduce(function(n,s){return function(){return n(s.apply(void 0,arguments))}})}function applyMiddleware(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(n){return function(){var s=n.apply(void 0,arguments),a=function(){throw new Error(formatProdErrorMessage(15))},o={getState:s.getState,dispatch:function(){return a.apply(void 0,arguments)}},l=e.map(function(u){return u(o)});return a=compose.apply(void 0,l)(s.dispatch),_objectSpread2(_objectSpread2({},s),{},{dispatch:a})}}}var ReactReduxContext=React.createContext(null);function defaultNoopBatch(t){t()}var batch=defaultNoopBatch,setBatch=function t(e){return batch=e},getBatch=function t(){return batch};function createListenerCollection(){var t=getBatch(),e=null,r=null;return{clear:function(){e=null,r=null},notify:function(){t(function(){for(var s=e;s;)s.callback(),s=s.next})},get:function(){for(var s=[],a=e;a;)s.push(a),a=a.next;return s},subscribe:function(s){var a=!0,o=r={callback:s,next:null,prev:r};return o.prev?o.prev.next=o:e=o,function(){!a||e===null||(a=!1,o.next?o.next.prev=o.prev:r=o.prev,o.prev?o.prev.next=o.next:e=o.next)}}}}var nullListeners={notify:function t(){},get:function t(){return[]}};function createSubscription(t,e){var r,n=nullListeners;function s(p){return u(),n.subscribe(p)}function a(){n.notify()}function o(){d.onStateChange&&d.onStateChange()}function l(){return!!r}function u(){r||(r=e?e.addNestedSub(o):t.subscribe(o),n=createListenerCollection())}function c(){r&&(r(),r=void 0,n.clear(),n=nullListeners)}var d={addNestedSub:s,notifyNestedSubs:a,handleChangeWrapper:o,isSubscribed:l,trySubscribe:u,tryUnsubscribe:c,getListeners:function(){return n}};return d}var useIsomorphicLayoutEffect$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?reactExports.useLayoutEffect:reactExports.useEffect;function Provider(t){var e=t.store,r=t.context,n=t.children,s=reactExports.useMemo(function(){var l=createSubscription(e);return{store:e,subscription:l}},[e]),a=reactExports.useMemo(function(){return e.getState()},[e]);useIsomorphicLayoutEffect$1(function(){var l=s.subscription;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),a!==e.getState()&&l.notifyNestedSubs(),function(){l.tryUnsubscribe(),l.onStateChange=null}},[s,a]);var o=r||ReactReduxContext;return React.createElement(o.Provider,{value:s},n)}function _objectWithoutPropertiesLoose(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var reactIs$1={exports:{}},reactIs_production_min$1={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactIs_production_min$1;function requireReactIs_production_min$1(){if(hasRequiredReactIs_production_min$1)return reactIs_production_min$1;hasRequiredReactIs_production_min$1=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,r=t?Symbol.for("react.portal"):60106,n=t?Symbol.for("react.fragment"):60107,s=t?Symbol.for("react.strict_mode"):60108,a=t?Symbol.for("react.profiler"):60114,o=t?Symbol.for("react.provider"):60109,l=t?Symbol.for("react.context"):60110,u=t?Symbol.for("react.async_mode"):60111,c=t?Symbol.for("react.concurrent_mode"):60111,d=t?Symbol.for("react.forward_ref"):60112,p=t?Symbol.for("react.suspense"):60113,m=t?Symbol.for("react.suspense_list"):60120,y=t?Symbol.for("react.memo"):60115,b=t?Symbol.for("react.lazy"):60116,E=t?Symbol.for("react.block"):60121,T=t?Symbol.for("react.fundamental"):60117,S=t?Symbol.for("react.responder"):60118,P=t?Symbol.for("react.scope"):60119;function A(j){if(typeof j=="object"&&j!==null){var K=j.$$typeof;switch(K){case e:switch(j=j.type,j){case u:case c:case n:case a:case s:case p:return j;default:switch(j=j&&j.$$typeof,j){case l:case d:case b:case y:case o:return j;default:return K}}case r:return K}}}function I(j){return A(j)===c}return reactIs_production_min$1.AsyncMode=u,reactIs_production_min$1.ConcurrentMode=c,reactIs_production_min$1.ContextConsumer=l,reactIs_production_min$1.ContextProvider=o,reactIs_production_min$1.Element=e,reactIs_production_min$1.ForwardRef=d,reactIs_production_min$1.Fragment=n,reactIs_production_min$1.Lazy=b,reactIs_production_min$1.Memo=y,reactIs_production_min$1.Portal=r,reactIs_production_min$1.Profiler=a,reactIs_production_min$1.StrictMode=s,reactIs_production_min$1.Suspense=p,reactIs_production_min$1.isAsyncMode=function(j){return I(j)||A(j)===u},reactIs_production_min$1.isConcurrentMode=I,reactIs_production_min$1.isContextConsumer=function(j){return A(j)===l},reactIs_production_min$1.isContextProvider=function(j){return A(j)===o},reactIs_production_min$1.isElement=function(j){return typeof j=="object"&&j!==null&&j.$$typeof===e},reactIs_production_min$1.isForwardRef=function(j){return A(j)===d},reactIs_production_min$1.isFragment=function(j){return A(j)===n},reactIs_production_min$1.isLazy=function(j){return A(j)===b},reactIs_production_min$1.isMemo=function(j){return A(j)===y},reactIs_production_min$1.isPortal=function(j){return A(j)===r},reactIs_production_min$1.isProfiler=function(j){return A(j)===a},reactIs_production_min$1.isStrictMode=function(j){return A(j)===s},reactIs_production_min$1.isSuspense=function(j){return A(j)===p},reactIs_production_min$1.isValidElementType=function(j){return typeof j=="string"||typeof j=="function"||j===n||j===c||j===a||j===s||j===p||j===m||typeof j=="object"&&j!==null&&(j.$$typeof===b||j.$$typeof===y||j.$$typeof===o||j.$$typeof===l||j.$$typeof===d||j.$$typeof===T||j.$$typeof===S||j.$$typeof===P||j.$$typeof===E)},reactIs_production_min$1.typeOf=A,reactIs_production_min$1}var hasRequiredReactIs$1;function requireReactIs$1(){return hasRequiredReactIs$1||(hasRequiredReactIs$1=1,reactIs$1.exports=requireReactIs_production_min$1()),reactIs$1.exports}var hoistNonReactStatics_cjs,hasRequiredHoistNonReactStatics_cjs;function requireHoistNonReactStatics_cjs(){if(hasRequiredHoistNonReactStatics_cjs)return hoistNonReactStatics_cjs;hasRequiredHoistNonReactStatics_cjs=1;var t=requireReactIs$1(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},n={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};a[t.ForwardRef]=n,a[t.Memo]=s;function o(b){return t.isMemo(b)?s:a[b.$$typeof]||e}var l=Object.defineProperty,u=Object.getOwnPropertyNames,c=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,m=Object.prototype;function y(b,E,T){if(typeof E!="string"){if(m){var S=p(E);S&&S!==m&&y(b,S,T)}var P=u(E);c&&(P=P.concat(c(E)));for(var A=o(b),I=o(E),j=0;j<P.length;++j){var K=P[j];if(!r[K]&&!(T&&T[K])&&!(I&&I[K])&&!(A&&A[K])){var W=d(E,K);try{l(b,K,W)}catch{}}}}return b}return hoistNonReactStatics_cjs=y,hoistNonReactStatics_cjs}var hoistNonReactStatics_cjsExports=requireHoistNonReactStatics_cjs();const hoistStatics=getDefaultExportFromCjs(hoistNonReactStatics_cjsExports);var reactIs={exports:{}},reactIs_production_min={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactIs_production_min;function requireReactIs_production_min(){if(hasRequiredReactIs_production_min)return reactIs_production_min;hasRequiredReactIs_production_min=1;var t=60103,e=60106,r=60107,n=60108,s=60114,a=60109,o=60110,l=60112,u=60113,c=60120,d=60115,p=60116,m=60121,y=60122,b=60117,E=60129,T=60131;if(typeof Symbol=="function"&&Symbol.for){var S=Symbol.for;t=S("react.element"),e=S("react.portal"),r=S("react.fragment"),n=S("react.strict_mode"),s=S("react.profiler"),a=S("react.provider"),o=S("react.context"),l=S("react.forward_ref"),u=S("react.suspense"),c=S("react.suspense_list"),d=S("react.memo"),p=S("react.lazy"),m=S("react.block"),y=S("react.server.block"),b=S("react.fundamental"),E=S("react.debug_trace_mode"),T=S("react.legacy_hidden")}function P(ae){if(typeof ae=="object"&&ae!==null){var ce=ae.$$typeof;switch(ce){case t:switch(ae=ae.type,ae){case r:case s:case n:case u:case c:return ae;default:switch(ae=ae&&ae.$$typeof,ae){case o:case l:case p:case d:case a:return ae;default:return ce}}case e:return ce}}}var A=a,I=t,j=l,K=r,W=p,H=d,ee=e,ue=s,de=n,fe=u;return reactIs_production_min.ContextConsumer=o,reactIs_production_min.ContextProvider=A,reactIs_production_min.Element=I,reactIs_production_min.ForwardRef=j,reactIs_production_min.Fragment=K,reactIs_production_min.Lazy=W,reactIs_production_min.Memo=H,reactIs_production_min.Portal=ee,reactIs_production_min.Profiler=ue,reactIs_production_min.StrictMode=de,reactIs_production_min.Suspense=fe,reactIs_production_min.isAsyncMode=function(){return!1},reactIs_production_min.isConcurrentMode=function(){return!1},reactIs_production_min.isContextConsumer=function(ae){return P(ae)===o},reactIs_production_min.isContextProvider=function(ae){return P(ae)===a},reactIs_production_min.isElement=function(ae){return typeof ae=="object"&&ae!==null&&ae.$$typeof===t},reactIs_production_min.isForwardRef=function(ae){return P(ae)===l},reactIs_production_min.isFragment=function(ae){return P(ae)===r},reactIs_production_min.isLazy=function(ae){return P(ae)===p},reactIs_production_min.isMemo=function(ae){return P(ae)===d},reactIs_production_min.isPortal=function(ae){return P(ae)===e},reactIs_production_min.isProfiler=function(ae){return P(ae)===s},reactIs_production_min.isStrictMode=function(ae){return P(ae)===n},reactIs_production_min.isSuspense=function(ae){return P(ae)===u},reactIs_production_min.isValidElementType=function(ae){return typeof ae=="string"||typeof ae=="function"||ae===r||ae===s||ae===E||ae===n||ae===u||ae===c||ae===T||typeof ae=="object"&&ae!==null&&(ae.$$typeof===p||ae.$$typeof===d||ae.$$typeof===a||ae.$$typeof===o||ae.$$typeof===l||ae.$$typeof===b||ae.$$typeof===m||ae[0]===y)},reactIs_production_min.typeOf=P,reactIs_production_min}var hasRequiredReactIs;function requireReactIs(){return hasRequiredReactIs||(hasRequiredReactIs=1,reactIs.exports=requireReactIs_production_min()),reactIs.exports}var reactIsExports=requireReactIs(),_excluded$2=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],_excluded2=["reactReduxForwardedRef"],EMPTY_ARRAY=[],NO_SUBSCRIPTION_ARRAY=[null,null];function storeStateUpdatesReducer(t,e){var r=t[1];return[e.payload,r+1]}function useIsomorphicLayoutEffectWithArgs(t,e,r){useIsomorphicLayoutEffect$1(function(){return t.apply(void 0,e)},r)}function captureWrapperProps(t,e,r,n,s,a,o){t.current=n,e.current=s,r.current=!1,a.current&&(a.current=null,o())}function subscribeUpdates(t,e,r,n,s,a,o,l,u,c){if(t){var d=!1,p=null,m=function(){if(!d){var E=e.getState(),T,S;try{T=n(E,s.current)}catch(P){S=P,p=P}S||(p=null),T===a.current?o.current||u():(a.current=T,l.current=T,o.current=!0,c({type:"STORE_UPDATED",payload:{error:S}}))}};r.onStateChange=m,r.trySubscribe(),m();var y=function(){if(d=!0,r.tryUnsubscribe(),r.onStateChange=null,p)throw p};return y}}var initStateUpdates=function t(){return[null,0]};function connectAdvanced(t,e){e===void 0&&(e={});var r=e,n=r.getDisplayName,s=n===void 0?function(A){return"ConnectAdvanced("+A+")"}:n,a=r.methodName,o=a===void 0?"connectAdvanced":a,l=r.renderCountProp,u=l===void 0?void 0:l,c=r.shouldHandleStateChanges,d=c===void 0?!0:c,p=r.storeKey,m=p===void 0?"store":p;r.withRef;var y=r.forwardRef,b=y===void 0?!1:y,E=r.context,T=E===void 0?ReactReduxContext:E,S=_objectWithoutPropertiesLoose(r,_excluded$2),P=T;return function(I){var j=I.displayName||I.name||"Component",K=s(j),W=_extends({},S,{getDisplayName:s,methodName:o,renderCountProp:u,shouldHandleStateChanges:d,storeKey:m,displayName:K,wrappedComponentName:j,WrappedComponent:I}),H=S.pure;function ee(ce){return t(ce.dispatch,W)}var ue=H?reactExports.useMemo:function(ce){return ce()};function de(ce){var me=reactExports.useMemo(function(){var lr=ce.reactReduxForwardedRef,ir=_objectWithoutPropertiesLoose(ce,_excluded2);return[ce.context,lr,ir]},[ce]),te=me[0],le=me[1],Z=me[2],Y=reactExports.useMemo(function(){return te&&te.Consumer&&reactIsExports.isContextConsumer(React.createElement(te.Consumer,null))?te:P},[te,P]),he=reactExports.useContext(Y),oe=!!ce.store&&!!ce.store.getState&&!!ce.store.dispatch;he&&he.store;var ye=oe?ce.store:he.store,Ee=reactExports.useMemo(function(){return ee(ye)},[ye]),Ae=reactExports.useMemo(function(){if(!d)return NO_SUBSCRIPTION_ARRAY;var lr=createSubscription(ye,oe?null:he.subscription),ir=lr.notifyNestedSubs.bind(lr);return[lr,ir]},[ye,oe,he]),je=Ae[0],Te=Ae[1],Ve=reactExports.useMemo(function(){return oe?he:_extends({},he,{subscription:je})},[oe,he,je]),Pe=reactExports.useReducer(storeStateUpdatesReducer,EMPTY_ARRAY,initStateUpdates),Ce=Pe[0],De=Ce[0],ze=Pe[1];if(De&&De.error)throw De.error;var Et=reactExports.useRef(),Ze=reactExports.useRef(Z),Ue=reactExports.useRef(),qt=reactExports.useRef(!1),or=ue(function(){return Ue.current&&Z===Ze.current?Ue.current:Ee(ye.getState(),Z)},[ye,De,Z]);useIsomorphicLayoutEffectWithArgs(captureWrapperProps,[Ze,Et,qt,Z,or,Ue,Te]),useIsomorphicLayoutEffectWithArgs(subscribeUpdates,[d,ye,je,Ee,Ze,Et,qt,Ue,Te,ze],[ye,je,Ee]);var Lt=reactExports.useMemo(function(){return React.createElement(I,_extends({},or,{ref:le}))},[le,I,or]),rt=reactExports.useMemo(function(){return d?React.createElement(Y.Provider,{value:Ve},Lt):Lt},[Y,Lt,Ve]);return rt}var fe=H?React.memo(de):de;if(fe.WrappedComponent=I,fe.displayName=de.displayName=K,b){var ae=React.forwardRef(function(me,te){return React.createElement(fe,_extends({},me,{reactReduxForwardedRef:te}))});return ae.displayName=K,ae.WrappedComponent=I,hoistStatics(ae,I)}return hoistStatics(fe,I)}}function is(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function shallowEqual(t,e){if(is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(var s=0;s<r.length;s++)if(!Object.prototype.hasOwnProperty.call(e,r[s])||!is(t[r[s]],e[r[s]]))return!1;return!0}function bindActionCreators(t,e){var r={},n=function(o){var l=t[o];typeof l=="function"&&(r[o]=function(){return e(l.apply(void 0,arguments))})};for(var s in t)n(s);return r}function wrapMapToPropsConstant(t){return function(r,n){var s=t(r,n);function a(){return s}return a.dependsOnOwnProps=!1,a}}function getDependsOnOwnProps(t){return t.dependsOnOwnProps!==null&&t.dependsOnOwnProps!==void 0?!!t.dependsOnOwnProps:t.length!==1}function wrapMapToPropsFunc(t,e){return function(n,s){s.displayName;var a=function(l,u){return a.dependsOnOwnProps?a.mapToProps(l,u):a.mapToProps(l)};return a.dependsOnOwnProps=!0,a.mapToProps=function(l,u){a.mapToProps=t,a.dependsOnOwnProps=getDependsOnOwnProps(t);var c=a(l,u);return typeof c=="function"&&(a.mapToProps=c,a.dependsOnOwnProps=getDependsOnOwnProps(c),c=a(l,u)),c},a}}function whenMapDispatchToPropsIsFunction(t){return typeof t=="function"?wrapMapToPropsFunc(t):void 0}function whenMapDispatchToPropsIsMissing(t){return t?void 0:wrapMapToPropsConstant(function(e){return{dispatch:e}})}function whenMapDispatchToPropsIsObject(t){return t&&typeof t=="object"?wrapMapToPropsConstant(function(e){return bindActionCreators(t,e)}):void 0}const defaultMapDispatchToPropsFactories=[whenMapDispatchToPropsIsFunction,whenMapDispatchToPropsIsMissing,whenMapDispatchToPropsIsObject];function whenMapStateToPropsIsFunction(t){return typeof t=="function"?wrapMapToPropsFunc(t):void 0}function whenMapStateToPropsIsMissing(t){return t?void 0:wrapMapToPropsConstant(function(){return{}})}const defaultMapStateToPropsFactories=[whenMapStateToPropsIsFunction,whenMapStateToPropsIsMissing];function defaultMergeProps(t,e,r){return _extends({},r,t,e)}function wrapMergePropsFunc(t){return function(r,n){n.displayName;var s=n.pure,a=n.areMergedPropsEqual,o=!1,l;return function(c,d,p){var m=t(c,d,p);return o?(!s||!a(m,l))&&(l=m):(o=!0,l=m),l}}}function whenMergePropsIsFunction(t){return typeof t=="function"?wrapMergePropsFunc(t):void 0}function whenMergePropsIsOmitted(t){return t?void 0:function(){return defaultMergeProps}}const defaultMergePropsFactories=[whenMergePropsIsFunction,whenMergePropsIsOmitted];var _excluded$1=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function impureFinalPropsSelectorFactory(t,e,r,n){return function(a,o){return r(t(a,o),e(n,o),o)}}function pureFinalPropsSelectorFactory(t,e,r,n,s){var a=s.areStatesEqual,o=s.areOwnPropsEqual,l=s.areStatePropsEqual,u=!1,c,d,p,m,y;function b(A,I){return c=A,d=I,p=t(c,d),m=e(n,d),y=r(p,m,d),u=!0,y}function E(){return p=t(c,d),e.dependsOnOwnProps&&(m=e(n,d)),y=r(p,m,d),y}function T(){return t.dependsOnOwnProps&&(p=t(c,d)),e.dependsOnOwnProps&&(m=e(n,d)),y=r(p,m,d),y}function S(){var A=t(c,d),I=!l(A,p);return p=A,I&&(y=r(p,m,d)),y}function P(A,I){var j=!o(I,d),K=!a(A,c,I,d);return c=A,d=I,j&&K?E():j?T():K?S():y}return function(I,j){return u?P(I,j):b(I,j)}}function finalPropsSelectorFactory(t,e){var r=e.initMapStateToProps,n=e.initMapDispatchToProps,s=e.initMergeProps,a=_objectWithoutPropertiesLoose(e,_excluded$1),o=r(t,a),l=n(t,a),u=s(t,a),c=a.pure?pureFinalPropsSelectorFactory:impureFinalPropsSelectorFactory;return c(o,l,u,t,a)}var _excluded=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function match(t,e,r){for(var n=e.length-1;n>=0;n--){var s=e[n](t);if(s)return s}return function(a,o){throw new Error("Invalid value of type "+typeof t+" for "+r+" argument when connecting component "+o.wrappedComponentName+".")}}function strictEqual(t,e){return t===e}function createConnect(t){var e=t===void 0?{}:t,r=e.connectHOC,n=r===void 0?connectAdvanced:r,s=e.mapStateToPropsFactories,a=s===void 0?defaultMapStateToPropsFactories:s,o=e.mapDispatchToPropsFactories,l=o===void 0?defaultMapDispatchToPropsFactories:o,u=e.mergePropsFactories,c=u===void 0?defaultMergePropsFactories:u,d=e.selectorFactory,p=d===void 0?finalPropsSelectorFactory:d;return function(y,b,E,T){T===void 0&&(T={});var S=T,P=S.pure,A=P===void 0?!0:P,I=S.areStatesEqual,j=I===void 0?strictEqual:I,K=S.areOwnPropsEqual,W=K===void 0?shallowEqual:K,H=S.areStatePropsEqual,ee=H===void 0?shallowEqual:H,ue=S.areMergedPropsEqual,de=ue===void 0?shallowEqual:ue,fe=_objectWithoutPropertiesLoose(S,_excluded),ae=match(y,a,"mapStateToProps"),ce=match(b,l,"mapDispatchToProps"),me=match(E,c,"mergeProps");return n(p,_extends({methodName:"connect",getDisplayName:function(le){return"Connect("+le+")"},shouldHandleStateChanges:!!y,initMapStateToProps:ae,initMapDispatchToProps:ce,initMergeProps:me,pure:A,areStatesEqual:j,areOwnPropsEqual:W,areStatePropsEqual:ee,areMergedPropsEqual:de},fe))}}const connect=createConnect();setBatch(reactDomExports.unstable_batchedUpdates);function areInputsEqual$1(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function useMemoOne(t,e){var r=reactExports.useState(function(){return{inputs:e,result:t()}})[0],n=reactExports.useRef(!0),s=reactExports.useRef(r),a=n.current||!!(e&&s.current.inputs&&areInputsEqual$1(e,s.current.inputs)),o=a?s.current:{inputs:e,result:t()};return reactExports.useEffect(function(){n.current=!1,s.current=o},[o]),o.result}function useCallbackOne(t,e){return useMemoOne(function(){return t},e)}var useMemo=useMemoOne,useCallback=useCallbackOne,prefix$2="Invariant failed";function invariant$1(t,e){throw new Error(prefix$2)}var getRect=function t(e){var r=e.top,n=e.right,s=e.bottom,a=e.left,o=n-a,l=s-r,u={top:r,right:n,bottom:s,left:a,width:o,height:l,x:a,y:r,center:{x:(n+a)/2,y:(s+r)/2}};return u},expand=function t(e,r){return{top:e.top-r.top,left:e.left-r.left,bottom:e.bottom+r.bottom,right:e.right+r.right}},shrink=function t(e,r){return{top:e.top+r.top,left:e.left+r.left,bottom:e.bottom-r.bottom,right:e.right-r.right}},shift=function t(e,r){return{top:e.top+r.y,left:e.left+r.x,bottom:e.bottom+r.y,right:e.right+r.x}},noSpacing$1={top:0,right:0,bottom:0,left:0},createBox=function t(e){var r=e.borderBox,n=e.margin,s=n===void 0?noSpacing$1:n,a=e.border,o=a===void 0?noSpacing$1:a,l=e.padding,u=l===void 0?noSpacing$1:l,c=getRect(expand(r,s)),d=getRect(shrink(r,o)),p=getRect(shrink(d,u));return{marginBox:c,borderBox:getRect(r),paddingBox:d,contentBox:p,margin:s,border:o,padding:u}},parse=function t(e){var r=e.slice(0,-2),n=e.slice(-2);if(n!=="px")return 0;var s=Number(r);return isNaN(s)&&invariant$1(),s},getWindowScroll$1=function t(){return{x:window.pageXOffset,y:window.pageYOffset}},offset=function t(e,r){var n=e.borderBox,s=e.border,a=e.margin,o=e.padding,l=shift(n,r);return createBox({borderBox:l,border:s,margin:a,padding:o})},withScroll=function t(e,r){return r===void 0&&(r=getWindowScroll$1()),offset(e,r)},calculateBox=function t(e,r){var n={top:parse(r.marginTop),right:parse(r.marginRight),bottom:parse(r.marginBottom),left:parse(r.marginLeft)},s={top:parse(r.paddingTop),right:parse(r.paddingRight),bottom:parse(r.paddingBottom),left:parse(r.paddingLeft)},a={top:parse(r.borderTopWidth),right:parse(r.borderRightWidth),bottom:parse(r.borderBottomWidth),left:parse(r.borderLeftWidth)};return createBox({borderBox:e,margin:n,padding:s,border:a})},getBox=function t(e){var r=e.getBoundingClientRect(),n=window.getComputedStyle(e);return calculateBox(r,n)},safeIsNaN=Number.isNaN||function t(e){return typeof e=="number"&&e!==e};function isEqual$2(t,e){return!!(t===e||safeIsNaN(t)&&safeIsNaN(e))}function areInputsEqual(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(!isEqual$2(t[r],e[r]))return!1;return!0}function memoizeOne(t,e){e===void 0&&(e=areInputsEqual);var r,n=[],s,a=!1;function o(){for(var l=[],u=0;u<arguments.length;u++)l[u]=arguments[u];return a&&r===this&&e(l,n)||(s=t.apply(this,l),a=!0,r=this,n=l),s}return o}var rafSchd=function t(e){var r=[],n=null,s=function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];r=l,!n&&(n=requestAnimationFrame(function(){n=null,e.apply(void 0,r)}))};return s.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},s};function log(t,e){}log.bind(null,"warn");log.bind(null,"error");function noop(){}function getOptions(t,e){return _extends({},t,{},e)}function bindEvents(t,e,r){var n=e.map(function(s){var a=getOptions(r,s.options);return t.addEventListener(s.eventName,s.fn,a),function(){t.removeEventListener(s.eventName,s.fn,a)}});return function(){n.forEach(function(a){a()})}}var prefix="Invariant failed";function RbdInvariant(t){this.message=t}RbdInvariant.prototype.toString=function t(){return this.message};function invariant(t,e){throw new RbdInvariant(prefix)}var ErrorBoundary=function(t){_inheritsLoose(e,t);function e(){for(var n,s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a))||this,n.callbacks=null,n.unbind=noop,n.onWindowError=function(l){var u=n.getCallbacks();u.isDragging()&&u.tryAbort();var c=l.error;c instanceof RbdInvariant&&l.preventDefault()},n.getCallbacks=function(){if(!n.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return n.callbacks},n.setCallbacks=function(l){n.callbacks=l},n}var r=e.prototype;return r.componentDidMount=function(){this.unbind=bindEvents(window,[{eventName:"error",fn:this.onWindowError}])},r.componentDidCatch=function(s){if(s instanceof RbdInvariant){this.setState({});return}throw s},r.componentWillUnmount=function(){this.unbind()},r.render=function(){return this.props.children(this.setCallbacks)},e}(React.Component),dragHandleUsageInstructions=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,position=function t(e){return e+1},onDragStart=function t(e){return`
  You have lifted an item in position `+position(e.source.index)+`
`},withLocation=function t(e,r){var n=e.droppableId===r.droppableId,s=position(e.index),a=position(r.index);return n?`
      You have moved the item from position `+s+`
      to position `+a+`
    `:`
    You have moved the item from position `+s+`
    in list `+e.droppableId+`
    to list `+r.droppableId+`
    in position `+a+`
  `},withCombine=function t(e,r,n){var s=r.droppableId===n.droppableId;return s?`
      The item `+e+`
      has been combined with `+n.draggableId:`
      The item `+e+`
      in list `+r.droppableId+`
      has been combined with `+n.draggableId+`
      in list `+n.droppableId+`
    `},onDragUpdate=function t(e){var r=e.destination;if(r)return withLocation(e.source,r);var n=e.combine;return n?withCombine(e.draggableId,e.source,n):"You are over an area that cannot be dropped on"},returnedToStart=function t(e){return`
  The item has returned to its starting position
  of `+position(e.index)+`
`},onDragEnd=function t(e){if(e.reason==="CANCEL")return`
      Movement cancelled.
      `+returnedToStart(e.source)+`
    `;var r=e.destination,n=e.combine;return r?`
      You have dropped the item.
      `+withLocation(e.source,r)+`
    `:n?`
      You have dropped the item.
      `+withCombine(e.draggableId,e.source,n)+`
    `:`
    The item has been dropped while not over a drop area.
    `+returnedToStart(e.source)+`
  `},preset={dragHandleUsageInstructions,onDragStart,onDragUpdate,onDragEnd},origin={x:0,y:0},add=function t(e,r){return{x:e.x+r.x,y:e.y+r.y}},subtract=function t(e,r){return{x:e.x-r.x,y:e.y-r.y}},isEqual=function t(e,r){return e.x===r.x&&e.y===r.y},negate=function t(e){return{x:e.x!==0?-e.x:0,y:e.y!==0?-e.y:0}},patch=function t(e,r,n){var s;return n===void 0&&(n=0),s={},s[e]=r,s[e==="x"?"y":"x"]=n,s},distance=function t(e,r){return Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2))},closest=function t(e,r){return Math.min.apply(Math,r.map(function(n){return distance(e,n)}))},apply=function t(e){return function(r){return{x:e(r.x),y:e(r.y)}}},executeClip=function(t,e){var r=getRect({top:Math.max(e.top,t.top),right:Math.min(e.right,t.right),bottom:Math.min(e.bottom,t.bottom),left:Math.max(e.left,t.left)});return r.width<=0||r.height<=0?null:r},offsetByPosition=function t(e,r){return{top:e.top+r.y,left:e.left+r.x,bottom:e.bottom+r.y,right:e.right+r.x}},getCorners=function t(e){return[{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.left,y:e.bottom},{x:e.right,y:e.bottom}]},noSpacing={top:0,right:0,bottom:0,left:0},scroll=function t(e,r){return r?offsetByPosition(e,r.scroll.diff.displacement):e},increase=function t(e,r,n){if(n&&n.increasedBy){var s;return _extends({},e,(s={},s[r.end]=e[r.end]+n.increasedBy[r.line],s))}return e},clip=function t(e,r){return r&&r.shouldClipSubject?executeClip(r.pageMarginBox,e):getRect(e)},getSubject=function(t){var e=t.page,r=t.withPlaceholder,n=t.axis,s=t.frame,a=scroll(e.marginBox,s),o=increase(a,n,r),l=clip(o,s);return{page:e,withPlaceholder:r,active:l}},scrollDroppable=function(t,e){t.frame||invariant();var r=t.frame,n=subtract(e,r.scroll.initial),s=negate(n),a=_extends({},r,{scroll:{initial:r.scroll.initial,current:e,diff:{value:n,displacement:s},max:r.scroll.max}}),o=getSubject({page:t.subject.page,withPlaceholder:t.subject.withPlaceholder,axis:t.axis,frame:a}),l=_extends({},t,{frame:a,subject:o});return l};function values(t){return Object.values?Object.values(t):Object.keys(t).map(function(e){return t[e]})}function findIndex(t,e){if(t.findIndex)return t.findIndex(e);for(var r=0;r<t.length;r++)if(e(t[r]))return r;return-1}function find(t,e){if(t.find)return t.find(e);var r=findIndex(t,e);if(r!==-1)return t[r]}function toArray(t){return Array.prototype.slice.call(t)}var toDroppableMap=memoizeOne(function(t){return t.reduce(function(e,r){return e[r.descriptor.id]=r,e},{})}),toDraggableMap=memoizeOne(function(t){return t.reduce(function(e,r){return e[r.descriptor.id]=r,e},{})}),toDroppableList=memoizeOne(function(t){return values(t)}),toDraggableList=memoizeOne(function(t){return values(t)}),getDraggablesInsideDroppable=memoizeOne(function(t,e){var r=toDraggableList(e).filter(function(n){return t===n.descriptor.droppableId}).sort(function(n,s){return n.descriptor.index-s.descriptor.index});return r});function tryGetDestination(t){return t.at&&t.at.type==="REORDER"?t.at.destination:null}function tryGetCombine(t){return t.at&&t.at.type==="COMBINE"?t.at.combine:null}var removeDraggableFromList=memoizeOne(function(t,e){return e.filter(function(r){return r.descriptor.id!==t.descriptor.id})}),moveToNextCombine=function(t){var e=t.isMovingForward,r=t.draggable,n=t.destination,s=t.insideDestination,a=t.previousImpact;if(!n.isCombineEnabled)return null;var o=tryGetDestination(a);if(!o)return null;function l(E){var T={type:"COMBINE",combine:{draggableId:E,droppableId:n.descriptor.id}};return _extends({},a,{at:T})}var u=a.displaced.all,c=u.length?u[0]:null;if(e)return c?l(c):null;var d=removeDraggableFromList(r,s);if(!c){if(!d.length)return null;var p=d[d.length-1];return l(p.descriptor.id)}var m=findIndex(d,function(E){return E.descriptor.id===c});m===-1&&invariant();var y=m-1;if(y<0)return null;var b=d[y];return l(b.descriptor.id)},isHomeOf=function(t,e){return t.descriptor.droppableId===e.descriptor.id},noDisplacedBy={point:origin,value:0},emptyGroups={invisible:{},visible:{},all:[]},noImpact={displaced:emptyGroups,displacedBy:noDisplacedBy,at:null},isWithin=function(t,e){return function(r){return t<=r&&r<=e}},isPartiallyVisibleThroughFrame=function(t){var e=isWithin(t.top,t.bottom),r=isWithin(t.left,t.right);return function(n){var s=e(n.top)&&e(n.bottom)&&r(n.left)&&r(n.right);if(s)return!0;var a=e(n.top)||e(n.bottom),o=r(n.left)||r(n.right),l=a&&o;if(l)return!0;var u=n.top<t.top&&n.bottom>t.bottom,c=n.left<t.left&&n.right>t.right,d=u&&c;if(d)return!0;var p=u&&o||c&&a;return p}},isTotallyVisibleThroughFrame=function(t){var e=isWithin(t.top,t.bottom),r=isWithin(t.left,t.right);return function(n){var s=e(n.top)&&e(n.bottom)&&r(n.left)&&r(n.right);return s}},vertical={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},horizontal={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"},isTotallyVisibleThroughFrameOnAxis=function(t){return function(e){var r=isWithin(e.top,e.bottom),n=isWithin(e.left,e.right);return function(s){return t===vertical?r(s.top)&&r(s.bottom):n(s.left)&&n(s.right)}}},getDroppableDisplaced=function t(e,r){var n=r.frame?r.frame.scroll.diff.displacement:origin;return offsetByPosition(e,n)},isVisibleInDroppable=function t(e,r,n){return r.subject.active?n(r.subject.active)(e):!1},isVisibleInViewport=function t(e,r,n){return n(r)(e)},isVisible=function t(e){var r=e.target,n=e.destination,s=e.viewport,a=e.withDroppableDisplacement,o=e.isVisibleThroughFrameFn,l=a?getDroppableDisplaced(r,n):r;return isVisibleInDroppable(l,n,o)&&isVisibleInViewport(l,s,o)},isPartiallyVisible=function t(e){return isVisible(_extends({},e,{isVisibleThroughFrameFn:isPartiallyVisibleThroughFrame}))},isTotallyVisible=function t(e){return isVisible(_extends({},e,{isVisibleThroughFrameFn:isTotallyVisibleThroughFrame}))},isTotallyVisibleOnAxis=function t(e){return isVisible(_extends({},e,{isVisibleThroughFrameFn:isTotallyVisibleThroughFrameOnAxis(e.destination.axis)}))},getShouldAnimate=function t(e,r,n){if(typeof n=="boolean")return n;if(!r)return!0;var s=r.invisible,a=r.visible;if(s[e])return!1;var o=a[e];return o?o.shouldAnimate:!0};function getTarget(t,e){var r=t.page.marginBox,n={top:e.point.y,right:0,bottom:0,left:e.point.x};return getRect(expand(r,n))}function getDisplacementGroups(t){var e=t.afterDragging,r=t.destination,n=t.displacedBy,s=t.viewport,a=t.forceShouldAnimate,o=t.last;return e.reduce(function(u,c){var d=getTarget(c,n),p=c.descriptor.id;u.all.push(p);var m=isPartiallyVisible({target:d,destination:r,viewport:s,withDroppableDisplacement:!0});if(!m)return u.invisible[c.descriptor.id]=!0,u;var y=getShouldAnimate(p,o,a),b={draggableId:p,shouldAnimate:y};return u.visible[p]=b,u},{all:[],visible:{},invisible:{}})}function getIndexOfLastItem(t,e){if(!t.length)return 0;var r=t[t.length-1].descriptor.index;return e.inHomeList?r:r+1}function goAtEnd(t){var e=t.insideDestination,r=t.inHomeList,n=t.displacedBy,s=t.destination,a=getIndexOfLastItem(e,{inHomeList:r});return{displaced:emptyGroups,displacedBy:n,at:{type:"REORDER",destination:{droppableId:s.descriptor.id,index:a}}}}function calculateReorderImpact(t){var e=t.draggable,r=t.insideDestination,n=t.destination,s=t.viewport,a=t.displacedBy,o=t.last,l=t.index,u=t.forceShouldAnimate,c=isHomeOf(e,n);if(l==null)return goAtEnd({insideDestination:r,inHomeList:c,displacedBy:a,destination:n});var d=find(r,function(E){return E.descriptor.index===l});if(!d)return goAtEnd({insideDestination:r,inHomeList:c,displacedBy:a,destination:n});var p=removeDraggableFromList(e,r),m=r.indexOf(d),y=p.slice(m),b=getDisplacementGroups({afterDragging:y,destination:n,displacedBy:a,last:o,viewport:s.frame,forceShouldAnimate:u});return{displaced:b,displacedBy:a,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:l}}}}function didStartAfterCritical(t,e){return!!e.effected[t]}var fromCombine=function(t){var e=t.isMovingForward,r=t.destination,n=t.draggables,s=t.combine,a=t.afterCritical;if(!r.isCombineEnabled)return null;var o=s.draggableId,l=n[o],u=l.descriptor.index,c=didStartAfterCritical(o,a);return c?e?u:u-1:e?u+1:u},fromReorder=function(t){var e=t.isMovingForward,r=t.isInHomeList,n=t.insideDestination,s=t.location;if(!n.length)return null;var a=s.index,o=e?a+1:a-1,l=n[0].descriptor.index,u=n[n.length-1].descriptor.index,c=r?u:u+1;return o<l||o>c?null:o},moveToNextIndex=function(t){var e=t.isMovingForward,r=t.isInHomeList,n=t.draggable,s=t.draggables,a=t.destination,o=t.insideDestination,l=t.previousImpact,u=t.viewport,c=t.afterCritical,d=l.at;if(d||invariant(),d.type==="REORDER"){var p=fromReorder({isMovingForward:e,isInHomeList:r,location:d.destination,insideDestination:o});return p==null?null:calculateReorderImpact({draggable:n,insideDestination:o,destination:a,viewport:u,last:l.displaced,displacedBy:l.displacedBy,index:p})}var m=fromCombine({isMovingForward:e,destination:a,displaced:l.displaced,draggables:s,combine:d.combine,afterCritical:c});return m==null?null:calculateReorderImpact({draggable:n,insideDestination:o,destination:a,viewport:u,last:l.displaced,displacedBy:l.displacedBy,index:m})},getCombinedItemDisplacement=function(t){var e=t.displaced,r=t.afterCritical,n=t.combineWith,s=t.displacedBy,a=!!(e.visible[n]||e.invisible[n]);return didStartAfterCritical(n,r)?a?origin:negate(s.point):a?s.point:origin},whenCombining=function(t){var e=t.afterCritical,r=t.impact,n=t.draggables,s=tryGetCombine(r);s||invariant();var a=s.draggableId,o=n[a].page.borderBox.center,l=getCombinedItemDisplacement({displaced:r.displaced,afterCritical:e,combineWith:a,displacedBy:r.displacedBy});return add(o,l)},distanceFromStartToBorderBoxCenter=function t(e,r){return r.margin[e.start]+r.borderBox[e.size]/2},distanceFromEndToBorderBoxCenter=function t(e,r){return r.margin[e.end]+r.borderBox[e.size]/2},getCrossAxisBorderBoxCenter=function t(e,r,n){return r[e.crossAxisStart]+n.margin[e.crossAxisStart]+n.borderBox[e.crossAxisSize]/2},goAfter=function t(e){var r=e.axis,n=e.moveRelativeTo,s=e.isMoving;return patch(r.line,n.marginBox[r.end]+distanceFromStartToBorderBoxCenter(r,s),getCrossAxisBorderBoxCenter(r,n.marginBox,s))},goBefore=function t(e){var r=e.axis,n=e.moveRelativeTo,s=e.isMoving;return patch(r.line,n.marginBox[r.start]-distanceFromEndToBorderBoxCenter(r,s),getCrossAxisBorderBoxCenter(r,n.marginBox,s))},goIntoStart=function t(e){var r=e.axis,n=e.moveInto,s=e.isMoving;return patch(r.line,n.contentBox[r.start]+distanceFromStartToBorderBoxCenter(r,s),getCrossAxisBorderBoxCenter(r,n.contentBox,s))},whenReordering=function(t){var e=t.impact,r=t.draggable,n=t.draggables,s=t.droppable,a=t.afterCritical,o=getDraggablesInsideDroppable(s.descriptor.id,n),l=r.page,u=s.axis;if(!o.length)return goIntoStart({axis:u,moveInto:s.page,isMoving:l});var c=e.displaced,d=e.displacedBy,p=c.all[0];if(p){var m=n[p];if(didStartAfterCritical(p,a))return goBefore({axis:u,moveRelativeTo:m.page,isMoving:l});var y=offset(m.page,d.point);return goBefore({axis:u,moveRelativeTo:y,isMoving:l})}var b=o[o.length-1];if(b.descriptor.id===r.descriptor.id)return l.borderBox.center;if(didStartAfterCritical(b.descriptor.id,a)){var E=offset(b.page,negate(a.displacedBy.point));return goAfter({axis:u,moveRelativeTo:E,isMoving:l})}return goAfter({axis:u,moveRelativeTo:b.page,isMoving:l})},withDroppableDisplacement=function(t,e){var r=t.frame;return r?add(e,r.scroll.diff.displacement):e},getResultWithoutDroppableDisplacement=function t(e){var r=e.impact,n=e.draggable,s=e.droppable,a=e.draggables,o=e.afterCritical,l=n.page.borderBox.center,u=r.at;return!s||!u?l:u.type==="REORDER"?whenReordering({impact:r,draggable:n,draggables:a,droppable:s,afterCritical:o}):whenCombining({impact:r,draggables:a,afterCritical:o})},getPageBorderBoxCenterFromImpact=function(t){var e=getResultWithoutDroppableDisplacement(t),r=t.droppable,n=r?withDroppableDisplacement(r,e):e;return n},scrollViewport=function(t,e){var r=subtract(e,t.scroll.initial),n=negate(r),s=getRect({top:e.y,bottom:e.y+t.frame.height,left:e.x,right:e.x+t.frame.width}),a={frame:s,scroll:{initial:t.scroll.initial,max:t.scroll.max,current:e,diff:{value:r,displacement:n}}};return a};function getDraggables(t,e){return t.map(function(r){return e[r]})}function tryGetVisible(t,e){for(var r=0;r<e.length;r++){var n=e[r].visible[t];if(n)return n}return null}var speculativelyIncrease=function(t){var e=t.impact,r=t.viewport,n=t.destination,s=t.draggables,a=t.maxScrollChange,o=scrollViewport(r,add(r.scroll.current,a)),l=n.frame?scrollDroppable(n,add(n.frame.scroll.current,a)):n,u=e.displaced,c=getDisplacementGroups({afterDragging:getDraggables(u.all,s),destination:n,displacedBy:e.displacedBy,viewport:o.frame,last:u,forceShouldAnimate:!1}),d=getDisplacementGroups({afterDragging:getDraggables(u.all,s),destination:l,displacedBy:e.displacedBy,viewport:r.frame,last:u,forceShouldAnimate:!1}),p={},m={},y=[u,c,d];u.all.forEach(function(E){var T=tryGetVisible(E,y);if(T){m[E]=T;return}p[E]=!0});var b=_extends({},e,{displaced:{all:u.all,invisible:p,visible:m}});return b},withViewportDisplacement=function(t,e){return add(t.scroll.diff.displacement,e)},getClientFromPageBorderBoxCenter=function(t){var e=t.pageBorderBoxCenter,r=t.draggable,n=t.viewport,s=withViewportDisplacement(n,e),a=subtract(s,r.page.borderBox.center);return add(r.client.borderBox.center,a)},isTotallyVisibleInNewLocation=function(t){var e=t.draggable,r=t.destination,n=t.newPageBorderBoxCenter,s=t.viewport,a=t.withDroppableDisplacement,o=t.onlyOnMainAxis,l=o===void 0?!1:o,u=subtract(n,e.page.borderBox.center),c=offsetByPosition(e.page.borderBox,u),d={target:c,destination:r,withDroppableDisplacement:a,viewport:s};return l?isTotallyVisibleOnAxis(d):isTotallyVisible(d)},moveToNextPlace=function(t){var e=t.isMovingForward,r=t.draggable,n=t.destination,s=t.draggables,a=t.previousImpact,o=t.viewport,l=t.previousPageBorderBoxCenter,u=t.previousClientSelection,c=t.afterCritical;if(!n.isEnabled)return null;var d=getDraggablesInsideDroppable(n.descriptor.id,s),p=isHomeOf(r,n),m=moveToNextCombine({isMovingForward:e,draggable:r,destination:n,insideDestination:d,previousImpact:a})||moveToNextIndex({isMovingForward:e,isInHomeList:p,draggable:r,draggables:s,destination:n,insideDestination:d,previousImpact:a,viewport:o,afterCritical:c});if(!m)return null;var y=getPageBorderBoxCenterFromImpact({impact:m,draggable:r,droppable:n,draggables:s,afterCritical:c}),b=isTotallyVisibleInNewLocation({draggable:r,destination:n,newPageBorderBoxCenter:y,viewport:o.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});if(b){var E=getClientFromPageBorderBoxCenter({pageBorderBoxCenter:y,draggable:r,viewport:o});return{clientSelection:E,impact:m,scrollJumpRequest:null}}var T=subtract(y,l),S=speculativelyIncrease({impact:m,viewport:o,destination:n,draggables:s,maxScrollChange:T});return{clientSelection:u,impact:S,scrollJumpRequest:T}},getKnownActive=function t(e){var r=e.subject.active;return r||invariant(),r},getBestCrossAxisDroppable=function(t){var e=t.isMovingForward,r=t.pageBorderBoxCenter,n=t.source,s=t.droppables,a=t.viewport,o=n.subject.active;if(!o)return null;var l=n.axis,u=isWithin(o[l.start],o[l.end]),c=toDroppableList(s).filter(function(p){return p!==n}).filter(function(p){return p.isEnabled}).filter(function(p){return!!p.subject.active}).filter(function(p){return isPartiallyVisibleThroughFrame(a.frame)(getKnownActive(p))}).filter(function(p){var m=getKnownActive(p);return e?o[l.crossAxisEnd]<m[l.crossAxisEnd]:m[l.crossAxisStart]<o[l.crossAxisStart]}).filter(function(p){var m=getKnownActive(p),y=isWithin(m[l.start],m[l.end]);return u(m[l.start])||u(m[l.end])||y(o[l.start])||y(o[l.end])}).sort(function(p,m){var y=getKnownActive(p)[l.crossAxisStart],b=getKnownActive(m)[l.crossAxisStart];return e?y-b:b-y}).filter(function(p,m,y){return getKnownActive(p)[l.crossAxisStart]===getKnownActive(y[0])[l.crossAxisStart]});if(!c.length)return null;if(c.length===1)return c[0];var d=c.filter(function(p){var m=isWithin(getKnownActive(p)[l.start],getKnownActive(p)[l.end]);return m(r[l.line])});return d.length===1?d[0]:d.length>1?d.sort(function(p,m){return getKnownActive(p)[l.start]-getKnownActive(m)[l.start]})[0]:c.sort(function(p,m){var y=closest(r,getCorners(getKnownActive(p))),b=closest(r,getCorners(getKnownActive(m)));return y!==b?y-b:getKnownActive(p)[l.start]-getKnownActive(m)[l.start]})[0]},getCurrentPageBorderBoxCenter=function t(e,r){var n=e.page.borderBox.center;return didStartAfterCritical(e.descriptor.id,r)?subtract(n,r.displacedBy.point):n},getCurrentPageBorderBox=function t(e,r){var n=e.page.borderBox;return didStartAfterCritical(e.descriptor.id,r)?offsetByPosition(n,negate(r.displacedBy.point)):n},getClosestDraggable=function(t){var e=t.pageBorderBoxCenter,r=t.viewport,n=t.destination,s=t.insideDestination,a=t.afterCritical,o=s.filter(function(l){return isTotallyVisible({target:getCurrentPageBorderBox(l,a),destination:n,viewport:r.frame,withDroppableDisplacement:!0})}).sort(function(l,u){var c=distance(e,withDroppableDisplacement(n,getCurrentPageBorderBoxCenter(l,a))),d=distance(e,withDroppableDisplacement(n,getCurrentPageBorderBoxCenter(u,a)));return c<d?-1:d<c?1:l.descriptor.index-u.descriptor.index});return o[0]||null},getDisplacedBy=memoizeOne(function t(e,r){var n=r[e.line];return{value:n,point:patch(e.line,n)}}),getRequiredGrowthForPlaceholder=function t(e,r,n){var s=e.axis;if(e.descriptor.mode==="virtual")return patch(s.line,r[s.line]);var a=e.subject.page.contentBox[s.size],o=getDraggablesInsideDroppable(e.descriptor.id,n),l=o.reduce(function(d,p){return d+p.client.marginBox[s.size]},0),u=l+r[s.line],c=u-a;return c<=0?null:patch(s.line,c)},withMaxScroll=function t(e,r){return _extends({},e,{scroll:_extends({},e.scroll,{max:r})})},addPlaceholder=function t(e,r,n){var s=e.frame;isHomeOf(r,e)&&invariant(),e.subject.withPlaceholder&&invariant();var a=getDisplacedBy(e.axis,r.displaceBy).point,o=getRequiredGrowthForPlaceholder(e,a,n),l={placeholderSize:a,increasedBy:o,oldFrameMaxScroll:e.frame?e.frame.scroll.max:null};if(!s){var u=getSubject({page:e.subject.page,withPlaceholder:l,axis:e.axis,frame:e.frame});return _extends({},e,{subject:u})}var c=o?add(s.scroll.max,o):s.scroll.max,d=withMaxScroll(s,c),p=getSubject({page:e.subject.page,withPlaceholder:l,axis:e.axis,frame:d});return _extends({},e,{subject:p,frame:d})},removePlaceholder=function t(e){var r=e.subject.withPlaceholder;r||invariant();var n=e.frame;if(!n){var s=getSubject({page:e.subject.page,axis:e.axis,frame:null,withPlaceholder:null});return _extends({},e,{subject:s})}var a=r.oldFrameMaxScroll;a||invariant();var o=withMaxScroll(n,a),l=getSubject({page:e.subject.page,axis:e.axis,frame:o,withPlaceholder:null});return _extends({},e,{subject:l,frame:o})},moveToNewDroppable=function(t){var e=t.previousPageBorderBoxCenter,r=t.moveRelativeTo,n=t.insideDestination,s=t.draggable,a=t.draggables,o=t.destination,l=t.viewport,u=t.afterCritical;if(!r){if(n.length)return null;var c={displaced:emptyGroups,displacedBy:noDisplacedBy,at:{type:"REORDER",destination:{droppableId:o.descriptor.id,index:0}}},d=getPageBorderBoxCenterFromImpact({impact:c,draggable:s,droppable:o,draggables:a,afterCritical:u}),p=isHomeOf(s,o)?o:addPlaceholder(o,s,a),m=isTotallyVisibleInNewLocation({draggable:s,destination:p,newPageBorderBoxCenter:d,viewport:l.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});return m?c:null}var y=e[o.axis.line]<=r.page.borderBox.center[o.axis.line],b=function(){var T=r.descriptor.index;return r.descriptor.id===s.descriptor.id||y?T:T+1}(),E=getDisplacedBy(o.axis,s.displaceBy);return calculateReorderImpact({draggable:s,insideDestination:n,destination:o,viewport:l,displacedBy:E,last:emptyGroups,index:b})},moveCrossAxis=function(t){var e=t.isMovingForward,r=t.previousPageBorderBoxCenter,n=t.draggable,s=t.isOver,a=t.draggables,o=t.droppables,l=t.viewport,u=t.afterCritical,c=getBestCrossAxisDroppable({isMovingForward:e,pageBorderBoxCenter:r,source:s,droppables:o,viewport:l});if(!c)return null;var d=getDraggablesInsideDroppable(c.descriptor.id,a),p=getClosestDraggable({pageBorderBoxCenter:r,viewport:l,destination:c,insideDestination:d,afterCritical:u}),m=moveToNewDroppable({previousPageBorderBoxCenter:r,destination:c,draggable:n,draggables:a,moveRelativeTo:p,insideDestination:d,viewport:l,afterCritical:u});if(!m)return null;var y=getPageBorderBoxCenterFromImpact({impact:m,draggable:n,droppable:c,draggables:a,afterCritical:u}),b=getClientFromPageBorderBoxCenter({pageBorderBoxCenter:y,draggable:n,viewport:l});return{clientSelection:b,impact:m,scrollJumpRequest:null}},whatIsDraggedOver=function(t){var e=t.at;return e?e.type==="REORDER"?e.destination.droppableId:e.combine.droppableId:null},getDroppableOver=function t(e,r){var n=whatIsDraggedOver(e);return n?r[n]:null},moveInDirection=function(t){var e=t.state,r=t.type,n=getDroppableOver(e.impact,e.dimensions.droppables),s=!!n,a=e.dimensions.droppables[e.critical.droppable.id],o=n||a,l=o.axis.direction,u=l==="vertical"&&(r==="MOVE_UP"||r==="MOVE_DOWN")||l==="horizontal"&&(r==="MOVE_LEFT"||r==="MOVE_RIGHT");if(u&&!s)return null;var c=r==="MOVE_DOWN"||r==="MOVE_RIGHT",d=e.dimensions.draggables[e.critical.draggable.id],p=e.current.page.borderBoxCenter,m=e.dimensions,y=m.draggables,b=m.droppables;return u?moveToNextPlace({isMovingForward:c,previousPageBorderBoxCenter:p,draggable:d,destination:o,draggables:y,viewport:e.viewport,previousClientSelection:e.current.client.selection,previousImpact:e.impact,afterCritical:e.afterCritical}):moveCrossAxis({isMovingForward:c,previousPageBorderBoxCenter:p,draggable:d,isOver:o,draggables:y,droppables:b,viewport:e.viewport,afterCritical:e.afterCritical})};function isMovementAllowed(t){return t.phase==="DRAGGING"||t.phase==="COLLECTING"}function isPositionInFrame(t){var e=isWithin(t.top,t.bottom),r=isWithin(t.left,t.right);return function(s){return e(s.y)&&r(s.x)}}function getHasOverlap(t,e){return t.left<e.right&&t.right>e.left&&t.top<e.bottom&&t.bottom>e.top}function getFurthestAway(t){var e=t.pageBorderBox,r=t.draggable,n=t.candidates,s=r.page.borderBox.center,a=n.map(function(o){var l=o.axis,u=patch(o.axis.line,e.center[l.line],o.page.borderBox.center[l.crossAxisLine]);return{id:o.descriptor.id,distance:distance(s,u)}}).sort(function(o,l){return l.distance-o.distance});return a[0]?a[0].id:null}function getDroppableOver$1(t){var e=t.pageBorderBox,r=t.draggable,n=t.droppables,s=toDroppableList(n).filter(function(a){if(!a.isEnabled)return!1;var o=a.subject.active;if(!o||!getHasOverlap(e,o))return!1;if(isPositionInFrame(o)(e.center))return!0;var l=a.axis,u=o.center[l.crossAxisLine],c=e[l.crossAxisStart],d=e[l.crossAxisEnd],p=isWithin(o[l.crossAxisStart],o[l.crossAxisEnd]),m=p(c),y=p(d);return!m&&!y?!0:m?c<u:d>u});return s.length?s.length===1?s[0].descriptor.id:getFurthestAway({pageBorderBox:e,draggable:r,candidates:s}):null}var offsetRectByPosition=function t(e,r){return getRect(offsetByPosition(e,r))},withDroppableScroll=function(t,e){var r=t.frame;return r?offsetRectByPosition(e,r.scroll.diff.value):e};function getIsDisplaced(t){var e=t.displaced,r=t.id;return!!(e.visible[r]||e.invisible[r])}function atIndex(t){var e=t.draggable,r=t.closest,n=t.inHomeList;return r?n&&r.descriptor.index>e.descriptor.index?r.descriptor.index-1:r.descriptor.index:null}var getReorderImpact=function(t){var e=t.pageBorderBoxWithDroppableScroll,r=t.draggable,n=t.destination,s=t.insideDestination,a=t.last,o=t.viewport,l=t.afterCritical,u=n.axis,c=getDisplacedBy(n.axis,r.displaceBy),d=c.value,p=e[u.start],m=e[u.end],y=removeDraggableFromList(r,s),b=find(y,function(T){var S=T.descriptor.id,P=T.page.borderBox.center[u.line],A=didStartAfterCritical(S,l),I=getIsDisplaced({displaced:a,id:S});return A?I?m<=P:p<P-d:I?m<=P+d:p<P}),E=atIndex({draggable:r,closest:b,inHomeList:isHomeOf(r,n)});return calculateReorderImpact({draggable:r,insideDestination:s,destination:n,viewport:o,last:a,displacedBy:c,index:E})},combineThresholdDivisor=4,getCombineImpact=function(t){var e=t.draggable,r=t.pageBorderBoxWithDroppableScroll,n=t.previousImpact,s=t.destination,a=t.insideDestination,o=t.afterCritical;if(!s.isCombineEnabled)return null;var l=s.axis,u=getDisplacedBy(s.axis,e.displaceBy),c=u.value,d=r[l.start],p=r[l.end],m=removeDraggableFromList(e,a),y=find(m,function(E){var T=E.descriptor.id,S=E.page.borderBox,P=S[l.size],A=P/combineThresholdDivisor,I=didStartAfterCritical(T,o),j=getIsDisplaced({displaced:n.displaced,id:T});return I?j?p>S[l.start]+A&&p<S[l.end]-A:d>S[l.start]-c+A&&d<S[l.end]-c-A:j?p>S[l.start]+c+A&&p<S[l.end]+c-A:d>S[l.start]+A&&d<S[l.end]-A});if(!y)return null;var b={displacedBy:u,displaced:n.displaced,at:{type:"COMBINE",combine:{draggableId:y.descriptor.id,droppableId:s.descriptor.id}}};return b},getDragImpact=function(t){var e=t.pageOffset,r=t.draggable,n=t.draggables,s=t.droppables,a=t.previousImpact,o=t.viewport,l=t.afterCritical,u=offsetRectByPosition(r.page.borderBox,e),c=getDroppableOver$1({pageBorderBox:u,draggable:r,droppables:s});if(!c)return noImpact;var d=s[c],p=getDraggablesInsideDroppable(d.descriptor.id,n),m=withDroppableScroll(d,u);return getCombineImpact({pageBorderBoxWithDroppableScroll:m,draggable:r,previousImpact:a,destination:d,insideDestination:p,afterCritical:l})||getReorderImpact({pageBorderBoxWithDroppableScroll:m,draggable:r,destination:d,insideDestination:p,last:a.displaced,viewport:o,afterCritical:l})},patchDroppableMap=function(t,e){var r;return _extends({},t,(r={},r[e.descriptor.id]=e,r))},clearUnusedPlaceholder=function t(e){var r=e.previousImpact,n=e.impact,s=e.droppables,a=whatIsDraggedOver(r),o=whatIsDraggedOver(n);if(!a||a===o)return s;var l=s[a];if(!l.subject.withPlaceholder)return s;var u=removePlaceholder(l);return patchDroppableMap(s,u)},recomputePlaceholders=function(t){var e=t.draggable,r=t.draggables,n=t.droppables,s=t.previousImpact,a=t.impact,o=clearUnusedPlaceholder({previousImpact:s,impact:a,droppables:n}),l=whatIsDraggedOver(a);if(!l)return o;var u=n[l];if(isHomeOf(e,u)||u.subject.withPlaceholder)return o;var c=addPlaceholder(u,e,r);return patchDroppableMap(o,c)},update=function(t){var e=t.state,r=t.clientSelection,n=t.dimensions,s=t.viewport,a=t.impact,o=t.scrollJumpRequest,l=s||e.viewport,u=n||e.dimensions,c=r||e.current.client.selection,d=subtract(c,e.initial.client.selection),p={offset:d,selection:c,borderBoxCenter:add(e.initial.client.borderBoxCenter,d)},m={selection:add(p.selection,l.scroll.current),borderBoxCenter:add(p.borderBoxCenter,l.scroll.current),offset:add(p.offset,l.scroll.diff.value)},y={client:p,page:m};if(e.phase==="COLLECTING")return _extends({phase:"COLLECTING"},e,{dimensions:u,viewport:l,current:y});var b=u.draggables[e.critical.draggable.id],E=a||getDragImpact({pageOffset:m.offset,draggable:b,draggables:u.draggables,droppables:u.droppables,previousImpact:e.impact,viewport:l,afterCritical:e.afterCritical}),T=recomputePlaceholders({draggable:b,impact:E,previousImpact:e.impact,draggables:u.draggables,droppables:u.droppables}),S=_extends({},e,{current:y,dimensions:{draggables:u.draggables,droppables:T},impact:E,viewport:l,scrollJumpRequest:o||null,forceShouldAnimate:o?!1:null});return S};function getDraggables$1(t,e){return t.map(function(r){return e[r]})}var recompute=function(t){var e=t.impact,r=t.viewport,n=t.draggables,s=t.destination,a=t.forceShouldAnimate,o=e.displaced,l=getDraggables$1(o.all,n),u=getDisplacementGroups({afterDragging:l,destination:s,displacedBy:e.displacedBy,viewport:r.frame,forceShouldAnimate:a,last:o});return _extends({},e,{displaced:u})},getClientBorderBoxCenter=function(t){var e=t.impact,r=t.draggable,n=t.droppable,s=t.draggables,a=t.viewport,o=t.afterCritical,l=getPageBorderBoxCenterFromImpact({impact:e,draggable:r,draggables:s,droppable:n,afterCritical:o});return getClientFromPageBorderBoxCenter({pageBorderBoxCenter:l,draggable:r,viewport:a})},refreshSnap=function(t){var e=t.state,r=t.dimensions,n=t.viewport;e.movementMode!=="SNAP"&&invariant();var s=e.impact,a=n||e.viewport,o=r||e.dimensions,l=o.draggables,u=o.droppables,c=l[e.critical.draggable.id],d=whatIsDraggedOver(s);d||invariant();var p=u[d],m=recompute({impact:s,viewport:a,destination:p,draggables:l}),y=getClientBorderBoxCenter({impact:m,draggable:c,droppable:p,draggables:l,viewport:a,afterCritical:e.afterCritical});return update({impact:m,clientSelection:y,state:e,dimensions:o,viewport:a})},getHomeLocation=function(t){return{index:t.index,droppableId:t.droppableId}},getLiftEffect=function(t){var e=t.draggable,r=t.home,n=t.draggables,s=t.viewport,a=getDisplacedBy(r.axis,e.displaceBy),o=getDraggablesInsideDroppable(r.descriptor.id,n),l=o.indexOf(e);l===-1&&invariant();var u=o.slice(l+1),c=u.reduce(function(y,b){return y[b.descriptor.id]=!0,y},{}),d={inVirtualList:r.descriptor.mode==="virtual",displacedBy:a,effected:c},p=getDisplacementGroups({afterDragging:u,destination:r,displacedBy:a,last:null,viewport:s.frame,forceShouldAnimate:!1}),m={displaced:p,displacedBy:a,at:{type:"REORDER",destination:getHomeLocation(e.descriptor)}};return{impact:m,afterCritical:d}},patchDimensionMap=function(t,e){return{draggables:t.draggables,droppables:patchDroppableMap(t.droppables,e)}},offsetDraggable=function(t){var e=t.draggable,r=t.offset,n=t.initialWindowScroll,s=offset(e.client,r),a=withScroll(s,n),o=_extends({},e,{placeholder:_extends({},e.placeholder,{client:s}),client:s,page:a});return o},getFrame=function(t){var e=t.frame;return e||invariant(),e},adjustAdditionsForScrollChanges=function(t){var e=t.additions,r=t.updatedDroppables,n=t.viewport,s=n.scroll.diff.value;return e.map(function(a){var o=a.descriptor.droppableId,l=r[o],u=getFrame(l),c=u.scroll.diff.value,d=add(s,c),p=offsetDraggable({draggable:a,offset:d,initialWindowScroll:n.scroll.initial});return p})},publishWhileDraggingInVirtual=function(t){var e=t.state,r=t.published,n=r.modified.map(function(A){var I=e.dimensions.droppables[A.droppableId],j=scrollDroppable(I,A.scroll);return j}),s=_extends({},e.dimensions.droppables,{},toDroppableMap(n)),a=toDraggableMap(adjustAdditionsForScrollChanges({additions:r.additions,updatedDroppables:s,viewport:e.viewport})),o=_extends({},e.dimensions.draggables,{},a);r.removals.forEach(function(A){delete o[A]});var l={droppables:s,draggables:o},u=whatIsDraggedOver(e.impact),c=u?l.droppables[u]:null,d=l.draggables[e.critical.draggable.id],p=l.droppables[e.critical.droppable.id],m=getLiftEffect({draggable:d,home:p,draggables:o,viewport:e.viewport}),y=m.impact,b=m.afterCritical,E=c&&c.isCombineEnabled?e.impact:y,T=getDragImpact({pageOffset:e.current.page.offset,draggable:l.draggables[e.critical.draggable.id],draggables:l.draggables,droppables:l.droppables,previousImpact:E,viewport:e.viewport,afterCritical:b}),S=_extends({phase:"DRAGGING"},e,{phase:"DRAGGING",impact:T,onLiftImpact:y,dimensions:l,afterCritical:b,forceShouldAnimate:!1});if(e.phase==="COLLECTING")return S;var P=_extends({phase:"DROP_PENDING"},S,{phase:"DROP_PENDING",reason:e.reason,isWaiting:!1});return P},isSnapping=function t(e){return e.movementMode==="SNAP"},postDroppableChange=function t(e,r,n){var s=patchDimensionMap(e.dimensions,r);return!isSnapping(e)||n?update({state:e,dimensions:s}):refreshSnap({state:e,dimensions:s})};function removeScrollJumpRequest(t){return t.isDragging&&t.movementMode==="SNAP"?_extends({phase:"DRAGGING"},t,{scrollJumpRequest:null}):t}var idle={phase:"IDLE",completed:null,shouldFlush:!1},reducer=function(t,e){if(t===void 0&&(t=idle),e.type==="FLUSH")return _extends({},idle,{shouldFlush:!0});if(e.type==="INITIAL_PUBLISH"){t.phase!=="IDLE"&&invariant();var r=e.payload,n=r.critical,s=r.clientSelection,a=r.viewport,o=r.dimensions,l=r.movementMode,u=o.draggables[n.draggable.id],c=o.droppables[n.droppable.id],d={selection:s,borderBoxCenter:u.client.borderBox.center,offset:origin},p={client:d,page:{selection:add(d.selection,a.scroll.initial),borderBoxCenter:add(d.selection,a.scroll.initial),offset:add(d.selection,a.scroll.diff.value)}},m=toDroppableList(o.droppables).every(function(ze){return!ze.isFixedOnPage}),y=getLiftEffect({draggable:u,home:c,draggables:o.draggables,viewport:a}),b=y.impact,E=y.afterCritical,T={phase:"DRAGGING",isDragging:!0,critical:n,movementMode:l,dimensions:o,initial:p,current:p,isWindowScrollAllowed:m,impact:b,afterCritical:E,onLiftImpact:b,viewport:a,scrollJumpRequest:null,forceShouldAnimate:null};return T}if(e.type==="COLLECTION_STARTING"){if(t.phase==="COLLECTING"||t.phase==="DROP_PENDING")return t;t.phase!=="DRAGGING"&&invariant();var S=_extends({phase:"COLLECTING"},t,{phase:"COLLECTING"});return S}if(e.type==="PUBLISH_WHILE_DRAGGING")return t.phase==="COLLECTING"||t.phase==="DROP_PENDING"||invariant(),publishWhileDraggingInVirtual({state:t,published:e.payload});if(e.type==="MOVE"){if(t.phase==="DROP_PENDING")return t;isMovementAllowed(t)||invariant();var P=e.payload.client;return isEqual(P,t.current.client.selection)?t:update({state:t,clientSelection:P,impact:isSnapping(t)?t.impact:null})}if(e.type==="UPDATE_DROPPABLE_SCROLL"){if(t.phase==="DROP_PENDING"||t.phase==="COLLECTING")return removeScrollJumpRequest(t);isMovementAllowed(t)||invariant();var A=e.payload,I=A.id,j=A.newScroll,K=t.dimensions.droppables[I];if(!K)return t;var W=scrollDroppable(K,j);return postDroppableChange(t,W,!1)}if(e.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(t.phase==="DROP_PENDING")return t;isMovementAllowed(t)||invariant();var H=e.payload,ee=H.id,ue=H.isEnabled,de=t.dimensions.droppables[ee];de||invariant(),de.isEnabled===ue&&invariant();var fe=_extends({},de,{isEnabled:ue});return postDroppableChange(t,fe,!0)}if(e.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(t.phase==="DROP_PENDING")return t;isMovementAllowed(t)||invariant();var ae=e.payload,ce=ae.id,me=ae.isCombineEnabled,te=t.dimensions.droppables[ce];te||invariant(),te.isCombineEnabled===me&&invariant();var le=_extends({},te,{isCombineEnabled:me});return postDroppableChange(t,le,!0)}if(e.type==="MOVE_BY_WINDOW_SCROLL"){if(t.phase==="DROP_PENDING"||t.phase==="DROP_ANIMATING")return t;isMovementAllowed(t)||invariant(),t.isWindowScrollAllowed||invariant();var Z=e.payload.newScroll;if(isEqual(t.viewport.scroll.current,Z))return removeScrollJumpRequest(t);var Y=scrollViewport(t.viewport,Z);return isSnapping(t)?refreshSnap({state:t,viewport:Y}):update({state:t,viewport:Y})}if(e.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!isMovementAllowed(t))return t;var he=e.payload.maxScroll;if(isEqual(he,t.viewport.scroll.max))return t;var oe=_extends({},t.viewport,{scroll:_extends({},t.viewport.scroll,{max:he})});return _extends({phase:"DRAGGING"},t,{viewport:oe})}if(e.type==="MOVE_UP"||e.type==="MOVE_DOWN"||e.type==="MOVE_LEFT"||e.type==="MOVE_RIGHT"){if(t.phase==="COLLECTING"||t.phase==="DROP_PENDING")return t;t.phase!=="DRAGGING"&&invariant();var ye=moveInDirection({state:t,type:e.type});return ye?update({state:t,impact:ye.impact,clientSelection:ye.clientSelection,scrollJumpRequest:ye.scrollJumpRequest}):t}if(e.type==="DROP_PENDING"){var Ee=e.payload.reason;t.phase!=="COLLECTING"&&invariant();var Ae=_extends({phase:"DROP_PENDING"},t,{phase:"DROP_PENDING",isWaiting:!0,reason:Ee});return Ae}if(e.type==="DROP_ANIMATE"){var je=e.payload,Te=je.completed,Ve=je.dropDuration,Pe=je.newHomeClientOffset;t.phase==="DRAGGING"||t.phase==="DROP_PENDING"||invariant();var Ce={phase:"DROP_ANIMATING",completed:Te,dropDuration:Ve,newHomeClientOffset:Pe,dimensions:t.dimensions};return Ce}if(e.type==="DROP_COMPLETE"){var De=e.payload.completed;return{phase:"IDLE",completed:De,shouldFlush:!1}}return t},beforeInitialCapture=function t(e){return{type:"BEFORE_INITIAL_CAPTURE",payload:e}},lift=function t(e){return{type:"LIFT",payload:e}},initialPublish=function t(e){return{type:"INITIAL_PUBLISH",payload:e}},publishWhileDragging=function t(e){return{type:"PUBLISH_WHILE_DRAGGING",payload:e}},collectionStarting=function t(){return{type:"COLLECTION_STARTING",payload:null}},updateDroppableScroll=function t(e){return{type:"UPDATE_DROPPABLE_SCROLL",payload:e}},updateDroppableIsEnabled=function t(e){return{type:"UPDATE_DROPPABLE_IS_ENABLED",payload:e}},updateDroppableIsCombineEnabled=function t(e){return{type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:e}},move=function t(e){return{type:"MOVE",payload:e}},moveByWindowScroll=function t(e){return{type:"MOVE_BY_WINDOW_SCROLL",payload:e}},updateViewportMaxScroll=function t(e){return{type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:e}},moveUp=function t(){return{type:"MOVE_UP",payload:null}},moveDown=function t(){return{type:"MOVE_DOWN",payload:null}},moveRight=function t(){return{type:"MOVE_RIGHT",payload:null}},moveLeft=function t(){return{type:"MOVE_LEFT",payload:null}},flush=function t(){return{type:"FLUSH",payload:null}},animateDrop=function t(e){return{type:"DROP_ANIMATE",payload:e}},completeDrop=function t(e){return{type:"DROP_COMPLETE",payload:e}},drop=function t(e){return{type:"DROP",payload:e}},dropPending=function t(e){return{type:"DROP_PENDING",payload:e}},dropAnimationFinished=function t(){return{type:"DROP_ANIMATION_FINISHED",payload:null}},lift$1=function(t){return function(e){var r=e.getState,n=e.dispatch;return function(s){return function(a){if(a.type!=="LIFT"){s(a);return}var o=a.payload,l=o.id,u=o.clientSelection,c=o.movementMode,d=r();d.phase==="DROP_ANIMATING"&&n(completeDrop({completed:d.completed})),r().phase!=="IDLE"&&invariant(),n(flush()),n(beforeInitialCapture({draggableId:l,movementMode:c}));var p={shouldPublishImmediately:c==="SNAP"},m={draggableId:l,scrollOptions:p},y=t.startPublishing(m),b=y.critical,E=y.dimensions,T=y.viewport;n(initialPublish({critical:b,dimensions:E,clientSelection:u,movementMode:c,viewport:T}))}}}},style=function(t){return function(){return function(e){return function(r){r.type==="INITIAL_PUBLISH"&&t.dragging(),r.type==="DROP_ANIMATE"&&t.dropping(r.payload.completed.result.reason),(r.type==="FLUSH"||r.type==="DROP_COMPLETE")&&t.resting(),e(r)}}}},curves={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},combine={opacity:{drop:0,combining:.7},scale:{drop:.75}},timings={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},outOfTheWayTiming=timings.outOfTheWay+"s "+curves.outOfTheWay,transitions={fluid:"opacity "+outOfTheWayTiming,snap:"transform "+outOfTheWayTiming+", opacity "+outOfTheWayTiming,drop:function t(e){var r=e+"s "+curves.drop;return"transform "+r+", opacity "+r},outOfTheWay:"transform "+outOfTheWayTiming,placeholder:"height "+outOfTheWayTiming+", width "+outOfTheWayTiming+", margin "+outOfTheWayTiming},moveTo=function t(e){return isEqual(e,origin)?null:"translate("+e.x+"px, "+e.y+"px)"},transforms={moveTo,drop:function t(e,r){var n=moveTo(e);return n?r?n+" scale("+combine.scale.drop+")":n:null}},minDropTime=timings.minDropTime,maxDropTime=timings.maxDropTime,dropTimeRange=maxDropTime-minDropTime,maxDropTimeAtDistance=1500,cancelDropModifier=.6,getDropDuration=function(t){var e=t.current,r=t.destination,n=t.reason,s=distance(e,r);if(s<=0)return minDropTime;if(s>=maxDropTimeAtDistance)return maxDropTime;var a=s/maxDropTimeAtDistance,o=minDropTime+dropTimeRange*a,l=n==="CANCEL"?o*cancelDropModifier:o;return Number(l.toFixed(2))},getNewHomeClientOffset=function(t){var e=t.impact,r=t.draggable,n=t.dimensions,s=t.viewport,a=t.afterCritical,o=n.draggables,l=n.droppables,u=whatIsDraggedOver(e),c=u?l[u]:null,d=l[r.descriptor.droppableId],p=getClientBorderBoxCenter({impact:e,draggable:r,draggables:o,afterCritical:a,droppable:c||d,viewport:s}),m=subtract(p,r.client.borderBox.center);return m},getDropImpact=function(t){var e=t.draggables,r=t.reason,n=t.lastImpact,s=t.home,a=t.viewport,o=t.onLiftImpact;if(!n.at||r!=="DROP"){var l=recompute({draggables:e,impact:o,destination:s,viewport:a,forceShouldAnimate:!0});return{impact:l,didDropInsideDroppable:!1}}if(n.at.type==="REORDER")return{impact:n,didDropInsideDroppable:!0};var u=_extends({},n,{displaced:emptyGroups});return{impact:u,didDropInsideDroppable:!0}},drop$1=function(t){var e=t.getState,r=t.dispatch;return function(n){return function(s){if(s.type!=="DROP"){n(s);return}var a=e(),o=s.payload.reason;if(a.phase==="COLLECTING"){r(dropPending({reason:o}));return}if(a.phase!=="IDLE"){var l=a.phase==="DROP_PENDING"&&a.isWaiting;l&&invariant(),a.phase==="DRAGGING"||a.phase==="DROP_PENDING"||invariant();var u=a.critical,c=a.dimensions,d=c.draggables[a.critical.draggable.id],p=getDropImpact({reason:o,lastImpact:a.impact,afterCritical:a.afterCritical,onLiftImpact:a.onLiftImpact,home:a.dimensions.droppables[a.critical.droppable.id],viewport:a.viewport,draggables:a.dimensions.draggables}),m=p.impact,y=p.didDropInsideDroppable,b=y?tryGetDestination(m):null,E=y?tryGetCombine(m):null,T={index:u.draggable.index,droppableId:u.droppable.id},S={draggableId:d.descriptor.id,type:d.descriptor.type,source:T,reason:o,mode:a.movementMode,destination:b,combine:E},P=getNewHomeClientOffset({impact:m,draggable:d,dimensions:c,viewport:a.viewport,afterCritical:a.afterCritical}),A={critical:a.critical,afterCritical:a.afterCritical,result:S,impact:m},I=!isEqual(a.current.client.offset,P)||!!S.combine;if(!I){r(completeDrop({completed:A}));return}var j=getDropDuration({current:a.current.client.offset,destination:P,reason:o}),K={newHomeClientOffset:P,dropDuration:j,completed:A};r(animateDrop(K))}}}},getWindowScroll=function(){return{x:window.pageXOffset,y:window.pageYOffset}};function getWindowScrollBinding(t){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(r){r.target!==window&&r.target!==window.document||t()}}}function getScrollListener(t){var e=t.onWindowScroll;function r(){e(getWindowScroll())}var n=rafSchd(r),s=getWindowScrollBinding(n),a=noop;function o(){return a!==noop}function l(){o()&&invariant(),a=bindEvents(window,[s])}function u(){o()||invariant(),n.cancel(),a(),a=noop}return{start:l,stop:u,isActive:o}}var shouldEnd=function t(e){return e.type==="DROP_COMPLETE"||e.type==="DROP_ANIMATE"||e.type==="FLUSH"},scrollListener=function(t){var e=getScrollListener({onWindowScroll:function(n){t.dispatch(moveByWindowScroll({newScroll:n}))}});return function(r){return function(n){!e.isActive()&&n.type==="INITIAL_PUBLISH"&&e.start(),e.isActive()&&shouldEnd(n)&&e.stop(),r(n)}}},getExpiringAnnounce=function(t){var e=!1,r=!1,n=setTimeout(function(){r=!0}),s=function(o){e||r||(e=!0,t(o),clearTimeout(n))};return s.wasCalled=function(){return e},s},getAsyncMarshal=function(){var t=[],e=function(a){var o=findIndex(t,function(c){return c.timerId===a});o===-1&&invariant();var l=t.splice(o,1),u=l[0];u.callback()},r=function(a){var o=setTimeout(function(){return e(o)}),l={timerId:o,callback:a};t.push(l)},n=function(){if(t.length){var a=[].concat(t);t.length=0,a.forEach(function(o){clearTimeout(o.timerId),o.callback()})}};return{add:r,flush:n}},areLocationsEqual=function t(e,r){return e==null&&r==null?!0:e==null||r==null?!1:e.droppableId===r.droppableId&&e.index===r.index},isCombineEqual=function t(e,r){return e==null&&r==null?!0:e==null||r==null?!1:e.draggableId===r.draggableId&&e.droppableId===r.droppableId},isCriticalEqual=function t(e,r){if(e===r)return!0;var n=e.draggable.id===r.draggable.id&&e.draggable.droppableId===r.draggable.droppableId&&e.draggable.type===r.draggable.type&&e.draggable.index===r.draggable.index,s=e.droppable.id===r.droppable.id&&e.droppable.type===r.droppable.type;return n&&s},withTimings=function t(e,r){r()},getDragStart=function t(e,r){return{draggableId:e.draggable.id,type:e.droppable.type,source:{droppableId:e.droppable.id,index:e.draggable.index},mode:r}},execute=function t(e,r,n,s){if(!e){n(s(r));return}var a=getExpiringAnnounce(n),o={announce:a};e(r,o),a.wasCalled()||n(s(r))},getPublisher=function(t,e){var r=getAsyncMarshal(),n=null,s=function(m,y){n&&invariant(),withTimings("onBeforeCapture",function(){var b=t().onBeforeCapture;if(b){var E={draggableId:m,mode:y};b(E)}})},a=function(m,y){n&&invariant(),withTimings("onBeforeDragStart",function(){var b=t().onBeforeDragStart;b&&b(getDragStart(m,y))})},o=function(m,y){n&&invariant();var b=getDragStart(m,y);n={mode:y,lastCritical:m,lastLocation:b.source,lastCombine:null},r.add(function(){withTimings("onDragStart",function(){return execute(t().onDragStart,b,e,preset.onDragStart)})})},l=function(m,y){var b=tryGetDestination(y),E=tryGetCombine(y);n||invariant();var T=!isCriticalEqual(m,n.lastCritical);T&&(n.lastCritical=m);var S=!areLocationsEqual(n.lastLocation,b);S&&(n.lastLocation=b);var P=!isCombineEqual(n.lastCombine,E);if(P&&(n.lastCombine=E),!(!T&&!S&&!P)){var A=_extends({},getDragStart(m,n.mode),{combine:E,destination:b});r.add(function(){withTimings("onDragUpdate",function(){return execute(t().onDragUpdate,A,e,preset.onDragUpdate)})})}},u=function(){n||invariant(),r.flush()},c=function(m){n||invariant(),n=null,withTimings("onDragEnd",function(){return execute(t().onDragEnd,m,e,preset.onDragEnd)})},d=function(){if(n){var m=_extends({},getDragStart(n.lastCritical,n.mode),{combine:null,destination:null,reason:"CANCEL"});c(m)}};return{beforeCapture:s,beforeStart:a,start:o,update:l,flush:u,drop:c,abort:d}},responders=function(t,e){var r=getPublisher(t,e);return function(n){return function(s){return function(a){if(a.type==="BEFORE_INITIAL_CAPTURE"){r.beforeCapture(a.payload.draggableId,a.payload.movementMode);return}if(a.type==="INITIAL_PUBLISH"){var o=a.payload.critical;r.beforeStart(o,a.payload.movementMode),s(a),r.start(o,a.payload.movementMode);return}if(a.type==="DROP_COMPLETE"){var l=a.payload.completed.result;r.flush(),s(a),r.drop(l);return}if(s(a),a.type==="FLUSH"){r.abort();return}var u=n.getState();u.phase==="DRAGGING"&&r.update(u.critical,u.impact)}}}},dropAnimationFinish=function(t){return function(e){return function(r){if(r.type!=="DROP_ANIMATION_FINISHED"){e(r);return}var n=t.getState();n.phase!=="DROP_ANIMATING"&&invariant(),t.dispatch(completeDrop({completed:n.completed}))}}},dropAnimationFlushOnScroll=function(t){var e=null,r=null;function n(){r&&(cancelAnimationFrame(r),r=null),e&&(e(),e=null)}return function(s){return function(a){if((a.type==="FLUSH"||a.type==="DROP_COMPLETE"||a.type==="DROP_ANIMATION_FINISHED")&&n(),s(a),a.type==="DROP_ANIMATE"){var o={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){var u=t.getState();u.phase==="DROP_ANIMATING"&&t.dispatch(dropAnimationFinished())}};r=requestAnimationFrame(function(){r=null,e=bindEvents(window,[o])})}}}},dimensionMarshalStopper=function(t){return function(){return function(e){return function(r){(r.type==="DROP_COMPLETE"||r.type==="FLUSH"||r.type==="DROP_ANIMATE")&&t.stopPublishing(),e(r)}}}},focus=function(t){var e=!1;return function(){return function(r){return function(n){if(n.type==="INITIAL_PUBLISH"){e=!0,t.tryRecordFocus(n.payload.critical.draggable.id),r(n),t.tryRestoreFocusRecorded();return}if(r(n),!!e){if(n.type==="FLUSH"){e=!1,t.tryRestoreFocusRecorded();return}if(n.type==="DROP_COMPLETE"){e=!1;var s=n.payload.completed.result;s.combine&&t.tryShiftRecord(s.draggableId,s.combine.draggableId),t.tryRestoreFocusRecorded()}}}}}},shouldStop=function t(e){return e.type==="DROP_COMPLETE"||e.type==="DROP_ANIMATE"||e.type==="FLUSH"},autoScroll=function(t){return function(e){return function(r){return function(n){if(shouldStop(n)){t.stop(),r(n);return}if(n.type==="INITIAL_PUBLISH"){r(n);var s=e.getState();s.phase!=="DRAGGING"&&invariant(),t.start(s);return}r(n),t.scroll(e.getState())}}}},pendingDrop=function(t){return function(e){return function(r){if(e(r),r.type==="PUBLISH_WHILE_DRAGGING"){var n=t.getState();n.phase==="DROP_PENDING"&&(n.isWaiting||t.dispatch(drop({reason:n.reason})))}}}},composeEnhancers=compose,createStore=function(t){var e=t.dimensionMarshal,r=t.focusMarshal,n=t.styleMarshal,s=t.getResponders,a=t.announce,o=t.autoScroller;return createStore$1(reducer,composeEnhancers(applyMiddleware(style(n),dimensionMarshalStopper(e),lift$1(e),drop$1,dropAnimationFinish,dropAnimationFlushOnScroll,pendingDrop,autoScroll(o),scrollListener,focus(r),responders(s,a))))},clean$1=function t(){return{additions:{},removals:{},modified:{}}};function createPublisher(t){var e=t.registry,r=t.callbacks,n=clean$1(),s=null,a=function(){s||(r.collectionStarting(),s=requestAnimationFrame(function(){s=null;var d=n,p=d.additions,m=d.removals,y=d.modified,b=Object.keys(p).map(function(S){return e.draggable.getById(S).getDimension(origin)}).sort(function(S,P){return S.descriptor.index-P.descriptor.index}),E=Object.keys(y).map(function(S){var P=e.droppable.getById(S),A=P.callbacks.getScrollWhileDragging();return{droppableId:S,scroll:A}}),T={additions:b,removals:Object.keys(m),modified:E};n=clean$1(),r.publish(T)}))},o=function(d){var p=d.descriptor.id;n.additions[p]=d,n.modified[d.descriptor.droppableId]=!0,n.removals[p]&&delete n.removals[p],a()},l=function(d){var p=d.descriptor;n.removals[p.id]=!0,n.modified[p.droppableId]=!0,n.additions[p.id]&&delete n.additions[p.id],a()},u=function(){s&&(cancelAnimationFrame(s),s=null,n=clean$1())};return{add:o,remove:l,stop:u}}var getMaxScroll=function(t){var e=t.scrollHeight,r=t.scrollWidth,n=t.height,s=t.width,a=subtract({x:r,y:e},{x:s,y:n}),o={x:Math.max(0,a.x),y:Math.max(0,a.y)};return o},getDocumentElement=function(){var t=document.documentElement;return t||invariant(),t},getMaxWindowScroll=function(){var t=getDocumentElement(),e=getMaxScroll({scrollHeight:t.scrollHeight,scrollWidth:t.scrollWidth,width:t.clientWidth,height:t.clientHeight});return e},getViewport=function(){var t=getWindowScroll(),e=getMaxWindowScroll(),r=t.y,n=t.x,s=getDocumentElement(),a=s.clientWidth,o=s.clientHeight,l=n+a,u=r+o,c=getRect({top:r,left:n,right:l,bottom:u}),d={frame:c,scroll:{initial:t,current:t,max:e,diff:{value:origin,displacement:origin}}};return d},getInitialPublish=function(t){var e=t.critical,r=t.scrollOptions,n=t.registry,s=getViewport(),a=s.scroll.current,o=e.droppable,l=n.droppable.getAllByType(o.type).map(function(p){return p.callbacks.getDimensionAndWatchScroll(a,r)}),u=n.draggable.getAllByType(e.draggable.type).map(function(p){return p.getDimension(a)}),c={draggables:toDraggableMap(u),droppables:toDroppableMap(l)},d={dimensions:c,critical:e,viewport:s};return d};function shouldPublishUpdate(t,e,r){if(r.descriptor.id===e.id||r.descriptor.type!==e.type)return!1;var n=t.droppable.getById(r.descriptor.droppableId);return n.descriptor.mode==="virtual"}var createDimensionMarshal=function(t,e){var r=null,n=createPublisher({callbacks:{publish:e.publishWhileDragging,collectionStarting:e.collectionStarting},registry:t}),s=function(y,b){t.droppable.exists(y)||invariant(),r&&e.updateDroppableIsEnabled({id:y,isEnabled:b})},a=function(y,b){r&&(t.droppable.exists(y)||invariant(),e.updateDroppableIsCombineEnabled({id:y,isCombineEnabled:b}))},o=function(y,b){r&&(t.droppable.exists(y)||invariant(),e.updateDroppableScroll({id:y,newScroll:b}))},l=function(y,b){r&&t.droppable.getById(y).callbacks.scroll(b)},u=function(){if(r){n.stop();var y=r.critical.droppable;t.droppable.getAllByType(y.type).forEach(function(b){return b.callbacks.dragStopped()}),r.unsubscribe(),r=null}},c=function(y){r||invariant();var b=r.critical.draggable;y.type==="ADDITION"&&shouldPublishUpdate(t,b,y.value)&&n.add(y.value),y.type==="REMOVAL"&&shouldPublishUpdate(t,b,y.value)&&n.remove(y.value)},d=function(y){r&&invariant();var b=t.draggable.getById(y.draggableId),E=t.droppable.getById(b.descriptor.droppableId),T={draggable:b.descriptor,droppable:E.descriptor},S=t.subscribe(c);return r={critical:T,unsubscribe:S},getInitialPublish({critical:T,registry:t,scrollOptions:y.scrollOptions})},p={updateDroppableIsEnabled:s,updateDroppableIsCombineEnabled:a,scrollDroppable:l,updateDroppableScroll:o,startPublishing:d,stopPublishing:u};return p},canStartDrag=function(t,e){return t.phase==="IDLE"?!0:t.phase!=="DROP_ANIMATING"||t.completed.result.draggableId===e?!1:t.completed.result.reason==="DROP"},scrollWindow=function(t){window.scrollBy(t.x,t.y)},getScrollableDroppables=memoizeOne(function(t){return toDroppableList(t).filter(function(e){return!(!e.isEnabled||!e.frame)})}),getScrollableDroppableOver=function t(e,r){var n=find(getScrollableDroppables(r),function(s){return s.frame||invariant(),isPositionInFrame(s.frame.pageMarginBox)(e)});return n},getBestScrollableDroppable=function(t){var e=t.center,r=t.destination,n=t.droppables;if(r){var s=n[r];return s.frame?s:null}var a=getScrollableDroppableOver(e,n);return a},config={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:function t(e){return Math.pow(e,2)},durationDampening:{stopDampeningAt:1200,accelerateAt:360}},getDistanceThresholds=function(t,e){var r=t[e.size]*config.startFromPercentage,n=t[e.size]*config.maxScrollAtPercentage,s={startScrollingFrom:r,maxScrollValueAt:n};return s},getPercentage=function(t){var e=t.startOfRange,r=t.endOfRange,n=t.current,s=r-e;if(s===0)return 0;var a=n-e,o=a/s;return o},minScroll=1,getValueFromDistance=function(t,e){if(t>e.startScrollingFrom)return 0;if(t<=e.maxScrollValueAt)return config.maxPixelScroll;if(t===e.startScrollingFrom)return minScroll;var r=getPercentage({startOfRange:e.maxScrollValueAt,endOfRange:e.startScrollingFrom,current:t}),n=1-r,s=config.maxPixelScroll*config.ease(n);return Math.ceil(s)},accelerateAt=config.durationDampening.accelerateAt,stopAt=config.durationDampening.stopDampeningAt,dampenValueByTime=function(t,e){var r=e,n=stopAt,s=Date.now(),a=s-r;if(a>=stopAt)return t;if(a<accelerateAt)return minScroll;var o=getPercentage({startOfRange:accelerateAt,endOfRange:n,current:a}),l=t*config.ease(o);return Math.ceil(l)},getValue=function(t){var e=t.distanceToEdge,r=t.thresholds,n=t.dragStartTime,s=t.shouldUseTimeDampening,a=getValueFromDistance(e,r);return a===0?0:s?Math.max(dampenValueByTime(a,n),minScroll):a},getScrollOnAxis=function(t){var e=t.container,r=t.distanceToEdges,n=t.dragStartTime,s=t.axis,a=t.shouldUseTimeDampening,o=getDistanceThresholds(e,s),l=r[s.end]<r[s.start];return l?getValue({distanceToEdge:r[s.end],thresholds:o,dragStartTime:n,shouldUseTimeDampening:a}):-1*getValue({distanceToEdge:r[s.start],thresholds:o,dragStartTime:n,shouldUseTimeDampening:a})},adjustForSizeLimits=function(t){var e=t.container,r=t.subject,n=t.proposedScroll,s=r.height>e.height,a=r.width>e.width;return!a&&!s?n:a&&s?null:{x:a?0:n.x,y:s?0:n.y}},clean$2=apply(function(t){return t===0?0:t}),getScroll=function(t){var e=t.dragStartTime,r=t.container,n=t.subject,s=t.center,a=t.shouldUseTimeDampening,o={top:s.y-r.top,right:r.right-s.x,bottom:r.bottom-s.y,left:s.x-r.left},l=getScrollOnAxis({container:r,distanceToEdges:o,dragStartTime:e,axis:vertical,shouldUseTimeDampening:a}),u=getScrollOnAxis({container:r,distanceToEdges:o,dragStartTime:e,axis:horizontal,shouldUseTimeDampening:a}),c=clean$2({x:u,y:l});if(isEqual(c,origin))return null;var d=adjustForSizeLimits({container:r,subject:n,proposedScroll:c});return d?isEqual(d,origin)?null:d:null},smallestSigned=apply(function(t){return t===0?0:t>0?1:-1}),getOverlap=function(){var t=function(r,n){return r<0?r:r>n?r-n:0};return function(e){var r=e.current,n=e.max,s=e.change,a=add(r,s),o={x:t(a.x,n.x),y:t(a.y,n.y)};return isEqual(o,origin)?null:o}}(),canPartiallyScroll=function t(e){var r=e.max,n=e.current,s=e.change,a={x:Math.max(n.x,r.x),y:Math.max(n.y,r.y)},o=smallestSigned(s),l=getOverlap({max:a,current:n,change:o});return!l||o.x!==0&&l.x===0||o.y!==0&&l.y===0},canScrollWindow=function t(e,r){return canPartiallyScroll({current:e.scroll.current,max:e.scroll.max,change:r})},getWindowOverlap=function t(e,r){if(!canScrollWindow(e,r))return null;var n=e.scroll.max,s=e.scroll.current;return getOverlap({current:s,max:n,change:r})},canScrollDroppable=function t(e,r){var n=e.frame;return n?canPartiallyScroll({current:n.scroll.current,max:n.scroll.max,change:r}):!1},getDroppableOverlap=function t(e,r){var n=e.frame;return!n||!canScrollDroppable(e,r)?null:getOverlap({current:n.scroll.current,max:n.scroll.max,change:r})},getWindowScrollChange=function(t){var e=t.viewport,r=t.subject,n=t.center,s=t.dragStartTime,a=t.shouldUseTimeDampening,o=getScroll({dragStartTime:s,container:e.frame,subject:r,center:n,shouldUseTimeDampening:a});return o&&canScrollWindow(e,o)?o:null},getDroppableScrollChange=function(t){var e=t.droppable,r=t.subject,n=t.center,s=t.dragStartTime,a=t.shouldUseTimeDampening,o=e.frame;if(!o)return null;var l=getScroll({dragStartTime:s,container:o.pageMarginBox,subject:r,center:n,shouldUseTimeDampening:a});return l&&canScrollDroppable(e,l)?l:null},scroll$1=function(t){var e=t.state,r=t.dragStartTime,n=t.shouldUseTimeDampening,s=t.scrollWindow,a=t.scrollDroppable,o=e.current.page.borderBoxCenter,l=e.dimensions.draggables[e.critical.draggable.id],u=l.page.marginBox;if(e.isWindowScrollAllowed){var c=e.viewport,d=getWindowScrollChange({dragStartTime:r,viewport:c,subject:u,center:o,shouldUseTimeDampening:n});if(d){s(d);return}}var p=getBestScrollableDroppable({center:o,destination:whatIsDraggedOver(e.impact),droppables:e.dimensions.droppables});if(p){var m=getDroppableScrollChange({dragStartTime:r,droppable:p,subject:u,center:o,shouldUseTimeDampening:n});m&&a(p.descriptor.id,m)}},createFluidScroller=function(t){var e=t.scrollWindow,r=t.scrollDroppable,n=rafSchd(e),s=rafSchd(r),a=null,o=function(d){a||invariant();var p=a,m=p.shouldUseTimeDampening,y=p.dragStartTime;scroll$1({state:d,scrollWindow:n,scrollDroppable:s,dragStartTime:y,shouldUseTimeDampening:m})},l=function(d){a&&invariant();var p=Date.now(),m=!1,y=function(){m=!0};scroll$1({state:d,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:y,scrollDroppable:y}),a={dragStartTime:p,shouldUseTimeDampening:m},m&&o(d)},u=function(){a&&(n.cancel(),s.cancel(),a=null)};return{start:l,stop:u,scroll:o}},createJumpScroller=function(t){var e=t.move,r=t.scrollDroppable,n=t.scrollWindow,s=function(c,d){var p=add(c.current.client.selection,d);e({client:p})},a=function(c,d){if(!canScrollDroppable(c,d))return d;var p=getDroppableOverlap(c,d);if(!p)return r(c.descriptor.id,d),null;var m=subtract(d,p);r(c.descriptor.id,m);var y=subtract(d,m);return y},o=function(c,d,p){if(!c||!canScrollWindow(d,p))return p;var m=getWindowOverlap(d,p);if(!m)return n(p),null;var y=subtract(p,m);n(y);var b=subtract(p,y);return b},l=function(c){var d=c.scrollJumpRequest;if(d){var p=whatIsDraggedOver(c.impact);p||invariant();var m=a(c.dimensions.droppables[p],d);if(m){var y=c.viewport,b=o(c.isWindowScrollAllowed,y,m);b&&s(c,b)}}};return l},createAutoScroller=function(t){var e=t.scrollDroppable,r=t.scrollWindow,n=t.move,s=createFluidScroller({scrollWindow:r,scrollDroppable:e}),a=createJumpScroller({move:n,scrollWindow:r,scrollDroppable:e}),o=function(c){if(c.phase==="DRAGGING"){if(c.movementMode==="FLUID"){s.scroll(c);return}c.scrollJumpRequest&&a(c)}},l={scroll:o,start:s.start,stop:s.stop};return l},prefix$1="data-rbd",dragHandle=function(){var t=prefix$1+"-drag-handle";return{base:t,draggableId:t+"-draggable-id",contextId:t+"-context-id"}}(),draggable=function(){var t=prefix$1+"-draggable";return{base:t,contextId:t+"-context-id",id:t+"-id"}}(),droppable=function(){var t=prefix$1+"-droppable";return{base:t,contextId:t+"-context-id",id:t+"-id"}}(),scrollContainer={contextId:prefix$1+"-scroll-container-context-id"},makeGetSelector=function t(e){return function(r){return"["+r+'="'+e+'"]'}},getStyles=function t(e,r){return e.map(function(n){var s=n.styles[r];return s?n.selector+" { "+s+" }":""}).join(" ")},noPointerEvents="pointer-events: none;",getStyles$1=function(t){var e=makeGetSelector(t),r=function(){var l=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:e(dragHandle.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:l,dragging:noPointerEvents,dropAnimating:l}}}(),n=function(){var l=`
      transition: `+transitions.outOfTheWay+`;
    `;return{selector:e(draggable.contextId),styles:{dragging:l,dropAnimating:l,userCancel:l}}}(),s={selector:e(droppable.contextId),styles:{always:"overflow-anchor: none;"}},a={selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}},o=[n,r,s,a];return{always:getStyles(o,"always"),resting:getStyles(o,"resting"),dragging:getStyles(o,"dragging"),dropAnimating:getStyles(o,"dropAnimating"),userCancel:getStyles(o,"userCancel")}},useIsomorphicLayoutEffect=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?reactExports.useLayoutEffect:reactExports.useEffect,getHead=function t(){var e=document.querySelector("head");return e||invariant(),e},createStyleEl=function t(e){var r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.type="text/css",r};function useStyleMarshal(t,e){var r=useMemo(function(){return getStyles$1(t)},[t]),n=reactExports.useRef(null),s=reactExports.useRef(null),a=useCallback(memoizeOne(function(p){var m=s.current;m||invariant(),m.textContent=p}),[]),o=useCallback(function(p){var m=n.current;m||invariant(),m.textContent=p},[]);useIsomorphicLayoutEffect(function(){!n.current&&!s.current||invariant();var p=createStyleEl(e),m=createStyleEl(e);return n.current=p,s.current=m,p.setAttribute(prefix$1+"-always",t),m.setAttribute(prefix$1+"-dynamic",t),getHead().appendChild(p),getHead().appendChild(m),o(r.always),a(r.resting),function(){var y=function(E){var T=E.current;T||invariant(),getHead().removeChild(T),E.current=null};y(n),y(s)}},[e,o,a,r.always,r.resting,t]);var l=useCallback(function(){return a(r.dragging)},[a,r.dragging]),u=useCallback(function(p){if(p==="DROP"){a(r.dropAnimating);return}a(r.userCancel)},[a,r.dropAnimating,r.userCancel]),c=useCallback(function(){s.current&&a(r.resting)},[a,r.resting]),d=useMemo(function(){return{dragging:l,dropping:u,resting:c}},[l,u,c]);return d}var getWindowFromEl=function(t){return t&&t.ownerDocument?t.ownerDocument.defaultView:window};function isHtmlElement(t){return t instanceof getWindowFromEl(t).HTMLElement}function findDragHandle(t,e){var r="["+dragHandle.contextId+'="'+t+'"]',n=toArray(document.querySelectorAll(r));if(!n.length)return null;var s=find(n,function(a){return a.getAttribute(dragHandle.draggableId)===e});return!s||!isHtmlElement(s)?null:s}function useFocusMarshal(t){var e=reactExports.useRef({}),r=reactExports.useRef(null),n=reactExports.useRef(null),s=reactExports.useRef(!1),a=useCallback(function(m,y){var b={id:m,focus:y};return e.current[m]=b,function(){var T=e.current,S=T[m];S!==b&&delete T[m]}},[]),o=useCallback(function(m){var y=findDragHandle(t,m);y&&y!==document.activeElement&&y.focus()},[t]),l=useCallback(function(m,y){r.current===m&&(r.current=y)},[]),u=useCallback(function(){n.current||s.current&&(n.current=requestAnimationFrame(function(){n.current=null;var m=r.current;m&&o(m)}))},[o]),c=useCallback(function(m){r.current=null;var y=document.activeElement;y&&y.getAttribute(dragHandle.draggableId)===m&&(r.current=m)},[]);useIsomorphicLayoutEffect(function(){return s.current=!0,function(){s.current=!1;var m=n.current;m&&cancelAnimationFrame(m)}},[]);var d=useMemo(function(){return{register:a,tryRecordFocus:c,tryRestoreFocusRecorded:u,tryShiftRecord:l}},[a,c,u,l]);return d}function createRegistry(){var t={draggables:{},droppables:{}},e=[];function r(p){return e.push(p),function(){var y=e.indexOf(p);y!==-1&&e.splice(y,1)}}function n(p){e.length&&e.forEach(function(m){return m(p)})}function s(p){return t.draggables[p]||null}function a(p){var m=s(p);return m||invariant(),m}var o={register:function(m){t.draggables[m.descriptor.id]=m,n({type:"ADDITION",value:m})},update:function(m,y){var b=t.draggables[y.descriptor.id];b&&b.uniqueId===m.uniqueId&&(delete t.draggables[y.descriptor.id],t.draggables[m.descriptor.id]=m)},unregister:function(m){var y=m.descriptor.id,b=s(y);b&&m.uniqueId===b.uniqueId&&(delete t.draggables[y],n({type:"REMOVAL",value:m}))},getById:a,findById:s,exists:function(m){return!!s(m)},getAllByType:function(m){return values(t.draggables).filter(function(y){return y.descriptor.type===m})}};function l(p){return t.droppables[p]||null}function u(p){var m=l(p);return m||invariant(),m}var c={register:function(m){t.droppables[m.descriptor.id]=m},unregister:function(m){var y=l(m.descriptor.id);y&&m.uniqueId===y.uniqueId&&delete t.droppables[m.descriptor.id]},getById:u,findById:l,exists:function(m){return!!l(m)},getAllByType:function(m){return values(t.droppables).filter(function(y){return y.descriptor.type===m})}};function d(){t.draggables={},t.droppables={},e.length=0}return{draggable:o,droppable:c,subscribe:r,clean:d}}function useRegistry(){var t=useMemo(createRegistry,[]);return reactExports.useEffect(function(){return function(){requestAnimationFrame(t.clean)}},[t]),t}var StoreContext=React.createContext(null),getBodyElement=function(){var t=document.body;return t||invariant(),t},visuallyHidden={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},getId=function t(e){return"rbd-announcement-"+e};function useAnnouncer(t){var e=useMemo(function(){return getId(t)},[t]),r=reactExports.useRef(null);reactExports.useEffect(function(){var a=document.createElement("div");return r.current=a,a.id=e,a.setAttribute("aria-live","assertive"),a.setAttribute("aria-atomic","true"),_extends(a.style,visuallyHidden),getBodyElement().appendChild(a),function(){setTimeout(function(){var u=getBodyElement();u.contains(a)&&u.removeChild(a),a===r.current&&(r.current=null)})}},[e]);var n=useCallback(function(s){var a=r.current;if(a){a.textContent=s;return}},[]);return n}var count=0,defaults={separator:"::"};function useUniqueId(t,e){return e===void 0&&(e=defaults),useMemo(function(){return""+t+e.separator+count++},[e.separator,t])}function getElementId(t){var e=t.contextId,r=t.uniqueId;return"rbd-hidden-text-"+e+"-"+r}function useHiddenTextElement(t){var e=t.contextId,r=t.text,n=useUniqueId("hidden-text",{separator:"-"}),s=useMemo(function(){return getElementId({contextId:e,uniqueId:n})},[n,e]);return reactExports.useEffect(function(){var o=document.createElement("div");return o.id=s,o.textContent=r,o.style.display="none",getBodyElement().appendChild(o),function(){var u=getBodyElement();u.contains(o)&&u.removeChild(o)}},[s,r]),s}var AppContext=React.createContext(null);function usePrevious(t){var e=reactExports.useRef(t);return reactExports.useEffect(function(){e.current=t}),e}function create(){var t=null;function e(){return!!t}function r(o){return o===t}function n(o){t&&invariant();var l={abandon:o};return t=l,l}function s(){t||invariant(),t=null}function a(){t&&(t.abandon(),s())}return{isClaimed:e,isActive:r,claim:n,release:s,tryAbandon:a}}var tab=9,enter=13,escape$1=27,space=32,pageUp=33,pageDown=34,end=35,home=36,arrowLeft=37,arrowUp=38,arrowRight=39,arrowDown=40,_preventedKeys,preventedKeys=(_preventedKeys={},_preventedKeys[enter]=!0,_preventedKeys[tab]=!0,_preventedKeys),preventStandardKeyEvents=function(t){preventedKeys[t.keyCode]&&t.preventDefault()},supportedEventName=function(){var t="visibilitychange";if(typeof document>"u")return t;var e=[t,"ms"+t,"webkit"+t,"moz"+t,"o"+t],r=find(e,function(n){return"on"+n in document});return r||t}(),primaryButton=0,sloppyClickThreshold=5;function isSloppyClickThresholdExceeded(t,e){return Math.abs(e.x-t.x)>=sloppyClickThreshold||Math.abs(e.y-t.y)>=sloppyClickThreshold}var idle$1={type:"IDLE"};function getCaptureBindings(t){var e=t.cancel,r=t.completed,n=t.getPhase,s=t.setPhase;return[{eventName:"mousemove",fn:function(o){var l=o.button,u=o.clientX,c=o.clientY;if(l===primaryButton){var d={x:u,y:c},p=n();if(p.type==="DRAGGING"){o.preventDefault(),p.actions.move(d);return}p.type!=="PENDING"&&invariant();var m=p.point;if(isSloppyClickThresholdExceeded(m,d)){o.preventDefault();var y=p.actions.fluidLift(d);s({type:"DRAGGING",actions:y})}}}},{eventName:"mouseup",fn:function(o){var l=n();if(l.type!=="DRAGGING"){e();return}o.preventDefault(),l.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"mousedown",fn:function(o){n().type==="DRAGGING"&&o.preventDefault(),e()}},{eventName:"keydown",fn:function(o){var l=n();if(l.type==="PENDING"){e();return}if(o.keyCode===escape$1){o.preventDefault(),e();return}preventStandardKeyEvents(o)}},{eventName:"resize",fn:e},{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(){n().type==="PENDING"&&e()}},{eventName:"webkitmouseforcedown",fn:function(o){var l=n();if(l.type==="IDLE"&&invariant(),l.actions.shouldRespectForcePress()){e();return}o.preventDefault()}},{eventName:supportedEventName,fn:e}]}function useMouseSensor(t){var e=reactExports.useRef(idle$1),r=reactExports.useRef(noop),n=useMemo(function(){return{eventName:"mousedown",fn:function(p){if(!p.defaultPrevented&&p.button===primaryButton&&!(p.ctrlKey||p.metaKey||p.shiftKey||p.altKey)){var m=t.findClosestDraggableId(p);if(m){var y=t.tryGetLock(m,o,{sourceEvent:p});if(y){p.preventDefault();var b={x:p.clientX,y:p.clientY};r.current(),c(y,b)}}}}}},[t]),s=useMemo(function(){return{eventName:"webkitmouseforcewillbegin",fn:function(p){if(!p.defaultPrevented){var m=t.findClosestDraggableId(p);if(m){var y=t.findOptionsForDraggable(m);y&&(y.shouldRespectForcePress||t.canGetLock(m)&&p.preventDefault())}}}}},[t]),a=useCallback(function(){var p={passive:!1,capture:!0};r.current=bindEvents(window,[s,n],p)},[s,n]),o=useCallback(function(){var d=e.current;d.type!=="IDLE"&&(e.current=idle$1,r.current(),a())},[a]),l=useCallback(function(){var d=e.current;o(),d.type==="DRAGGING"&&d.actions.cancel({shouldBlockNextClick:!0}),d.type==="PENDING"&&d.actions.abort()},[o]),u=useCallback(function(){var p={capture:!0,passive:!1},m=getCaptureBindings({cancel:l,completed:o,getPhase:function(){return e.current},setPhase:function(b){e.current=b}});r.current=bindEvents(window,m,p)},[l,o]),c=useCallback(function(p,m){e.current.type!=="IDLE"&&invariant(),e.current={type:"PENDING",point:m,actions:p},u()},[u]);useIsomorphicLayoutEffect(function(){return a(),function(){r.current()}},[a])}var _scrollJumpKeys;function noop$1(){}var scrollJumpKeys=(_scrollJumpKeys={},_scrollJumpKeys[pageDown]=!0,_scrollJumpKeys[pageUp]=!0,_scrollJumpKeys[home]=!0,_scrollJumpKeys[end]=!0,_scrollJumpKeys);function getDraggingBindings(t,e){function r(){e(),t.cancel()}function n(){e(),t.drop()}return[{eventName:"keydown",fn:function(a){if(a.keyCode===escape$1){a.preventDefault(),r();return}if(a.keyCode===space){a.preventDefault(),n();return}if(a.keyCode===arrowDown){a.preventDefault(),t.moveDown();return}if(a.keyCode===arrowUp){a.preventDefault(),t.moveUp();return}if(a.keyCode===arrowRight){a.preventDefault(),t.moveRight();return}if(a.keyCode===arrowLeft){a.preventDefault(),t.moveLeft();return}if(scrollJumpKeys[a.keyCode]){a.preventDefault();return}preventStandardKeyEvents(a)}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:supportedEventName,fn:r}]}function useKeyboardSensor(t){var e=reactExports.useRef(noop$1),r=useMemo(function(){return{eventName:"keydown",fn:function(a){if(a.defaultPrevented||a.keyCode!==space)return;var o=t.findClosestDraggableId(a);if(!o)return;var l=t.tryGetLock(o,d,{sourceEvent:a});if(!l)return;a.preventDefault();var u=!0,c=l.snapLift();e.current();function d(){u||invariant(),u=!1,e.current(),n()}e.current=bindEvents(window,getDraggingBindings(c,d),{capture:!0,passive:!1})}}},[t]),n=useCallback(function(){var a={passive:!1,capture:!0};e.current=bindEvents(window,[r],a)},[r]);useIsomorphicLayoutEffect(function(){return n(),function(){e.current()}},[n])}var idle$2={type:"IDLE"},timeForLongPress=120,forcePressThreshold=.15;function getWindowBindings(t){var e=t.cancel,r=t.getPhase;return[{eventName:"orientationchange",fn:e},{eventName:"resize",fn:e},{eventName:"contextmenu",fn:function(s){s.preventDefault()}},{eventName:"keydown",fn:function(s){if(r().type!=="DRAGGING"){e();return}s.keyCode===escape$1&&s.preventDefault(),e()}},{eventName:supportedEventName,fn:e}]}function getHandleBindings(t){var e=t.cancel,r=t.completed,n=t.getPhase;return[{eventName:"touchmove",options:{capture:!1},fn:function(a){var o=n();if(o.type!=="DRAGGING"){e();return}o.hasMoved=!0;var l=a.touches[0],u=l.clientX,c=l.clientY,d={x:u,y:c};a.preventDefault(),o.actions.move(d)}},{eventName:"touchend",fn:function(a){var o=n();if(o.type!=="DRAGGING"){e();return}a.preventDefault(),o.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"touchcancel",fn:function(a){if(n().type!=="DRAGGING"){e();return}a.preventDefault(),e()}},{eventName:"touchforcechange",fn:function(a){var o=n();o.type==="IDLE"&&invariant();var l=a.touches[0];if(l){var u=l.force>=forcePressThreshold;if(u){var c=o.actions.shouldRespectForcePress();if(o.type==="PENDING"){c&&e();return}if(c){if(o.hasMoved){a.preventDefault();return}e();return}a.preventDefault()}}}},{eventName:supportedEventName,fn:e}]}function useTouchSensor(t){var e=reactExports.useRef(idle$2),r=reactExports.useRef(noop),n=useCallback(function(){return e.current},[]),s=useCallback(function(y){e.current=y},[]),a=useMemo(function(){return{eventName:"touchstart",fn:function(y){if(!y.defaultPrevented){var b=t.findClosestDraggableId(y);if(b){var E=t.tryGetLock(b,l,{sourceEvent:y});if(E){var T=y.touches[0],S=T.clientX,P=T.clientY,A={x:S,y:P};r.current(),p(E,A)}}}}}},[t]),o=useCallback(function(){var y={capture:!0,passive:!1};r.current=bindEvents(window,[a],y)},[a]),l=useCallback(function(){var m=e.current;m.type!=="IDLE"&&(m.type==="PENDING"&&clearTimeout(m.longPressTimerId),s(idle$2),r.current(),o())},[o,s]),u=useCallback(function(){var m=e.current;l(),m.type==="DRAGGING"&&m.actions.cancel({shouldBlockNextClick:!0}),m.type==="PENDING"&&m.actions.abort()},[l]),c=useCallback(function(){var y={capture:!0,passive:!1},b={cancel:u,completed:l,getPhase:n},E=bindEvents(window,getHandleBindings(b),y),T=bindEvents(window,getWindowBindings(b),y);r.current=function(){E(),T()}},[u,n,l]),d=useCallback(function(){var y=n();y.type!=="PENDING"&&invariant();var b=y.actions.fluidLift(y.point);s({type:"DRAGGING",actions:b,hasMoved:!1})},[n,s]),p=useCallback(function(y,b){n().type!=="IDLE"&&invariant();var E=setTimeout(d,timeForLongPress);s({type:"PENDING",point:b,actions:y,longPressTimerId:E}),c()},[c,n,s,d]);useIsomorphicLayoutEffect(function(){return o(),function(){r.current();var b=n();b.type==="PENDING"&&(clearTimeout(b.longPressTimerId),s(idle$2))}},[n,o,s]),useIsomorphicLayoutEffect(function(){var y=bindEvents(window,[{eventName:"touchmove",fn:function(){},options:{capture:!1,passive:!1}}]);return y},[])}var interactiveTagNames={input:!0,button:!0,textarea:!0,select:!0,option:!0,optgroup:!0,video:!0,audio:!0};function isAnInteractiveElement(t,e){if(e==null)return!1;var r=!!interactiveTagNames[e.tagName.toLowerCase()];if(r)return!0;var n=e.getAttribute("contenteditable");return n==="true"||n===""?!0:e===t?!1:isAnInteractiveElement(t,e.parentElement)}function isEventInInteractiveElement(t,e){var r=e.target;return isHtmlElement(r)?isAnInteractiveElement(t,r):!1}var getBorderBoxCenterPosition=function(t){return getRect(t.getBoundingClientRect()).center};function isElement(t){return t instanceof getWindowFromEl(t).Element}var supportedMatchesName=function(){var t="matches";if(typeof document>"u")return t;var e=[t,"msMatchesSelector","webkitMatchesSelector"],r=find(e,function(n){return n in Element.prototype});return r||t}();function closestPonyfill(t,e){return t==null?null:t[supportedMatchesName](e)?t:closestPonyfill(t.parentElement,e)}function closest$1(t,e){return t.closest?t.closest(e):closestPonyfill(t,e)}function getSelector(t){return"["+dragHandle.contextId+'="'+t+'"]'}function findClosestDragHandleFromEvent(t,e){var r=e.target;if(!isElement(r))return null;var n=getSelector(t),s=closest$1(r,n);return!s||!isHtmlElement(s)?null:s}function tryGetClosestDraggableIdFromEvent(t,e){var r=findClosestDragHandleFromEvent(t,e);return r?r.getAttribute(dragHandle.draggableId):null}function findDraggable(t,e){var r="["+draggable.contextId+'="'+t+'"]',n=toArray(document.querySelectorAll(r)),s=find(n,function(a){return a.getAttribute(draggable.id)===e});return!s||!isHtmlElement(s)?null:s}function preventDefault(t){t.preventDefault()}function _isActive(t){var e=t.expected,r=t.phase,n=t.isLockActive;return t.shouldWarn,!(!n()||e!==r)}function canStart(t){var e=t.lockAPI,r=t.store,n=t.registry,s=t.draggableId;if(e.isClaimed())return!1;var a=n.draggable.findById(s);return!(!a||!a.options.isEnabled||!canStartDrag(r.getState(),s))}function tryStart(t){var e=t.lockAPI,r=t.contextId,n=t.store,s=t.registry,a=t.draggableId,o=t.forceSensorStop,l=t.sourceEvent,u=canStart({lockAPI:e,store:n,registry:s,draggableId:a});if(!u)return null;var c=s.draggable.getById(a),d=findDraggable(r,c.descriptor.id);if(!d||l&&!c.options.canDragInteractiveElements&&isEventInInteractiveElement(d,l))return null;var p=e.claim(o||noop),m="PRE_DRAG";function y(){return c.options.shouldRespectForcePress}function b(){return e.isActive(p)}function E(K,W){_isActive({expected:K,phase:m,isLockActive:b,shouldWarn:!0})&&n.dispatch(W())}var T=E.bind(null,"DRAGGING");function S(K){function W(){e.release(),m="COMPLETED"}m!=="PRE_DRAG"&&(W(),m!=="PRE_DRAG"&&invariant()),n.dispatch(lift(K.liftActionArgs)),m="DRAGGING";function H(ee,ue){if(ue===void 0&&(ue={shouldBlockNextClick:!1}),K.cleanup(),ue.shouldBlockNextClick){var de=bindEvents(window,[{eventName:"click",fn:preventDefault,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(de)}W(),n.dispatch(drop({reason:ee}))}return _extends({isActive:function(){return _isActive({expected:"DRAGGING",phase:m,isLockActive:b,shouldWarn:!1})},shouldRespectForcePress:y,drop:function(ue){return H("DROP",ue)},cancel:function(ue){return H("CANCEL",ue)}},K.actions)}function P(K){var W=rafSchd(function(ee){T(function(){return move({client:ee})})}),H=S({liftActionArgs:{id:a,clientSelection:K,movementMode:"FLUID"},cleanup:function(){return W.cancel()},actions:{move:W}});return _extends({},H,{move:W})}function A(){var K={moveUp:function(){return T(moveUp)},moveRight:function(){return T(moveRight)},moveDown:function(){return T(moveDown)},moveLeft:function(){return T(moveLeft)}};return S({liftActionArgs:{id:a,clientSelection:getBorderBoxCenterPosition(d),movementMode:"SNAP"},cleanup:noop,actions:K})}function I(){var K=_isActive({expected:"PRE_DRAG",phase:m,isLockActive:b,shouldWarn:!0});K&&e.release()}var j={isActive:function(){return _isActive({expected:"PRE_DRAG",phase:m,isLockActive:b,shouldWarn:!1})},shouldRespectForcePress:y,fluidLift:P,snapLift:A,abort:I};return j}var defaultSensors=[useMouseSensor,useKeyboardSensor,useTouchSensor];function useSensorMarshal(t){var e=t.contextId,r=t.store,n=t.registry,s=t.customSensors,a=t.enableDefaultSensors,o=[].concat(a?defaultSensors:[],s||[]),l=reactExports.useState(function(){return create()})[0],u=useCallback(function(P,A){P.isDragging&&!A.isDragging&&l.tryAbandon()},[l]);useIsomorphicLayoutEffect(function(){var P=r.getState(),A=r.subscribe(function(){var I=r.getState();u(P,I),P=I});return A},[l,r,u]),useIsomorphicLayoutEffect(function(){return l.tryAbandon},[l.tryAbandon]);for(var c=useCallback(function(S){return canStart({lockAPI:l,registry:n,store:r,draggableId:S})},[l,n,r]),d=useCallback(function(S,P,A){return tryStart({lockAPI:l,registry:n,contextId:e,store:r,draggableId:S,forceSensorStop:P,sourceEvent:A&&A.sourceEvent?A.sourceEvent:null})},[e,l,n,r]),p=useCallback(function(S){return tryGetClosestDraggableIdFromEvent(e,S)},[e]),m=useCallback(function(S){var P=n.draggable.findById(S);return P?P.options:null},[n.draggable]),y=useCallback(function(){l.isClaimed()&&(l.tryAbandon(),r.getState().phase!=="IDLE"&&r.dispatch(flush()))},[l,r]),b=useCallback(l.isClaimed,[l]),E=useMemo(function(){return{canGetLock:c,tryGetLock:d,findClosestDraggableId:p,findOptionsForDraggable:m,tryReleaseLock:y,isLockClaimed:b}},[c,d,p,m,y,b]),T=0;T<o.length;T++)o[T](E)}var createResponders=function t(e){return{onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDragUpdate:e.onDragUpdate}};function getStore(t){return t.current||invariant(),t.current}function App$1(t){var e=t.contextId,r=t.setCallbacks,n=t.sensors,s=t.nonce,a=t.dragHandleUsageInstructions,o=reactExports.useRef(null),l=usePrevious(t),u=useCallback(function(){return createResponders(l.current)},[l]),c=useAnnouncer(e),d=useHiddenTextElement({contextId:e,text:a}),p=useStyleMarshal(e,s),m=useCallback(function(ee){getStore(o).dispatch(ee)},[]),y=useMemo(function(){return bindActionCreators$1({publishWhileDragging,updateDroppableScroll,updateDroppableIsEnabled,updateDroppableIsCombineEnabled,collectionStarting},m)},[m]),b=useRegistry(),E=useMemo(function(){return createDimensionMarshal(b,y)},[b,y]),T=useMemo(function(){return createAutoScroller(_extends({scrollWindow,scrollDroppable:E.scrollDroppable},bindActionCreators$1({move},m)))},[E.scrollDroppable,m]),S=useFocusMarshal(e),P=useMemo(function(){return createStore({announce:c,autoScroller:T,dimensionMarshal:E,focusMarshal:S,getResponders:u,styleMarshal:p})},[c,T,E,S,u,p]);o.current=P;var A=useCallback(function(){var ee=getStore(o),ue=ee.getState();ue.phase!=="IDLE"&&ee.dispatch(flush())},[]),I=useCallback(function(){var ee=getStore(o).getState();return ee.isDragging||ee.phase==="DROP_ANIMATING"},[]),j=useMemo(function(){return{isDragging:I,tryAbort:A}},[I,A]);r(j);var K=useCallback(function(ee){return canStartDrag(getStore(o).getState(),ee)},[]),W=useCallback(function(){return isMovementAllowed(getStore(o).getState())},[]),H=useMemo(function(){return{marshal:E,focus:S,contextId:e,canLift:K,isMovementAllowed:W,dragHandleUsageInstructionsId:d,registry:b}},[e,E,d,S,K,W,b]);return useSensorMarshal({contextId:e,store:P,registry:b,customSensors:n,enableDefaultSensors:t.enableDefaultSensors!==!1}),reactExports.useEffect(function(){return A},[A]),React.createElement(AppContext.Provider,{value:H},React.createElement(Provider,{context:StoreContext,store:P},t.children))}var count$1=0;function useInstanceCount(){return useMemo(function(){return""+count$1++},[])}function DragDropContext(t){var e=useInstanceCount(),r=t.dragHandleUsageInstructions||preset.dragHandleUsageInstructions;return React.createElement(ErrorBoundary,null,function(n){return React.createElement(App$1,{nonce:t.nonce,contextId:e,setCallbacks:n,dragHandleUsageInstructions:r,enableDefaultSensors:t.enableDefaultSensors,sensors:t.sensors,onBeforeCapture:t.onBeforeCapture,onBeforeDragStart:t.onBeforeDragStart,onDragStart:t.onDragStart,onDragUpdate:t.onDragUpdate,onDragEnd:t.onDragEnd},t.children)})}var isEqual$1=function t(e){return function(r){return e===r}},isScroll=isEqual$1("scroll"),isAuto=isEqual$1("auto"),isEither=function t(e,r){return r(e.overflowX)||r(e.overflowY)},isElementScrollable=function t(e){var r=window.getComputedStyle(e),n={overflowX:r.overflowX,overflowY:r.overflowY};return isEither(n,isScroll)||isEither(n,isAuto)},isBodyScrollable=function t(){return!1},getClosestScrollable=function t(e){return e==null?null:e===document.body?isBodyScrollable()?e:null:e===document.documentElement?null:isElementScrollable(e)?e:t(e.parentElement)},getScroll$1=function(t){return{x:t.scrollLeft,y:t.scrollTop}},getIsFixed=function t(e){if(!e)return!1;var r=window.getComputedStyle(e);return r.position==="fixed"?!0:t(e.parentElement)},getEnv=function(t){var e=getClosestScrollable(t),r=getIsFixed(t);return{closestScrollable:e,isFixedOnPage:r}},getDroppableDimension=function(t){var e=t.descriptor,r=t.isEnabled,n=t.isCombineEnabled,s=t.isFixedOnPage,a=t.direction,o=t.client,l=t.page,u=t.closest,c=function(){if(!u)return null;var y=u.scrollSize,b=u.client,E=getMaxScroll({scrollHeight:y.scrollHeight,scrollWidth:y.scrollWidth,height:b.paddingBox.height,width:b.paddingBox.width});return{pageMarginBox:u.page.marginBox,frameClient:b,scrollSize:y,shouldClipSubject:u.shouldClipSubject,scroll:{initial:u.scroll,current:u.scroll,max:E,diff:{value:origin,displacement:origin}}}}(),d=a==="vertical"?vertical:horizontal,p=getSubject({page:l,withPlaceholder:null,axis:d,frame:c}),m={descriptor:e,isCombineEnabled:n,isFixedOnPage:s,axis:d,isEnabled:r,client:o,page:l,frame:c,subject:p};return m},getClient=function t(e,r){var n=getBox(e);if(!r||e!==r)return n;var s=n.paddingBox.top-r.scrollTop,a=n.paddingBox.left-r.scrollLeft,o=s+r.scrollHeight,l=a+r.scrollWidth,u={top:s,right:l,bottom:o,left:a},c=expand(u,n.border),d=createBox({borderBox:c,margin:n.margin,border:n.border,padding:n.padding});return d},getDimension=function(t){var e=t.ref,r=t.descriptor,n=t.env,s=t.windowScroll,a=t.direction,o=t.isDropDisabled,l=t.isCombineEnabled,u=t.shouldClipSubject,c=n.closestScrollable,d=getClient(e,c),p=withScroll(d,s),m=function(){if(!c)return null;var b=getBox(c),E={scrollHeight:c.scrollHeight,scrollWidth:c.scrollWidth};return{client:b,page:withScroll(b,s),scroll:getScroll$1(c),scrollSize:E,shouldClipSubject:u}}(),y=getDroppableDimension({descriptor:r,isEnabled:!o,isCombineEnabled:l,isFixedOnPage:n.isFixedOnPage,direction:a,client:d,page:p,closest:m});return y},immediate={passive:!1},delayed={passive:!0},getListenerOptions=function(t){return t.shouldPublishImmediately?immediate:delayed};function useRequiredContext(t){var e=reactExports.useContext(t);return e||invariant(),e}var getClosestScrollableFromDrag=function t(e){return e&&e.env.closestScrollable||null};function useDroppablePublisher(t){var e=reactExports.useRef(null),r=useRequiredContext(AppContext),n=useUniqueId("droppable"),s=r.registry,a=r.marshal,o=usePrevious(t),l=useMemo(function(){return{id:t.droppableId,type:t.type,mode:t.mode}},[t.droppableId,t.mode,t.type]),u=reactExports.useRef(l),c=useMemo(function(){return memoizeOne(function(I,j){e.current||invariant();var K={x:I,y:j};a.updateDroppableScroll(l.id,K)})},[l.id,a]),d=useCallback(function(){var I=e.current;return!I||!I.env.closestScrollable?origin:getScroll$1(I.env.closestScrollable)},[]),p=useCallback(function(){var I=d();c(I.x,I.y)},[d,c]),m=useMemo(function(){return rafSchd(p)},[p]),y=useCallback(function(){var I=e.current,j=getClosestScrollableFromDrag(I);I&&j||invariant();var K=I.scrollOptions;if(K.shouldPublishImmediately){p();return}m()},[m,p]),b=useCallback(function(I,j){e.current&&invariant();var K=o.current,W=K.getDroppableRef();W||invariant();var H=getEnv(W),ee={ref:W,descriptor:l,env:H,scrollOptions:j};e.current=ee;var ue=getDimension({ref:W,descriptor:l,env:H,windowScroll:I,direction:K.direction,isDropDisabled:K.isDropDisabled,isCombineEnabled:K.isCombineEnabled,shouldClipSubject:!K.ignoreContainerClipping}),de=H.closestScrollable;return de&&(de.setAttribute(scrollContainer.contextId,r.contextId),de.addEventListener("scroll",y,getListenerOptions(ee.scrollOptions))),ue},[r.contextId,l,y,o]),E=useCallback(function(){var I=e.current,j=getClosestScrollableFromDrag(I);return I&&j||invariant(),getScroll$1(j)},[]),T=useCallback(function(){var I=e.current;I||invariant();var j=getClosestScrollableFromDrag(I);e.current=null,j&&(m.cancel(),j.removeAttribute(scrollContainer.contextId),j.removeEventListener("scroll",y,getListenerOptions(I.scrollOptions)))},[y,m]),S=useCallback(function(I){var j=e.current;j||invariant();var K=getClosestScrollableFromDrag(j);K||invariant(),K.scrollTop+=I.y,K.scrollLeft+=I.x},[]),P=useMemo(function(){return{getDimensionAndWatchScroll:b,getScrollWhileDragging:E,dragStopped:T,scroll:S}},[T,b,E,S]),A=useMemo(function(){return{uniqueId:n,descriptor:l,callbacks:P}},[P,l,n]);useIsomorphicLayoutEffect(function(){return u.current=A.descriptor,s.droppable.register(A),function(){e.current&&T(),s.droppable.unregister(A)}},[P,l,T,A,a,s.droppable]),useIsomorphicLayoutEffect(function(){e.current&&a.updateDroppableIsEnabled(u.current.id,!t.isDropDisabled)},[t.isDropDisabled,a]),useIsomorphicLayoutEffect(function(){e.current&&a.updateDroppableIsCombineEnabled(u.current.id,t.isCombineEnabled)},[t.isCombineEnabled,a])}function noop$2(){}var empty={width:0,height:0,margin:noSpacing},getSize=function t(e){var r=e.isAnimatingOpenOnMount,n=e.placeholder,s=e.animate;return r||s==="close"?empty:{height:n.client.borderBox.height,width:n.client.borderBox.width,margin:n.client.margin}},getStyle=function t(e){var r=e.isAnimatingOpenOnMount,n=e.placeholder,s=e.animate,a=getSize({isAnimatingOpenOnMount:r,placeholder:n,animate:s});return{display:n.display,boxSizing:"border-box",width:a.width,height:a.height,marginTop:a.margin.top,marginRight:a.margin.right,marginBottom:a.margin.bottom,marginLeft:a.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:s!=="none"?transitions.placeholder:null}};function Placeholder(t){var e=reactExports.useRef(null),r=useCallback(function(){e.current&&(clearTimeout(e.current),e.current=null)},[]),n=t.animate,s=t.onTransitionEnd,a=t.onClose,o=t.contextId,l=reactExports.useState(t.animate==="open"),u=l[0],c=l[1];reactExports.useEffect(function(){return u?n!=="open"?(r(),c(!1),noop$2):e.current?noop$2:(e.current=setTimeout(function(){e.current=null,c(!1)}),r):noop$2},[n,u,r]);var d=useCallback(function(m){m.propertyName==="height"&&(s(),n==="close"&&a())},[n,a,s]),p=getStyle({isAnimatingOpenOnMount:u,animate:t.animate,placeholder:t.placeholder});return React.createElement(t.placeholder.tagName,{style:p,"data-rbd-placeholder-context-id":o,onTransitionEnd:d,ref:t.innerRef})}var Placeholder$1=React.memo(Placeholder),DroppableContext=React.createContext(null),AnimateInOut=function(t){_inheritsLoose(e,t);function e(){for(var n,s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return n=t.call.apply(t,[this].concat(a))||this,n.state={isVisible:!!n.props.on,data:n.props.on,animate:n.props.shouldAnimate&&n.props.on?"open":"none"},n.onClose=function(){n.state.animate==="close"&&n.setState({isVisible:!1})},n}e.getDerivedStateFromProps=function(s,a){return s.shouldAnimate?s.on?{isVisible:!0,data:s.on,animate:"open"}:a.isVisible?{isVisible:!0,data:a.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!s.on,data:s.on,animate:"none"}};var r=e.prototype;return r.render=function(){if(!this.state.isVisible)return null;var s={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(s)},e}(React.PureComponent),zIndexOptions={dragging:5e3,dropAnimating:4500},getDraggingTransition=function t(e,r){return r?transitions.drop(r.duration):e?transitions.snap:transitions.fluid},getDraggingOpacity=function t(e,r){return e?r?combine.opacity.drop:combine.opacity.combining:null},getShouldDraggingAnimate=function t(e){return e.forceShouldAnimate!=null?e.forceShouldAnimate:e.mode==="SNAP"};function getDraggingStyle(t){var e=t.dimension,r=e.client,n=t.offset,s=t.combineWith,a=t.dropping,o=!!s,l=getShouldDraggingAnimate(t),u=!!a,c=u?transforms.drop(n,o):transforms.moveTo(n),d={position:"fixed",top:r.marginBox.top,left:r.marginBox.left,boxSizing:"border-box",width:r.borderBox.width,height:r.borderBox.height,transition:getDraggingTransition(l,a),transform:c,opacity:getDraggingOpacity(o,u),zIndex:u?zIndexOptions.dropAnimating:zIndexOptions.dragging,pointerEvents:"none"};return d}function getSecondaryStyle(t){return{transform:transforms.moveTo(t.offset),transition:t.shouldAnimateDisplacement?null:"none"}}function getStyle$1(t){return t.type==="DRAGGING"?getDraggingStyle(t):getSecondaryStyle(t)}function getDimension$1(t,e,r){r===void 0&&(r=origin);var n=window.getComputedStyle(e),s=e.getBoundingClientRect(),a=calculateBox(s,n),o=withScroll(a,r),l={client:a,tagName:e.tagName.toLowerCase(),display:n.display},u={x:a.marginBox.width,y:a.marginBox.height},c={descriptor:t,placeholder:l,displaceBy:u,client:a,page:o};return c}function useDraggablePublisher(t){var e=useUniqueId("draggable"),r=t.descriptor,n=t.registry,s=t.getDraggableRef,a=t.canDragInteractiveElements,o=t.shouldRespectForcePress,l=t.isEnabled,u=useMemo(function(){return{canDragInteractiveElements:a,shouldRespectForcePress:o,isEnabled:l}},[a,l,o]),c=useCallback(function(y){var b=s();return b||invariant(),getDimension$1(r,b,y)},[r,s]),d=useMemo(function(){return{uniqueId:e,descriptor:r,options:u,getDimension:c}},[r,c,u,e]),p=reactExports.useRef(d),m=reactExports.useRef(!0);useIsomorphicLayoutEffect(function(){return n.draggable.register(p.current),function(){return n.draggable.unregister(p.current)}},[n.draggable]),useIsomorphicLayoutEffect(function(){if(m.current){m.current=!1;return}var y=p.current;p.current=d,n.draggable.update(d,y)},[d,n.draggable])}function preventHtml5Dnd(t){t.preventDefault()}function Draggable(t){var e=reactExports.useRef(null),r=useCallback(function(ee){e.current=ee},[]),n=useCallback(function(){return e.current},[]),s=useRequiredContext(AppContext),a=s.contextId,o=s.dragHandleUsageInstructionsId,l=s.registry,u=useRequiredContext(DroppableContext),c=u.type,d=u.droppableId,p=useMemo(function(){return{id:t.draggableId,index:t.index,type:c,droppableId:d}},[t.draggableId,t.index,c,d]),m=t.children,y=t.draggableId,b=t.isEnabled,E=t.shouldRespectForcePress,T=t.canDragInteractiveElements,S=t.isClone,P=t.mapped,A=t.dropAnimationFinished;if(!S){var I=useMemo(function(){return{descriptor:p,registry:l,getDraggableRef:n,canDragInteractiveElements:T,shouldRespectForcePress:E,isEnabled:b}},[p,l,n,T,E,b]);useDraggablePublisher(I)}var j=useMemo(function(){return b?{tabIndex:0,role:"button","aria-describedby":o,"data-rbd-drag-handle-draggable-id":y,"data-rbd-drag-handle-context-id":a,draggable:!1,onDragStart:preventHtml5Dnd}:null},[a,o,y,b]),K=useCallback(function(ee){P.type==="DRAGGING"&&P.dropping&&ee.propertyName==="transform"&&A()},[A,P]),W=useMemo(function(){var ee=getStyle$1(P),ue=P.type==="DRAGGING"&&P.dropping?K:null,de={innerRef:r,draggableProps:{"data-rbd-draggable-context-id":a,"data-rbd-draggable-id":y,style:ee,onTransitionEnd:ue},dragHandleProps:j};return de},[a,j,y,P,K,r]),H=useMemo(function(){return{draggableId:p.id,type:p.type,source:{index:p.index,droppableId:p.droppableId}}},[p.droppableId,p.id,p.index,p.type]);return m(W,P.snapshot,H)}var isStrictEqual=function(t,e){return t===e},whatIsDraggedOverFromResult=function(t){var e=t.combine,r=t.destination;return r?r.droppableId:e?e.droppableId:null},getCombineWithFromResult=function t(e){return e.combine?e.combine.draggableId:null},getCombineWithFromImpact=function t(e){return e.at&&e.at.type==="COMBINE"?e.at.combine.draggableId:null};function getDraggableSelector(){var t=memoizeOne(function(s,a){return{x:s,y:a}}),e=memoizeOne(function(s,a,o,l,u){return{isDragging:!0,isClone:a,isDropAnimating:!!u,dropAnimation:u,mode:s,draggingOver:o,combineWith:l,combineTargetFor:null}}),r=memoizeOne(function(s,a,o,l,u,c,d){return{mapped:{type:"DRAGGING",dropping:null,draggingOver:u,combineWith:c,mode:a,offset:s,dimension:o,forceShouldAnimate:d,snapshot:e(a,l,u,c,null)}}}),n=function(a,o){if(a.isDragging){if(a.critical.draggable.id!==o.draggableId)return null;var l=a.current.client.offset,u=a.dimensions.draggables[o.draggableId],c=whatIsDraggedOver(a.impact),d=getCombineWithFromImpact(a.impact),p=a.forceShouldAnimate;return r(t(l.x,l.y),a.movementMode,u,o.isClone,c,d,p)}if(a.phase==="DROP_ANIMATING"){var m=a.completed;if(m.result.draggableId!==o.draggableId)return null;var y=o.isClone,b=a.dimensions.draggables[o.draggableId],E=m.result,T=E.mode,S=whatIsDraggedOverFromResult(E),P=getCombineWithFromResult(E),A=a.dropDuration,I={duration:A,curve:curves.drop,moveTo:a.newHomeClientOffset,opacity:P?combine.opacity.drop:null,scale:P?combine.scale.drop:null};return{mapped:{type:"DRAGGING",offset:a.newHomeClientOffset,dimension:b,dropping:I,draggingOver:S,combineWith:P,mode:T,forceShouldAnimate:null,snapshot:e(T,y,S,P,I)}}}return null};return n}function getSecondarySnapshot(t){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:t,combineWith:null}}var atRest={mapped:{type:"SECONDARY",offset:origin,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:getSecondarySnapshot(null)}};function getSecondarySelector(){var t=memoizeOne(function(o,l){return{x:o,y:l}}),e=memoizeOne(getSecondarySnapshot),r=memoizeOne(function(o,l,u){return l===void 0&&(l=null),{mapped:{type:"SECONDARY",offset:o,combineTargetFor:l,shouldAnimateDisplacement:u,snapshot:e(l)}}}),n=function(l){return l?r(origin,l,!0):null},s=function(l,u,c,d){var p=c.displaced.visible[l],m=!!(d.inVirtualList&&d.effected[l]),y=tryGetCombine(c),b=y&&y.draggableId===l?u:null;if(!p){if(!m)return n(b);if(c.displaced.invisible[l])return null;var E=negate(d.displacedBy.point),T=t(E.x,E.y);return r(T,b,!0)}if(m)return n(b);var S=c.displacedBy.point,P=t(S.x,S.y);return r(P,b,p.shouldAnimate)},a=function(l,u){if(l.isDragging)return l.critical.draggable.id===u.draggableId?null:s(u.draggableId,l.critical.draggable.id,l.impact,l.afterCritical);if(l.phase==="DROP_ANIMATING"){var c=l.completed;return c.result.draggableId===u.draggableId?null:s(u.draggableId,c.result.draggableId,c.impact,c.afterCritical)}return null};return a}var makeMapStateToProps=function t(){var e=getDraggableSelector(),r=getSecondarySelector(),n=function(a,o){return e(a,o)||r(a,o)||atRest};return n},mapDispatchToProps={dropAnimationFinished},ConnectedDraggable=connect(makeMapStateToProps,mapDispatchToProps,null,{context:StoreContext,pure:!0,areStatePropsEqual:isStrictEqual})(Draggable);function PrivateDraggable(t){var e=useRequiredContext(DroppableContext),r=e.isUsingCloneFor;return r===t.draggableId&&!t.isClone?null:React.createElement(ConnectedDraggable,t)}function PublicDraggable(t){var e=typeof t.isDragDisabled=="boolean"?!t.isDragDisabled:!0,r=!!t.disableInteractiveElementBlocking,n=!!t.shouldRespectForcePress;return React.createElement(PrivateDraggable,_extends({},t,{isClone:!1,isEnabled:e,canDragInteractiveElements:r,shouldRespectForcePress:n}))}function Droppable(t){var e=reactExports.useContext(AppContext);e||invariant();var r=e.contextId,n=e.isMovementAllowed,s=reactExports.useRef(null),a=reactExports.useRef(null),o=t.children,l=t.droppableId,u=t.type,c=t.mode,d=t.direction,p=t.ignoreContainerClipping,m=t.isDropDisabled,y=t.isCombineEnabled,b=t.snapshot,E=t.useClone,T=t.updateViewportMaxScroll,S=t.getContainerForClone,P=useCallback(function(){return s.current},[]),A=useCallback(function(de){s.current=de},[]);useCallback(function(){return a.current},[]);var I=useCallback(function(de){a.current=de},[]),j=useCallback(function(){n()&&T({maxScroll:getMaxWindowScroll()})},[n,T]);useDroppablePublisher({droppableId:l,type:u,mode:c,direction:d,isDropDisabled:m,isCombineEnabled:y,ignoreContainerClipping:p,getDroppableRef:P});var K=React.createElement(AnimateInOut,{on:t.placeholder,shouldAnimate:t.shouldAnimatePlaceholder},function(de){var fe=de.onClose,ae=de.data,ce=de.animate;return React.createElement(Placeholder$1,{placeholder:ae,onClose:fe,innerRef:I,animate:ce,contextId:r,onTransitionEnd:j})}),W=useMemo(function(){return{innerRef:A,placeholder:K,droppableProps:{"data-rbd-droppable-id":l,"data-rbd-droppable-context-id":r}}},[r,l,K,A]),H=E?E.dragging.draggableId:null,ee=useMemo(function(){return{droppableId:l,type:u,isUsingCloneFor:H}},[l,H,u]);function ue(){if(!E)return null;var de=E.dragging,fe=E.render,ae=React.createElement(PrivateDraggable,{draggableId:de.draggableId,index:de.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},function(ce,me){return fe(ce,me,de)});return ReactDOM.createPortal(ae,S())}return React.createElement(DroppableContext.Provider,{value:ee},o(W,b),ue())}var isMatchingType=function t(e,r){return e===r.droppable.type},getDraggable=function t(e,r){return r.draggables[e.draggable.id]},makeMapStateToProps$1=function t(){var e={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},r=_extends({},e,{shouldAnimatePlaceholder:!1}),n=memoizeOne(function(o){return{draggableId:o.id,type:o.type,source:{index:o.index,droppableId:o.droppableId}}}),s=memoizeOne(function(o,l,u,c,d,p){var m=d.descriptor.id,y=d.descriptor.droppableId===o;if(y){var b=p?{render:p,dragging:n(d.descriptor)}:null,E={isDraggingOver:u,draggingOverWith:u?m:null,draggingFromThisWith:m,isUsingPlaceholder:!0};return{placeholder:d.placeholder,shouldAnimatePlaceholder:!1,snapshot:E,useClone:b}}if(!l)return r;if(!c)return e;var T={isDraggingOver:u,draggingOverWith:m,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:d.placeholder,shouldAnimatePlaceholder:!0,snapshot:T,useClone:null}}),a=function(l,u){var c=u.droppableId,d=u.type,p=!u.isDropDisabled,m=u.renderClone;if(l.isDragging){var y=l.critical;if(!isMatchingType(d,y))return r;var b=getDraggable(y,l.dimensions),E=whatIsDraggedOver(l.impact)===c;return s(c,p,E,E,b,m)}if(l.phase==="DROP_ANIMATING"){var T=l.completed;if(!isMatchingType(d,T.critical))return r;var S=getDraggable(T.critical,l.dimensions);return s(c,p,whatIsDraggedOverFromResult(T.result)===c,whatIsDraggedOver(T.impact)===c,S,m)}if(l.phase==="IDLE"&&l.completed&&!l.shouldFlush){var P=l.completed;if(!isMatchingType(d,P.critical))return r;var A=whatIsDraggedOver(P.impact)===c,I=!!(P.impact.at&&P.impact.at.type==="COMBINE"),j=P.critical.droppable.id===c;return A?I?e:r:j?e:r}return r};return a},mapDispatchToProps$1={updateViewportMaxScroll};function getBody(){return document.body||invariant(),document.body}var defaultProps={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:getBody},ConnectedDroppable=connect(makeMapStateToProps$1,mapDispatchToProps$1,null,{context:StoreContext,pure:!0,areStatePropsEqual:isStrictEqual})(Droppable);ConnectedDroppable.defaultProps=defaultProps;const GoalDetails=({goal:t,onBack:e,onTaskClick:r,isCreating:n=!1,isEditing:s=n,onEditToggle:a})=>{const[o,l]=reactExports.useState([]),[u,c]=reactExports.useState(!1),[d,p]=reactExports.useState(null),[m,y]=reactExports.useState(""),[b,E]=reactExports.useState(""),[T,S]=reactExports.useState(null),[P,A]=reactExports.useState(!1),[I,j]=reactExports.useState(!1),[K,W]=reactExports.useState({...t,templateType:t.templateType||"學習目標",subject:t.subject||SUBJECTS.CUSTOM}),{deleteGoal:H,addStep:ee,deleteStep:ue,addTask:de,deleteTask:fe,updateGoal:ae,getActiveSteps:ce,updateTask:me,reorderTasks:te}=useGoalStore(),[le,Z]=reactExports.useState([]);reactExports.useEffect(()=>{const Ce=ce(t.id);Z(Ce),l(Ce.filter(De=>{const ze=De.tasks.length,Et=De.tasks.filter(Ze=>Ze.status==="done").length;return ze>0&&Et<ze}).map(De=>De.id))},[t.id,t.steps]),reactExports.useEffect(()=>{W({...t,templateType:t.templateType||"學習目標",subject:t.subject||SUBJECTS.CUSTOM})},[t]),reactExports.useEffect(()=>{l(s?le.map(Ce=>Ce.id):le.filter(Ce=>{const De=Ce.tasks.length,ze=Ce.tasks.filter(Et=>Et.status==="done").length;return De>0&&ze<De}).map(Ce=>Ce.id))},[s,le]);const Y=Ce=>{const De=Ce.target;De.closest(".dropdown-option")||!De.closest(".type-select")&&!De.closest(".subject-select")&&(j(!1),A(!1))};reactExports.useEffect(()=>(document.addEventListener("mousedown",Y),()=>document.removeEventListener("mousedown",Y)),[]);const he=()=>{j(!I),A(!1)},oe=()=>{A(!P),j(!1)},ye=Ce=>{l(De=>De.includes(Ce)?De.filter(ze=>ze!==Ce):[...De,Ce])},Ee=Ce=>{const De=le.find(Ze=>Ze.id===Ce.id);if(!De)return 0;const ze=De.tasks.length,Et=De.tasks.filter(Ze=>Ze.status==="done").length;return ze===0?0:Math.round(Et/ze*100)},Ae=(Ce,De,ze,Et)=>{p({type:Ce,goalId:De,stepId:ze,taskId:Et}),c(!0)},je=()=>{d&&(d.type==="goal"?H(d.goalId):d.type==="step"&&d.stepId?ue(d.goalId,d.stepId):d.type==="task"&&d.stepId&&d.taskId&&fe(d.goalId,d.stepId,d.taskId),c(!1),p(null))},Te=()=>{m.trim()&&(ee(t.id,{id:"",title:m,tasks:[]}),y(""),S(null))},Ve=Ce=>{b.trim()&&(de(t.id,Ce,{id:"",title:b,status:"todo"}),E(""),S(null))};reactExports.useEffect(()=>{s&&W({...t,templateType:t.templateType||"學習目標",subject:t.subject||SUBJECTS.CUSTOM})},[s,t]);const Pe=Ce=>{if(!Ce.destination)return;const{source:De,destination:ze}=Ce,Et=De.droppableId,Ze=ze.droppableId;if(Et===Ze)te(t.id,Et,De.index,ze.index);else{const Ue=le.find(or=>or.id===Et),qt=le.find(or=>or.id===Ze);if(Ue&&qt){const or=Ue.tasks[De.index];fe(t.id,Et,or.id),de(t.id,Ze,{...or,order:ze.index})}}};return jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col",children:[u&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full mx-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium mb-4",children:"確認刪除"}),jsxRuntimeExports.jsxs("p",{className:"text-gray-600 mb-6",children:["確定要刪除這個",(d==null?void 0:d.type)==="step"?"步驟":(d==null?void 0:d.type)==="task"?"任務":"目標","嗎？此操作無法復原。"]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>{c(!1),p(null)},className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-md transition-colors",children:"取消"}),jsxRuntimeExports.jsx("button",{onClick:je,className:"px-4 py-2 bg-red-500 text-white hover:bg-red-600 rounded-md transition-colors",children:"刪除"})]})]})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[jsxRuntimeExports.jsxs("div",{className:"mb-6 rounded-lg shadow p-4 border-l-4",style:{borderLeftColor:subjects.getSubjectStyle(t.subject||"").accent,background:`linear-gradient(to right, ${subjects.getSubjectStyle(t.subject||"").accent}10, ${subjects.getSubjectStyle(t.subject||"").accent}10)`},children:[jsxRuntimeExports.jsx("div",{className:"flex gap-2 mb-3",children:s?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("button",{onClick:he,className:`inline-flex items-center gap-2 px-2.5 py-0.5 rounded-md text-sm font-medium ${K.templateType==="學習目標"?"bg-purple-100 text-purple-800":K.templateType==="個人成長"?"bg-blue-100 text-blue-800":K.templateType==="專案計畫"?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:[K.templateType==="學習目標"?jsxRuntimeExports.jsx(Brain,{className:"h-4 w-4"}):K.templateType==="個人成長"?jsxRuntimeExports.jsx(Target,{className:"h-4 w-4"}):K.templateType==="專案計畫"?jsxRuntimeExports.jsx(Sparkles,{className:"h-4 w-4"}):jsxRuntimeExports.jsx(PartyPopper,{className:"h-4 w-4"}),K.templateType||"選擇類型",jsxRuntimeExports.jsx(ChevronDown,{className:"h-4 w-4"})]}),I&&jsxRuntimeExports.jsx("div",{className:"absolute z-10 mt-1 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5",children:jsxRuntimeExports.jsx("div",{className:"py-1",children:["學習目標","個人成長","專案計畫","其他"].map(Ce=>jsxRuntimeExports.jsx("button",{onClick:()=>{const De={...K,templateType:Ce};W(De),ae(De),j(!1)},className:`w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dropdown-option ${Ce==="學習目標"?"text-purple-800":Ce==="個人成長"?"text-blue-800":Ce==="專案計畫"?"text-green-800":"text-orange-800"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[Ce==="學習目標"?jsxRuntimeExports.jsx(Brain,{className:"h-4 w-4"}):Ce==="個人成長"?jsxRuntimeExports.jsx(Target,{className:"h-4 w-4"}):Ce==="專案計畫"?jsxRuntimeExports.jsx(Sparkles,{className:"h-4 w-4"}):jsxRuntimeExports.jsx(PartyPopper,{className:"h-4 w-4"}),Ce]})},Ce))})})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("button",{onClick:oe,className:`inline-flex items-center px-2.5 py-0.5 rounded-md text-sm font-medium ${subjects.getSubjectStyle(K.subject||"").bg} ${subjects.getSubjectStyle(K.subject||"").text}`,children:[K.subject||"未分類",jsxRuntimeExports.jsx(ChevronDown,{className:"h-4 w-4 ml-1"})]}),P&&jsxRuntimeExports.jsx("div",{className:"absolute z-10 mt-1 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5",children:jsxRuntimeExports.jsx("div",{className:"py-1",children:Object.entries(SUBJECTS).map(([Ce,De])=>jsxRuntimeExports.jsx("button",{onClick:()=>{const ze={...K,subject:De};W(ze),ae(ze),A(!1)},className:`w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dropdown-option ${subjects.getSubjectStyle(De).text}`,children:De},Ce))})})]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("span",{className:`inline-flex items-center gap-2 px-2.5 py-0.5 rounded-md text-sm font-medium ${t.templateType==="學習目標"?"bg-purple-100 text-purple-800":t.templateType==="個人成長"?"bg-blue-100 text-blue-800":t.templateType==="專案計畫"?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:[t.templateType==="學習目標"?jsxRuntimeExports.jsx(Brain,{className:"h-4 w-4"}):t.templateType==="個人成長"?jsxRuntimeExports.jsx(Target,{className:"h-4 w-4"}):t.templateType==="專案計畫"?jsxRuntimeExports.jsx(Sparkles,{className:"h-4 w-4"}):jsxRuntimeExports.jsx(PartyPopper,{className:"h-4 w-4"}),t.templateType]}),jsxRuntimeExports.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-md text-sm font-medium ${subjects.getSubjectStyle(t.subject||"").bg} ${subjects.getSubjectStyle(t.subject||"").text}`,children:t.subject||"未分類"})]})}),s?jsxRuntimeExports.jsx("textarea",{value:K.description,onChange:Ce=>{const De={...K,description:Ce.target.value};W(De),ae(De)},className:"w-full p-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"描述你的目標..."}):jsxRuntimeExports.jsx("p",{className:"text-gray-700",children:t.description})]}),jsxRuntimeExports.jsx(DragDropContext,{onDragEnd:Pe,children:jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[le.map(Ce=>jsxRuntimeExports.jsxs("div",{className:"border rounded-lg overflow-hidden bg-white/80 backdrop-blur-sm shadow-sm group",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-100/60 backdrop-blur-sm group",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>ye(Ce.id),className:"flex items-center flex-1",children:[o.includes(Ce.id)?jsxRuntimeExports.jsx(ChevronDown,{className:"h-5 w-5 text-gray-500"}):jsxRuntimeExports.jsx(ChevronRight,{className:"h-5 w-5 text-gray-500"}),jsxRuntimeExports.jsx("span",{className:"ml-2 font-medium",children:Ce.title})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsxs("span",{className:"text-sm text-gray-500 mr-2",children:[Ee(Ce),"%"]}),jsxRuntimeExports.jsx("div",{className:"w-16 h-2 bg-gray-200 rounded-full",children:jsxRuntimeExports.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${Ee(Ce)}%`}})})]}),s&&jsxRuntimeExports.jsx("button",{onClick:()=>Ae("step",t.id,Ce.id),className:"text-red-500 hover:bg-red-50 rounded-full p-1","aria-label":"刪除步驟",children:jsxRuntimeExports.jsx(Trash2,{size:16})})]})]}),o.includes(Ce.id)&&jsxRuntimeExports.jsxs("div",{className:"p-3 space-y-2 bg-gray-50/20 backdrop-blur-sm",children:[jsxRuntimeExports.jsx(ConnectedDroppable,{droppableId:Ce.id,children:De=>jsxRuntimeExports.jsxs("div",{...De.droppableProps,ref:De.innerRef,className:"min-h-[50px]",children:[Ce.tasks.sort((ze,Et)=>(ze.order||0)-(Et.order||0)).map((ze,Et)=>jsxRuntimeExports.jsx(PublicDraggable,{draggableId:ze.id,index:Et,isDragDisabled:!s,children:(Ze,Ue)=>jsxRuntimeExports.jsxs(React.Fragment,{children:[jsxRuntimeExports.jsx("div",{ref:Ze.innerRef,...Ze.draggableProps,className:`flex items-center justify-between group ${Ue.isDragging?"opacity-100 shadow-lg":""}`,children:jsxRuntimeExports.jsxs("div",{className:`flex items-center justify-between flex-1 p-2 rounded hover:bg-gray-100 transition-colors ${ze.status==="done"?"bg-green-50":ze.status==="in_progress"?"bg-gradient-to-r from-pink-100 via-purple-100 to-indigo-100":""}`,children:[jsxRuntimeExports.jsxs("button",{onClick:()=>r(ze.id),className:"flex items-center flex-1",children:[ze.status==="done"?jsxRuntimeExports.jsx(CircleCheck,{className:"h-5 w-5 text-green-500 mr-2"}):ze.status==="in_progress"?jsxRuntimeExports.jsx(CircleAlert,{className:"h-5 w-5 text-purple-500 mr-2"}):jsxRuntimeExports.jsx(CircleAlert,{className:"h-5 w-5 text-gray-400 mr-2"}),jsxRuntimeExports.jsx("span",{className:`${ze.status==="done"?"text-gray-400":ze.status==="in_progress"?"text-purple-700 font-medium":""}`,children:ze.title})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-2",children:s&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("button",{onClick:()=>Ae("task",t.id,Ce.id,ze.id),className:"text-red-500 hover:bg-red-50 rounded-full p-1","aria-label":"刪除任務",children:jsxRuntimeExports.jsx(Trash2,{size:16})}),jsxRuntimeExports.jsx("button",{onClick:()=>{S(Ce.id),E("")},className:"text-blue-500 hover:bg-blue-50 rounded-full p-1","aria-label":"新增任務",children:jsxRuntimeExports.jsx(Plus,{size:16})}),jsxRuntimeExports.jsx("div",{...Ze.dragHandleProps,children:jsxRuntimeExports.jsx("button",{className:"text-gray-400 hover:text-gray-600 cursor-grab active:cursor-grabbing","aria-label":"拖曳排序",children:jsxRuntimeExports.jsx(GripVertical,{size:16})})})]})})]})}),T===Ce.id&&Et===Ce.tasks.length-1&&jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 p-2 border rounded-md bg-gray-50 ml-8",children:[jsxRuntimeExports.jsx(CircleAlert,{className:"h-5 w-5 text-gray-400"}),jsxRuntimeExports.jsx("input",{type:"text",value:b,onChange:qt=>E(qt.target.value),placeholder:"輸入任務名稱...",className:"flex-1 bg-transparent border-none focus:outline-none",autoFocus:!0,onKeyPress:qt=>{qt.key==="Enter"&&Ve(Ce.id)}}),jsxRuntimeExports.jsx("button",{onClick:()=>Ve(Ce.id),className:"p-1 text-blue-500 hover:bg-blue-50 rounded-full","aria-label":"確認新增",children:jsxRuntimeExports.jsx(CircleCheck,{size:20})}),jsxRuntimeExports.jsx("button",{onClick:()=>S(null),className:"p-1 text-gray-500 hover:bg-gray-50 rounded-full","aria-label":"取消",children:jsxRuntimeExports.jsx(X,{size:20})})]})]})},ze.id)),De.placeholder]})}),Ce.tasks.length===0&&!T&&s&&jsxRuntimeExports.jsxs("button",{onClick:()=>{S(Ce.id),E("")},className:"w-full flex items-center justify-center gap-2 p-2 text-gray-500 hover:text-blue-500 hover:bg-blue-50 rounded-md transition-colors",children:[jsxRuntimeExports.jsx(Plus,{size:16}),jsxRuntimeExports.jsx("span",{children:"新增任務"})]})]})]},Ce.id)),T==="new"?jsxRuntimeExports.jsx("div",{className:"border rounded-lg overflow-hidden bg-white/80 backdrop-blur-sm shadow-sm",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50/80 backdrop-blur-sm",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center flex-1",children:[jsxRuntimeExports.jsx(ChevronRight,{className:"h-5 w-5 text-gray-500"}),jsxRuntimeExports.jsx("input",{type:"text",value:m,onChange:Ce=>y(Ce.target.value),placeholder:"輸入步驟名稱...",className:"ml-2 font-medium bg-transparent border-none focus:outline-none",autoFocus:!0,onKeyPress:Ce=>{Ce.key==="Enter"&&Te()}})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:Te,className:"p-1 text-blue-500 hover:bg-blue-50 rounded-full","aria-label":"確認新增",children:jsxRuntimeExports.jsx(CircleCheck,{size:20})}),jsxRuntimeExports.jsx("button",{onClick:()=>S(null),className:"p-1 text-gray-500 hover:bg-gray-50 rounded-full","aria-label":"取消",children:jsxRuntimeExports.jsx(X,{size:20})})]})]})}):s&&jsxRuntimeExports.jsxs("button",{onClick:()=>{S("new"),y("")},className:"w-full flex items-center justify-center gap-2 p-3 text-gray-500 hover:text-blue-500 hover:bg-blue-50 rounded-md transition-colors border border-dashed border-gray-300",children:[jsxRuntimeExports.jsx(Plus,{size:20}),jsxRuntimeExports.jsx("span",{children:"新增步驟"})]})]})})]})]})},GoalDetailsDialog=({goal:t,onClose:e,onBack:r,onTaskClick:n,isCreating:s=!1})=>{const[a,o]=reactExports.useState(s);return jsxRuntimeExports.jsxs("div",{className:"bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 p-6 w-[400px] max-w-[90vw] flex flex-col h-full",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-4 select-none","data-draggable-header":!0,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{className:"p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700",onClick:r,"aria-label":"返回",children:jsxRuntimeExports.jsx(ChevronLeft,{className:"w-5 h-5"})}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-indigo-700 dark:text-indigo-300",children:"學習目標詳情"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{className:`p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 ${a?"text-green-500 hover:bg-green-50":""}`,onClick:()=>o(!a),"aria-label":a?"完成編輯":"編輯",children:a?jsxRuntimeExports.jsx(Check,{className:"w-5 h-5"}):jsxRuntimeExports.jsx(Pencil,{className:"w-5 h-5"})}),jsxRuntimeExports.jsx("button",{className:"p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700",onClick:e,"aria-label":"關閉",children:jsxRuntimeExports.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-auto",children:jsxRuntimeExports.jsx(GoalDetails,{goal:t,onBack:r,onTaskClick:n,isCreating:!1,isEditing:a,onEditToggle:()=>o(!a)})})]})},DraggableDialog=({children:t,mapRect:e,position:r,onPositionChange:n,headerSelector:s})=>{const[a,o]=reactExports.useState(!1),l=reactExports.useRef(null),u=reactExports.useRef({startX:0,startY:0,initialX:0,initialY:0,isDragging:!1});return reactExports.useEffect(()=>{const c=l.current;if(!c)return;const d=c.querySelector(s);if(!d)return;const p=b=>{b.preventDefault(),b.stopPropagation(),o(!0),u.current.isDragging=!0,u.current.startX=b.clientX,u.current.startY=b.clientY,u.current.initialX=r.x,u.current.initialY=r.y,d.style.cursor="grabbing",d.style.userSelect="none",document.body.style.cursor="grabbing",document.body.style.userSelect="none"},m=b=>{if(!u.current.isDragging)return;b.preventDefault();const E=b.clientX-u.current.startX,T=b.clientY-u.current.startY,S=u.current.initialX+E,P=u.current.initialY+T,A=400,I=c.offsetHeight||600,j=-e.width+A-20,K=20,W=10,H=e.height-I-10,ee=Math.max(j,Math.min(K,S)),ue=Math.max(W,Math.min(H,P));n({x:ee,y:ue})},y=()=>{u.current.isDragging&&(o(!1),u.current.isDragging=!1,d.style.cursor="grab",d.style.userSelect="",document.body.style.cursor="",document.body.style.userSelect="")};return d.style.cursor="grab",d.style.userSelect="none",d.addEventListener("mousedown",p),document.addEventListener("mousemove",m),document.addEventListener("mouseup",y),()=>{d.removeEventListener("mousedown",p),document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",y),document.body.style.cursor="",document.body.style.userSelect=""}},[r,e,s,n]),jsxRuntimeExports.jsx(motion.div,{ref:l,className:"fixed z-50",style:{left:e.left+e.width+r.x,top:e.top+r.y,height:e.height-40},animate:{left:e.left+e.width+r.x,top:e.top+r.y},transition:{duration:a?0:.1,ease:"easeOut"},children:t})},StudentLearningMap=()=>{const[t,e]=reactExports.useState(null),[r,n]=reactExports.useState(null),[s,a]=reactExports.useState(!1),[o,l]=reactExports.useState(!1),[u,c]=reactExports.useState(!1),[d,p]=reactExports.useState(!1),{goals:m,addGoal:y,getCompletionRate:b}=useGoalStore(),E=reactExports.useRef(null),[T,S]=reactExports.useState(null),[P,A]=reactExports.useState({x:-420,y:20});reactExports.useLayoutEffect(()=>{if((o||u||t)&&E.current){const te=E.current.getBoundingClientRect();S({left:te.left,top:te.top,width:te.width,height:te.height})}},[o,u,t]);const I=m.find(te=>te.id===t),j=r?(()=>{for(const te of m)for(const le of te.steps){const Z=le.tasks.find(Y=>Y.id===r);if(Z)return{task:Z,step:le,goal:te}}return null})():null,K=j==null?void 0:j.task,W=j==null?void 0:j.step,H=j==null?void 0:j.goal,ee=(te,le=!1)=>{e(te),n(null),a(!1),p(le),le||c(!1)},ue=()=>{const te={id:"",title:"新目標",description:"",steps:[],subject:SUBJECTS.CUSTOM,templateType:"學習目標",status:"in_progress"};y(te),e(te.id),a(!0)},de=te=>{n(te)},fe=()=>{e(null),n(null),a(!1)},ae=()=>{d?(e(null),n(null),a(!1),p(!1),c(!0)):(e(null),n(null),a(!1),p(!1))},ce=()=>{n(null)},me=te=>{console.log("Help requested for task:",te)};return m.filter(te=>te.steps.some(le=>le.tasks.length>0)).map((te,le,Z)=>{const Y=Z.length,he=le/Y*80+10;return{id:te.id,label:te.title,subject:te.subject||"未分類",completed:te.steps.every(ye=>ye.tasks.every(Ee=>Ee.status==="done")),position:{x:he,y:50},goalId:te.id}}),jsxRuntimeExports.jsxs(PageLayout,{title:"學習地圖",children:[o&&T&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"fixed z-40 bg-black/10 cursor-pointer",style:{left:T.left,top:T.top,width:T.width,height:T.height},onClick:()=>l(!1)}),jsxRuntimeExports.jsx("div",{className:"fixed z-50 pointer-events-auto",style:{left:T.left,top:T.top,width:T.width,height:T.height,pointerEvents:"none"},children:jsxRuntimeExports.jsx("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",pointerEvents:"auto"},onClick:te=>te.stopPropagation(),children:jsxRuntimeExports.jsx(DailyReviewCarousel,{className:"max-h-[80vh] overflow-y-auto w-full max-w-[440px]",onClose:()=>l(!1)})})}),jsxRuntimeExports.jsx("button",{className:"fixed top-8 right-8 z-50 bg-white/80 dark:bg-gray-800/80 backdrop-blur px-3 py-1 rounded-full shadow border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-200 font-semibold hover:bg-gray-100 dark:hover:bg-gray-700 transition",onClick:()=>l(!1),children:"關閉"})]}),u&&T&&jsxRuntimeExports.jsx(DraggableDialog,{mapRect:T,position:P,onPositionChange:A,headerSelector:"[data-draggable-header]",children:jsxRuntimeExports.jsx(GoalDashboardDialog,{goals:m,onClose:()=>c(!1),onGoalClick:te=>ee(te,!0),onAddGoal:ue,getCompletionRate:b})}),t&&I&&T&&!r&&jsxRuntimeExports.jsx(DraggableDialog,{mapRect:T,position:P,onPositionChange:A,headerSelector:"[data-draggable-header]",children:jsxRuntimeExports.jsx(GoalDetailsDialog,{goal:I,onClose:fe,onBack:ae,onTaskClick:de,isCreating:s})}),r&&K&&W&&H&&T&&jsxRuntimeExports.jsx(DraggableDialog,{mapRect:T,position:P,onPositionChange:A,headerSelector:"[data-draggable-header]",children:jsxRuntimeExports.jsx(TaskDetailDialog,{task:K,stepId:W.id,goalId:H.id,onClose:fe,onBack:ce,onHelpRequest:me})}),jsxRuntimeExports.jsx("div",{className:"h-full p-6",children:jsxRuntimeExports.jsx("div",{className:"h-[calc(100vh-8rem)]",ref:E,children:jsxRuntimeExports.jsx(InteractiveMap,{goals:m,onGoalClick:ee,onCampfireClick:()=>l(!0),onMailboxClick:()=>c(!0)})})})]})};function App(){return jsxRuntimeExports.jsx(CurriculumProvider,{children:jsxRuntimeExports.jsx(UserProvider,{children:jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/login",element:jsxRuntimeExports.jsx(Login,{})}),jsxRuntimeExports.jsx(Route,{path:"/preview/lottie",element:jsxRuntimeExports.jsx(LottiePreview,{})}),jsxRuntimeExports.jsx(Route,{path:"/student",element:jsxRuntimeExports.jsx(StudentDashboard,{})}),jsxRuntimeExports.jsx(Route,{path:"/student/schedule",element:jsxRuntimeExports.jsx(StudentSchedule,{})}),jsxRuntimeExports.jsx(Route,{path:"/student/tasks",element:jsxRuntimeExports.jsx(StudentTasks,{})}),jsxRuntimeExports.jsx(Route,{path:"/student/planning",element:jsxRuntimeExports.jsx(StudentPlanning,{})}),jsxRuntimeExports.jsx(Route,{path:"/student/planning/goal/:goalId",element:jsxRuntimeExports.jsx(GoalMindMapPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/student/journal",element:jsxRuntimeExports.jsx(StudentJournal,{})}),jsxRuntimeExports.jsx(Route,{path:"/student/goals",element:jsxRuntimeExports.jsx(StudentGoals,{})}),jsxRuntimeExports.jsx(Route,{path:"/student/learning-map",element:jsxRuntimeExports.jsx(StudentLearningMap,{})}),jsxRuntimeExports.jsx(Route,{path:"/student/subject/:subjectId",element:jsxRuntimeExports.jsx(SubjectPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/mentor",element:jsxRuntimeExports.jsx(MentorDashboard,{})}),jsxRuntimeExports.jsx(Route,{path:"/mentor/tasks",element:jsxRuntimeExports.jsx(MentorTaskManager,{})}),jsxRuntimeExports.jsx(Route,{path:"/mentor/task-planner",element:jsxRuntimeExports.jsx(MentorTaskPlanner,{})}),jsxRuntimeExports.jsx(Route,{path:"/mentor/subject/:subjectId",element:jsxRuntimeExports.jsx(SubjectPage,{isMentor:!0})}),jsxRuntimeExports.jsx(Route,{path:"/mentor/curriculum",element:jsxRuntimeExports.jsx(MentorCurriculum,{})}),jsxRuntimeExports.jsx(Route,{path:"/mentor/course-blueprint",element:jsxRuntimeExports.jsx(CourseBluePrint,{})}),jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(Navigate,{to:"/login",replace:!0})}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(NotFound,{})})]})})})})}const container=document.getElementById("root");if(!container)throw new Error("Root element not found");const root=clientExports.createRoot(container);root.render(jsxRuntimeExports.jsx(App,{}));export{BaseStringPromptTemplate as B,PromptTemplate as P,checkValidTemplate as c,renderTemplate as r};
