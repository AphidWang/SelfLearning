/**
 * HabitChallengePage - Â≠∏ÁîüÁøíÊÖ£ÊåëÊà∞È†ÅÈù¢
 * 
 * üéØ ÂäüËÉΩË™™ÊòéÔºö
 * - ÁÆ°ÁêÜÊó•Â∏∏ÁøíÊÖ£ÂíåÊåëÊà∞‰ªªÂãô
 * - ÊîØÊè¥‰∏çÂêåÈ°ûÂûãÁöÑÊåëÊà∞ÔºöÈ´îËÉΩ„ÄÅÂ≠∏Áøí„ÄÅÁîüÊ¥ªÁ≠â
 * - ÈÄ≤Â∫¶ËøΩËπ§ÂíåÈÄ£Á∫åÂ§©Êï∏Áµ±Ë®à
 * - Ê∫´ÊöñËâ≤Ë™øË®≠Ë®àÔºåÈºìÂãµÊåÅÁ∫åÂÆåÊàê
 * 
 * üèóÔ∏è Êû∂ÊßãË®≠Ë®àÔºö
 * - ÊåâÈ°ûÂà•ÂàÜÁµÑÈ°ØÁ§∫ÔºàÂ≠∏Áßë„ÄÅÁîüÊ¥ª„ÄÅÈ´îËÉΩÁ≠âÔºâ
 * - ÊØèÂÄãÈ°ûÂà•È°ØÁ§∫Êï¥È´îÈÄ≤Â∫¶ÂíåÂÖ∑È´î‰ªªÂãô
 * - ÊîØÊè¥ÊØèÊó•ÊâìÂç°ÂíåÈÄ£Á∫åÂ§©Êï∏Áµ±Ë®à
 * - Á∞°ÊΩîÁöÑÂç°ÁâáÂºè‰ΩàÂ±Ä
 * 
 * üé® Ë¶ñË¶∫Ë®≠Ë®àÔºö
 * - Ê∏ÖÁàΩÁöÑÊ∑∫Ëâ≤Ë™øËÉåÊôØ
 * - ÊåâÈ°ûÂà•‰ΩøÁî®‰∏çÂêåÁöÑ‰∏ªÈ°åËâ≤ÂΩ©
 * - ÈÄ≤Â∫¶Ê¢ùÂíåÊâìÂç°ÂãïÁï´
 * - ÈºìÂãµÊÄßÁöÑË¶ñË¶∫ÂèçÈ•ã
 */

import React, { useState, useEffect, useMemo, useCallback } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import toast, { Toaster } from 'react-hot-toast';
import { ArrowLeft, Settings, Plus, CheckCircle2, Clock, Target, Star, Flame, Calendar, TrendingUp, X } from 'lucide-react';
import PageLayout from '../../components/layout/PageLayout';
import { LoadingDots } from '../../components/shared/LoadingDots';

/**
 * ÁøíÊÖ£È°ûÂûã
 */
type HabitType = 'daily' | 'weekly' | 'challenge';

/**
 * ÁøíÊÖ£ÁãÄÊÖã
 */
type HabitStatus = 'active' | 'completed' | 'paused';

/**
 * ÁøíÊÖ£/ÊåëÊà∞‰ªãÈù¢
 */
interface Habit {
  id: string;
  title: string;
  description?: string;
  type: HabitType;
  status: HabitStatus;
  categoryId: string;
  target: number; // ÁõÆÊ®ôÊ¨°Êï∏ÊàñÂ§©Êï∏
  current: number; // ÁõÆÂâçÈÄ≤Â∫¶
  streak: number; // ÈÄ£Á∫åÂ§©Êï∏
  lastCompletedDate?: string;
  createdAt: string;
  completedDates: string[]; // ÂÆåÊàêÊó•ÊúüË®òÈåÑ
}

/**
 * ÁøíÊÖ£È°ûÂà•
 */
interface HabitCategory {
  id: string;
  name: string;
  emoji: string;
  color: string;
  description: string;
}

/**
 * ÁøíÊÖ£Áµ±Ë®à
 */
interface HabitStats {
  totalHabits: number;
  completedHabits: number;
  currentStreak: number;
  totalCompletions: number;
}

// Mock Ë≥áÊñô
const mockCategories: HabitCategory[] = [
  {
    id: 'study',
    name: 'Â≠∏ÁøíÁøíÊÖ£',
    emoji: 'üìö',
    color: '#3B82F6',
    description: 'ÂüπÈ§äËâØÂ•ΩÁöÑÂ≠∏ÁøíÁøíÊÖ£'
  },
  {
    id: 'health',
    name: 'ÂÅ•Â∫∑ÁîüÊ¥ª',
    emoji: 'üí™',
    color: '#10B981',
    description: 'Á∂≠ÊåÅË∫´ÂøÉÂÅ•Â∫∑'
  },
  {
    id: 'life',
    name: 'ÁîüÊ¥ªÁÆ°ÁêÜ',
    emoji: 'üè†',
    color: '#F59E0B',
    description: 'ÊèêÂçáÁîüÊ¥ªÂìÅË≥™'
  },
  {
    id: 'hobby',
    name: 'ËààË∂£ÂüπÈ§ä',
    emoji: 'üé®',
    color: '#8B5CF6',
    description: 'ÁôºÂ±ïÂÄã‰∫∫ËààË∂£'
  }
];

const mockHabits: Habit[] = [
  // Â≠∏ÁøíÁøíÊÖ£
  {
    id: 'habit-1',
    title: 'ÊØèÊó•Ëã±ÊñáÁ∑¥Áøí',
    description: 'ÊØèÂ§©15ÂàÜÈêòËã±ÊñáÁ∑¥Áøí',
    type: 'daily',
    status: 'active',
    categoryId: 'study',
    target: 7,
    current: 4,
    streak: 4,
    lastCompletedDate: '2024-01-15',
    createdAt: '2024-01-12',
    completedDates: ['2024-01-12', '2024-01-13', '2024-01-14', '2024-01-15']
  },
  {
    id: 'habit-2',
    title: 'Êï∏Â≠∏Á∑¥ÁøíÈ°å',
    description: 'ÂÆåÊàê5ÈÅìÊï∏Â≠∏Á∑¥ÁøíÈ°å',
    type: 'daily',
    status: 'active',
    categoryId: 'study',
    target: 7,
    current: 2,
    streak: 2,
    lastCompletedDate: '2024-01-14',
    createdAt: '2024-01-13',
    completedDates: ['2024-01-13', '2024-01-14']
  },
  {
    id: 'habit-3',
    title: 'Èñ±ËÆÄÁêÜËß£',
    description: 'Èñ±ËÆÄ30ÂàÜÈêò',
    type: 'daily',
    status: 'active',
    categoryId: 'study',
    target: 7,
    current: 1,
    streak: 1,
    lastCompletedDate: '2024-01-15',
    createdAt: '2024-01-15',
    completedDates: ['2024-01-15']
  },
  // ÂÅ•Â∫∑ÁîüÊ¥ª
  {
    id: 'habit-4',
    title: 'Êô®ÈñìÈÅãÂãï',
    description: '10ÂàÜÈêò‰º∏Â±ïÈÅãÂãï',
    type: 'daily',
    status: 'active',
    categoryId: 'health',
    target: 7,
    current: 3,
    streak: 3,
    lastCompletedDate: '2024-01-15',
    createdAt: '2024-01-13',
    completedDates: ['2024-01-13', '2024-01-14', '2024-01-15']
  },
  {
    id: 'habit-5',
    title: 'ÂñùÊ∞¥ÊèêÈÜí',
    description: 'ÊØèÊó•8ÊùØÊ∞¥',
    type: 'daily',
    status: 'active',
    categoryId: 'health',
    target: 7,
    current: 5,
    streak: 5,
    lastCompletedDate: '2024-01-15',
    createdAt: '2024-01-11',
    completedDates: ['2024-01-11', '2024-01-12', '2024-01-13', '2024-01-14', '2024-01-15']
  },
  // ÁîüÊ¥ªÁÆ°ÁêÜ
  {
    id: 'habit-6',
    title: 'Êï¥ÁêÜÊõ∏Ê°å',
    description: '‰øùÊåÅÊõ∏Ê°åÊï¥ÊΩî',
    type: 'daily',
    status: 'active',
    categoryId: 'life',
    target: 7,
    current: 2,
    streak: 2,
    lastCompletedDate: '2024-01-14',
    createdAt: '2024-01-13',
    completedDates: ['2024-01-13', '2024-01-14']
  },
  {
    id: 'habit-7',
    title: 'Êó©Áù°Êó©Ëµ∑',
    description: '11ÈªûÂâç‰∏äÂ∫äÁù°Ë¶∫',
    type: 'daily',
    status: 'active',
    categoryId: 'life',
    target: 7,
    current: 1,
    streak: 1,
    lastCompletedDate: '2024-01-15',
    createdAt: '2024-01-15',
    completedDates: ['2024-01-15']
  },
  // ËààË∂£ÂüπÈ§ä
  {
    id: 'habit-8',
    title: 'Áï´Áï´Á∑¥Áøí',
    description: 'ÊØèÊó•Á¥†Êèè20ÂàÜÈêò',
    type: 'daily',
    status: 'active',
    categoryId: 'hobby',
    target: 7,
    current: 3,
    streak: 3,
    lastCompletedDate: '2024-01-15',
    createdAt: '2024-01-13',
    completedDates: ['2024-01-13', '2024-01-14', '2024-01-15']
  }
];

/**
 * ÁøíÊÖ£Âç°ÁâáÁµÑ‰ª∂
 */
interface HabitCardProps {
  habit: Habit;
  category: HabitCategory;
  onToggleComplete: (habitId: string) => void;
  onEdit: (habitId: string) => void;
}

const HabitCard: React.FC<HabitCardProps> = ({ habit, category, onToggleComplete, onEdit }) => {
  const progress = (habit.current / habit.target) * 100;
  const isCompletedToday = habit.lastCompletedDate === new Date().toISOString().split('T')[0];
  
  return (
    <motion.div
      className="bg-white/80 backdrop-blur-sm rounded-2xl p-4 shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300"
      whileHover={{ y: -2 }}
      layout
    >
      <div className="flex items-center justify-between mb-3">
        <div className="flex items-center gap-3">
          <motion.button
            className={`w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all duration-300 ${
              isCompletedToday 
                ? 'bg-green-500 border-green-500' 
                : 'border-gray-300 hover:border-green-400'
            }`}
            onClick={() => onToggleComplete(habit.id)}
            whileHover={{ scale: 1.1 }}
            whileTap={{ scale: 0.9 }}
          >
            {isCompletedToday && (
              <motion.div
                initial={{ scale: 0 }}
                animate={{ scale: 1 }}
                transition={{ type: "spring", stiffness: 500, damping: 30 }}
              >
                <CheckCircle2 className="w-4 h-4 text-white" />
              </motion.div>
            )}
          </motion.button>
          <div className="flex-1">
            <h4 className="font-semibold text-gray-800 text-sm">{habit.title}</h4>
            {habit.description && (
              <p className="text-xs text-gray-600 mt-1">{habit.description}</p>
            )}
          </div>
        </div>
        
        <div className="flex items-center gap-2">
          {habit.streak > 0 && (
            <div className="flex items-center gap-1 px-2 py-1 bg-orange-100 text-orange-600 rounded-full text-xs">
              <Flame className="w-3 h-3" />
              <span className="font-medium">{habit.streak}</span>
            </div>
          )}
          <span className="text-xs text-gray-500">
            {habit.current}/{habit.target}
          </span>
        </div>
      </div>
      
      {/* ÈÄ≤Â∫¶Ê¢ù */}
      <div className="w-full bg-gray-200 rounded-full h-2">
        <motion.div
          className="h-2 rounded-full transition-all duration-500"
          style={{ backgroundColor: category.color }}
          initial={{ width: 0 }}
          animate={{ width: `${progress}%` }}
        />
      </div>
    </motion.div>
  );
};

/**
 * È°ûÂà•Âç°ÁâáÁµÑ‰ª∂
 */
interface CategoryCardProps {
  category: HabitCategory;
  habits: Habit[];
  onToggleComplete: (habitId: string) => void;
  onEditHabit: (habitId: string) => void;
  onAddHabit: (categoryId: string) => void;
}

const CategoryCard: React.FC<CategoryCardProps> = ({ 
  category, 
  habits, 
  onToggleComplete, 
  onEditHabit, 
  onAddHabit 
}) => {
  const completedHabits = habits.filter(h => h.current >= h.target).length;
  const totalHabits = habits.length;
  const overallProgress = totalHabits > 0 ? (completedHabits / totalHabits) * 100 : 0;
  
  return (
    <motion.div
      className="bg-white/90 backdrop-blur-sm rounded-3xl shadow-xl border border-gray-100 p-6 hover:shadow-2xl transition-all duration-300"
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      whileHover={{ y: -3 }}
    >
      {/* È°ûÂà•Ê®ôÈ°å */}
      <div className="flex items-center justify-between mb-4">
        <div className="flex items-center gap-3">
          <div 
            className="w-12 h-12 rounded-2xl flex items-center justify-center text-2xl shadow-lg"
            style={{ backgroundColor: category.color + '20' }}
          >
            {category.emoji}
          </div>
          <div>
            <h3 className="text-xl font-bold text-gray-800">{category.name}</h3>
            <p className="text-sm text-gray-600">{category.description}</p>
          </div>
        </div>
        
        <div className="text-right">
          <div className="flex items-center gap-2 mb-1">
            <span className="text-2xl font-bold text-gray-800">
              {completedHabits}/{totalHabits}
            </span>
            <div 
              className="w-8 h-8 rounded-full flex items-center justify-center"
              style={{ backgroundColor: category.color + '20' }}
            >
              <TrendingUp className="w-4 h-4" style={{ color: category.color }} />
            </div>
          </div>
          <div className="text-xs text-gray-500">ÂÆåÊàêÈÄ≤Â∫¶</div>
        </div>
      </div>
      
      {/* Êï¥È´îÈÄ≤Â∫¶Ê¢ù */}
      <div className="mb-4">
        <div className="w-full bg-gray-200 rounded-full h-3">
          <motion.div
            className="h-3 rounded-full transition-all duration-500"
            style={{ backgroundColor: category.color }}
            initial={{ width: 0 }}
            animate={{ width: `${overallProgress}%` }}
          />
        </div>
        <div className="flex justify-between text-xs text-gray-500 mt-1">
          <span>Êï¥È´îÈÄ≤Â∫¶</span>
          <span>{Math.round(overallProgress)}%</span>
        </div>
      </div>
      
      {/* ÁøíÊÖ£ÂàóË°® */}
      <div className="space-y-3">
        {habits.map((habit) => (
          <HabitCard
            key={habit.id}
            habit={habit}
            category={category}
            onToggleComplete={onToggleComplete}
            onEdit={onEditHabit}
          />
        ))}
        
        {/* Ê∑ªÂä†Êñ∞ÁøíÊÖ£ÊåâÈàï */}
        <motion.button
          className="w-full p-3 border-2 border-dashed border-gray-300 rounded-2xl text-gray-500 hover:border-gray-400 hover:text-gray-600 transition-colors flex items-center justify-center gap-2"
          onClick={() => onAddHabit(category.id)}
          whileHover={{ scale: 1.02 }}
          whileTap={{ scale: 0.98 }}
        >
          <Plus className="w-4 h-4" />
          <span className="text-sm">Ê∑ªÂä†Êñ∞ÁøíÊÖ£</span>
        </motion.button>
      </div>
    </motion.div>
  );
};

/**
 * Áµ±Ë®àÈù¢ÊùøÁµÑ‰ª∂
 */
interface StatsPanelProps {
  stats: HabitStats;
}

const StatsPanel: React.FC<StatsPanelProps> = ({ stats }) => {
  const statItems = [
    { label: 'Á∏ΩÁøíÊÖ£', value: stats.totalHabits, icon: Target, color: '#3B82F6' },
    { label: 'Â∑≤ÂÆåÊàê', value: stats.completedHabits, icon: CheckCircle2, color: '#10B981' },
    { label: 'ÈÄ£Á∫åÂ§©Êï∏', value: stats.currentStreak, icon: Flame, color: '#F59E0B' },
    { label: 'Á∏ΩÂÆåÊàêÊ¨°Êï∏', value: stats.totalCompletions, icon: Star, color: '#8B5CF6' }
  ];

  return (
    <div className="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
      {statItems.map((item, index) => (
        <motion.div
          key={item.label}
          className="bg-white/90 backdrop-blur-sm rounded-2xl p-4 shadow-lg border border-gray-100"
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: index * 0.1 }}
        >
          <div className="flex items-center justify-between mb-2">
            <div 
              className="w-10 h-10 rounded-full flex items-center justify-center shadow-md"
              style={{ backgroundColor: item.color + '20' }}
            >
              <item.icon className="w-5 h-5" style={{ color: item.color }} />
            </div>
            <span className="text-2xl font-bold text-gray-800">{item.value}</span>
          </div>
          <p className="text-sm text-gray-600">{item.label}</p>
        </motion.div>
      ))}
    </div>
  );
};

export const HabitChallengePage = () => {
  const [habits, setHabits] = useState<Habit[]>(mockHabits);
  const [categories] = useState<HabitCategory[]>(mockCategories);
  const [isLoading, setIsLoading] = useState(true);
  const [showSettings, setShowSettings] = useState(false);

  // Ê®°Êì¨ÂàùÂßãËºâÂÖ•
  useEffect(() => {
    const timer = setTimeout(() => {
      setIsLoading(false);
    }, 1000);
    return () => clearTimeout(timer);
  }, []);

  // Ë®àÁÆóÁµ±Ë®àË≥áÊñô
  const stats = useMemo((): HabitStats => {
    const totalHabits = habits.filter(h => h.status === 'active').length;
    const completedHabits = habits.filter(h => h.status === 'active' && h.current >= h.target).length;
    const currentStreak = Math.max(...habits.map(h => h.streak), 0);
    const totalCompletions = habits.reduce((sum, h) => sum + h.current, 0);
    
    return {
      totalHabits,
      completedHabits,
      currentStreak,
      totalCompletions
    };
  }, [habits]);

  // ÊåâÈ°ûÂà•ÂàÜÁµÑÁøíÊÖ£
  const habitsByCategory = useMemo(() => {
    const grouped = categories.map(category => ({
      category,
      habits: habits.filter(h => h.categoryId === category.id && h.status === 'active')
    }));
    return grouped.filter(group => group.habits.length > 0);
  }, [categories, habits]);

  // ËôïÁêÜÁøíÊÖ£ÂÆåÊàêÁãÄÊÖãÂàáÊèõ
  const handleToggleComplete = useCallback((habitId: string) => {
    const today = new Date().toISOString().split('T')[0];
    
    setHabits(prev => prev.map(habit => {
      if (habit.id !== habitId) return habit;
      
      const isCompletedToday = habit.lastCompletedDate === today;
      
      if (isCompletedToday) {
        // ÂèñÊ∂à‰ªäÊó•ÂÆåÊàê
        return {
          ...habit,
          current: Math.max(0, habit.current - 1),
          streak: Math.max(0, habit.streak - 1),
          lastCompletedDate: habit.completedDates[habit.completedDates.length - 2] || undefined,
          completedDates: habit.completedDates.filter(date => date !== today)
        };
      } else {
        // Ê®ôË®ò‰ªäÊó•ÂÆåÊàê
        const newCompletedDates = [...habit.completedDates, today].sort();
        return {
          ...habit,
          current: habit.current + 1,
          streak: habit.streak + 1,
          lastCompletedDate: today,
          completedDates: newCompletedDates
        };
      }
    }));
    
    // È°ØÁ§∫ÈºìÂãµË®äÊÅØ
    toast.success(
      habits.find(h => h.id === habitId)?.lastCompletedDate === today 
        ? 'Â∑≤ÂèñÊ∂à‰ªäÊó•ÂÆåÊàê üëå' 
        : 'Â§™Ê£í‰∫ÜÔºÅ‰ªäÊó•‰ªªÂãôÂÆåÊàê üéâ',
      {
        duration: 2000,
        style: {
          background: '#10B981',
          color: 'white',
          borderRadius: '12px',
          fontWeight: '500'
        }
      }
    );
  }, [habits]);

  // ËôïÁêÜÁ∑®ËºØÁøíÊÖ£
  const handleEditHabit = useCallback((habitId: string) => {
    console.log('Edit habit:', habitId);
    // TODO: ÂØ¶‰ΩúÁ∑®ËºØÂäüËÉΩ
  }, []);

  // ËôïÁêÜÊ∑ªÂä†Êñ∞ÁøíÊÖ£
  const handleAddHabit = useCallback((categoryId: string) => {
    console.log('Add habit to category:', categoryId);
    // TODO: ÂØ¶‰ΩúÊ∑ªÂä†ÂäüËÉΩ
  }, []);

  if (isLoading) {
    return (
      <PageLayout title="ÁøíÊÖ£ÊåëÊà∞">
        <div className="flex items-center justify-center h-64">
          <LoadingDots 
            colors={['#3B82F6', '#10B981', '#F59E0B', '#8B5CF6']}
            size={8}
          />
        </div>
      </PageLayout>
    );
  }

  return (
    <PageLayout title="ÁøíÊÖ£ÊåëÊà∞">
      <Toaster 
        position="top-center"
        toastOptions={{
          duration: 3000,
          style: {
            borderRadius: '12px',
            fontWeight: '500'
          }
        }}
      />
      
      {/* Ê∏ÖÊñ∞ËÉåÊôØ */}
      <div 
        className="min-h-screen"
        style={{
          background: 'linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 50%, #f0f9ff 100%)',
          backgroundImage: `
            radial-gradient(circle at 25% 25%, #e0f2fe 0%, transparent 50%),
            radial-gradient(circle at 75% 75%, #f0f9ff 0%, transparent 50%)
          `
        }}
      >
        {/* Ê®ôÈ°åÂçÄÂüü */}
        <div className="bg-gradient-to-r from-blue-50/80 to-cyan-50/80 backdrop-blur-sm border-b border-blue-200/50 mb-6">
          <div className="max-w-7xl mx-auto px-4 py-6">
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-4">
                <button
                  onClick={() => window.history.back()}
                  className="p-2 rounded-full bg-white/80 text-blue-700 hover:bg-white transition-colors shadow-sm"
                >
                  <ArrowLeft className="w-5 h-5" />
                </button>
                
                <div>
                  <h1 className="text-3xl font-bold text-blue-900 mb-1">
                    üéØ ÁøíÊÖ£ÊåëÊà∞
                  </h1>
                  <p className="text-blue-700">
                    ÂüπÈ§äÂ•ΩÁøíÊÖ£ÔºåËøéÊé•ÊØè‰∏ÄÂ§©ÁöÑÊåëÊà∞ÔºÅ
                  </p>
                </div>
              </div>
              
              <div className="flex items-center gap-4">
                <button
                  onClick={() => setShowSettings(!showSettings)}
                  className="p-2 rounded-full bg-white/80 text-blue-700 hover:bg-white transition-colors shadow-sm"
                >
                  <Settings className="w-5 h-5" />
                </button>
              </div>
            </div>
          </div>
        </div>

        {/* Ë®≠ÂÆöÈù¢Êùø */}
        <AnimatePresence>
          {showSettings && (
            <motion.div
              className="fixed top-0 right-0 w-80 h-full bg-white/95 backdrop-blur-md shadow-2xl z-[100] p-6"
              initial={{ x: '100%' }}
              animate={{ x: 0 }}
              exit={{ x: '100%' }}
              transition={{ type: 'spring', damping: 25, stiffness: 300 }}
            >
              <div className="space-y-6">
                <div className="flex items-center justify-between">
                  <h3 className="text-lg font-bold text-gray-800">ÁøíÊÖ£Ë®≠ÂÆö</h3>
                  <button
                    onClick={() => setShowSettings(false)}
                    className="p-1 rounded-full hover:bg-gray-100 text-gray-500 hover:text-gray-700 transition-colors"
                  >
                    <X className="w-5 h-5" />
                  </button>
                </div>
                
                <div className="text-sm text-gray-600">
                  <p>Ë®≠ÂÆöÂäüËÉΩÈñãÁôº‰∏≠...</p>
                  <p className="mt-2">Âç≥Â∞áÊîØÊè¥Ôºö</p>
                  <ul className="mt-1 space-y-1 text-xs">
                    <li>‚Ä¢ Ëá™Ë®ÇÊèêÈÜíÊôÇÈñì</li>
                    <li>‚Ä¢ ÁõÆÊ®ôË™øÊï¥</li>
                    <li>‚Ä¢ Áµ±Ë®àÂ†±Âëä</li>
                  </ul>
                </div>
              </div>
            </motion.div>
          )}
        </AnimatePresence>

        {/* ‰∏ªË¶ÅÂÖßÂÆπÂçÄÂüü */}
        <div className="max-w-7xl mx-auto px-4 pb-20">
          {/* Áµ±Ë®àÈù¢Êùø */}
          <StatsPanel stats={stats} />
          
          {/* ÁøíÊÖ£È°ûÂà•Á∂≤Ê†º */}
          <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
            {habitsByCategory.map((group, index) => (
              <motion.div
                key={group.category.id}
                initial={{ opacity: 0, y: 20 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: index * 0.1 }}
              >
                <CategoryCard
                  category={group.category}
                  habits={group.habits}
                  onToggleComplete={handleToggleComplete}
                  onEditHabit={handleEditHabit}
                  onAddHabit={handleAddHabit}
                />
              </motion.div>
            ))}
          </div>
          
          {/* Á©∫ÁãÄÊÖã */}
          {habitsByCategory.length === 0 && (
            <div className="text-center py-20">
              <div className="text-6xl mb-4">üéØ</div>
              <h3 className="text-2xl font-bold text-gray-800 mb-2">ÈñãÂßã‰Ω†ÁöÑÁøíÊÖ£ÊåëÊà∞ÔºÅ</h3>
              <p className="text-gray-600 mb-4">Âª∫Á´ã‰Ω†ÁöÑÁ¨¨‰∏ÄÂÄãÁøíÊÖ£ÔºåÈñãÂßãÊîπËÆäÁîüÊ¥ª</p>
              <button
                onClick={() => handleAddHabit('study')}
                className="inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-2xl font-medium hover:from-blue-600 hover:to-cyan-600 transition-all shadow-lg hover:shadow-xl"
              >
                <Plus className="w-5 h-5" />
                Âª∫Á´ãÁ¨¨‰∏ÄÂÄãÁøíÊÖ£
              </button>
            </div>
          )}
        </div>
      </div>
    </PageLayout>
  );
};

export default HabitChallengePage; 